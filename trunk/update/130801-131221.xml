<files codepage='65001' xmlns:dt='urn:schemas-microsoft-com:datatypes'>
	<file name='zb_system\ADMIN\admin.asp' crc32='BEFA056A'  dt:dt='bin.base64'>77u/PCVAIENPREVQQUdFPTY1MDAxICU+DQo8JQ0KJy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCicvLyAgICAgICAgICAgICAgWi1CbG9nDQonLy8g5L2cICAgIOiAhTogICAg5pyx54WKKHp4LmFzZCkNCicvLyDniYjmnYPmiYDmnIk6ICAgIFJhaW5ib3dTb2Z0IFN0dWRpbw0KJy8vIOaKgOacr+aUr+aMgTogICAgcmFpbmJvd3NvZnRAMTYzLmNvbQ0KJy8vIOeoi+W6j+WQjeensDogICAgDQonLy8g56iL5bqP54mI5pysOiAgICANCicvLyDljZXlhYPlkI3np7A6ICAgIGFkbWluLmFzcA0KJy8vIOW8gOWni+aXtumXtDogICAgMjAwNC4wNy4zMA0KJy8vIOacgOWQjuS/ruaUuTogICAgDQonLy8g5aSHICAgIOazqDogICAg566h55CG6aG1DQonLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KJT4NCjwlIE9wdGlvbiBFeHBsaWNpdCAlPg0KPCUgT24gRXJyb3IgUmVzdW1lIE5leHQgJT4NCjwlIFJlc3BvbnNlLkNoYXJzZXQ9IlVURi04IiAlPg0KPCUgUmVzcG9uc2UuQnVmZmVyPVRydWUgJT4NCjwhLS0gI2luY2x1ZGUgZmlsZT0iLi4vLi4vemJfdXNlcnMvY19vcHRpb24uYXNwIiAtLT4NCjwhLS0gI2luY2x1ZGUgZmlsZT0iLi4vZnVuY3Rpb24vY19mdW5jdGlvbi5hc3AiIC0tPg0KPCEtLSAjaW5jbHVkZSBmaWxlPSIuLi9mdW5jdGlvbi9jX3N5c3RlbV9saWIuYXNwIiAtLT4NCjwhLS0gI2luY2x1ZGUgZmlsZT0iLi4vZnVuY3Rpb24vY19zeXN0ZW1fYmFzZS5hc3AiIC0tPg0KPCEtLSAjaW5jbHVkZSBmaWxlPSIuLi9mdW5jdGlvbi9jX3N5c3RlbV9ldmVudC5hc3AiIC0tPg0KPCEtLSAjaW5jbHVkZSBmaWxlPSIuLi9mdW5jdGlvbi9jX3N5c3RlbV9tYW5hZ2UuYXNwIiAtLT4NCjwhLS0gI2luY2x1ZGUgZmlsZT0iLi4vZnVuY3Rpb24vY19zeXN0ZW1fcGx1Z2luLmFzcCIgLS0+DQo8IS0tICNpbmNsdWRlIGZpbGU9Ii4uLy4uL3piX3VzZXJzL3BsdWdpbi9wX2NvbmZpZy5hc3AiIC0tPg0KPCUNCkNhbGwgU3lzdGVtX0luaXRpYWxpemUoKQ0KDQon5qOA5p+l5qih5p2/55qE5pu05pawLOWmguacieabtOaWsOimgemHjeaWsOWKoOi9vQ0KRGltIHN0clRlbXBsYXRlTW9kaWZpZWQNCkFwcGxpY2F0aW9uLkxvY2sNCnN0clRlbXBsYXRlTW9kaWZpZWQ9QXBwbGljYXRpb24oWkNfQkxPR19DTFNJRCAmICJURU1QTEFURU1PRElGSUVEIikNCkFwcGxpY2F0aW9uLlVuTG9jaw0KSWYgSXNFbXB0eShzdHJUZW1wbGF0ZU1vZGlmaWVkKT1GYWxzZSBUaGVuDQoJSWYgTENhc2UoQ1N0cihzdHJUZW1wbGF0ZU1vZGlmaWVkKSk8PkxDYXNlKENTdHIoQ2hlY2tUZW1wbGF0ZU1vZGlmaWVkKSkgVGhlbg0KCQlDYWxsIEJsb2dSZUJ1aWxkX0RlZmF1bHQoKQ0KCUVuZCBJZg0KRW5kIElmDQoNCkRpbSBhY3QNCmFjdD1SZXF1ZXN0LlF1ZXJ5U3RyaW5nKCJhY3QiKQ0KaWYgYWN0PSIiIFRoZW4gYWN0PSJTaXRlSW5mbyINCg0KJ3BsdWdpbiBub2RlDQpGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9BZG1pbl9CZWdpbiBpbiBBY3Rpb25fUGx1Z2luX0FkbWluX0JlZ2luDQoJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fQWRtaW5fQmVnaW4pIFRoZW4gQ2FsbCBFeGVjdXRlKHNBY3Rpb25fUGx1Z2luX0FkbWluX0JlZ2luKQ0KTmV4dA0KDQon5qOA5p+l5p2D6ZmQDQpJZiBOb3QgQ2hlY2tSaWdodHMoYWN0KSBUaGVuIENhbGwgU2hvd0Vycm9yKDYpDQoNCkJsb2dUaXRsZT1aQ19NU0cwMjINCg0KJT4NCjwhLS0jaW5jbHVkZSBmaWxlPSJhZG1pbl9oZWFkZXIuYXNwIi0tPg0KPCEtLSNpbmNsdWRlIGZpbGU9ImFkbWluX3RvcC5hc3AiLS0+DQogICAgPGRpdiBpZD0iZGl2TWFpbiI+DQo8JQlDYWxsIEdldEJsb2dIaW50KCkJJT4NCiAgICAgIDwlDQoJU2VsZWN0IENhc2UgYWN0DQoJCUNhc2UgIkFydGljbGVNbmciDQoJCQlJZiBSZXF1ZXN0LlF1ZXJ5U3RyaW5nKCJ0eXBlIik9IlBhZ2UiIFRoZW4NCgkJCUNhbGwgRXhwb3J0UGFnZUxpc3QoUmVxdWVzdC5RdWVyeVN0cmluZygicGFnZSIpLFJlcXVlc3QoImNhdGUiKSxSZXF1ZXN0KCJsZXZlbCIpLEVzY2FwZShSZXF1ZXN0KCJ0aXRsZSIpKSkNCgkJCUVsc2UNCgkJCUNhbGwgRXhwb3J0QXJ0aWNsZUxpc3QoUmVxdWVzdC5RdWVyeVN0cmluZygicGFnZSIpLFJlcXVlc3QoImNhdGUiKSxSZXF1ZXN0KCJsZXZlbCIpLFJlcXVlc3QoImlzdG9wIiksRXNjYXBlKFJlcXVlc3QoInRpdGxlIikpKQ0KCQkJRW5kIElmDQoJCUNhc2UgIkNhdGVnb3J5TW5nIiBDYWxsIEV4cG9ydENhdGVnb3J5TGlzdChSZXF1ZXN0LlF1ZXJ5U3RyaW5nKCJwYWdlIikpDQoJCUNhc2UgIkNvbW1lbnRNbmciIENhbGwgRXhwb3J0Q29tbWVudExpc3QoUmVxdWVzdC5RdWVyeVN0cmluZygicGFnZSIpLFJlcXVlc3QoImludENvbnRlbnQiKSxSZXF1ZXN0KCJpc0NoZWNrIikpDQoJCUNhc2UgIlRyYWNrQmFja01uZyIgQ2FsbCBFeHBvcnRUcmFja0JhY2tMaXN0KFJlcXVlc3QuUXVlcnlTdHJpbmcoInBhZ2UiKSkNCgkJQ2FzZSAiVXNlck1uZyIgQ2FsbCBFeHBvcnRVc2VyTGlzdChSZXF1ZXN0LlF1ZXJ5U3RyaW5nKCJwYWdlIikpDQoJCUNhc2UgIkZpbGVNbmciIENhbGwgRXhwb3J0RmlsZUxpc3QoUmVxdWVzdC5RdWVyeVN0cmluZygicGFnZSIpKQ0KCQlDYXNlICJUYWdNbmciIENhbGwgRXhwb3J0VGFnTGlzdChSZXF1ZXN0LlF1ZXJ5U3RyaW5nKCJwYWdlIikpDQoJCUNhc2UgIlBsdWdJbk1uZyIgQ2FsbCBFeHBvcnRQbHVnaW5NbmcoKQ0KCQlDYXNlICJTaXRlSW5mbyIgQ2FsbCBFeHBvcnRTaXRlSW5mbygpDQoJCUNhc2UgIkFza0ZpbGVSZUJ1aWxkIiBDYWxsIEV4cG9ydEZpbGVSZUJ1aWxkQXNrKCkNCgkJQ2FzZSAiVGhlbWVNbmciIENhbGwgRXhwb3J0VGhlbWVNbmcoKQ0KCQlDYXNlICJGdW5jdGlvbk1uZyIgQ2FsbCBFeHBvcnRGdW5jdGlvbkxpc3QoKQ0KCQlDYXNlIEVsc2UgQ2FsbCBFeHBvcnRTaXRlSW5mbygpDQoJRW5kIFNlbGVjdA0KJT4NCiAgICA8L2Rpdj4NCjwhLS0jaW5jbHVkZSBmaWxlPSJhZG1pbl9mb290ZXIuYXNwIi0tPg0KPCUNCidwbHVnaW4gbm9kZQ0KRm9yIEVhY2ggc0FjdGlvbl9QbHVnaW5fQWRtaW5fRW5kIGluIEFjdGlvbl9QbHVnaW5fQWRtaW5fRW5kDQoJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fQWRtaW5fRW5kKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9BZG1pbl9FbmQpDQpOZXh0DQoNCkNhbGwgU3lzdGVtX1Rlcm1pbmF0ZSgpDQoNCklmIEVyci5OdW1iZXI8PjAgdGhlbg0KCUNhbGwgU2hvd0Vycm9yKDApDQpFbmQgSWYNCiU+DQo8IS0tIDwlPVJ1blRpbWUoKSU+bXMgLS0+</file>
	<file name='zb_system\ADMIN\c_updateinfo.asp' crc32='261F569E'  dt:dt='bin.base64'>77u/PCVAIENPREVQQUdFPTY1MDAxICU+DQo8JQ0KJy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCicvLyAgICAgICAgICAgICAgWi1CbG9nDQonLy8g5L2cICAgIOiAhTogICAg5pyx54WKKHp4LmFzZCkmKHNpcG8pDQonLy8g54mI5p2D5omA5pyJOiAgICBSYWluYm93U29mdCBTdHVkaW8NCicvLyDmioDmnK/mlK/mjIE6ICAgIHJhaW5ib3dzb2Z0QDE2My5jb20NCicvLyDnqIvluo/lkI3np7A6ICAgIA0KJy8vIOeoi+W6j+eJiOacrDogICAgDQonLy8g5Y2V5YWD5ZCN56ewOiAgICBjX3VwZGF0ZWluZm8uYXNwDQonLy8g5byA5aeL5pe26Ze0OiAgICAyMDA3LTEtMjYNCicvLyDmnIDlkI7kv67mlLk6ICAgIA0KJy8vIOWkhyAgICDms6g6ICAgIA0KJy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCiU+DQo8JSBPcHRpb24gRXhwbGljaXQgJT4NCjwlIE9uIEVycm9yIFJlc3VtZSBOZXh0ICU+DQo8JSBSZXNwb25zZS5DaGFyc2V0PSJVVEYtOCIgJT4NCjwlIFJlc3BvbnNlLkJ1ZmZlcj1UcnVlICU+DQo8IS0tICNpbmNsdWRlIGZpbGU9Ii4uLy4uL3piX3VzZXJzL2Nfb3B0aW9uLmFzcCIgLS0+DQo8IS0tICNpbmNsdWRlIGZpbGU9Ii4uL2Z1bmN0aW9uL2NfZnVuY3Rpb24uYXNwIiAtLT4NCjwhLS0gI2luY2x1ZGUgZmlsZT0iLi4vZnVuY3Rpb24vY19zeXN0ZW1fYmFzZS5hc3AiIC0tPg0KPCUNCg0KUmVzcG9uc2UuRXhwaXJlc0Fic29sdXRlICAgPSAgIE5vdygpICAgLSAgIDEgICAgICAgICAgIA0KUmVzcG9uc2UuRXhwaXJlcyAgID0gICAwICAgDQpSZXNwb25zZS5DYWNoZUNvbnRyb2wgICA9ICAgIm5vLWNhY2hlIg0KDQpJZiBMZW4oWkNfVVBEQVRFX0lORk9fVVJMKT4wIFRoZW4NCg0KCURpbSBzdHJQaW5nVGltZQ0KCURpbSBzdHJQaW5nQ29udGVudA0KDQoJRGltIGIsaA0KCWI9RmFsc2UNCgloPU5vdw0KCURpbSBmc28sZg0KCVNldCBmc28gPSBDcmVhdGVPYmplY3QoIlNjcmlwdGluZy5GaWxlU3lzdGVtT2JqZWN0IikNCglJZiBmc28uRmlsZUV4aXN0cyhCbG9nUGF0aCAmICJ6Yl91c2Vyc1xDQUNIRVx1cGRhdGVpbmZvLnR4dCIpPVRydWUgVGhlbg0KCQlTZXQgZiA9IGZzby5HZXRGaWxlKEJsb2dQYXRoICYgInpiX3VzZXJzXENBQ0hFXHVwZGF0ZWluZm8udHh0IikNCg0KCQlzdHJQaW5nQ29udGVudD1Mb2FkRnJvbUZpbGUoQmxvZ1BhdGggJiAiemJfdXNlcnNcQ0FDSEVcdXBkYXRlaW5mby50eHQiLCJ1dGYtOCIpDQoJCUlmIERhdGVEaWZmKCJoIixmLkRhdGVMYXN0TW9kaWZpZWQsTm93KT4yNCBUaGVuDQoJCQliPVRydWUNCgkJRWxzZQ0KCQkJaD1mLkRhdGVMYXN0TW9kaWZpZWQNCgkJRW5kIElmDQoJRWxzZQ0KCQliPVRydWUNCglFbmQgSWYNCg0KCUlmIElzRW1wdHkoUmVxdWVzdC5RdWVyeVN0cmluZygicmVsb2FkIikpPUZhbHNlIFRoZW4NCgkJYj1UcnVlDQoJRW5kIElmDQoNCg0KCUlmIGI9VHJ1ZSBUaGVuDQoNCgkJRGltIG9ialBpbmcNCgkJU2V0IG9ialBpbmcgPSBTZXJ2ZXIuQ3JlYXRlT2JqZWN0KCJNU1hNTDIuU2VydmVyWE1MSFRUUCIpDQoNCgkJb2JqUGluZy5vcGVuICJHRVQiLFpDX1VQREFURV9JTkZPX1VSTCxGYWxzZQ0KDQoJCW9ialBpbmcuc2VuZA0KDQoJCUlmIG9ialBpbmcuUmVhZHlTdGF0ZT00IFRoZW4NCgkJCUlmIG9ialBpbmcuU3RhdHVzPTIwMCBUaGVuDQoJCQkJc3RyUGluZ0NvbnRlbnQ9b2JqUGluZy5yZXNwb25zZVRleHQNCgkJCUVuZCBJZg0KCQlFbmQgSWYNCg0KCQlEaW0gb2JqUmVnRXhwDQoJCVNldCBvYmpSZWdFeHA9TmV3IFJlZ0V4cA0KCQlvYmpSZWdFeHAuSWdub3JlQ2FzZSA9VHJ1ZQ0KCQlvYmpSZWdFeHAuR2xvYmFsPVRydWUNCgkJb2JqUmVnRXhwLlBhdHRlcm49IjxzY3JpcHQuKi8qPnw8L3NjcmlwdD58PFthLXpBLVpdW14+XSo9WyciIl0ramF2YXNjcmlwdDpcdysuKlsnIiJdKz58PFx3K1tePl0qXHNvblx3Kz0uKlsgL10qPiINCgkJc3RyUGluZ0NvbnRlbnQ9IG9ialJlZ0V4cC5SZXBsYWNlKHN0clBpbmdDb250ZW50LCIiKQ0KDQoJCVNldCBvYmpQaW5nID0gTm90aGluZw0KDQoJCUNhbGwgU2F2ZVRvRmlsZShCbG9nUGF0aCAmICJ6Yl91c2Vyc1xDQUNIRVx1cGRhdGVpbmZvLnR4dCIsc3RyUGluZ0NvbnRlbnQsInV0Zi04IixGYWxzZSkNCg0KCUVuZCBJZg0KCSdSZXNwb25zZS5BZGRIZWFkZXIgIkxhc3QtTW9kaWZpZWQiLFBhcnNlRGF0ZUZvclJGQzgyMkdNVChoKQ0KCVJlc3BvbnNlLldyaXRlIHN0clBpbmdDb250ZW50DQoNCkVuZCBJZg0KJT4=</file>
	<file name='zb_system\ADMIN\ueditor\ueditor.all.js' crc32='2DB2987B'  dt:dt='bin.base64'>KGZ1bmN0aW9uKCl7ClVFRElUT1JfQ09ORklHID0gd2luZG93LlVFRElUT1JfQ09ORklHIHx8IHt9Ow0KDQp2YXIgYmFpZHUgPSB3aW5kb3cuYmFpZHUgfHwge307DQoNCndpbmRvdy5iYWlkdSA9IGJhaWR1Ow0KDQp3aW5kb3cuVUUgPSBiYWlkdS5lZGl0b3IgPSAge307DQoNClVFLnBsdWdpbnMgPSB7fTsNCg0KVUUuY29tbWFuZHMgPSB7fTsNCg0KVUUuaW5zdGFudHMgPSB7fTsNCg0KVUUuSTE4TiA9IHt9Ow0KDQpVRS52ZXJzaW9uID0gIjEuMi42LjEiOw0KDQp2YXIgZG9tID0gVUUuZG9tID0ge307Ci8qKg0KICogQGZpbGUNCiAqIEBuYW1lIFVFLmJyb3dzZXINCiAqIEBzaG9ydCBCcm93c2VyDQogKiBAZGVzYyBVRWRpdG9y5Lit6YeH55So55qE5rWP6KeI5Zmo5Yik5pat5qih5Z2XDQogKi8NCnZhciBicm93c2VyID0gVUUuYnJvd3NlciA9IGZ1bmN0aW9uKCl7DQogICAgdmFyIGFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLA0KICAgICAgICBvcGVyYSA9IHdpbmRvdy5vcGVyYSwNCiAgICAgICAgYnJvd3NlciA9IHsNCiAgICAgICAgLyoqDQogICAgICAgICAqIOajgOa1i+a1j+iniOWZqOaYr+WQpuS4uklFDQogICAgICAgICAqIEBuYW1lIGllDQogICAgICAgICAqIEBncmFtbWFyIFVFLmJyb3dzZXIuaWUgID0+IHRydWV8ZmFsc2UNCiAgICAgICAgICovDQogICAgICAgIGllCQk6ICEhd2luZG93LkFjdGl2ZVhPYmplY3QsDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIOajgOa1i+a1j+iniOWZqOaYr+WQpuS4uk9wZXJhDQogICAgICAgICAqIEBuYW1lIG9wZXJhDQogICAgICAgICAqIEBncmFtbWFyIFVFLmJyb3dzZXIub3BlcmEgID0+IHRydWV8ZmFsc2UNCiAgICAgICAgICovDQogICAgICAgIG9wZXJhCTogKCAhIW9wZXJhICYmIG9wZXJhLnZlcnNpb24gKSwNCg0KICAgICAgICAvKioNCiAgICAgICAgICog5qOA5rWL5rWP6KeI5Zmo5piv5ZCm5Li6d2Via2l05YaF5qC4DQogICAgICAgICAqIEBuYW1lIHdlYmtpdA0KICAgICAgICAgKiBAZ3JhbW1hciBVRS5icm93c2VyLndlYmtpdCAgPT4gdHJ1ZXxmYWxzZQ0KICAgICAgICAgKi8NCiAgICAgICAgd2Via2l0CTogKCBhZ2VudC5pbmRleE9mKCAnIGFwcGxld2Via2l0LycgKSA+IC0xICksDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIOajgOa1i+a1j+iniOWZqOaYr+WQpuS4um1hY+ezu+e7n+S4i+eahOa1j+iniOWZqA0KICAgICAgICAgKiBAbmFtZSBtYWMNCiAgICAgICAgICogQGdyYW1tYXIgVUUuYnJvd3Nlci5tYWMgID0+IHRydWV8ZmFsc2UNCiAgICAgICAgICovDQogICAgICAgIG1hYwk6ICggYWdlbnQuaW5kZXhPZiggJ21hY2ludG9zaCcgKSA+IC0xICksDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIOajgOa1i+a1j+iniOWZqOaYr+WQpuWkhOS6juaAquW8guaooeW8jw0KICAgICAgICAgKiBAbmFtZSBxdWlya3MNCiAgICAgICAgICogQGdyYW1tYXIgVUUuYnJvd3Nlci5xdWlya3MgID0+IHRydWV8ZmFsc2UNCiAgICAgICAgICovDQogICAgICAgIHF1aXJrcyA6ICggZG9jdW1lbnQuY29tcGF0TW9kZSA9PSAnQmFja0NvbXBhdCcgKQ0KICAgIH07DQogICAgLyoqDQogICAgICog5qOA5rWL5rWP6KeI5Zmo5piv5ZCm5aSE5Li6Z2Vja2/lhoXmoLgNCiAgICAgKiBAbmFtZSBnZWNrbw0KICAgICAqIEBncmFtbWFyIFVFLmJyb3dzZXIuZ2Vja28gID0+IHRydWV8ZmFsc2UNCiAgICAgKi8NCiAgICBicm93c2VyLmdlY2tvID0oIG5hdmlnYXRvci5wcm9kdWN0ID09ICdHZWNrbycgJiYgIWJyb3dzZXIud2Via2l0ICYmICFicm93c2VyLm9wZXJhICk7DQoNCiAgICB2YXIgdmVyc2lvbiA9IDA7DQoNCiAgICAvLyBJbnRlcm5ldCBFeHBsb3JlciA2LjArDQogICAgaWYgKCBicm93c2VyLmllICl7DQogICAgICAgIHZlcnNpb24gPSBwYXJzZUZsb2F0KCBhZ2VudC5tYXRjaCggL21zaWUgKFxkKykvIClbMV0gKTsNCiAgICAgICAgLyoqDQogICAgICAgICAqIOajgOa1i+a1j+iniOWZqOaYr+WQpuS4uiBJRTkg5qih5byPDQogICAgICAgICAqIEBuYW1lIGllOUNvbXBhdA0KICAgICAgICAgKiBAZ3JhbW1hciBVRS5icm93c2VyLmllOUNvbXBhdCAgPT4gdHJ1ZXxmYWxzZQ0KICAgICAgICAgKi8NCiAgICAgICAgYnJvd3Nlci5pZTlDb21wYXQgPSBkb2N1bWVudC5kb2N1bWVudE1vZGUgPT0gOTsNCiAgICAgICAgLyoqDQogICAgICAgICAqIOajgOa1i+a1j+iniOWZqOaYr+WQpuS4uiBJRTgg5rWP6KeI5ZmoDQogICAgICAgICAqIEBuYW1lIGllOA0KICAgICAgICAgKiBAZ3JhbW1hciAgICAgVUUuYnJvd3Nlci5pZTggID0+IHRydWV8ZmFsc2UNCiAgICAgICAgICovDQogICAgICAgIGJyb3dzZXIuaWU4ID0gISFkb2N1bWVudC5kb2N1bWVudE1vZGU7DQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIOajgOa1i+a1j+iniOWZqOaYr+WQpuS4uiBJRTgg5qih5byPDQogICAgICAgICAqIEBuYW1lIGllOENvbXBhdA0KICAgICAgICAgKiBAZ3JhbW1hciAgICAgVUUuYnJvd3Nlci5pZThDb21wYXQgID0+IHRydWV8ZmFsc2UNCiAgICAgICAgICovDQogICAgICAgIGJyb3dzZXIuaWU4Q29tcGF0ID0gZG9jdW1lbnQuZG9jdW1lbnRNb2RlID09IDg7DQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIOajgOa1i+a1j+iniOWZqOaYr+WQpui/kOihjOWcqCDlhbzlrrlJRTfmqKHlvI8NCiAgICAgICAgICogQG5hbWUgaWU3Q29tcGF0DQogICAgICAgICAqIEBncmFtbWFyICAgICBVRS5icm93c2VyLmllN0NvbXBhdCAgPT4gdHJ1ZXxmYWxzZQ0KICAgICAgICAgKi8NCiAgICAgICAgYnJvd3Nlci5pZTdDb21wYXQgPSAoICggdmVyc2lvbiA9PSA3ICYmICFkb2N1bWVudC5kb2N1bWVudE1vZGUgKQ0KICAgICAgICAgICAgICAgIHx8IGRvY3VtZW50LmRvY3VtZW50TW9kZSA9PSA3ICk7DQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIOajgOa1i+a1j+iniOWZqOaYr+WQpklFNuaooeW8j+aIluaAquW8guaooeW8jw0KICAgICAgICAgKiBAbmFtZSBpZTZDb21wYXQNCiAgICAgICAgICogQGdyYW1tYXIgICAgIFVFLmJyb3dzZXIuaWU2Q29tcGF0ICA9PiB0cnVlfGZhbHNlDQogICAgICAgICAqLw0KICAgICAgICBicm93c2VyLmllNkNvbXBhdCA9ICggdmVyc2lvbiA8IDcgfHwgYnJvd3Nlci5xdWlya3MgKTsNCg0KICAgIH0NCg0KICAgIC8vIEdlY2tvLg0KICAgIGlmICggYnJvd3Nlci5nZWNrbyApew0KICAgICAgICB2YXIgZ2Vja29SZWxlYXNlID0gYWdlbnQubWF0Y2goIC9ydjooW1xkXC5dKykvICk7DQogICAgICAgIGlmICggZ2Vja29SZWxlYXNlICkNCiAgICAgICAgew0KICAgICAgICAgICAgZ2Vja29SZWxlYXNlID0gZ2Vja29SZWxlYXNlWzFdLnNwbGl0KCAnLicgKTsNCiAgICAgICAgICAgIHZlcnNpb24gPSBnZWNrb1JlbGVhc2VbMF0gKiAxMDAwMCArICggZ2Vja29SZWxlYXNlWzFdIHx8IDAgKSAqIDEwMCArICggZ2Vja29SZWxlYXNlWzJdIHx8IDAgKSAqIDE7DQogICAgICAgIH0NCiAgICB9DQogICAgLyoqDQogICAgICog5qOA5rWL5rWP6KeI5Zmo5piv5ZCm5Li6Y2hyb21lDQogICAgICogQG5hbWUgY2hyb21lDQogICAgICogQGdyYW1tYXIgICAgIFVFLmJyb3dzZXIuY2hyb21lICA9PiB0cnVlfGZhbHNlDQogICAgICovDQogICAgaWYgKC9jaHJvbWVcLyhcZCtcLlxkKS9pLnRlc3QoYWdlbnQpKSB7DQogICAgICAgIGJyb3dzZXIuY2hyb21lID0gKyBSZWdFeHBbJ1x4MjQxJ107DQogICAgfQ0KICAgIC8qKg0KICAgICAqIOajgOa1i+a1j+iniOWZqOaYr+WQpuS4unNhZmFyaQ0KICAgICAqIEBuYW1lIHNhZmFyaQ0KICAgICAqIEBncmFtbWFyICAgICBVRS5icm93c2VyLnNhZmFyaSAgPT4gdHJ1ZXxmYWxzZQ0KICAgICAqLw0KICAgIGlmKC8oXGQrXC5cZCk/KD86XC5cZCk/XHMrc2FmYXJpXC8/KFxkK1wuXGQrKT8vaS50ZXN0KGFnZW50KSAmJiAhL2Nocm9tZS9pLnRlc3QoYWdlbnQpKXsNCiAgICAJYnJvd3Nlci5zYWZhcmkgPSArIChSZWdFeHBbJ1x4MjQxJ10gfHwgUmVnRXhwWydceDI0MiddKTsNCiAgICB9DQoNCg0KICAgIC8vIE9wZXJhIDkuNTArDQogICAgaWYgKCBicm93c2VyLm9wZXJhICkNCiAgICAgICAgdmVyc2lvbiA9IHBhcnNlRmxvYXQoIG9wZXJhLnZlcnNpb24oKSApOw0KDQogICAgLy8gV2ViS2l0IDUyMisgKFNhZmFyaSAzKykNCiAgICBpZiAoIGJyb3dzZXIud2Via2l0ICkNCiAgICAgICAgdmVyc2lvbiA9IHBhcnNlRmxvYXQoIGFnZW50Lm1hdGNoKCAvIGFwcGxld2Via2l0XC8oXGQrKS8gKVsxXSApOw0KDQogICAgLyoqDQogICAgICog5rWP6KeI5Zmo54mI5pys5Yik5patDQogICAgICogSUXns7vliJfov5Tlm57lgLzkuLo1LDYsNyw4LDksMTDnrYkNCiAgICAgKiBnZWNrb+ezu+WIl+S8mui/lOWbnjEwOTAw77yMMTU4OTAw562JLg0KICAgICAqIHdlYmtpdOezu+WIl+S8mui/lOWbnuWFtmJ1aWxk5Y+3ICjlpoIgNTIy562JKS4NCiAgICAgKiBAbmFtZSB2ZXJzaW9uDQogICAgICogQGdyYW1tYXIgICAgIFVFLmJyb3dzZXIudmVyc2lvbiAgPT4gbnVtYmVyDQogICAgICogQGV4YW1wbGUNCiAgICAgKiBpZiAoIFVFLmJyb3dzZXIuaWUgJiYgVUUuYnJvd3Nlci52ZXJzaW9uID09IDYgKXsNCiAgICAgKiAgICAgYWxlcnQoICJPdWNoIeWxheeEtuaYr+S4h+aBtueahElFNiEiICk7DQogICAgICogfQ0KICAgICAqLw0KICAgIGJyb3dzZXIudmVyc2lvbiA9IHZlcnNpb247DQoNCiAgICAvKioNCiAgICAgKiDmmK/lkKbmmK/lhbzlrrnmqKHlvI/nmoTmtY/op4jlmagNCiAgICAgKiBAbmFtZSBpc0NvbXBhdGlibGUNCiAgICAgKiBAZ3JhbW1hciAgVUUuYnJvd3Nlci5pc0NvbXBhdGlibGUgID0+IHRydWV8ZmFsc2UNCiAgICAgKiBAZXhhbXBsZQ0KICAgICAqIGlmICggVUUuYnJvd3Nlci5pc0NvbXBhdGlibGUgKXsNCiAgICAgKiAgICAgYWxlcnQoICLkvaDnmoTmtY/op4jlmajnm7jlvZPkuI3plJnlk6bvvIEiICk7DQogICAgICogfQ0KICAgICAqLw0KICAgIGJyb3dzZXIuaXNDb21wYXRpYmxlID0NCiAgICAgICAgIWJyb3dzZXIubW9iaWxlICYmICgNCiAgICAgICAgKCBicm93c2VyLmllICYmIHZlcnNpb24gPj0gNiApIHx8DQogICAgICAgICggYnJvd3Nlci5nZWNrbyAmJiB2ZXJzaW9uID49IDEwODAxICkgfHwNCiAgICAgICAgKCBicm93c2VyLm9wZXJhICYmIHZlcnNpb24gPj0gOS41ICkgfHwNCiAgICAgICAgKCBicm93c2VyLmFpciAmJiB2ZXJzaW9uID49IDEgKSB8fA0KICAgICAgICAoIGJyb3dzZXIud2Via2l0ICYmIHZlcnNpb24gPj0gNTIyICkgfHwNCiAgICAgICAgZmFsc2UgKTsNCiAgICByZXR1cm4gYnJvd3NlcjsNCn0oKTsNCi8v5b+r5o235pa55byPDQp2YXIgaWUgPSBicm93c2VyLmllLA0KICAgIHdlYmtpdCA9IGJyb3dzZXIud2Via2l0LA0KICAgIGdlY2tvID0gYnJvd3Nlci5nZWNrbywNCiAgICBvcGVyYSA9IGJyb3dzZXIub3BlcmE7Ci8qKg0KICogQGZpbGUNCiAqIEBuYW1lIFVFLlV0aWxzDQogKiBAc2hvcnQgVXRpbHMNCiAqIEBkZXNjIFVFZGl0b3LlsIHoo4Xkvb/nlKjnmoTpnZnmgIHlt6Xlhbflh73mlbANCiAqIEBpbXBvcnQgZWRpdG9yLmpzDQogKi8NCnZhciB1dGlscyA9IFVFLnV0aWxzID0gew0KICAgIC8qKg0KICAgICAqIOmBjeWOhuaVsOe7hO+8jOWvueixoe+8jG5vZGVMaXN0DQogICAgICogQG5hbWUgZWFjaA0KICAgICAqIEBncmFtbWFyIFVFLnV0aWxzLmVhY2gob2JqLGl0ZXJhdG9yLFtjb250ZXh0XSkNCiAgICAgKiBAc2luY2UgMS4yLjQrDQogICAgICogQGRlc2MNCiAgICAgKiAqIG9iaiDopoHpgY3ljobnmoTlr7nosaENCiAgICAgKiAqIGl0ZXJhdG9yIOmBjeWOhueahOaWueazlSzmlrnms5XnmoTnrKzkuIDkuKrmmK/pgY3ljobnmoTlgLzvvIznrKzkuozkuKrmmK/ntKLlvJXvvIznrKzkuInkuKrmmK9vYmoNCiAgICAgKiAqIGNvbnRleHQgIGl0ZXJhdG9y55qE5LiK5LiL5paHDQogICAgICogQGV4YW1wbGUNCiAgICAgKiBVRS51dGlscy5lYWNoKFsxLDJdLGZ1bmN0aW9uKHYsaSl7DQogICAgICogICAgIGNvbnNvbGUubG9nKHYpLy/lgLwNCiAgICAgKiAgICAgY29uc29sZS5sb2coaSkvL+e0ouW8lQ0KICAgICAqIH0pDQogICAgICogVUUudXRpbHMuZWFjaChkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnKicpLGZ1bmN0aW9uKG4pew0KICAgICAqICAgICBjb25zb2xlLmxvZyhuLnRhZ05hbWUpDQogICAgICogfSkNCiAgICAgKi8NCiAgICBlYWNoIDogZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgY29udGV4dCkgew0KICAgICAgICBpZiAob2JqID09IG51bGwpIHJldHVybjsNCiAgICAgICAgaWYgKG9iai5sZW5ndGggPT09ICtvYmoubGVuZ3RoKSB7DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IG9iai5sZW5ndGg7IGkgPCBsOyBpKyspIHsNCiAgICAgICAgICAgICAgICBpZihpdGVyYXRvci5jYWxsKGNvbnRleHQsIG9ialtpXSwgaSwgb2JqKSA9PT0gZmFsc2UpDQogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsNCiAgICAgICAgICAgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KGtleSkpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYoaXRlcmF0b3IuY2FsbChjb250ZXh0LCBvYmpba2V5XSwga2V5LCBvYmopID09PSBmYWxzZSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9LA0KDQogICAgbWFrZUluc3RhbmNlOmZ1bmN0aW9uIChvYmopIHsNCiAgICAgICAgdmFyIG5vb3AgPSBuZXcgRnVuY3Rpb24oKTsNCiAgICAgICAgbm9vcC5wcm90b3R5cGUgPSBvYmo7DQogICAgICAgIG9iaiA9IG5ldyBub29wOw0KICAgICAgICBub29wLnByb3RvdHlwZSA9IG51bGw7DQogICAgICAgIHJldHVybiBvYmo7DQogICAgfSwNCiAgICAvKioNCiAgICAgKiDlsIZzb3VyY2Xlr7nosaHkuK3nmoTlsZ7mgKfmianlsZXliLB0YXJnZXTlr7nosaHkuIoNCiAgICAgKiBAbmFtZSBleHRlbmQNCiAgICAgKiBAZ3JhbW1hciBVRS51dGlscy5leHRlbmQodGFyZ2V0LHNvdXJjZSkgID0+IE9iamVjdCAgLy/opobnm5bmianlsZUNCiAgICAgKiBAZ3JhbW1hciBVRS51dGlscy5leHRlbmQodGFyZ2V0LHNvdXJjZSx0cnVlKSAgPT0+IE9iamVjdCAgLy/kv53nlZnmianlsZUNCiAgICAgKi8NCiAgICBleHRlbmQ6ZnVuY3Rpb24gKHQsIHMsIGIpIHsNCiAgICAgICAgaWYgKHMpIHsNCiAgICAgICAgICAgIGZvciAodmFyIGsgaW4gcykgew0KICAgICAgICAgICAgICAgIGlmICghYiB8fCAhdC5oYXNPd25Qcm9wZXJ0eShrKSkgew0KICAgICAgICAgICAgICAgICAgICB0W2tdID0gc1trXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHQ7DQogICAgfSwNCiAgICBleHRlbmQyOmZ1bmN0aW9uICh0KSB7DQogICAgICAgIHZhciBhID0gYXJndW1lbnRzOw0KICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGEubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIHZhciB4ID0gYVtpXTsNCiAgICAgICAgICAgIGZvciAodmFyIGsgaW4geCkgew0KICAgICAgICAgICAgICAgIGlmICghdC5oYXNPd25Qcm9wZXJ0eShrKSkgew0KICAgICAgICAgICAgICAgICAgICB0W2tdID0geFtrXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHQ7DQogICAgfSwNCiAgICAvKioNCiAgICAgKiDmqKHmi5/nu6fmib/mnLrliLbvvIxzdWJDbGFzc+e7p+aJv3N1cGVyQ2xhc3MNCiAgICAgKiBAbmFtZSBpbmhlcml0cw0KICAgICAqIEBncmFtbWFyIFVFLnV0aWxzLmluaGVyaXRzKHN1YkNsYXNzLHN1cGVyQ2xhc3MpID0+IHN1YkNsYXNzDQogICAgICogQGV4YW1wbGUNCiAgICAgKiBmdW5jdGlvbiBTdXBlckNsYXNzKCl7DQogICAgICogICAgIHRoaXMubmFtZSA9ICLlsI/mnY4iOw0KICAgICAqIH0NCiAgICAgKiBTdXBlckNsYXNzLnByb3RvdHlwZSA9IHsNCiAgICAgKiAgICAgaGVsbG86ZnVuY3Rpb24oc3RyKXsNCiAgICAgKiAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMubmFtZSArIHN0cik7DQogICAgICogICAgIH0NCiAgICAgKiB9DQogICAgICogZnVuY3Rpb24gU3ViQ2xhc3MoKXsNCiAgICAgKiAgICAgdGhpcy5uYW1lID0gIuWwj+W8oCI7DQogICAgICogfQ0KICAgICAqIFVFLnV0aWxzLmluaGVyaXRzKFN1YkNsYXNzLFN1cGVyQ2xhc3MpOw0KICAgICAqIHZhciBzdWIgPSBuZXcgU3ViQ2xhc3MoKTsNCiAgICAgKiBzdWIuaGVsbG8oIuaXqeS4iuWlvSEiKTsgPT0+ICLlsI/lvKDml6nkuIrlpb3vvIEiDQogICAgICovDQogICAgaW5oZXJpdHM6ZnVuY3Rpb24gKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7DQogICAgICAgIHZhciBvbGRQID0gc3ViQ2xhc3MucHJvdG90eXBlLA0KICAgICAgICAgICAgbmV3UCA9IHV0aWxzLm1ha2VJbnN0YW5jZShzdXBlckNsYXNzLnByb3RvdHlwZSk7DQogICAgICAgIHV0aWxzLmV4dGVuZChuZXdQLCBvbGRQLCB0cnVlKTsNCiAgICAgICAgc3ViQ2xhc3MucHJvdG90eXBlID0gbmV3UDsNCiAgICAgICAgcmV0dXJuIChuZXdQLmNvbnN0cnVjdG9yID0gc3ViQ2xhc3MpOw0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiDnlKjmjIflrprnmoRjb250ZXh05L2c5Li6Zm7kuIrkuIvmlofvvIzkuZ/lsLHmmK90aGlzDQogICAgICogQG5hbWUgYmluZA0KICAgICAqIEBncmFtbWFyIFVFLnV0aWxzLmJpbmQoZm4sY29udGV4dCkgID0+ICBmbg0KICAgICAqLw0KICAgIGJpbmQ6ZnVuY3Rpb24gKGZuLCBjb250ZXh0KSB7DQogICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICByZXR1cm4gZm4uYXBwbHkoY29udGV4dCwgYXJndW1lbnRzKTsNCiAgICAgICAgfTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICog5Yib5bu65bu26L+fZGVsYXnmiafooYznmoTlh73mlbBmbg0KICAgICAqIEBuYW1lIGRlZmVyDQogICAgICogQGdyYW1tYXIgVUUudXRpbHMuZGVmZXIoZm4sZGVsYXkpICA9PmZuICAgLy/lu7bov59kZWxheeavq+enkuaJp+ihjGZu77yM6L+U5ZueZm4NCiAgICAgKiBAZ3JhbW1hciBVRS51dGlscy5kZWZlcihmbixkZWxheSxleGNsdXNpb24pICA9PmZuICAgLy/lu7bov59kZWxheeavq+enkuaJp+ihjGZu77yM6IulZXhjbHVzaW9u5Li655yf77yM5YiZ5LqS5pal5omn6KGMZm4NCiAgICAgKiBAZXhhbXBsZQ0KICAgICAqIGZ1bmN0aW9uIHRlc3QoKXsNCiAgICAgKiAgICAgY29uc29sZS5sb2coIuW7tui/n+i+k+WHuu+8gSIpOw0KICAgICAqIH0NCiAgICAgKiAvL+mdnuS6kuaWpeW7tui/n+aJp+ihjA0KICAgICAqIHZhciB0ZXN0RGVmZXIgPSBVRS51dGlscy5kZWZlcih0ZXN0LDEwMDApOw0KICAgICAqIHRlc3REZWZlcigpOyAgID0+ICAi5bu26L+f6L6T5Ye677yBIjsNCiAgICAgKiB0ZXN0RGVmZXIoKTsgICA9PiAgIuW7tui/n+i+k+WHuu+8gSI7DQogICAgICogLy/kupLmlqXlu7bov5/miafooYwNCiAgICAgKiB2YXIgdGVzdERlZmVyMSA9IFVFLnV0aWxzLmRlZmVyKHRlc3QsMTAwMCx0cnVlKTsNCiAgICAgKiB0ZXN0RGVmZXIxKCk7ICAgPT4gIC8v5pys5qyh5LiN5omn6KGMDQogICAgICogdGVzdERlZmVyMSgpOyAgID0+ICAi5bu26L+f6L6T5Ye677yBIjsNCiAgICAgKi8NCiAgICBkZWZlcjpmdW5jdGlvbiAoZm4sIGRlbGF5LCBleGNsdXNpb24pIHsNCiAgICAgICAgdmFyIHRpbWVySUQ7DQogICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBpZiAoZXhjbHVzaW9uKSB7DQogICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVySUQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGltZXJJRCA9IHNldFRpbWVvdXQoZm4sIGRlbGF5KTsNCiAgICAgICAgfTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICog5p+l5om+5YWD57SgaXRlbeWcqOaVsOe7hGFycmF55Lit55qE57Si5byVLCDoi6Xmib7kuI3liLDov5Tlm54tMQ0KICAgICAqIEBuYW1lIGluZGV4T2YNCiAgICAgKiBAZ3JhbW1hciBVRS51dGlscy5pbmRleE9mKGFycmF5LGl0ZW0pICA9PiBpbmRleHwtMSAgLy/pu5jorqTku47mlbDnu4TlvIDlpLTpg6jlvIDlp4vmkJzntKINCiAgICAgKiBAZ3JhbW1hciBVRS51dGlscy5pbmRleE9mKGFycmF5LGl0ZW0sc3RhcnQpICA9PiBpbmRleHwtMSAgLy9zdGFydOaMh+WumuW8gOWni+afpeaJvueahOS9jee9rg0KICAgICAqLw0KICAgIGluZGV4T2Y6ZnVuY3Rpb24gKGFycmF5LCBpdGVtLCBzdGFydCkgew0KICAgICAgICB2YXIgaW5kZXggPSAtMTsNCiAgICAgICAgc3RhcnQgPSB0aGlzLmlzTnVtYmVyKHN0YXJ0KSA/IHN0YXJ0IDogMDsNCiAgICAgICAgdGhpcy5lYWNoKGFycmF5LCBmdW5jdGlvbiAodiwgaSkgew0KICAgICAgICAgICAgaWYgKGkgPj0gc3RhcnQgJiYgdiA9PT0gaXRlbSkgew0KICAgICAgICAgICAgICAgIGluZGV4ID0gaTsNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgICAgICByZXR1cm4gaW5kZXg7DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIOenu+mZpOaVsOe7hGFycmF55Lit55qE5YWD57SgaXRlbQ0KICAgICAqIEBuYW1lIHJlbW92ZUl0ZW0NCiAgICAgKiBAZ3JhbW1hciBVRS51dGlscy5yZW1vdmVJdGVtKGFycmF5LGl0ZW0pDQogICAgICovDQogICAgcmVtb3ZlSXRlbTpmdW5jdGlvbiAoYXJyYXksIGl0ZW0pIHsNCiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBhcnJheS5sZW5ndGg7IGkgPCBsOyBpKyspIHsNCiAgICAgICAgICAgIGlmIChhcnJheVtpXSA9PT0gaXRlbSkgew0KICAgICAgICAgICAgICAgIGFycmF5LnNwbGljZShpLCAxKTsNCiAgICAgICAgICAgICAgICBpLS07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9LA0KDQogICAgLyoqDQogICAgICog5Yig6Zmk5a2X56ym5Liyc3Ry55qE6aaW5bC+56m65qC8DQogICAgICogQG5hbWUgdHJpbQ0KICAgICAqIEBncmFtbWFyIFVFLnV0aWxzLnRyaW0oc3RyKSA9PiBTdHJpbmcNCiAgICAgKi8NCiAgICB0cmltOmZ1bmN0aW9uIChzdHIpIHsNCiAgICAgICAgcmV0dXJuIHN0ci5yZXBsYWNlKC8oXlsgXHRcblxyXSspfChbIFx0XG5ccl0rJCkvZywgJycpOw0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiDlsIblrZfnrKbkuLJsaXN0KOS7pScsJ+WIhumalCnmiJbogIXmlbDnu4RsaXN06L2s5oiQ5ZOI5biM5a+56LGhDQogICAgICogQG5hbWUgbGlzdFRvTWFwDQogICAgICogQGdyYW1tYXIgVUUudXRpbHMubGlzdFRvTWFwKGxpc3QpICA9PiBPYmplY3QgIC8vT2JqZWN05b2i5aaCe3Rlc3Q6MSxicjoxLHRleHRhcmVhOjF9DQogICAgICovDQogICAgbGlzdFRvTWFwOmZ1bmN0aW9uIChsaXN0KSB7DQogICAgICAgIGlmICghbGlzdClyZXR1cm4ge307DQogICAgICAgIGxpc3QgPSB1dGlscy5pc0FycmF5KGxpc3QpID8gbGlzdCA6IGxpc3Quc3BsaXQoJywnKTsNCiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNpLCBvYmogPSB7fTsgY2kgPSBsaXN0W2krK107KSB7DQogICAgICAgICAgICBvYmpbY2kudG9VcHBlckNhc2UoKV0gPSBvYmpbY2ldID0gMTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gb2JqOw0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiDlsIZzdHLkuK3nmoRodG1s56ym5Y+36L2s5LmJLOm7mOiupOWwhui9rOS5iScnJjwiPicn5Zub5Liq5a2X56ym77yM5Y+v6Ieq5a6a5LmJcmVn5p2l56Gu5a6a6ZyA6KaB6L2s5LmJ55qE5a2X56ymDQogICAgICogQG5hbWUgdW5odG1sDQogICAgICogQGdyYW1tYXIgVUUudXRpbHMudW5odG1sKHN0cik7ICA9PiBTdHJpbmcNCiAgICAgKiBAZ3JhbW1hciBVRS51dGlscy51bmh0bWwoc3RyLHJlZykgID0+IFN0cmluZw0KICAgICAqIEBleGFtcGxlDQogICAgICogdmFyIGh0bWwgPSAnPGJvZHk+WW91IHNheToi5L2g5aW977yBQmFpZHUgJiBVRWRpdG9yISI8L2JvZHk+JzsNCiAgICAgKiBVRS51dGlscy51bmh0bWwoaHRtbCk7ICAgPT0+ICAmbHQ7Ym9keSZndDtZb3Ugc2F5OiZxdW90O+S9oOWlve+8gUJhaWR1ICZhbXA7IFVFZGl0b3IhJnF1b3Q7Jmx0Oy9ib2R5Jmd0Ow0KICAgICAqIFVFLnV0aWxzLnVuaHRtbChodG1sLC9bPD5dL2cpICA9PT4gICZsdDtib2R5Jmd0O1lvdSBzYXk6IuS9oOWlve+8gUJhaWR1ICYgVUVkaXRvciEiJmx0Oy9ib2R5Jmd0Ow0KICAgICAqLw0KICAgIHVuaHRtbDpmdW5jdGlvbiAoc3RyLCByZWcpIHsNCiAgICAgICAgcmV0dXJuIHN0ciA/IHN0ci5yZXBsYWNlKHJlZyB8fCAvWyY8Ij4nXSg/OihhbXB8bHR8cXVvdHxndHwjMzl8bmJzcCk7KT8vZywgZnVuY3Rpb24gKGEsIGIpIHsNCiAgICAgICAgICAgIGlmIChiKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGE7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgICAgICc8JzonJmx0OycsDQogICAgICAgICAgICAgICAgICAgICcmJzonJmFtcDsnLA0KICAgICAgICAgICAgICAgICAgICAnIic6JyZxdW90OycsDQogICAgICAgICAgICAgICAgICAgICc+JzonJmd0OycsDQogICAgICAgICAgICAgICAgICAgICInIjonJiMzOTsnDQogICAgICAgICAgICAgICAgfVthXQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0pIDogJyc7DQogICAgfSwNCiAgICAvKioNCiAgICAgKiDlsIZzdHLkuK3nmoTovazkuYnlrZfnrKbov5jljp/miJBodG1s5a2X56ymDQogICAgICogQG5hbWUgaHRtbA0KICAgICAqIEBncmFtbWFyIFVFLnV0aWxzLmh0bWwoc3RyKSAgPT4gU3RyaW5nICAgLy/or6bnu4blj4Lop4E8Y29kZT48YSBocmVmID0gJyN1bmh0bWwnPnVuaHRtbDwvYT48L2NvZGU+DQogICAgICovDQogICAgaHRtbDpmdW5jdGlvbiAoc3RyKSB7DQogICAgICAgIHJldHVybiBzdHIgPyBzdHIucmVwbGFjZSgvJigoZ3xsfHF1byl0fGFtcHwjMzkpOy9nLCBmdW5jdGlvbiAobSkgew0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAnJmx0Oyc6JzwnLA0KICAgICAgICAgICAgICAgICcmYW1wOyc6JyYnLA0KICAgICAgICAgICAgICAgICcmcXVvdDsnOiciJywNCiAgICAgICAgICAgICAgICAnJmd0Oyc6Jz4nLA0KICAgICAgICAgICAgICAgICcmIzM5Oyc6IiciDQogICAgICAgICAgICB9W21dDQogICAgICAgIH0pIDogJyc7DQogICAgfSwNCiAgICAvKioNCiAgICAgKiDlsIZjc3PmoLflvI/ovazmjaLkuLrpqbzls7DnmoTlvaLlvI/jgILlpoJmb250LXNpemUgPT4gZm9udFNpemUNCiAgICAgKiBAbmFtZSBjc3NTdHlsZVRvRG9tU3R5bGUNCiAgICAgKiBAZ3JhbW1hciBVRS51dGlscy5jc3NTdHlsZVRvRG9tU3R5bGUoY3NzTmFtZSkgID0+IFN0cmluZw0KICAgICAqLw0KICAgIGNzc1N0eWxlVG9Eb21TdHlsZTpmdW5jdGlvbiAoKSB7DQogICAgICAgIHZhciB0ZXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jykuc3R5bGUsDQogICAgICAgICAgICBjYWNoZSA9IHsNCiAgICAgICAgICAgICAgICAnZmxvYXQnOnRlc3QuY3NzRmxvYXQgIT0gdW5kZWZpbmVkID8gJ2Nzc0Zsb2F0JyA6IHRlc3Quc3R5bGVGbG9hdCAhPSB1bmRlZmluZWQgPyAnc3R5bGVGbG9hdCcgOiAnZmxvYXQnDQogICAgICAgICAgICB9Ow0KDQogICAgICAgIHJldHVybiBmdW5jdGlvbiAoY3NzTmFtZSkgew0KICAgICAgICAgICAgcmV0dXJuIGNhY2hlW2Nzc05hbWVdIHx8IChjYWNoZVtjc3NOYW1lXSA9IGNzc05hbWUudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC8tLi9nLCBmdW5jdGlvbiAobWF0Y2gpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2guY2hhckF0KDEpLnRvVXBwZXJDYXNlKCk7DQogICAgICAgICAgICB9KSk7DQogICAgICAgIH07DQogICAgfSgpLA0KICAgIC8qKg0KICAgICAqIOWKqOaAgeWKoOi9veaWh+S7tuWIsGRvY+S4re+8jOW5tuS+neaNrm9iauadpeiuvue9ruWxnuaAp++8jOWKoOi9veaIkOWKn+WQjuaJp+ihjOWbnuiwg+WHveaVsGZuDQogICAgICogQG5hbWUgbG9hZEZpbGUNCiAgICAgKiBAZ3JhbW1hciBVRS51dGlscy5sb2FkRmlsZShkb2Msb2JqKQ0KICAgICAqIEBncmFtbWFyIFVFLnV0aWxzLmxvYWRGaWxlKGRvYyxvYmosZm4pDQogICAgICogQGV4YW1wbGUNCiAgICAgKiAvL+aMh+WumuWKoOi9veWIsOW9k+WJjWRvY3VtZW505Lit5LiA5Liqc2NyaXB05paH5Lu277yM5Yqg6L295oiQ5Yqf5ZCO5omn6KGMZnVuY3Rpb24NCiAgICAgKiB1dGlscy5sb2FkRmlsZSggZG9jdW1lbnQsIHsNCiAgICAgKiAgICAgc3JjOiJ0ZXN0LmpzIiwNCiAgICAgKiAgICAgdGFnOiJzY3JpcHQiLA0KICAgICAqICAgICB0eXBlOiJ0ZXh0L2phdmFzY3JpcHQiLA0KICAgICAqICAgICBkZWZlcjoiZGVmZXIiDQogICAgICogfSwgZnVuY3Rpb24gKCkgew0KICAgICAqICAgICBjb25zb2xlLmxvZygn5Yqg6L295oiQ5Yqf77yBJykNCiAgICAgKiB9KTsNCiAgICAgKi8NCiAgICBsb2FkRmlsZTpmdW5jdGlvbiAoKSB7DQogICAgICAgIHZhciB0bXBMaXN0ID0gW107DQoNCiAgICAgICAgZnVuY3Rpb24gZ2V0SXRlbShkb2MsIG9iaikgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgY2k7IGNpID0gdG1wTGlzdFtpKytdOykgew0KICAgICAgICAgICAgICAgICAgICBpZiAoY2kuZG9jID09PSBkb2MgJiYgY2kudXJsID09IChvYmouc3JjIHx8IG9iai5ocmVmKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGRvYywgb2JqLCBmbikgew0KICAgICAgICAgICAgdmFyIGl0ZW0gPSBnZXRJdGVtKGRvYywgb2JqKTsNCiAgICAgICAgICAgIGlmIChpdGVtKSB7DQogICAgICAgICAgICAgICAgaWYgKGl0ZW0ucmVhZHkpIHsNCiAgICAgICAgICAgICAgICAgICAgZm4gJiYgZm4oKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBpdGVtLmZ1bnMucHVzaChmbikNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdG1wTGlzdC5wdXNoKHsNCiAgICAgICAgICAgICAgICBkb2M6ZG9jLA0KICAgICAgICAgICAgICAgIHVybDpvYmouc3JjIHx8IG9iai5ocmVmLA0KICAgICAgICAgICAgICAgIGZ1bnM6W2ZuXQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICBpZiAoIWRvYy5ib2R5KSB7DQogICAgICAgICAgICAgICAgdmFyIGh0bWwgPSBbXTsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBwIGluIG9iaikgew0KICAgICAgICAgICAgICAgICAgICBpZiAocCA9PSAndGFnJyljb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgaHRtbC5wdXNoKHAgKyAnPSInICsgb2JqW3BdICsgJyInKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBkb2Mud3JpdGUoJzwnICsgb2JqLnRhZyArICcgJyArIGh0bWwuam9pbignICcpICsgJyA+PC8nICsgb2JqLnRhZyArICc+Jyk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKG9iai5pZCAmJiBkb2MuZ2V0RWxlbWVudEJ5SWQob2JqLmlkKSkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZG9jLmNyZWF0ZUVsZW1lbnQob2JqLnRhZyk7DQogICAgICAgICAgICBkZWxldGUgb2JqLnRhZzsNCiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gb2JqKSB7DQogICAgICAgICAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUocCwgb2JqW3BdKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsZW1lbnQub25sb2FkID0gZWxlbWVudC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgaWYgKCF0aGlzLnJlYWR5U3RhdGUgfHwgL2xvYWRlZHxjb21wbGV0ZS8udGVzdCh0aGlzLnJlYWR5U3RhdGUpKSB7DQogICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBnZXRJdGVtKGRvYywgb2JqKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uZnVucy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnJlYWR5ID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGZpOyBmaSA9IGl0ZW0uZnVucy5wb3AoKTspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQub25sb2FkID0gZWxlbWVudC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH07DQogICAgICAgICAgICBlbGVtZW50Lm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ1RoZSBsb2FkICcgKyAob2JqLmhyZWYgfHwgb2JqLnNyYykgKyAnIGZhaWxzLGNoZWNrIHRoZSB1cmwgc2V0dGluZ3Mgb2YgZmlsZSB1ZWRpdG9yLmNvbmZpZy5qcyAnKQ0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIGRvYy5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaGVhZCIpWzBdLmFwcGVuZENoaWxkKGVsZW1lbnQpOw0KICAgICAgICB9DQogICAgfSgpLA0KICAgIC8qKg0KICAgICAqIOWIpOaWrW9iauWvueixoeaYr+WQpuS4uuepug0KICAgICAqIEBuYW1lIGlzRW1wdHlPYmplY3QNCiAgICAgKiBAZ3JhbW1hciBVRS51dGlscy5pc0VtcHR5T2JqZWN0KG9iaikgID0+IHRydWV8ZmFsc2UNCiAgICAgKiBAZXhhbXBsZQ0KICAgICAqIFVFLnV0aWxzLmlzRW1wdHlPYmplY3Qoe30pID09PnRydWUNCiAgICAgKiBVRS51dGlscy5pc0VtcHR5T2JqZWN0KFtdKSA9PT50cnVlDQogICAgICogVUUudXRpbHMuaXNFbXB0eU9iamVjdCgiIikgPT0+dHJ1ZQ0KICAgICAqLw0KICAgIGlzRW1wdHlPYmplY3Q6ZnVuY3Rpb24gKG9iaikgew0KICAgICAgICBpZiAob2JqID09IG51bGwpIHJldHVybiB0cnVlOw0KICAgICAgICBpZiAodGhpcy5pc0FycmF5KG9iaikgfHwgdGhpcy5pc1N0cmluZyhvYmopKSByZXR1cm4gb2JqLmxlbmd0aCA9PT0gMDsNCiAgICAgICAgZm9yICh2YXIga2V5IGluIG9iaikgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSByZXR1cm4gZmFsc2U7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiDnu5/kuIDlsIbpopzoibLlgLzkvb/nlKgxNui/m+WItuW9ouW8j+ihqOekug0KICAgICAqIEBuYW1lIGZpeENvbG9yDQogICAgICogQGdyYW1tYXIgVUUudXRpbHMuZml4Q29sb3IobmFtZSx2YWx1ZSkgPT4gdmFsdWUNCiAgICAgKiBAZXhhbXBsZQ0KICAgICAqIHJnYigyNTUsMjU1LDI1NSkgID0+ICIjZmZmZmZmIg0KICAgICAqLw0KICAgIGZpeENvbG9yOmZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkgew0KICAgICAgICBpZiAoL2NvbG9yL2kudGVzdChuYW1lKSAmJiAvcmdiYT8vLnRlc3QodmFsdWUpKSB7DQogICAgICAgICAgICB2YXIgYXJyYXkgPSB2YWx1ZS5zcGxpdCgiLCIpOw0KICAgICAgICAgICAgaWYgKGFycmF5Lmxlbmd0aCA+IDMpDQogICAgICAgICAgICAgICAgcmV0dXJuICIiOw0KICAgICAgICAgICAgdmFsdWUgPSAiIyI7DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgY29sb3I7IGNvbG9yID0gYXJyYXlbaSsrXTspIHsNCiAgICAgICAgICAgICAgICBjb2xvciA9IHBhcnNlSW50KGNvbG9yLnJlcGxhY2UoL1teXGRdL2dpLCAnJyksIDEwKS50b1N0cmluZygxNik7DQogICAgICAgICAgICAgICAgdmFsdWUgKz0gY29sb3IubGVuZ3RoID09IDEgPyAiMCIgKyBjb2xvciA6IGNvbG9yOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS50b1VwcGVyQ2FzZSgpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiAgdmFsdWU7DQogICAgfSwNCiAgICAvKioNCiAgICAgKiDlj6rpkojlr7lib3JkZXIscGFkZGluZyxtYXJnaW7lgZrkuoblpITnkIbvvIzlm6DkuLrmgKfog73pl67popgNCiAgICAgKiBAcHVibGljDQogICAgICogQGZ1bmN0aW9uDQogICAgICogQHBhcmFtIHtTdHJpbmd9ICAgIHZhbCBzdHlsZeWtl+espuS4sg0KICAgICAqLw0KICAgIG9wdENzczpmdW5jdGlvbiAodmFsKSB7DQogICAgICAgIHZhciBwYWRkaW5nLCBtYXJnaW4sIGJvcmRlcjsNCiAgICAgICAgdmFsID0gdmFsLnJlcGxhY2UoLyhwYWRkaW5nfG1hcmdpbnxib3JkZXIpXC0oW146XSspOihbXjtdKyk7Py9naSwgZnVuY3Rpb24gKHN0ciwga2V5LCBuYW1lLCB2YWwpIHsNCiAgICAgICAgICAgIGlmICh2YWwuc3BsaXQoJyAnKS5sZW5ndGggPT0gMSkgew0KICAgICAgICAgICAgICAgIHN3aXRjaCAoa2V5KSB7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgJ3BhZGRpbmcnOg0KICAgICAgICAgICAgICAgICAgICAgICAgIXBhZGRpbmcgJiYgKHBhZGRpbmcgPSB7fSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nW25hbWVdID0gdmFsOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICAgICAgICAgICAgICBjYXNlICdtYXJnaW4nOg0KICAgICAgICAgICAgICAgICAgICAgICAgIW1hcmdpbiAmJiAobWFyZ2luID0ge30pOw0KICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luW25hbWVdID0gdmFsOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICAgICAgICAgICAgICBjYXNlICdib3JkZXInOg0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbCA9PSAnaW5pdGlhbCcgPyAnJyA6IHN0cjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gc3RyOw0KICAgICAgICB9KTsNCg0KICAgICAgICBmdW5jdGlvbiBvcHQob2JqLCBuYW1lKSB7DQogICAgICAgICAgICBpZiAoIW9iaikgew0KICAgICAgICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZhciB0ID0gb2JqLnRvcCAsIGIgPSBvYmouYm90dG9tLCBsID0gb2JqLmxlZnQsIHIgPSBvYmoucmlnaHQsIHZhbCA9ICcnOw0KICAgICAgICAgICAgaWYgKCF0IHx8ICFsIHx8ICFiIHx8ICFyKSB7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBvYmopIHsNCiAgICAgICAgICAgICAgICAgICAgdmFsICs9ICc7JyArIG5hbWUgKyAnLScgKyBwICsgJzonICsgb2JqW3BdICsgJzsnOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdmFsICs9ICc7JyArIG5hbWUgKyAnOicgKw0KICAgICAgICAgICAgICAgICAgICAodCA9PSBiICYmIGIgPT0gbCAmJiBsID09IHIgPyB0IDoNCiAgICAgICAgICAgICAgICAgICAgICAgIHQgPT0gYiAmJiBsID09IHIgPyAodCArICcgJyArIGwpIDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsID09IHIgPyAodCArICcgJyArIGwgKyAnICcgKyBiKSA6ICh0ICsgJyAnICsgciArICcgJyArIGIgKyAnICcgKyBsKSkgKyAnOycNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiB2YWw7DQogICAgICAgIH0NCg0KICAgICAgICB2YWwgKz0gb3B0KHBhZGRpbmcsICdwYWRkaW5nJykgKyBvcHQobWFyZ2luLCAnbWFyZ2luJyk7DQogICAgICAgIHJldHVybiB2YWwucmVwbGFjZSgvXlsgXG5cclx0O10qfFsgXG5cclx0XSokLywgJycpLnJlcGxhY2UoLzsoWyBcblxyXHRdKyl8XDE7L2csICc7JykNCiAgICAgICAgICAgIC5yZXBsYWNlKC8oJigobHxnKXR8cXVvdHwjMzkpKT87ezIsfS9nLCBmdW5jdGlvbiAoYSwgYikgew0KICAgICAgICAgICAgICAgIHJldHVybiBiID8gYiArICI7OyIgOiAnOycNCiAgICAgICAgICAgIH0pOw0KICAgIH0sDQogICAgLyoqDQogICAgICog5rex5bqm5YWL6ZqG5a+56LGh77yM5LuOc291cmNl5YiwdGFyZ2V0DQogICAgICogQG5hbWUgY2xvbmUNCiAgICAgKiBAZ3JhbW1hciBVRS51dGlscy5jbG9uZShzb3VyY2UpID0+IGFudGhvck9iaiDmlrDnmoTlr7nosaHmmK/lrozmlbTnmoRzb3VyY2XnmoTlia/mnKwNCiAgICAgKiBAZ3JhbW1hciBVRS51dGlscy5jbG9uZShzb3VyY2UsdGFyZ2V0KSA9PiB0YXJnZXTljIXlkKvkuoZzb3VyY2XnmoTmiYDmnInlhoXlrrnvvIzph43lkI3kvJropobnm5YNCiAgICAgKi8NCiAgICBjbG9uZTpmdW5jdGlvbiAoc291cmNlLCB0YXJnZXQpIHsNCiAgICAgICAgdmFyIHRtcDsNCiAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0IHx8IHt9Ow0KICAgICAgICBmb3IgKHZhciBpIGluIHNvdXJjZSkgew0KICAgICAgICAgICAgaWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eShpKSkgew0KICAgICAgICAgICAgICAgIHRtcCA9IHNvdXJjZVtpXTsNCiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRtcCA9PSAnb2JqZWN0Jykgew0KICAgICAgICAgICAgICAgICAgICB0YXJnZXRbaV0gPSB1dGlscy5pc0FycmF5KHRtcCkgPyBbXSA6IHt9Ow0KICAgICAgICAgICAgICAgICAgICB1dGlscy5jbG9uZShzb3VyY2VbaV0sIHRhcmdldFtpXSkNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICB0YXJnZXRbaV0gPSB0bXA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0YXJnZXQ7DQogICAgfSwNCiAgICAvKioNCiAgICAgKiDovazmjaJjbS9wdOWIsHB4DQogICAgICogQG5hbWUgdHJhbnNVbml0VG9QeA0KICAgICAqIEBncmFtbWFyIFVFLnV0aWxzLnRyYW5zVW5pdFRvUHgoJzIwcHQnKSA9PiAnMjdweCcNCiAgICAgKiBAZ3JhbW1hciBVRS51dGlscy50cmFuc1VuaXRUb1B4KCcwcHQnKSA9PiAnMCcNCiAgICAgKi8NCiAgICB0cmFuc1VuaXRUb1B4OmZ1bmN0aW9uICh2YWwpIHsNCiAgICAgICAgaWYgKCEvKHB0fGNtKS8udGVzdCh2YWwpKSB7DQogICAgICAgICAgICByZXR1cm4gdmFsDQogICAgICAgIH0NCiAgICAgICAgdmFyIHVuaXQ7DQogICAgICAgIHZhbC5yZXBsYWNlKC8oW1xkLl0rKShcdyspLywgZnVuY3Rpb24gKHN0ciwgdiwgdSkgew0KICAgICAgICAgICAgdmFsID0gdjsNCiAgICAgICAgICAgIHVuaXQgPSB1Ow0KICAgICAgICB9KTsNCiAgICAgICAgc3dpdGNoICh1bml0KSB7DQogICAgICAgICAgICBjYXNlICdjbSc6DQogICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdCh2YWwpICogMjU7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdwdCc6DQogICAgICAgICAgICAgICAgdmFsID0gTWF0aC5yb3VuZChwYXJzZUZsb2F0KHZhbCkgKiA5NiAvIDcyKTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gdmFsICsgKHZhbCA/ICdweCcgOiAnJyk7DQogICAgfSwNCiAgICAvKioNCiAgICAgKiBEb21SZWFkeeaWueazle+8jOWbnuiwg+WHveaVsOWwhuWcqGRvbeagkXJlYWR55a6M5oiQ5ZCO5omn6KGMDQogICAgICogQG5hbWUgZG9tUmVhZHkNCiAgICAgKiBAZ3JhbW1hciBVRS51dGlscy5kb21SZWFkeShmbikgID0+IGZuICAvL+i/lOWbnuS4gOS4quW7tui/n+aJp+ihjOeahOaWueazlQ0KICAgICAqLw0KICAgIGRvbVJlYWR5OmZ1bmN0aW9uICgpIHsNCg0KICAgICAgICB2YXIgZm5BcnIgPSBbXTsNCg0KICAgICAgICBmdW5jdGlvbiBkb1JlYWR5KGRvYykgew0KICAgICAgICAgICAgLy/noa7kv51vbnJlYWR55Y+q5omn6KGM5LiA5qyhDQogICAgICAgICAgICBkb2MuaXNSZWFkeSA9IHRydWU7DQogICAgICAgICAgICBmb3IgKHZhciBjaTsgY2kgPSBmbkFyci5wb3AoKTsgY2koKSkgew0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChvbnJlYWR5LCB3aW4pIHsNCiAgICAgICAgICAgIHdpbiA9IHdpbiB8fCB3aW5kb3c7DQogICAgICAgICAgICB2YXIgZG9jID0gd2luLmRvY3VtZW50Ow0KICAgICAgICAgICAgb25yZWFkeSAmJiBmbkFyci5wdXNoKG9ucmVhZHkpOw0KICAgICAgICAgICAgaWYgKGRvYy5yZWFkeVN0YXRlID09PSAiY29tcGxldGUiKSB7DQogICAgICAgICAgICAgICAgZG9SZWFkeShkb2MpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBkb2MuaXNSZWFkeSAmJiBkb1JlYWR5KGRvYyk7DQogICAgICAgICAgICAgICAgaWYgKGJyb3dzZXIuaWUpIHsNCiAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb2MuaXNSZWFkeSkgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2MuZG9jdW1lbnRFbGVtZW50LmRvU2Nyb2xsKCJsZWZ0Iik7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoYXJndW1lbnRzLmNhbGxlZSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZG9SZWFkeShkb2MpOw0KICAgICAgICAgICAgICAgICAgICB9KSgpOw0KICAgICAgICAgICAgICAgICAgICB3aW4uYXR0YWNoRXZlbnQoJ29ubG9hZCcsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvUmVhZHkoZG9jKQ0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBkb2MuYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvYy5yZW1vdmVFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIiwgYXJndW1lbnRzLmNhbGxlZSwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZG9SZWFkeShkb2MpOw0KICAgICAgICAgICAgICAgICAgICB9LCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgIHdpbi5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZG9SZWFkeShkb2MpDQogICAgICAgICAgICAgICAgICAgIH0sIGZhbHNlKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KICAgIH0oKSwNCiAgICAvKioNCiAgICAgKiDliqjmgIHmt7vliqBjc3PmoLflvI8NCiAgICAgKiBAbmFtZSBjc3NSdWxlDQogICAgICogQGdyYW1tYXIgVUUudXRpbHMuY3NzUnVsZSgn5re75Yqg55qE5qC35byP55qE6IqC54K55ZCN56ewJyxbJ+agt+W8jyfvvIwn5pS+5Yiw5ZOq5LiqZG9jdW1lbnTkuIonXSkNCiAgICAgKiBAZ3JhbW1hciBVRS51dGlscy5jc3NSdWxlKCdib2R5JywnYm9keXtiYWNrZ3JvdW5kOiNjY2N9JykgPT4gbnVsbCAgLy/nu5lib2R55re75Yqg6IOM5pmv6aKc6ImyDQogICAgICogQGdyYW1tYXIgVUUudXRpbHMuY3NzUnVsZSgnYm9keScpID0+5qC35byP55qE5a2X56ym5LiyICAvL+WPluW+l2tleeWAvOS4umJvZHnnmoTmoLflvI/nmoTlhoXlrrks5aaC5p6c5rKh5pyJ5om+5Yiwa2V55YC85YWI5YWz55qE5qC35byP5bCG6L+U5Zue56m677yM5L6L5aaC5Yia5omN6YKj5Liq6IOM5pmv6aKc6Imy77yM5bCG6L+U5ZueIGJvZHl7YmFja2dyb3VuZDojY2NjfQ0KICAgICAqIEBncmFtbWFyIFVFLnV0aWxzLmNzc1J1bGUoJ2JvZHknLCcnKSA9Pm51bGwgLy/muIXnqbrnu5nlrprnmoRrZXnlgLznmoTog4zmma/popzoibINCiAgICAgKi8NCiAgICBjc3NSdWxlOmJyb3dzZXIuaWUgPyBmdW5jdGlvbiAoa2V5LCBzdHlsZSwgZG9jKSB7DQogICAgICAgIHZhciBpbmRleExpc3QsIGluZGV4Ow0KICAgICAgICBkb2MgPSBkb2MgfHwgZG9jdW1lbnQ7DQogICAgICAgIGlmIChkb2MuaW5kZXhMaXN0KSB7DQogICAgICAgICAgICBpbmRleExpc3QgPSBkb2MuaW5kZXhMaXN0Ow0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaW5kZXhMaXN0ID0gZG9jLmluZGV4TGlzdCA9IHt9Ow0KICAgICAgICB9DQogICAgICAgIHZhciBzaGVldFN0eWxlOw0KICAgICAgICBpZiAoIWluZGV4TGlzdFtrZXldKSB7DQogICAgICAgICAgICBpZiAoc3R5bGUgPT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgIHJldHVybiAnJw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgc2hlZXRTdHlsZSA9IGRvYy5jcmVhdGVTdHlsZVNoZWV0KCcnLCBpbmRleCA9IGRvYy5zdHlsZVNoZWV0cy5sZW5ndGgpOw0KICAgICAgICAgICAgaW5kZXhMaXN0W2tleV0gPSBpbmRleDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHNoZWV0U3R5bGUgPSBkb2Muc3R5bGVTaGVldHNbaW5kZXhMaXN0W2tleV1dOw0KICAgICAgICB9DQogICAgICAgIGlmIChzdHlsZSA9PT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICByZXR1cm4gc2hlZXRTdHlsZS5jc3NUZXh0DQogICAgICAgIH0NCiAgICAgICAgc2hlZXRTdHlsZS5jc3NUZXh0ID0gc3R5bGUgfHwgJycNCiAgICB9IDogZnVuY3Rpb24gKGtleSwgc3R5bGUsIGRvYykgew0KICAgICAgICBkb2MgPSBkb2MgfHwgZG9jdW1lbnQ7DQogICAgICAgIHZhciBoZWFkID0gZG9jLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0sIG5vZGU7DQogICAgICAgIGlmICghKG5vZGUgPSBkb2MuZ2V0RWxlbWVudEJ5SWQoa2V5KSkpIHsNCiAgICAgICAgICAgIGlmIChzdHlsZSA9PT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICcnDQogICAgICAgICAgICB9DQogICAgICAgICAgICBub2RlID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7DQogICAgICAgICAgICBub2RlLmlkID0ga2V5Ow0KICAgICAgICAgICAgaGVhZC5hcHBlbmRDaGlsZChub2RlKQ0KICAgICAgICB9DQogICAgICAgIGlmIChzdHlsZSA9PT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICByZXR1cm4gbm9kZS5pbm5lckhUTUwNCiAgICAgICAgfQ0KICAgICAgICBpZiAoc3R5bGUgIT09ICcnKSB7DQogICAgICAgICAgICBub2RlLmlubmVySFRNTCA9IHN0eWxlOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaGVhZC5yZW1vdmVDaGlsZChub2RlKQ0KICAgICAgICB9DQogICAgfSwNCiAgICBzb3J0OmZ1bmN0aW9uKGFycmF5LGNvbXBhcmVGbil7DQogICAgICAgIGNvbXBhcmVGbiA9IGNvbXBhcmVGbiB8fCBmdW5jdGlvbihpdGVtMSwgaXRlbTIpeyByZXR1cm4gaXRlbTEubG9jYWxlQ29tcGFyZShpdGVtMik7fTsNCiAgICAgICAgZm9yKHZhciBpPSAwLGxlbiA9IGFycmF5Lmxlbmd0aDsgaTxsZW47IGkrKyl7DQogICAgICAgICAgICBmb3IodmFyIGogPSBpLGxlbmd0aCA9IGFycmF5Lmxlbmd0aDsgajxsZW5ndGg7IGorKyl7DQogICAgICAgICAgICAgICAgaWYoY29tcGFyZUZuKGFycmF5W2ldLCBhcnJheVtqXSkgPiAwKXsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSBhcnJheVtpXTsNCiAgICAgICAgICAgICAgICAgICAgYXJyYXlbaV0gPSBhcnJheVtqXTsNCiAgICAgICAgICAgICAgICAgICAgYXJyYXlbal0gPSB0Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gYXJyYXk7DQogICAgfQ0KDQp9Ow0KLyoqDQogKiDliKTmlq1zdHLmmK/lkKbkuLrlrZfnrKbkuLINCiAqIEBuYW1lIGlzU3RyaW5nDQogKiBAZ3JhbW1hciBVRS51dGlscy5pc1N0cmluZyhzdHIpID0+IHRydWV8ZmFsc2UNCiAqLw0KLyoqDQogKiDliKTmlq1hcnJheeaYr+WQpuS4uuaVsOe7hA0KICogQG5hbWUgaXNBcnJheQ0KICogQGdyYW1tYXIgVUUudXRpbHMuaXNBcnJheShvYmopID0+IHRydWV8ZmFsc2UNCiAqLw0KLyoqDQogKiDliKTmlq1vYmrlr7nosaHmmK/lkKbkuLrmlrnms5UNCiAqIEBuYW1lIGlzRnVuY3Rpb24NCiAqIEBncmFtbWFyIFVFLnV0aWxzLmlzRnVuY3Rpb24ob2JqKSAgPT4gdHJ1ZXxmYWxzZQ0KICovDQovKioNCiAqIOWIpOaWrW9iauWvueixoeaYr+WQpuS4uuaVsOWtlw0KICogQG5hbWUgaXNOdW1iZXINCiAqIEBncmFtbWFyIFVFLnV0aWxzLmlzTnVtYmVyKG9iaikgID0+IHRydWV8ZmFsc2UNCiAqLw0KdXRpbHMuZWFjaChbJ1N0cmluZycsICdGdW5jdGlvbicsICdBcnJheScsICdOdW1iZXInLCAnUmVnRXhwJywgJ09iamVjdCddLCBmdW5jdGlvbiAodikgew0KICAgIFVFLnV0aWxzWydpcycgKyB2XSA9IGZ1bmN0aW9uIChvYmopIHsNCiAgICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuYXBwbHkob2JqKSA9PSAnW29iamVjdCAnICsgdiArICddJzsNCiAgICB9DQp9KTsKLyoqDQogKiBAZmlsZQ0KICogQG5hbWUgVUUuRXZlbnRCYXNlDQogKiBAc2hvcnQgRXZlbnRCYXNlDQogKiBAaW1wb3J0IGVkaXRvci5qcyxjb3JlL3V0aWxzLmpzDQogKiBAZGVzYyBVRemHh+eUqOeahOS6i+S7tuWfuuexu++8jOe7p+aJv+atpOexu+eahOWvueW6lOexu+WwhuiOt+WPlmFkZExpc3RlbmVyLHJlbW92ZUxpc3RlbmVyLGZpcmVFdmVudOaWueazleOAgg0KICog5ZyoVUXkuK3vvIxFZGl0b3Lku6Xlj4rmiYDmnIl1aeWunuS+i+mDvee7p+aJv+S6huivpeexu++8jOaVheWPr+S7peWcqOWvueW6lOeahHVp5a+56LGh5Lul5Y+KZWRpdG9y5a+56LGh5LiK5L2/55So5LiK6L+w5pa55rOV44CCDQogKi8NCnZhciBFdmVudEJhc2UgPSBVRS5FdmVudEJhc2UgPSBmdW5jdGlvbiAoKSB7fTsNCg0KRXZlbnRCYXNlLnByb3RvdHlwZSA9IHsNCiAgICAvKioNCiAgICAgKiDms6jlhozkuovku7bnm5HlkKzlmagNCiAgICAgKiBAbmFtZSBhZGRMaXN0ZW5lcg0KICAgICAqIEBncmFtbWFyIGVkaXRvci5hZGRMaXN0ZW5lcih0eXBlcyxmbikgIC8vdHlwZXPkuLrkuovku7blkI3np7DvvIzlpJrkuKrlj6/nlKjnqbrmoLzliIbpmpQNCiAgICAgKiBAZXhhbXBsZQ0KICAgICAqIGVkaXRvci5hZGRMaXN0ZW5lcignc2VsZWN0aW9uY2hhbmdlJyxmdW5jdGlvbigpew0KICAgICAqICAgICAgY29uc29sZS5sb2coIumAieWMuuW3sue7j+WPmOWMlu+8gSIpOw0KICAgICAqIH0pDQogICAgICogZWRpdG9yLmFkZExpc3RlbmVyKCdiZWZvcmVnZXRjb250ZW50IGFmdGVyZ2V0Y29udGVudCcsZnVuY3Rpb24odHlwZSl7DQogICAgICogICAgICAgICBpZih0eXBlID09ICdiZWZvcmVnZXRjb250ZW50Jyl7DQogICAgICogICAgICAgICAgICAgLy9kbyBzb21ldGhpbmcNCiAgICAgKiAgICAgICAgIH1lbHNlew0KICAgICAqICAgICAgICAgICAgIC8vZG8gc29tZXRoaW5nDQogICAgICogICAgICAgICB9DQogICAgICogICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmdldENvbnRlbnQpIC8vIHRoaXPmmK/ms6jlhoznmoTkuovku7bnmoTnvJbovpHlmajlrp7kvosNCiAgICAgKiB9KQ0KICAgICAqLw0KICAgIGFkZExpc3RlbmVyOmZ1bmN0aW9uICh0eXBlcywgbGlzdGVuZXIpIHsNCiAgICAgICAgdHlwZXMgPSB1dGlscy50cmltKHR5cGVzKS5zcGxpdCgnICcpOw0KICAgICAgICBmb3IgKHZhciBpID0gMCwgdGk7IHRpID0gdHlwZXNbaSsrXTspIHsNCiAgICAgICAgICAgIGdldExpc3RlbmVyKHRoaXMsIHRpLCB0cnVlKS5wdXNoKGxpc3RlbmVyKTsNCiAgICAgICAgfQ0KICAgIH0sDQogICAgLyoqDQogICAgICog56e76Zmk5LqL5Lu255uR5ZCs5ZmoDQogICAgICogQG5hbWUgcmVtb3ZlTGlzdGVuZXINCiAgICAgKiBAZ3JhbW1hciBlZGl0b3IucmVtb3ZlTGlzdGVuZXIodHlwZXMsZm4pICAvL3R5cGVz5Li65LqL5Lu25ZCN56ew77yM5aSa5Liq5Y+v55So56m65qC85YiG6ZqUDQogICAgICogQGV4YW1wbGUNCiAgICAgKiAvL2NoYW5nZUNhbGxiYWNr5Li65pa55rOV5L2TDQogICAgICogZWRpdG9yLnJlbW92ZUxpc3RlbmVyKCJzZWxlY3Rpb25jaGFuZ2UiLGNoYW5nZUNhbGxiYWNrKTsNCiAgICAgKi8NCiAgICByZW1vdmVMaXN0ZW5lcjpmdW5jdGlvbiAodHlwZXMsIGxpc3RlbmVyKSB7DQogICAgICAgIHR5cGVzID0gdXRpbHMudHJpbSh0eXBlcykuc3BsaXQoJyAnKTsNCiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHRpOyB0aSA9IHR5cGVzW2krK107KSB7DQogICAgICAgICAgICB1dGlscy5yZW1vdmVJdGVtKGdldExpc3RlbmVyKHRoaXMsIHRpKSB8fCBbXSwgbGlzdGVuZXIpOw0KICAgICAgICB9DQogICAgfSwNCiAgICAvKioNCiAgICAgKiDop6blj5Hkuovku7YNCiAgICAgKiBAbmFtZSBmaXJlRXZlbnQNCiAgICAgKiBAZ3JhbW1hciBlZGl0b3IuZmlyZUV2ZW50KHR5cGVzKSAgLy90eXBlc+S4uuS6i+S7tuWQjeensO+8jOWkmuS4quWPr+eUqOepuuagvOWIhumalA0KICAgICAqIEBleGFtcGxlDQogICAgICogZWRpdG9yLmZpcmVFdmVudCgic2VsZWN0aW9uY2hhbmdlIik7DQogICAgICovDQogICAgZmlyZUV2ZW50OmZ1bmN0aW9uICgpIHsNCiAgICAgICAgdmFyIHR5cGVzID0gYXJndW1lbnRzWzBdOw0KICAgICAgICB0eXBlcyA9IHV0aWxzLnRyaW0odHlwZXMpLnNwbGl0KCcgJyk7DQogICAgICAgIGZvciAodmFyIGkgPSAwLCB0aTsgdGkgPSB0eXBlc1tpKytdOykgew0KICAgICAgICAgICAgdmFyIGxpc3RlbmVycyA9IGdldExpc3RlbmVyKHRoaXMsIHRpKSwNCiAgICAgICAgICAgICAgICByLCB0LCBrOw0KICAgICAgICAgICAgaWYgKGxpc3RlbmVycykgew0KICAgICAgICAgICAgICAgIGsgPSBsaXN0ZW5lcnMubGVuZ3RoOw0KICAgICAgICAgICAgICAgIHdoaWxlIChrLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgaWYoIWxpc3RlbmVyc1trXSljb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgdCA9IGxpc3RlbmVyc1trXS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOw0KICAgICAgICAgICAgICAgICAgICBpZih0ID09PSB0cnVlKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmICh0ICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHIgPSB0Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKHQgPSB0aGlzWydvbicgKyB0aS50b0xvd2VyQ2FzZSgpXSkgew0KICAgICAgICAgICAgICAgIHIgPSB0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHI7DQogICAgfQ0KfTsNCi8qKg0KICog6I635b6X5a+56LGh5omA5oul5pyJ55uR5ZCs57G75Z6L55qE5omA5pyJ55uR5ZCs5ZmoDQogKiBAcHVibGljDQogKiBAZnVuY3Rpb24NCiAqIEBwYXJhbSB7T2JqZWN0fSBvYmogIOafpeivouebkeWQrOWZqOeahOWvueixoQ0KICogQHBhcmFtIHtTdHJpbmd9IHR5cGUg5LqL5Lu257G75Z6LDQogKiBAcGFyYW0ge0Jvb2xlYW59IGZvcmNlICDkuLp0cnVl5LiU5b2T5YmN5omA5pyJdHlwZeexu+Wei+eahOS+puWQrOWZqOS4jeWtmOWcqOaXtu+8jOWIm+W7uuS4gOS4quepuuebkeWQrOWZqOaVsOe7hA0KICogQHJldHVybnMge0FycmF5fSDnm5HlkKzlmajmlbDnu4QNCiAqLw0KZnVuY3Rpb24gZ2V0TGlzdGVuZXIob2JqLCB0eXBlLCBmb3JjZSkgew0KICAgIHZhciBhbGxMaXN0ZW5lcnM7DQogICAgdHlwZSA9IHR5cGUudG9Mb3dlckNhc2UoKTsNCiAgICByZXR1cm4gKCAoIGFsbExpc3RlbmVycyA9ICggb2JqLl9fYWxsTGlzdGVuZXJzIHx8IGZvcmNlICYmICggb2JqLl9fYWxsTGlzdGVuZXJzID0ge30gKSApICkNCiAgICAgICAgJiYgKCBhbGxMaXN0ZW5lcnNbdHlwZV0gfHwgZm9yY2UgJiYgKCBhbGxMaXN0ZW5lcnNbdHlwZV0gPSBbXSApICkgKTsNCn0NCg0KCi8vL2ltcG9ydCBlZGl0b3IuanMNCi8vL2ltcG9ydCBjb3JlL2RvbS9kb20uanMNCi8vL2ltcG9ydCBjb3JlL3V0aWxzLmpzDQovKioNCiAqIGR0ZCBodG1s6K+t5LmJ5YyW55qE5L2T546w57G7DQogKiBAY29uc3RydWN0b3INCiAqIEBuYW1lc3BhY2UgZHRkDQogKi8NCnZhciBkdGQgPSBkb20uZHRkID0gKGZ1bmN0aW9uKCkgew0KICAgIGZ1bmN0aW9uIF8oIHMgKSB7DQogICAgICAgIGZvciAodmFyIGsgaW4gcykgew0KICAgICAgICAgICAgc1trLnRvVXBwZXJDYXNlKCldID0gc1trXTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gczsNCiAgICB9DQogICAgdmFyIFggPSB1dGlscy5leHRlbmQyOw0KICAgIHZhciBBID0gXyh7aXNpbmRleDoxLGZpZWxkc2V0OjF9KSwNCiAgICAgICAgQiA9IF8oe2lucHV0OjEsYnV0dG9uOjEsc2VsZWN0OjEsdGV4dGFyZWE6MSxsYWJlbDoxfSksDQogICAgICAgIEMgPSBYKCBfKHthOjF9KSwgQiApLA0KICAgICAgICBEID0gWCgge2lmcmFtZToxfSwgQyApLA0KICAgICAgICBFID0gXyh7aHI6MSx1bDoxLG1lbnU6MSxkaXY6MSxibG9ja3F1b3RlOjEsbm9zY3JpcHQ6MSx0YWJsZToxLGNlbnRlcjoxLGFkZHJlc3M6MSxkaXI6MSxwcmU6MSxoNToxLGRsOjEsaDQ6MSxub2ZyYW1lczoxLGg2OjEsb2w6MSxoMToxLGgzOjEsaDI6MX0pLA0KICAgICAgICBGID0gXyh7aW5zOjEsZGVsOjEsc2NyaXB0OjEsc3R5bGU6MX0pLA0KICAgICAgICBHID0gWCggXyh7YjoxLGFjcm9ueW06MSxiZG86MSwndmFyJzoxLCcjJzoxLGFiYnI6MSxjb2RlOjEsYnI6MSxpOjEsY2l0ZToxLGtiZDoxLHU6MSxzdHJpa2U6MSxzOjEsdHQ6MSxzdHJvbmc6MSxxOjEsc2FtcDoxLGVtOjEsZGZuOjEsc3BhbjoxfSksIEYgKSwNCiAgICAgICAgSCA9IFgoIF8oe3N1YjoxLGltZzoxLGVtYmVkOjEsb2JqZWN0OjEsc3VwOjEsYmFzZWZvbnQ6MSxtYXA6MSxhcHBsZXQ6MSxmb250OjEsYmlnOjEsc21hbGw6MX0pLCBHICksDQogICAgICAgIEkgPSBYKCBfKHtwOjF9KSwgSCApLA0KICAgICAgICBKID0gWCggXyh7aWZyYW1lOjF9KSwgSCwgQiApLA0KICAgICAgICBLID0gXyh7aW1nOjEsZW1iZWQ6MSxub3NjcmlwdDoxLGJyOjEsa2JkOjEsY2VudGVyOjEsYnV0dG9uOjEsYmFzZWZvbnQ6MSxoNToxLGg0OjEsc2FtcDoxLGg2OjEsb2w6MSxoMToxLGgzOjEsaDI6MSxmb3JtOjEsZm9udDoxLCcjJzoxLHNlbGVjdDoxLG1lbnU6MSxpbnM6MSxhYmJyOjEsbGFiZWw6MSxjb2RlOjEsdGFibGU6MSxzY3JpcHQ6MSxjaXRlOjEsaW5wdXQ6MSxpZnJhbWU6MSxzdHJvbmc6MSx0ZXh0YXJlYToxLG5vZnJhbWVzOjEsYmlnOjEsc21hbGw6MSxzcGFuOjEsaHI6MSxzdWI6MSxiZG86MSwndmFyJzoxLGRpdjoxLG9iamVjdDoxLHN1cDoxLHN0cmlrZToxLGRpcjoxLG1hcDoxLGRsOjEsYXBwbGV0OjEsZGVsOjEsaXNpbmRleDoxLGZpZWxkc2V0OjEsdWw6MSxiOjEsYWNyb255bToxLGE6MSxibG9ja3F1b3RlOjEsaToxLHU6MSxzOjEsdHQ6MSxhZGRyZXNzOjEscToxLHByZToxLHA6MSxlbToxLGRmbjoxfSksDQoNCiAgICAgICAgTCA9IFgoIF8oe2E6MH0pLCBKICksLy9h5LiN6IO96KKr5YiH5byA77yM5omA5Lul5oqK5LuWDQogICAgICAgIE0gPSBfKHt0cjoxfSksDQogICAgICAgIE4gPSBfKHsnIyc6MX0pLA0KICAgICAgICBPID0gWCggXyh7cGFyYW06MX0pLCBLICksDQogICAgICAgIFAgPSBYKCBfKHtmb3JtOjF9KSwgQSwgRCwgRSwgSSApLA0KICAgICAgICBRID0gXyh7bGk6MSxvbDoxLHVsOjF9KSwNCiAgICAgICAgUiA9IF8oe3N0eWxlOjEsc2NyaXB0OjF9KSwNCiAgICAgICAgUyA9IF8oe2Jhc2U6MSxsaW5rOjEsbWV0YToxLHRpdGxlOjF9KSwNCiAgICAgICAgVCA9IFgoIFMsIFIgKSwNCiAgICAgICAgVSA9IF8oe2hlYWQ6MSxib2R5OjF9KSwNCiAgICAgICAgViA9IF8oe2h0bWw6MX0pOw0KDQogICAgdmFyIGJsb2NrID0gXyh7YWRkcmVzczoxLGJsb2NrcXVvdGU6MSxjZW50ZXI6MSxkaXI6MSxkaXY6MSxkbDoxLGZpZWxkc2V0OjEsZm9ybToxLGgxOjEsaDI6MSxoMzoxLGg0OjEsaDU6MSxoNjoxLGhyOjEsaXNpbmRleDoxLG1lbnU6MSxub2ZyYW1lczoxLG9sOjEscDoxLHByZToxLHRhYmxlOjEsdWw6MX0pLA0KDQogICAgICAgIGVtcHR5ID0gIF8oe2FyZWE6MSxiYXNlOjEsYmFzZWZvbnQ6MSxicjoxLGNvbDoxLGNvbW1hbmQ6MSxkaWFsb2c6MSxlbWJlZDoxLGhyOjEsaW1nOjEsaW5wdXQ6MSxpc2luZGV4OjEsa2V5Z2VuOjEsbGluazoxLG1ldGE6MSxwYXJhbToxLHNvdXJjZToxLHRyYWNrOjEsd2JyOjF9KTsNCg0KICAgIHJldHVybiAgXyh7DQoNCiAgICAgICAgLy8gJCDooajnpLroh6rlrprnmoTlsZ7mgKcNCg0KICAgICAgICAvLyBib2R55aSW55qE5YWD57Sg5YiX6KGoLg0KICAgICAgICAkbm9uQm9keUNvbnRlbnQ6IFgoIFYsIFUsIFMgKSwNCg0KICAgICAgICAvL+Wdl+e7k+aehOWFg+e0oOWIl+ihqA0KICAgICAgICAkYmxvY2sgOiBibG9jaywNCg0KICAgICAgICAvL+WGheiBlOWFg+e0oOWIl+ihqA0KICAgICAgICAkaW5saW5lIDogTCwNCg0KICAgICAgICAkaW5saW5lV2l0aEEgOiBYKF8oe2E6MX0pLEwpLA0KDQogICAgICAgICRib2R5IDogWCggXyh7c2NyaXB0OjEsc3R5bGU6MX0pLCBibG9jayApLA0KDQogICAgICAgICRjZGF0YSA6IF8oe3NjcmlwdDoxLHN0eWxlOjF9KSwNCg0KICAgICAgICAvL+iHqumXreWSjOWFg+e0oA0KICAgICAgICAkZW1wdHkgOiBlbXB0eSwNCg0KICAgICAgICAvL+S4jeaYr+iHqumXreWQiO+8jOS9huS4jeiDveiuqXJhbmdl6YCJ5Lit6YeM6L65DQogICAgICAgICRub25DaGlsZCA6IF8oe2lmcmFtZToxLHRleHRhcmVhOjF9KSwNCiAgICAgICAgLy/liJfooajlhYPntKDliJfooagNCiAgICAgICAgJGxpc3RJdGVtIDogXyh7ZGQ6MSxkdDoxLGxpOjF9KSwNCg0KICAgICAgICAvL+WIl+ihqOagueWFg+e0oOWIl+ihqA0KICAgICAgICAkbGlzdDogXyh7dWw6MSxvbDoxLGRsOjF9KSwNCg0KICAgICAgICAvL+S4jeiDveiupOS4uuaYr+epuueahOWFg+e0oA0KICAgICAgICAkaXNOb3RFbXB0eSA6IF8oe3RhYmxlOjEsdWw6MSxvbDoxLGRsOjEsaWZyYW1lOjEsYXJlYToxLGJhc2U6MSxjb2w6MSxocjoxLGltZzoxLGVtYmVkOjEsaW5wdXQ6MSxsaW5rOjEsbWV0YToxLHBhcmFtOjEsaDE6MSxoMjoxLGgzOjEsaDQ6MSxoNToxLGg2OjF9KSwNCg0KICAgICAgICAvL+WmguaenOayoeacieWtkOiKgueCueWwseWPr+S7peWIoOmZpOeahOWFg+e0oOWIl+ihqO+8jOWDj3NwYW4sYQ0KICAgICAgICAkcmVtb3ZlRW1wdHkgOiBfKHthOjEsYWJicjoxLGFjcm9ueW06MSxhZGRyZXNzOjEsYjoxLGJkbzoxLGJpZzoxLGNpdGU6MSxjb2RlOjEsZGVsOjEsZGZuOjEsZW06MSxmb250OjEsaToxLGluczoxLGxhYmVsOjEsa2JkOjEscToxLHM6MSxzYW1wOjEsc21hbGw6MSxzcGFuOjEsc3RyaWtlOjEsc3Ryb25nOjEsc3ViOjEsc3VwOjEsdHQ6MSx1OjEsJ3Zhcic6MX0pLA0KDQogICAgICAgICRyZW1vdmVFbXB0eUJsb2NrIDogXyh7J3AnOjEsJ2Rpdic6MX0pLA0KDQogICAgICAgIC8v5ZyodGFibGXlhYPntKDph4znmoTlhYPntKDliJfooagNCiAgICAgICAgJHRhYmxlQ29udGVudCA6IF8oe2NhcHRpb246MSxjb2w6MSxjb2xncm91cDoxLHRib2R5OjEsdGQ6MSx0Zm9vdDoxLHRoOjEsdGhlYWQ6MSx0cjoxLHRhYmxlOjF9KSwNCiAgICAgICAgLy/kuI3ovazmjaLnmoTmoIfnrb4NCiAgICAgICAgJG5vdFRyYW5zQ29udGVudCA6IF8oe3ByZToxLHNjcmlwdDoxLHN0eWxlOjEsdGV4dGFyZWE6MX0pLA0KICAgICAgICBodG1sOiBVLA0KICAgICAgICBoZWFkOiBULA0KICAgICAgICBzdHlsZTogTiwNCiAgICAgICAgc2NyaXB0OiBOLA0KICAgICAgICBib2R5OiBQLA0KICAgICAgICBiYXNlOiB7fSwNCiAgICAgICAgbGluazoge30sDQogICAgICAgIG1ldGE6IHt9LA0KICAgICAgICB0aXRsZTogTiwNCiAgICAgICAgY29sIDoge30sDQogICAgICAgIHRyIDogXyh7dGQ6MSx0aDoxfSksDQogICAgICAgIGltZyA6IHt9LA0KICAgICAgICBlbWJlZDoge30sDQogICAgICAgIGNvbGdyb3VwIDogXyh7dGhlYWQ6MSxjb2w6MSx0Ym9keToxLHRyOjEsdGZvb3Q6MX0pLA0KICAgICAgICBub3NjcmlwdCA6IFAsDQogICAgICAgIHRkIDogUCwNCiAgICAgICAgYnIgOiB7fSwNCiAgICAgICAgdGggOiBQLA0KICAgICAgICBjZW50ZXIgOiBQLA0KICAgICAgICBrYmQgOiBMLA0KICAgICAgICBidXR0b24gOiBYKCBJLCBFICksDQogICAgICAgIGJhc2Vmb250IDoge30sDQogICAgICAgIGg1IDogTCwNCiAgICAgICAgaDQgOiBMLA0KICAgICAgICBzYW1wIDogTCwNCiAgICAgICAgaDYgOiBMLA0KICAgICAgICBvbCA6IFEsDQogICAgICAgIGgxIDogTCwNCiAgICAgICAgaDMgOiBMLA0KICAgICAgICBvcHRpb24gOiBOLA0KICAgICAgICBoMiA6IEwsDQogICAgICAgIGZvcm0gOiBYKCBBLCBELCBFLCBJICksDQogICAgICAgIHNlbGVjdCA6IF8oe29wdGdyb3VwOjEsb3B0aW9uOjF9KSwNCiAgICAgICAgZm9udCA6IEwsDQogICAgICAgIGlucyA6IEwsDQogICAgICAgIG1lbnUgOiBRLA0KICAgICAgICBhYmJyIDogTCwNCiAgICAgICAgbGFiZWwgOiBMLA0KICAgICAgICB0YWJsZSA6IF8oe3RoZWFkOjEsY29sOjEsdGJvZHk6MSx0cjoxLGNvbGdyb3VwOjEsY2FwdGlvbjoxLHRmb290OjF9KSwNCiAgICAgICAgY29kZSA6IEwsDQogICAgICAgIHRmb290IDogTSwNCiAgICAgICAgY2l0ZSA6IEwsDQogICAgICAgIGxpIDogUCwNCiAgICAgICAgaW5wdXQgOiB7fSwNCiAgICAgICAgaWZyYW1lIDogUCwNCiAgICAgICAgc3Ryb25nIDogTCwNCiAgICAgICAgdGV4dGFyZWEgOiBOLA0KICAgICAgICBub2ZyYW1lcyA6IFAsDQogICAgICAgIGJpZyA6IEwsDQogICAgICAgIHNtYWxsIDogTCwNCiAgICAgICAgLy90cmFjZToNCiAgICAgICAgc3BhbiA6Xyh7JyMnOjEsYnI6MSxiOjEsc3Ryb25nOjEsdToxLGk6MSxlbToxLHN1YjoxLHN1cDoxLHN0cmlrZToxLHNwYW46MX0pLA0KICAgICAgICBociA6IEwsDQogICAgICAgIGR0IDogTCwNCiAgICAgICAgc3ViIDogTCwNCiAgICAgICAgb3B0Z3JvdXAgOiBfKHtvcHRpb246MX0pLA0KICAgICAgICBwYXJhbSA6IHt9LA0KICAgICAgICBiZG8gOiBMLA0KICAgICAgICAndmFyJyA6IEwsDQogICAgICAgIGRpdiA6IFAsDQogICAgICAgIG9iamVjdCA6IE8sDQogICAgICAgIHN1cCA6IEwsDQogICAgICAgIGRkIDogUCwNCiAgICAgICAgc3RyaWtlIDogTCwNCiAgICAgICAgYXJlYSA6IHt9LA0KICAgICAgICBkaXIgOiBRLA0KICAgICAgICBtYXAgOiBYKCBfKHthcmVhOjEsZm9ybToxLHA6MX0pLCBBLCBGLCBFICksDQogICAgICAgIGFwcGxldCA6IE8sDQogICAgICAgIGRsIDogXyh7ZHQ6MSxkZDoxfSksDQogICAgICAgIGRlbCA6IEwsDQogICAgICAgIGlzaW5kZXggOiB7fSwNCiAgICAgICAgZmllbGRzZXQgOiBYKCBfKHtsZWdlbmQ6MX0pLCBLICksDQogICAgICAgIHRoZWFkIDogTSwNCiAgICAgICAgdWwgOiBRLA0KICAgICAgICBhY3JvbnltIDogTCwNCiAgICAgICAgYiA6IEwsDQogICAgICAgIGEgOiBYKCBfKHthOjF9KSwgSiApLA0KICAgICAgICBibG9ja3F1b3RlIDpYKF8oe3RkOjEsdHI6MSx0Ym9keToxLGxpOjF9KSxQKSwNCiAgICAgICAgY2FwdGlvbiA6IEwsDQogICAgICAgIGkgOiBMLA0KICAgICAgICB1IDogTCwNCiAgICAgICAgdGJvZHkgOiBNLA0KICAgICAgICBzIDogTCwNCiAgICAgICAgYWRkcmVzcyA6IFgoIEQsIEkgKSwNCiAgICAgICAgdHQgOiBMLA0KICAgICAgICBsZWdlbmQgOiBMLA0KICAgICAgICBxIDogTCwNCiAgICAgICAgcHJlIDogWCggRywgQyApLA0KICAgICAgICBwIDogWChfKHsnYSc6MX0pLEwpLA0KICAgICAgICBlbSA6TCwNCiAgICAgICAgZGZuIDogTA0KICAgIH0pOw0KfSkoKTsNCgovKioNCiAqIEBmaWxlDQogKiBAbmFtZSBVRS5kb20uZG9tVXRpbHMNCiAqIEBzaG9ydCBEb21VdGlscw0KICogQGltcG9ydCBlZGl0b3IuanMsIGNvcmUvdXRpbHMuanMsY29yZS9icm93c2VyLmpzLGNvcmUvZG9tL2R0ZC5qcw0KICogQGRlc2MgVUVkaXRvcuWwgeijheeahOW6leWxgmRvbeaTjeS9nOW6kw0KICovDQpmdW5jdGlvbiBnZXREb21Ob2RlKG5vZGUsIHN0YXJ0LCBsdHIsIHN0YXJ0RnJvbUNoaWxkLCBmbiwgZ3VhcmQpIHsNCiAgICB2YXIgdG1wTm9kZSA9IHN0YXJ0RnJvbUNoaWxkICYmIG5vZGVbc3RhcnRdLA0KICAgICAgICBwYXJlbnQ7DQogICAgIXRtcE5vZGUgJiYgKHRtcE5vZGUgPSBub2RlW2x0cl0pOw0KICAgIHdoaWxlICghdG1wTm9kZSAmJiAocGFyZW50ID0gKHBhcmVudCB8fCBub2RlKS5wYXJlbnROb2RlKSkgew0KICAgICAgICBpZiAocGFyZW50LnRhZ05hbWUgPT0gJ0JPRFknIHx8IGd1YXJkICYmICFndWFyZChwYXJlbnQpKSB7DQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgfQ0KICAgICAgICB0bXBOb2RlID0gcGFyZW50W2x0cl07DQogICAgfQ0KICAgIGlmICh0bXBOb2RlICYmIGZuICYmICFmbih0bXBOb2RlKSkgew0KICAgICAgICByZXR1cm4gIGdldERvbU5vZGUodG1wTm9kZSwgc3RhcnQsIGx0ciwgZmFsc2UsIGZuKTsNCiAgICB9DQogICAgcmV0dXJuIHRtcE5vZGU7DQp9DQp2YXIgYXR0ckZpeCA9IGllICYmIGJyb3dzZXIudmVyc2lvbiA8IDkgPyB7DQogICAgICAgIHRhYmluZGV4OiJ0YWJJbmRleCIsDQogICAgICAgIHJlYWRvbmx5OiJyZWFkT25seSIsDQogICAgICAgICJmb3IiOiJodG1sRm9yIiwNCiAgICAgICAgImNsYXNzIjoiY2xhc3NOYW1lIiwNCiAgICAgICAgbWF4bGVuZ3RoOiJtYXhMZW5ndGgiLA0KICAgICAgICBjZWxsc3BhY2luZzoiY2VsbFNwYWNpbmciLA0KICAgICAgICBjZWxscGFkZGluZzoiY2VsbFBhZGRpbmciLA0KICAgICAgICByb3dzcGFuOiJyb3dTcGFuIiwNCiAgICAgICAgY29sc3BhbjoiY29sU3BhbiIsDQogICAgICAgIHVzZW1hcDoidXNlTWFwIiwNCiAgICAgICAgZnJhbWVib3JkZXI6ImZyYW1lQm9yZGVyIg0KICAgIH0gOiB7DQogICAgICAgIHRhYmluZGV4OiJ0YWJJbmRleCIsDQogICAgICAgIHJlYWRvbmx5OiJyZWFkT25seSINCiAgICB9LA0KICAgIHN0eWxlQmxvY2sgPSB1dGlscy5saXN0VG9NYXAoWw0KICAgICAgICAnLXdlYmtpdC1ib3gnLCAnLW1vei1ib3gnLCAnYmxvY2snICwNCiAgICAgICAgJ2xpc3QtaXRlbScgLCAndGFibGUnICwgJ3RhYmxlLXJvdy1ncm91cCcgLA0KICAgICAgICAndGFibGUtaGVhZGVyLWdyb3VwJywgJ3RhYmxlLWZvb3Rlci1ncm91cCcgLA0KICAgICAgICAndGFibGUtcm93JyAsICd0YWJsZS1jb2x1bW4tZ3JvdXAnICwgJ3RhYmxlLWNvbHVtbicgLA0KICAgICAgICAndGFibGUtY2VsbCcgLCAndGFibGUtY2FwdGlvbicNCiAgICBdKTsNCnZhciBkb21VdGlscyA9IGRvbS5kb21VdGlscyA9IHsNCiAgICAvL+iKgueCueW4uOmHjw0KICAgIE5PREVfRUxFTUVOVDoxLA0KICAgIE5PREVfRE9DVU1FTlQ6OSwNCiAgICBOT0RFX1RFWFQ6MywNCiAgICBOT0RFX0NPTU1FTlQ6OCwNCiAgICBOT0RFX0RPQ1VNRU5UX0ZSQUdNRU5UOjExLA0KDQogICAgLy/kvY3nva7lhbPns7sNCiAgICBQT1NJVElPTl9JREVOVElDQUw6MCwNCiAgICBQT1NJVElPTl9ESVNDT05ORUNURUQ6MSwNCiAgICBQT1NJVElPTl9GT0xMT1dJTkc6MiwNCiAgICBQT1NJVElPTl9QUkVDRURJTkc6NCwNCiAgICBQT1NJVElPTl9JU19DT05UQUlORUQ6OCwNCiAgICBQT1NJVElPTl9DT05UQUlOUzoxNiwNCiAgICAvL2llNuS9v+eUqOWFtuS7lueahOS8muacieS4gOauteepuueZveWHuueOsA0KICAgIGZpbGxDaGFyOmllICYmIGJyb3dzZXIudmVyc2lvbiA9PSAnNicgPyAnXHVmZWZmJyA6ICdcdTIwMEInLA0KICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLU5vZGXpg6jliIYtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgIGtleXM6ew0KICAgICAgICAvKkJhY2tzcGFjZSovIDg6MSwgLypEZWxldGUqLyA0NjoxLA0KICAgICAgICAvKlNoaWZ0Ki8gMTY6MSwgLypDdHJsKi8gMTc6MSwgLypBbHQqLyAxODoxLA0KICAgICAgICAzNzoxLCAzODoxLCAzOToxLCA0MDoxLA0KICAgICAgICAxMzoxIC8qZW50ZXIqLw0KICAgIH0sDQogICAgLyoqDQogICAgICog6I635Y+W6IqC54K5QeebuOWvueS6juiKgueCuULnmoTkvY3nva7lhbPns7sNCiAgICAgKiBAbmFtZSBnZXRQb3NpdGlvbg0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5nZXRQb3NpdGlvbihub2RlQSxub2RlQikgID0+ICBOdW1iZXINCiAgICAgKiBAZXhhbXBsZQ0KICAgICAqICBzd2l0Y2ggKHJldHVyblZhbHVlKSB7DQogICAgICogICAgICBjYXNlIDA6IC8v55u4562J77yM5ZCM5LiA6IqC54K5DQogICAgICogICAgICBjYXNlIDE6IC8v5peg5YWz77yM6IqC54K55LiN55u46L+eDQogICAgICogICAgICBjYXNlIDI6IC8v6Lef6ZqP77yM5Y2z6IqC54K5QeWktOmDqOS9jeS6juiKgueCuULlpLTpg6jnmoTlkI7pnaINCiAgICAgKiAgICAgIGNhc2UgNDogLy/liY3nva7vvIzljbPoioLngrlB5aS06YOo5L2N5LqO6IqC54K5QuWktOmDqOeahOWJjemdog0KICAgICAqICAgICAgY2FzZSA4OiAvL+iiq+WMheWQq++8jOWNs+iKgueCuUHooqvoioLngrlC5YyF5ZCrDQogICAgICogICAgICBjYXNlIDEwOi8v57uE5ZCI57G75Z6L77yM5Y2z6IqC54K5Qea7oei2s+i3n+maj+iKgueCuULkuJTooqvoioLngrlC5YyF5ZCr44CC5a6e6ZmF5LiK77yM5aaC5p6c6KKr5YyF5ZCr77yM5b+F5a6a6Lef6ZqP77yM5omA5LulcmV0dXJuVmFsdWXkuovlrp7kuIrkuI3kvJrlrZjlnKg455qE5oOF5Ya144CCDQogICAgICogICAgICBjYXNlIDE2Oi8v5YyF5ZCr77yM5Y2z6IqC54K5QeWMheWQq+iKgueCuUINCiAgICAgKiAgICAgIGNhc2UgMjA6Ly/nu4TlkIjnsbvlnovvvIzljbPoioLngrlB5ruh6Laz5YmN572u6IqC54K5QeS4lOWMheWQq+iKgueCuULjgILlkIzmoLfvvIzlpoLmnpzljIXlkKvvvIzlv4XlrprliY3nva7vvIzmiYDku6VyZXR1cm5WYWx1ZeS6i+WunuS4iuS5n+S4jeS8muWtmOWcqDE255qE5oOF5Ya1DQogICAgICogIH0NCiAgICAgKi8NCiAgICBnZXRQb3NpdGlvbjpmdW5jdGlvbiAobm9kZUEsIG5vZGVCKSB7DQogICAgICAgIC8vIOWmguaenOS4pOS4quiKgueCueaYr+WQjOS4gOS4quiKgueCuQ0KICAgICAgICBpZiAobm9kZUEgPT09IG5vZGVCKSB7DQogICAgICAgICAgICAvLyBkb21VdGlscy5QT1NJVElPTl9JREVOVElDQUwNCiAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICB9DQogICAgICAgIHZhciBub2RlLA0KICAgICAgICAgICAgcGFyZW50c0EgPSBbbm9kZUFdLA0KICAgICAgICAgICAgcGFyZW50c0IgPSBbbm9kZUJdOw0KICAgICAgICBub2RlID0gbm9kZUE7DQogICAgICAgIHdoaWxlIChub2RlID0gbm9kZS5wYXJlbnROb2RlKSB7DQogICAgICAgICAgICAvLyDlpoLmnpxub2RlQuaYr25vZGVB55qE56WW5YWI6IqC54K5DQogICAgICAgICAgICBpZiAobm9kZSA9PT0gbm9kZUIpIHsNCiAgICAgICAgICAgICAgICAvLyBkb21VdGlscy5QT1NJVElPTl9JU19DT05UQUlORUQgKyBkb21VdGlscy5QT1NJVElPTl9GT0xMT1dJTkcNCiAgICAgICAgICAgICAgICByZXR1cm4gMTA7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBwYXJlbnRzQS5wdXNoKG5vZGUpOw0KICAgICAgICB9DQogICAgICAgIG5vZGUgPSBub2RlQjsNCiAgICAgICAgd2hpbGUgKG5vZGUgPSBub2RlLnBhcmVudE5vZGUpIHsNCiAgICAgICAgICAgIC8vIOWmguaenG5vZGVB5pivbm9kZULnmoTnpZblhYjoioLngrkNCiAgICAgICAgICAgIGlmIChub2RlID09PSBub2RlQSkgew0KICAgICAgICAgICAgICAgIC8vIGRvbVV0aWxzLlBPU0lUSU9OX0NPTlRBSU5TICsgZG9tVXRpbHMuUE9TSVRJT05fUFJFQ0VESU5HDQogICAgICAgICAgICAgICAgcmV0dXJuIDIwOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcGFyZW50c0IucHVzaChub2RlKTsNCiAgICAgICAgfQ0KICAgICAgICBwYXJlbnRzQS5yZXZlcnNlKCk7DQogICAgICAgIHBhcmVudHNCLnJldmVyc2UoKTsNCiAgICAgICAgaWYgKHBhcmVudHNBWzBdICE9PSBwYXJlbnRzQlswXSkgew0KICAgICAgICAgICAgLy8gZG9tVXRpbHMuUE9TSVRJT05fRElTQ09OTkVDVEVEDQogICAgICAgICAgICByZXR1cm4gMTsNCiAgICAgICAgfQ0KICAgICAgICB2YXIgaSA9IC0xOw0KICAgICAgICB3aGlsZSAoaSsrLCBwYXJlbnRzQVtpXSA9PT0gcGFyZW50c0JbaV0pIHsNCiAgICAgICAgfQ0KICAgICAgICBub2RlQSA9IHBhcmVudHNBW2ldOw0KICAgICAgICBub2RlQiA9IHBhcmVudHNCW2ldOw0KICAgICAgICB3aGlsZSAobm9kZUEgPSBub2RlQS5uZXh0U2libGluZykgew0KICAgICAgICAgICAgaWYgKG5vZGVBID09PSBub2RlQikgew0KICAgICAgICAgICAgICAgIC8vIGRvbVV0aWxzLlBPU0lUSU9OX1BSRUNFRElORw0KICAgICAgICAgICAgICAgIHJldHVybiA0DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgLy8gZG9tVXRpbHMuUE9TSVRJT05fRk9MTE9XSU5HDQogICAgICAgIHJldHVybiAgMjsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICog6L+U5Zue6IqC54K5bm9kZeWcqOeItuiKgueCueS4reeahOe0ouW8leS9jee9rg0KICAgICAqIEBuYW1lIGdldE5vZGVJbmRleA0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5nZXROb2RlSW5kZXgobm9kZSkgID0+IE51bWJlciAgLy/ntKLlvJXlgLzku44w5byA5aeLDQogICAgICovDQogICAgZ2V0Tm9kZUluZGV4OmZ1bmN0aW9uIChub2RlLCBpZ25vcmVUZXh0Tm9kZSkgew0KICAgICAgICB2YXIgcHJlTm9kZSA9IG5vZGUsDQogICAgICAgICAgICBpID0gMDsNCiAgICAgICAgd2hpbGUgKHByZU5vZGUgPSBwcmVOb2RlLnByZXZpb3VzU2libGluZykgew0KICAgICAgICAgICAgaWYgKGlnbm9yZVRleHROb2RlICYmIHByZU5vZGUubm9kZVR5cGUgPT0gMykgew0KICAgICAgICAgICAgICAgIGlmKHByZU5vZGUubm9kZVR5cGUgIT0gcHJlTm9kZS5uZXh0U2libGluZy5ub2RlVHlwZSApew0KICAgICAgICAgICAgICAgICAgICBpKys7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaSsrOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBpOw0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiDmo4DmtYvoioLngrlub2Rl5piv5ZCm5Zyo6IqC54K5ZG9j55qE5qCR5LiK77yM5a6e6LSo5LiK5piv5qOA5rWL5piv5ZCm6KKrZG9j5YyF5ZCrDQogICAgICogQG5hbWUgaW5Eb2MNCiAgICAgKiBAZ3JhbW1hciBVRS5kb20uZG9tVXRpbHMuaW5Eb2Mobm9kZSxkb2MpICAgPT4gIHRydWV8ZmFsc2UNCiAgICAgKi8NCiAgICBpbkRvYzpmdW5jdGlvbiAobm9kZSwgZG9jKSB7DQogICAgICAgIHJldHVybiBkb21VdGlscy5nZXRQb3NpdGlvbihub2RlLCBkb2MpID09IDEwOw0KICAgIH0sDQogICAgLyoqDQogICAgICog5p+l5om+bm9kZeiKgueCueeahOelluWFiOiKgueCuQ0KICAgICAqIEBuYW1lIGZpbmRQYXJlbnQNCiAgICAgKiBAZ3JhbW1hciBVRS5kb20uZG9tVXRpbHMuZmluZFBhcmVudChub2RlKSAgPT4gRWxlbWVudCAgLy8g55u05o6l6L+U5Zuebm9kZeiKgueCueeahOeItuiKgueCuQ0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5maW5kUGFyZW50KG5vZGUsZmlsdGVyRm4pICA9PiBFbGVtZW50ICAvL2ZpbHRlckZu5Li66L+H5ruk5Ye95pWw77yMbm9kZeS9nOS4uuWPguaVsO+8jOi/lOWbnnRydWXml7bmiY3kvJrlsIZub2Rl5L2c5Li656ym5ZCI6KaB5rGC55qE6IqC54K56L+U5ZueDQogICAgICogQGdyYW1tYXIgVUUuZG9tLmRvbVV0aWxzLmZpbmRQYXJlbnQobm9kZSxmaWx0ZXJGbixpbmNsdWRlU2VsZikgID0+IEVsZW1lbnQgIC8vaW5jbHVkZVNlbGbmjIflrprmmK/lkKbljIXlkKvoh6rouqsNCiAgICAgKi8NCiAgICBmaW5kUGFyZW50OmZ1bmN0aW9uIChub2RlLCBmaWx0ZXJGbiwgaW5jbHVkZVNlbGYpIHsNCiAgICAgICAgaWYgKG5vZGUgJiYgIWRvbVV0aWxzLmlzQm9keShub2RlKSkgew0KICAgICAgICAgICAgbm9kZSA9IGluY2x1ZGVTZWxmID8gbm9kZSA6IG5vZGUucGFyZW50Tm9kZTsNCiAgICAgICAgICAgIHdoaWxlIChub2RlKSB7DQogICAgICAgICAgICAgICAgaWYgKCFmaWx0ZXJGbiB8fCBmaWx0ZXJGbihub2RlKSB8fCBkb21VdGlscy5pc0JvZHkobm9kZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZpbHRlckZuICYmICFmaWx0ZXJGbihub2RlKSAmJiBkb21VdGlscy5pc0JvZHkobm9kZSkgPyBudWxsIDogbm9kZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUucGFyZW50Tm9kZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gbnVsbDsNCiAgICB9LA0KICAgIC8qKg0KICAgICAqIOmAmui/h3RhZ05hbWXmn6Xmib5ub2Rl6IqC54K555qE56WW5YWI6IqC54K5DQogICAgICogQG5hbWUgZmluZFBhcmVudEJ5VGFnTmFtZQ0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKG5vZGUsdGFnTmFtZXMpICAgPT4gIEVsZW1lbnQgIC8vdGFnTmFtZXPmlK/mjIHmlbDnu4TvvIzljLrliIblpKflsI/lhpkNCiAgICAgKiBAZ3JhbW1hciBVRS5kb20uZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShub2RlLHRhZ05hbWVzLGluY2x1ZGVTZWxmKSAgID0+ICBFbGVtZW50ICAvL2luY2x1ZGVTZWxm5oyH5a6a5piv5ZCm5YyF5ZCr6Ieq6LqrDQogICAgICogQGdyYW1tYXIgVUUuZG9tLmRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUobm9kZSx0YWdOYW1lcyxpbmNsdWRlU2VsZixleGNsdWRlRm4pICAgPT4gIEVsZW1lbnQgIC8vZXhjbHVkZUZu5oyH5a6a5L6L5aSW6L+H5ruk5p2h5Lu277yM6L+U5ZuedHJ1ZeaXtuW/veeVpeivpeiKgueCuQ0KICAgICAqLw0KICAgIGZpbmRQYXJlbnRCeVRhZ05hbWU6ZnVuY3Rpb24gKG5vZGUsIHRhZ05hbWVzLCBpbmNsdWRlU2VsZiwgZXhjbHVkZUZuKSB7DQogICAgICAgIHRhZ05hbWVzID0gdXRpbHMubGlzdFRvTWFwKHV0aWxzLmlzQXJyYXkodGFnTmFtZXMpID8gdGFnTmFtZXMgOiBbdGFnTmFtZXNdKTsNCiAgICAgICAgcmV0dXJuIGRvbVV0aWxzLmZpbmRQYXJlbnQobm9kZSwgZnVuY3Rpb24gKG5vZGUpIHsNCiAgICAgICAgICAgIHJldHVybiB0YWdOYW1lc1tub2RlLnRhZ05hbWVdICYmICEoZXhjbHVkZUZuICYmIGV4Y2x1ZGVGbihub2RlKSk7DQogICAgICAgIH0sIGluY2x1ZGVTZWxmKTsNCiAgICB9LA0KICAgIC8qKg0KICAgICAqIOafpeaJvuiKgueCuW5vZGXnmoTnpZblhYjoioLngrnpm4blkIgNCiAgICAgKiBAbmFtZSBmaW5kUGFyZW50cw0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5maW5kUGFyZW50cyhub2RlKSAgPT4gQXJyYXkgIC8v6L+U5Zue5LiA5Liq56WW5YWI6IqC54K55pWw57uE6ZuG5ZCI77yM5LiN5YyF5ZCr6Ieq6LqrDQogICAgICogQGdyYW1tYXIgVUUuZG9tLmRvbVV0aWxzLmZpbmRQYXJlbnRzKG5vZGUsaW5jbHVkZVNlbGYpICA9PiBBcnJheSAgLy/ov5Tlm57kuIDkuKrnpZblhYjoioLngrnmlbDnu4Tpm4blkIjvvIxpbmNsdWRlU2VsZuaMh+WumuaYr+WQpuWMheWQq+iHqui6qw0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5maW5kUGFyZW50cyhub2RlLGluY2x1ZGVTZWxmLGZpbHRlckZuKSAgPT4gQXJyYXkgIC8v6L+U5Zue5LiA5Liq56WW5YWI6IqC54K55pWw57uE6ZuG5ZCI77yMZmlsdGVyRm7mjIflrprov4fmu6TmnaHku7bvvIzov5Tlm550cnVl55qEbm9kZeWwhuiiq+mAieWPlg0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5maW5kUGFyZW50cyhub2RlLGluY2x1ZGVTZWxmLGZpbHRlckZuLGNsb3NlckZpcnN0KSAgPT4gQXJyYXkgIC8v6L+U5Zue5LiA5Liq56WW5YWI6IqC54K55pWw57uE6ZuG5ZCI77yMY2xvc2VyRmlyc3TkuLp0cnVl55qE6K+d77yMbm9kZeeahOebtOaOpeeItuS6suiKgueCueaYr+aVsOe7hOeahOesrDDkuKoNCiAgICAgKi8NCiAgICBmaW5kUGFyZW50czpmdW5jdGlvbiAobm9kZSwgaW5jbHVkZVNlbGYsIGZpbHRlckZuLCBjbG9zZXJGaXJzdCkgew0KICAgICAgICB2YXIgcGFyZW50cyA9IGluY2x1ZGVTZWxmICYmICggZmlsdGVyRm4gJiYgZmlsdGVyRm4obm9kZSkgfHwgIWZpbHRlckZuICkgPyBbbm9kZV0gOiBbXTsNCiAgICAgICAgd2hpbGUgKG5vZGUgPSBkb21VdGlscy5maW5kUGFyZW50KG5vZGUsIGZpbHRlckZuKSkgew0KICAgICAgICAgICAgcGFyZW50cy5wdXNoKG5vZGUpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBjbG9zZXJGaXJzdCA/IHBhcmVudHMgOiBwYXJlbnRzLnJldmVyc2UoKTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICog5Zyo6IqC54K5bm9kZeWQjumdouaPkuWFpeaWsOiKgueCuW5ld05vZGUNCiAgICAgKiBAbmFtZSBpbnNlcnRBZnRlcg0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5pbnNlcnRBZnRlcihub2RlLG5ld05vZGUpICA9PiBuZXdOb2RlDQogICAgICovDQogICAgaW5zZXJ0QWZ0ZXI6ZnVuY3Rpb24gKG5vZGUsIG5ld05vZGUpIHsNCiAgICAgICAgcmV0dXJuIG5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobmV3Tm9kZSwgbm9kZS5uZXh0U2libGluZyk7DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIOWIoOmZpOiKgueCuW5vZGXvvIzlubbmoLnmja5rZWVwQ2hpbGRyZW7mjIflrprmmK/lkKbkv53nlZnlrZDoioLngrkNCiAgICAgKiBAbmFtZSByZW1vdmUNCiAgICAgKiBAZ3JhbW1hciBVRS5kb20uZG9tVXRpbHMucmVtb3ZlKG5vZGUpICA9PiAgbm9kZQ0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5yZW1vdmUobm9kZSxrZWVwQ2hpbGRyZW4pICA9PiAgbm9kZQ0KICAgICAqLw0KICAgIHJlbW92ZTpmdW5jdGlvbiAobm9kZSwga2VlcENoaWxkcmVuKSB7DQogICAgICAgIHZhciBwYXJlbnQgPSBub2RlLnBhcmVudE5vZGUsDQogICAgICAgICAgICBjaGlsZDsNCiAgICAgICAgaWYgKHBhcmVudCkgew0KICAgICAgICAgICAgaWYgKGtlZXBDaGlsZHJlbiAmJiBub2RlLmhhc0NoaWxkTm9kZXMoKSkgew0KICAgICAgICAgICAgICAgIHdoaWxlIChjaGlsZCA9IG5vZGUuZmlyc3RDaGlsZCkgew0KICAgICAgICAgICAgICAgICAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKGNoaWxkLCBub2RlKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBwYXJlbnQucmVtb3ZlQ2hpbGQobm9kZSk7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIG5vZGU7DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIOWPluW+l25vZGXoioLngrnlnKhkb23moJHkuIrnmoTkuIvkuIDkuKroioLngrks5Y2z5aSa5Y+J5qCR6YGN5Y6GDQogICAgICogQG5hbWUgIGdldE5leHREb21Ob2RlDQogICAgICogQGdyYW1tYXIgVUUuZG9tLmRvbVV0aWxzLmdldE5leHREb21Ob2RlKG5vZGUpICA9PiBFbGVtZW50DQogICAgICogQGV4YW1wbGUNCiAgICAgKi8NCiAgICBnZXROZXh0RG9tTm9kZTpmdW5jdGlvbiAobm9kZSwgc3RhcnRGcm9tQ2hpbGQsIGZpbHRlckZuLCBndWFyZCkgew0KICAgICAgICByZXR1cm4gZ2V0RG9tTm9kZShub2RlLCAnZmlyc3RDaGlsZCcsICduZXh0U2libGluZycsIHN0YXJ0RnJvbUNoaWxkLCBmaWx0ZXJGbiwgZ3VhcmQpOw0KICAgIH0sDQogICAgLyoqDQogICAgICog5qOA5rWL6IqC54K5bm9kZeaYr+WQpuWxnuS6jmJvb2ttYXJr6IqC54K5DQogICAgICogQG5hbWUgaXNCb29rbWFya05vZGUNCiAgICAgKiBAZ3JhbW1hciBVRS5kb20uZG9tVXRpbHMuaXNCb29rbWFya05vZGUobm9kZSkgID0+IHRydWV8ZmFsc2UNCiAgICAgKi8NCiAgICBpc0Jvb2ttYXJrTm9kZTpmdW5jdGlvbiAobm9kZSkgew0KICAgICAgICByZXR1cm4gbm9kZS5ub2RlVHlwZSA9PSAxICYmIG5vZGUuaWQgJiYgL15fYmFpZHVfYm9va21hcmtfL2kudGVzdChub2RlLmlkKTsNCiAgICB9LA0KICAgIC8qKg0KICAgICAqIOiOt+WPluiKgueCuW5vZGXmiYDlnKjnmoR3aW5kb3flr7nosaENCiAgICAgKiBAbmFtZSAgZ2V0V2luZG93DQogICAgICogQGdyYW1tYXIgVUUuZG9tLmRvbVV0aWxzLmdldFdpbmRvdyhub2RlKSAgPT4gd2luZG935a+56LGhDQogICAgICovDQogICAgZ2V0V2luZG93OmZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgIHZhciBkb2MgPSBub2RlLm93bmVyRG9jdW1lbnQgfHwgbm9kZTsNCiAgICAgICAgcmV0dXJuIGRvYy5kZWZhdWx0VmlldyB8fCBkb2MucGFyZW50V2luZG93Ow0KICAgIH0sDQogICAgLyoqDQogICAgICog5b6X5Yiwbm9kZUHkuI5ub2RlQuWFrOWFseeahOelluWFiOiKgueCuQ0KICAgICAqIEBuYW1lICBnZXRDb21tb25BbmNlc3Rvcg0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5nZXRDb21tb25BbmNlc3Rvcihub2RlQSxub2RlQikgID0+IEVsZW1lbnQNCiAgICAgKi8NCiAgICBnZXRDb21tb25BbmNlc3RvcjpmdW5jdGlvbiAobm9kZUEsIG5vZGVCKSB7DQogICAgICAgIGlmIChub2RlQSA9PT0gbm9kZUIpDQogICAgICAgICAgICByZXR1cm4gbm9kZUE7DQogICAgICAgIHZhciBwYXJlbnRzQSA9IFtub2RlQV0gLCBwYXJlbnRzQiA9IFtub2RlQl0sIHBhcmVudCA9IG5vZGVBLCBpID0gLTE7DQogICAgICAgIHdoaWxlIChwYXJlbnQgPSBwYXJlbnQucGFyZW50Tm9kZSkgew0KICAgICAgICAgICAgaWYgKHBhcmVudCA9PT0gbm9kZUIpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gcGFyZW50Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcGFyZW50c0EucHVzaChwYXJlbnQpOw0KICAgICAgICB9DQogICAgICAgIHBhcmVudCA9IG5vZGVCOw0KICAgICAgICB3aGlsZSAocGFyZW50ID0gcGFyZW50LnBhcmVudE5vZGUpIHsNCiAgICAgICAgICAgIGlmIChwYXJlbnQgPT09IG5vZGVBKQ0KICAgICAgICAgICAgICAgIHJldHVybiBwYXJlbnQ7DQogICAgICAgICAgICBwYXJlbnRzQi5wdXNoKHBhcmVudCk7DQogICAgICAgIH0NCiAgICAgICAgcGFyZW50c0EucmV2ZXJzZSgpOw0KICAgICAgICBwYXJlbnRzQi5yZXZlcnNlKCk7DQogICAgICAgIHdoaWxlIChpKyssIHBhcmVudHNBW2ldID09PSBwYXJlbnRzQltpXSkgew0KICAgICAgICB9DQogICAgICAgIHJldHVybiBpID09IDAgPyBudWxsIDogcGFyZW50c0FbaSAtIDFdOw0KDQogICAgfSwNCiAgICAvKioNCiAgICAgKiDmuIXpmaRub2Rl6IqC54K55bem5Y+z5YWE5byf5Li656m655qEaW5saW5l6IqC54K5DQogICAgICogQG5hbWUgY2xlYXJFbXB0eVNpYmxpbmcNCiAgICAgKiBAZ3JhbW1hciBVRS5kb20uZG9tVXRpbHMuY2xlYXJFbXB0eVNpYmxpbmcobm9kZSkNCiAgICAgKiBAZ3JhbW1hciBVRS5kb20uZG9tVXRpbHMuY2xlYXJFbXB0eVNpYmxpbmcobm9kZSxpZ25vcmVOZXh0KSAgLy9pZ25vcmVOZXh05oyH5a6a5piv5ZCm5b+955Wl5Y+z6L6556m66IqC54K5DQogICAgICogQGdyYW1tYXIgVUUuZG9tLmRvbVV0aWxzLmNsZWFyRW1wdHlTaWJsaW5nKG5vZGUsaWdub3JlTmV4dCxpZ25vcmVQcmUpICAvL2lnbm9yZVByZeaMh+WumuaYr+WQpuW/veeVpeW3pui+ueepuuiKgueCuQ0KICAgICAqIEBleGFtcGxlDQogICAgICogPGI+PC9iPjxpPjwvaT54eHh4PGI+YmI8L2I+IC0tPiB4eHh4PGI+YmI8L2I+DQogICAgICovDQogICAgY2xlYXJFbXB0eVNpYmxpbmc6ZnVuY3Rpb24gKG5vZGUsIGlnbm9yZU5leHQsIGlnbm9yZVByZSkgew0KICAgICAgICBmdW5jdGlvbiBjbGVhcihuZXh0LCBkaXIpIHsNCiAgICAgICAgICAgIHZhciB0bXBOb2RlOw0KICAgICAgICAgICAgd2hpbGUgKG5leHQgJiYgIWRvbVV0aWxzLmlzQm9va21hcmtOb2RlKG5leHQpICYmIChkb21VdGlscy5pc0VtcHR5SW5saW5lRWxlbWVudChuZXh0KQ0KICAgICAgICAgICAgICAgIC8v6L+Z6YeM5LiN6IO95oqK56m65qC8566X6L+b5p2l5Lya5ZCn56m65qC85bmy5o6J77yM5Ye6546w5paH5a2X6Ze055qE56m65qC85Lii5o6J5LqGDQogICAgICAgICAgICAgICAgfHwgIW5ldyBSZWdFeHAoJ1teXHRcblxyJyArIGRvbVV0aWxzLmZpbGxDaGFyICsgJ10nKS50ZXN0KG5leHQubm9kZVZhbHVlKSApKSB7DQogICAgICAgICAgICAgICAgdG1wTm9kZSA9IG5leHRbZGlyXTsNCiAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUobmV4dCk7DQogICAgICAgICAgICAgICAgbmV4dCA9IHRtcE5vZGU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgIWlnbm9yZU5leHQgJiYgY2xlYXIobm9kZS5uZXh0U2libGluZywgJ25leHRTaWJsaW5nJyk7DQogICAgICAgICFpZ25vcmVQcmUgJiYgY2xlYXIobm9kZS5wcmV2aW91c1NpYmxpbmcsICdwcmV2aW91c1NpYmxpbmcnKTsNCiAgICB9LA0KICAgIC8qKg0KICAgICAqIOWwhuS4gOS4quaWh+acrOiKgueCuW5vZGXmi4bliIbmiJDkuKTkuKrmlofmnKzoioLngrnvvIxvZmZzZXTmjIflrprmi4bliIbkvY3nva4NCiAgICAgKiBAbmFtZSBzcGxpdA0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5zcGxpdChub2RlLG9mZnNldCkgID0+ICBUZXh0Tm9kZSAgLy/ov5Tlm57ku47liIfliIbkvY3nva7lvIDlp4vnmoTlkI7kuIDkuKrmlofmnKzoioLngrkNCiAgICAgKi8NCiAgICBzcGxpdDpmdW5jdGlvbiAobm9kZSwgb2Zmc2V0KSB7DQogICAgICAgIHZhciBkb2MgPSBub2RlLm93bmVyRG9jdW1lbnQ7DQogICAgICAgIGlmIChicm93c2VyLmllICYmIG9mZnNldCA9PSBub2RlLm5vZGVWYWx1ZS5sZW5ndGgpIHsNCiAgICAgICAgICAgIHZhciBuZXh0ID0gZG9jLmNyZWF0ZVRleHROb2RlKCcnKTsNCiAgICAgICAgICAgIHJldHVybiBkb21VdGlscy5pbnNlcnRBZnRlcihub2RlLCBuZXh0KTsNCiAgICAgICAgfQ0KICAgICAgICB2YXIgcmV0dmFsID0gbm9kZS5zcGxpdFRleHQob2Zmc2V0KTsNCiAgICAgICAgLy9pZTjkuItzcGxpdFRleHTkuI3kvJrot5/mlrBjaGlsZE5vZGVzLOaIkeS7rOaJi+WKqOinpuWPkeS7lueahOabtOaWsA0KICAgICAgICBpZiAoYnJvd3Nlci5pZTgpIHsNCiAgICAgICAgICAgIHZhciB0bXBOb2RlID0gZG9jLmNyZWF0ZVRleHROb2RlKCcnKTsNCiAgICAgICAgICAgIGRvbVV0aWxzLmluc2VydEFmdGVyKHJldHZhbCwgdG1wTm9kZSk7DQogICAgICAgICAgICBkb21VdGlscy5yZW1vdmUodG1wTm9kZSk7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHJldHZhbDsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICog5qOA5rWL6IqC54K5bm9kZeaYr+WQpuS4uuepuuiKgueCue+8iOWMheaLrOepuuagvOOAgeaNouihjOOAgeWNoOS9jeespuetieWtl+espu+8iQ0KICAgICAqIEBuYW1lICBpc1doaXRlc3BhY2UNCiAgICAgKiBAZ3JhbW1hciAgVUUuZG9tLmRvbVV0aWxzLmlzV2hpdGVzcGFjZShub2RlKSAgPT4gdHJ1ZXxmYWxzZQ0KICAgICAqLw0KICAgIGlzV2hpdGVzcGFjZTpmdW5jdGlvbiAobm9kZSkgew0KICAgICAgICByZXR1cm4gIW5ldyBSZWdFeHAoJ1teIFx0XG5ccicgKyBkb21VdGlscy5maWxsQ2hhciArICddJykudGVzdChub2RlLm5vZGVWYWx1ZSk7DQogICAgfSwNCiAgICAvKioNCiAgICAgKiDojrflj5blhYPntKBlbGVtZW5055u45a+55LqOdmlld3BvcnTnmoTkvY3nva7lnZDmoIcNCiAgICAgKiBAbmFtZSBnZXRYWQ0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5nZXRYWShlbGVtZW50KSAgPT4gT2JqZWN0IC8v6L+U5Zue5Z2Q5qCH5a+56LGhe3g6bGVmdCx5OnRvcH0NCiAgICAgKi8NCiAgICBnZXRYWTpmdW5jdGlvbiAoZWxlbWVudCkgew0KICAgICAgICB2YXIgeCA9IDAsIHkgPSAwOw0KICAgICAgICB3aGlsZSAoZWxlbWVudC5vZmZzZXRQYXJlbnQpIHsNCiAgICAgICAgICAgIHkgKz0gZWxlbWVudC5vZmZzZXRUb3A7DQogICAgICAgICAgICB4ICs9IGVsZW1lbnQub2Zmc2V0TGVmdDsNCiAgICAgICAgICAgIGVsZW1lbnQgPSBlbGVtZW50Lm9mZnNldFBhcmVudDsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4geyAneCc6eCwgJ3knOnl9Ow0KICAgIH0sDQogICAgLyoqDQogICAgICog5Li65YWD57SgZWxlbWVudOe7keWumuWOn+eUn0RPTeS6i+S7tu+8jHR5cGXkuLrkuovku7bnsbvlnovvvIxoYW5kbGVy5Li65aSE55CG5Ye95pWwDQogICAgICogQG5hbWUgb24NCiAgICAgKiBAZ3JhbW1hciBVRS5kb20uZG9tVXRpbHMub24oZWxlbWVudCx0eXBlLGhhbmRsZXIpICAgLy90eXBl5pSv5oyB5pWw57uE5Lyg5YWlDQogICAgICogQGV4YW1wbGUNCiAgICAgKiBVRS5kb20uZG9tVXRpbHMub24oZG9jdW1lbnQuYm9keSwiY2xpY2siLGZ1bmN0aW9uKGUpew0KICAgICAqICAgICAvL2XkuLrkuovku7blr7nosaHvvIx0aGlz5Li66KKr54K55Ye75YWD57Sg5a+55oiP6YKj5LiqDQogICAgICogfSkNCiAgICAgKiBAZXhhbXBsZQ0KICAgICAqIFVFLmRvbS5kb21VdGlscy5vbihkb2N1bWVudC5ib2R5LFsiY2xpY2siLCJtb3VzZWRvd24iXSxmdW5jdGlvbihldnQpew0KICAgICAqICAgICAvL2V2dOS4uuS6i+S7tuWvueixoe+8jHRoaXPkuLrooqvngrnlh7vlhYPntKDlr7nosaENCiAgICAgKiB9KQ0KICAgICAqLw0KICAgIG9uOmZ1bmN0aW9uIChlbGVtZW50LCB0eXBlLCBoYW5kbGVyKSB7DQogICAgICAgIHZhciB0eXBlcyA9IHV0aWxzLmlzQXJyYXkodHlwZSkgPyB0eXBlIDogW3R5cGVdLA0KICAgICAgICAgICAgayA9IHR5cGVzLmxlbmd0aDsNCiAgICAgICAgaWYgKGspIHdoaWxlIChrLS0pIHsNCiAgICAgICAgICAgIHR5cGUgPSB0eXBlc1trXTsNCiAgICAgICAgICAgIGlmIChlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIpIHsNCiAgICAgICAgICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgaGFuZGxlciwgZmFsc2UpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpZiAoIWhhbmRsZXIuX2QpIHsNCiAgICAgICAgICAgICAgICAgICAgaGFuZGxlci5fZCA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVscyA6IFtdDQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHZhciBrZXkgPSB0eXBlICsgaGFuZGxlci50b1N0cmluZygpLGluZGV4ID0gdXRpbHMuaW5kZXhPZihoYW5kbGVyLl9kLmVscyxlbGVtZW50KTsNCiAgICAgICAgICAgICAgICBpZiAoIWhhbmRsZXIuX2Rba2V5XSB8fCBpbmRleCA9PSAtMSkgew0KICAgICAgICAgICAgICAgICAgICBpZihpbmRleCA9PSAtMSl7DQogICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyLl9kLmVscy5wdXNoKGVsZW1lbnQpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmKCFoYW5kbGVyLl9kW2tleV0pew0KICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlci5fZFtrZXldID0gZnVuY3Rpb24gKGV2dCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBoYW5kbGVyLmNhbGwoZXZ0LnNyY0VsZW1lbnQsIGV2dCB8fCB3aW5kb3cuZXZlbnQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hdHRhY2hFdmVudCgnb24nICsgdHlwZSwgaGFuZGxlci5fZFtrZXldKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgZWxlbWVudCA9IG51bGw7DQogICAgfSwNCiAgICAvKioNCiAgICAgKiDop6PpmaTljp/nlJ9ET03kuovku7bnu5HlrpoNCiAgICAgKiBAbmFtZSB1bg0KICAgICAqIEBncmFtbWFyICBVRS5kb20uZG9uVXRpbHMudW4oZWxlbWVudCx0eXBlLGhhbmRsZXIpICAvL+WPguingTxjb2RlPjxhIGhyZWY9IiNvbiI+b248L2E+PC9jb2RlPg0KICAgICAqLw0KICAgIHVuOmZ1bmN0aW9uIChlbGVtZW50LCB0eXBlLCBoYW5kbGVyKSB7DQogICAgICAgIHZhciB0eXBlcyA9IHV0aWxzLmlzQXJyYXkodHlwZSkgPyB0eXBlIDogW3R5cGVdLA0KICAgICAgICAgICAgayA9IHR5cGVzLmxlbmd0aDsNCiAgICAgICAgaWYgKGspIHdoaWxlIChrLS0pIHsNCiAgICAgICAgICAgIHR5cGUgPSB0eXBlc1trXTsNCiAgICAgICAgICAgIGlmIChlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIpIHsNCiAgICAgICAgICAgICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgaGFuZGxlciwgZmFsc2UpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB2YXIga2V5ID0gdHlwZSArIGhhbmRsZXIudG9TdHJpbmcoKTsNCiAgICAgICAgICAgICAgICB0cnl7DQogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZGV0YWNoRXZlbnQoJ29uJyArIHR5cGUsIGhhbmRsZXIuX2QgPyBoYW5kbGVyLl9kW2tleV0gOiBoYW5kbGVyKTsNCiAgICAgICAgICAgICAgICB9Y2F0Y2goZSl7fQ0KICAgICAgICAgICAgICAgIGlmIChoYW5kbGVyLl9kICYmIGhhbmRsZXIuX2Rba2V5XSkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSB1dGlscy5pbmRleE9mKGhhbmRsZXIuX2QuZWxzLGVsZW1lbnQpOw0KICAgICAgICAgICAgICAgICAgICBpZihpbmRleCE9LTEpew0KICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlci5fZC5lbHMuc3BsaWNlKGluZGV4LDEpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGhhbmRsZXIuX2QuZWxzLmxlbmd0aCA9PSAwICYmIGRlbGV0ZSBoYW5kbGVyLl9kW2tleV07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIOavlOi+g+iKgueCuW5vZGVB5LiO6IqC54K5bm9kZULmmK/lkKblhbfmnInnm7jlkIznmoTmoIfnrb7lkI3jgIHlsZ7mgKflkI3ku6Xlj4rlsZ7mgKflgLwNCiAgICAgKiBAbmFtZSAgaXNTYW1lRWxlbWVudA0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5pc1NhbWVFbGVtZW50KG5vZGVBLG5vZGVCKSA9PiB0cnVlfGZhbHNlDQogICAgICogQGV4YW1wbGUNCiAgICAgKiA8c3BhbiAgc3R5bGU9ImZvbnQtc2l6ZToxMnB4Ij5zc3NzPC9zcGFuPiBhbmQgPHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMnB4Ij5iYmJiYjwvc3Bhbj4gICA9PiB0cnVlDQogICAgICogPHNwYW4gIHN0eWxlPSJmb250LXNpemU6MTNweCI+c3Nzczwvc3Bhbj4gYW5kIDxzcGFuIHN0eWxlPSJmb250LXNpemU6MTJweCI+YmJiYmI8L3NwYW4+ICAgPT4gZmFsc2UNCiAgICAgKi8NCiAgICBpc1NhbWVFbGVtZW50OmZ1bmN0aW9uIChub2RlQSwgbm9kZUIpIHsNCiAgICAgICAgaWYgKG5vZGVBLnRhZ05hbWUgIT0gbm9kZUIudGFnTmFtZSkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgIHZhciB0aGlzQXR0cnMgPSBub2RlQS5hdHRyaWJ1dGVzLA0KICAgICAgICAgICAgb3RoZXJBdHRycyA9IG5vZGVCLmF0dHJpYnV0ZXM7DQogICAgICAgIGlmICghaWUgJiYgdGhpc0F0dHJzLmxlbmd0aCAhPSBvdGhlckF0dHJzLmxlbmd0aCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgIHZhciBhdHRyQSwgYXR0ckIsIGFsID0gMCwgYmwgPSAwOw0KICAgICAgICBmb3IgKHZhciBpID0gMDsgYXR0ckEgPSB0aGlzQXR0cnNbaSsrXTspIHsNCiAgICAgICAgICAgIGlmIChhdHRyQS5ub2RlTmFtZSA9PSAnc3R5bGUnKSB7DQogICAgICAgICAgICAgICAgaWYgKGF0dHJBLnNwZWNpZmllZCkgew0KICAgICAgICAgICAgICAgICAgICBhbCsrOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoZG9tVXRpbHMuaXNTYW1lU3R5bGUobm9kZUEsIG5vZGVCKSkgew0KICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKGllKSB7DQogICAgICAgICAgICAgICAgaWYgKGF0dHJBLnNwZWNpZmllZCkgew0KICAgICAgICAgICAgICAgICAgICBhbCsrOw0KICAgICAgICAgICAgICAgICAgICBhdHRyQiA9IG90aGVyQXR0cnMuZ2V0TmFtZWRJdGVtKGF0dHJBLm5vZGVOYW1lKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGF0dHJCID0gbm9kZUIuYXR0cmlidXRlc1thdHRyQS5ub2RlTmFtZV07DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIWF0dHJCLnNwZWNpZmllZCB8fCBhdHRyQS5ub2RlVmFsdWUgIT0gYXR0ckIubm9kZVZhbHVlKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIC8vIOacieWPr+iDvWF0dHJC55qE5bGe5oCn5YyF5ZCr5LqGYXR0ckHnmoTlsZ7mgKfkuYvlpJbov5jmnInoh6rlt7HnmoTlsZ7mgKcNCiAgICAgICAgaWYgKGllKSB7DQogICAgICAgICAgICBmb3IgKGkgPSAwOyBhdHRyQiA9IG90aGVyQXR0cnNbaSsrXTspIHsNCiAgICAgICAgICAgICAgICBpZiAoYXR0ckIuc3BlY2lmaWVkKSB7DQogICAgICAgICAgICAgICAgICAgIGJsKys7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKGFsICE9IGJsKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiDliKTmlq3oioLngrlub2RlQeS4juiKgueCuW5vZGVC55qE5YWD57Sg5bGe5oCn5piv5ZCm5LiA6Ie0DQogICAgICogQG5hbWUgaXNTYW1lU3R5bGUNCiAgICAgKiBAZ3JhbW1hciBVRS5kb20uZG9tVXRpbHMuaXNTYW1lU3R5bGUobm9kZUEsbm9kZUIpID0+IHRydWV8ZmFsc2UNCiAgICAgKi8NCiAgICBpc1NhbWVTdHlsZTpmdW5jdGlvbiAobm9kZUEsIG5vZGVCKSB7DQogICAgICAgIHZhciBzdHlsZUEgPSBub2RlQS5zdHlsZS5jc3NUZXh0LnJlcGxhY2UoLyggPzsgPykvZywgJzsnKS5yZXBsYWNlKC8oID86ID8pL2csICc6JyksDQogICAgICAgICAgICBzdHlsZUIgPSBub2RlQi5zdHlsZS5jc3NUZXh0LnJlcGxhY2UoLyggPzsgPykvZywgJzsnKS5yZXBsYWNlKC8oID86ID8pL2csICc6Jyk7DQogICAgICAgIGlmIChicm93c2VyLm9wZXJhKSB7DQogICAgICAgICAgICBzdHlsZUEgPSBub2RlQS5zdHlsZTsNCiAgICAgICAgICAgIHN0eWxlQiA9IG5vZGVCLnN0eWxlOw0KICAgICAgICAgICAgaWYgKHN0eWxlQS5sZW5ndGggIT0gc3R5bGVCLmxlbmd0aCkNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICBmb3IgKHZhciBwIGluIHN0eWxlQSkgew0KICAgICAgICAgICAgICAgIGlmICgvXihcZCt8Y3NzdGV4dCkkL2kudGVzdChwKSkgew0KICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKHN0eWxlQVtwXSAhPSBzdHlsZUJbcF0pIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQogICAgICAgIGlmICghc3R5bGVBIHx8ICFzdHlsZUIpIHsNCiAgICAgICAgICAgIHJldHVybiBzdHlsZUEgPT0gc3R5bGVCOw0KICAgICAgICB9DQogICAgICAgIHN0eWxlQSA9IHN0eWxlQS5zcGxpdCgnOycpOw0KICAgICAgICBzdHlsZUIgPSBzdHlsZUIuc3BsaXQoJzsnKTsNCiAgICAgICAgaWYgKHN0eWxlQS5sZW5ndGggIT0gc3R5bGVCLmxlbmd0aCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgIGZvciAodmFyIGkgPSAwLCBjaTsgY2kgPSBzdHlsZUFbaSsrXTspIHsNCiAgICAgICAgICAgIGlmICh1dGlscy5pbmRleE9mKHN0eWxlQiwgY2kpID09IC0xKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0sDQogICAgLyoqDQogICAgICog5qOA5p+l6IqC54K5bm9kZeaYr+WQpuS4uuWdl+WFg+e0oA0KICAgICAqIEBuYW1lIGlzQmxvY2tFbG0NCiAgICAgKiBAZ3JhbW1hciBVRS5kb20uZG9tVXRpbHMuaXNCbG9ja0VsbShub2RlKSAgPT4gdHJ1ZXxmYWxzZQ0KICAgICAqLw0KICAgIGlzQmxvY2tFbG06ZnVuY3Rpb24gKG5vZGUpIHsNCiAgICAgICAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT0gMSAmJiAoZHRkLiRibG9ja1tub2RlLnRhZ05hbWVdIHx8IHN0eWxlQmxvY2tbZG9tVXRpbHMuZ2V0Q29tcHV0ZWRTdHlsZShub2RlLCAnZGlzcGxheScpXSkgJiYgIWR0ZC4kbm9uQ2hpbGRbbm9kZS50YWdOYW1lXTsNCiAgICB9LA0KICAgIC8qKg0KICAgICAqIOajgOa1i25vZGXoioLngrnmmK/lkKbkuLpib2R56IqC54K5DQogICAgICogQG5hbWUgaXNCb2R5DQogICAgICogQGdyYW1tYXIgVUUuZG9tLmRvbVV0aWxzLmlzQm9keShub2RlKSAgID0+IHRydWV8ZmFsc2UNCiAgICAgKi8NCiAgICBpc0JvZHk6ZnVuY3Rpb24gKG5vZGUpIHsNCiAgICAgICAgcmV0dXJuICBub2RlICYmIG5vZGUubm9kZVR5cGUgPT0gMSAmJiBub2RlLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PSAnYm9keSc7DQogICAgfSwNCiAgICAvKioNCiAgICAgKiDku6Vub2Rl6IqC54K55Li65Lit5b+D77yM5bCG6K+l6IqC54K555qE5oyH5a6a56WW5YWI6IqC54K5cGFyZW505ouG5YiG5oiQMuWdlw0KICAgICAqIEBuYW1lICBicmVha1BhcmVudA0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5icmVha1BhcmVudChub2RlLHBhcmVudCkgPT4gbm9kZQ0KICAgICAqIEBkZXNjDQogICAgICogPGNvZGUgdHlwZT0iaHRtbCI+PGI+b29vPC9iPuaYr25vZGXoioLngrkNCiAgICAgKiA8cD54eHh4PGI+b29vPC9iPnh4eDwvcD4gPT0+IDxwPnh4eDwvcD48Yj5vb288L2I+PHA+eHh4PC9wPg0KICAgICAqIDxwPnh4eHh4PHNwYW4+eHh4eDxiPm9vbzwvYj54eHh4eHg8L3NwYW4+PC9wPiAgID0+ICAgPHA+eHh4eHg8c3Bhbj54eHh4PC9zcGFuPjwvcD48Yj5vb288L2I+PHA+PHNwYW4+eHh4eHh4PC9zcGFuPjwvcD48L2NvZGU+DQogICAgICovDQogICAgYnJlYWtQYXJlbnQ6ZnVuY3Rpb24gKG5vZGUsIHBhcmVudCkgew0KICAgICAgICB2YXIgdG1wTm9kZSwNCiAgICAgICAgICAgIHBhcmVudENsb25lID0gbm9kZSwNCiAgICAgICAgICAgIGNsb25lID0gbm9kZSwNCiAgICAgICAgICAgIGxlZnROb2RlcywNCiAgICAgICAgICAgIHJpZ2h0Tm9kZXM7DQogICAgICAgIGRvIHsNCiAgICAgICAgICAgIHBhcmVudENsb25lID0gcGFyZW50Q2xvbmUucGFyZW50Tm9kZTsNCiAgICAgICAgICAgIGlmIChsZWZ0Tm9kZXMpIHsNCiAgICAgICAgICAgICAgICB0bXBOb2RlID0gcGFyZW50Q2xvbmUuY2xvbmVOb2RlKGZhbHNlKTsNCiAgICAgICAgICAgICAgICB0bXBOb2RlLmFwcGVuZENoaWxkKGxlZnROb2Rlcyk7DQogICAgICAgICAgICAgICAgbGVmdE5vZGVzID0gdG1wTm9kZTsNCiAgICAgICAgICAgICAgICB0bXBOb2RlID0gcGFyZW50Q2xvbmUuY2xvbmVOb2RlKGZhbHNlKTsNCiAgICAgICAgICAgICAgICB0bXBOb2RlLmFwcGVuZENoaWxkKHJpZ2h0Tm9kZXMpOw0KICAgICAgICAgICAgICAgIHJpZ2h0Tm9kZXMgPSB0bXBOb2RlOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBsZWZ0Tm9kZXMgPSBwYXJlbnRDbG9uZS5jbG9uZU5vZGUoZmFsc2UpOw0KICAgICAgICAgICAgICAgIHJpZ2h0Tm9kZXMgPSBsZWZ0Tm9kZXMuY2xvbmVOb2RlKGZhbHNlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHdoaWxlICh0bXBOb2RlID0gY2xvbmUucHJldmlvdXNTaWJsaW5nKSB7DQogICAgICAgICAgICAgICAgbGVmdE5vZGVzLmluc2VydEJlZm9yZSh0bXBOb2RlLCBsZWZ0Tm9kZXMuZmlyc3RDaGlsZCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB3aGlsZSAodG1wTm9kZSA9IGNsb25lLm5leHRTaWJsaW5nKSB7DQogICAgICAgICAgICAgICAgcmlnaHROb2Rlcy5hcHBlbmRDaGlsZCh0bXBOb2RlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGNsb25lID0gcGFyZW50Q2xvbmU7DQogICAgICAgIH0gd2hpbGUgKHBhcmVudCAhPT0gcGFyZW50Q2xvbmUpOw0KICAgICAgICB0bXBOb2RlID0gcGFyZW50LnBhcmVudE5vZGU7DQogICAgICAgIHRtcE5vZGUuaW5zZXJ0QmVmb3JlKGxlZnROb2RlcywgcGFyZW50KTsNCiAgICAgICAgdG1wTm9kZS5pbnNlcnRCZWZvcmUocmlnaHROb2RlcywgcGFyZW50KTsNCiAgICAgICAgdG1wTm9kZS5pbnNlcnRCZWZvcmUobm9kZSwgcmlnaHROb2Rlcyk7DQogICAgICAgIGRvbVV0aWxzLnJlbW92ZShwYXJlbnQpOw0KICAgICAgICByZXR1cm4gbm9kZTsNCiAgICB9LA0KICAgIC8qKg0KICAgICAqIOajgOafpeiKgueCuW5vZGXmmK/lkKbmmK/nqbppbmxpbmXoioLngrkNCiAgICAgKiBAbmFtZSAgaXNFbXB0eUlubGluZUVsZW1lbnQNCiAgICAgKiBAZ3JhbW1hciAgIFVFLmRvbS5kb21VdGlscy5pc0VtcHR5SW5saW5lRWxlbWVudChub2RlKSAgPT4gMXwwDQogICAgICogQGV4YW1wbGUNCiAgICAgKiA8Yj48aT48L2k+PC9iPiA9PiAxDQogICAgICogPGI+PGk+PC9pPjx1PjwvdT48L2I+ID0+IDENCiAgICAgKiA8Yj48L2I+ID0+IDENCiAgICAgKiA8Yj54eDxpPjwvaT48L2I+ID0+IDANCiAgICAgKi8NCiAgICBpc0VtcHR5SW5saW5lRWxlbWVudDpmdW5jdGlvbiAobm9kZSkgew0KICAgICAgICBpZiAobm9kZS5ub2RlVHlwZSAhPSAxIHx8ICFkdGQuJHJlbW92ZUVtcHR5WyBub2RlLnRhZ05hbWUgXSkgew0KICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgIH0NCiAgICAgICAgbm9kZSA9IG5vZGUuZmlyc3RDaGlsZDsNCiAgICAgICAgd2hpbGUgKG5vZGUpIHsNCiAgICAgICAgICAgIC8v5aaC5p6c5piv5Yib5bu655qEYm9va21hcmvlsLHot7Pov4cNCiAgICAgICAgICAgIGlmIChkb21VdGlscy5pc0Jvb2ttYXJrTm9kZShub2RlKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT0gMSAmJiAhZG9tVXRpbHMuaXNFbXB0eUlubGluZUVsZW1lbnQobm9kZSkgfHwNCiAgICAgICAgICAgICAgICBub2RlLm5vZGVUeXBlID09IDMgJiYgIWRvbVV0aWxzLmlzV2hpdGVzcGFjZShub2RlKQ0KICAgICAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgbm9kZSA9IG5vZGUubmV4dFNpYmxpbmc7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIDE7DQoNCiAgICB9LA0KDQogICAgLyoqDQogICAgICog5Yig6Zmkbm9kZeiKgueCueS4i+eahOW3puWPs+epuueZveaWh+acrOWtkOiKgueCuQ0KICAgICAqIEBuYW1lIHRyaW1XaGl0ZVRleHROb2RlDQogICAgICogQGdyYW1tYXIgVUUuZG9tLmRvbVV0aWxzLnRyaW1XaGl0ZVRleHROb2RlKG5vZGUpDQogICAgICovDQogICAgdHJpbVdoaXRlVGV4dE5vZGU6ZnVuY3Rpb24gKG5vZGUpIHsNCiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlKGRpcikgew0KICAgICAgICAgICAgdmFyIGNoaWxkOw0KICAgICAgICAgICAgd2hpbGUgKChjaGlsZCA9IG5vZGVbZGlyXSkgJiYgY2hpbGQubm9kZVR5cGUgPT0gMyAmJiBkb21VdGlscy5pc1doaXRlc3BhY2UoY2hpbGQpKSB7DQogICAgICAgICAgICAgICAgbm9kZS5yZW1vdmVDaGlsZChjaGlsZCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmVtb3ZlKCdmaXJzdENoaWxkJyk7DQogICAgICAgIHJlbW92ZSgnbGFzdENoaWxkJyk7DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIOWQiOW5tm5vZGXoioLngrnkuIvnm7jlkIznmoTlrZDoioLngrkNCiAgICAgKiBAbmFtZSBtZXJnZUNoaWxkDQogICAgICogQGRlc2MNCiAgICAgKiBVRS5kb20uZG9tVXRpbHMubWVyZ2VDaGlsZChub2RlLHRhZ05hbWUpIC8vdGFnTmFtZeimgeWQiOW5tueahOWtkOiKgueCueeahOagh+etvg0KICAgICAqIEBleGFtcGxlDQogICAgICogPHA+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMnB4OyI+eHg8c3BhbiBzdHlsZT0iZm9udC1zaXplOjEycHg7Ij5hYTwvc3Bhbj54eDwvc3Bhbj48L3A+DQogICAgICogPT0+IFVFLmRvbS5kb21VdGlscy5tZXJnZUNoaWxkKG5vZGUsJ3NwYW4nKQ0KICAgICAqIDxwPjxzcGFuIHN0eWxlPSJmb250LXNpemU6MTJweDsiPnh4YWF4eDwvc3Bhbj48L3A+DQogICAgICovDQogICAgbWVyZ2VDaGlsZDpmdW5jdGlvbiAobm9kZSwgdGFnTmFtZSwgYXR0cnMpIHsNCiAgICAgICAgdmFyIGxpc3QgPSBkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZShub2RlLCBub2RlLnRhZ05hbWUudG9Mb3dlckNhc2UoKSk7DQogICAgICAgIGZvciAodmFyIGkgPSAwLCBjaTsgY2kgPSBsaXN0W2krK107KSB7DQogICAgICAgICAgICBpZiAoIWNpLnBhcmVudE5vZGUgfHwgZG9tVXRpbHMuaXNCb29rbWFya05vZGUoY2kpKSB7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAvL3NwYW7ljZXni6zlpITnkIYNCiAgICAgICAgICAgIGlmIChjaS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT0gJ3NwYW4nKSB7DQogICAgICAgICAgICAgICAgaWYgKG5vZGUgPT09IGNpLnBhcmVudE5vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMudHJpbVdoaXRlVGV4dE5vZGUobm9kZSk7DQogICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmNoaWxkTm9kZXMubGVuZ3RoID09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuc3R5bGUuY3NzVGV4dCA9IGNpLnN0eWxlLmNzc1RleHQgKyAiOyIgKyBub2RlLnN0eWxlLmNzc1RleHQ7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUoY2ksIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgY2kuc3R5bGUuY3NzVGV4dCA9IG5vZGUuc3R5bGUuY3NzVGV4dCArICc7JyArIGNpLnN0eWxlLmNzc1RleHQ7DQogICAgICAgICAgICAgICAgaWYgKGF0dHJzKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBzdHlsZSA9IGF0dHJzLnN0eWxlOw0KICAgICAgICAgICAgICAgICAgICBpZiAoc3R5bGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlID0gc3R5bGUuc3BsaXQoJzsnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwLCBzOyBzID0gc3R5bGVbaisrXTspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaS5zdHlsZVt1dGlscy5jc3NTdHlsZVRvRG9tU3R5bGUocy5zcGxpdCgnOicpWzBdKV0gPSBzLnNwbGl0KCc6JylbMV07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKGRvbVV0aWxzLmlzU2FtZVN0eWxlKGNpLCBub2RlKSkgew0KICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUoY2ksIHRydWUpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChkb21VdGlscy5pc1NhbWVFbGVtZW50KG5vZGUsIGNpKSkgew0KICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShjaSwgdHJ1ZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9LA0KDQogICAgLyoqDQogICAgICog5Y6f55Sf5pa55rOVZ2V0RWxlbWVudHNCeVRhZ05hbWXnmoTlsIHoo4UNCiAgICAgKiBAbmFtZSBnZXRFbGVtZW50c0J5VGFnTmFtZQ0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZShub2RlLHRhZ05hbWUpICA9PiBBcnJheSAgLy/oioLngrnpm4blkIjmlbDnu4QNCiAgICAgKi8NCiAgICBnZXRFbGVtZW50c0J5VGFnTmFtZTpmdW5jdGlvbiAobm9kZSwgbmFtZSxmaWx0ZXIpIHsNCiAgICAgICAgaWYoZmlsdGVyICYmIHV0aWxzLmlzU3RyaW5nKGZpbHRlcikpew0KICAgICAgICAgICB2YXIgY2xhc3NOYW1lID0gZmlsdGVyOw0KICAgICAgICAgICBmaWx0ZXIgPSAgZnVuY3Rpb24obm9kZSl7cmV0dXJuIGRvbVV0aWxzLmhhc0NsYXNzKG5vZGUsY2xhc3NOYW1lKX0NCiAgICAgICAgfQ0KICAgICAgICBuYW1lID0gdXRpbHMudHJpbShuYW1lKS5yZXBsYWNlKC9bIF17Mix9L2csJyAnKS5zcGxpdCgnICcpOw0KICAgICAgICB2YXIgYXJyID0gW107DQogICAgICAgIGZvcih2YXIgbiA9IDAsbmk7bmk9bmFtZVtuKytdOyl7DQogICAgICAgICAgICB2YXIgbGlzdCA9IG5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUobmkpOw0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNpOyBjaSA9IGxpc3RbaSsrXTspIHsNCiAgICAgICAgICAgICAgICBpZighZmlsdGVyIHx8IGZpbHRlcihjaSkpDQogICAgICAgICAgICAgICAgICAgIGFyci5wdXNoKGNpKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBhcnI7DQogICAgfSwNCiAgICAvKioNCiAgICAgKiDlsIboioLngrlub2Rl5ZCI5bm25Yiw54i26IqC54K55LiKDQogICAgICogQG5hbWUgbWVyZ2VUb1BhcmVudA0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5tZXJnZVRvUGFyZW50KG5vZGUpDQogICAgICogQGV4YW1wbGUNCiAgICAgKiA8c3BhbiBzdHlsZT0iY29sb3I6I2ZmZiI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMnB4Ij54eHg8L3NwYW4+PC9zcGFuPiA9PT4gPHNwYW4gc3R5bGU9ImNvbG9yOiNmZmY7Zm9udC1zaXplOjEycHgiPnh4eDwvc3Bhbj4NCiAgICAgKi8NCiAgICBtZXJnZVRvUGFyZW50OmZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgIHZhciBwYXJlbnQgPSBub2RlLnBhcmVudE5vZGU7DQogICAgICAgIHdoaWxlIChwYXJlbnQgJiYgZHRkLiRyZW1vdmVFbXB0eVtwYXJlbnQudGFnTmFtZV0pIHsNCiAgICAgICAgICAgIGlmIChwYXJlbnQudGFnTmFtZSA9PSBub2RlLnRhZ05hbWUgfHwgcGFyZW50LnRhZ05hbWUgPT0gJ0EnKSB7Ly/pkojlr7lh5qCH562+5Y2V54us5aSE55CGDQogICAgICAgICAgICAgICAgZG9tVXRpbHMudHJpbVdoaXRlVGV4dE5vZGUocGFyZW50KTsNCiAgICAgICAgICAgICAgICAvL3NwYW7pnIDopoHnibnmrorlpITnkIYgIOS4jeWkhOeQhui/meagt+eahOaDheWGtSA8c3BhbiBzdGx5ZT0iY29sb3I6I2ZmZiI+eHh4PHNwYW4gc3R5bGU9ImNvbG9yOiNjY2MiPnh4eDwvc3Bhbj54eHg8L3NwYW4+DQogICAgICAgICAgICAgICAgaWYgKHBhcmVudC50YWdOYW1lID09ICdTUEFOJyAmJiAhZG9tVXRpbHMuaXNTYW1lU3R5bGUocGFyZW50LCBub2RlKQ0KICAgICAgICAgICAgICAgICAgICB8fCAocGFyZW50LnRhZ05hbWUgPT0gJ0EnICYmIG5vZGUudGFnTmFtZSA9PSAnU1BBTicpKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnQuY2hpbGROb2Rlcy5sZW5ndGggPiAxIHx8IHBhcmVudCAhPT0gbm9kZS5wYXJlbnROb2RlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBub2RlLnN0eWxlLmNzc1RleHQgPSBwYXJlbnQuc3R5bGUuY3NzVGV4dCArICI7IiArIG5vZGUuc3R5bGUuY3NzVGV4dDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnROb2RlOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuc3R5bGUuY3NzVGV4dCArPSAiOyIgKyBub2RlLnN0eWxlLmNzc1RleHQ7DQogICAgICAgICAgICAgICAgICAgICAgICAvL3RyYWNlOjk1MiBh5qCH562+6KaB5L+d5oyB5LiL5YiS57q/DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50LnRhZ05hbWUgPT0gJ0EnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50LnN0eWxlLnRleHREZWNvcmF0aW9uID0gJ3VuZGVybGluZSc7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKHBhcmVudC50YWdOYW1lICE9ICdBJykgew0KICAgICAgICAgICAgICAgICAgICBwYXJlbnQgPT09IG5vZGUucGFyZW50Tm9kZSAmJiBkb21VdGlscy5yZW1vdmUobm9kZSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnROb2RlOw0KICAgICAgICB9DQogICAgfSwNCiAgICAvKioNCiAgICAgKiDlkIjlubboioLngrlub2Rl55qE5bem5Y+z5YWE5byf6IqC54K5DQogICAgICogQG5hbWUgbWVyZ2VTaWJsaW5nDQogICAgICogQGdyYW1tYXIgVUUuZG9tLmRvbVV0aWxzLm1lcmdlU2libGluZyhub2RlKQ0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5tZXJnZVNpYmxpbmcobm9kZSxpZ25vcmVQcmUpICAgIC8vaWdub3JlUHJl5oyH5a6a5piv5ZCm5b+955Wl5bem5YWE5byfDQogICAgICogQGdyYW1tYXIgVUUuZG9tLmRvbVV0aWxzLm1lcmdlU2libGluZyhub2RlLGlnbm9yZVByZSxpZ25vcmVOZXh0KSAgLy9pZ25vcmVOZXh05oyH5a6a5piv5ZCm5b+955Wl5Y+z5YWE5byfDQogICAgICogQGV4YW1wbGUNCiAgICAgKiA8Yj54eHh4PC9iPjxiPm9vbzwvYj48Yj54eHh4PC9iPiA9PT4gPGI+eHh4eG9vb3h4eHg8L2I+DQogICAgICovDQogICAgbWVyZ2VTaWJsaW5nOmZ1bmN0aW9uIChub2RlLCBpZ25vcmVQcmUsIGlnbm9yZU5leHQpIHsNCiAgICAgICAgZnVuY3Rpb24gbWVyZ2UocnRsLCBzdGFydCwgbm9kZSkgew0KICAgICAgICAgICAgdmFyIG5leHQ7DQogICAgICAgICAgICBpZiAoKG5leHQgPSBub2RlW3J0bF0pICYmICFkb21VdGlscy5pc0Jvb2ttYXJrTm9kZShuZXh0KSAmJiBuZXh0Lm5vZGVUeXBlID09IDEgJiYgZG9tVXRpbHMuaXNTYW1lRWxlbWVudChub2RlLCBuZXh0KSkgew0KICAgICAgICAgICAgICAgIHdoaWxlIChuZXh0LmZpcnN0Q2hpbGQpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0ID09ICdmaXJzdENoaWxkJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5pbnNlcnRCZWZvcmUobmV4dC5sYXN0Q2hpbGQsIG5vZGUuZmlyc3RDaGlsZCk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBub2RlLmFwcGVuZENoaWxkKG5leHQuZmlyc3RDaGlsZCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKG5leHQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgICFpZ25vcmVQcmUgJiYgbWVyZ2UoJ3ByZXZpb3VzU2libGluZycsICdmaXJzdENoaWxkJywgbm9kZSk7DQogICAgICAgICFpZ25vcmVOZXh0ICYmIG1lcmdlKCduZXh0U2libGluZycsICdsYXN0Q2hpbGQnLCBub2RlKTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICog6K6+572u6IqC54K5bm9kZeWPiuWFtuWtkOiKgueCueS4jeS8muiiq+mAieS4rQ0KICAgICAqIEBuYW1lIHVuU2VsZWN0YWJsZQ0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy51blNlbGVjdGFibGUobm9kZSkNCiAgICAgKi8NCiAgICB1blNlbGVjdGFibGU6aWUgfHwgYnJvd3Nlci5vcGVyYSA/IGZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgIC8vZm9yIGllOQ0KICAgICAgICBub2RlLm9uc2VsZWN0c3RhcnQgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH07DQogICAgICAgIG5vZGUub25jbGljayA9IG5vZGUub25rZXl1cCA9IG5vZGUub25rZXlkb3duID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9Ow0KICAgICAgICBub2RlLnVuc2VsZWN0YWJsZSA9ICdvbic7DQogICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCJ1bnNlbGVjdGFibGUiLCAib24iKTsNCiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNpOyBjaSA9IG5vZGUuYWxsW2krK107KSB7DQogICAgICAgICAgICBzd2l0Y2ggKGNpLnRhZ05hbWUudG9Mb3dlckNhc2UoKSkgew0KICAgICAgICAgICAgICAgIGNhc2UgJ2lmcmFtZScgOg0KICAgICAgICAgICAgICAgIGNhc2UgJ3RleHRhcmVhJyA6DQogICAgICAgICAgICAgICAgY2FzZSAnaW5wdXQnIDoNCiAgICAgICAgICAgICAgICBjYXNlICdzZWxlY3QnIDoNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgZGVmYXVsdCA6DQogICAgICAgICAgICAgICAgICAgIGNpLnVuc2VsZWN0YWJsZSA9ICdvbic7DQogICAgICAgICAgICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCJ1bnNlbGVjdGFibGUiLCAib24iKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0gOiBmdW5jdGlvbiAobm9kZSkgew0KICAgICAgICBub2RlLnN0eWxlLk1velVzZXJTZWxlY3QgPQ0KICAgICAgICAgICAgbm9kZS5zdHlsZS53ZWJraXRVc2VyU2VsZWN0ID0NCiAgICAgICAgICAgICAgICBub2RlLnN0eWxlLktodG1sVXNlclNlbGVjdCA9ICdub25lJzsNCiAgICB9LA0KICAgIC8qKg0KICAgICAqIOWIoOmZpOiKgueCuW5vZGXkuIrnmoTlsZ7mgKdhdHRyTmFtZXPvvIxhdHRyTmFtZXPkuLrlsZ7mgKflkI3np7DmlbDnu4QNCiAgICAgKiBAbmFtZSAgcmVtb3ZlQXR0cmlidXRlcw0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5yZW1vdmVBdHRyaWJ1dGVzKG5vZGUsYXR0ck5hbWVzKQ0KICAgICAqIEBleGFtcGxlDQogICAgICogLy9CZWZvcmUgcmVtb3ZlDQogICAgICogPHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxNHB4OyIgaWQ9InRlc3QiIG5hbWU9ImZvbGxvd01lIj54eHh4eDwvc3Bhbj4NCiAgICAgKiAvL1JlbW92ZQ0KICAgICAqIFVFLmRvbS5kb21VdGlscy5yZW1vdmVBdHRyaWJ1dGVzKG5vZGUsWyJpZCIsIm5hbWUiXSk7DQogICAgICogLy9BZnRlciByZW1vdmUNCiAgICAgKiA8c3BhbiBzdHlsZT0iZm9udC1zaXplOjE0cHg7Ij54eHh4eDwvc3Bhbj4NCiAgICAgKi8NCiAgICByZW1vdmVBdHRyaWJ1dGVzOmZ1bmN0aW9uIChub2RlLCBhdHRyTmFtZXMpIHsNCiAgICAgICAgYXR0ck5hbWVzID0gdXRpbHMuaXNBcnJheShhdHRyTmFtZXMpID8gYXR0ck5hbWVzIDogdXRpbHMudHJpbShhdHRyTmFtZXMpLnJlcGxhY2UoL1sgXXsyLH0vZywnICcpLnNwbGl0KCcgJyk7DQogICAgICAgIGZvciAodmFyIGkgPSAwLCBjaTsgY2kgPSBhdHRyTmFtZXNbaSsrXTspIHsNCiAgICAgICAgICAgIGNpID0gYXR0ckZpeFtjaV0gfHwgY2k7DQogICAgICAgICAgICBzd2l0Y2ggKGNpKSB7DQogICAgICAgICAgICAgICAgY2FzZSAnY2xhc3NOYW1lJzoNCiAgICAgICAgICAgICAgICAgICAgbm9kZVtjaV0gPSAnJzsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAnc3R5bGUnOg0KICAgICAgICAgICAgICAgICAgICBub2RlLnN0eWxlLmNzc1RleHQgPSAnJzsNCiAgICAgICAgICAgICAgICAgICAgIWJyb3dzZXIuaWUgJiYgbm9kZS5yZW1vdmVBdHRyaWJ1dGVOb2RlKG5vZGUuZ2V0QXR0cmlidXRlTm9kZSgnc3R5bGUnKSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIG5vZGUucmVtb3ZlQXR0cmlidXRlKGNpKTsNCiAgICAgICAgfQ0KICAgIH0sDQogICAgLyoqDQogICAgICog5ZyoZG9j5LiL5Yib5bu65LiA5Liq5qCH562+5ZCN5Li6dGFn77yM5bGe5oCn5Li6YXR0cnPnmoTlhYPntKANCiAgICAgKiBAbmFtZSBjcmVhdGVFbGVtZW50DQogICAgICogQGdyYW1tYXIgVUUuZG9tLmRvbVV0aWxzLmNyZWF0ZUVsZW1lbnQoZG9jLHRhZyxhdHRycykgID0+ICBOb2RlICAvL+i/lOWbnuWIm+W7uueahOiKgueCuQ0KICAgICAqLw0KICAgIGNyZWF0ZUVsZW1lbnQ6ZnVuY3Rpb24gKGRvYywgdGFnLCBhdHRycykgew0KICAgICAgICByZXR1cm4gZG9tVXRpbHMuc2V0QXR0cmlidXRlcyhkb2MuY3JlYXRlRWxlbWVudCh0YWcpLCBhdHRycykNCiAgICB9LA0KICAgIC8qKg0KICAgICAqIOS4uuiKgueCuW5vZGXmt7vliqDlsZ7mgKdhdHRyc++8jGF0dHJz5Li65bGe5oCn6ZSu5YC85a+5DQogICAgICogQG5hbWUgc2V0QXR0cmlidXRlcw0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5zZXRBdHRyaWJ1dGVzKG5vZGUsYXR0cnMpICA9PiBub2RlDQogICAgICovDQogICAgc2V0QXR0cmlidXRlczpmdW5jdGlvbiAobm9kZSwgYXR0cnMpIHsNCiAgICAgICAgZm9yICh2YXIgYXR0ciBpbiBhdHRycykgew0KICAgICAgICAgICAgaWYoYXR0cnMuaGFzT3duUHJvcGVydHkoYXR0cikpew0KICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGF0dHJzW2F0dHJdOw0KICAgICAgICAgICAgICAgIHN3aXRjaCAoYXR0cikgew0KICAgICAgICAgICAgICAgICAgICBjYXNlICdjbGFzcyc6DQogICAgICAgICAgICAgICAgICAgICAgICAvL2ll5LiL6KaB6L+Z5qC36LWL5YC877yMc2V0QXR0cmlidXRl5LiN6LW35L2c55SoDQogICAgICAgICAgICAgICAgICAgICAgICBub2RlLmNsYXNzTmFtZSA9IHZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgJ3N0eWxlJyA6DQogICAgICAgICAgICAgICAgICAgICAgICBub2RlLnN0eWxlLmNzc1RleHQgPSBub2RlLnN0eWxlLmNzc1RleHQgKyAiOyIgKyB2YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICBjYXNlICdpbm5lckhUTUwnOg0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZVthdHRyXSA9IHZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgJ3ZhbHVlJzoNCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUudmFsdWUgPSB2YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoYXR0ckZpeFthdHRyXSB8fCBhdHRyLCB2YWx1ZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiBub2RlOw0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiDojrflj5blhYPntKBlbGVtZW5055qE6K6h566X5qC35byPDQogICAgICogQG5hbWUgZ2V0Q29tcHV0ZWRTdHlsZQ0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQsc3R5bGVOYW1lKSAgPT4gU3RyaW5nIC8v6L+U5Zue5a+55bqU5qC35byP5ZCN56ew55qE5qC35byP5YC8DQogICAgICogQGV4YW1wbGUNCiAgICAgKiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHksImZvbnQtc2l6ZSIpICA9PiAgIjE1cHgiDQogICAgICogZ2V0Q29tcHV0ZWRTdHlsZShmb3JtLCJjb2xvciIpICA9PiAgIiNmZmNjZGQiDQogICAgICovDQogICAgZ2V0Q29tcHV0ZWRTdHlsZTpmdW5jdGlvbiAoZWxlbWVudCwgc3R5bGVOYW1lKSB7DQogICAgICAgIC8v5LiA5LiL55qE5bGe5oCn5Y2V54us5aSE55CGDQogICAgICAgIHZhciBwcm9zID0gJ3dpZHRoIGhlaWdodCB0b3AgbGVmdCc7DQoNCiAgICAgICAgaWYocHJvcy5pbmRleE9mKHN0eWxlTmFtZSkgPiAtMSl7DQogICAgICAgICAgICByZXR1cm4gZWxlbWVudFsnb2Zmc2V0JyArIHN0eWxlTmFtZS5yZXBsYWNlKC9eXHcvLGZ1bmN0aW9uKHMpe3JldHVybiBzLnRvVXBwZXJDYXNlKCl9KV0gKyAncHgnOw0KICAgICAgICB9DQogICAgICAgIC8v5b+955Wl5paH5pys6IqC54K5DQogICAgICAgIGlmIChlbGVtZW50Lm5vZGVUeXBlID09IDMpIHsNCiAgICAgICAgICAgIGVsZW1lbnQgPSBlbGVtZW50LnBhcmVudE5vZGU7DQogICAgICAgIH0NCiAgICAgICAgLy9pZeS4i2ZvbnQtc2l6ZeiLpWJvZHnkuIvlrprkuYnkuoZmb250LXNpemXvvIzliJnku45jdXJyZW50U3R5bGXph4zkvJrlj5bliLDov5nkuKpmb250LXNpemUuIOWPluS4jeWIsOWunumZheWAvO+8jOaVheatpOS/ruaUuS4NCiAgICAgICAgaWYgKGJyb3dzZXIuaWUgJiYgYnJvd3Nlci52ZXJzaW9uIDwgOSAmJiBzdHlsZU5hbWUgPT0gJ2ZvbnQtc2l6ZScgJiYgIWVsZW1lbnQuc3R5bGUuZm9udFNpemUgJiYNCiAgICAgICAgICAgICFkdGQuJGVtcHR5W2VsZW1lbnQudGFnTmFtZV0gJiYgIWR0ZC4kbm9uQ2hpbGRbZWxlbWVudC50YWdOYW1lXSkgew0KICAgICAgICAgICAgdmFyIHNwYW4gPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOw0KICAgICAgICAgICAgc3Bhbi5zdHlsZS5jc3NUZXh0ID0gJ3BhZGRpbmc6MDtib3JkZXI6MDtmb250LWZhbWlseTpzaW1zdW47JzsNCiAgICAgICAgICAgIHNwYW4uaW5uZXJIVE1MID0gJy4nOw0KICAgICAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChzcGFuKTsNCiAgICAgICAgICAgIHZhciByZXN1bHQgPSBzcGFuLm9mZnNldEhlaWdodDsNCiAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQ2hpbGQoc3Bhbik7DQogICAgICAgICAgICBzcGFuID0gbnVsbDsNCiAgICAgICAgICAgIHJldHVybiByZXN1bHQgKyAncHgnOw0KICAgICAgICB9DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICB2YXIgdmFsdWUgPSBkb21VdGlscy5nZXRTdHlsZShlbGVtZW50LCBzdHlsZU5hbWUpIHx8DQogICAgICAgICAgICAgICAgKHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlID8gZG9tVXRpbHMuZ2V0V2luZG93KGVsZW1lbnQpLmdldENvbXB1dGVkU3R5bGUoZWxlbWVudCwgJycpLmdldFByb3BlcnR5VmFsdWUoc3R5bGVOYW1lKSA6DQogICAgICAgICAgICAgICAgICAgICggZWxlbWVudC5jdXJyZW50U3R5bGUgfHwgZWxlbWVudC5zdHlsZSApW3V0aWxzLmNzc1N0eWxlVG9Eb21TdHlsZShzdHlsZU5hbWUpXSk7DQoNCiAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgcmV0dXJuICIiOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiB1dGlscy50cmFuc1VuaXRUb1B4KHV0aWxzLmZpeENvbG9yKHN0eWxlTmFtZSwgdmFsdWUpKTsNCiAgICB9LA0KICAgIC8qKg0KICAgICAqIOWcqOWFg+e0oGVsZW1lbnTkuIrliKDpmaRjbGFzc05hbWVz77yM5pSv5oyB5ZCM5pe25Yig6Zmk5aSa5LiqDQogICAgICogQG5hbWUgcmVtb3ZlQ2xhc3Nlcw0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5yZW1vdmVDbGFzc2VzKGVsZW1lbnQsY2xhc3NOYW1lcykNCiAgICAgKiBAZXhhbXBsZQ0KICAgICAqIC8v5omn6KGM5pa55rOV5YmN55qEZG9t57uT5p6EDQogICAgICogPHNwYW4gY2xhc3M9InRlc3QxIHRlc3QyIHRlc3QzIj54eHg8L3NwYW4+DQogICAgICogLy/miafooYzmlrnms5UNCiAgICAgKiBVRS5kb20uZG9tVXRpbHMucmVtb3ZlQ2xhc3NlcyhlbGVtZW50LFsidGVzdDEiLCJ0ZXN0MyJdKQ0KICAgICAqIC8v5omn6KGM5pa55rOV5ZCO55qEZG9t57uT5p6EDQogICAgICogPHNwYW4gY2xhc3M9InRlc3QyIj54eHg8L3NwYW4+DQogICAgICovDQogICAgcmVtb3ZlQ2xhc3NlczpmdW5jdGlvbiAoZWxtLCBjbGFzc05hbWVzKSB7DQogICAgICAgIGNsYXNzTmFtZXMgPSB1dGlscy5pc0FycmF5KGNsYXNzTmFtZXMpID8gY2xhc3NOYW1lcyA6DQogICAgICAgICAgICB1dGlscy50cmltKGNsYXNzTmFtZXMpLnJlcGxhY2UoL1sgXXsyLH0vZywnICcpLnNwbGl0KCcgJyk7DQogICAgICAgIGZvcih2YXIgaSA9IDAsY2ksY2xzID0gZWxtLmNsYXNzTmFtZTtjaT1jbGFzc05hbWVzW2krK107KXsNCiAgICAgICAgICAgIGNscyA9IGNscy5yZXBsYWNlKG5ldyBSZWdFeHAoJ1xcYicgKyBjaSArICdcXGInKSwnJykNCiAgICAgICAgfQ0KICAgICAgICBjbHMgPSB1dGlscy50cmltKGNscykucmVwbGFjZSgvWyBdezIsfS9nLCcgJyk7DQogICAgICAgIGlmKGNscyl7DQogICAgICAgICAgICBlbG0uY2xhc3NOYW1lID0gY2xzOw0KICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZUF0dHJpYnV0ZXMoZWxtLFsnY2xhc3MnXSk7DQogICAgICAgIH0NCiAgICB9LA0KICAgIC8qKg0KICAgICAqIOWcqOWFg+e0oGVsZW1lbnTkuIrlop7liqDkuIDkuKrmoLflvI/nsbtjbGFzc05hbWXvvIzmlK/mjIHku6XnqbrmoLzliIblvIDnmoTlpJrkuKrnsbvlkI0NCiAgICAgKiDlpoLmnpznm7jlkIznmoTnsbvlkI3lsIbkuI3kvJrmt7vliqANCiAgICAgKiBAbmFtZSBhZGRDbGFzcw0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5hZGRDbGFzcyhlbGVtZW50LGNsYXNzTmFtZXMpDQogICAgICovDQogICAgYWRkQ2xhc3M6ZnVuY3Rpb24gKGVsbSwgY2xhc3NOYW1lcykgew0KICAgICAgICBpZighZWxtKXJldHVybjsNCiAgICAgICAgY2xhc3NOYW1lcyA9IHV0aWxzLnRyaW0oY2xhc3NOYW1lcykucmVwbGFjZSgvWyBdezIsfS9nLCcgJykuc3BsaXQoJyAnKTsNCiAgICAgICAgZm9yKHZhciBpID0gMCxjaSxjbHMgPSBlbG0uY2xhc3NOYW1lO2NpPWNsYXNzTmFtZXNbaSsrXTspew0KICAgICAgICAgICAgaWYoIW5ldyBSZWdFeHAoJ1xcYicgKyBjaSArICdcXGInKS50ZXN0KGNscykpew0KICAgICAgICAgICAgICAgIGVsbS5jbGFzc05hbWUgKz0gJyAnICsgY2k7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9LA0KICAgIC8qKg0KICAgICAqIOWIpOaWreWFg+e0oGVsZW1lbnTmmK/lkKbljIXlkKvmoLflvI/nsbvlkI1jbGFzc05hbWUs5pSv5oyB5Lul56m65qC85YiG5byA55qE5aSa5Liq57G75ZCNLOWkmuS4quexu+WQjemhuuW6j+S4jeWQjOS5n+WPr+S7peavlOi+gw0KICAgICAqIEBuYW1lIGhhc0NsYXNzDQogICAgICogQGdyYW1tYXIgVUUuZG9tLmRvbVV0aWxzLmhhc0NsYXNzKGVsZW1lbnQsY2xhc3NOYW1lKSAgPT50cnVlfGZhbHNlDQogICAgICovDQogICAgaGFzQ2xhc3M6ZnVuY3Rpb24gKGVsZW1lbnQsIGNsYXNzTmFtZSkgew0KICAgICAgICBpZih1dGlscy5pc1JlZ0V4cChjbGFzc05hbWUpKXsNCiAgICAgICAgICAgIHJldHVybiBjbGFzc05hbWUudGVzdChlbGVtZW50LmNsYXNzTmFtZSkNCiAgICAgICAgfQ0KICAgICAgICBjbGFzc05hbWUgPSB1dGlscy50cmltKGNsYXNzTmFtZSkucmVwbGFjZSgvWyBdezIsfS9nLCcgJykuc3BsaXQoJyAnKTsNCiAgICAgICAgZm9yKHZhciBpID0gMCxjaSxjbHMgPSBlbGVtZW50LmNsYXNzTmFtZTtjaT1jbGFzc05hbWVbaSsrXTspew0KICAgICAgICAgICAgaWYoIW5ldyBSZWdFeHAoJ1xcYicgKyBjaSArICdcXGInLCdpJykudGVzdChjbHMpKXsNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIGkgLSAxID09IGNsYXNzTmFtZS5sZW5ndGg7DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIOmYu+atouS6i+S7tum7mOiupOihjOS4ug0KICAgICAqIEBwYXJhbSB7RXZlbnR9IGV2dCAgICDpnIDopoHnu4Tnu4fnmoTkuovku7blr7nosaENCiAgICAgKi8NCiAgICBwcmV2ZW50RGVmYXVsdDpmdW5jdGlvbiAoZXZ0KSB7DQogICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCA/IGV2dC5wcmV2ZW50RGVmYXVsdCgpIDogKGV2dC5yZXR1cm5WYWx1ZSA9IGZhbHNlKTsNCiAgICB9LA0KICAgIC8qKg0KICAgICAqIOWIoOmZpOWFg+e0oGVsZW1lbnTnmoTmoLflvI8NCiAgICAgKiBAZ3JhbW1hciBVRS5kb20uZG9tVXRpbHMucmVtb3ZlU3R5bGUoZWxlbWVudCxuYW1lKSAgICAgICAg5Yig6Zmk55qE5qC35byP5ZCN56ewDQogICAgICovDQogICAgcmVtb3ZlU3R5bGU6ZnVuY3Rpb24gKGVsZW1lbnQsIG5hbWUpIHsNCiAgICAgICAgaWYoYnJvd3Nlci5pZSApew0KICAgICAgICAgICAgLy/pkojlr7ljb2xvcuWFiOWNleeLrOWkhOeQhuS4gOS4iw0KICAgICAgICAgICAgaWYobmFtZSA9PSAnY29sb3InKXsNCiAgICAgICAgICAgICAgICBuYW1lID0gJyhefDspJyArIG5hbWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbGVtZW50LnN0eWxlLmNzc1RleHQgPSBlbGVtZW50LnN0eWxlLmNzc1RleHQucmVwbGFjZShuZXcgUmVnRXhwKG5hbWUgKyAnW146XSo6W147XSs7PycsJ2lnJyksJycpDQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAgaWYgKGVsZW1lbnQuc3R5bGUucmVtb3ZlUHJvcGVydHkpIHsNCiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLnJlbW92ZVByb3BlcnR5IChuYW1lKTsNCiAgICAgICAgICAgIH1lbHNlIHsNCiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLnJlbW92ZUF0dHJpYnV0ZSAodXRpbHMuY3NzU3R5bGVUb0RvbVN0eWxlKG5hbWUpKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQoNCiAgICAgICAgaWYgKCFlbGVtZW50LnN0eWxlLmNzc1RleHQpIHsNCiAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZUF0dHJpYnV0ZXMoZWxlbWVudCwgWydzdHlsZSddKTsNCiAgICAgICAgfQ0KICAgIH0sDQogICAgLyoqDQogICAgICog6I635Y+W5YWD57SgZWxlbWVudOeahOafkOS4quagt+W8j+WAvA0KICAgICAqIEBuYW1lIGdldFN0eWxlDQogICAgICogQGdyYW1tYXIgVUUuZG9tLmRvbVV0aWxzLmdldFN0eWxlKGVsZW1lbnQsbmFtZSkgID0+IFN0cmluZw0KICAgICAqLw0KICAgIGdldFN0eWxlOmZ1bmN0aW9uIChlbGVtZW50LCBuYW1lKSB7DQogICAgICAgIHZhciB2YWx1ZSA9IGVsZW1lbnQuc3R5bGVbIHV0aWxzLmNzc1N0eWxlVG9Eb21TdHlsZShuYW1lKSBdOw0KICAgICAgICByZXR1cm4gdXRpbHMuZml4Q29sb3IobmFtZSwgdmFsdWUpOw0KICAgIH0sDQogICAgLyoqDQogICAgICog5Li65YWD57SgZWxlbWVudOiuvue9ruagt+W8j+WxnuaAp+WAvA0KICAgICAqIEBuYW1lIHNldFN0eWxlDQogICAgICogQGdyYW1tYXIgVUUuZG9tLmRvbVV0aWxzLnNldFN0eWxlKGVsZW1lbnQsbmFtZSx2YWx1ZSkNCiAgICAgKi8NCiAgICBzZXRTdHlsZTpmdW5jdGlvbiAoZWxlbWVudCwgbmFtZSwgdmFsdWUpIHsNCiAgICAgICAgZWxlbWVudC5zdHlsZVt1dGlscy5jc3NTdHlsZVRvRG9tU3R5bGUobmFtZSldID0gdmFsdWU7DQogICAgICAgIGlmKCF1dGlscy50cmltKGVsZW1lbnQuc3R5bGUuY3NzVGV4dCkpew0KICAgICAgICAgICAgdGhpcy5yZW1vdmVBdHRyaWJ1dGVzKGVsZW1lbnQsJ3N0eWxlJykNCiAgICAgICAgfQ0KICAgIH0sDQogICAgLyoqDQogICAgICog5Li65YWD57SgZWxlbWVudOiuvue9ruagt+W8j+WxnuaAp+WAvA0KICAgICAqIEBuYW1lIHNldFN0eWxlcw0KICAgICAqIEBncmFtbWFyIFVFLmRvbS5kb21VdGlscy5zZXRTdHlsZShlbGVtZW50LHN0eWxlcykgIC8vc3R5bGVz5Li65qC35byP6ZSu5YC85a+5DQogICAgICovDQogICAgc2V0U3R5bGVzOmZ1bmN0aW9uIChlbGVtZW50LCBzdHlsZXMpIHsNCiAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBzdHlsZXMpIHsNCiAgICAgICAgICAgIGlmIChzdHlsZXMuaGFzT3duUHJvcGVydHkobmFtZSkpIHsNCiAgICAgICAgICAgICAgICBkb21VdGlscy5zZXRTdHlsZShlbGVtZW50LCBuYW1lLCBzdHlsZXNbbmFtZV0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSwNCiAgICAvKioNCiAgICAgKiDliKDpmaRfbW96X2RpcnR55bGe5oCnDQogICAgICogQGZ1bmN0aW9uDQogICAgICovDQogICAgcmVtb3ZlRGlydHlBdHRyOmZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgIGZvciAodmFyIGkgPSAwLCBjaSwgbm9kZXMgPSBub2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCcqJyk7IGNpID0gbm9kZXNbaSsrXTspIHsNCiAgICAgICAgICAgIGNpLnJlbW92ZUF0dHJpYnV0ZSgnX21vel9kaXJ0eScpOw0KICAgICAgICB9DQogICAgICAgIG5vZGUucmVtb3ZlQXR0cmlidXRlKCdfbW96X2RpcnR5Jyk7DQogICAgfSwNCiAgICAvKioNCiAgICAgKiDov5Tlm57lrZDoioLngrnnmoTmlbDph48NCiAgICAgKiBAZnVuY3Rpb24NCiAgICAgKiBAcGFyYW0ge05vZGV9ICAgIG5vZGUgICAg54i26IqC54K5DQogICAgICogQHBhcmFtICB7RnVuY3Rpb259ICAgIGZuICAgIOi/h+a7pOWtkOiKgueCueeahOinhOWIme+8jOiLpeS4uuepuu+8jOWImeW+l+WIsOaJgOacieWtkOiKgueCueeahOaVsOmHjw0KICAgICAqIEByZXR1cm4ge051bWJlcn0gICAg56ym5ZCI5p2h5Lu25a2Q6IqC54K555qE5pWw6YePDQogICAgICovDQogICAgZ2V0Q2hpbGRDb3VudDpmdW5jdGlvbiAobm9kZSwgZm4pIHsNCiAgICAgICAgdmFyIGNvdW50ID0gMCwgZmlyc3QgPSBub2RlLmZpcnN0Q2hpbGQ7DQogICAgICAgIGZuID0gZm4gfHwgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgcmV0dXJuIDE7DQogICAgICAgIH07DQogICAgICAgIHdoaWxlIChmaXJzdCkgew0KICAgICAgICAgICAgaWYgKGZuKGZpcnN0KSkgew0KICAgICAgICAgICAgICAgIGNvdW50Kys7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBmaXJzdCA9IGZpcnN0Lm5leHRTaWJsaW5nOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBjb3VudDsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICog5Yik5pat5piv5ZCm5Li656m66IqC54K5DQogICAgICogQGZ1bmN0aW9uDQogICAgICogQHBhcmFtIHtOb2RlfSAgICBub2RlICAgIOiKgueCuQ0KICAgICAqIEByZXR1cm4ge0Jvb2xlYW59ICAgIOaYr+WQpuS4uuepuuiKgueCuQ0KICAgICAqLw0KICAgIGlzRW1wdHlOb2RlOmZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgIHJldHVybiAhbm9kZS5maXJzdENoaWxkIHx8IGRvbVV0aWxzLmdldENoaWxkQ291bnQobm9kZSwgZnVuY3Rpb24gKG5vZGUpIHsNCiAgICAgICAgICAgIHJldHVybiAgIWRvbVV0aWxzLmlzQnIobm9kZSkgJiYgIWRvbVV0aWxzLmlzQm9va21hcmtOb2RlKG5vZGUpICYmICFkb21VdGlscy5pc1doaXRlc3BhY2Uobm9kZSkNCiAgICAgICAgfSkgPT0gMA0KICAgIH0sDQogICAgLyoqDQogICAgICog5riF56m66IqC54K55omA5pyJ55qEY2xhc3NOYW1lDQogICAgICogQGZ1bmN0aW9uDQogICAgICogQHBhcmFtIHtBcnJheX0gICAgbm9kZXMgICAg6IqC54K55pWw57uEDQogICAgICovDQogICAgY2xlYXJTZWxlY3RlZEFycjpmdW5jdGlvbiAobm9kZXMpIHsNCiAgICAgICAgdmFyIG5vZGU7DQogICAgICAgIHdoaWxlIChub2RlID0gbm9kZXMucG9wKCkpIHsNCiAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZUF0dHJpYnV0ZXMobm9kZSwgWydjbGFzcyddKTsNCiAgICAgICAgfQ0KICAgIH0sDQogICAgLyoqDQogICAgICog5bCG5pi+56S65Yy65Z+f5rua5Yqo5Yiw5pi+56S66IqC54K555qE5L2N572uDQogICAgICogQGZ1bmN0aW9uDQogICAgICogQHBhcmFtICAgIHtOb2RlfSAgIG5vZGUgICAg6IqC54K5DQogICAgICogQHBhcmFtICAgIHt3aW5kb3d9ICAgd2luICAgICAgd2luZG935a+56LGhDQogICAgICogQHBhcmFtICAgIHtOdW1iZXJ9ICAgIG9mZnNldFRvcCAgICDot53nprvkuIrmlrnnmoTlgY/np7vph48NCiAgICAgKi8NCiAgICBzY3JvbGxUb1ZpZXc6ZnVuY3Rpb24gKG5vZGUsIHdpbiwgb2Zmc2V0VG9wKSB7DQogICAgICAgIHZhciBnZXRWaWV3UGFuZVNpemUgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgdmFyIGRvYyA9IHdpbi5kb2N1bWVudCwNCiAgICAgICAgICAgICAgICAgICAgbW9kZSA9IGRvYy5jb21wYXRNb2RlID09ICdDU1MxQ29tcGF0JzsNCiAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICB3aWR0aDooIG1vZGUgPyBkb2MuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoIDogZG9jLmJvZHkuY2xpZW50V2lkdGggKSB8fCAwLA0KICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6KCBtb2RlID8gZG9jLmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgOiBkb2MuYm9keS5jbGllbnRIZWlnaHQgKSB8fCAwDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBnZXRTY3JvbGxQb3NpdGlvbiA9IGZ1bmN0aW9uICh3aW4pIHsNCiAgICAgICAgICAgICAgICBpZiAoJ3BhZ2VYT2Zmc2V0JyBpbiB3aW4pIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHg6d2luLnBhZ2VYT2Zmc2V0IHx8IDAsDQogICAgICAgICAgICAgICAgICAgICAgICB5Ondpbi5wYWdlWU9mZnNldCB8fCAwDQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICB2YXIgZG9jID0gd2luLmRvY3VtZW50Ow0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICAgICAgeDpkb2MuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQgfHwgZG9jLmJvZHkuc2Nyb2xsTGVmdCB8fCAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgeTpkb2MuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCB8fCBkb2MuYm9keS5zY3JvbGxUb3AgfHwgMA0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH07DQogICAgICAgIHZhciB3aW5IZWlnaHQgPSBnZXRWaWV3UGFuZVNpemUoKS5oZWlnaHQsIG9mZnNldCA9IHdpbkhlaWdodCAqIC0xICsgb2Zmc2V0VG9wOw0KICAgICAgICBvZmZzZXQgKz0gKG5vZGUub2Zmc2V0SGVpZ2h0IHx8IDApOw0KICAgICAgICB2YXIgZWxlbWVudFBvc2l0aW9uID0gZG9tVXRpbHMuZ2V0WFkobm9kZSk7DQogICAgICAgIG9mZnNldCArPSBlbGVtZW50UG9zaXRpb24ueTsNCiAgICAgICAgdmFyIGN1cnJlbnRTY3JvbGwgPSBnZXRTY3JvbGxQb3NpdGlvbih3aW4pLnk7DQogICAgICAgIC8vIG9mZnNldCArPSA1MDsNCiAgICAgICAgaWYgKG9mZnNldCA+IGN1cnJlbnRTY3JvbGwgfHwgb2Zmc2V0IDwgY3VycmVudFNjcm9sbCAtIHdpbkhlaWdodCkgew0KICAgICAgICAgICAgd2luLnNjcm9sbFRvKDAsIG9mZnNldCArIChvZmZzZXQgPCAwID8gLTIwIDogMjApKTsNCiAgICAgICAgfQ0KICAgIH0sDQogICAgLyoqDQogICAgICog5Yik5pat6IqC54K55piv5ZCm5Li6YnINCiAgICAgKiBAZnVuY3Rpb24NCiAgICAgKiBAcGFyYW0ge05vZGV9ICAgIG5vZGUgICDoioLngrkNCiAgICAgKi8NCiAgICBpc0JyOmZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgIHJldHVybiBub2RlLm5vZGVUeXBlID09IDEgJiYgbm9kZS50YWdOYW1lID09ICdCUic7DQogICAgfSwNCiAgICBpc0ZpbGxDaGFyOmZ1bmN0aW9uIChub2RlLGlzSW5TdGFydCkgew0KICAgICAgICByZXR1cm4gbm9kZS5ub2RlVHlwZSA9PSAzICYmICFub2RlLm5vZGVWYWx1ZS5yZXBsYWNlKG5ldyBSZWdFeHAoKGlzSW5TdGFydCA/ICdeJyA6ICcnICkgKyBkb21VdGlscy5maWxsQ2hhciksICcnKS5sZW5ndGgNCiAgICB9LA0KICAgIGlzU3RhcnRJbmJsb2NrOmZ1bmN0aW9uIChyYW5nZSkgew0KICAgICAgICB2YXIgdG1wUmFuZ2UgPSByYW5nZS5jbG9uZVJhbmdlKCksDQogICAgICAgICAgICBmbGFnID0gMCwNCiAgICAgICAgICAgIHN0YXJ0ID0gdG1wUmFuZ2Uuc3RhcnRDb250YWluZXIsDQogICAgICAgICAgICB0bXA7DQogICAgICAgIGlmKHN0YXJ0Lm5vZGVUeXBlID09IDEgJiYgc3RhcnQuY2hpbGROb2Rlc1t0bXBSYW5nZS5zdGFydE9mZnNldF0pew0KICAgICAgICAgICAgc3RhcnQgPSBzdGFydC5jaGlsZE5vZGVzW3RtcFJhbmdlLnN0YXJ0T2Zmc2V0XTsNCiAgICAgICAgICAgIHZhciBwcmUgPSBzdGFydC5wcmV2aW91c1NpYmxpbmc7DQogICAgICAgICAgICB3aGlsZShwcmUgJiYgZG9tVXRpbHMuaXNGaWxsQ2hhcihwcmUpKXsNCiAgICAgICAgICAgICAgICBzdGFydCA9IHByZTsNCiAgICAgICAgICAgICAgICBwcmUgPSBwcmUucHJldmlvdXNTaWJsaW5nOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmKHRoaXMuaXNGaWxsQ2hhcihzdGFydCx0cnVlKSAmJiB0bXBSYW5nZS5zdGFydE9mZnNldCA9PSAxKXsNCiAgICAgICAgICAgIHRtcFJhbmdlLnNldFN0YXJ0QmVmb3JlKHN0YXJ0KTsNCiAgICAgICAgICAgIHN0YXJ0ID0gdG1wUmFuZ2Uuc3RhcnRDb250YWluZXI7DQogICAgICAgIH0NCg0KICAgICAgICB3aGlsZSAoc3RhcnQgJiYgZG9tVXRpbHMuaXNGaWxsQ2hhcihzdGFydCkpIHsNCiAgICAgICAgICAgIHRtcCA9IHN0YXJ0Ow0KICAgICAgICAgICAgc3RhcnQgPSBzdGFydC5wcmV2aW91c1NpYmxpbmcNCiAgICAgICAgfQ0KICAgICAgICBpZiAodG1wKSB7DQogICAgICAgICAgICB0bXBSYW5nZS5zZXRTdGFydEJlZm9yZSh0bXApOw0KICAgICAgICAgICAgc3RhcnQgPSB0bXBSYW5nZS5zdGFydENvbnRhaW5lcjsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoc3RhcnQubm9kZVR5cGUgPT0gMSAmJiBkb21VdGlscy5pc0VtcHR5Tm9kZShzdGFydCkgJiYgdG1wUmFuZ2Uuc3RhcnRPZmZzZXQgPT0gMSkgew0KICAgICAgICAgICAgdG1wUmFuZ2Uuc2V0U3RhcnQoc3RhcnQsIDApLmNvbGxhcHNlKHRydWUpOw0KICAgICAgICB9DQogICAgICAgIHdoaWxlICghdG1wUmFuZ2Uuc3RhcnRPZmZzZXQpIHsNCiAgICAgICAgICAgIHN0YXJ0ID0gdG1wUmFuZ2Uuc3RhcnRDb250YWluZXI7DQogICAgICAgICAgICBpZiAoZG9tVXRpbHMuaXNCbG9ja0VsbShzdGFydCkgfHwgZG9tVXRpbHMuaXNCb2R5KHN0YXJ0KSkgew0KICAgICAgICAgICAgICAgIGZsYWcgPSAxOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdmFyIHByZSA9IHRtcFJhbmdlLnN0YXJ0Q29udGFpbmVyLnByZXZpb3VzU2libGluZywNCiAgICAgICAgICAgICAgICB0bXBOb2RlOw0KICAgICAgICAgICAgaWYgKCFwcmUpIHsNCiAgICAgICAgICAgICAgICB0bXBSYW5nZS5zZXRTdGFydEJlZm9yZSh0bXBSYW5nZS5zdGFydENvbnRhaW5lcik7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHdoaWxlIChwcmUgJiYgZG9tVXRpbHMuaXNGaWxsQ2hhcihwcmUpKSB7DQogICAgICAgICAgICAgICAgICAgIHRtcE5vZGUgPSBwcmU7DQogICAgICAgICAgICAgICAgICAgIHByZSA9IHByZS5wcmV2aW91c1NpYmxpbmc7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICh0bXBOb2RlKSB7DQogICAgICAgICAgICAgICAgICAgIHRtcFJhbmdlLnNldFN0YXJ0QmVmb3JlKHRtcE5vZGUpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHRtcFJhbmdlLnNldFN0YXJ0QmVmb3JlKHRtcFJhbmdlLnN0YXJ0Q29udGFpbmVyKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIGZsYWcgJiYgIWRvbVV0aWxzLmlzQm9keSh0bXBSYW5nZS5zdGFydENvbnRhaW5lcikgPyAxIDogMDsNCiAgICB9LA0KICAgIGlzRW1wdHlCbG9jazpmdW5jdGlvbiAobm9kZSxyZWcpIHsNCiAgICAgICAgaWYobm9kZS5ub2RlVHlwZSAhPSAxKQ0KICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgIHJlZyA9IHJlZyB8fCBuZXcgUmVnRXhwKCdbIFx0XHJcbicgKyBkb21VdGlscy5maWxsQ2hhciArICddJywgJ2cnKTsNCiAgICAgICAgaWYgKG5vZGVbYnJvd3Nlci5pZSA/ICdpbm5lclRleHQnIDogJ3RleHRDb250ZW50J10ucmVwbGFjZShyZWcsICcnKS5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgfQ0KICAgICAgICBmb3IgKHZhciBuIGluIGR0ZC4kaXNOb3RFbXB0eSkgew0KICAgICAgICAgICAgaWYgKG5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUobikubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIDE7DQogICAgfSwNCg0KICAgIHNldFZpZXdwb3J0T2Zmc2V0OmZ1bmN0aW9uIChlbGVtZW50LCBvZmZzZXQpIHsNCiAgICAgICAgdmFyIGxlZnQgPSBwYXJzZUludChlbGVtZW50LnN0eWxlLmxlZnQpIHwgMDsNCiAgICAgICAgdmFyIHRvcCA9IHBhcnNlSW50KGVsZW1lbnQuc3R5bGUudG9wKSB8IDA7DQogICAgICAgIHZhciByZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICAgICAgdmFyIG9mZnNldExlZnQgPSBvZmZzZXQubGVmdCAtIHJlY3QubGVmdDsNCiAgICAgICAgdmFyIG9mZnNldFRvcCA9IG9mZnNldC50b3AgLSByZWN0LnRvcDsNCiAgICAgICAgaWYgKG9mZnNldExlZnQpIHsNCiAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUubGVmdCA9IGxlZnQgKyBvZmZzZXRMZWZ0ICsgJ3B4JzsNCiAgICAgICAgfQ0KICAgICAgICBpZiAob2Zmc2V0VG9wKSB7DQogICAgICAgICAgICBlbGVtZW50LnN0eWxlLnRvcCA9IHRvcCArIG9mZnNldFRvcCArICdweCc7DQogICAgICAgIH0NCiAgICB9LA0KICAgIGZpbGxOb2RlOmZ1bmN0aW9uIChkb2MsIG5vZGUpIHsNCiAgICAgICAgdmFyIHRtcE5vZGUgPSBicm93c2VyLmllID8gZG9jLmNyZWF0ZVRleHROb2RlKGRvbVV0aWxzLmZpbGxDaGFyKSA6IGRvYy5jcmVhdGVFbGVtZW50KCdicicpOw0KICAgICAgICBub2RlLmlubmVySFRNTCA9ICcnOw0KICAgICAgICBub2RlLmFwcGVuZENoaWxkKHRtcE5vZGUpOw0KICAgIH0sDQogICAgbW92ZUNoaWxkOmZ1bmN0aW9uIChzcmMsIHRhZywgZGlyKSB7DQogICAgICAgIHdoaWxlIChzcmMuZmlyc3RDaGlsZCkgew0KICAgICAgICAgICAgaWYgKGRpciAmJiB0YWcuZmlyc3RDaGlsZCkgew0KICAgICAgICAgICAgICAgIHRhZy5pbnNlcnRCZWZvcmUoc3JjLmxhc3RDaGlsZCwgdGFnLmZpcnN0Q2hpbGQpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0YWcuYXBwZW5kQ2hpbGQoc3JjLmZpcnN0Q2hpbGQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSwNCiAgICAvL+WIpOaWreaYr+WQpuaciemineWkluWxnuaApw0KICAgIGhhc05vQXR0cmlidXRlczpmdW5jdGlvbiAobm9kZSkgew0KICAgICAgICByZXR1cm4gYnJvd3Nlci5pZSA/IC9ePFx3K1xzKj8+Ly50ZXN0KG5vZGUub3V0ZXJIVE1MKSA6IG5vZGUuYXR0cmlidXRlcy5sZW5ndGggPT0gMDsNCiAgICB9LA0KICAgIC8v5Yik5pat5piv5ZCm5piv57yW6L6R5Zmo6Ieq5a6a5LmJ55qE5Y+C5pWwDQogICAgaXNDdXN0b21lTm9kZTpmdW5jdGlvbiAobm9kZSkgew0KICAgICAgICByZXR1cm4gbm9kZS5ub2RlVHlwZSA9PSAxICYmIG5vZGUuZ2V0QXR0cmlidXRlKCdfdWVfY3VzdG9tX25vZGVfJyk7DQogICAgfSwNCiAgICBpc1RhZ05vZGU6ZnVuY3Rpb24gKG5vZGUsIHRhZ05hbWUpIHsNCiAgICAgICAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT0gMSAmJiBuZXcgUmVnRXhwKCdeJyArIG5vZGUudGFnTmFtZSArICckJywnaScpLnRlc3QodGFnTmFtZSkNCiAgICB9LA0KICAgIC8qKg0KICAgICAqIOWvueS6jm5vZGVsaXN055SoZmlsdGVy6L+b6KGM6L+H5rukDQogICAgICogQG5hbWUgZmlsdGVyTm9kZUxpc3QNCiAgICAgKiBAc2luY2UgMS4yLjQrDQogICAgICogQGdyYW1tYXIgVUUuZG9tLmRvbVV0aWxzLmZpbHRlck5vZGVMaXN0KG5vZGVsaXN0LGZpbHRlcixvbmx5Rmlyc3QpICA9PiDoioLngrkNCiAgICAgKiBAZXhhbXBsZQ0KICAgICAqIFVFLmRvbS5kb21VdGlscy5maWx0ZXJOb2RlTGlzdChkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnKicpLCdkaXYgcCcpIC8v6L+U5Zue56ys5LiA5Liq5pivZGl25oiW6ICFcOeahOiKgueCuQ0KICAgICAqIFVFLmRvbS5kb21VdGlscy5maWx0ZXJOb2RlTGlzdChkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnKicpLGZ1bmN0aW9uKG4pe3JldHVybiBuLmdldEF0dHJpYnV0ZSgnc3JjJyl9KQ0KICAgICAqIC8v6L+U5Zue56ys5LiA5Liq5bimc3Jj5bGe5oCn55qE6IqC54K5DQogICAgICogVUUuZG9tLmRvbVV0aWxzLmZpbHRlck5vZGVMaXN0KGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCcqJyksJ2knLHRydWUpIC8v6L+U5Zue5pWw57uE77yM6YeM6L656YO95pivaeiKgueCuQ0KICAgICAqLw0KICAgIGZpbHRlck5vZGVMaXN0IDogZnVuY3Rpb24obm9kZWxpc3QsZmlsdGVyLGZvckFsbCl7DQogICAgICAgIHZhciByZXN1bHRzID0gW107DQogICAgICAgIGlmKCF1dGlscyAuaXNGdW5jdGlvbihmaWx0ZXIpKXsNCiAgICAgICAgICAgIHZhciBzdHIgPSBmaWx0ZXI7DQogICAgICAgICAgICBmaWx0ZXIgPSBmdW5jdGlvbihuKXsNCiAgICAgICAgICAgICAgICByZXR1cm4gdXRpbHMuaW5kZXhPZih1dGlscy5pc0FycmF5KHN0cikgPyBzdHI6c3RyLnNwbGl0KCcgJyksIG4udGFnTmFtZS50b0xvd2VyQ2FzZSgpKSAhPSAtMQ0KICAgICAgICAgICAgfTsNCiAgICAgICAgfQ0KICAgICAgICB1dGlscy5lYWNoKG5vZGVsaXN0LGZ1bmN0aW9uKG4pew0KICAgICAgICAgICAgZmlsdGVyKG4pICYmIHJlc3VsdHMucHVzaChuKQ0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIHJlc3VsdHMubGVuZ3RoICA9PSAwID8gbnVsbCA6IHJlc3VsdHMubGVuZ3RoID09IDEgfHwgIWZvckFsbCA/IHJlc3VsdHNbMF0gOiByZXN1bHRzDQogICAgfSwNCg0KICAgIGlzSW5Ob2RlRW5kQm91bmRhcnkgOiBmdW5jdGlvbiAocm5nLG5vZGUpew0KICAgICAgICB2YXIgc3RhcnQgPSBybmcuc3RhcnRDb250YWluZXI7DQogICAgICAgIGlmKHN0YXJ0Lm5vZGVUeXBlID09IDMgJiYgcm5nLnN0YXJ0T2Zmc2V0ICE9IHN0YXJ0Lm5vZGVWYWx1ZS5sZW5ndGgpew0KICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgIH0NCiAgICAgICAgaWYoc3RhcnQubm9kZVR5cGUgPT0gMSAmJiBybmcuc3RhcnRPZmZzZXQgIT0gc3RhcnQuY2hpbGROb2Rlcy5sZW5ndGgpew0KICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgIH0NCiAgICAgICAgd2hpbGUoc3RhcnQgIT09IG5vZGUpew0KICAgICAgICAgICAgaWYoc3RhcnQubmV4dFNpYmxpbmcpew0KICAgICAgICAgICAgICAgIHJldHVybiAwDQogICAgICAgICAgICB9Ow0KICAgICAgICAgICAgc3RhcnQgPSBzdGFydC5wYXJlbnROb2RlOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiAxOw0KICAgIH0sDQogICAgaXNCb3VuZGFyeU5vZGUgOiBmdW5jdGlvbiAobm9kZSxkaXIpew0KICAgICAgICB2YXIgdG1wOw0KICAgICAgICB3aGlsZSghZG9tVXRpbHMuaXNCb2R5KG5vZGUpKXsNCiAgICAgICAgICAgIHRtcCA9IG5vZGU7DQogICAgICAgICAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlOw0KICAgICAgICAgICAgaWYodG1wICE9PSBub2RlW2Rpcl0pew0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQp9Ow0KdmFyIGZpbGxDaGFyUmVnID0gbmV3IFJlZ0V4cChkb21VdGlscy5maWxsQ2hhciwgJ2cnKTsKLy8vaW1wb3J0IGVkaXRvci5qcw0KLy8vaW1wb3J0IGNvcmUvdXRpbHMuanMNCi8vL2ltcG9ydCBjb3JlL2Jyb3dzZXIuanMNCi8vL2ltcG9ydCBjb3JlL2RvbS9kb20uanMNCi8vL2ltcG9ydCBjb3JlL2RvbS9kdGQuanMNCi8vL2ltcG9ydCBjb3JlL2RvbS9kb21VdGlscy5qcw0KLyoqDQogKiBAZmlsZQ0KICogQG5hbWUgVUUuZG9tLlJhbmdlDQogKiBAYW50aG9yIHpoYW55aQ0KICogQHNob3J0IFJhbmdlDQogKiBAaW1wb3J0IGVkaXRvci5qcyxjb3JlL3V0aWxzLmpzLGNvcmUvYnJvd3Nlci5qcyxjb3JlL2RvbS9kb21VdGlscy5qcyxjb3JlL2RvbS9kdGQuanMNCiAqIEBkZXNjIFJhbmdl6IyD5Zu05a6e546w57G777yM5pys57G75pivVUVkaXRvcuW6leWxguaguOW/g+exu++8jOe7n+S4gHczY1Jhbmdl5ZKMaWVSYW5nZeS5i+mXtOeahOW3ruW8gu+8jOWMheaLrOaOpeWPo+WSjOWxnuaApw0KICovDQooZnVuY3Rpb24gKCkgew0KICAgIHZhciBndWlkID0gMCwNCiAgICAgICAgZmlsbENoYXIgPSBkb21VdGlscy5maWxsQ2hhciwNCiAgICAgICAgZmlsbERhdGE7DQoNCiAgICAvKioNCiAgICAgKiDmm7TmlrByYW5nZeeahGNvbGxhcHNl54q25oCBDQogICAgICogQHBhcmFtICB7UmFuZ2V9ICAgcmFuZ2UgICAgcmFuZ2Xlr7nosaENCiAgICAgKi8NCiAgICBmdW5jdGlvbiB1cGRhdGVDb2xsYXBzZShyYW5nZSkgew0KICAgICAgICByYW5nZS5jb2xsYXBzZWQgPQ0KICAgICAgICAgICAgcmFuZ2Uuc3RhcnRDb250YWluZXIgJiYgcmFuZ2UuZW5kQ29udGFpbmVyICYmDQogICAgICAgICAgICAgICAgcmFuZ2Uuc3RhcnRDb250YWluZXIgPT09IHJhbmdlLmVuZENvbnRhaW5lciAmJg0KICAgICAgICAgICAgICAgIHJhbmdlLnN0YXJ0T2Zmc2V0ID09IHJhbmdlLmVuZE9mZnNldDsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzZWxlY3RPbmVOb2RlKHJuZyl7DQogICAgICAgIHJldHVybiAhcm5nLmNvbGxhcHNlZCAmJiBybmcuc3RhcnRDb250YWluZXIubm9kZVR5cGUgPT0gMSAmJiBybmcuc3RhcnRDb250YWluZXIgPT09IHJuZy5lbmRDb250YWluZXIgJiYgcm5nLmVuZE9mZnNldCAtIHJuZy5zdGFydE9mZnNldCA9PSAxDQogICAgfQ0KICAgIGZ1bmN0aW9uIHNldEVuZFBvaW50KHRvU3RhcnQsIG5vZGUsIG9mZnNldCwgcmFuZ2UpIHsNCiAgICAgICAgLy/lpoLmnpxub2Rl5piv6Ieq6Zet5ZCI5qCH562+6KaB5aSE55CGDQogICAgICAgIGlmIChub2RlLm5vZGVUeXBlID09IDEgJiYgKGR0ZC4kZW1wdHlbbm9kZS50YWdOYW1lXSB8fCBkdGQuJG5vbkNoaWxkW25vZGUudGFnTmFtZV0pKSB7DQogICAgICAgICAgICBvZmZzZXQgPSBkb21VdGlscy5nZXROb2RlSW5kZXgobm9kZSkgKyAodG9TdGFydCA/IDAgOiAxKTsNCiAgICAgICAgICAgIG5vZGUgPSBub2RlLnBhcmVudE5vZGU7DQogICAgICAgIH0NCiAgICAgICAgaWYgKHRvU3RhcnQpIHsNCiAgICAgICAgICAgIHJhbmdlLnN0YXJ0Q29udGFpbmVyID0gbm9kZTsNCiAgICAgICAgICAgIHJhbmdlLnN0YXJ0T2Zmc2V0ID0gb2Zmc2V0Ow0KICAgICAgICAgICAgaWYgKCFyYW5nZS5lbmRDb250YWluZXIpIHsNCiAgICAgICAgICAgICAgICByYW5nZS5jb2xsYXBzZSh0cnVlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJhbmdlLmVuZENvbnRhaW5lciA9IG5vZGU7DQogICAgICAgICAgICByYW5nZS5lbmRPZmZzZXQgPSBvZmZzZXQ7DQogICAgICAgICAgICBpZiAoIXJhbmdlLnN0YXJ0Q29udGFpbmVyKSB7DQogICAgICAgICAgICAgICAgcmFuZ2UuY29sbGFwc2UoZmFsc2UpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHVwZGF0ZUNvbGxhcHNlKHJhbmdlKTsNCiAgICAgICAgcmV0dXJuIHJhbmdlOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGV4ZWNDb250ZW50c0FjdGlvbihyYW5nZSwgYWN0aW9uKSB7DQogICAgICAgIC8v6LCD5pW06L6555WMDQogICAgICAgIC8vcmFuZ2UuaW5jbHVkZUJvb2ttYXJrKCk7DQogICAgICAgIHZhciBzdGFydCA9IHJhbmdlLnN0YXJ0Q29udGFpbmVyLA0KICAgICAgICAgICAgZW5kID0gcmFuZ2UuZW5kQ29udGFpbmVyLA0KICAgICAgICAgICAgc3RhcnRPZmZzZXQgPSByYW5nZS5zdGFydE9mZnNldCwNCiAgICAgICAgICAgIGVuZE9mZnNldCA9IHJhbmdlLmVuZE9mZnNldCwNCiAgICAgICAgICAgIGRvYyA9IHJhbmdlLmRvY3VtZW50LA0KICAgICAgICAgICAgZnJhZyA9IGRvYy5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksDQogICAgICAgICAgICB0bXBTdGFydCwgdG1wRW5kOw0KICAgICAgICBpZiAoc3RhcnQubm9kZVR5cGUgPT0gMSkgew0KICAgICAgICAgICAgc3RhcnQgPSBzdGFydC5jaGlsZE5vZGVzW3N0YXJ0T2Zmc2V0XSB8fCAodG1wU3RhcnQgPSBzdGFydC5hcHBlbmRDaGlsZChkb2MuY3JlYXRlVGV4dE5vZGUoJycpKSk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGVuZC5ub2RlVHlwZSA9PSAxKSB7DQogICAgICAgICAgICBlbmQgPSBlbmQuY2hpbGROb2Rlc1tlbmRPZmZzZXRdIHx8ICh0bXBFbmQgPSBlbmQuYXBwZW5kQ2hpbGQoZG9jLmNyZWF0ZVRleHROb2RlKCcnKSkpOw0KICAgICAgICB9DQogICAgICAgIGlmIChzdGFydCA9PT0gZW5kICYmIHN0YXJ0Lm5vZGVUeXBlID09IDMpIHsNCiAgICAgICAgICAgIGZyYWcuYXBwZW5kQ2hpbGQoZG9jLmNyZWF0ZVRleHROb2RlKHN0YXJ0LnN1YnN0cmluZ0RhdGEoc3RhcnRPZmZzZXQsIGVuZE9mZnNldCAtIHN0YXJ0T2Zmc2V0KSkpOw0KICAgICAgICAgICAgLy9pcyBub3QgY2xvbmUNCiAgICAgICAgICAgIGlmIChhY3Rpb24pIHsNCiAgICAgICAgICAgICAgICBzdGFydC5kZWxldGVEYXRhKHN0YXJ0T2Zmc2V0LCBlbmRPZmZzZXQgLSBzdGFydE9mZnNldCk7DQogICAgICAgICAgICAgICAgcmFuZ2UuY29sbGFwc2UodHJ1ZSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gZnJhZzsNCiAgICAgICAgfQ0KICAgICAgICB2YXIgY3VycmVudCwgY3VycmVudExldmVsLCBjbG9uZSA9IGZyYWcsDQogICAgICAgICAgICBzdGFydFBhcmVudHMgPSBkb21VdGlscy5maW5kUGFyZW50cyhzdGFydCwgdHJ1ZSksIGVuZFBhcmVudHMgPSBkb21VdGlscy5maW5kUGFyZW50cyhlbmQsIHRydWUpOw0KICAgICAgICBmb3IgKHZhciBpID0gMDsgc3RhcnRQYXJlbnRzW2ldID09IGVuZFBhcmVudHNbaV07KSB7DQogICAgICAgICAgICBpKys7DQogICAgICAgIH0NCiAgICAgICAgZm9yICh2YXIgaiA9IGksIHNpOyBzaSA9IHN0YXJ0UGFyZW50c1tqXTsgaisrKSB7DQogICAgICAgICAgICBjdXJyZW50ID0gc2kubmV4dFNpYmxpbmc7DQogICAgICAgICAgICBpZiAoc2kgPT0gc3RhcnQpIHsNCiAgICAgICAgICAgICAgICBpZiAoIXRtcFN0YXJ0KSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChyYW5nZS5zdGFydENvbnRhaW5lci5ub2RlVHlwZSA9PSAzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjbG9uZS5hcHBlbmRDaGlsZChkb2MuY3JlYXRlVGV4dE5vZGUoc3RhcnQubm9kZVZhbHVlLnNsaWNlKHN0YXJ0T2Zmc2V0KSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgLy9pcyBub3QgY2xvbmUNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpb24pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydC5kZWxldGVEYXRhKHN0YXJ0T2Zmc2V0LCBzdGFydC5ub2RlVmFsdWUubGVuZ3RoIC0gc3RhcnRPZmZzZXQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgY2xvbmUuYXBwZW5kQ2hpbGQoIWFjdGlvbiA/IHN0YXJ0LmNsb25lTm9kZSh0cnVlKSA6IHN0YXJ0KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgY3VycmVudExldmVsID0gc2kuY2xvbmVOb2RlKGZhbHNlKTsNCiAgICAgICAgICAgICAgICBjbG9uZS5hcHBlbmRDaGlsZChjdXJyZW50TGV2ZWwpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgd2hpbGUgKGN1cnJlbnQpIHsNCiAgICAgICAgICAgICAgICBpZiAoY3VycmVudCA9PT0gZW5kIHx8IGN1cnJlbnQgPT09IGVuZFBhcmVudHNbal0pIHsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHNpID0gY3VycmVudC5uZXh0U2libGluZzsNCiAgICAgICAgICAgICAgICBjbG9uZS5hcHBlbmRDaGlsZCghYWN0aW9uID8gY3VycmVudC5jbG9uZU5vZGUodHJ1ZSkgOiBjdXJyZW50KTsNCiAgICAgICAgICAgICAgICBjdXJyZW50ID0gc2k7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBjbG9uZSA9IGN1cnJlbnRMZXZlbDsNCiAgICAgICAgfQ0KICAgICAgICBjbG9uZSA9IGZyYWc7DQogICAgICAgIGlmICghc3RhcnRQYXJlbnRzW2ldKSB7DQogICAgICAgICAgICBjbG9uZS5hcHBlbmRDaGlsZChzdGFydFBhcmVudHNbaSAtIDFdLmNsb25lTm9kZShmYWxzZSkpOw0KICAgICAgICAgICAgY2xvbmUgPSBjbG9uZS5maXJzdENoaWxkOw0KICAgICAgICB9DQogICAgICAgIGZvciAodmFyIGogPSBpLCBlaTsgZWkgPSBlbmRQYXJlbnRzW2pdOyBqKyspIHsNCiAgICAgICAgICAgIGN1cnJlbnQgPSBlaS5wcmV2aW91c1NpYmxpbmc7DQogICAgICAgICAgICBpZiAoZWkgPT0gZW5kKSB7DQogICAgICAgICAgICAgICAgaWYgKCF0bXBFbmQgJiYgcmFuZ2UuZW5kQ29udGFpbmVyLm5vZGVUeXBlID09IDMpIHsNCiAgICAgICAgICAgICAgICAgICAgY2xvbmUuYXBwZW5kQ2hpbGQoZG9jLmNyZWF0ZVRleHROb2RlKGVuZC5zdWJzdHJpbmdEYXRhKDAsIGVuZE9mZnNldCkpKTsNCiAgICAgICAgICAgICAgICAgICAgLy9pcyBub3QgY2xvbmUNCiAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGlvbikgew0KICAgICAgICAgICAgICAgICAgICAgICAgZW5kLmRlbGV0ZURhdGEoMCwgZW5kT2Zmc2V0KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgY3VycmVudExldmVsID0gZWkuY2xvbmVOb2RlKGZhbHNlKTsNCiAgICAgICAgICAgICAgICBjbG9uZS5hcHBlbmRDaGlsZChjdXJyZW50TGV2ZWwpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy/lpoLmnpzkuKTnq6/lkIznuqfvvIzlj7PovrnnrKzkuIDmrKHlt7Lnu4/ooqvlvIDlp4vlgZrkuoYNCiAgICAgICAgICAgIGlmIChqICE9IGkgfHwgIXN0YXJ0UGFyZW50c1tpXSkgew0KICAgICAgICAgICAgICAgIHdoaWxlIChjdXJyZW50KSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50ID09PSBzdGFydCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZWkgPSBjdXJyZW50LnByZXZpb3VzU2libGluZzsNCiAgICAgICAgICAgICAgICAgICAgY2xvbmUuaW5zZXJ0QmVmb3JlKCFhY3Rpb24gPyBjdXJyZW50LmNsb25lTm9kZSh0cnVlKSA6IGN1cnJlbnQsIGNsb25lLmZpcnN0Q2hpbGQpOw0KICAgICAgICAgICAgICAgICAgICBjdXJyZW50ID0gZWk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgY2xvbmUgPSBjdXJyZW50TGV2ZWw7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGFjdGlvbikgew0KICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnRCZWZvcmUoIWVuZFBhcmVudHNbaV0gPyBlbmRQYXJlbnRzW2kgLSAxXSA6ICFzdGFydFBhcmVudHNbaV0gPyBzdGFydFBhcmVudHNbaSAtIDFdIDogZW5kUGFyZW50c1tpXSkuY29sbGFwc2UodHJ1ZSk7DQogICAgICAgIH0NCiAgICAgICAgdG1wU3RhcnQgJiYgZG9tVXRpbHMucmVtb3ZlKHRtcFN0YXJ0KTsNCiAgICAgICAgdG1wRW5kICYmIGRvbVV0aWxzLnJlbW92ZSh0bXBFbmQpOw0KICAgICAgICByZXR1cm4gZnJhZzsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAbmFtZSBSYW5nZQ0KICAgICAqIEBncmFtbWFyIG5ldyBVRS5kb20uUmFuZ2UoZG9jdW1lbnQpICA9PiBSYW5nZSDlrp7kvosNCiAgICAgKiBAZGVzYyDliJvlu7rkuIDkuKrot59kb2N1bWVudOe7keWumueahOepuueahFJhbmdl5a6e5L6LDQogICAgICogLSAqKipzdGFydENvbnRhaW5lcioqKiDlvIDlp4vovrnnlYznmoTlrrnlmajoioLngrks5Y+v5Lul5pivZWxlbWVudE5vZGXmiJbogIXmmK90ZXh0Tm9kZQ0KICAgICAqIC0gKioqc3RhcnRPZmZzZXQqKiog5a655Zmo6IqC54K55Lit55qE5YGP56e76YeP77yM5aaC5p6c5pivZWxlbWVudE5vZGXlsLHmmK9jaGlsZE5vZGVz5Lit55qE56ys5Yeg5Liq77yM5aaC5p6c5pivdGV4dE5vZGXlsLHmmK9ub2RlVmFsdWXnmoTnrKzlh6DkuKrlrZfnrKYNCiAgICAgKiAtICoqKmVuZENvbnRhaW5lcioqKiDnu5PmnZ/ovrnnlYznmoTlrrnlmajoioLngrks5Y+v5Lul5pivZWxlbWVudE5vZGXmiJbogIXmmK90ZXh0Tm9kZQ0KICAgICAqIC0gKioqZW5kT2Zmc2V0KioqIOWuueWZqOiKgueCueS4reeahOWBj+enu+mHj++8jOWmguaenOaYr2VsZW1lbnROb2Rl5bCx5pivY2hpbGROb2Rlc+S4reeahOesrOWHoOS4qu+8jOWmguaenOaYr3RleHROb2Rl5bCx5pivbm9kZVZhbHVl55qE56ys5Yeg5Liq5a2X56ymDQogICAgICogLSAqKipkb2N1bWVudCoqKiDot59yYW5nZeWFs+iBlOeahGRvY3VtZW505a+56LGhDQogICAgICogLSAqKipjb2xsYXBzZWQqKiog5piv5ZCm5piv6Zet5ZCI54q25oCBDQogICAgICovDQogICAgdmFyIFJhbmdlID0gZG9tLlJhbmdlID0gZnVuY3Rpb24gKGRvY3VtZW50KSB7DQogICAgICAgIHZhciBtZSA9IHRoaXM7DQogICAgICAgIG1lLnN0YXJ0Q29udGFpbmVyID0NCiAgICAgICAgICAgIG1lLnN0YXJ0T2Zmc2V0ID0NCiAgICAgICAgICAgICAgICBtZS5lbmRDb250YWluZXIgPQ0KICAgICAgICAgICAgICAgICAgICBtZS5lbmRPZmZzZXQgPSBudWxsOw0KICAgICAgICBtZS5kb2N1bWVudCA9IGRvY3VtZW50Ow0KICAgICAgICBtZS5jb2xsYXBzZWQgPSB0cnVlOw0KICAgIH07DQoNCiAgICAvKioNCiAgICAgKiDliKDpmaRmaWxsRGF0YQ0KICAgICAqIEBwYXJhbSBkb2MNCiAgICAgKiBAcGFyYW0gZXhjbHVkZU5vZGUNCiAgICAgKi8NCiAgICBmdW5jdGlvbiByZW1vdmVGaWxsRGF0YShkb2MsIGV4Y2x1ZGVOb2RlKSB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBpZiAoZmlsbERhdGEgJiYgZG9tVXRpbHMuaW5Eb2MoZmlsbERhdGEsIGRvYykpIHsNCiAgICAgICAgICAgICAgICBpZiAoIWZpbGxEYXRhLm5vZGVWYWx1ZS5yZXBsYWNlKGZpbGxDaGFyUmVnLCAnJykubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciB0bXBOb2RlID0gZmlsbERhdGEucGFyZW50Tm9kZTsNCiAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKGZpbGxEYXRhKTsNCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHRtcE5vZGUgJiYgZG9tVXRpbHMuaXNFbXB0eUlubGluZUVsZW1lbnQodG1wTm9kZSkgJiYNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vc2FmYXJp55qEY29udGFpbnPmnIlidWcNCiAgICAgICAgICAgICAgICAgICAgICAgIChicm93c2VyLnNhZmFyaSA/ICEoZG9tVXRpbHMuZ2V0UG9zaXRpb24odG1wTm9kZSxleGNsdWRlTm9kZSkgJiBkb21VdGlscy5QT1NJVElPTl9DT05UQUlOUykgOiAhdG1wTm9kZS5jb250YWlucyhleGNsdWRlTm9kZSkpDQogICAgICAgICAgICAgICAgICAgICAgICApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxEYXRhID0gdG1wTm9kZS5wYXJlbnROb2RlOw0KICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHRtcE5vZGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG1wTm9kZSA9IGZpbGxEYXRhOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgZmlsbERhdGEubm9kZVZhbHVlID0gZmlsbERhdGEubm9kZVZhbHVlLnJlcGxhY2UoZmlsbENoYXJSZWcsICcnKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqDQogICAgICogQHBhcmFtIG5vZGUNCiAgICAgKiBAcGFyYW0gZGlyDQogICAgICovDQogICAgZnVuY3Rpb24gbWVyZ2VTaWJsaW5nKG5vZGUsIGRpcikgew0KICAgICAgICB2YXIgdG1wTm9kZTsNCiAgICAgICAgbm9kZSA9IG5vZGVbZGlyXTsNCiAgICAgICAgd2hpbGUgKG5vZGUgJiYgZG9tVXRpbHMuaXNGaWxsQ2hhcihub2RlKSkgew0KICAgICAgICAgICAgdG1wTm9kZSA9IG5vZGVbZGlyXTsNCiAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShub2RlKTsNCiAgICAgICAgICAgIG5vZGUgPSB0bXBOb2RlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgUmFuZ2UucHJvdG90eXBlID0gew0KICAgICAgICAvKioNCiAgICAgICAgICogQG5hbWUgY2xvbmVDb250ZW50cw0KICAgICAgICAgKiBAZ3JhbW1hciByYW5nZS5jbG9uZUNvbnRlbnRzKCkgID0+IERvY3VtZW50RnJhZ21lbnQNCiAgICAgICAgICogQGRlc2Mg5YWL6ZqG6YCJ5Lit55qE5YaF5a655Yiw5LiA5LiqZnJhZ21lbnTph4zvvIzlpoLmnpzpgInljLrmmK/nqbrnmoTlsIbov5Tlm55udWxsDQogICAgICAgICAqLw0KICAgICAgICBjbG9uZUNvbnRlbnRzOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbGxhcHNlZCA/IG51bGwgOiBleGVjQ29udGVudHNBY3Rpb24odGhpcywgMCk7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiBAbmFtZSBkZWxldGVDb250ZW50cw0KICAgICAgICAgKiBAZ3JhbW1hciByYW5nZS5kZWxldGVDb250ZW50cygpICA9PiBSYW5nZQ0KICAgICAgICAgKiBAZGVzYyDliKDpmaTlvZPliY3pgInljLrojIPlm7TkuK3nmoTmiYDmnInlhoXlrrnlubbov5Tlm55yYW5nZeWunuS+i++8jOi/meaXtueahHJhbmdl5bey57uP5Y+Y5oiQ5LqG6Zet5ZCI54q25oCBDQogICAgICAgICAqIEBleGFtcGxlDQogICAgICAgICAqIERPTSBFbGVtZW50IDoNCiAgICAgICAgICogPGI+eDxpPnhbeDxpPnh4XXg8L2I+DQogICAgICAgICAqIC8v5omn6KGM5pa55rOV5ZCODQogICAgICAgICAqIDxiPng8aT54PGk+fHg8L2I+DQogICAgICAgICAqIOazqOaEj3Jhbmdl5pS55Y+Y5LqGDQogICAgICAgICAqIHJhbmdlLnN0YXJ0Q29udGFpbmVyID0+IGINCiAgICAgICAgICogcmFuZ2Uuc3RhcnRPZmZzZXQgID0+IDINCiAgICAgICAgICogcmFuZ2UuZW5kQ29udGFpbmVyID0+IGINCiAgICAgICAgICogcmFuZ2UuZW5kT2Zmc2V0ID0+IDINCiAgICAgICAgICogcmFuZ2UuY29sbGFwc2VkID0+IHRydWUNCiAgICAgICAgICovDQogICAgICAgIGRlbGV0ZUNvbnRlbnRzOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciB0eHQ7DQogICAgICAgICAgICBpZiAoIXRoaXMuY29sbGFwc2VkKSB7DQogICAgICAgICAgICAgICAgZXhlY0NvbnRlbnRzQWN0aW9uKHRoaXMsIDEpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKGJyb3dzZXIud2Via2l0KSB7DQogICAgICAgICAgICAgICAgdHh0ID0gdGhpcy5zdGFydENvbnRhaW5lcjsNCiAgICAgICAgICAgICAgICBpZiAodHh0Lm5vZGVUeXBlID09IDMgJiYgIXR4dC5ub2RlVmFsdWUubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhcnRCZWZvcmUodHh0KS5jb2xsYXBzZSh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHR4dCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIHRoaXM7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiBAbmFtZSBleHRyYWN0Q29udGVudHMNCiAgICAgICAgICogQGdyYW1tYXIgcmFuZ2UuZXh0cmFjdENvbnRlbnRzKCkgID0+IERvY3VtZW50RnJhZ21lbnQNCiAgICAgICAgICogQGRlc2Mg5bCG5b2T5YmN55qE5YaF5a655pS+5Yiw5LiA5LiqZnJhZ21lbnTph4zlubbov5Tlm57ov5nkuKpmcmFnbWVudO+8jOi/meaXtueahHJhbmdl5bey57uP5Y+Y5oiQ5LqG6Zet5ZCI54q25oCBDQogICAgICAgICAqIEBleGFtcGxlDQogICAgICAgICAqIERPTSBFbGVtZW50IDoNCiAgICAgICAgICogPGI+eDxpPnhbeDxpPnh4XXg8L2I+DQogICAgICAgICAqIC8v5omn6KGM5pa55rOV5ZCODQogICAgICAgICAqIOi/lOWbnueahGZyYWdtZW506YeM55qEIGRvbee7k+aehOaYrw0KICAgICAgICAgKiA8aT54PGk+eHgNCiAgICAgICAgICogZG9t5qCR5LiK55qE57uT5p6E5pivDQogICAgICAgICAqIDxiPng8aT54PGk+fHg8L2I+DQogICAgICAgICAqIOazqOaEj3Jhbmdl5pS55Y+Y5LqGDQogICAgICAgICAqIHJhbmdlLnN0YXJ0Q29udGFpbmVyID0+IGINCiAgICAgICAgICogcmFuZ2Uuc3RhcnRPZmZzZXQgID0+IDINCiAgICAgICAgICogcmFuZ2UuZW5kQ29udGFpbmVyID0+IGINCiAgICAgICAgICogcmFuZ2UuZW5kT2Zmc2V0ID0+IDINCiAgICAgICAgICogcmFuZ2UuY29sbGFwc2VkID0+IHRydWUNCiAgICAgICAgICovDQogICAgICAgIGV4dHJhY3RDb250ZW50czpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5jb2xsYXBzZWQgPyBudWxsIDogZXhlY0NvbnRlbnRzQWN0aW9uKHRoaXMsIDIpOw0KICAgICAgICB9LA0KICAgICAgICAvKioNCiAgICAgICAgICogQG5hbWUgIHNldFN0YXJ0DQogICAgICAgICAqIEBncmFtbWFyIHJhbmdlLnNldFN0YXJ0KG5vZGUsb2Zmc2V0KSAgPT4gUmFuZ2UNCiAgICAgICAgICogQGRlc2MgICAg6K6+572ucmFuZ2XnmoTlvIDlp4vkvY3nva7kvY3kuo5ub2Rl6IqC54K55YaF77yM5YGP56e76YeP5Li6b2Zmc2V0DQogICAgICAgICAqIOWmguaenG5vZGXmmK9lbGVtZW50Tm9kZemCo29mZnNldOaMh+eahOaYr2NoaWxkTm9kZXPkuK3nmoTnrKzlh6DkuKrvvIzlpoLmnpzmmK90ZXh0Tm9kZemCo29mZnNldOaMh+eahOaYr25vZGVWYWx1ZeeahOesrOWHoOS4quWtl+espg0KICAgICAgICAgKi8NCiAgICAgICAgc2V0U3RhcnQ6ZnVuY3Rpb24gKG5vZGUsIG9mZnNldCkgew0KICAgICAgICAgICAgcmV0dXJuIHNldEVuZFBvaW50KHRydWUsIG5vZGUsIG9mZnNldCwgdGhpcyk7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDorr7nva5yYW5nZeeahOe7k+adn+S9jee9ruS9jeS6jm5vZGXoioLngrnvvIzlgY/np7vph4/kuLpvZmZzZXQNCiAgICAgICAgICog5aaC5p6cbm9kZeaYr2VsZW1lbnROb2Rl6YKjb2Zmc2V05oyH55qE5pivY2hpbGROb2Rlc+S4reeahOesrOWHoOS4qu+8jOWmguaenOaYr3RleHROb2Rl6YKjb2Zmc2V05oyH55qE5pivbm9kZVZhbHVl55qE56ys5Yeg5Liq5a2X56ymDQogICAgICAgICAqIEBuYW1lICBzZXRFbmQNCiAgICAgICAgICogQGdyYW1tYXIgcmFuZ2Uuc2V0RW5kKG5vZGUsb2Zmc2V0KSAgPT4gUmFuZ2UNCiAgICAgICAgICovDQogICAgICAgIHNldEVuZDpmdW5jdGlvbiAobm9kZSwgb2Zmc2V0KSB7DQogICAgICAgICAgICByZXR1cm4gc2V0RW5kUG9pbnQoZmFsc2UsIG5vZGUsIG9mZnNldCwgdGhpcyk7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDlsIZSYW5nZeW8gOWni+S9jee9ruiuvue9ruWIsG5vZGXoioLngrnkuYvlkI4NCiAgICAgICAgICogQG5hbWUgIHNldFN0YXJ0QWZ0ZXINCiAgICAgICAgICogQGdyYW1tYXIgcmFuZ2Uuc2V0U3RhcnRBZnRlcihub2RlKSAgPT4gUmFuZ2UNCiAgICAgICAgICogQGV4YW1wbGUNCiAgICAgICAgICogPGI+eHg8aT54fHg8L2k+eDwvYj4NCiAgICAgICAgICog5omn6KGMc2V0U3RhcnRBZnRlcihpKeWQjg0KICAgICAgICAgKiByYW5nZS5zdGFydENvbnRhaW5lciA9PmINCiAgICAgICAgICogcmFuZ2Uuc3RhcnRPZmZzZXQgPT4yDQogICAgICAgICAqLw0KICAgICAgICBzZXRTdGFydEFmdGVyOmZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRTdGFydChub2RlLnBhcmVudE5vZGUsIGRvbVV0aWxzLmdldE5vZGVJbmRleChub2RlKSArIDEpOw0KICAgICAgICB9LA0KICAgICAgICAvKioNCiAgICAgICAgICog5bCGUmFuZ2XlvIDlp4vkvY3nva7orr7nva7liLBub2Rl6IqC54K55LmL5YmNDQogICAgICAgICAqIEBuYW1lICBzZXRTdGFydEJlZm9yZQ0KICAgICAgICAgKiBAZ3JhbW1hciByYW5nZS5zZXRTdGFydEJlZm9yZShub2RlKSAgPT4gUmFuZ2UNCiAgICAgICAgICogQGV4YW1wbGUNCiAgICAgICAgICogPGI+eHg8aT54fHg8L2k+eDwvYj4NCiAgICAgICAgICog5omn6KGMc2V0U3RhcnRCZWZvcmUoaSnlkI4NCiAgICAgICAgICogcmFuZ2Uuc3RhcnRDb250YWluZXIgPT5iDQogICAgICAgICAqIHJhbmdlLnN0YXJ0T2Zmc2V0ID0+MQ0KICAgICAgICAgKi8NCiAgICAgICAgc2V0U3RhcnRCZWZvcmU6ZnVuY3Rpb24gKG5vZGUpIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldFN0YXJ0KG5vZGUucGFyZW50Tm9kZSwgZG9tVXRpbHMuZ2V0Tm9kZUluZGV4KG5vZGUpKTsNCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIOWwhlJhbmdl57uT5p2f5L2N572u6K6+572u5Yiwbm9kZeiKgueCueS5i+WQjg0KICAgICAgICAgKiBAbmFtZSAgc2V0RW5kQWZ0ZXINCiAgICAgICAgICogQGdyYW1tYXIgcmFuZ2Uuc2V0RW5kQWZ0ZXIobm9kZSkgID0+IFJhbmdlDQogICAgICAgICAqIEBleGFtcGxlDQogICAgICAgICAqIDxiPnh4PGk+eHx4PC9pPng8L2I+DQogICAgICAgICAqIHNldEVuZEFmdGVyKGkp5ZCODQogICAgICAgICAqIHJhbmdlLmVuZENvbnRhaW5lciA9PmINCiAgICAgICAgICogcmFuZ2UuZW5kdE9mZnNldCA9PjINCiAgICAgICAgICovDQogICAgICAgIHNldEVuZEFmdGVyOmZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRFbmQobm9kZS5wYXJlbnROb2RlLCBkb21VdGlscy5nZXROb2RlSW5kZXgobm9kZSkgKyAxKTsNCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIOWwhlJhbmdl57uT5p2f5L2N572u6K6+572u5Yiwbm9kZeiKgueCueS5i+WJjQ0KICAgICAgICAgKiBAbmFtZSAgc2V0RW5kQmVmb3JlDQogICAgICAgICAqIEBncmFtbWFyIHJhbmdlLnNldEVuZEJlZm9yZShub2RlKSAgPT4gUmFuZ2UNCiAgICAgICAgICogQGV4YW1wbGUNCiAgICAgICAgICogPGI+eHg8aT54fHg8L2k+eDwvYj4NCiAgICAgICAgICog5omn6KGMc2V0RW5kQmVmb3JlKGkp5ZCODQogICAgICAgICAqIHJhbmdlLmVuZENvbnRhaW5lciA9PmINCiAgICAgICAgICogcmFuZ2UuZW5kdE9mZnNldCA9PjENCiAgICAgICAgICovDQogICAgICAgIHNldEVuZEJlZm9yZTpmdW5jdGlvbiAobm9kZSkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0RW5kKG5vZGUucGFyZW50Tm9kZSwgZG9tVXRpbHMuZ2V0Tm9kZUluZGV4KG5vZGUpKTsNCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIOWwhlJhbmdl5byA5aeL5L2N572u6K6+572u5Yiwbm9kZeiKgueCueWGheeahOW8gOWni+S9jee9rg0KICAgICAgICAgKiBAbmFtZSAgc2V0U3RhcnRBdEZpcnN0DQogICAgICAgICAqIEBncmFtbWFyIHJhbmdlLnNldFN0YXJ0QXRGaXJzdChub2RlKSAgPT4gUmFuZ2UNCiAgICAgICAgICovDQogICAgICAgIHNldFN0YXJ0QXRGaXJzdDpmdW5jdGlvbiAobm9kZSkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0U3RhcnQobm9kZSwgMCk7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDlsIZSYW5nZeW8gOWni+S9jee9ruiuvue9ruWIsG5vZGXoioLngrnlhoXnmoTnu5PmnZ/kvY3nva4NCiAgICAgICAgICogQG5hbWUgIHNldFN0YXJ0QXRMYXN0DQogICAgICAgICAqIEBncmFtbWFyIHJhbmdlLnNldFN0YXJ0QXRMYXN0KG5vZGUpICA9PiBSYW5nZQ0KICAgICAgICAgKi8NCiAgICAgICAgc2V0U3RhcnRBdExhc3Q6ZnVuY3Rpb24gKG5vZGUpIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldFN0YXJ0KG5vZGUsIG5vZGUubm9kZVR5cGUgPT0gMyA/IG5vZGUubm9kZVZhbHVlLmxlbmd0aCA6IG5vZGUuY2hpbGROb2Rlcy5sZW5ndGgpOw0KICAgICAgICB9LA0KICAgICAgICAvKioNCiAgICAgICAgICog5bCGUmFuZ2Xnu5PmnZ/kvY3nva7orr7nva7liLBub2Rl6IqC54K55YaF55qE5byA5aeL5L2N572uDQogICAgICAgICAqIEBuYW1lICBzZXRFbmRBdEZpcnN0DQogICAgICAgICAqIEBncmFtbWFyIHJhbmdlLnNldEVuZEF0Rmlyc3Qobm9kZSkgID0+IFJhbmdlDQogICAgICAgICAqLw0KICAgICAgICBzZXRFbmRBdEZpcnN0OmZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRFbmQobm9kZSwgMCk7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDlsIZSYW5nZee7k+adn+S9jee9ruiuvue9ruWIsG5vZGXoioLngrnlhoXnmoTnu5PmnZ/kvY3nva4NCiAgICAgICAgICogQG5hbWUgIHNldEVuZEF0TGFzdA0KICAgICAgICAgKiBAZ3JhbW1hciByYW5nZS5zZXRFbmRBdExhc3Qobm9kZSkgID0+IFJhbmdlDQogICAgICAgICAqLw0KICAgICAgICBzZXRFbmRBdExhc3Q6ZnVuY3Rpb24gKG5vZGUpIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldEVuZChub2RlLCBub2RlLm5vZGVUeXBlID09IDMgPyBub2RlLm5vZGVWYWx1ZS5sZW5ndGggOiBub2RlLmNoaWxkTm9kZXMubGVuZ3RoKTsNCiAgICAgICAgfSwNCg0KICAgICAgICAvKioNCiAgICAgICAgICog6YCJ5Lit5a6M5pW055qE5oyH5a6a6IqC54K5LOW5tui/lOWbnuWMheWQq+ivpeiKgueCueeahHJhbmdlDQogICAgICAgICAqIEBuYW1lICBzZWxlY3ROb2RlDQogICAgICAgICAqIEBncmFtbWFyIHJhbmdlLnNlbGVjdE5vZGUobm9kZSkgID0+IFJhbmdlDQogICAgICAgICAqLw0KICAgICAgICBzZWxlY3ROb2RlOmZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRTdGFydEJlZm9yZShub2RlKS5zZXRFbmRBZnRlcihub2RlKTsNCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIOmAieS4rW5vZGXlhoXpg6jnmoTmiYDmnInoioLngrnvvIzlubbov5Tlm57lr7nlupTnmoRyYW5nZQ0KICAgICAgICAgKiBAbmFtZSBzZWxlY3ROb2RlQ29udGVudHMNCiAgICAgICAgICogQGdyYW1tYXIgcmFuZ2Uuc2VsZWN0Tm9kZUNvbnRlbnRzKG5vZGUpICA9PiBSYW5nZQ0KICAgICAgICAgKiBAZXhhbXBsZQ0KICAgICAgICAgKiA8Yj54eFt4PGk+eHh4PC9pPl14eHg8L2I+DQogICAgICAgICAqIOaJp+ihjOWQjg0KICAgICAgICAgKiA8Yj5beHh4PGk+eHh4PC9pPnh4eF08L2I+DQogICAgICAgICAqIHJhbmdlLnN0YXJ0Q29udGFpbmVyID0+Yg0KICAgICAgICAgKiByYW5nZS5zdGFydE9mZnNldCA9PjANCiAgICAgICAgICogcmFuZ2UuZW5kQ29udGFpbmVyID0+Yg0KICAgICAgICAgKiByYW5nZS5lbmRPZmZzZXQgPT4zDQogICAgICAgICAqLw0KICAgICAgICBzZWxlY3ROb2RlQ29udGVudHM6ZnVuY3Rpb24gKG5vZGUpIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldFN0YXJ0KG5vZGUsIDApLnNldEVuZEF0TGFzdChub2RlKTsNCiAgICAgICAgfSwNCg0KICAgICAgICAvKioNCiAgICAgICAgICog5YWL6ZqG5LiA5Liq5paw55qEcmFuZ2Xlr7nosaENCiAgICAgICAgICogQG5hbWUgIGNsb25lUmFuZ2UNCiAgICAgICAgICogQGdyYW1tYXIgcmFuZ2UuY2xvbmVSYW5nZSgpID0+IFJhbmdlDQogICAgICAgICAqLw0KICAgICAgICBjbG9uZVJhbmdlOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7DQogICAgICAgICAgICByZXR1cm4gbmV3IFJhbmdlKG1lLmRvY3VtZW50KS5zZXRTdGFydChtZS5zdGFydENvbnRhaW5lciwgbWUuc3RhcnRPZmZzZXQpLnNldEVuZChtZS5lbmRDb250YWluZXIsIG1lLmVuZE9mZnNldCk7DQoNCiAgICAgICAgfSwNCg0KICAgICAgICAvKioNCiAgICAgICAgICog6K6p6YCJ5Yy66Zet5ZCI5Yiw5bC+6YOo77yM6IuldG9TdGFydOS4uuecn++8jOWImemXreWQiOWIsOWktOmDqA0KICAgICAgICAgKiBAbmFtZSAgY29sbGFwc2UNCiAgICAgICAgICogQGdyYW1tYXIgcmFuZ2UuY29sbGFwc2UoKSA9PiBSYW5nZQ0KICAgICAgICAgKiBAZ3JhbW1hciByYW5nZS5jb2xsYXBzZSh0cnVlKSA9PiBSYW5nZSAgIC8v6Zet5ZCI6YCJ5Yy65Yiw5aS06YOoDQogICAgICAgICAqLw0KICAgICAgICBjb2xsYXBzZTpmdW5jdGlvbiAodG9TdGFydCkgew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpczsNCiAgICAgICAgICAgIGlmICh0b1N0YXJ0KSB7DQogICAgICAgICAgICAgICAgbWUuZW5kQ29udGFpbmVyID0gbWUuc3RhcnRDb250YWluZXI7DQogICAgICAgICAgICAgICAgbWUuZW5kT2Zmc2V0ID0gbWUuc3RhcnRPZmZzZXQ7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIG1lLnN0YXJ0Q29udGFpbmVyID0gbWUuZW5kQ29udGFpbmVyOw0KICAgICAgICAgICAgICAgIG1lLnN0YXJ0T2Zmc2V0ID0gbWUuZW5kT2Zmc2V0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgbWUuY29sbGFwc2VkID0gdHJ1ZTsNCiAgICAgICAgICAgIHJldHVybiBtZTsNCiAgICAgICAgfSwNCg0KICAgICAgICAvKioNCiAgICAgICAgICog6LCD5pW0cmFuZ2XnmoTovrnnlYzvvIzkvb/lhbYi5pS257ypIuWIsOacgOWwj+eahOS9jee9rg0KICAgICAgICAgKiBAbmFtZSAgc2hyaW5rQm91bmRhcnkNCiAgICAgICAgICogQGdyYW1tYXIgcmFuZ2Uuc2hyaW5rQm91bmRhcnkoKSAgPT4gUmFuZ2UgIC8vcmFuZ2XlvIDlp4vkvY3nva7lkoznu5PmnZ/kvY3nva7pg73osIPmlbTvvIzlj4Lop4E8Y29kZT48YSBocmVmPSIjYWRqdXN0bWVudGJvdW5kYXJ5Ij5hZGp1c3RtZW50Qm91bmRhcnk8L2E+PC9jb2RlPg0KICAgICAgICAgKiBAZ3JhbW1hciByYW5nZS5zaHJpbmtCb3VuZGFyeSh0cnVlKSAgPT4gUmFuZ2UgIC8v5LuF6LCD5pW05byA5aeL5L2N572u77yM5b+955Wl57uT5p2f5L2N572uDQogICAgICAgICAqIEBleGFtcGxlDQogICAgICAgICAqIDxiPnh4WzwvYj54eHh4eF0gPT0+IDxiPnh4PC9iPlt4eHh4eF0NCiAgICAgICAgICogPGI+eFt4eDwvYj48aT5deHh4PC9pPiA9PT4gPGI+eFt4eF08L2I+PGk+eHh4PC9pPg0KICAgICAgICAgKiBbPGI+PGk+eHh4eDwvaT54eHh4eHh4PC9iPl0gPT0+IDxiPjxpPlt4eHh4PC9pPnh4eHh4eHhdPC9iPg0KICAgICAgICAgKi8NCiAgICAgICAgc2hyaW5rQm91bmRhcnk6ZnVuY3Rpb24gKGlnbm9yZUVuZCkgew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpcywgY2hpbGQsDQogICAgICAgICAgICAgICAgY29sbGFwc2VkID0gbWUuY29sbGFwc2VkOw0KICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2sobm9kZSl7DQogICAgICAgICAgICAgICAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT0gMSAmJiAhZG9tVXRpbHMuaXNCb29rbWFya05vZGUobm9kZSkgJiYgIWR0ZC4kZW1wdHlbbm9kZS50YWdOYW1lXSAmJiAhZHRkLiRub25DaGlsZFtub2RlLnRhZ05hbWVdDQogICAgICAgICAgICB9DQogICAgICAgICAgICB3aGlsZSAobWUuc3RhcnRDb250YWluZXIubm9kZVR5cGUgPT0gMSAvL+aYr2VsZW1lbnQNCiAgICAgICAgICAgICAgICAmJiAoY2hpbGQgPSBtZS5zdGFydENvbnRhaW5lci5jaGlsZE5vZGVzW21lLnN0YXJ0T2Zmc2V0XSkgLy/lrZDoioLngrnkuZ/mmK9lbGVtZW50DQogICAgICAgICAgICAgICAgJiYgY2hlY2soY2hpbGQpKSB7DQogICAgICAgICAgICAgICAgbWUuc2V0U3RhcnQoY2hpbGQsIDApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKGNvbGxhcHNlZCkgew0KICAgICAgICAgICAgICAgIHJldHVybiBtZS5jb2xsYXBzZSh0cnVlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICghaWdub3JlRW5kKSB7DQogICAgICAgICAgICAgICAgd2hpbGUgKG1lLmVuZENvbnRhaW5lci5ub2RlVHlwZSA9PSAxLy/mmK9lbGVtZW50DQogICAgICAgICAgICAgICAgICAgICYmIG1lLmVuZE9mZnNldCA+IDAgLy/lpoLmnpzmmK/nqbrlhYPntKDlsLHpgIDlh7ogZW5kT2Zmc2V0PTDpgqPkuYhlbmRPZmZzdC0x5Li66LSf5YC877yMY2hpbGROb2Rlc1tlbmRPZmZzZXRd5oql6ZSZDQogICAgICAgICAgICAgICAgICAgICYmIChjaGlsZCA9IG1lLmVuZENvbnRhaW5lci5jaGlsZE5vZGVzW21lLmVuZE9mZnNldCAtIDFdKSAvL+WtkOiKgueCueS5n+aYr2VsZW1lbnQNCiAgICAgICAgICAgICAgICAgICAgJiYgY2hlY2soY2hpbGQpKSB7DQogICAgICAgICAgICAgICAgICAgIG1lLnNldEVuZChjaGlsZCwgY2hpbGQuY2hpbGROb2Rlcy5sZW5ndGgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBtZTsNCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIOiOt+WPluW9k+WJjXJhbmdl5omA5Zyo5L2N572u55qE5YWs5YWx56WW5YWI6IqC54K577yM5b2T5YmNcmFuZ2XkvY3nva7lj6/ku6XkvY3kuo7mlofmnKzoioLngrnlhoXvvIzkuZ/lj6/ku6XljIXlkKvmlbTkuKrlhYPntKDoioLngrnvvIzkuZ/lj6/ku6XkvY3kuo7kuKTkuKroioLngrnkuYvpl7QNCiAgICAgICAgICogQG5hbWUgIGdldENvbW1vbkFuY2VzdG9yDQogICAgICAgICAqIEBncmFtbWFyIHJhbmdlLmdldENvbW1vbkFuY2VzdG9yKFtpbmNsdWRlU2VsZiwgaWdub3JlVGV4dE5vZGVdKSAgPT4gRWxlbWVudA0KICAgICAgICAgKiBAZXhhbXBsZQ0KICAgICAgICAgKiA8Yj54eFt4eDxpPnh4XXg8L2k+eHh4PC9iPiA9PT5nZXRDb21tb25BbmNlc3RvcigpID09PiBiDQogICAgICAgICAqIDxiPls8aW1nLz5dPC9iPg0KICAgICAgICAgKiByYW5nZS5zdGFydENvbnRhaW5lciA9PT4gYg0KICAgICAgICAgKiByYW5nZS5zdGFydE9mZnNldCA9PT4gMA0KICAgICAgICAgKiByYW5nZS5lbmRDb250YWluZXIgPT0+IGINCiAgICAgICAgICogcmFuZ2UuZW5kT2Zmc2V0ID09PiAxDQogICAgICAgICAqIHJhbmdlLmdldENvbW1vbkFuY2VzdG9yKCkgPT0+IGINCiAgICAgICAgICogcmFuZ2UuZ2V0Q29tbW9uQW5jZXN0b3IodHJ1ZSkgPT0+IGltZw0KICAgICAgICAgKiA8Yj54eHh8eHg8L2I+DQogICAgICAgICAqIHJhbmdlLnN0YXJ0Q29udGFpbmVyID09PiB0ZXh0Tm9kZQ0KICAgICAgICAgKiByYW5nZS5zdGFydE9mZnNldCA9PT4gMw0KICAgICAgICAgKiByYW5nZS5lbmRDb250YWluZXIgPT0+IHRleHROb2RlDQogICAgICAgICAqIHJhbmdlLmVuZE9mZnNldCA9PT4gMw0KICAgICAgICAgKiByYW5nZS5nZXRDb21tb25BbmNlc3RvcigpID09PiB0ZXh0Tm9kZQ0KICAgICAgICAgKiByYW5nZS5nZXRDb21tb25BbmNlc3RvcihudWxsLHRydWUpID09PiBiDQogICAgICAgICAqLw0KICAgICAgICBnZXRDb21tb25BbmNlc3RvcjpmdW5jdGlvbiAoaW5jbHVkZVNlbGYsIGlnbm9yZVRleHROb2RlKSB7DQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzLA0KICAgICAgICAgICAgICAgIHN0YXJ0ID0gbWUuc3RhcnRDb250YWluZXIsDQogICAgICAgICAgICAgICAgZW5kID0gbWUuZW5kQ29udGFpbmVyOw0KICAgICAgICAgICAgaWYgKHN0YXJ0ID09PSBlbmQpIHsNCiAgICAgICAgICAgICAgICBpZiAoaW5jbHVkZVNlbGYgJiYgc2VsZWN0T25lTm9kZSh0aGlzKSkgew0KICAgICAgICAgICAgICAgICAgICBzdGFydCA9IHN0YXJ0LmNoaWxkTm9kZXNbbWUuc3RhcnRPZmZzZXRdOw0KICAgICAgICAgICAgICAgICAgICBpZihzdGFydC5ub2RlVHlwZSA9PSAxKQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0YXJ0Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAvL+WPquacieWcqOS4iuadpeWwseebuOetieeahOaDheWGteS4i+aJjeS8muWHuueOsOaYr+aWh+acrOeahOaDheWGtQ0KICAgICAgICAgICAgICAgIHJldHVybiBpZ25vcmVUZXh0Tm9kZSAmJiBzdGFydC5ub2RlVHlwZSA9PSAzID8gc3RhcnQucGFyZW50Tm9kZSA6IHN0YXJ0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGRvbVV0aWxzLmdldENvbW1vbkFuY2VzdG9yKHN0YXJ0LCBlbmQpOw0KICAgICAgICB9LA0KICAgICAgICAvKioNCiAgICAgICAgICog6LCD5pW06L6555WM5a655Zmo77yM5aaC5p6c5pivdGV4dE5vZGUs5bCx6LCD5pW05YiwZWxlbWVudE5vZGXkuIoNCiAgICAgICAgICogQG5hbWUgdHJpbUJvdW5kYXJ5DQogICAgICAgICAqIEBncmFtbWFyIHJhbmdlLnRyaW1Cb3VuZGFyeShbaWdub3JlRW5kXSkgID0+IFJhbmdlIC8vdHJ1ZeW/veeVpee7k+adn+i+ueeVjA0KICAgICAgICAgKiBAZXhhbXBsZQ0KICAgICAgICAgKiBET00gRWxlbWVudCA6DQogICAgICAgICAqIDxiPnx4eHg8L2I+DQogICAgICAgICAqIHN0YXJ0Q29udGFpbmVyID0geHh4OyBzdGFydE9mZnNldCA9IDANCiAgICAgICAgICogLy/miafooYzlkI7mnKzmlrnms5XlkI4NCiAgICAgICAgICogc3RhcnRDb250YWluZXIgPSA8Yj47ICBzdGFydE9mZnNldCA9IDANCiAgICAgICAgICogQGV4YW1wbGUNCiAgICAgICAgICogRG9tIEVsZW1lbnQgOg0KICAgICAgICAgKiA8Yj54eHx4PC9iPg0KICAgICAgICAgKiBzdGFydENvbnRhaW5lciA9IHh4eDsgIHN0YXJ0T2Zmc2V0ID0gMg0KICAgICAgICAgKiAvL+aJp+ihjOacrOaWueazleWQju+8jHh4eOiiq+WunuWunuWcqOWcqOWcsOWIh+WIhuaIkOS4pOS4qlRleHROb2RlDQogICAgICAgICAqIHN0YXJ0Q29udGFpbmVyID0gPGI+OyBzdGFydE9mZnNldCA9IDENCiAgICAgICAgICovDQogICAgICAgIHRyaW1Cb3VuZGFyeTpmdW5jdGlvbiAoaWdub3JlRW5kKSB7DQogICAgICAgICAgICB0aGlzLnR4dFRvRWxtQm91bmRhcnkoKTsNCiAgICAgICAgICAgIHZhciBzdGFydCA9IHRoaXMuc3RhcnRDb250YWluZXIsDQogICAgICAgICAgICAgICAgb2Zmc2V0ID0gdGhpcy5zdGFydE9mZnNldCwNCiAgICAgICAgICAgICAgICBjb2xsYXBzZWQgPSB0aGlzLmNvbGxhcHNlZCwNCiAgICAgICAgICAgICAgICBlbmQgPSB0aGlzLmVuZENvbnRhaW5lcjsNCiAgICAgICAgICAgIGlmIChzdGFydC5ub2RlVHlwZSA9PSAzKSB7DQogICAgICAgICAgICAgICAgaWYgKG9mZnNldCA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhcnRCZWZvcmUoc3RhcnQpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChvZmZzZXQgPj0gc3RhcnQubm9kZVZhbHVlLmxlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGFydEFmdGVyKHN0YXJ0KTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0Tm9kZSA9IGRvbVV0aWxzLnNwbGl0KHN0YXJ0LCBvZmZzZXQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgLy/ot5/mlrDnu5PmnZ/ovrnnlYwNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGFydCA9PT0gZW5kKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRFbmQodGV4dE5vZGUsIHRoaXMuZW5kT2Zmc2V0IC0gb2Zmc2V0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhcnQucGFyZW50Tm9kZSA9PT0gZW5kKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmRPZmZzZXQgKz0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhcnRCZWZvcmUodGV4dE5vZGUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChjb2xsYXBzZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29sbGFwc2UodHJ1ZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCFpZ25vcmVFbmQpIHsNCiAgICAgICAgICAgICAgICBvZmZzZXQgPSB0aGlzLmVuZE9mZnNldDsNCiAgICAgICAgICAgICAgICBlbmQgPSB0aGlzLmVuZENvbnRhaW5lcjsNCiAgICAgICAgICAgICAgICBpZiAoZW5kLm5vZGVUeXBlID09IDMpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKG9mZnNldCA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldEVuZEJlZm9yZShlbmQpOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0IDwgZW5kLm5vZGVWYWx1ZS5sZW5ndGggJiYgZG9tVXRpbHMuc3BsaXQoZW5kLCBvZmZzZXQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRFbmRBZnRlcihlbmQpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIHRoaXM7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDlpoLmnpzpgInljLrlnKjmlofmnKznmoTovrnnlYzkuIrvvIzlsLHmianlsZXpgInljLrliLDmlofmnKznmoTniLboioLngrnkuIoNCiAgICAgICAgICogQG5hbWUgIHR4dFRvRWxtQm91bmRhcnkNCiAgICAgICAgICogQGV4YW1wbGUNCiAgICAgICAgICogRG9tIEVsZW1lbnQgOg0KICAgICAgICAgKiA8Yj4gfHh4eDwvYj4NCiAgICAgICAgICogc3RhcnRDb250YWluZXIgPSB4eHg7ICBzdGFydE9mZnNldCA9IDANCiAgICAgICAgICogLy/mnKzmlrnms5XmiafooYzlkI4NCiAgICAgICAgICogc3RhcnRDb250YWluZXIgPSA8Yj47IHN0YXJ0T2Zmc2V0ID0gMA0KICAgICAgICAgKiBAZXhhbXBsZQ0KICAgICAgICAgKiBEb20gRWxlbWVudCA6DQogICAgICAgICAqIDxiPiB4eHh8IDwvYj4NCiAgICAgICAgICogc3RhcnRDb250YWluZXIgPSB4eHg7IHN0YXJ0T2Zmc2V0ID0gMw0KICAgICAgICAgKiAvL+acrOaWueazleaJp+ihjOWQjg0KICAgICAgICAgKiBzdGFydENvbnRhaW5lciA9IDxiPjsgc3RhcnRPZmZzZXQgPSAxDQogICAgICAgICAqLw0KICAgICAgICB0eHRUb0VsbUJvdW5kYXJ5OmZ1bmN0aW9uIChpZ25vcmVDb2xsYXBzZWQpIHsNCiAgICAgICAgICAgIGZ1bmN0aW9uIGFkanVzdChyLCBjKSB7DQogICAgICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9IHJbYyArICdDb250YWluZXInXSwNCiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gcltjICsgJ09mZnNldCddOw0KICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIubm9kZVR5cGUgPT0gMykgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIW9mZnNldCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgclsnc2V0JyArIGMucmVwbGFjZSgvKFx3KS8sIGZ1bmN0aW9uIChhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEudG9VcHBlckNhc2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pICsgJ0JlZm9yZSddKGNvbnRhaW5lcik7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAob2Zmc2V0ID49IGNvbnRhaW5lci5ub2RlVmFsdWUubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByWydzZXQnICsgYy5yZXBsYWNlKC8oXHcpLywgZnVuY3Rpb24gKGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYS50b1VwcGVyQ2FzZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSkgKyAnQWZ0ZXInIF0oY29udGFpbmVyKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKGlnbm9yZUNvbGxhcHNlZCB8fCAhdGhpcy5jb2xsYXBzZWQpIHsNCiAgICAgICAgICAgICAgICBhZGp1c3QodGhpcywgJ3N0YXJ0Jyk7DQogICAgICAgICAgICAgICAgYWRqdXN0KHRoaXMsICdlbmQnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiB0aGlzOw0KICAgICAgICB9LA0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiDlnKjlvZPliY3pgInljLrnmoTlvIDlp4vkvY3nva7liY3mj5LlhaXkuIDkuKroioLngrnmiJbogIVmcmFnbWVudO+8jHJhbmdl55qE5byA5aeL5L2N572u5Lya5Zyo5o+S5YWl6IqC54K555qE5YmN6L65DQogICAgICAgICAqIEBuYW1lICBpbnNlcnROb2RlDQogICAgICAgICAqIEBncmFtbWFyIHJhbmdlLmluc2VydE5vZGUobm9kZSkgID0+IFJhbmdlIC8vbm9kZeWPr+S7peaYr3RleHROb2RlLGVsZW1lbnROb2RlLGZyYWdtZW50DQogICAgICAgICAqIEBleGFtcGxlDQogICAgICAgICAqIFJhbmdlIDoNCiAgICAgICAgICogeHh4W3g8cD54eHh4PC9wPnh4eHhdeDxwPnNkZnNkZjwvcD4NCiAgICAgICAgICog5b6F5o+S5YWlTm9kZSA6DQogICAgICAgICAqIDxwPnNzc3M8L3A+DQogICAgICAgICAqIOaJp+ihjOacrOaWueazleWQjueahFJhbmdlIDoNCiAgICAgICAgICogeHh4WzxwPnNzc3M8L3A+eDxwPnh4eHg8L3A+eHh4eF14PHA+c2Rmc2RmPC9wPg0KICAgICAgICAgKi8NCiAgICAgICAgaW5zZXJ0Tm9kZTpmdW5jdGlvbiAobm9kZSkgew0KICAgICAgICAgICAgdmFyIGZpcnN0ID0gbm9kZSwgbGVuZ3RoID0gMTsNCiAgICAgICAgICAgIGlmIChub2RlLm5vZGVUeXBlID09IDExKSB7DQogICAgICAgICAgICAgICAgZmlyc3QgPSBub2RlLmZpcnN0Q2hpbGQ7DQogICAgICAgICAgICAgICAgbGVuZ3RoID0gbm9kZS5jaGlsZE5vZGVzLmxlbmd0aDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMudHJpbUJvdW5kYXJ5KHRydWUpOw0KICAgICAgICAgICAgdmFyIHN0YXJ0ID0gdGhpcy5zdGFydENvbnRhaW5lciwNCiAgICAgICAgICAgICAgICBvZmZzZXQgPSB0aGlzLnN0YXJ0T2Zmc2V0Ow0KICAgICAgICAgICAgdmFyIG5leHROb2RlID0gc3RhcnQuY2hpbGROb2Rlc1sgb2Zmc2V0IF07DQogICAgICAgICAgICBpZiAobmV4dE5vZGUpIHsNCiAgICAgICAgICAgICAgICBzdGFydC5pbnNlcnRCZWZvcmUobm9kZSwgbmV4dE5vZGUpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBzdGFydC5hcHBlbmRDaGlsZChub2RlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChmaXJzdC5wYXJlbnROb2RlID09PSB0aGlzLmVuZENvbnRhaW5lcikgew0KICAgICAgICAgICAgICAgIHRoaXMuZW5kT2Zmc2V0ID0gdGhpcy5lbmRPZmZzZXQgKyBsZW5ndGg7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRTdGFydEJlZm9yZShmaXJzdCk7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDorr7nva7lhYnmoIfpl63lkIjkvY3nva4sdG9FbmTorr7nva7kuLp0cnVl5pe25YWJ5qCH5bCG6Zet5ZCI5Yiw6YCJ5Yy655qE57uT5bC+DQogICAgICAgICAqIEBuYW1lICBzZXRDdXJzb3INCiAgICAgICAgICogQGdyYW1tYXIgcmFuZ2Uuc2V0Q3Vyc29yKFt0b0VuZF0pICA9PiAgUmFuZ2UgICAvL3RvRW5k5Li6dHJ1ZeaXtu+8jOWFieagh+mXreWQiOWIsOmAieWMuueahOacq+Wwvg0KICAgICAgICAgKi8NCiAgICAgICAgc2V0Q3Vyc29yOmZ1bmN0aW9uICh0b0VuZCwgbm9GaWxsRGF0YSkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29sbGFwc2UoIXRvRW5kKS5zZWxlY3Qobm9GaWxsRGF0YSk7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDliJvlu7rlvZPliY1yYW5nZeeahOS4gOS4quS5puetvu+8jOiusOW9leS4i+W9k+WJjXJhbmdl55qE5L2N572u77yM5pa55L6/5b2TZG9t5qCR5pS55Y+Y5pe277yM6L+Y6IO95om+5Zue5Y6f5p2l55qE6YCJ5Yy65L2N572uDQogICAgICAgICAqIEBuYW1lIGNyZWF0ZUJvb2ttYXJrDQogICAgICAgICAqIEBncmFtbWFyIHJhbmdlLmNyZWF0ZUJvb2ttYXJrKFtzZXJpYWxpemVdKSAgPT4gT2JqZWN0ICAvL3tzdGFydDrlvIDlp4vmoIforrAsZW5kOue7k+adn+agh+iusCxpZDpzZXJpYWxpemV9IHNlcmlhbGl6ZeS4uuecn+aXtu+8jOW8gOWni+e7k+adn+agh+iusOaYr+aPkuWFpeiKgueCueeahGlk77yM5ZCm5YiZ5piv5o+S5YWl6IqC54K555qE5byV55SoDQogICAgICAgICAqLw0KICAgICAgICBjcmVhdGVCb29rbWFyazpmdW5jdGlvbiAoc2VyaWFsaXplLCBzYW1lKSB7DQogICAgICAgICAgICB2YXIgZW5kTm9kZSwNCiAgICAgICAgICAgICAgICBzdGFydE5vZGUgPSB0aGlzLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsNCiAgICAgICAgICAgIHN0YXJ0Tm9kZS5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6bm9uZTtsaW5lLWhlaWdodDowcHg7JzsNCiAgICAgICAgICAgIHN0YXJ0Tm9kZS5hcHBlbmRDaGlsZCh0aGlzLmRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCdcdTIwMEQnKSk7DQogICAgICAgICAgICBzdGFydE5vZGUuaWQgPSAnX2JhaWR1X2Jvb2ttYXJrX3N0YXJ0XycgKyAoc2FtZSA/ICcnIDogZ3VpZCsrKTsNCg0KICAgICAgICAgICAgaWYgKCF0aGlzLmNvbGxhcHNlZCkgew0KICAgICAgICAgICAgICAgIGVuZE5vZGUgPSBzdGFydE5vZGUuY2xvbmVOb2RlKHRydWUpOw0KICAgICAgICAgICAgICAgIGVuZE5vZGUuaWQgPSAnX2JhaWR1X2Jvb2ttYXJrX2VuZF8nICsgKHNhbWUgPyAnJyA6IGd1aWQrKyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLmluc2VydE5vZGUoc3RhcnROb2RlKTsNCiAgICAgICAgICAgIGlmIChlbmROb2RlKSB7DQogICAgICAgICAgICAgICAgdGhpcy5jb2xsYXBzZSgpLmluc2VydE5vZGUoZW5kTm9kZSkuc2V0RW5kQmVmb3JlKGVuZE5vZGUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5zZXRTdGFydEFmdGVyKHN0YXJ0Tm9kZSk7DQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgIHN0YXJ0OnNlcmlhbGl6ZSA/IHN0YXJ0Tm9kZS5pZCA6IHN0YXJ0Tm9kZSwNCiAgICAgICAgICAgICAgICBlbmQ6ZW5kTm9kZSA/IHNlcmlhbGl6ZSA/IGVuZE5vZGUuaWQgOiBlbmROb2RlIDogbnVsbCwNCiAgICAgICAgICAgICAgICBpZDpzZXJpYWxpemUNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqICDnp7vliqjovrnnlYzliLDkuabnrb7kvY3nva7vvIzlubbliKDpmaTmj5LlhaXnmoTkuabnrb7oioLngrkNCiAgICAgICAgICogIEBuYW1lICBtb3ZlVG9Cb29rbWFyaw0KICAgICAgICAgKiAgQGdyYW1tYXIgcmFuZ2UubW92ZVRvQm9va21hcmsoYm9va21hcmspICA9PiBSYW5nZSAvL+iuqeW9k+WJjeeahHJhbmdl6YCJ5Yiw57uZ5a6aYm9va21hcmvnmoTkvY3nva4sYm9va21hcmvlr7nosaHmmK/nlLFyYW5nZS5jcmVhdGVCb29rbWFya+WIm+W7uueahA0KICAgICAgICAgKi8NCiAgICAgICAgbW92ZVRvQm9va21hcms6ZnVuY3Rpb24gKGJvb2ttYXJrKSB7DQogICAgICAgICAgICB2YXIgc3RhcnQgPSBib29rbWFyay5pZCA/IHRoaXMuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYm9va21hcmsuc3RhcnQpIDogYm9va21hcmsuc3RhcnQsDQogICAgICAgICAgICAgICAgZW5kID0gYm9va21hcmsuZW5kICYmIGJvb2ttYXJrLmlkID8gdGhpcy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChib29rbWFyay5lbmQpIDogYm9va21hcmsuZW5kOw0KICAgICAgICAgICAgdGhpcy5zZXRTdGFydEJlZm9yZShzdGFydCk7DQogICAgICAgICAgICBkb21VdGlscy5yZW1vdmUoc3RhcnQpOw0KICAgICAgICAgICAgaWYgKGVuZCkgew0KICAgICAgICAgICAgICAgIHRoaXMuc2V0RW5kQmVmb3JlKGVuZCk7DQogICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKGVuZCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRoaXMuY29sbGFwc2UodHJ1ZSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gdGhpczsNCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIOiwg+aVtHJhbmdl55qE6L6555WM77yM5L2/5YW2IuaUvuWkpyLliLDmnIDov5HnmoTniLZibG9ja+iKgueCuQ0KICAgICAgICAgKiBAbmFtZSAgZW5sYXJnZQ0KICAgICAgICAgKiBAZ3JhbW1hciByYW5nZS5lbmxhcmdlKCkgID0+ICBSYW5nZQ0KICAgICAgICAgKiBAZXhhbXBsZQ0KICAgICAgICAgKiA8cD48c3Bhbj54eHg8L3NwYW4+PGI+eFt4PC9iPnh4eHh4XTwvcD48cD54eHg8L3A+ID09PiBbPHA+PHNwYW4+eHh4PC9zcGFuPjxiPnh4PC9iPnh4eHh4PC9wPl08cD54eHg8L3A+DQogICAgICAgICAqLw0KICAgICAgICBlbmxhcmdlOmZ1bmN0aW9uICh0b0Jsb2NrLCBzdG9wRm4pIHsNCiAgICAgICAgICAgIHZhciBpc0JvZHkgPSBkb21VdGlscy5pc0JvZHksDQogICAgICAgICAgICAgICAgcHJlLCBub2RlLCB0bXAgPSB0aGlzLmRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCcnKTsNCiAgICAgICAgICAgIGlmICh0b0Jsb2NrKSB7DQogICAgICAgICAgICAgICAgbm9kZSA9IHRoaXMuc3RhcnRDb250YWluZXI7DQogICAgICAgICAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT0gMSkgew0KICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5jaGlsZE5vZGVzW3RoaXMuc3RhcnRPZmZzZXRdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwcmUgPSBub2RlID0gbm9kZS5jaGlsZE5vZGVzW3RoaXMuc3RhcnRPZmZzZXRdDQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBub2RlLmFwcGVuZENoaWxkKHRtcCk7DQogICAgICAgICAgICAgICAgICAgICAgICBwcmUgPSBub2RlID0gdG1wOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgcHJlID0gbm9kZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGRvbVV0aWxzLmlzQmxvY2tFbG0obm9kZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSBwcmU7DQogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoKHByZSA9IG5vZGUucHJldmlvdXNTaWJsaW5nKSAmJiAhZG9tVXRpbHMuaXNCbG9ja0VsbShwcmUpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IHByZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhcnRCZWZvcmUobm9kZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBwcmUgPSBub2RlOw0KICAgICAgICAgICAgICAgICAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBub2RlID0gdGhpcy5lbmRDb250YWluZXI7DQogICAgICAgICAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT0gMSkgew0KICAgICAgICAgICAgICAgICAgICBpZiAocHJlID0gbm9kZS5jaGlsZE5vZGVzW3RoaXMuZW5kT2Zmc2V0XSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5pbnNlcnRCZWZvcmUodG1wLCBwcmUpOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5hcHBlbmRDaGlsZCh0bXApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHByZSA9IG5vZGUgPSB0bXA7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgcHJlID0gbm9kZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGRvbVV0aWxzLmlzQmxvY2tFbG0obm9kZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSBwcmU7DQogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoKHByZSA9IG5vZGUubmV4dFNpYmxpbmcpICYmICFkb21VdGlscy5pc0Jsb2NrRWxtKHByZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlID0gcHJlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRFbmRBZnRlcihub2RlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHByZSA9IG5vZGU7DQogICAgICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLnBhcmVudE5vZGU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICh0bXAucGFyZW50Tm9kZSA9PT0gdGhpcy5lbmRDb250YWluZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmRPZmZzZXQtLTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHRtcCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIOaJqeWxlei+ueeVjOWIsOacgOWkpw0KICAgICAgICAgICAgaWYgKCF0aGlzLmNvbGxhcHNlZCkgew0KICAgICAgICAgICAgICAgIHdoaWxlICh0aGlzLnN0YXJ0T2Zmc2V0ID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHN0b3BGbiAmJiBzdG9wRm4odGhpcy5zdGFydENvbnRhaW5lcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmIChpc0JvZHkodGhpcy5zdGFydENvbnRhaW5lcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhcnRCZWZvcmUodGhpcy5zdGFydENvbnRhaW5lcik7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHdoaWxlICh0aGlzLmVuZE9mZnNldCA9PSAodGhpcy5lbmRDb250YWluZXIubm9kZVR5cGUgPT0gMSA/IHRoaXMuZW5kQ29udGFpbmVyLmNoaWxkTm9kZXMubGVuZ3RoIDogdGhpcy5lbmRDb250YWluZXIubm9kZVZhbHVlLmxlbmd0aCkpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHN0b3BGbiAmJiBzdG9wRm4odGhpcy5lbmRDb250YWluZXIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoaXNCb2R5KHRoaXMuZW5kQ29udGFpbmVyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRFbmRBZnRlcih0aGlzLmVuZENvbnRhaW5lcik7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIHRoaXM7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDosIPmlbRSYW5nZeeahOi+ueeVjO+8jOS9v+WFtiLnvKnlsI8i5Yiw5pyA5ZCI6YCC55qE5L2N572uDQogICAgICAgICAqIEBuYW1lIGFkanVzdG1lbnRCb3VuZGFyeQ0KICAgICAgICAgKiBAZ3JhbW1hciByYW5nZS5hZGp1c3RtZW50Qm91bmRhcnkoKSA9PiBSYW5nZSAgIC8v5Y+C6KeBPGNvZGU+PGEgaHJlZj0iI3Nocmlua2JvdW5kYXJ5Ij5zaHJpbmtCb3VuZGFyeTwvYT48L2NvZGU+DQogICAgICAgICAqIEBleGFtcGxlDQogICAgICAgICAqIDxiPnh4WzwvYj54eHh4eF0gPT0+IDxiPnh4PC9iPlt4eHh4eF0NCiAgICAgICAgICogPGI+eFt4eDwvYj48aT5deHh4PC9pPiA9PT4gPGI+eFt4eDwvYj5dPGk+eHh4PC9pPg0KICAgICAgICAgKi8NCiAgICAgICAgYWRqdXN0bWVudEJvdW5kYXJ5OmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIGlmICghdGhpcy5jb2xsYXBzZWQpIHsNCiAgICAgICAgICAgICAgICB3aGlsZSAoIWRvbVV0aWxzLmlzQm9keSh0aGlzLnN0YXJ0Q29udGFpbmVyKSAmJg0KICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0T2Zmc2V0ID09IHRoaXMuc3RhcnRDb250YWluZXJbdGhpcy5zdGFydENvbnRhaW5lci5ub2RlVHlwZSA9PSAzID8gJ25vZGVWYWx1ZScgOiAnY2hpbGROb2RlcyddLmxlbmd0aCAmJg0KICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0Q29udGFpbmVyW3RoaXMuc3RhcnRDb250YWluZXIubm9kZVR5cGUgPT0gMyA/ICdub2RlVmFsdWUnIDogJ2NoaWxkTm9kZXMnXS5sZW5ndGgNCiAgICAgICAgICAgICAgICAgICAgKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGFydEFmdGVyKHRoaXMuc3RhcnRDb250YWluZXIpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB3aGlsZSAoIWRvbVV0aWxzLmlzQm9keSh0aGlzLmVuZENvbnRhaW5lcikgJiYgIXRoaXMuZW5kT2Zmc2V0ICYmDQogICAgICAgICAgICAgICAgICAgIHRoaXMuZW5kQ29udGFpbmVyW3RoaXMuZW5kQ29udGFpbmVyLm5vZGVUeXBlID09IDMgPyAnbm9kZVZhbHVlJyA6ICdjaGlsZE5vZGVzJ10ubGVuZ3RoDQogICAgICAgICAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNldEVuZEJlZm9yZSh0aGlzLmVuZENvbnRhaW5lcik7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIHRoaXM7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDnu5lyYW5nZemAieWMuuS4reeahOWGheWuuea3u+WKoOe7meWumueahOagh+etvu+8jOS4u+imgeeUqOS6jmlubGluZeagh+etvg0KICAgICAgICAgKiBAbmFtZSBhcHBseUlubGluZVN0eWxlDQogICAgICAgICAqIEBncmFtbWFyIHJhbmdlLmFwcGx5SW5saW5lU3R5bGUodGFnTmFtZSkgICAgICAgID0+ICBSYW5nZSAgICAvL3RhZ05hbWXkuLrpnIDopoHmt7vliqDnmoTmoLflvI/moIfnrb7lkI0NCiAgICAgICAgICogQGdyYW1tYXIgcmFuZ2UuYXBwbHlJbmxpbmVTdHlsZSh0YWdOYW1lLGF0dHJzKSAgPT4gIFJhbmdlICAgIC8vYXR0cnPkuLrlsZ7mgKdqc29u5a+56LGhDQogICAgICAgICAqIEBkZXNjDQogICAgICAgICAqIDxjb2RlIHR5cGU9Imh0bWwiPjxwPnh4eHhbeHh4eF14PC9wPiAgPT0+ICByYW5nZS5hcHBseUlubGluZVN0eWxlKCJzdHJvbmciKSAgPT0+ICA8cD54eHh4WzxzdHJvbmc+eHh4eDwvc3Ryb25nPl14PC9wPg0KICAgICAgICAgKiA8cD54eFtkZDxzdHJvbmc+eXl5eTwvc3Ryb25nPl14PC9wPiAgPT0+ICByYW5nZS5hcHBseUlubGluZVN0eWxlKCJzdHJvbmciKSAgPT0+ICA8cD54eFs8c3Ryb25nPmRkeXl5eTwvc3Ryb25nPl14PC9wPg0KICAgICAgICAgKiA8cD54eHh4W3h4eHhdeDwvcD4gID09PiAgcmFuZ2UuYXBwbHlJbmxpbmVTdHlsZSgic3Ryb25nIix7InN0eWxlIjoiZm9udC1zaXplOjEycHgifSkgID09PiAgPHA+eHh4eFs8c3Ryb25nIHN0eWxlPSJmb250LXNpemU6MTJweCI+eHh4eDwvc3Ryb25nPl14PC9wPjwvY29kZT4NCiAgICAgICAgICovDQogICAgICAgIGFwcGx5SW5saW5lU3R5bGU6ZnVuY3Rpb24gKHRhZ05hbWUsIGF0dHJzLCBsaXN0KSB7DQogICAgICAgICAgICBpZiAodGhpcy5jb2xsYXBzZWQpcmV0dXJuIHRoaXM7DQogICAgICAgICAgICB0aGlzLnRyaW1Cb3VuZGFyeSgpLmVubGFyZ2UoZmFsc2UsDQogICAgICAgICAgICAgICAgZnVuY3Rpb24gKG5vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT0gMSAmJiBkb21VdGlscy5pc0Jsb2NrRWxtKG5vZGUpDQogICAgICAgICAgICAgICAgfSkuYWRqdXN0bWVudEJvdW5kYXJ5KCk7DQogICAgICAgICAgICB2YXIgYm9va21hcmsgPSB0aGlzLmNyZWF0ZUJvb2ttYXJrKCksDQogICAgICAgICAgICAgICAgZW5kID0gYm9va21hcmsuZW5kLA0KICAgICAgICAgICAgICAgIGZpbHRlckZuID0gZnVuY3Rpb24gKG5vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT0gMSA/IG5vZGUudGFnTmFtZS50b0xvd2VyQ2FzZSgpICE9ICdicicgOiAhZG9tVXRpbHMuaXNXaGl0ZXNwYWNlKG5vZGUpOw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgY3VycmVudCA9IGRvbVV0aWxzLmdldE5leHREb21Ob2RlKGJvb2ttYXJrLnN0YXJ0LCBmYWxzZSwgZmlsdGVyRm4pLA0KICAgICAgICAgICAgICAgIG5vZGUsDQogICAgICAgICAgICAgICAgcHJlLA0KICAgICAgICAgICAgICAgIHJhbmdlID0gdGhpcy5jbG9uZVJhbmdlKCk7DQogICAgICAgICAgICB3aGlsZSAoY3VycmVudCAmJiAoZG9tVXRpbHMuZ2V0UG9zaXRpb24oY3VycmVudCwgZW5kKSAmIGRvbVV0aWxzLlBPU0lUSU9OX1BSRUNFRElORykpIHsNCiAgICAgICAgICAgICAgICBpZiAoY3VycmVudC5ub2RlVHlwZSA9PSAzIHx8IGR0ZFt0YWdOYW1lXVtjdXJyZW50LnRhZ05hbWVdKSB7DQogICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0QmVmb3JlKGN1cnJlbnQpOw0KICAgICAgICAgICAgICAgICAgICBub2RlID0gY3VycmVudDsNCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKG5vZGUgJiYgKG5vZGUubm9kZVR5cGUgPT0gMyB8fCBkdGRbdGFnTmFtZV1bbm9kZS50YWdOYW1lXSkgJiYgbm9kZSAhPT0gZW5kKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwcmUgPSBub2RlOw0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IGRvbVV0aWxzLmdldE5leHREb21Ob2RlKG5vZGUsIG5vZGUubm9kZVR5cGUgPT0gMSwgbnVsbCwgZnVuY3Rpb24gKHBhcmVudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkdGRbdGFnTmFtZV1bcGFyZW50LnRhZ05hbWVdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdmFyIGZyYWcgPSByYW5nZS5zZXRFbmRBZnRlcihwcmUpLmV4dHJhY3RDb250ZW50cygpLCBlbG07DQogICAgICAgICAgICAgICAgICAgIGlmIChsaXN0ICYmIGxpc3QubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxldmVsLCB0b3A7DQogICAgICAgICAgICAgICAgICAgICAgICB0b3AgPSBsZXZlbCA9IGxpc3RbMF0uY2xvbmVOb2RlKGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAxLCBjaTsgY2kgPSBsaXN0W2krK107KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWwuYXBwZW5kQ2hpbGQoY2kuY2xvbmVOb2RlKGZhbHNlKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWwgPSBsZXZlbC5maXJzdENoaWxkOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxtID0gbGV2ZWw7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBlbG0gPSByYW5nZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZ05hbWUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmIChhdHRycykgew0KICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMuc2V0QXR0cmlidXRlcyhlbG0sIGF0dHJzKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBlbG0uYXBwZW5kQ2hpbGQoZnJhZyk7DQogICAgICAgICAgICAgICAgICAgIHJhbmdlLmluc2VydE5vZGUobGlzdCA/IHRvcCA6IGVsbSk7DQogICAgICAgICAgICAgICAgICAgIC8v5aSE55CG5LiL5ruR57q/5ZyoYeS4iueahOaDheWGtQ0KICAgICAgICAgICAgICAgICAgICB2YXIgYU5vZGU7DQogICAgICAgICAgICAgICAgICAgIGlmICh0YWdOYW1lID09ICdzcGFuJyAmJiBhdHRycy5zdHlsZSAmJiAvdGV4dFwtZGVjb3JhdGlvbi8udGVzdChhdHRycy5zdHlsZSkgJiYgKGFOb2RlID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShlbG0sICdhJywgdHJ1ZSkpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5zZXRBdHRyaWJ1dGVzKGFOb2RlLCBhdHRycyk7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUoZWxtLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsbSA9IGFOb2RlOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMubWVyZ2VTaWJsaW5nKGVsbSk7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5jbGVhckVtcHR5U2libGluZyhlbG0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIC8v5Y676Zmk5a2Q6IqC54K555u45ZCM55qEDQogICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLm1lcmdlQ2hpbGQoZWxtLCBhdHRycyk7DQogICAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBkb21VdGlscy5nZXROZXh0RG9tTm9kZShlbG0sIGZhbHNlLCBmaWx0ZXJGbik7DQogICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLm1lcmdlVG9QYXJlbnQoZWxtKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUgPT09IGVuZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBjdXJyZW50ID0gZG9tVXRpbHMuZ2V0TmV4dERvbU5vZGUoY3VycmVudCwgdHJ1ZSwgZmlsdGVyRm4pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiB0aGlzLm1vdmVUb0Jvb2ttYXJrKGJvb2ttYXJrKTsNCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIOWvueW9k+WJjXJhbmdl6YCJ5Lit55qE6IqC54K577yM5Y675o6J57uZ5a6a55qE5qCH562+6IqC54K577yM5L2G5qCH562+5Lit55qE5YaF5a655L+d55WZ77yM5Li76KaB55So5LqO5aSE55CGaW5saW5l5YWD57SgDQogICAgICAgICAqIEBuYW1lIHJlbW92ZUlubGluZVN0eWxlDQogICAgICAgICAqIEBncmFtbWFyIHJhbmdlLnJlbW92ZUlubGluZVN0eWxlKHRhZ05hbWVzKSAgPT4gUmFuZ2UgIC8vdGFnTmFtZXMg5Li66ZyA6KaB5Y675o6J55qE5qC35byP5qCH562+5ZCNLOaUr+aMgSJiIuaIluiAhVsiYiIsImkiLCJ1Il0NCiAgICAgICAgICogQGRlc2MNCiAgICAgICAgICogPGNvZGUgdHlwZT0iaHRtbCI+eHhbeDxzcGFuPnh4eDxlbT55eXk8L2VtPnp6XXo8L3NwYW4+ICA9PiByYW5nZS5yZW1vdmVJbmxpbmVTdHlsZShbImVtIl0pICA9PiB4eFt4PHNwYW4+eHh4eXl5enpdejwvc3Bhbj48L2NvZGU+DQogICAgICAgICAqLw0KICAgICAgICByZW1vdmVJbmxpbmVTdHlsZTpmdW5jdGlvbiAodGFnTmFtZXMpIHsNCiAgICAgICAgICAgIGlmICh0aGlzLmNvbGxhcHNlZClyZXR1cm4gdGhpczsNCiAgICAgICAgICAgIHRhZ05hbWVzID0gdXRpbHMuaXNBcnJheSh0YWdOYW1lcykgPyB0YWdOYW1lcyA6IFt0YWdOYW1lc107DQogICAgICAgICAgICB0aGlzLnNocmlua0JvdW5kYXJ5KCkuYWRqdXN0bWVudEJvdW5kYXJ5KCk7DQogICAgICAgICAgICB2YXIgc3RhcnQgPSB0aGlzLnN0YXJ0Q29udGFpbmVyLCBlbmQgPSB0aGlzLmVuZENvbnRhaW5lcjsNCiAgICAgICAgICAgIHdoaWxlICgxKSB7DQogICAgICAgICAgICAgICAgaWYgKHN0YXJ0Lm5vZGVUeXBlID09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHV0aWxzLmluZGV4T2YodGFnTmFtZXMsIHN0YXJ0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSkgPiAtMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PSAnYm9keScpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHN0YXJ0ID0gc3RhcnQucGFyZW50Tm9kZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHdoaWxlICgxKSB7DQogICAgICAgICAgICAgICAgaWYgKGVuZC5ub2RlVHlwZSA9PSAxKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICh1dGlscy5pbmRleE9mKHRhZ05hbWVzLCBlbmQudGFnTmFtZS50b0xvd2VyQ2FzZSgpKSA+IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoZW5kLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PSAnYm9keScpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZCA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbmQgPSBlbmQucGFyZW50Tm9kZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZhciBib29rbWFyayA9IHRoaXMuY3JlYXRlQm9va21hcmsoKSwNCiAgICAgICAgICAgICAgICBmcmFnLA0KICAgICAgICAgICAgICAgIHRtcFJhbmdlOw0KICAgICAgICAgICAgaWYgKHN0YXJ0KSB7DQogICAgICAgICAgICAgICAgdG1wUmFuZ2UgPSB0aGlzLmNsb25lUmFuZ2UoKS5zZXRFbmRCZWZvcmUoYm9va21hcmsuc3RhcnQpLnNldFN0YXJ0QmVmb3JlKHN0YXJ0KTsNCiAgICAgICAgICAgICAgICBmcmFnID0gdG1wUmFuZ2UuZXh0cmFjdENvbnRlbnRzKCk7DQogICAgICAgICAgICAgICAgdG1wUmFuZ2UuaW5zZXJ0Tm9kZShmcmFnKTsNCiAgICAgICAgICAgICAgICBkb21VdGlscy5jbGVhckVtcHR5U2libGluZyhzdGFydCwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgc3RhcnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoYm9va21hcmsuc3RhcnQsIHN0YXJ0KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChlbmQpIHsNCiAgICAgICAgICAgICAgICB0bXBSYW5nZSA9IHRoaXMuY2xvbmVSYW5nZSgpLnNldFN0YXJ0QWZ0ZXIoYm9va21hcmsuZW5kKS5zZXRFbmRBZnRlcihlbmQpOw0KICAgICAgICAgICAgICAgIGZyYWcgPSB0bXBSYW5nZS5leHRyYWN0Q29udGVudHMoKTsNCiAgICAgICAgICAgICAgICB0bXBSYW5nZS5pbnNlcnROb2RlKGZyYWcpOw0KICAgICAgICAgICAgICAgIGRvbVV0aWxzLmNsZWFyRW1wdHlTaWJsaW5nKGVuZCwgZmFsc2UsIHRydWUpOw0KICAgICAgICAgICAgICAgIGVuZC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShib29rbWFyay5lbmQsIGVuZC5uZXh0U2libGluZyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB2YXIgY3VycmVudCA9IGRvbVV0aWxzLmdldE5leHREb21Ob2RlKGJvb2ttYXJrLnN0YXJ0LCBmYWxzZSwgZnVuY3Rpb24gKG5vZGUpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gbm9kZS5ub2RlVHlwZSA9PSAxOw0KICAgICAgICAgICAgfSksIG5leHQ7DQogICAgICAgICAgICB3aGlsZSAoY3VycmVudCAmJiBjdXJyZW50ICE9PSBib29rbWFyay5lbmQpIHsNCiAgICAgICAgICAgICAgICBuZXh0ID0gZG9tVXRpbHMuZ2V0TmV4dERvbU5vZGUoY3VycmVudCwgdHJ1ZSwgZnVuY3Rpb24gKG5vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT0gMTsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBpZiAodXRpbHMuaW5kZXhPZih0YWdOYW1lcywgY3VycmVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCkpID4gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKGN1cnJlbnQsIHRydWUpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBjdXJyZW50ID0gbmV4dDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiB0aGlzLm1vdmVUb0Jvb2ttYXJrKGJvb2ttYXJrKTsNCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIOW+l+WIsOS4gOS4quiHqumXreWQiOeahOiKgueCuSzluLjnlKjkuo7ojrflj5boh6rpl63lkoznmoToioLngrnvvIzkvovlpoLlm77niYfoioLngrkNCiAgICAgICAgICogQG5hbWUgIGdldENsb3NlZE5vZGUNCiAgICAgICAgICogQGdyYW1tYXIgcmFuZ2UuZ2V0Q2xvc2VkTm9kZSgpICA9PiBub2RlfG51bGwNCiAgICAgICAgICogQGV4YW1wbGUNCiAgICAgICAgICogPGI+eHh4eFs8aW1nIC8+XXh4eDwvYj4NCiAgICAgICAgICovDQogICAgICAgIGdldENsb3NlZE5vZGU6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIG5vZGU7DQogICAgICAgICAgICBpZiAoIXRoaXMuY29sbGFwc2VkKSB7DQogICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gdGhpcy5jbG9uZVJhbmdlKCkuYWRqdXN0bWVudEJvdW5kYXJ5KCkuc2hyaW5rQm91bmRhcnkoKTsNCiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0T25lTm9kZShyYW5nZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkID0gcmFuZ2Uuc3RhcnRDb250YWluZXIuY2hpbGROb2Rlc1tyYW5nZS5zdGFydE9mZnNldF07DQogICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZCAmJiBjaGlsZC5ub2RlVHlwZSA9PSAxICYmIChkdGQuJGVtcHR5W2NoaWxkLnRhZ05hbWVdIHx8IGR0ZC4kbm9uQ2hpbGRbY2hpbGQudGFnTmFtZV0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBub2RlID0gY2hpbGQ7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gbm9kZTsNCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIOagueaNruW9k+WJjXJhbmdl6YCJ5Lit5YaF5a656IqC54K577yI5Zyo6aG16Z2i5LiK6KGo546w5Li65Y+N55m95pi+56S677yJDQogICAgICAgICAqIEBuYW1lIHNlbGVjdA0KICAgICAgICAgKiBAZ3JhbW1hciByYW5nZS5zZWxlY3QoKTsgID0+IFJhbmdlDQogICAgICAgICAqLw0KICAgICAgICBzZWxlY3Q6YnJvd3Nlci5pZSA/IGZ1bmN0aW9uIChub0ZpbGxEYXRhLCB0ZXh0UmFuZ2UpIHsNCiAgICAgICAgICAgIHZhciBuYXRpdmVSYW5nZTsNCiAgICAgICAgICAgIGlmICghdGhpcy5jb2xsYXBzZWQpDQogICAgICAgICAgICAgICAgdGhpcy5zaHJpbmtCb3VuZGFyeSgpOw0KICAgICAgICAgICAgdmFyIG5vZGUgPSB0aGlzLmdldENsb3NlZE5vZGUoKTsNCiAgICAgICAgICAgIGlmIChub2RlICYmICF0ZXh0UmFuZ2UpIHsNCiAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICBuYXRpdmVSYW5nZSA9IHRoaXMuZG9jdW1lbnQuYm9keS5jcmVhdGVDb250cm9sUmFuZ2UoKTsNCiAgICAgICAgICAgICAgICAgICAgbmF0aXZlUmFuZ2UuYWRkRWxlbWVudChub2RlKTsNCiAgICAgICAgICAgICAgICAgICAgbmF0aXZlUmFuZ2Uuc2VsZWN0KCk7DQogICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge30NCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZhciBib29rbWFyayA9IHRoaXMuY3JlYXRlQm9va21hcmsoKSwNCiAgICAgICAgICAgICAgICBzdGFydCA9IGJvb2ttYXJrLnN0YXJ0LA0KICAgICAgICAgICAgICAgIGVuZDsNCiAgICAgICAgICAgIG5hdGl2ZVJhbmdlID0gdGhpcy5kb2N1bWVudC5ib2R5LmNyZWF0ZVRleHRSYW5nZSgpOw0KICAgICAgICAgICAgbmF0aXZlUmFuZ2UubW92ZVRvRWxlbWVudFRleHQoc3RhcnQpOw0KICAgICAgICAgICAgbmF0aXZlUmFuZ2UubW92ZVN0YXJ0KCdjaGFyYWN0ZXInLCAxKTsNCiAgICAgICAgICAgIGlmICghdGhpcy5jb2xsYXBzZWQpIHsNCiAgICAgICAgICAgICAgICB2YXIgbmF0aXZlUmFuZ2VFbmQgPSB0aGlzLmRvY3VtZW50LmJvZHkuY3JlYXRlVGV4dFJhbmdlKCk7DQogICAgICAgICAgICAgICAgZW5kID0gYm9va21hcmsuZW5kOw0KICAgICAgICAgICAgICAgIG5hdGl2ZVJhbmdlRW5kLm1vdmVUb0VsZW1lbnRUZXh0KGVuZCk7DQogICAgICAgICAgICAgICAgbmF0aXZlUmFuZ2Uuc2V0RW5kUG9pbnQoJ0VuZFRvRW5kJywgbmF0aXZlUmFuZ2VFbmQpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpZiAoIW5vRmlsbERhdGEgJiYgdGhpcy5zdGFydENvbnRhaW5lci5ub2RlVHlwZSAhPSAzKSB7DQogICAgICAgICAgICAgICAgICAgIC8v5L2/55SoPHNwYW4+fHg8c3Bhbj7lm7rlrprkvY/lhYnmoIcNCiAgICAgICAgICAgICAgICAgICAgdmFyIHRtcFRleHQgPSB0aGlzLmRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGZpbGxDaGFyKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHRtcCA9IHRoaXMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOw0KICAgICAgICAgICAgICAgICAgICB0bXAuYXBwZW5kQ2hpbGQodGhpcy5kb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShmaWxsQ2hhcikpOw0KICAgICAgICAgICAgICAgICAgICBzdGFydC5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0bXAsIHN0YXJ0KTsNCiAgICAgICAgICAgICAgICAgICAgc3RhcnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUodG1wVGV4dCwgc3RhcnQpOw0KICAgICAgICAgICAgICAgICAgICAvL+W9k+eCuWIsaSx15pe277yM5LiN6IO95riF6ZmkaeS4iui+ueeahGINCiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlRmlsbERhdGEodGhpcy5kb2N1bWVudCwgdG1wVGV4dCk7DQogICAgICAgICAgICAgICAgICAgIGZpbGxEYXRhID0gdG1wVGV4dDsNCiAgICAgICAgICAgICAgICAgICAgbWVyZ2VTaWJsaW5nKHRtcCwgJ3ByZXZpb3VzU2libGluZycpOw0KICAgICAgICAgICAgICAgICAgICBtZXJnZVNpYmxpbmcoc3RhcnQsICduZXh0U2libGluZycpOw0KICAgICAgICAgICAgICAgICAgICBuYXRpdmVSYW5nZS5tb3ZlU3RhcnQoJ2NoYXJhY3RlcicsIC0xKTsNCiAgICAgICAgICAgICAgICAgICAgbmF0aXZlUmFuZ2UuY29sbGFwc2UodHJ1ZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5tb3ZlVG9Cb29rbWFyayhib29rbWFyayk7DQogICAgICAgICAgICB0bXAgJiYgZG9tVXRpbHMucmVtb3ZlKHRtcCk7DQogICAgICAgICAgICAvL0lF5Zyo6ZqQ6JeP54q25oCB5LiL5LiN5pSv5oyBcmFuZ2Xmk43kvZzvvIxjYXRjaOS4gOS4iw0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBuYXRpdmVSYW5nZS5zZWxlY3QoKTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiB0aGlzOw0KICAgICAgICB9IDogZnVuY3Rpb24gKG5vdEluc2VydEZpbGxEYXRhKSB7DQogICAgICAgICAgICBmdW5jdGlvbiBjaGVja09mZnNldChybmcpew0KDQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2sobm9kZSxvZmZzZXQsZGlyKXsNCiAgICAgICAgICAgICAgICAgICAgaWYobm9kZS5ub2RlVHlwZSA9PSAzICYmIG5vZGUubm9kZVZhbHVlLmxlbmd0aCA8IG9mZnNldCl7DQogICAgICAgICAgICAgICAgICAgICAgICBybmdbZGlyICsgJ09mZnNldCddID0gbm9kZS5ub2RlVmFsdWUubGVuZ3RoDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgY2hlY2socm5nLnN0YXJ0Q29udGFpbmVyLHJuZy5zdGFydE9mZnNldCwnc3RhcnQnKTsNCiAgICAgICAgICAgICAgICBjaGVjayhybmcuZW5kQ29udGFpbmVyLHJuZy5lbmRPZmZzZXQsJ2VuZCcpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdmFyIHdpbiA9IGRvbVV0aWxzLmdldFdpbmRvdyh0aGlzLmRvY3VtZW50KSwNCiAgICAgICAgICAgICAgICBzZWwgPSB3aW4uZ2V0U2VsZWN0aW9uKCksDQogICAgICAgICAgICAgICAgdHh0Tm9kZTsNCiAgICAgICAgICAgIC8vRkbkuIvlhbPpl63oh6rliqjplb/pq5jml7bmu5rliqjmnaHlnKjlhbPpl61kaWFsb2fml7bkvJrot7MNCiAgICAgICAgICAgIC8vZmbkuIvlpoLmnpzkuI1ib2R5LmZvY3Vz5bCG5LiN6IO95a6a5L2N6Zet5ZCI5YWJ5qCH5Yiw57yW6L6R5Zmo5YaFDQogICAgICAgICAgICBicm93c2VyLmdlY2tvID8gdGhpcy5kb2N1bWVudC5ib2R5LmZvY3VzKCkgOiB3aW4uZm9jdXMoKTsNCiAgICAgICAgICAgIGlmIChzZWwpIHsNCiAgICAgICAgICAgICAgICBzZWwucmVtb3ZlQWxsUmFuZ2VzKCk7DQogICAgICAgICAgICAgICAgLy8gdHJhY2U6ODcwIGNocm9tZS9zYWZhcmnlkI7ovrnmmK9icuWvueS6jumXreWQiOW+l3Jhbmdl5LiN6IO95a6a5L2NIOaJgOS7peWOu+aOieS6huWIpOaWrQ0KICAgICAgICAgICAgICAgIC8vIHRoaXMuc3RhcnRDb250YWluZXIubm9kZVR5cGUgIT0gMyAmJiEgKChjaGlsZCA9IHRoaXMuc3RhcnRDb250YWluZXIuY2hpbGROb2Rlc1t0aGlzLnN0YXJ0T2Zmc2V0XSkgJiYgY2hpbGQubm9kZVR5cGUgPT0gMSAmJiBjaGlsZC50YWdOYW1lID09ICdCUicNCiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb2xsYXBzZWQgJiYgIW5vdEluc2VydEZpbGxEYXRhKSB7DQovLyAgICAgICAgICAgICAgICAgICAgLy9vcGVhcuWmguaenOayoeacieiKgueCueaOpeedgO+8jOWOn+eUn+eahOS4jeiDveWkn+WumuS9jSzkuI3og73lnKhib2R555qE56ys5LiA57qn5o+S5YWl56m655m96IqC54K5DQovLyAgICAgICAgICAgICAgICAgICAgaWYgKG5vdEluc2VydEZpbGxEYXRhICYmIGJyb3dzZXIub3BlcmEgJiYgIWRvbVV0aWxzLmlzQm9keSh0aGlzLnN0YXJ0Q29udGFpbmVyKSAmJiB0aGlzLnN0YXJ0Q29udGFpbmVyLm5vZGVUeXBlID09IDEpIHsNCi8vICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRtcCA9IHRoaXMuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJycpOw0KLy8gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmluc2VydE5vZGUodG1wKS5zZXRTdGFydCh0bXAsIDApLmNvbGxhcHNlKHRydWUpOw0KLy8gICAgICAgICAgICAgICAgICAgIH0NCi8vDQogICAgICAgICAgICAgICAgICAgIC8v5aSE55CG5YWJ5qCH6JC95Zyo5paH5pys6IqC54K555qE5oOF5Ya1DQogICAgICAgICAgICAgICAgICAgIC8v5aSE55CG5Lul5LiL55qE5oOF5Ya1DQogICAgICAgICAgICAgICAgICAgIC8vPGI+fHh4eHg8L2I+DQogICAgICAgICAgICAgICAgICAgIC8vPGI+eHh4eDwvYj58eHh4eA0KICAgICAgICAgICAgICAgICAgICAvL3h4eHg8Yj58PC9iPg0KICAgICAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSB0aGlzLnN0YXJ0Q29udGFpbmVyLGNoaWxkID0gc3RhcnQ7DQogICAgICAgICAgICAgICAgICAgIGlmKHN0YXJ0Lm5vZGVUeXBlID09IDEpew0KICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQgPSBzdGFydC5jaGlsZE5vZGVzW3RoaXMuc3RhcnRPZmZzZXRdOw0KDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYoICEoc3RhcnQubm9kZVR5cGUgPT0gMyAmJiB0aGlzLnN0YXJ0T2Zmc2V0KSAgJiYNCiAgICAgICAgICAgICAgICAgICAgICAgIChjaGlsZCA/DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKCFjaGlsZC5wcmV2aW91c1NpYmxpbmcgfHwgY2hpbGQucHJldmlvdXNTaWJsaW5nLm5vZGVUeXBlICE9IDMpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICghc3RhcnQubGFzdENoaWxkIHx8IHN0YXJ0Lmxhc3RDaGlsZC5ub2RlVHlwZSAhPSAzKQ0KICAgICAgICAgICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgICAgICAgICApew0KICAgICAgICAgICAgICAgICAgICAgICAgdHh0Tm9kZSA9IHRoaXMuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoZmlsbENoYXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgLy/ot5/nnYDliY3ovrnotbANCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5zZXJ0Tm9kZSh0eHROb2RlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUZpbGxEYXRhKHRoaXMuZG9jdW1lbnQsIHR4dE5vZGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbWVyZ2VTaWJsaW5nKHR4dE5vZGUsICdwcmV2aW91c1NpYmxpbmcnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lcmdlU2libGluZyh0eHROb2RlLCAnbmV4dFNpYmxpbmcnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxEYXRhID0gdHh0Tm9kZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhcnQodHh0Tm9kZSwgYnJvd3Nlci53ZWJraXQgPyAxIDogMCkuY29sbGFwc2UodHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdmFyIG5hdGl2ZVJhbmdlID0gdGhpcy5kb2N1bWVudC5jcmVhdGVSYW5nZSgpOw0KICAgICAgICAgICAgICAgIGlmKHRoaXMuY29sbGFwc2VkICYmIGJyb3dzZXIub3BlcmEgJiYgdGhpcy5zdGFydENvbnRhaW5lci5ub2RlVHlwZSA9PSAxKXsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkID0gdGhpcy5zdGFydENvbnRhaW5lci5jaGlsZE5vZGVzW3RoaXMuc3RhcnRPZmZzZXRdOw0KICAgICAgICAgICAgICAgICAgICBpZighY2hpbGQpew0KICAgICAgICAgICAgICAgICAgICAgICAgLy/lvoDliY3pnaDmi6INCiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkID0gdGhpcy5zdGFydENvbnRhaW5lci5sYXN0Q2hpbGQ7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiggY2hpbGQgJiYgZG9tVXRpbHMuaXNCcihjaGlsZCkpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhcnRCZWZvcmUoY2hpbGQpLmNvbGxhcHNlKHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8v5ZCR5ZCO6Z2g5ouiDQogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZShjaGlsZCAmJiBkb21VdGlscy5pc0Jsb2NrRWxtKGNoaWxkKSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY2hpbGQubm9kZVR5cGUgPT0gMSAmJiBjaGlsZC5jaGlsZE5vZGVzWzBdKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQgPSBjaGlsZC5jaGlsZE5vZGVzWzBdDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkICYmIHRoaXMuc2V0U3RhcnRCZWZvcmUoY2hpbGQpLmNvbGxhcHNlKHRydWUpDQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAvL+aYr2NyZWF0ZUFkZHJlc3PmnIDlkI7kuIDkvY3nrpfnmoTkuI3lh4bvvIznjrDlnKjov5nph4zov5vooYzlvq7osIMNCiAgICAgICAgICAgICAgICBjaGVja09mZnNldCh0aGlzKTsNCiAgICAgICAgICAgICAgICBuYXRpdmVSYW5nZS5zZXRTdGFydCh0aGlzLnN0YXJ0Q29udGFpbmVyLCB0aGlzLnN0YXJ0T2Zmc2V0KTsNCiAgICAgICAgICAgICAgICBuYXRpdmVSYW5nZS5zZXRFbmQodGhpcy5lbmRDb250YWluZXIsIHRoaXMuZW5kT2Zmc2V0KTsNCiAgICAgICAgICAgICAgICBzZWwuYWRkUmFuZ2UobmF0aXZlUmFuZ2UpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIHRoaXM7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDmu5rliqjmnaHot7PliLDlvZPnhLZyYW5nZeW8gOWni+eahOS9jee9rg0KICAgICAgICAgKiBAbmFtZSBzY3JvbGxUb1ZpZXcNCiAgICAgICAgICogQGdyYW1tYXIgcmFuZ2Uuc2Nyb2xsVG9WaWV3KFt3aW4sb2Zmc2V0XSkgPT4gUmFuZ2UgLy/pkojlr7l3aW5kb3flr7nosaHvvIzoi6XkuI3mjIflrprvvIzlsIbku6XnvJbovpHljLrln5/nmoTnqpflj6PkuLrlh4Ysb2Zmc2V05YGP56e76YePDQogICAgICAgICAqLw0KICAgICAgICBzY3JvbGxUb1ZpZXc6ZnVuY3Rpb24gKHdpbiwgb2Zmc2V0KSB7DQogICAgICAgICAgICB3aW4gPSB3aW4gPyB3aW5kb3cgOiBkb21VdGlscy5nZXRXaW5kb3codGhpcy5kb2N1bWVudCk7DQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzLA0KICAgICAgICAgICAgICAgIHNwYW4gPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7DQogICAgICAgICAgICAvL3RyYWNlOjcxNw0KICAgICAgICAgICAgc3Bhbi5pbm5lckhUTUwgPSAnJm5ic3A7JzsNCiAgICAgICAgICAgIG1lLmNsb25lUmFuZ2UoKS5pbnNlcnROb2RlKHNwYW4pOw0KICAgICAgICAgICAgZG9tVXRpbHMuc2Nyb2xsVG9WaWV3KHNwYW4sIHdpbiwgb2Zmc2V0KTsNCiAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShzcGFuKTsNCiAgICAgICAgICAgIHJldHVybiBtZTsNCiAgICAgICAgfSwNCiAgICAgICAgaW5GaWxsQ2hhciA6IGZ1bmN0aW9uKCl7DQogICAgICAgICAgICB2YXIgc3RhcnQgPSB0aGlzLnN0YXJ0Q29udGFpbmVyOw0KICAgICAgICAgICAgaWYodGhpcy5jb2xsYXBzZWQgJiYgc3RhcnQubm9kZVR5cGUgPT0gMw0KICAgICAgICAgICAgICAgICYmIHN0YXJ0Lm5vZGVWYWx1ZS5yZXBsYWNlKG5ldyBSZWdFeHAoJ14nICsgZG9tVXRpbHMuZmlsbENoYXIpLCcnKS5sZW5ndGggKyAxID09IHN0YXJ0Lm5vZGVWYWx1ZS5sZW5ndGgNCiAgICAgICAgICAgICAgICApew0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9LA0KICAgICAgICBjcmVhdGVBZGRyZXNzIDogZnVuY3Rpb24oaWdub3JlRW5kLGlnbm9yZVR4dCl7DQogICAgICAgICAgICB2YXIgYWRkciA9IHt9LG1lID0gdGhpczsNCg0KICAgICAgICAgICAgZnVuY3Rpb24gZ2V0QWRkcmVzcyhpc1N0YXJ0KXsNCiAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IGlzU3RhcnQgPyBtZS5zdGFydENvbnRhaW5lciA6IG1lLmVuZENvbnRhaW5lcjsNCiAgICAgICAgICAgICAgICB2YXIgcGFyZW50cyA9IGRvbVV0aWxzLmZpbmRQYXJlbnRzKG5vZGUsdHJ1ZSxmdW5jdGlvbihub2RlKXtyZXR1cm4gIWRvbVV0aWxzLmlzQm9keShub2RlKX0pLA0KICAgICAgICAgICAgICAgICAgICBhZGRycyA9IFtdOw0KICAgICAgICAgICAgICAgIGZvcih2YXIgaSA9IDAsY2k7Y2kgPSBwYXJlbnRzW2krK107KXsNCiAgICAgICAgICAgICAgICAgICAgYWRkcnMucHVzaChkb21VdGlscy5nZXROb2RlSW5kZXgoY2ksaWdub3JlVHh0KSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHZhciBmaXJzdEluZGV4ID0gMDsNCg0KICAgICAgICAgICAgICAgIGlmKGlnbm9yZVR4dCl7DQogICAgICAgICAgICAgICAgICAgIGlmKG5vZGUubm9kZVR5cGUgPT0gMyl7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG1wTm9kZSA9IG5vZGUucHJldmlvdXNTaWJsaW5nOw0KICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUodG1wTm9kZSAmJiB0bXBOb2RlLm5vZGVUeXBlID09IDMpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0SW5kZXggKz0gdG1wTm9kZS5ub2RlVmFsdWUucmVwbGFjZShmaWxsQ2hhclJlZywnJykubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcE5vZGUgPSB0bXBOb2RlLnByZXZpb3VzU2libGluZzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0SW5kZXggKz0gIChpc1N0YXJ0ID8gbWUuc3RhcnRPZmZzZXQgOiBtZS5lbmRPZmZzZXQpLy8gLSAoZmlsbENoYXJSZWcudGVzdChub2RlLm5vZGVWYWx1ZSkgPyAxIDogMCApDQogICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9ICBub2RlLmNoaWxkTm9kZXNbIGlzU3RhcnQgPyBtZS5zdGFydE9mZnNldCA6IG1lLmVuZE9mZnNldF07DQogICAgICAgICAgICAgICAgICAgICAgICBpZihub2RlKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdEluZGV4ID0gZG9tVXRpbHMuZ2V0Tm9kZUluZGV4KG5vZGUsaWdub3JlVHh0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSBpc1N0YXJ0ID8gbWUuc3RhcnRDb250YWluZXIgOiBtZS5lbmRDb250YWluZXI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpcnN0ID0gbm9kZS5maXJzdENoaWxkOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlKGZpcnN0KXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZG9tVXRpbHMuaXNGaWxsQ2hhcihmaXJzdCkpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3QgPSBmaXJzdC5uZXh0U2libGluZzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0SW5kZXgrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZmlyc3Qubm9kZVR5cGUgPT0gMyl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSggZmlyc3QgJiYgZmlyc3Qubm9kZVR5cGUgPT0gMyl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3QgPSBmaXJzdC5uZXh0U2libGluZzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdCA9IGZpcnN0Lm5leHRTaWJsaW5nOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgZmlyc3RJbmRleCA9IGlzU3RhcnQgPyBkb21VdGlscy5pc0ZpbGxDaGFyKG5vZGUpID8gMCA6IG1lLnN0YXJ0T2Zmc2V0ICA6IG1lLmVuZE9mZnNldA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZihmaXJzdEluZGV4IDwgMCl7DQogICAgICAgICAgICAgICAgICAgIGZpcnN0SW5kZXggPSAwOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBhZGRycy5wdXNoKGZpcnN0SW5kZXgpOw0KICAgICAgICAgICAgICAgIHJldHVybiBhZGRyczsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGFkZHIuc3RhcnRBZGRyZXNzID0gZ2V0QWRkcmVzcyh0cnVlKTsNCiAgICAgICAgICAgIGlmKCFpZ25vcmVFbmQpew0KICAgICAgICAgICAgICAgIGFkZHIuZW5kQWRkcmVzcyA9IG1lLmNvbGxhcHNlZCA/IFtdLmNvbmNhdChhZGRyLnN0YXJ0QWRkcmVzcykgOiBnZXRBZGRyZXNzKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gYWRkcjsNCiAgICAgICAgfSwNCiAgICAgICAgbW92ZVRvQWRkcmVzcyA6IGZ1bmN0aW9uKGFkZHIsaWdub3JlRW5kKXsNCiAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7DQogICAgICAgICAgICBmdW5jdGlvbiBnZXROb2RlKGFkZHJlc3MsaXNTdGFydCl7DQogICAgICAgICAgICAgICAgdmFyIHRtcE5vZGUgPSBtZS5kb2N1bWVudC5ib2R5LA0KICAgICAgICAgICAgICAgICAgICBwYXJlbnROb2RlLG9mZnNldDsNCiAgICAgICAgICAgICAgICBmb3IodmFyIGk9IDAsY2ksbD1hZGRyZXNzLmxlbmd0aDtpPGw7aSsrKXsNCiAgICAgICAgICAgICAgICAgICAgY2kgPSBhZGRyZXNzW2ldOw0KICAgICAgICAgICAgICAgICAgICBwYXJlbnROb2RlID0gdG1wTm9kZTsNCiAgICAgICAgICAgICAgICAgICAgdG1wTm9kZSA9IHRtcE5vZGUuY2hpbGROb2Rlc1tjaV07DQogICAgICAgICAgICAgICAgICAgIGlmKCF0bXBOb2RlKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IGNpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYoaXNTdGFydCl7DQogICAgICAgICAgICAgICAgICAgIGlmKHRtcE5vZGUpew0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuc2V0U3RhcnRCZWZvcmUodG1wTm9kZSkNCiAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICBtZS5zZXRTdGFydChwYXJlbnROb2RlLG9mZnNldCkNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICBpZih0bXBOb2RlKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lLnNldEVuZEJlZm9yZSh0bXBOb2RlKQ0KICAgICAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lLnNldEVuZChwYXJlbnROb2RlLG9mZnNldCkNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGdldE5vZGUoYWRkci5zdGFydEFkZHJlc3MsdHJ1ZSk7DQogICAgICAgICAgICAhaWdub3JlRW5kICYmIGFkZHIuZW5kQWRkcmVzcyAmJiAgZ2V0Tm9kZShhZGRyLmVuZEFkZHJlc3MpOw0KICAgICAgICAgICAgcmV0dXJuIG1lOw0KICAgICAgICB9LA0KICAgICAgICBlcXVhbHMgOiBmdW5jdGlvbihybmcpew0KICAgICAgICAgICAgZm9yKHZhciBwIGluIHRoaXMpew0KICAgICAgICAgICAgICAgIGlmKHRoaXMuaGFzT3duUHJvcGVydHkocCkpew0KICAgICAgICAgICAgICAgICAgICBpZih0aGlzW3BdICE9PSBybmdbcF0pDQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2UNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCg0KICAgICAgICB9LA0KICAgICAgICB0cmF2ZXJzYWw6ZnVuY3Rpb24oZG9GbixmaWx0ZXJGbil7DQogICAgICAgICAgICBpZiAodGhpcy5jb2xsYXBzZWQpDQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7DQogICAgICAgICAgICB2YXIgYm9va21hcmsgPSB0aGlzLmNyZWF0ZUJvb2ttYXJrKCksDQogICAgICAgICAgICAgICAgZW5kID0gYm9va21hcmsuZW5kLA0KICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBkb21VdGlscy5nZXROZXh0RG9tTm9kZShib29rbWFyay5zdGFydCwgZmFsc2UsIGZpbHRlckZuKTsNCiAgICAgICAgICAgIHdoaWxlIChjdXJyZW50ICYmIGN1cnJlbnQgIT09IGVuZCAmJiAoZG9tVXRpbHMuZ2V0UG9zaXRpb24oY3VycmVudCwgZW5kKSAmIGRvbVV0aWxzLlBPU0lUSU9OX1BSRUNFRElORykpIHsNCiAgICAgICAgICAgICAgICB2YXIgdG1wTm9kZSA9IGRvbVV0aWxzLmdldE5leHREb21Ob2RlKGN1cnJlbnQsZmFsc2UsZmlsdGVyRm4pOw0KICAgICAgICAgICAgICAgIGRvRm4oY3VycmVudCk7DQogICAgICAgICAgICAgICAgY3VycmVudCA9IHRtcE5vZGU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gdGhpcy5tb3ZlVG9Cb29rbWFyayhib29rbWFyayk7DQogICAgICAgIH0NCiAgICB9Ow0KfSkoKTsKLy8vaW1wb3J0IGVkaXRvci5qcw0KLy8vaW1wb3J0IGNvcmUvYnJvd3Nlci5qcw0KLy8vaW1wb3J0IGNvcmUvZG9tL2RvbS5qcw0KLy8vaW1wb3J0IGNvcmUvZG9tL2R0ZC5qcw0KLy8vaW1wb3J0IGNvcmUvZG9tL2RvbVV0aWxzLmpzDQovLy9pbXBvcnQgY29yZS9kb20vUmFuZ2UuanMNCi8qKg0KICogQGNsYXNzIGJhaWR1LmVkaXRvci5kb20uU2VsZWN0aW9uICAgIFNlbGVjdGlvbuexuw0KICovDQooZnVuY3Rpb24gKCkgew0KDQogICAgZnVuY3Rpb24gZ2V0Qm91bmRhcnlJbmZvcm1hdGlvbiggcmFuZ2UsIHN0YXJ0ICkgew0KICAgICAgICB2YXIgZ2V0SW5kZXggPSBkb21VdGlscy5nZXROb2RlSW5kZXg7DQogICAgICAgIHJhbmdlID0gcmFuZ2UuZHVwbGljYXRlKCk7DQogICAgICAgIHJhbmdlLmNvbGxhcHNlKCBzdGFydCApOw0KICAgICAgICB2YXIgcGFyZW50ID0gcmFuZ2UucGFyZW50RWxlbWVudCgpOw0KICAgICAgICAvL+WmguaenOiKgueCuemHjOayoeacieWtkOiKgueCue+8jOebtOaOpemAgOWHug0KICAgICAgICBpZiAoICFwYXJlbnQuaGFzQ2hpbGROb2RlcygpICkgew0KICAgICAgICAgICAgcmV0dXJuICB7Y29udGFpbmVyOnBhcmVudCwgb2Zmc2V0OjB9Ow0KICAgICAgICB9DQogICAgICAgIHZhciBzaWJsaW5ncyA9IHBhcmVudC5jaGlsZHJlbiwNCiAgICAgICAgICAgIGNoaWxkLA0KICAgICAgICAgICAgdGVzdFJhbmdlID0gcmFuZ2UuZHVwbGljYXRlKCksDQogICAgICAgICAgICBzdGFydEluZGV4ID0gMCwgZW5kSW5kZXggPSBzaWJsaW5ncy5sZW5ndGggLSAxLCBpbmRleCA9IC0xLA0KICAgICAgICAgICAgZGlzdGFuY2U7DQogICAgICAgIHdoaWxlICggc3RhcnRJbmRleCA8PSBlbmRJbmRleCApIHsNCiAgICAgICAgICAgIGluZGV4ID0gTWF0aC5mbG9vciggKHN0YXJ0SW5kZXggKyBlbmRJbmRleCkgLyAyICk7DQogICAgICAgICAgICBjaGlsZCA9IHNpYmxpbmdzW2luZGV4XTsNCiAgICAgICAgICAgIHRlc3RSYW5nZS5tb3ZlVG9FbGVtZW50VGV4dCggY2hpbGQgKTsNCiAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHRlc3RSYW5nZS5jb21wYXJlRW5kUG9pbnRzKCAnU3RhcnRUb1N0YXJ0JywgcmFuZ2UgKTsNCiAgICAgICAgICAgIGlmICggcG9zaXRpb24gPiAwICkgew0KICAgICAgICAgICAgICAgIGVuZEluZGV4ID0gaW5kZXggLSAxOw0KICAgICAgICAgICAgfSBlbHNlIGlmICggcG9zaXRpb24gPCAwICkgew0KICAgICAgICAgICAgICAgIHN0YXJ0SW5kZXggPSBpbmRleCArIDE7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIC8vdHJhY2U6MTA0Mw0KICAgICAgICAgICAgICAgIHJldHVybiAge2NvbnRhaW5lcjpwYXJlbnQsIG9mZnNldDpnZXRJbmRleCggY2hpbGQgKX07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYgKCBpbmRleCA9PSAtMSApIHsNCiAgICAgICAgICAgIHRlc3RSYW5nZS5tb3ZlVG9FbGVtZW50VGV4dCggcGFyZW50ICk7DQogICAgICAgICAgICB0ZXN0UmFuZ2Uuc2V0RW5kUG9pbnQoICdTdGFydFRvU3RhcnQnLCByYW5nZSApOw0KICAgICAgICAgICAgZGlzdGFuY2UgPSB0ZXN0UmFuZ2UudGV4dC5yZXBsYWNlKCAvKFxyXG58XHIpL2csICdcbicgKS5sZW5ndGg7DQogICAgICAgICAgICBzaWJsaW5ncyA9IHBhcmVudC5jaGlsZE5vZGVzOw0KICAgICAgICAgICAgaWYgKCAhZGlzdGFuY2UgKSB7DQogICAgICAgICAgICAgICAgY2hpbGQgPSBzaWJsaW5nc1tzaWJsaW5ncy5sZW5ndGggLSAxXTsNCiAgICAgICAgICAgICAgICByZXR1cm4gIHtjb250YWluZXI6Y2hpbGQsIG9mZnNldDpjaGlsZC5ub2RlVmFsdWUubGVuZ3RofTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdmFyIGkgPSBzaWJsaW5ncy5sZW5ndGg7DQogICAgICAgICAgICB3aGlsZSAoIGRpc3RhbmNlID4gMCApew0KICAgICAgICAgICAgICAgIGRpc3RhbmNlIC09IHNpYmxpbmdzWyAtLWkgXS5ub2RlVmFsdWUubGVuZ3RoOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIHtjb250YWluZXI6c2libGluZ3NbaV0sIG9mZnNldDotZGlzdGFuY2V9Ow0KICAgICAgICB9DQogICAgICAgIHRlc3RSYW5nZS5jb2xsYXBzZSggcG9zaXRpb24gPiAwICk7DQogICAgICAgIHRlc3RSYW5nZS5zZXRFbmRQb2ludCggcG9zaXRpb24gPiAwID8gJ1N0YXJ0VG9TdGFydCcgOiAnRW5kVG9TdGFydCcsIHJhbmdlICk7DQogICAgICAgIGRpc3RhbmNlID0gdGVzdFJhbmdlLnRleHQucmVwbGFjZSggLyhcclxufFxyKS9nLCAnXG4nICkubGVuZ3RoOw0KICAgICAgICBpZiAoICFkaXN0YW5jZSApIHsNCiAgICAgICAgICAgIHJldHVybiAgZHRkLiRlbXB0eVtjaGlsZC50YWdOYW1lXSB8fCBkdGQuJG5vbkNoaWxkW2NoaWxkLnRhZ05hbWVdID8NCiAgICAgICAgICAgIHtjb250YWluZXI6cGFyZW50LCBvZmZzZXQ6Z2V0SW5kZXgoIGNoaWxkICkgKyAocG9zaXRpb24gPiAwID8gMCA6IDEpfSA6DQogICAgICAgICAgICB7Y29udGFpbmVyOmNoaWxkLCBvZmZzZXQ6cG9zaXRpb24gPiAwID8gMCA6IGNoaWxkLmNoaWxkTm9kZXMubGVuZ3RofQ0KICAgICAgICB9DQogICAgICAgIHdoaWxlICggZGlzdGFuY2UgPiAwICkgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICB2YXIgcHJlID0gY2hpbGQ7DQogICAgICAgICAgICAgICAgY2hpbGQgPSBjaGlsZFtwb3NpdGlvbiA+IDAgPyAncHJldmlvdXNTaWJsaW5nJyA6ICduZXh0U2libGluZyddOw0KICAgICAgICAgICAgICAgIGRpc3RhbmNlIC09IGNoaWxkLm5vZGVWYWx1ZS5sZW5ndGg7DQogICAgICAgICAgICB9IGNhdGNoICggZSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4ge2NvbnRhaW5lcjpwYXJlbnQsIG9mZnNldDpnZXRJbmRleCggcHJlICl9Ow0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiAge2NvbnRhaW5lcjpjaGlsZCwgb2Zmc2V0OnBvc2l0aW9uID4gMCA/IC1kaXN0YW5jZSA6IGNoaWxkLm5vZGVWYWx1ZS5sZW5ndGggKyBkaXN0YW5jZX0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDlsIZpZVJhbmdl6L2s5o2i5Li6UmFuZ2Xlr7nosaENCiAgICAgKiBAcGFyYW0ge1JhbmdlfSAgIGllUmFuZ2UgICAgaWVSYW5nZeWvueixoQ0KICAgICAqIEBwYXJhbSB7UmFuZ2V9ICAgcmFuZ2UgICAgICBSYW5nZeWvueixoQ0KICAgICAqIEByZXR1cm4gIHtSYW5nZX0gIHJhbmdlICAgICAgIOi/lOWbnui9rOaNouWQjueahFJhbmdl5a+56LGhDQogICAgICovDQogICAgZnVuY3Rpb24gdHJhbnNmb3JtSUVSYW5nZVRvUmFuZ2UoIGllUmFuZ2UsIHJhbmdlICkgew0KICAgICAgICBpZiAoIGllUmFuZ2UuaXRlbSApIHsNCiAgICAgICAgICAgIHJhbmdlLnNlbGVjdE5vZGUoIGllUmFuZ2UuaXRlbSggMCApICk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB2YXIgYmkgPSBnZXRCb3VuZGFyeUluZm9ybWF0aW9uKCBpZVJhbmdlLCB0cnVlICk7DQogICAgICAgICAgICByYW5nZS5zZXRTdGFydCggYmkuY29udGFpbmVyLCBiaS5vZmZzZXQgKTsNCiAgICAgICAgICAgIGlmICggaWVSYW5nZS5jb21wYXJlRW5kUG9pbnRzKCAnU3RhcnRUb0VuZCcsIGllUmFuZ2UgKSAhPSAwICkgew0KICAgICAgICAgICAgICAgIGJpID0gZ2V0Qm91bmRhcnlJbmZvcm1hdGlvbiggaWVSYW5nZSwgZmFsc2UgKTsNCiAgICAgICAgICAgICAgICByYW5nZS5zZXRFbmQoIGJpLmNvbnRhaW5lciwgYmkub2Zmc2V0ICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHJhbmdlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+W+l2llUmFuZ2UNCiAgICAgKiBAcGFyYW0ge1NlbGVjdGlvbn0gc2VsICAgIFNlbGVjdGlvbuWvueixoQ0KICAgICAqIEByZXR1cm4ge2llUmFuZ2V9ICAgIOW+l+WIsGllUmFuZ2UNCiAgICAgKi8NCiAgICBmdW5jdGlvbiBfZ2V0SUVSYW5nZSggc2VsICkgew0KICAgICAgICB2YXIgaWVSYW5nZTsNCiAgICAgICAgLy9pZeS4i+acieWPr+iDveaKpemUmQ0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgaWVSYW5nZSA9IHNlbC5nZXROYXRpdmUoKS5jcmVhdGVSYW5nZSgpOw0KICAgICAgICB9IGNhdGNoICggZSApIHsNCiAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICB9DQogICAgICAgIHZhciBlbCA9IGllUmFuZ2UuaXRlbSA/IGllUmFuZ2UuaXRlbSggMCApIDogaWVSYW5nZS5wYXJlbnRFbGVtZW50KCk7DQogICAgICAgIGlmICggKCBlbC5vd25lckRvY3VtZW50IHx8IGVsICkgPT09IHNlbC5kb2N1bWVudCApIHsNCiAgICAgICAgICAgIHJldHVybiBpZVJhbmdlOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBudWxsOw0KICAgIH0NCg0KICAgIHZhciBTZWxlY3Rpb24gPSBkb20uU2VsZWN0aW9uID0gZnVuY3Rpb24gKCBkb2MgKSB7DQogICAgICAgIHZhciBtZSA9IHRoaXMsIGlmcmFtZTsNCiAgICAgICAgbWUuZG9jdW1lbnQgPSBkb2M7DQogICAgICAgIGlmICggaWUgKSB7DQogICAgICAgICAgICBpZnJhbWUgPSBkb21VdGlscy5nZXRXaW5kb3coIGRvYyApLmZyYW1lRWxlbWVudDsNCiAgICAgICAgICAgIGRvbVV0aWxzLm9uKCBpZnJhbWUsICdiZWZvcmVkZWFjdGl2YXRlJywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIG1lLl9iYWtJRVJhbmdlID0gbWUuZ2V0SUVSYW5nZSgpOw0KICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgZG9tVXRpbHMub24oIGlmcmFtZSwgJ2FjdGl2YXRlJywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggIV9nZXRJRVJhbmdlKCBtZSApICYmIG1lLl9iYWtJRVJhbmdlICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuX2Jha0lFUmFuZ2Uuc2VsZWN0KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGNhdGNoICggZXggKSB7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIG1lLl9iYWtJRVJhbmdlID0gbnVsbDsNCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfQ0KICAgICAgICBpZnJhbWUgPSBkb2MgPSBudWxsOw0KICAgIH07DQoNCiAgICBTZWxlY3Rpb24ucHJvdG90eXBlID0gew0KICAgICAgICAvKioNCiAgICAgICAgICog6I635Y+W5Y6f55Sfc2VsZWNpdG9u5a+56LGhDQogICAgICAgICAqIEBwdWJsaWMNCiAgICAgICAgICogQGZ1bmN0aW9uDQogICAgICAgICAqIEBuYW1lICAgIGJhaWR1LmVkaXRvci5kb20uU2VsZWN0aW9uLmdldE5hdGl2ZQ0KICAgICAgICAgKiBAcmV0dXJuIHtTZWxlY3Rpb259ICAgIOiOt+W+l3NlbGVjdGlvbuWvueixoQ0KICAgICAgICAgKi8NCiAgICAgICAgZ2V0TmF0aXZlOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBkb2MgPSB0aGlzLmRvY3VtZW50Ow0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICByZXR1cm4gIWRvYyA/IG51bGwgOiBpZSAmJiBicm93c2VyLmllIDwgOSA/IGRvYy5zZWxlY3Rpb24gOiBkb21VdGlscy5nZXRXaW5kb3coIGRvYyApLmdldFNlbGVjdGlvbigpOw0KICAgICAgICAgICAgfSBjYXRjaCAoIGUgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDojrflvpdpZVJhbmdlDQogICAgICAgICAqIEBwdWJsaWMNCiAgICAgICAgICogQGZ1bmN0aW9uDQogICAgICAgICAqIEBuYW1lICAgIGJhaWR1LmVkaXRvci5kb20uU2VsZWN0aW9uLmdldElFUmFuZ2UNCiAgICAgICAgICogQHJldHVybiB7aWVSYW5nZX0gICAg6L+U5ZueaWXljp/nlJ/nmoRSYW5nZQ0KICAgICAgICAgKi8NCiAgICAgICAgZ2V0SUVSYW5nZTpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgaWVSYW5nZSA9IF9nZXRJRVJhbmdlKCB0aGlzICk7DQogICAgICAgICAgICBpZiAoICFpZVJhbmdlICkgew0KICAgICAgICAgICAgICAgIGlmICggdGhpcy5fYmFrSUVSYW5nZSApIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Jha0lFUmFuZ2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGllUmFuZ2U7DQogICAgICAgIH0sDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIOe8k+WtmOW9k+WJjemAieWMuueahHJhbmdl5ZKM6YCJ5Yy655qE5byA5aeL6IqC54K5DQogICAgICAgICAqIEBwdWJsaWMNCiAgICAgICAgICogQGZ1bmN0aW9uDQogICAgICAgICAqIEBuYW1lICAgIGJhaWR1LmVkaXRvci5kb20uU2VsZWN0aW9uLmNhY2hlDQogICAgICAgICAqLw0KICAgICAgICBjYWNoZTpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB0aGlzLmNsZWFyKCk7DQogICAgICAgICAgICB0aGlzLl9jYWNoZWRSYW5nZSA9IHRoaXMuZ2V0UmFuZ2UoKTsNCiAgICAgICAgICAgIHRoaXMuX2NhY2hlZFN0YXJ0RWxlbWVudCA9IHRoaXMuZ2V0U3RhcnQoKTsNCiAgICAgICAgICAgIHRoaXMuX2NhY2hlZFN0YXJ0RWxlbWVudFBhdGggPSB0aGlzLmdldFN0YXJ0RWxlbWVudFBhdGgoKTsNCiAgICAgICAgfSwNCg0KICAgICAgICBnZXRTdGFydEVsZW1lbnRQYXRoOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIGlmICggdGhpcy5fY2FjaGVkU3RhcnRFbGVtZW50UGF0aCApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2FjaGVkU3RhcnRFbGVtZW50UGF0aDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZhciBzdGFydCA9IHRoaXMuZ2V0U3RhcnQoKTsNCiAgICAgICAgICAgIGlmICggc3RhcnQgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGRvbVV0aWxzLmZpbmRQYXJlbnRzKCBzdGFydCwgdHJ1ZSwgbnVsbCwgdHJ1ZSApDQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gW107DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDmuIXnqbrnvJPlrZgNCiAgICAgICAgICogQHB1YmxpYw0KICAgICAgICAgKiBAZnVuY3Rpb24NCiAgICAgICAgICogQG5hbWUgICAgYmFpZHUuZWRpdG9yLmRvbS5TZWxlY3Rpb24uY2xlYXINCiAgICAgICAgICovDQogICAgICAgIGNsZWFyOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHRoaXMuX2NhY2hlZFN0YXJ0RWxlbWVudFBhdGggPSB0aGlzLl9jYWNoZWRSYW5nZSA9IHRoaXMuX2NhY2hlZFN0YXJ0RWxlbWVudCA9IG51bGw7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDnvJbovpHlmajmmK/lkKblvpfliLDkuobpgInljLoNCiAgICAgICAgICovDQogICAgICAgIGlzRm9jdXM6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICByZXR1cm4gYnJvd3Nlci5pZSAmJiBfZ2V0SUVSYW5nZSggdGhpcyApIHx8ICFicm93c2VyLmllICYmIHRoaXMuZ2V0TmF0aXZlKCkucmFuZ2VDb3VudCA/IHRydWUgOiBmYWxzZTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKCBlICkgew0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9LA0KICAgICAgICAvKioNCiAgICAgICAgICog6I635Y+W6YCJ5Yy65a+55bqU55qEUmFuZ2UNCiAgICAgICAgICogQHB1YmxpYw0KICAgICAgICAgKiBAZnVuY3Rpb24NCiAgICAgICAgICogQG5hbWUgICAgYmFpZHUuZWRpdG9yLmRvbS5TZWxlY3Rpb24uZ2V0UmFuZ2UNCiAgICAgICAgICogQHJldHVybnMge2JhaWR1LmVkaXRvci5kb20uUmFuZ2V9ICAgIOW+l+WIsFJhbmdl5a+56LGhDQogICAgICAgICAqLw0KICAgICAgICBnZXRSYW5nZTpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzOw0KICAgICAgICAgICAgZnVuY3Rpb24gb3B0aW16ZSggcmFuZ2UgKSB7DQogICAgICAgICAgICAgICAgdmFyIGNoaWxkID0gbWUuZG9jdW1lbnQuYm9keS5maXJzdENoaWxkLA0KICAgICAgICAgICAgICAgICAgICBjb2xsYXBzZWQgPSByYW5nZS5jb2xsYXBzZWQ7DQogICAgICAgICAgICAgICAgd2hpbGUgKCBjaGlsZCAmJiBjaGlsZC5maXJzdENoaWxkICkgew0KICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydCggY2hpbGQsIDAgKTsNCiAgICAgICAgICAgICAgICAgICAgY2hpbGQgPSBjaGlsZC5maXJzdENoaWxkOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoICFyYW5nZS5zdGFydENvbnRhaW5lciApIHsNCiAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQoIG1lLmRvY3VtZW50LmJvZHksIDAgKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoIGNvbGxhcHNlZCApIHsNCiAgICAgICAgICAgICAgICAgICAgcmFuZ2UuY29sbGFwc2UoIHRydWUgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggbWUuX2NhY2hlZFJhbmdlICE9IG51bGwgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NhY2hlZFJhbmdlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdmFyIHJhbmdlID0gbmV3IGJhaWR1LmVkaXRvci5kb20uUmFuZ2UoIG1lLmRvY3VtZW50ICk7DQogICAgICAgICAgICBpZiAoIGllICYmIGJyb3dzZXIuaWUgPCA5ICkgew0KICAgICAgICAgICAgICAgIHZhciBuYXRpdmVSYW5nZSA9IG1lLmdldElFUmFuZ2UoKTsNCiAgICAgICAgICAgICAgICBpZiAoIG5hdGl2ZVJhbmdlICkgew0KICAgICAgICAgICAgICAgICAgICAvL+Wkh+S7veeahF9iYWtJRVJhbmdl5Y+v6IO95bey57uP5a6e5pWI5LqG77yMZG9t5qCR5Y+R55Sf5LqG5Y+Y5YyW5q+U5aaC5LuO5rqQ56CB5qih5byP5YiH5Zue5p2l77yM5omA5LuldHJ55LiA5LiL77yM5a6e5pWI5bCx5pS+5YiwYm9keeW8gOWni+S9jee9rg0KICAgICAgICAgICAgICAgICAgICB0cnl7DQogICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2Zvcm1JRVJhbmdlVG9SYW5nZSggbmF0aXZlUmFuZ2UsIHJhbmdlICk7DQogICAgICAgICAgICAgICAgICAgIH1jYXRjaChlKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGltemUoIHJhbmdlICk7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIG9wdGltemUoIHJhbmdlICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB2YXIgc2VsID0gbWUuZ2V0TmF0aXZlKCk7DQogICAgICAgICAgICAgICAgaWYgKCBzZWwgJiYgc2VsLnJhbmdlQ291bnQgKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBmaXJzdFJhbmdlID0gc2VsLmdldFJhbmdlQXQoIDAgKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGxhc3RSYW5nZSA9IHNlbC5nZXRSYW5nZUF0KCBzZWwucmFuZ2VDb3VudCAtIDEgKTsNCiAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQoIGZpcnN0UmFuZ2Uuc3RhcnRDb250YWluZXIsIGZpcnN0UmFuZ2Uuc3RhcnRPZmZzZXQgKS5zZXRFbmQoIGxhc3RSYW5nZS5lbmRDb250YWluZXIsIGxhc3RSYW5nZS5lbmRPZmZzZXQgKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCByYW5nZS5jb2xsYXBzZWQgJiYgZG9tVXRpbHMuaXNCb2R5KCByYW5nZS5zdGFydENvbnRhaW5lciApICYmICFyYW5nZS5zdGFydE9mZnNldCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGltemUoIHJhbmdlICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAvL3RyYWNlOjE3MzQg5pyJ5Y+v6IO95bey57uP5LiN5ZyoZG9t5qCR5LiK5LqG77yM5qCH6K+G55qE6IqC54K5DQogICAgICAgICAgICAgICAgICAgIGlmICggdGhpcy5fYmFrUmFuZ2UgJiYgZG9tVXRpbHMuaW5Eb2MoIHRoaXMuX2Jha1JhbmdlLnN0YXJ0Q29udGFpbmVyLCB0aGlzLmRvY3VtZW50ICkgKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYWtSYW5nZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBvcHRpbXplKCByYW5nZSApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYWtSYW5nZSA9IHJhbmdlOw0KICAgICAgICB9LA0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiDojrflj5blvIDlp4vlhYPntKDvvIznlKjkuo7nirbmgIHlj43lsIQNCiAgICAgICAgICogQHB1YmxpYw0KICAgICAgICAgKiBAZnVuY3Rpb24NCiAgICAgICAgICogQG5hbWUgICAgYmFpZHUuZWRpdG9yLmRvbS5TZWxlY3Rpb24uZ2V0U3RhcnQNCiAgICAgICAgICogQHJldHVybiB7RWxlbWVudH0gICAgIOiOt+W+l+W8gOWni+WFg+e0oA0KICAgICAgICAgKi8NCiAgICAgICAgZ2V0U3RhcnQ6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgaWYgKCB0aGlzLl9jYWNoZWRTdGFydEVsZW1lbnQgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NhY2hlZFN0YXJ0RWxlbWVudDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZhciByYW5nZSA9IGllID8gdGhpcy5nZXRJRVJhbmdlKCkgOiB0aGlzLmdldFJhbmdlKCksDQogICAgICAgICAgICAgICAgdG1wUmFuZ2UsDQogICAgICAgICAgICAgICAgc3RhcnQsIHRtcCwgcGFyZW50Ow0KICAgICAgICAgICAgaWYgKCBpZSApIHsNCiAgICAgICAgICAgICAgICBpZiAoICFyYW5nZSApIHsNCiAgICAgICAgICAgICAgICAgICAgLy90b2RvIOe7meesrOS4gOS4quWAvOWPr+iDveS8muaciemXrumimA0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kb2N1bWVudC5ib2R5LmZpcnN0Q2hpbGQ7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8vY29udHJvbOWFg+e0oA0KICAgICAgICAgICAgICAgIGlmICggcmFuZ2UuaXRlbSApew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmFuZ2UuaXRlbSggMCApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0bXBSYW5nZSA9IHJhbmdlLmR1cGxpY2F0ZSgpOw0KICAgICAgICAgICAgICAgIC8v5L+u5q2jaWXkuIs8Yj54PC9iPlt4eF0g6Zet5ZCI5ZCOIDxiPnh8PC9iPnh4DQogICAgICAgICAgICAgICAgdG1wUmFuZ2UudGV4dC5sZW5ndGggPiAwICYmIHRtcFJhbmdlLm1vdmVTdGFydCggJ2NoYXJhY3RlcicsIDEgKTsNCiAgICAgICAgICAgICAgICB0bXBSYW5nZS5jb2xsYXBzZSggMSApOw0KICAgICAgICAgICAgICAgIHN0YXJ0ID0gdG1wUmFuZ2UucGFyZW50RWxlbWVudCgpOw0KICAgICAgICAgICAgICAgIHBhcmVudCA9IHRtcCA9IHJhbmdlLnBhcmVudEVsZW1lbnQoKTsNCiAgICAgICAgICAgICAgICB3aGlsZSAoIHRtcCA9IHRtcC5wYXJlbnROb2RlICkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIHRtcCA9PSBzdGFydCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gcGFyZW50Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHJhbmdlLnNocmlua0JvdW5kYXJ5KCk7DQogICAgICAgICAgICAgICAgc3RhcnQgPSByYW5nZS5zdGFydENvbnRhaW5lcjsNCiAgICAgICAgICAgICAgICBpZiAoIHN0YXJ0Lm5vZGVUeXBlID09IDEgJiYgc3RhcnQuaGFzQ2hpbGROb2RlcygpICl7DQogICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gc3RhcnQuY2hpbGROb2Rlc1tNYXRoLm1pbiggc3RhcnQuY2hpbGROb2Rlcy5sZW5ndGggLSAxLCByYW5nZS5zdGFydE9mZnNldCApXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKCBzdGFydC5ub2RlVHlwZSA9PSAzICl7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBzdGFydC5wYXJlbnROb2RlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBzdGFydDsNCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIOW+l+WIsOmAieWMuuS4reeahOaWh+acrA0KICAgICAgICAgKiBAcHVibGljDQogICAgICAgICAqIEBmdW5jdGlvbg0KICAgICAgICAgKiBAbmFtZSAgICBiYWlkdS5lZGl0b3IuZG9tLlNlbGVjdGlvbi5nZXRUZXh0DQogICAgICAgICAqIEByZXR1cm4gIHtTdHJpbmd9ICAgIOmAieWMuuS4reWMheWQq+eahOaWh+acrA0KICAgICAgICAgKi8NCiAgICAgICAgZ2V0VGV4dDpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgbmF0aXZlU2VsLCBuYXRpdmVSYW5nZTsNCiAgICAgICAgICAgIGlmICggdGhpcy5pc0ZvY3VzKCkgJiYgKG5hdGl2ZVNlbCA9IHRoaXMuZ2V0TmF0aXZlKCkpICkgew0KICAgICAgICAgICAgICAgIG5hdGl2ZVJhbmdlID0gYnJvd3Nlci5pZSA/IG5hdGl2ZVNlbC5jcmVhdGVSYW5nZSgpIDogbmF0aXZlU2VsLmdldFJhbmdlQXQoIDAgKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gYnJvd3Nlci5pZSA/IG5hdGl2ZVJhbmdlLnRleHQgOiBuYXRpdmVSYW5nZS50b1N0cmluZygpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICB9LA0KICAgICAgICBjbGVhclJhbmdlIDogZnVuY3Rpb24oKXsNCiAgICAgICAgICAgIHRoaXMuZ2V0TmF0aXZlKClbYnJvd3Nlci5pZSA/ICdlbXB0eScgOiAncmVtb3ZlQWxsUmFuZ2VzJ10oKTsNCiAgICAgICAgfQ0KICAgIH07DQp9KSgpOwovKioNCiAqIEBmaWxlDQogKiBAbmFtZSBVRS5FZGl0b3INCiAqIEBzaG9ydCBFZGl0b3INCiAqIEBpbXBvcnQgZWRpdG9yLmpzLGNvcmUvdXRpbHMuanMsY29yZS9FdmVudEJhc2UuanMsY29yZS9icm93c2VyLmpzLGNvcmUvZG9tL2R0ZC5qcyxjb3JlL2RvbS9kb21VdGlscy5qcyxjb3JlL2RvbS9SYW5nZS5qcyxjb3JlL2RvbS9TZWxlY3Rpb24uanMscGx1Z2lucy9zZXJpYWxpemUuanMNCiAqIEBkZXNjIOe8lui+keWZqOS4u+exu++8jOWMheWQq+e8lui+keWZqOaPkOS+m+eahOWkp+mDqOWIhuWFrOeUqOaOpeWPow0KICovDQooZnVuY3Rpb24gKCkgew0KICAgIHZhciB1aWQgPSAwLCBfc2VsZWN0aW9uQ2hhbmdlVGltZXI7DQoNCiAgICAvKioNCiAgICAgKiBAcHJpdmF0ZQ0KICAgICAqIEBpZ25vcmUNCiAgICAgKiBAcGFyYW0gZm9ybSAg57yW6L6R5Zmo5omA5Zyo55qEZm9ybeWFg+e0oA0KICAgICAqIEBwYXJhbSBlZGl0b3IgIOe8lui+keWZqOWunuS+i+WvueixoQ0KICAgICAqLw0KICAgIGZ1bmN0aW9uIHNldFZhbHVlKGZvcm0sIGVkaXRvcikgew0KICAgICAgICB2YXIgdGV4dGFyZWE7DQogICAgICAgIGlmIChlZGl0b3IudGV4dGFyZWEpIHsNCiAgICAgICAgICAgIGlmICh1dGlscy5pc1N0cmluZyhlZGl0b3IudGV4dGFyZWEpKSB7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIHRpLCB0aXMgPSBkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZShmb3JtLCAndGV4dGFyZWEnKTsgdGkgPSB0aXNbaSsrXTspIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHRpLmlkID09ICd1ZWRpdG9yX3RleHRhcmVhXycgKyBlZGl0b3Iub3B0aW9ucy50ZXh0YXJlYSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGV4dGFyZWEgPSB0aTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0ZXh0YXJlYSA9IGVkaXRvci50ZXh0YXJlYTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoIXRleHRhcmVhKSB7DQogICAgICAgICAgICBmb3JtLmFwcGVuZENoaWxkKHRleHRhcmVhID0gZG9tVXRpbHMuY3JlYXRlRWxlbWVudChkb2N1bWVudCwgJ3RleHRhcmVhJywgew0KICAgICAgICAgICAgICAgICduYW1lJzogZWRpdG9yLm9wdGlvbnMudGV4dGFyZWEsDQogICAgICAgICAgICAgICAgJ2lkJzogJ3VlZGl0b3JfdGV4dGFyZWFfJyArIGVkaXRvci5vcHRpb25zLnRleHRhcmVhLA0KICAgICAgICAgICAgICAgICdzdHlsZSc6ICJkaXNwbGF5Om5vbmUiDQogICAgICAgICAgICB9KSk7DQogICAgICAgICAgICAvL+S4jeimgeS6p+eUn+WkmuS4qnRleHRhcmVhDQogICAgICAgICAgICBlZGl0b3IudGV4dGFyZWEgPSB0ZXh0YXJlYTsNCiAgICAgICAgfQ0KICAgICAgICB0ZXh0YXJlYS52YWx1ZSA9IGVkaXRvci5oYXNDb250ZW50cygpID8NCiAgICAgICAgICAgIChlZGl0b3Iub3B0aW9ucy5hbGxIdG1sRW5hYmxlZCA/IGVkaXRvci5nZXRBbGxIdG1sKCkgOiBlZGl0b3IuZ2V0Q29udGVudChudWxsLCBudWxsLCB0cnVlKSkgOg0KICAgICAgICAgICAgJycNCiAgICB9DQogICAgZnVuY3Rpb24gbG9hZFBsdWdpbnMobWUpew0KICAgICAgICAvL+WIneWni+WMluaPkuS7tg0KICAgICAgICBmb3IgKHZhciBwaSBpbiBVRS5wbHVnaW5zKSB7DQogICAgICAgICAgICBVRS5wbHVnaW5zW3BpXS5jYWxsKG1lKTsNCiAgICAgICAgfQ0KICAgICAgICBtZS5sYW5nSXNSZWFkeSA9IHRydWU7DQoNCiAgICAgICAgbWUuZmlyZUV2ZW50KCJsYW5nUmVhZHkiKTsNCiAgICB9DQogICAgZnVuY3Rpb24gY2hlY2tDdXJMYW5nKEkxOE4pew0KICAgICAgICBmb3IodmFyIGxhbmcgaW4gSTE4Til7DQogICAgICAgICAgICByZXR1cm4gbGFuZw0KICAgICAgICB9DQogICAgfQ0KICAgIC8qKg0KICAgICAqIFVFZGl0b3LnvJbovpHlmajnsbsNCiAgICAgKiBAbmFtZSBFZGl0b3INCiAgICAgKiBAZGVzYyDliJvlu7rkuIDkuKrot5/nvJbovpHlmajlrp7kvosNCiAgICAgKiAtICoqKmNvbnRhaW5lcioqKiDnvJbovpHlmajlrrnlmajlr7nosaENCiAgICAgKiAtICoqKmlmcmFtZSoqKiDnvJbovpHljLrln5/miYDlnKjnmoRpZnJhbWXlr7nosaENCiAgICAgKiAtICoqKndpbmRvdyoqKiDnvJbovpHljLrln5/miYDlnKjnmoR3aW5kb3cNCiAgICAgKiAtICoqKmRvY3VtZW50KioqIOe8lui+keWMuuWfn+aJgOWcqOeahGRvY3VtZW505a+56LGhDQogICAgICogLSAqKipib2R5KioqIOe8lui+keWMuuWfn+aJgOWcqOeahGJvZHnlr7nosaENCiAgICAgKiAtICoqKnNlbGVjdGlvbioqKiDnvJbovpHljLrln5/nmoTpgInljLrlr7nosaENCiAgICAgKi8NCiAgICB2YXIgRWRpdG9yID0gVUUuRWRpdG9yID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsNCiAgICAgICAgdmFyIG1lID0gdGhpczsNCiAgICAgICAgbWUudWlkID0gdWlkKys7DQogICAgICAgIEV2ZW50QmFzZS5jYWxsKG1lKTsNCiAgICAgICAgbWUuY29tbWFuZHMgPSB7fTsNCiAgICAgICAgbWUub3B0aW9ucyA9IHV0aWxzLmV4dGVuZCh1dGlscy5jbG9uZShvcHRpb25zIHx8IHt9KSwgVUVESVRPUl9DT05GSUcsIHRydWUpOw0KICAgICAgICBtZS5zaG9ydGN1dGtleXMgPSB7fTsNCiAgICAgICAgbWUuaW5wdXRSdWxlcyA9IFtdOw0KICAgICAgICBtZS5vdXRwdXRSdWxlcyA9IFtdOw0KICAgICAgICAvL+iuvue9rum7mOiupOeahOW4uOeUqOWxnuaApw0KICAgICAgICBtZS5zZXRPcHQoew0KICAgICAgICAgICAgaXNTaG93OiB0cnVlLA0KICAgICAgICAgICAgaW5pdGlhbENvbnRlbnQ6ICcnLA0KICAgICAgICAgICAgaW5pdGlhbFN0eWxlOicnLA0KICAgICAgICAgICAgYXV0b0NsZWFyaW5pdGlhbENvbnRlbnQ6IGZhbHNlLA0KICAgICAgICAgICAgaWZyYW1lQ3NzVXJsOiBtZS5vcHRpb25zLlVFRElUT1JfSE9NRV9VUkwgKyAndGhlbWVzL2lmcmFtZS5jc3MnLA0KICAgICAgICAgICAgdGV4dGFyZWE6ICdlZGl0b3JWYWx1ZScsDQogICAgICAgICAgICBmb2N1czogZmFsc2UsDQogICAgICAgICAgICBmb2N1c0luRW5kOiB0cnVlLA0KICAgICAgICAgICAgYXV0b0NsZWFyRW1wdHlOb2RlOiB0cnVlLA0KICAgICAgICAgICAgZnVsbHNjcmVlbjogZmFsc2UsDQogICAgICAgICAgICByZWFkb25seTogZmFsc2UsDQogICAgICAgICAgICB6SW5kZXg6IDk5OSwNCiAgICAgICAgICAgIGltYWdlUG9wdXA6IHRydWUsDQogICAgICAgICAgICBlbnRlclRhZzogJ3AnLA0KICAgICAgICAgICAgY3VzdG9tRG9tYWluOiBmYWxzZSwNCiAgICAgICAgICAgIGxhbmc6ICd6aC1jbicsDQogICAgICAgICAgICBsYW5nUGF0aDogbWUub3B0aW9ucy5VRURJVE9SX0hPTUVfVVJMICsgJ2xhbmcvJywNCiAgICAgICAgICAgIHRoZW1lOiAnZGVmYXVsdCcsDQogICAgICAgICAgICB0aGVtZVBhdGg6IG1lLm9wdGlvbnMuVUVESVRPUl9IT01FX1VSTCArICd0aGVtZXMvJywNCiAgICAgICAgICAgIGFsbEh0bWxFbmFibGVkOiBmYWxzZSwNCiAgICAgICAgICAgIHNjYWxlRW5hYmxlZDogZmFsc2UsDQogICAgICAgICAgICB0YWJsZU5hdGl2ZUVkaXRJbkZGOiBmYWxzZSwNCiAgICAgICAgICAgIGF1dG9TeW5jRGF0YSA6IHRydWUNCiAgICAgICAgfSk7DQoNCiAgICAgICAgaWYoIXV0aWxzLmlzRW1wdHlPYmplY3QoVUUuSTE4Tikpew0KICAgICAgICAgICAgLy/kv67mlLnpu5jorqTnmoTor63oqIDnsbvlnosNCiAgICAgICAgICAgIG1lLm9wdGlvbnMubGFuZyA9IGNoZWNrQ3VyTGFuZyhVRS5JMThOKTsNCiAgICAgICAgICAgIGxvYWRQbHVnaW5zKG1lKQ0KICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgIHV0aWxzLmxvYWRGaWxlKGRvY3VtZW50LCB7DQogICAgICAgICAgICAgICAgc3JjOiBtZS5vcHRpb25zLmxhbmdQYXRoICsgbWUub3B0aW9ucy5sYW5nICsgIi8iICsgbWUub3B0aW9ucy5sYW5nICsgIi5qcyIsDQogICAgICAgICAgICAgICAgdGFnOiAic2NyaXB0IiwNCiAgICAgICAgICAgICAgICB0eXBlOiAidGV4dC9qYXZhc2NyaXB0IiwNCiAgICAgICAgICAgICAgICBkZWZlcjogImRlZmVyIg0KICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIGxvYWRQbHVnaW5zKG1lKQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCg0KICAgICAgICBVRS5pbnN0YW50c1sndWVkaXRvckluc3RhbnQnICsgbWUudWlkXSA9IG1lOw0KICAgIH07DQogICAgRWRpdG9yLnByb3RvdHlwZSA9IHsNCiAgICAgICAgLyoqDQogICAgICAgICAqIOW9k+e8lui+keWZqHJlYWR55ZCO5omn6KGM5Lyg5YWl55qEZm4s5aaC5p6c57yW6L6R5Zmo5bey57uP5a6M5oiQcmVhZHnvvIzlsLHpqazkuIrmiafooYxmbu+8jGZu55qE5Lit55qEdGhpc+aYr+e8lui+keWZqOWunuS+i+OAgg0KICAgICAgICAgKiDlpKfpg6jliIbnmoTlrp7kvovmjqXlj6Ppg73pnIDopoHmlL7lnKjor6Xmlrnms5XlhoXpg6jmiafooYzvvIzlkKbliJnlnKhJReS4i+WPr+iDveS8muaKpemUmeOAgg0KICAgICAgICAgKiBAbmFtZSByZWFkeQ0KICAgICAgICAgKiBAZ3JhbW1hciBlZGl0b3IucmVhZHkoZm4pIGZu5piv5b2T57yW6L6R5Zmo5riy5p+T5aW95ZCO5omn6KGM55qEZnVuY3Rpb24NCiAgICAgICAgICogQGV4YW1wbGUNCiAgICAgICAgICogdmFyIGVkaXRvciA9IG5ldyBVRS51aS5FZGl0b3IoKTsNCiAgICAgICAgICogZWRpdG9yLnJlbmRlcigibXlFZGl0b3IiKTsNCiAgICAgICAgICogZWRpdG9yLnJlYWR5KGZ1bmN0aW9uKCl7DQogICAgICAgICAqICAgICBlZGl0b3Iuc2V0Q29udGVudCgi5qyi6L+O5L2/55SoVUVkaXRvcu+8gSIpOw0KICAgICAgICAgKiB9KQ0KICAgICAgICAgKi8NCiAgICAgICAgcmVhZHk6IGZ1bmN0aW9uIChmbikgew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpczsNCiAgICAgICAgICAgIGlmIChmbikgew0KICAgICAgICAgICAgICAgIG1lLmlzUmVhZHkgPyBmbi5hcHBseShtZSkgOiBtZS5hZGRMaXN0ZW5lcigncmVhZHknLCBmbik7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDkuLrnvJbovpHlmajorr7nva7pu5jorqTlj4LmlbDlgLzjgILoi6XnlKjmiLfphY3nva7kuLrnqbrvvIzliJnku6Xpu5jorqTphY3nva7kuLrlh4YNCiAgICAgICAgICogQGdyYW1tYXIgZWRpdG9yLnNldE9wdChrZXksdmFsdWUpOyAgICAgIC8v5Lyg5YWl5LiA5Liq6ZSu44CB5YC85a+5DQogICAgICAgICAqIEBncmFtbWFyIGVkaXRvci5zZXRPcHQoeyBrZXk6dmFsdWV9KTsgICAvL+S8oOWFpeS4gOS4qmpzb27lr7nosaENCiAgICAgICAgICovDQogICAgICAgIHNldE9wdDogZnVuY3Rpb24gKGtleSwgdmFsKSB7DQogICAgICAgICAgICB2YXIgb2JqID0ge307DQogICAgICAgICAgICBpZiAodXRpbHMuaXNTdHJpbmcoa2V5KSkgew0KICAgICAgICAgICAgICAgIG9ialtrZXldID0gdmFsDQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIG9iaiA9IGtleTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHV0aWxzLmV4dGVuZCh0aGlzLm9wdGlvbnMsIG9iaiwgdHJ1ZSk7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDplIDmr4HnvJbovpHlmajlrp7kvovlr7nosaENCiAgICAgICAgICogQG5hbWUgZGVzdHJveQ0KICAgICAgICAgKiBAZ3JhbW1hciBlZGl0b3IuZGVzdHJveSgpOw0KICAgICAgICAgKi8NCiAgICAgICAgZGVzdHJveTogZnVuY3Rpb24gKCkgew0KDQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzOw0KICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCdkZXN0cm95Jyk7DQogICAgICAgICAgICB2YXIgY29udGFpbmVyID0gbWUuY29udGFpbmVyLnBhcmVudE5vZGU7DQogICAgICAgICAgICB2YXIgdGV4dGFyZWEgPSBtZS50ZXh0YXJlYTsNCiAgICAgICAgICAgIGlmICghdGV4dGFyZWEpIHsNCiAgICAgICAgICAgICAgICB0ZXh0YXJlYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJyk7DQogICAgICAgICAgICAgICAgY29udGFpbmVyLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHRleHRhcmVhLCBjb250YWluZXIpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0ZXh0YXJlYS5zdHlsZS5kaXNwbGF5ID0gJycNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGV4dGFyZWEuc3R5bGUud2lkdGggPSBtZS5pZnJhbWUub2Zmc2V0V2lkdGggKyAncHgnOw0KICAgICAgICAgICAgdGV4dGFyZWEuc3R5bGUuaGVpZ2h0ID0gbWUuaWZyYW1lLm9mZnNldEhlaWdodCArICdweCc7DQogICAgICAgICAgICB0ZXh0YXJlYS52YWx1ZSA9IG1lLmdldENvbnRlbnQoKTsNCiAgICAgICAgICAgIHRleHRhcmVhLmlkID0gbWUua2V5Ow0KICAgICAgICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9ICcnOw0KICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKGNvbnRhaW5lcik7DQogICAgICAgICAgICB2YXIga2V5ID0gbWUua2V5Ow0KICAgICAgICAgICAgLy90cmFjZToyMDA0DQogICAgICAgICAgICBmb3IgKHZhciBwIGluIG1lKSB7DQogICAgICAgICAgICAgICAgaWYgKG1lLmhhc093blByb3BlcnR5KHApKSB7DQogICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW3BdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIFVFLmRlbEVkaXRvcihrZXkpOw0KICAgICAgICB9LA0KICAgICAgICAvKioNCiAgICAgICAgICog5riy5p+T57yW6L6R5Zmo55qERE9N5Yiw5oyH5a6a5a655Zmo77yM5b+F6aG75LiU5Y+q6IO96LCD55So5LiA5qyhDQogICAgICAgICAqIEBuYW1lIHJlbmRlcg0KICAgICAgICAgKiBAZ3JhbW1hciBlZGl0b3IucmVuZGVyKGNvbnRhaW5lcklkKTsgICAgLy/lj6/ku6XmjIflrprkuIDkuKrlrrnlmahJRA0KICAgICAgICAgKiBAZ3JhbW1hciBlZGl0b3IucmVuZGVyKGNvbnRhaW5lckRvbSk7ICAgLy/kuZ/lj6/ku6Xnm7TmjqXmjIflrprlrrnlmajlr7nosaENCiAgICAgICAgICovDQogICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGNvbnRhaW5lcikgew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpcywNCiAgICAgICAgICAgICAgICBvcHRpb25zID0gbWUub3B0aW9ucywNCiAgICAgICAgICAgICAgICBnZXRTdHlsZVZhbHVlPWZ1bmN0aW9uKGF0dHIpew0KICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUludChkb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKGNvbnRhaW5lcixhdHRyKSk7DQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIGlmICh1dGlscy5pc1N0cmluZyhjb250YWluZXIpKSB7DQogICAgICAgICAgICAgICAgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29udGFpbmVyKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChjb250YWluZXIpIHsNCiAgICAgICAgICAgICAgICBpZihvcHRpb25zLmluaXRpYWxGcmFtZVdpZHRoKXsNCiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5taW5GcmFtZVdpZHRoID0gb3B0aW9ucy5pbml0aWFsRnJhbWVXaWR0aA0KICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICBvcHRpb25zLm1pbkZyYW1lV2lkdGggPSBvcHRpb25zLmluaXRpYWxGcmFtZVdpZHRoID0gY29udGFpbmVyLm9mZnNldFdpZHRoOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZihvcHRpb25zLmluaXRpYWxGcmFtZUhlaWdodCl7DQogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMubWluRnJhbWVIZWlnaHQgPSBvcHRpb25zLmluaXRpYWxGcmFtZUhlaWdodA0KICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmluaXRpYWxGcmFtZUhlaWdodCA9IG9wdGlvbnMubWluRnJhbWVIZWlnaHQgPSBjb250YWluZXIub2Zmc2V0SGVpZ2h0Ow0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGNvbnRhaW5lci5zdHlsZS53aWR0aCA9IC8lJC8udGVzdChvcHRpb25zLmluaXRpYWxGcmFtZVdpZHRoKSA/ICAnMTAwJScgOiBvcHRpb25zLmluaXRpYWxGcmFtZVdpZHRoLQ0KICAgICAgICAgICAgICAgICAgIGdldFN0eWxlVmFsdWUoInBhZGRpbmctbGVmdCIpLSBnZXRTdHlsZVZhbHVlKCJwYWRkaW5nLXJpZ2h0IikgKydweCc7DQogICAgICAgICAgICAgICAgY29udGFpbmVyLnN0eWxlLmhlaWdodCA9IC8lJC8udGVzdChvcHRpb25zLmluaXRpYWxGcmFtZUhlaWdodCkgPyAgJzEwMCUnIDogb3B0aW9ucy5pbml0aWFsRnJhbWVIZWlnaHQgLQ0KICAgICAgICAgICAgICAgICAgICBnZXRTdHlsZVZhbHVlKCJwYWRkaW5nLXRvcCIpLSBnZXRTdHlsZVZhbHVlKCJwYWRkaW5nLWJvdHRvbSIpICsncHgnOw0KDQogICAgICAgICAgICAgICAgY29udGFpbmVyLnN0eWxlLnpJbmRleCA9IG9wdGlvbnMuekluZGV4Ow0KDQogICAgICAgICAgICAgICAgdmFyIGh0bWwgPSAoIGllICYmIGJyb3dzZXIudmVyc2lvbiA8IDkgID8gJycgOiAnPCFET0NUWVBFIGh0bWw+JykgKw0KICAgICAgICAgICAgICAgICAgICAgICAgJzxodG1sIHhtbG5zPVwnaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbFwnIGNsYXNzPVwndmlld1wnID48aGVhZD4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICc8c3R5bGUgdHlwZT1cJ3RleHQvY3NzXCc+JyArDQogICAgICAgICAgICAgICAgICAgICAgICAvL+iuvue9ruWbm+WRqOeahOeVmei+uQ0KICAgICAgICAgICAgICAgICAgICAgICAgJy52aWV3e3BhZGRpbmc6MDt3b3JkLXdyYXA6YnJlYWstd29yZDtjdXJzb3I6dGV4dDtoZWlnaHQ6OTAlO31cbicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgLy/orr7nva7pu5jorqTlrZfkvZPlkozlrZflj7cNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vZm9udC1mYW1pbHnkuI3og73lkaLpmo/kvr/mlLnvvIzlnKhzYWZhcmnkuItmaWxsY2hhcuS8muacieino+aekOmXrumimA0KICAgICAgICAgICAgICAgICAgICAgICAgJ2JvZHl7bWFyZ2luOjhweDtmb250LWZhbWlseTpzYW5zLXNlcmlmO2ZvbnQtc2l6ZToxNnB4O30nICsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8v6K6+572u5q616JC96Ze06LedDQogICAgICAgICAgICAgICAgICAgICAgICAncHttYXJnaW46NXB4IDA7fTwvc3R5bGU+JyArDQogICAgICAgICAgICAgICAgICAgICAgICAoIG9wdGlvbnMuaWZyYW1lQ3NzVXJsID8gJzxsaW5rIHJlbD1cJ3N0eWxlc2hlZXRcJyB0eXBlPVwndGV4dC9jc3NcJyBocmVmPVwnJyArIHV0aWxzLnVuaHRtbChvcHRpb25zLmlmcmFtZUNzc1VybCkgKyAnXCcvPicgOiAnJyApICsNCiAgICAgICAgICAgICAgICAgICAgICAgIChvcHRpb25zLmluaXRpYWxTdHlsZSA/ICc8c3R5bGU+JyArIG9wdGlvbnMuaW5pdGlhbFN0eWxlICsgJzwvc3R5bGU+JyA6ICcnKSArDQogICAgICAgICAgICAgICAgICAgICAgICAnPC9oZWFkPjxib2R5IGNsYXNzPVwndmlld1wnID48L2JvZHk+JyArDQogICAgICAgICAgICAgICAgICAgICAgICAnPHNjcmlwdCB0eXBlPVwndGV4dC9qYXZhc2NyaXB0XCcgJyArIChpZSA/ICdkZWZlcj1cJ2RlZmVyXCcnIDogJycgKSArJyBpZD1cJ19pbml0aWFsU2NyaXB0XCc+JyArDQogICAgICAgICAgICAgICAgICAgICAgICAnc2V0VGltZW91dChmdW5jdGlvbigpe3dpbmRvdy5wYXJlbnQuVUUuaW5zdGFudHNbXCd1ZWRpdG9ySW5zdGFudCcgKyBtZS51aWQgKyAnXCddLl9zZXR1cChkb2N1bWVudCk7fSwwKTsnICsNCiAgICAgICAgICAgICAgICAgICAgICAgICd2YXIgX3RtcFNjcmlwdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwnX2luaXRpYWxTY3JpcHRcJyk7X3RtcFNjcmlwdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKF90bXBTY3JpcHQpOzwvc2NyaXB0PjwvaHRtbD4nOw0KICAgICAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChkb21VdGlscy5jcmVhdGVFbGVtZW50KGRvY3VtZW50LCAnaWZyYW1lJywgew0KICAgICAgICAgICAgICAgICAgICBpZDogJ3VlZGl0b3JfJyArIG1lLnVpZCwNCiAgICAgICAgICAgICAgICAgICAgd2lkdGg6ICIxMDAlIiwNCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAiMTAwJSIsDQogICAgICAgICAgICAgICAgICAgIGZyYW1lYm9yZGVyOiAiMCIsDQogICAgICAgICAgICAgICAgICAgIHNyYzogJ2phdmFzY3JpcHQ6dm9pZChmdW5jdGlvbigpe2RvY3VtZW50Lm9wZW4oKTsnICsgKG9wdGlvbnMuY3VzdG9tRG9tYWluICYmIGRvY3VtZW50LmRvbWFpbiAhPSBsb2NhdGlvbi5ob3N0bmFtZSA/ICAnZG9jdW1lbnQuZG9tYWluPSInICsgZG9jdW1lbnQuZG9tYWluICsgJyI7JyA6ICcnKSArDQogICAgICAgICAgICAgICAgICAgICAgICAnZG9jdW1lbnQud3JpdGUoIicgKyBodG1sICsgJyIpO2RvY3VtZW50LmNsb3NlKCk7fSgpKScNCiAgICAgICAgICAgICAgICB9KSk7DQogICAgICAgICAgICAgICAgY29udGFpbmVyLnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7DQogICAgICAgICAgICAgICAgLy/op6PlhrPlpoLmnpzmmK/nu5nlrprnmoTnmb7liIbmr5TvvIzkvJrlr7zoh7Tpq5jluqbnrpfkuI3lr7nnmoTpl67popgNCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgICAgICAgIGlmKCAvJSQvLnRlc3Qob3B0aW9ucy5pbml0aWFsRnJhbWVXaWR0aCkpew0KICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5taW5GcmFtZVdpZHRoID0gb3B0aW9ucy5pbml0aWFsRnJhbWVXaWR0aCA9IGNvbnRhaW5lci5vZmZzZXRXaWR0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5zdHlsZS53aWR0aCA9IG9wdGlvbnMuaW5pdGlhbEZyYW1lV2lkdGggKyAncHgnOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmKC8lJC8udGVzdChvcHRpb25zLmluaXRpYWxGcmFtZUhlaWdodCkpew0KICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5taW5GcmFtZUhlaWdodCA9IG9wdGlvbnMuaW5pdGlhbEZyYW1lSGVpZ2h0ID0gY29udGFpbmVyLm9mZnNldEhlaWdodDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBvcHRpb25zLmluaXRpYWxGcmFtZUhlaWdodCArICdweCc7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICAvKioNCiAgICAgICAgICog57yW6L6R5Zmo5Yid5aeL5YyWDQogICAgICAgICAqIEBwcml2YXRlDQogICAgICAgICAqIEBpZ25vcmUNCiAgICAgICAgICogQHBhcmFtIHtFbGVtZW50fSBkb2Mg57yW6L6R5ZmoSWZyYW1l5Lit55qE5paH5qGj5a+56LGhDQogICAgICAgICAqLw0KICAgICAgICBfc2V0dXA6IGZ1bmN0aW9uIChkb2MpIHsNCg0KICAgICAgICAgICAgdmFyIG1lID0gdGhpcywNCiAgICAgICAgICAgICAgICBvcHRpb25zID0gbWUub3B0aW9uczsNCiAgICAgICAgICAgIGlmIChpZSkgew0KICAgICAgICAgICAgICAgIGRvYy5ib2R5LmRpc2FibGVkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICBkb2MuYm9keS5jb250ZW50RWRpdGFibGUgPSB0cnVlOw0KICAgICAgICAgICAgICAgIGRvYy5ib2R5LmRpc2FibGVkID0gZmFsc2U7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGRvYy5ib2R5LmNvbnRlbnRFZGl0YWJsZSA9IHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBkb2MuYm9keS5zcGVsbGNoZWNrID0gZmFsc2U7DQogICAgICAgICAgICBtZS5kb2N1bWVudCA9IGRvYzsNCiAgICAgICAgICAgIG1lLndpbmRvdyA9IGRvYy5kZWZhdWx0VmlldyB8fCBkb2MucGFyZW50V2luZG93Ow0KICAgICAgICAgICAgbWUuaWZyYW1lID0gbWUud2luZG93LmZyYW1lRWxlbWVudDsNCiAgICAgICAgICAgIG1lLmJvZHkgPSBkb2MuYm9keTsNCg0KICAgICAgICAgICAgbWUuc2VsZWN0aW9uID0gbmV3IGRvbS5TZWxlY3Rpb24oZG9jKTsNCiAgICAgICAgICAgIC8vZ2Vja2/liJ3lp4vljJblsLHog73lvpfliLByYW5nZSzml6Dms5XliKTmlq1pc0ZvY3Vz5LqGDQogICAgICAgICAgICB2YXIgZ2Vja29TZWw7DQogICAgICAgICAgICBpZiAoYnJvd3Nlci5nZWNrbyAmJiAoZ2Vja29TZWwgPSB0aGlzLnNlbGVjdGlvbi5nZXROYXRpdmUoKSkpIHsNCiAgICAgICAgICAgICAgICBnZWNrb1NlbC5yZW1vdmVBbGxSYW5nZXMoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuX2luaXRFdmVudHMoKTsNCiAgICAgICAgICAgIC8v5Li6Zm9ybeaPkOS6pOaPkOS+m+S4gOS4qumakOiXj+eahHRleHRhcmVhDQogICAgICAgICAgICBmb3IgKHZhciBmb3JtID0gdGhpcy5pZnJhbWUucGFyZW50Tm9kZTsgIWRvbVV0aWxzLmlzQm9keShmb3JtKTsgZm9ybSA9IGZvcm0ucGFyZW50Tm9kZSkgew0KICAgICAgICAgICAgICAgIGlmIChmb3JtLnRhZ05hbWUgPT0gJ0ZPUk0nKSB7DQogICAgICAgICAgICAgICAgICAgIG1lLmZvcm0gPSBmb3JtOw0KICAgICAgICAgICAgICAgICAgICBpZihtZS5vcHRpb25zLmF1dG9TeW5jRGF0YSl7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5vbihtZS53aW5kb3csJ2JsdXInLGZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VmFsdWUoZm9ybSxtZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5vbihmb3JtLCAnc3VibWl0JywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFZhbHVlKHRoaXMsIG1lKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChvcHRpb25zLmluaXRpYWxDb250ZW50KSB7DQogICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuYXV0b0NsZWFyaW5pdGlhbENvbnRlbnQpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIG9sZEV4ZWNDb21tYW5kID0gbWUuZXhlY0NvbW1hbmQ7DQogICAgICAgICAgICAgICAgICAgIG1lLmV4ZWNDb21tYW5kID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCdmaXJzdEJlZm9yZUV4ZWNDb21tYW5kJyk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2xkRXhlY0NvbW1hbmQuYXBwbHkobWUsIGFyZ3VtZW50cyk7DQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldERlZmF1bHRDb250ZW50KG9wdGlvbnMuaW5pdGlhbENvbnRlbnQpOw0KICAgICAgICAgICAgICAgIH0gZWxzZQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNldENvbnRlbnQob3B0aW9ucy5pbml0aWFsQ29udGVudCwgZmFsc2UsIHRydWUpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvL+e8lui+keWZqOS4jeiDveS4uuepuuWGheWuuQ0KDQogICAgICAgICAgICBpZiAoZG9tVXRpbHMuaXNFbXB0eU5vZGUobWUuYm9keSkpIHsNCiAgICAgICAgICAgICAgICBtZS5ib2R5LmlubmVySFRNTCA9ICc8cD4nICsgKGJyb3dzZXIuaWUgPyAnJyA6ICc8YnIvPicpICsgJzwvcD4nOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy/lpoLmnpzopoHmsYJmb2N1cywg5bCx5oqK5YWJ5qCH5a6a5L2N5Yiw5YaF5a655byA5aeLDQogICAgICAgICAgICBpZiAob3B0aW9ucy5mb2N1cykgew0KICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICBtZS5mb2N1cyhtZS5vcHRpb25zLmZvY3VzSW5FbmQpOw0KICAgICAgICAgICAgICAgICAgICAvL+WmguaenOiHquWKqOa4hemZpOW8gOedgO+8jOWwseS4jemcgOimgeWBmnNlbGVjdGlvbmNoYW5nZTsNCiAgICAgICAgICAgICAgICAgICAgIW1lLm9wdGlvbnMuYXV0b0NsZWFyaW5pdGlhbENvbnRlbnQgJiYgbWUuX3NlbGVjdGlvbkNoYW5nZSgpOw0KICAgICAgICAgICAgICAgIH0sIDApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCFtZS5jb250YWluZXIpIHsNCiAgICAgICAgICAgICAgICBtZS5jb250YWluZXIgPSB0aGlzLmlmcmFtZS5wYXJlbnROb2RlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKG9wdGlvbnMuZnVsbHNjcmVlbiAmJiBtZS51aSkgew0KICAgICAgICAgICAgICAgIG1lLnVpLnNldEZ1bGxTY3JlZW4odHJ1ZSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgbWUuZG9jdW1lbnQuZXhlY0NvbW1hbmQoJzJELXBvc2l0aW9uJywgZmFsc2UsIGZhbHNlKTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgbWUuZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ2VuYWJsZUlubGluZVRhYmxlRWRpdGluZycsIGZhbHNlLCBmYWxzZSk7DQogICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIG1lLmRvY3VtZW50LmV4ZWNDb21tYW5kKCdlbmFibGVPYmplY3RSZXNpemluZycsIGZhbHNlLCBmYWxzZSk7DQogICAgICAgICAgICB9IGNhdGNoIChlKSB7DQovLyAgICAgICAgICAgICAgICBkb21VdGlscy5vbihtZS5ib2R5LGJyb3dzZXIuaWUgPyAncmVzaXplc3RhcnQnIDogJ3Jlc2l6ZScsIGZ1bmN0aW9uKCBldnQgKSB7DQovLyAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucHJldmVudERlZmF1bHQoZXZ0KQ0KLy8gICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBtZS5fYmluZHNob3J0Y3V0S2V5cygpOw0KICAgICAgICAgICAgbWUuaXNSZWFkeSA9IDE7DQogICAgICAgICAgICBtZS5maXJlRXZlbnQoJ3JlYWR5Jyk7DQogICAgICAgICAgICBvcHRpb25zLm9ucmVhZHkgJiYgb3B0aW9ucy5vbnJlYWR5LmNhbGwobWUpOw0KICAgICAgICAgICAgaWYgKCFicm93c2VyLmllKSB7DQogICAgICAgICAgICAgICAgZG9tVXRpbHMub24obWUud2luZG93LCBbJ2JsdXInLCAnZm9jdXMnXSwgZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgLy9jaHJvbWXkuIvkvJrlh7rnjrBhbHQrdGFi5YiH5o2i5pe277yM5a+86Ie06YCJ5Yy65L2N572u5LiN5a+5DQogICAgICAgICAgICAgICAgICAgIGlmIChlLnR5cGUgPT0gJ2JsdXInKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBtZS5fYmFrUmFuZ2UgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUuX2Jha05hdGl2ZVJhbmdlID0gbWUuc2VsZWN0aW9uLmdldE5hdGl2ZSgpLmdldFJhbmdlQXQoMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUuc2VsZWN0aW9uLmdldE5hdGl2ZSgpLnJlbW92ZUFsbFJhbmdlcygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lLl9iYWtOYXRpdmVSYW5nZSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUuX2Jha1JhbmdlICYmIG1lLl9iYWtSYW5nZS5zZWxlY3QoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy90cmFjZToxNTE4IGZmMy42Ym9keeS4jeWkn+Wvm++8jOS8muWvvOiHtOeCueWHu+epuueZveWkhOaXoOazleiOt+W+l+eEpueCuQ0KICAgICAgICAgICAgaWYgKGJyb3dzZXIuZ2Vja28gJiYgYnJvd3Nlci52ZXJzaW9uIDw9IDEwOTAyKSB7DQogICAgICAgICAgICAgICAgLy/kv67lpI1mZjMuNuWIneWni+WMlui/m+adpe+8jOS4jeiDveeCueWHu+iOt+W+l+eEpueCuQ0KICAgICAgICAgICAgICAgIG1lLmJvZHkuY29udGVudEVkaXRhYmxlID0gZmFsc2U7DQogICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgIG1lLmJvZHkuY29udGVudEVkaXRhYmxlID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICB9LCAxMDApOw0KICAgICAgICAgICAgICAgIHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgbWUuYm9keS5zdHlsZS5oZWlnaHQgPSBtZS5pZnJhbWUub2Zmc2V0SGVpZ2h0IC0gMjAgKyAncHgnDQogICAgICAgICAgICAgICAgfSwgMTAwKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgIW9wdGlvbnMuaXNTaG93ICYmIG1lLnNldEhpZGUoKTsNCiAgICAgICAgICAgIG9wdGlvbnMucmVhZG9ubHkgJiYgbWUuc2V0RGlzYWJsZWQoKTsNCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIOWQjOatpee8lui+keWZqOeahOaVsOaNru+8jOS4uuaPkOS6pOaVsOaNruWBmuWHhuWkh++8jOS4u+imgeeUqOS6juS9oOaYr+aJi+WKqOaPkOS6pOeahOaDheWGtQ0KICAgICAgICAgKiBAbmFtZSBzeW5jDQogICAgICAgICAqIEBncmFtbWFyIGVkaXRvci5zeW5jKCk7IC8v5LuO57yW6L6R5Zmo55qE5a655Zmo5ZCR5LiK5p+l5om+77yM5aaC5p6c5om+5Yiw5bCx5ZCM5q2l5pWw5o2uDQogICAgICAgICAqIEBncmFtbWFyIGVkaXRvci5zeW5jKGZvcm1JRCk7IC8vZm9ybUlE5Yi25a6a5LiA5Liq6KaB5ZCM5q2l5pWw5o2u55qEZm9ybeeahGlkLOe8lui+keWZqOeahOaVsOaNruS8muWQjOatpeWIsOS9oOaMh+WummZvcm3kuIsNCiAgICAgICAgICogQGRlc2MNCiAgICAgICAgICog5ZCO5Y+w5Y+W5b6X5pWw5o2u5b6X6ZSu5YC85L2/55So5L2g5a655Zmo5LiK5b6XJyduYW1lJyflsZ7mgKfvvIzlpoLmnpzmsqHmnInlsLHkvb/nlKjlj4LmlbDkvKDlhaXnmoQnJ3RleHRhcmVhJycNCiAgICAgICAgICogQGV4YW1wbGUNCiAgICAgICAgICogZWRpdG9yLnN5bmMoKTsNCiAgICAgICAgICogZm9ybS5zdW1iaXQoKTsgLy9mb3Jt5Y+Y6YeP5bey57uP5oyH5ZCR5LqGZm9ybeWFg+e0oA0KICAgICAgICAgKg0KICAgICAgICAgKi8NCiAgICAgICAgc3luYzogZnVuY3Rpb24gKGZvcm1JZCkgew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpcywNCiAgICAgICAgICAgICAgICBmb3JtID0gZm9ybUlkID8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZm9ybUlkKSA6DQogICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLmZpbmRQYXJlbnQobWUuaWZyYW1lLnBhcmVudE5vZGUsIGZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbm9kZS50YWdOYW1lID09ICdGT1JNJw0KICAgICAgICAgICAgICAgICAgICB9LCB0cnVlKTsNCiAgICAgICAgICAgIGZvcm0gJiYgc2V0VmFsdWUoZm9ybSwgbWUpOw0KICAgICAgICB9LA0KICAgICAgICAvKioNCiAgICAgICAgICog6K6+572u57yW6L6R5Zmo6auY5bqmDQogICAgICAgICAqIEBuYW1lIHNldEhlaWdodA0KICAgICAgICAgKiBAZ3JhbW1hciBlZGl0b3Iuc2V0SGVpZ2h0KG51bWJlcik7ICAvL+e6r+aVsOWAvO+8jOS4jeW4puWNleS9jQ0KICAgICAgICAgKi8NCiAgICAgICAgc2V0SGVpZ2h0OiBmdW5jdGlvbiAoaGVpZ2h0LG5vdFNldEhlaWdodCkgew0KICAgICAgICAgICAgaWYgKGhlaWdodCAhPT0gcGFyc2VJbnQodGhpcy5pZnJhbWUucGFyZW50Tm9kZS5zdHlsZS5oZWlnaHQpKSB7DQogICAgICAgICAgICAgICAgdGhpcy5pZnJhbWUucGFyZW50Tm9kZS5zdHlsZS5oZWlnaHQgPSBoZWlnaHQgKyAncHgnOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgIW5vdFNldEhlaWdodCAmJiAodGhpcy5vcHRpb25zLm1pbkZyYW1lSGVpZ2h0ID0gdGhpcy5vcHRpb25zLmluaXRpYWxGcmFtZUhlaWdodCA9IGhlaWdodCk7DQoNCiAgICAgICAgICAgIHRoaXMuYm9keS5zdHlsZS5oZWlnaHQgPSBoZWlnaHQgKyAncHgnOw0KICAgICAgICB9LA0KDQogICAgICAgIGFkZHNob3J0Y3V0a2V5OiBmdW5jdGlvbiAoY21kLCBrZXlzKSB7DQogICAgICAgICAgICB2YXIgb2JqID0ge307DQogICAgICAgICAgICBpZiAoa2V5cykgew0KICAgICAgICAgICAgICAgIG9ialtjbWRdID0ga2V5cw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBvYmogPSBjbWQ7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB1dGlscy5leHRlbmQodGhpcy5zaG9ydGN1dGtleXMsIG9iaikNCiAgICAgICAgfSwNCiAgICAgICAgX2JpbmRzaG9ydGN1dEtleXM6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBtZSA9IHRoaXMsIHNob3J0Y3V0a2V5cyA9IHRoaXMuc2hvcnRjdXRrZXlzOw0KICAgICAgICAgICAgbWUuYWRkTGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbiAodHlwZSwgZSkgew0KICAgICAgICAgICAgICAgIHZhciBrZXlDb2RlID0gZS5rZXlDb2RlIHx8IGUud2hpY2g7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBzaG9ydGN1dGtleXMpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHRtcCA9IHNob3J0Y3V0a2V5c1tpXS5zcGxpdCgnLCcpOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB0ID0gMCwgdGk7IHRpID0gdG1wW3QrK107KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aSA9IHRpLnNwbGl0KCc6Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gdGlbMF0sIHBhcmFtID0gdGlbMV07DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoL14oY3RybCkoXCtzaGlmdCk/XCsoXGQrKSQvLnRlc3Qoa2V5LnRvTG93ZXJDYXNlKCkpIHx8IC9eKFxkKykkLy50ZXN0KGtleSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKCAoUmVnRXhwLiQxID09ICdjdHJsJyA/IChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSA6IDApDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIChSZWdFeHAuJDIgIT0gIiIgPyBlW1JlZ0V4cC4kMi5zbGljZSgxKSArICJLZXkiXSA6IDEpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIGtleUNvZGUgPT0gUmVnRXhwLiQzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgfHwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5Q29kZSA9PSBSZWdFeHAuJDENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZS5xdWVyeUNvbW1hbmRTdGF0ZShpLHBhcmFtKSAhPSAtMSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lLmV4ZWNDb21tYW5kKGksIHBhcmFtKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucHJldmVudERlZmF1bHQoZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIOiOt+WPlue8lui+keWZqOWGheWuuQ0KICAgICAgICAgKiBAbmFtZSBnZXRDb250ZW50DQogICAgICAgICAqIEBncmFtbWFyIGVkaXRvci5nZXRDb250ZW50KCkgID0+IFN0cmluZyAvL+iLpee8lui+keWZqOS4reWPquWMheWQq+Wtl+espiImbHQ7cCZndDsmbHQ7YnIgLyZndDsmbHQ7L3AvJmd0OyLkvJrov5Tlm57nqbrjgIINCiAgICAgICAgICogQGdyYW1tYXIgZWRpdG9yLmdldENvbnRlbnQoZm4pICA9PiBTdHJpbmcNCiAgICAgICAgICogQGV4YW1wbGUNCiAgICAgICAgICogZ2V0Q29udGVudOm7mOiupOaYr+S8mueOsOiwg+eUqGhhc0NvbnRlbnRz5p2l5Yik5pat57yW6L6R5Zmo5piv5ZCm5Li656m677yM5aaC5p6c5piv77yM5bCx55u05o6l6L+U5Zue56m65a2X56ym5LiyDQogICAgICAgICAqIOS9oOS5n+WPr+S7peS8oOWFpeS4gOS4qmZu5p2l5o6l5pu/aGFzQ29udGVudHPnmoTlt6XkvZzvvIzlrprliLbliKTmlq3nmoTop4TliJkNCiAgICAgICAgICogZWRpdG9yLmdldENvbnRlbnQoZnVuY3Rpb24oKXsNCiAgICAgICAgICogICAgIHJldHVybiBmYWxzZSAvL+e8lui+keWZqOayoeacieWGheWuuSDvvIxnZXRDb250ZW5055u05o6l6L+U5Zue56m6DQogICAgICAgICAqIH0pDQogICAgICAgICAqLw0KICAgICAgICBnZXRDb250ZW50OiBmdW5jdGlvbiAoY21kLCBmbixub3RTZXRDdXJzb3IsaWdub3JlQmxhbmssZm9ybWF0dGVyKSB7DQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzOw0KICAgICAgICAgICAgaWYgKGNtZCAmJiB1dGlscy5pc0Z1bmN0aW9uKGNtZCkpIHsNCiAgICAgICAgICAgICAgICBmbiA9IGNtZDsNCiAgICAgICAgICAgICAgICBjbWQgPSAnJzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChmbiA/ICFmbigpIDogIXRoaXMuaGFzQ29udGVudHMoKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnYmVmb3JlZ2V0Y29udGVudCcpOw0KICAgICAgICAgICAgdmFyIHJvb3QgPSBVRS5odG1scGFyc2VyKG1lLmJvZHkuaW5uZXJIVE1MLGlnbm9yZUJsYW5rKTsNCiAgICAgICAgICAgIG1lLmZpbHRlck91dHB1dFJ1bGUocm9vdCk7DQogICAgICAgICAgICBtZS5maXJlRXZlbnQoJ2FmdGVyZ2V0Y29udGVudCcsIGNtZCk7DQogICAgICAgICAgICByZXR1cm4gIHJvb3QudG9IdG1sKGZvcm1hdHRlcik7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDlj5blvpflrozmlbTnmoRodG1s5Luj56CB77yM5Y+v5Lul55u05o6l5pi+56S65oiQ5a6M5pW055qEaHRtbOaWh+ahow0KICAgICAgICAgKiBAbmFtZSBnZXRBbGxIdG1sDQogICAgICAgICAqIEBncmFtbWFyIGVkaXRvci5nZXRBbGxIdG1sKCkgID0+IFN0cmluZw0KICAgICAgICAgKi8NCiAgICAgICAgZ2V0QWxsSHRtbDogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpcywNCiAgICAgICAgICAgICAgICBoZWFkSHRtbCA9IFtdLA0KICAgICAgICAgICAgICAgIGh0bWwgPSAnJzsNCiAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnZ2V0QWxsSHRtbCcsIGhlYWRIdG1sKTsNCiAgICAgICAgICAgIGlmIChicm93c2VyLmllICYmIGJyb3dzZXIudmVyc2lvbiA+IDgpIHsNCiAgICAgICAgICAgICAgICB2YXIgaGVhZEh0bWxGb3JJRTkgPSAnJzsNCiAgICAgICAgICAgICAgICB1dGlscy5lYWNoKG1lLmRvY3VtZW50LnN0eWxlU2hlZXRzLCBmdW5jdGlvbiAoc2kpIHsNCiAgICAgICAgICAgICAgICAgICAgaGVhZEh0bWxGb3JJRTkgKz0gKCBzaS5ocmVmID8gJzxsaW5rIHJlbD0ic3R5bGVzaGVldCIgdHlwZT0idGV4dC9jc3MiIGhyZWY9IicgKyBzaS5ocmVmICsgJyIgLz4nIDogJzxzdHlsZT4nICsgc2kuY3NzVGV4dCArICc8L3N0eWxlPicpOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIHV0aWxzLmVhY2gobWUuZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpLCBmdW5jdGlvbiAoc2kpIHsNCiAgICAgICAgICAgICAgICAgICAgaGVhZEh0bWxGb3JJRTkgKz0gc2kub3V0ZXJIVE1MOw0KICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gJzxodG1sPjxoZWFkPicgKyAobWUub3B0aW9ucy5jaGFyc2V0ID8gJzxtZXRhIGh0dHAtZXF1aXY9IkNvbnRlbnQtVHlwZSIgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PScgKyBtZS5vcHRpb25zLmNoYXJzZXQgKyAnIi8+JyA6ICcnKQ0KICAgICAgICAgICAgICAgICsgKGhlYWRIdG1sRm9ySUU5IHx8IG1lLmRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0uaW5uZXJIVE1MKSArIGhlYWRIdG1sLmpvaW4oJ1xuJykgKyAnPC9oZWFkPicNCiAgICAgICAgICAgICAgICArICc8Ym9keSAnICsgKGllICYmIGJyb3dzZXIudmVyc2lvbiA8IDkgPyAnY2xhc3M9InZpZXciJyA6ICcnKSArICc+JyArIG1lLmdldENvbnRlbnQobnVsbCwgbnVsbCwgdHJ1ZSkgKyAnPC9ib2R5PjwvaHRtbD4nOw0KICAgICAgICB9LA0KICAgICAgICAvKioNCiAgICAgICAgICog5b6X5Yiw57yW6L6R5Zmo55qE57qv5paH5pys5YaF5a6577yM5L2G5Lya5L+d55WZ5q616JC95qC85byPDQogICAgICAgICAqIEBuYW1lIGdldFBsYWluVHh0DQogICAgICAgICAqIEBncmFtbWFyIGVkaXRvci5nZXRQbGFpblR4dCgpICA9PiBTdHJpbmcNCiAgICAgICAgICovDQogICAgICAgIGdldFBsYWluVHh0OiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgcmVnID0gbmV3IFJlZ0V4cChkb21VdGlscy5maWxsQ2hhciwgJ2cnKSwNCiAgICAgICAgICAgICAgICBodG1sID0gdGhpcy5ib2R5LmlubmVySFRNTC5yZXBsYWNlKC9bXG5ccl0vZywgJycpOy8vaWXopoHlhYjljrvkuoZcbuWcqOWkhOeQhg0KICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgvPChwfGRpdilbXj5dKj4oPGJyXC8/PnwmbmJzcDspPFwvXDE+L2dpLCAnXG4nKQ0KICAgICAgICAgICAgICAgIC5yZXBsYWNlKC88YnJcLz8+L2dpLCAnXG4nKQ0KICAgICAgICAgICAgICAgIC5yZXBsYWNlKC88W14+L10rPi9nLCAnJykNCiAgICAgICAgICAgICAgICAucmVwbGFjZSgvKFxuKT88XC8oW14+XSspPi9nLCBmdW5jdGlvbiAoYSwgYiwgYykgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZHRkLiRibG9ja1tjXSA/ICdcbicgOiBiID8gYiA6ICcnOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgLy/lj5blh7rmnaXnmoTnqbrmoLzkvJrmnIljMmEw5Lya5Y+Y5oiQ5Lmx56CB77yM5aSE55CG6L+Z56eN5oOF5Ya1XHUwMGEwDQogICAgICAgICAgICByZXR1cm4gaHRtbC5yZXBsYWNlKHJlZywgJycpLnJlcGxhY2UoL1x1MDBhMC9nLCAnICcpLnJlcGxhY2UoLyZuYnNwOy9nLCAnICcpOw0KICAgICAgICB9LA0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiDojrflj5bnvJbovpHlmajkuK3nmoTnuq/mlofmnKzlhoXlrrks5rKh5pyJ5q616JC95qC85byPDQogICAgICAgICAqIEBuYW1lIGdldENvbnRlbnRUeHQNCiAgICAgICAgICogQGdyYW1tYXIgZWRpdG9yLmdldENvbnRlbnRUeHQoKSAgPT4gU3RyaW5nDQogICAgICAgICAqLw0KICAgICAgICBnZXRDb250ZW50VHh0OiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgcmVnID0gbmV3IFJlZ0V4cChkb21VdGlscy5maWxsQ2hhciwgJ2cnKTsNCiAgICAgICAgICAgIC8v5Y+W5Ye65p2l55qE56m65qC85Lya5pyJYzJhMOS8muWPmOaIkOS5seegge+8jOWkhOeQhui/meenjeaDheWGtVx1MDBhMA0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuYm9keVticm93c2VyLmllID8gJ2lubmVyVGV4dCcgOiAndGV4dENvbnRlbnQnXS5yZXBsYWNlKHJlZywgJycpLnJlcGxhY2UoL1x1MDBhMC9nLCAnICcpOw0KICAgICAgICB9LA0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiDlsIZodG1s6K6+572u5Yiw57yW6L6R5Zmo5LitLCDlpoLmnpzmmK/nlKjkuo7liJ3lp4vljJbml7bnu5nnvJbovpHlmajotYvliJ3lgLzvvIzliJnlv4XpobvmlL7lnKhyZWFkeeaWueazleWGhemDqOaJp+ihjA0KICAgICAgICAgKiBAbmFtZSBzZXRDb250ZW50DQogICAgICAgICAqIEBncmFtbWFyIGVkaXRvci5zZXRDb250ZW50KGh0bWwpDQogICAgICAgICAqIEBleGFtcGxlDQogICAgICAgICAqIHZhciBlZGl0b3IgPSBuZXcgVUUudWkuRWRpdG9yKCkNCiAgICAgICAgICogZWRpdG9yLnJlYWR5KGZ1bmN0aW9uKCl7DQogICAgICAgICAqICAgICAvL+mcgOimgXJlYWR55ZCO5omn6KGM77yM5ZCm5YiZ5Y+v6IO95oql6ZSZDQogICAgICAgICAqICAgICBlZGl0b3Iuc2V0Q29udGVudCgi5qyi6L+O5L2/55SoVUVkaXRvcu+8gSIpOw0KICAgICAgICAgKiB9KQ0KICAgICAgICAgKi8NCiAgICAgICAgc2V0Q29udGVudDogZnVuY3Rpb24gKGh0bWwsIGlzQXBwZW5kVG8sIG5vdEZpcmVTZWxlY3Rpb25jaGFuZ2UpIHsNCiAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7DQoNCiAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnYmVmb3Jlc2V0Y29udGVudCcsIGh0bWwpOw0KICAgICAgICAgICAgdmFyIHJvb3QgPSBVRS5odG1scGFyc2VyKGh0bWwpOw0KICAgICAgICAgICAgbWUuZmlsdGVySW5wdXRSdWxlKHJvb3QpOw0KICAgICAgICAgICAgaHRtbCA9IHJvb3QudG9IdG1sKCk7DQoNCg0KICAgICAgICAgICAgbWUuYm9keS5pbm5lckhUTUwgPSAoaXNBcHBlbmRUbyA/IG1lLmJvZHkuaW5uZXJIVE1MIDogJycpICsgaHRtbDsNCg0KDQogICAgICAgICAgICBmdW5jdGlvbiBpc0NkYXRhRGl2KG5vZGUpew0KICAgICAgICAgICAgICAgIHJldHVybiAgbm9kZS50YWdOYW1lID09ICdESVYnICYmIG5vZGUuZ2V0QXR0cmlidXRlKCdjZGF0YV90YWcnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8v57uZ5paH5pys5oiW6ICFaW5saW5l6IqC54K55aWXcOagh+etvg0KICAgICAgICAgICAgaWYgKG1lLm9wdGlvbnMuZW50ZXJUYWcgPT0gJ3AnKSB7DQoNCiAgICAgICAgICAgICAgICB2YXIgY2hpbGQgPSB0aGlzLmJvZHkuZmlyc3RDaGlsZCwgdG1wTm9kZTsNCiAgICAgICAgICAgICAgICBpZiAoIWNoaWxkIHx8IGNoaWxkLm5vZGVUeXBlID09IDEgJiYNCiAgICAgICAgICAgICAgICAgICAgKGR0ZC4kY2RhdGFbY2hpbGQudGFnTmFtZV0gfHwgaXNDZGF0YURpdihjaGlsZCkgfHwNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLmlzQ3VzdG9tZU5vZGUoY2hpbGQpDQogICAgICAgICAgICAgICAgICAgICAgICApDQogICAgICAgICAgICAgICAgICAgICYmIGNoaWxkID09PSB0aGlzLmJvZHkubGFzdENoaWxkKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYm9keS5pbm5lckhUTUwgPSAnPHA+JyArIChicm93c2VyLmllID8gJyZuYnNwOycgOiAnPGJyLz4nKSArICc8L3A+JyArIHRoaXMuYm9keS5pbm5lckhUTUw7DQoNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IG1lLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTsNCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGNoaWxkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoY2hpbGQgJiYgKGNoaWxkLm5vZGVUeXBlID09IDMgfHwgY2hpbGQubm9kZVR5cGUgPT0gMSAmJiBkdGQucFtjaGlsZC50YWdOYW1lXSAmJiAhZHRkLiRjZGF0YVtjaGlsZC50YWdOYW1lXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBOb2RlID0gY2hpbGQubmV4dFNpYmxpbmc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5hcHBlbmRDaGlsZChjaGlsZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQgPSB0bXBOb2RlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHAuZmlyc3RDaGlsZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY2hpbGQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUuYm9keS5hcHBlbmRDaGlsZChwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUocCwgY2hpbGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gbWUuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkID0gY2hpbGQubmV4dFNpYmxpbmc7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBtZS5maXJlRXZlbnQoJ2FmdGVyc2V0Y29udGVudCcpOw0KICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCdjb250ZW50Y2hhbmdlJyk7DQoNCiAgICAgICAgICAgICFub3RGaXJlU2VsZWN0aW9uY2hhbmdlICYmIG1lLl9zZWxlY3Rpb25DaGFuZ2UoKTsNCiAgICAgICAgICAgIC8v5riF6Zmk5L+d5a2Y55qE6YCJ5Yy6DQogICAgICAgICAgICBtZS5fYmFrUmFuZ2UgPSBtZS5fYmFrSUVSYW5nZSA9IG1lLl9iYWtOYXRpdmVSYW5nZSA9IG51bGw7DQogICAgICAgICAgICAvL3RyYWNlOjE3NDIgc2V0Q29udGVudOWQjmdlY2tv6IO95b6X5Yiw54Sm54K56Zeu6aKYDQogICAgICAgICAgICB2YXIgZ2Vja29TZWw7DQogICAgICAgICAgICBpZiAoYnJvd3Nlci5nZWNrbyAmJiAoZ2Vja29TZWwgPSB0aGlzLnNlbGVjdGlvbi5nZXROYXRpdmUoKSkpIHsNCiAgICAgICAgICAgICAgICBnZWNrb1NlbC5yZW1vdmVBbGxSYW5nZXMoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmKG1lLm9wdGlvbnMuYXV0b1N5bmNEYXRhKXsNCiAgICAgICAgICAgICAgICBtZS5mb3JtICYmIHNldFZhbHVlKG1lLmZvcm0sbWUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiDorqnnvJbovpHlmajojrflvpfnhKbngrnvvIx0b0VuZOehruWummZvY3Vz5L2N572uDQogICAgICAgICAqIEBuYW1lIGZvY3VzDQogICAgICAgICAqIEBncmFtbWFyIGVkaXRvci5mb2N1cyhbdG9FbmRdKSAgIC8v6buY6K6kZm9jdXPliLDnvJbovpHlmajlpLTpg6jvvIx0b0VuZOS4unRydWXml7Zmb2N1c+WIsOWGheWuueWwvumDqA0KICAgICAgICAgKi8NCiAgICAgICAgZm9jdXM6IGZ1bmN0aW9uICh0b0VuZCkgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICB2YXIgbWUgPSB0aGlzLA0KICAgICAgICAgICAgICAgICAgICBybmcgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKTsNCiAgICAgICAgICAgICAgICBpZiAodG9FbmQpIHsNCiAgICAgICAgICAgICAgICAgICAgcm5nLnNldFN0YXJ0QXRMYXN0KG1lLmJvZHkubGFzdENoaWxkKS5zZXRDdXJzb3IoZmFsc2UsIHRydWUpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHJuZy5zZWxlY3QodHJ1ZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRoaXMuZmlyZUV2ZW50KCdmb2N1cycpOw0KICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiDliJ3lp4vljJZVReS6i+S7tuWPiumDqOWIhuS6i+S7tuS7o+eQhg0KICAgICAgICAgKiBAcHJpdmF0ZQ0KICAgICAgICAgKiBAaWdub3JlDQogICAgICAgICAqLw0KICAgICAgICBfaW5pdEV2ZW50czogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpcywNCiAgICAgICAgICAgICAgICBkb2MgPSBtZS5kb2N1bWVudCwNCiAgICAgICAgICAgICAgICB3aW4gPSBtZS53aW5kb3c7DQogICAgICAgICAgICBtZS5fcHJveHlEb21FdmVudCA9IHV0aWxzLmJpbmQobWUuX3Byb3h5RG9tRXZlbnQsIG1lKTsNCiAgICAgICAgICAgIGRvbVV0aWxzLm9uKGRvYywgWydjbGljaycsICdjb250ZXh0bWVudScsICdtb3VzZWRvd24nLCAna2V5ZG93bicsICdrZXl1cCcsICdrZXlwcmVzcycsICdtb3VzZXVwJywgJ21vdXNlb3ZlcicsICdtb3VzZW91dCcsICdzZWxlY3RzdGFydCddLCBtZS5fcHJveHlEb21FdmVudCk7DQogICAgICAgICAgICBkb21VdGlscy5vbih3aW4sIFsnZm9jdXMnLCAnYmx1ciddLCBtZS5fcHJveHlEb21FdmVudCk7DQogICAgICAgICAgICBkb21VdGlscy5vbihkb2MsIFsnbW91c2V1cCcsICdrZXlkb3duJ10sIGZ1bmN0aW9uIChldnQpIHsNCiAgICAgICAgICAgICAgICAvL+eJueauiumUruS4jeinpuWPkXNlbGVjdGlvbmNoYW5nZQ0KICAgICAgICAgICAgICAgIGlmIChldnQudHlwZSA9PSAna2V5ZG93bicgJiYgKGV2dC5jdHJsS2V5IHx8IGV2dC5tZXRhS2V5IHx8IGV2dC5zaGlmdEtleSB8fCBldnQuYWx0S2V5KSkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChldnQuYnV0dG9uID09IDIpcmV0dXJuOw0KICAgICAgICAgICAgICAgIG1lLl9zZWxlY3Rpb25DaGFuZ2UoMjUwLCBldnQpOw0KICAgICAgICAgICAgfSk7DQovLyAgICAgICAgICAgIC8v5aSE55CG5ouW5ou9DQovLyAgICAgICAgICAgIC8vaWUgZmbkuI3og73ku47lpJbovrnmi5blhaUNCi8vICAgICAgICAgICAgLy9jaHJvbWXlj6rpkojlr7nku47lpJbovrnmi5blhaXnmoTlhoXlrrnov4fmu6QNCi8vICAgICAgICAgICAgdmFyIGlubmVyRHJhZyA9IDAsIHNvdXJjZSA9IGJyb3dzZXIuaWUgPyBtZS5ib2R5IDogbWUuZG9jdW1lbnQsIGRyYWdvdmVySGFuZGxlcjsNCi8vICAgICAgICAgICAgZG9tVXRpbHMub24oc291cmNlLCAnZHJhZ3N0YXJ0JywgZnVuY3Rpb24gKCkgew0KLy8gICAgICAgICAgICAgICAgaW5uZXJEcmFnID0gMTsNCi8vICAgICAgICAgICAgfSk7DQovLyAgICAgICAgICAgIGRvbVV0aWxzLm9uKHNvdXJjZSwgYnJvd3Nlci53ZWJraXQgPyAnZHJhZ292ZXInIDogJ2Ryb3AnLCBmdW5jdGlvbiAoKSB7DQovLyAgICAgICAgICAgICAgICByZXR1cm4gYnJvd3Nlci53ZWJraXQgPw0KLy8gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsNCi8vICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGRyYWdvdmVySGFuZGxlcik7DQovLyAgICAgICAgICAgICAgICAgICAgICAgIGRyYWdvdmVySGFuZGxlciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgew0KLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpbm5lckRyYWcpIHsNCi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsID0gbWUuc2VsZWN0aW9uLA0KLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZSA9IHNlbC5nZXRSYW5nZSgpOw0KLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyYW5nZSkgew0KLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29tbW9uID0gcmFuZ2UuZ2V0Q29tbW9uQW5jZXN0b3IoKTsNCi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbW1vbiAmJiBtZS5zZXJpYWxpemUpIHsNCi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmID0gbWUuc2VyaWFsaXplLA0KLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPQ0KLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmLmZpbHRlcigNCi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYudHJhbnNmb3JtSW5wdXQoDQovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZi5wYXJzZUhUTUwoDQovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYud29yZChjb21tb24uaW5uZXJIVE1MKQ0KLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkNCi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkNCi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTsNCi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1vbi5pbm5lckhUTUwgPSBmLnRvSFRNTChub2RlKTsNCi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyRHJhZyA9IDA7DQovLyAgICAgICAgICAgICAgICAgICAgICAgIH0sIDIwMCk7DQovLyAgICAgICAgICAgICAgICAgICAgfSA6DQovLyAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGUpIHsNCi8vICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpbm5lckRyYWcpIHsNCi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQgPyBlLnByZXZlbnREZWZhdWx0KCkgOiAoZS5yZXR1cm5WYWx1ZSA9IGZhbHNlKTsNCi8vICAgICAgICAgICAgICAgICAgICAgICAgfQ0KLy8gICAgICAgICAgICAgICAgICAgICAgICBpbm5lckRyYWcgPSAwOw0KLy8gICAgICAgICAgICAgICAgICAgIH0NCi8vICAgICAgICAgICAgfSgpKTsNCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIOinpuWPkeS6i+S7tuS7o+eQhg0KICAgICAgICAgKiBAcHJpdmF0ZQ0KICAgICAgICAgKiBAaWdub3JlDQogICAgICAgICAqLw0KICAgICAgICBfcHJveHlEb21FdmVudDogZnVuY3Rpb24gKGV2dCkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmlyZUV2ZW50KGV2dC50eXBlLnJlcGxhY2UoL15vbi8sICcnKSwgZXZ0KTsNCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIOWPmOWMlumAieWMug0KICAgICAgICAgKiBAcHJpdmF0ZQ0KICAgICAgICAgKiBAaWdub3JlDQogICAgICAgICAqLw0KICAgICAgICBfc2VsZWN0aW9uQ2hhbmdlOiBmdW5jdGlvbiAoZGVsYXksIGV2dCkgew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpczsNCiAgICAgICAgICAgIC8v5pyJ5YWJ5qCH5omN5YGac2VsZWN0aW9uY2hhbmdlIOS4uuS6huino+WGs+acqmZvY3Vz5pe254K55Ye7c291cmNl5LiN6IO96Kem5Y+R5pu05pS55bel5YW35qCP54q25oCB55qE6Zeu6aKY77yIc291cmNl5ZG95Lukbm90TmVlZFVuZG89Me+8iQ0KLy8gICAgICAgICAgICBpZiAoICFtZS5zZWxlY3Rpb24uaXNGb2N1cygpICl7DQovLyAgICAgICAgICAgICAgICByZXR1cm47DQovLyAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICB2YXIgaGFja0Zvck1vdXNlVXAgPSBmYWxzZTsNCiAgICAgICAgICAgIHZhciBtb3VzZVgsIG1vdXNlWTsNCiAgICAgICAgICAgIGlmIChicm93c2VyLmllICYmIGJyb3dzZXIudmVyc2lvbiA8IDkgJiYgZXZ0ICYmIGV2dC50eXBlID09ICdtb3VzZXVwJykgew0KICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IHRoaXMuc2VsZWN0aW9uLmdldFJhbmdlKCk7DQogICAgICAgICAgICAgICAgaWYgKCFyYW5nZS5jb2xsYXBzZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgaGFja0Zvck1vdXNlVXAgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICBtb3VzZVggPSBldnQuY2xpZW50WDsNCiAgICAgICAgICAgICAgICAgICAgbW91c2VZID0gZXZ0LmNsaWVudFk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgY2xlYXJUaW1lb3V0KF9zZWxlY3Rpb25DaGFuZ2VUaW1lcik7DQogICAgICAgICAgICBfc2VsZWN0aW9uQ2hhbmdlVGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICBpZiAoIW1lLnNlbGVjdGlvbi5nZXROYXRpdmUoKSkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8v5L+u5aSN5LiA5LiqSUXkuIvnmoRidWc6IOm8oOagh+eCueWHu+S4gOauteW3sumAieaLqeeahOaWh+acrOS4remXtOaXtu+8jOWPr+iDveWcqG1vdXNldXDlkI7nmoTkuIDmrrXml7bpl7TlhoXlj5bliLDnmoRyYW5nZeaYr+WcqHNlbGVjdGlvbueahHR5cGXkuLpOb25l5LiL55qE6ZSZ6K+v5YC8Lg0KICAgICAgICAgICAgICAgIC8vSUXkuIvlpoLmnpznlKjmiLfmmK/mi5bmi73kuIDmrrXlt7LpgInmi6nmlofmnKzvvIzliJnkuI3kvJrop6blj5Ftb3VzZXVw5LqL5Lu277yM5omA5Lul6L+Z6YeM55qE54m55q6K5aSE55CG5LiN5Lya5a+55YW25pyJ5b2x5ZONDQogICAgICAgICAgICAgICAgdmFyIGllUmFuZ2U7DQogICAgICAgICAgICAgICAgaWYgKGhhY2tGb3JNb3VzZVVwICYmIG1lLnNlbGVjdGlvbi5nZXROYXRpdmUoKS50eXBlID09ICdOb25lJykgew0KICAgICAgICAgICAgICAgICAgICBpZVJhbmdlID0gbWUuZG9jdW1lbnQuYm9keS5jcmVhdGVUZXh0UmFuZ2UoKTsNCiAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGllUmFuZ2UubW92ZVRvUG9pbnQobW91c2VYLCBtb3VzZVkpOw0KICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChleCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWVSYW5nZSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdmFyIGJha0dldElFUmFuZ2U7DQogICAgICAgICAgICAgICAgaWYgKGllUmFuZ2UpIHsNCiAgICAgICAgICAgICAgICAgICAgYmFrR2V0SUVSYW5nZSA9IG1lLnNlbGVjdGlvbi5nZXRJRVJhbmdlOw0KICAgICAgICAgICAgICAgICAgICBtZS5zZWxlY3Rpb24uZ2V0SUVSYW5nZSA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpZVJhbmdlOw0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBtZS5zZWxlY3Rpb24uY2FjaGUoKTsNCiAgICAgICAgICAgICAgICBpZiAoYmFrR2V0SUVSYW5nZSkgew0KICAgICAgICAgICAgICAgICAgICBtZS5zZWxlY3Rpb24uZ2V0SUVSYW5nZSA9IGJha0dldElFUmFuZ2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChtZS5zZWxlY3Rpb24uX2NhY2hlZFJhbmdlICYmIG1lLnNlbGVjdGlvbi5fY2FjaGVkU3RhcnRFbGVtZW50KSB7DQogICAgICAgICAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnYmVmb3Jlc2VsZWN0aW9uY2hhbmdlJyk7DQogICAgICAgICAgICAgICAgICAgIC8vIOesrOS6jOS4quWPguaVsGNhdXNlQnlVaeS4unRydWXku6PooajnlLHnlKjmiLfkuqTkupLpgKDmiJDnmoRzZWxlY3Rpb25jaGFuZ2UuDQogICAgICAgICAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnc2VsZWN0aW9uY2hhbmdlJywgISFldnQpOw0KICAgICAgICAgICAgICAgICAgICBtZS5maXJlRXZlbnQoJ2FmdGVyc2VsZWN0aW9uY2hhbmdlJyk7DQogICAgICAgICAgICAgICAgICAgIG1lLnNlbGVjdGlvbi5jbGVhcigpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIGRlbGF5IHx8IDUwKTsNCiAgICAgICAgfSwNCiAgICAgICAgX2NhbGxDbWRGbjogZnVuY3Rpb24gKGZuTmFtZSwgYXJncykgew0KICAgICAgICAgICAgdmFyIGNtZE5hbWUgPSBhcmdzWzBdLnRvTG93ZXJDYXNlKCksDQogICAgICAgICAgICAgICAgY21kLCBjbWRGbjsNCiAgICAgICAgICAgIGNtZCA9IHRoaXMuY29tbWFuZHNbY21kTmFtZV0gfHwgVUUuY29tbWFuZHNbY21kTmFtZV07DQogICAgICAgICAgICBjbWRGbiA9IGNtZCAmJiBjbWRbZm5OYW1lXTsNCiAgICAgICAgICAgIC8v5rKh5pyJcXVlcnljb21tYW5kc3RhdGXmiJbogIXmsqHmnIljb21tYW5k55qE6YO96buY6K6k6L+U5ZueMA0KICAgICAgICAgICAgaWYgKCghY21kIHx8ICFjbWRGbikgJiYgZm5OYW1lID09ICdxdWVyeUNvbW1hbmRTdGF0ZScpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoY21kRm4pIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gY21kRm4uYXBwbHkodGhpcywgYXJncyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIOaJp+ihjOe8lui+keWRveS7pGNtZE5hbWXvvIzlrozmiJDlr4zmlofmnKznvJbovpHmlYjmnpwNCiAgICAgICAgICogQG5hbWUgZXhlY0NvbW1hbmQNCiAgICAgICAgICogQGdyYW1tYXIgZWRpdG9yLmV4ZWNDb21tYW5kKGNtZE5hbWUpICAgPT4geyp9DQogICAgICAgICAqLw0KICAgICAgICBleGVjQ29tbWFuZDogZnVuY3Rpb24gKGNtZE5hbWUpIHsNCiAgICAgICAgICAgIGNtZE5hbWUgPSBjbWROYW1lLnRvTG93ZXJDYXNlKCk7DQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzLA0KICAgICAgICAgICAgICAgIHJlc3VsdCwNCiAgICAgICAgICAgICAgICBjbWQgPSBtZS5jb21tYW5kc1tjbWROYW1lXSB8fCBVRS5jb21tYW5kc1tjbWROYW1lXTsNCiAgICAgICAgICAgIGlmICghY21kIHx8ICFjbWQuZXhlY0NvbW1hbmQpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICghY21kLm5vdE5lZWRVbmRvICYmICFtZS5fX2hhc0VudGVyRXhlY0NvbW1hbmQpIHsNCiAgICAgICAgICAgICAgICBtZS5fX2hhc0VudGVyRXhlY0NvbW1hbmQgPSB0cnVlOw0KICAgICAgICAgICAgICAgIGlmIChtZS5xdWVyeUNvbW1hbmRTdGF0ZS5hcHBseShtZSxhcmd1bWVudHMpICE9IC0xKSB7DQogICAgICAgICAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnYmVmb3JlZXhlY2NvbW1hbmQnLCBjbWROYW1lKTsNCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5fY2FsbENtZEZuKCdleGVjQ29tbWFuZCcsIGFyZ3VtZW50cyk7DQogICAgICAgICAgICAgICAgICAgICFtZS5faWdub3JlQ29udGVudENoYW5nZSAmJiBtZS5maXJlRXZlbnQoJ2NvbnRlbnRjaGFuZ2UnKTsNCiAgICAgICAgICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCdhZnRlcmV4ZWNjb21tYW5kJywgY21kTmFtZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIG1lLl9faGFzRW50ZXJFeGVjQ29tbWFuZCA9IGZhbHNlOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLl9jYWxsQ21kRm4oJ2V4ZWNDb21tYW5kJywgYXJndW1lbnRzKTsNCiAgICAgICAgICAgICAgICAhbWUuX2lnbm9yZUNvbnRlbnRDaGFuZ2UgJiYgbWUuZmlyZUV2ZW50KCdjb250ZW50Y2hhbmdlJykNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICFtZS5faWdub3JlQ29udGVudENoYW5nZSAmJiBtZS5fc2VsZWN0aW9uQ2hhbmdlKCk7DQogICAgICAgICAgICByZXR1cm4gcmVzdWx0Ow0KICAgICAgICB9LA0KICAgICAgICAvKioNCiAgICAgICAgICog5qC55o2u5Lyg5YWl55qEY29tbWFuZOWRveS7pO+8jOafpemAiee8lui+keWZqOW9k+WJjeeahOmAieWMuu+8jOi/lOWbnuWRveS7pOeahOeKtuaAgQ0KICAgICAgICAgKiBAbmFtZSAgcXVlcnlDb21tYW5kU3RhdGUNCiAgICAgICAgICogQGdyYW1tYXIgZWRpdG9yLnF1ZXJ5Q29tbWFuZFN0YXRlKGNtZE5hbWUpICA9PiAoLTF8MHwxKQ0KICAgICAgICAgKiBAZGVzYw0KICAgICAgICAgKiAqICcnLTEnJyDlvZPliY3lkb3ku6TkuI3lj6/nlKgNCiAgICAgICAgICogKiAnJzAnJyDlvZPliY3lkb3ku6Tlj6/nlKgNCiAgICAgICAgICogKiAnJzEnJyDlvZPliY3lkb3ku6Tlt7Lnu4/miafooYzov4fkuoYNCiAgICAgICAgICovDQogICAgICAgIHF1ZXJ5Q29tbWFuZFN0YXRlOiBmdW5jdGlvbiAoY21kTmFtZSkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NhbGxDbWRGbigncXVlcnlDb21tYW5kU3RhdGUnLCBhcmd1bWVudHMpOw0KICAgICAgICB9LA0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiDmoLnmja7kvKDlhaXnmoRjb21tYW5k5ZG95Luk77yM5p+l6YCJ57yW6L6R5Zmo5b2T5YmN55qE6YCJ5Yy677yM5qC55o2u5ZG95Luk6L+U5Zue55u45YWz55qE5YC8DQogICAgICAgICAqIEBuYW1lICBxdWVyeUNvbW1hbmRWYWx1ZQ0KICAgICAgICAgKiBAZ3JhbW1hciBlZGl0b3IucXVlcnlDb21tYW5kVmFsdWUoY21kTmFtZSkgID0+ICB7Kn0NCiAgICAgICAgICovDQogICAgICAgIHF1ZXJ5Q29tbWFuZFZhbHVlOiBmdW5jdGlvbiAoY21kTmFtZSkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NhbGxDbWRGbigncXVlcnlDb21tYW5kVmFsdWUnLCBhcmd1bWVudHMpOw0KICAgICAgICB9LA0KICAgICAgICAvKioNCiAgICAgICAgICog5qOA5p+l57yW6L6R5Yy65Z+f5Lit5piv5ZCm5pyJ5YaF5a6577yM6Iul5YyF5ZCrdGFnc+S4reeahOiKgueCueexu+Wei++8jOebtOaOpei/lOWbnnRydWUNCiAgICAgICAgICogQG5hbWUgIGhhc0NvbnRlbnRzDQogICAgICAgICAqIEBkZXNjDQogICAgICAgICAqIOm7mOiupOacieaWh+acrOWGheWuue+8jOaIluiAheacieS7peS4i+iKgueCuemDveS4jeiupOS4uuaYr+epug0KICAgICAgICAgKiA8Y29kZT57dGFibGU6MSx1bDoxLG9sOjEsZGw6MSxpZnJhbWU6MSxhcmVhOjEsYmFzZToxLGNvbDoxLGhyOjEsaW1nOjEsZW1iZWQ6MSxpbnB1dDoxLGxpbms6MSxtZXRhOjEscGFyYW06MX08L2NvZGU+DQogICAgICAgICAqIEBncmFtbWFyIGVkaXRvci5oYXNDb250ZW50cygpICA9PiAodHJ1ZXxmYWxzZSkNCiAgICAgICAgICogQGdyYW1tYXIgZWRpdG9yLmhhc0NvbnRlbnRzKHRhZ3MpICA9PiAgKHRydWV8ZmFsc2UpICAvL+iLpeaWh+aho+S4reWMheWQq3RhZ3PmlbDnu4Tph4zlr7nlupTnmoR0YWfvvIznm7TmjqXov5Tlm550cnVlDQogICAgICAgICAqIEBleGFtcGxlDQogICAgICAgICAqIGVkaXRvci5oYXNDb250ZW50cyhbJ3NwYW4nXSkgLy/lpoLmnpznvJbovpHlmajph4zmnInov5nkupvvvIzkuI3orqTkuLrmmK/nqboNCiAgICAgICAgICovDQogICAgICAgIGhhc0NvbnRlbnRzOiBmdW5jdGlvbiAodGFncykgew0KICAgICAgICAgICAgaWYgKHRhZ3MpIHsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgY2k7IGNpID0gdGFnc1tpKytdOykgew0KICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShjaSkubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIWRvbVV0aWxzLmlzRW1wdHlCbG9jayh0aGlzLmJvZHkpKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWUNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8v6ZqP5pe25re75YqgLOWumuS5ieeahOeJueauiuagh+etvuWmguaenOWtmOWcqO+8jOS4jeiDveiupOS4uuaYr+epug0KICAgICAgICAgICAgdGFncyA9IFsnZGl2J107DQogICAgICAgICAgICBmb3IgKGkgPSAwOyBjaSA9IHRhZ3NbaSsrXTspIHsNCiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSBkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZSh0aGlzLmRvY3VtZW50LCBjaSk7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgbiA9IDAsIGNuOyBjbiA9IG5vZGVzW24rK107KSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChkb21VdGlscy5pc0N1c3RvbWVOb2RlKGNuKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDph43nva7nvJbovpHlmajvvIzlj6/nlKjmnaXlgZrlpJrkuKp0YWLkvb/nlKjlkIzkuIDkuKrnvJbovpHlmajlrp7kvosNCiAgICAgICAgICogQG5hbWUgIHJlc2V0DQogICAgICAgICAqIEBkZXNjDQogICAgICAgICAqICog5riF56m657yW6L6R5Zmo5YaF5a65DQogICAgICAgICAqICog5riF56m65Zue6YCA5YiX6KGoDQogICAgICAgICAqIEBncmFtbWFyIGVkaXRvci5yZXNldCgpDQogICAgICAgICAqLw0KICAgICAgICByZXNldDogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdGhpcy5maXJlRXZlbnQoJ3Jlc2V0Jyk7DQogICAgICAgIH0sDQogICAgICAgIHNldEVuYWJsZWQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBtZSA9IHRoaXMsIHJhbmdlOw0KICAgICAgICAgICAgaWYgKG1lLmJvZHkuY29udGVudEVkaXRhYmxlID09ICdmYWxzZScpIHsNCiAgICAgICAgICAgICAgICBtZS5ib2R5LmNvbnRlbnRFZGl0YWJsZSA9IHRydWU7DQogICAgICAgICAgICAgICAgcmFuZ2UgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKTsNCiAgICAgICAgICAgICAgICAvL+acieWPr+iDveWGheWuueS4ouWkseS6hg0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIHJhbmdlLm1vdmVUb0Jvb2ttYXJrKG1lLmxhc3RCayk7DQogICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBtZS5sYXN0QmsNCiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0QXRGaXJzdChtZS5ib2R5KS5jb2xsYXBzZSh0cnVlKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICByYW5nZS5zZWxlY3QodHJ1ZSk7DQogICAgICAgICAgICAgICAgaWYgKG1lLmJrcXVlcnlDb21tYW5kU3RhdGUpIHsNCiAgICAgICAgICAgICAgICAgICAgbWUucXVlcnlDb21tYW5kU3RhdGUgPSBtZS5ia3F1ZXJ5Q29tbWFuZFN0YXRlOw0KICAgICAgICAgICAgICAgICAgICBkZWxldGUgbWUuYmtxdWVyeUNvbW1hbmRTdGF0ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCdzZWxlY3Rpb25jaGFuZ2UnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIOiuvue9ruW9k+WJjee8lui+keWMuuWfn+WPr+S7pee8lui+kQ0KICAgICAgICAgKiBAbmFtZSBlbmFibGUNCiAgICAgICAgICogQGdyYW1tYXIgZWRpdG9yLmVuYWJsZSgpDQogICAgICAgICAqLw0KICAgICAgICBlbmFibGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldEVuYWJsZWQoKTsNCiAgICAgICAgfSwNCiAgICAgICAgc2V0RGlzYWJsZWQ6IGZ1bmN0aW9uIChleGNlcHQpIHsNCiAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7DQogICAgICAgICAgICBleGNlcHQgPSBleGNlcHQgPyB1dGlscy5pc0FycmF5KGV4Y2VwdCkgPyBleGNlcHQgOiBbZXhjZXB0XSA6IFtdOw0KICAgICAgICAgICAgaWYgKG1lLmJvZHkuY29udGVudEVkaXRhYmxlID09ICd0cnVlJykgew0KICAgICAgICAgICAgICAgIGlmICghbWUubGFzdEJrKSB7DQogICAgICAgICAgICAgICAgICAgIG1lLmxhc3RCayA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpLmNyZWF0ZUJvb2ttYXJrKHRydWUpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBtZS5ib2R5LmNvbnRlbnRFZGl0YWJsZSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgIG1lLmJrcXVlcnlDb21tYW5kU3RhdGUgPSBtZS5xdWVyeUNvbW1hbmRTdGF0ZTsNCiAgICAgICAgICAgICAgICBtZS5xdWVyeUNvbW1hbmRTdGF0ZSA9IGZ1bmN0aW9uICh0eXBlKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICh1dGlscy5pbmRleE9mKGV4Y2VwdCwgdHlwZSkgIT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtZS5ia3F1ZXJ5Q29tbWFuZFN0YXRlLmFwcGx5KG1lLCBhcmd1bWVudHMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnc2VsZWN0aW9uY2hhbmdlJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIC8qKiDorr7nva7lvZPliY3nvJbovpHljLrln5/kuI3lj6/nvJbovpEsZXhjZXB05Lit55qE5ZG95Luk6Zmk5aSWDQogICAgICAgICAqIEBuYW1lIGRpc2FibGUNCiAgICAgICAgICogQGdyYW1tYXIgZWRpdG9yLmRpc2FibGUoKQ0KICAgICAgICAgKiBAZ3JhbW1hciBlZGl0b3IuZGlzYWJsZShleGNlcHQpICAvL+S+i+WklueahOWRveS7pO+8jOS5n+WNs+WNs+S9v+iuvue9ruS6hmRpc2FibGXvvIzmraTlpITphY3nva7nmoTlkb3ku6Tku43nhLblj6/ku6XmiafooYwNCiAgICAgICAgICogQGV4YW1wbGUNCiAgICAgICAgICogLy/npoHnlKjlt6XlhbfmoI/kuK3pmaTliqDnspflkozmj5LlhaXlm77niYfkuYvlpJbnmoTmiYDmnInlip/og70NCiAgICAgICAgICogZWRpdG9yLmRpc2FibGUoWydib2xkJywnaW5zZXJ0aW1hZ2UnXSk7Ly/lj6/ku6XmmK/ljZXkuIDnmoRTdHJpbmcs5Lmf5Y+v5Lul5pivQXJyYXkNCiAgICAgICAgICovDQogICAgICAgIGRpc2FibGU6IGZ1bmN0aW9uIChleGNlcHQpIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldERpc2FibGVkKGV4Y2VwdCk7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDorr7nva7pu5jorqTlhoXlrrkNCiAgICAgICAgICogQGlnbm9yZQ0KICAgICAgICAgKiBAcHJpdmF0ZQ0KICAgICAgICAgKiBAcGFyYW0gIHtTdHJpbmd9IGNvbnQg6KaB5a2Y5YWl55qE5YaF5a65DQogICAgICAgICAqLw0KICAgICAgICBfc2V0RGVmYXVsdENvbnRlbnQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIGZ1bmN0aW9uIGNsZWFyKCkgew0KICAgICAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7DQogICAgICAgICAgICAgICAgaWYgKG1lLmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbml0Q29udGVudCcpKSB7DQogICAgICAgICAgICAgICAgICAgIG1lLmJvZHkuaW5uZXJIVE1MID0gJzxwPicgKyAoaWUgPyAnJyA6ICc8YnIvPicpICsgJzwvcD4nOw0KICAgICAgICAgICAgICAgICAgICBtZS5yZW1vdmVMaXN0ZW5lcignZmlyc3RCZWZvcmVFeGVjQ29tbWFuZCBmb2N1cycsIGNsZWFyKTsNCiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBtZS5mb2N1cygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuX3NlbGVjdGlvbkNoYW5nZSgpOw0KICAgICAgICAgICAgICAgICAgICB9LCAwKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjb250KSB7DQogICAgICAgICAgICAgICAgdmFyIG1lID0gdGhpczsNCiAgICAgICAgICAgICAgICBtZS5ib2R5LmlubmVySFRNTCA9ICc8cCBpZD0iaW5pdENvbnRlbnQiPicgKyBjb250ICsgJzwvcD4nOw0KDQogICAgICAgICAgICAgICAgbWUuYWRkTGlzdGVuZXIoJ2ZpcnN0QmVmb3JlRXhlY0NvbW1hbmQgZm9jdXMnLCBjbGVhcik7DQogICAgICAgICAgICB9DQogICAgICAgIH0oKSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIHNob3fmlrnms5XnmoTlhbzlrrnniYjmnKwNCiAgICAgICAgICogQHByaXZhdGUNCiAgICAgICAgICogQGlnbm9yZQ0KICAgICAgICAgKi8NCiAgICAgICAgc2V0U2hvdzogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpcywgcmFuZ2UgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKTsNCiAgICAgICAgICAgIGlmIChtZS5jb250YWluZXIuc3R5bGUuZGlzcGxheSA9PSAnbm9uZScpIHsNCiAgICAgICAgICAgICAgICAvL+acieWPr+iDveWGheWuueS4ouWkseS6hg0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIHJhbmdlLm1vdmVUb0Jvb2ttYXJrKG1lLmxhc3RCayk7DQogICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBtZS5sYXN0QmsNCiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0QXRGaXJzdChtZS5ib2R5KS5jb2xsYXBzZSh0cnVlKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAvL2ll5LiLZm9jdXPlrp7mlYjvvIzmiYDku6XlgZrkuobkuKrlu7bov58NCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2VsZWN0KHRydWUpOw0KICAgICAgICAgICAgICAgIH0sIDEwMCk7DQogICAgICAgICAgICAgICAgbWUuY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnJzsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9LA0KICAgICAgICAvKioNCiAgICAgICAgICog5pi+56S657yW6L6R5ZmoDQogICAgICAgICAqIEBuYW1lIHNob3cNCiAgICAgICAgICogQGdyYW1tYXIgZWRpdG9yLnNob3coKQ0KICAgICAgICAgKi8NCiAgICAgICAgc2hvdzogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0U2hvdygpOw0KICAgICAgICB9LA0KICAgICAgICAvKioNCiAgICAgICAgICogaGlkZeaWueazleeahOWFvOWuueeJiOacrA0KICAgICAgICAgKiBAcHJpdmF0ZQ0KICAgICAgICAgKiBAaWdub3JlDQogICAgICAgICAqLw0KICAgICAgICBzZXRIaWRlOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzOw0KICAgICAgICAgICAgaWYgKCFtZS5sYXN0QmspIHsNCiAgICAgICAgICAgICAgICBtZS5sYXN0QmsgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKS5jcmVhdGVCb29rbWFyayh0cnVlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIG1lLmNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnDQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDpmpDol4/nvJbovpHlmagNCiAgICAgICAgICogQG5hbWUgaGlkZQ0KICAgICAgICAgKiBAZ3JhbW1hciBlZGl0b3IuaGlkZSgpDQogICAgICAgICAqLw0KICAgICAgICBoaWRlOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRIaWRlKCk7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDmoLnmja7liLblrprnmoTot6/lvoTvvIzojrflj5blr7nlupTnmoTor63oqIDotYTmupANCiAgICAgICAgICogQG5hbWUgIGdldExhbmcNCiAgICAgICAgICogQGdyYW1tYXIgZWRpdG9yLmdldExhbmcocGF0aCkgID0+ICDvvIhKU09OfFN0cmluZykg6Lev5b6E5qC55o2u55qE5pivbGFuZ+ebruW9leS4i+eahOivreiogOaWh+S7tueahOi3r+W+hOe7k+aehA0KICAgICAgICAgKiBAZXhhbXBsZQ0KICAgICAgICAgKiBlZGl0b3IuZ2V0TGFuZygnY29udGV4dE1lbnUuZGVsZXRlJykgLy/lpoLmnpzlvZPliY3mmK/kuK3mlofvvIzpgqPov5Tlm57mmK/nmoTmmK/liKDpmaQNCiAgICAgICAgICovDQogICAgICAgIGdldExhbmc6IGZ1bmN0aW9uIChwYXRoKSB7DQogICAgICAgICAgICB2YXIgbGFuZyA9IFVFLkkxOE5bdGhpcy5vcHRpb25zLmxhbmddOw0KICAgICAgICAgICAgaWYgKCFsYW5nKSB7DQogICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoIm5vdCBpbXBvcnQgbGFuZ3VhZ2UgZmlsZSIpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcGF0aCA9IChwYXRoIHx8ICIiKS5zcGxpdCgiLiIpOw0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNpOyBjaSA9IHBhdGhbaSsrXTspIHsNCiAgICAgICAgICAgICAgICBsYW5nID0gbGFuZ1tjaV07DQogICAgICAgICAgICAgICAgaWYgKCFsYW5nKWJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGxhbmc7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDorqHnrpfnvJbovpHlmajlvZPliY3lhoXlrrnnmoTplb/luqYNCiAgICAgICAgICogQG5hbWUgIGdldENvbnRlbnRMZW5ndGgNCiAgICAgICAgICogQGdyYW1tYXIgZWRpdG9yLmdldENvbnRlbnRMZW5ndGgoaW5nb25lSHRtbCx0YWdOYW1lcykgID0+DQogICAgICAgICAqIEBleGFtcGxlDQogICAgICAgICAqIGVkaXRvci5nZXRMYW5nKHRydWUpDQogICAgICAgICAqLw0KICAgICAgICBnZXRDb250ZW50TGVuZ3RoOiBmdW5jdGlvbiAoaW5nb25lSHRtbCwgdGFnTmFtZXMpIHsNCiAgICAgICAgICAgIHZhciBjb3VudCA9IHRoaXMuZ2V0Q29udGVudChmYWxzZSxmYWxzZSx0cnVlKS5sZW5ndGg7DQogICAgICAgICAgICBpZiAoaW5nb25lSHRtbCkgew0KICAgICAgICAgICAgICAgIHRhZ05hbWVzID0gKHRhZ05hbWVzIHx8IFtdKS5jb25jYXQoWyAnaHInLCAnaW1nJywgJ2lmcmFtZSddKTsNCiAgICAgICAgICAgICAgICBjb3VudCA9IHRoaXMuZ2V0Q29udGVudFR4dCgpLnJlcGxhY2UoL1tcdFxyXG5dKy9nLCAnJykubGVuZ3RoOw0KICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjaTsgY2kgPSB0YWdOYW1lc1tpKytdOykgew0KICAgICAgICAgICAgICAgICAgICBjb3VudCArPSB0aGlzLmRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKGNpKS5sZW5ndGg7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGNvdW50Ow0KICAgICAgICB9LA0KICAgICAgICBhZGRJbnB1dFJ1bGU6IGZ1bmN0aW9uIChydWxlKSB7DQogICAgICAgICAgICB0aGlzLmlucHV0UnVsZXMucHVzaChydWxlKTsNCiAgICAgICAgfSwNCiAgICAgICAgZmlsdGVySW5wdXRSdWxlOiBmdW5jdGlvbiAocm9vdCkgew0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNpOyBjaSA9IHRoaXMuaW5wdXRSdWxlc1tpKytdOykgew0KICAgICAgICAgICAgICAgIGNpLmNhbGwodGhpcywgcm9vdCkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgYWRkT3V0cHV0UnVsZTogZnVuY3Rpb24gKHJ1bGUpIHsNCiAgICAgICAgICAgIHRoaXMub3V0cHV0UnVsZXMucHVzaChydWxlKQ0KICAgICAgICB9LA0KICAgICAgICBmaWx0ZXJPdXRwdXRSdWxlOiBmdW5jdGlvbiAocm9vdCkgew0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNpOyBjaSA9IHRoaXMub3V0cHV0UnVsZXNbaSsrXTspIHsNCiAgICAgICAgICAgICAgICBjaS5jYWxsKHRoaXMsIHJvb3QpDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgLyoqDQogICAgICAgICAqIOW+l+WIsGRpYWxvZ+WunuS+i+WvueixoQ0KICAgICAgICAgKiBAbmFtZSBnZXREaWFsb2cNCiAgICAgICAgICogQGdyYW1tYXIgZWRpdG9yLmdldERpYWxvZyhkaWFsb2dOYW1lKSA9PiBPYmplY3QNCiAgICAgICAgICogQGV4YW1wbGUNCiAgICAgICAgICogdmFyIGRpYWxvZyA9IGVkaXRvci5nZXREaWFsb2coImluc2VydGltYWdlIik7DQogICAgICAgICAqIGRpYWxvZy5vcGVuKCk7ICAgLy/miZPlvIBkaWFsb2cNCiAgICAgICAgICogZGlhbG9nLmNsb3NlKCk7ICAvL+WFs+mXrWRpYWxvZw0KICAgICAgICAgKi8NCiAgICB9Ow0KICAgIHV0aWxzLmluaGVyaXRzKEVkaXRvciwgRXZlbnRCYXNlKTsNCn0pKCk7DQoKLyoqDQogKiBAZmlsZQ0KICogQG5hbWUgVUUuYWpheA0KICogQHNob3J0IEFqYXgNCiAqIEBkZXNjIFVFZGl0b3LlhoXnva7nmoRhamF46K+35rGC5qih5Z2XDQogKiBAaW1wb3J0IGNvcmUvdXRpbHMuanMNCiAqIEB1c2VyOiB0YW9xaWxpDQogKiBAZGF0ZTogMTEtOC0xOA0KICogQHRpbWU6IOS4i+WNiDM6MTgNCiAqLw0KVUUuYWpheCA9IGZ1bmN0aW9uKCkgew0KICAgIC8qKg0KICAgICAqIOWIm+W7uuS4gOS4qmFqYXhSZXF1ZXN05a+56LGhDQogICAgICovDQogICAgdmFyIGZuU3RyID0gJ1hNTEh0dHBSZXF1ZXN0KCknOw0KICAgIHRyeSB7DQogICAgICAgIG5ldyBBY3RpdmVYT2JqZWN0KCJNc3htbDIuWE1MSFRUUCIpOw0KICAgICAgICBmblN0ciA9ICdBY3RpdmVYT2JqZWN0KFwnTXN4bWwyLlhNTEhUVFBcJyknOw0KICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIG5ldyBBY3RpdmVYT2JqZWN0KCJNaWNyb3NvZnQuWE1MSFRUUCIpOw0KICAgICAgICAgICAgZm5TdHIgPSAnQWN0aXZlWE9iamVjdChcJ01pY3Jvc29mdC5YTUxIVFRQXCcpJw0KICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgIH0NCiAgICB9DQogICAgdmFyIGNyZWF0QWpheFJlcXVlc3QgPSBuZXcgRnVuY3Rpb24oJ3JldHVybiBuZXcgJyArIGZuU3RyKTsNCg0KDQogICAgLyoqDQogICAgICog5bCGanNvbuWPguaVsOi9rOWMluaIkOmAguWQiGFqYXjmj5DkuqTnmoTlj4LmlbDliJfooagNCiAgICAgKiBAcGFyYW0ganNvbg0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGpzb24yc3RyKGpzb24pIHsNCiAgICAgICAgdmFyIHN0ckFyciA9IFtdOw0KICAgICAgICBmb3IgKHZhciBpIGluIGpzb24pIHsNCiAgICAgICAgICAgIC8v5b+955Wl6buY6K6k55qE5Yeg5Liq5Y+C5pWwDQogICAgICAgICAgICBpZihpPT0ibWV0aG9kIiB8fCBpPT0idGltZW91dCIgfHwgaT09ImFzeW5jIikgY29udGludWU7DQogICAgICAgICAgICAvL+S8oOmAkui/h+adpeeahOWvueixoeWSjOWHveaVsOS4jeWcqOaPkOS6pOS5i+WIlw0KICAgICAgICAgICAgaWYgKCEoKHR5cGVvZiBqc29uW2ldKS50b0xvd2VyQ2FzZSgpID09ICJmdW5jdGlvbiIgfHwgKHR5cGVvZiBqc29uW2ldKS50b0xvd2VyQ2FzZSgpID09ICJvYmplY3QiKSkgew0KICAgICAgICAgICAgICAgIHN0ckFyci5wdXNoKCBlbmNvZGVVUklDb21wb25lbnQoaSkgKyAiPSIrZW5jb2RlVVJJQ29tcG9uZW50KGpzb25baV0pICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHN0ckFyci5qb2luKCImIik7DQoNCiAgICB9DQoNCg0KICAgIHJldHVybiB7DQoJCS8qKg0KICAgICAgICAgKiBAbmFtZSByZXF1ZXN0DQogICAgICAgICAqIEBkZXNjIOWPkeWHumFqYXjor7fmsYLvvIxhamF4T3B05Lit6buY6K6k5YyF5ZCrbWV0aG9k77yMdGltZW91dO+8jGFzeW5j77yMZGF0Ye+8jG9uc3VjY2Vzc+S7peWPim9uZXJyb3LnrYnlha3kuKrvvIzmlK/mjIHoh6rlrprkuYnmt7vliqDlj4LmlbANCiAgICAgICAgICogQGdyYW1tYXIgVUUuYWpheC5yZXF1ZXN0KHVybCxhamF4T3B0KTsNCiAgICAgICAgICogQGV4YW1wbGUNCiAgICAgICAgICogVUUuYWpheC5yZXF1ZXN0KCdodHRwOi8vd3d3Lnh4eHguY29tL3Rlc3QucGhwJyx7DQogICAgICAgICAqICAgICAvL+WPr+ecgeeVpe+8jOm7mOiupFBPU1QNCiAgICAgICAgICogICAgIG1ldGhvZDonUE9TVCcsDQogICAgICAgICAqICAgICAvL+WPr+S7peiHquWumuS5ieWPguaVsA0KICAgICAgICAgKiAgICAgY29udGVudDon6L+Z6YeM5piv5o+Q5Lqk55qE5YaF5a65JywNCiAgICAgICAgICogICAgIC8v5Lmf5Y+v5Lul55u05o6l5LyganNvbu+8jOS9huaYr+WPquiDveWRveWQjeS4umRhdGHvvIzlkKbliJnlvZPlgZrkuIDoiKzlrZfnrKbkuLLlpITnkIYNCiAgICAgICAgICogICAgIGRhdGE6ew0KICAgICAgICAgKiAgICAgICAgIG5hbWU6J1VFZGl0b3InLA0KICAgICAgICAgKiAgICAgICAgIGFnZTonMScNCiAgICAgICAgICogICAgIH0NCiAgICAgICAgICogICAgIG9uc3VjY2VzczpmdW5jdGlvbih4aHIpew0KICAgICAgICAgKiAgICAgICAgIGNvbnNvbGUubG9nKHhoci5yZXNwb25zZVRleHQpOw0KICAgICAgICAgKiAgICAgfSwNCiAgICAgICAgICogICAgIG9uZXJyb3I6ZnVuY3Rpb24oeGhyKXsNCiAgICAgICAgICogICAgICAgICBjb25zb2xlLmxvZyh4aHIucmVzcG9uc2VUZXh0KTsNCiAgICAgICAgICogICAgIH0NCiAgICAgICAgICogfSkNCgkJICogQHBhcmFtIGFqYXhPcHRpb25zDQoJCSAqLw0KCQlyZXF1ZXN0OmZ1bmN0aW9uKHVybCwgYWpheE9wdGlvbnMpIHsNCiAgICAgICAgICAgIHZhciBhamF4UmVxdWVzdCA9IGNyZWF0QWpheFJlcXVlc3QoKSwNCiAgICAgICAgICAgICAgICAvL+aYr+WQpui2heaXtg0KICAgICAgICAgICAgICAgIHRpbWVJc091dCA9IGZhbHNlLA0KICAgICAgICAgICAgICAgIC8v6buY6K6k5Y+C5pWwDQogICAgICAgICAgICAgICAgZGVmYXVsdEFqYXhPcHRpb25zID0gew0KICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IlBPU1QiLA0KICAgICAgICAgICAgICAgICAgICB0aW1lb3V0OjUwMDAsDQogICAgICAgICAgICAgICAgICAgIGFzeW5jOnRydWUsDQogICAgICAgICAgICAgICAgICAgIGRhdGE6e30sLy/pnIDopoHkvKDpgJLlr7nosaHnmoTor53lj6rog73opobnm5YNCiAgICAgICAgICAgICAgICAgICAgb25zdWNjZXNzOmZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICBvbmVycm9yOmZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfTsNCg0KCQkJaWYgKHR5cGVvZiB1cmwgPT09ICJvYmplY3QiKSB7DQoJCQkJYWpheE9wdGlvbnMgPSB1cmw7DQoJCQkJdXJsID0gYWpheE9wdGlvbnMudXJsOw0KCQkJfQ0KCQkJaWYgKCFhamF4UmVxdWVzdCB8fCAhdXJsKSByZXR1cm47DQoJCQl2YXIgYWpheE9wdHMgPSBhamF4T3B0aW9ucyA/IHV0aWxzLmV4dGVuZChkZWZhdWx0QWpheE9wdGlvbnMsYWpheE9wdGlvbnMpIDogZGVmYXVsdEFqYXhPcHRpb25zOw0KDQoJCQl2YXIgc3VibWl0U3RyID0ganNvbjJzdHIoYWpheE9wdHMpOyAgLy8geyBuYW1lOiJKaW0iLGNpdHk6IkJlaWppbmciIH0gLS0+ICJuYW1lPUppbSZjaXR5PUJlaWppbmciDQoJCQkvL+WmguaenOeUqOaIt+ebtOaOpemAmui/h2RhdGHlj4LmlbDkvKDpgJJqc29u5a+56LGh6L+H5p2l77yM5YiZ5Lmf6KaB5bCG5q2kanNvbuWvueixoei9rOWMluS4uuWtl+espuS4sg0KCQkJaWYgKCF1dGlscy5pc0VtcHR5T2JqZWN0KGFqYXhPcHRzLmRhdGEpKXsNCiAgICAgICAgICAgICAgICBzdWJtaXRTdHIgKz0gKHN1Ym1pdFN0cj8gIiYiOiIiKSArIGpzb24yc3RyKGFqYXhPcHRzLmRhdGEpOw0KCQkJfQ0KICAgICAgICAgICAgLy/otoXml7bmo4DmtYsNCiAgICAgICAgICAgIHZhciB0aW1lcklEID0gc2V0VGltZW91dChmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBpZiAoYWpheFJlcXVlc3QucmVhZHlTdGF0ZSAhPSA0KSB7DQogICAgICAgICAgICAgICAgICAgIHRpbWVJc091dCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIGFqYXhSZXF1ZXN0LmFib3J0KCk7DQogICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lcklEKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCBhamF4T3B0cy50aW1lb3V0KTsNCg0KCQkJdmFyIG1ldGhvZCA9IGFqYXhPcHRzLm1ldGhvZC50b1VwcGVyQ2FzZSgpOw0KICAgICAgICAgICAgdmFyIHN0ciA9IHVybCArICh1cmwuaW5kZXhPZigiPyIpPT0tMT8iPyI6IiYiKSArIChtZXRob2Q9PSJQT1NUIj8iIjpzdWJtaXRTdHIrICImbm9DYWNoZT0iICsgK25ldyBEYXRlKTsNCgkJCWFqYXhSZXF1ZXN0Lm9wZW4obWV0aG9kLCBzdHIsIGFqYXhPcHRzLmFzeW5jKTsNCgkJCWFqYXhSZXF1ZXN0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkgew0KCQkJCWlmIChhamF4UmVxdWVzdC5yZWFkeVN0YXRlID09IDQpIHsNCgkJCQkJaWYgKCF0aW1lSXNPdXQgJiYgYWpheFJlcXVlc3Quc3RhdHVzID09IDIwMCkgew0KCQkJCQkJYWpheE9wdHMub25zdWNjZXNzKGFqYXhSZXF1ZXN0KTsNCgkJCQkJfSBlbHNlIHsNCgkJCQkJCWFqYXhPcHRzLm9uZXJyb3IoYWpheFJlcXVlc3QpOw0KCQkJCQl9DQoJCQkJfQ0KCQkJfTsNCgkJCWlmIChtZXRob2QgPT0gIlBPU1QiKSB7DQoJCQkJYWpheFJlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcpOw0KCQkJCWFqYXhSZXF1ZXN0LnNlbmQoc3VibWl0U3RyKTsNCgkJCX0gZWxzZSB7DQoJCQkJYWpheFJlcXVlc3Quc2VuZChudWxsKTsNCgkJCX0NCgkJfQ0KCX07DQoNCg0KfSgpOw0KCi8qKg0KICogQGZpbGUNCiAqIEBuYW1lIFVFLmZpbHRlcldvcmQNCiAqIEBzaG9ydCBmaWx0ZXJXb3JkDQogKiBAZGVzYyDnlKjmnaXov4fmu6R3b3Jk57KY6LS06L+H5p2l55qE5a2X56ym5LiyDQogKiBAaW1wb3J0IGVkaXRvci5qcyxjb3JlL3V0aWxzLmpzDQogKiBAYW50aG9yIHpoYW55aQ0KICovDQp2YXIgZmlsdGVyV29yZCA9IFVFLmZpbHRlcldvcmQgPSBmdW5jdGlvbiAoKSB7DQoNCiAgICAvL+aYr+WQpuaYr3dvcmTov4fmnaXnmoTlhoXlrrkNCiAgICBmdW5jdGlvbiBpc1dvcmREb2N1bWVudCggc3RyICkgew0KICAgICAgICByZXR1cm4gLyhjbGFzcz0iP01zb3xzdHlsZT0iW14iXSpcYm1zb1wtfHc6V29yZERvY3VtZW50fDx2OikvaWcudGVzdCggc3RyICk7DQogICAgfQ0KICAgIC8v5Y675o6J5bCP5pWwDQogICAgZnVuY3Rpb24gdHJhbnNVbml0KCB2ICkgew0KICAgICAgICB2ID0gdi5yZXBsYWNlKCAvW1xkLl0rXHcrL2csIGZ1bmN0aW9uICggbSApIHsNCiAgICAgICAgICAgIHJldHVybiB1dGlscy50cmFuc1VuaXRUb1B4KG0pOw0KICAgICAgICB9ICk7DQogICAgICAgIHJldHVybiB2Ow0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGZpbHRlclBhc3RlV29yZCggc3RyICkgew0KICAgICAgICByZXR1cm4gc3RyLnJlcGxhY2UoIC9bXHRcclxuXSsvZywgIiIgKQ0KICAgICAgICAgICAgICAgIC5yZXBsYWNlKCAvPCEtLVtcc1xTXSo/LS0+L2lnLCAiIiApDQogICAgICAgICAgICAgICAgLy/ovazmjaLlm77niYcNCiAgICAgICAgICAgICAgICAucmVwbGFjZSgvPHY6c2hhcGUgW14+XSo+W1xzXFNdKj8uPFwvdjpzaGFwZT4vZ2ksZnVuY3Rpb24oc3RyKXsNCiAgICAgICAgICAgICAgICAgICAgLy9vcGVyYeiDveiHquW3seino+aekOWHumltYWdl5omA6L+Z6YeM55u05o6l6L+U5Zue56m6DQogICAgICAgICAgICAgICAgICAgIGlmKGJyb3dzZXIub3BlcmEpew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRyeXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHN0ci5tYXRjaCgvd2lkdGg6KFsgXGQuXSpwW3R4XSkvaSlbMV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gc3RyLm1hdGNoKC9oZWlnaHQ6KFsgXGQuXSpwW3R4XSkvaSlbMV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjID0gIHN0ci5tYXRjaCgvc3JjPVxzKiIoW14iXSopIi9pKVsxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnPGltZyB3aWR0aD0iJysgdHJhbnNVbml0KHdpZHRoKSArJyIgaGVpZ2h0PSInK3RyYW5zVW5pdChoZWlnaHQpICsnIiBzcmM9IicgKyBzcmMgKyAnIiAvPic7DQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2goZSl7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyc7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgIC8v6ZKI5a+5d3Bz5re75Yqg55qE5aSa5L2Z5qCH562+5aSE55CGDQogICAgICAgICAgICAgICAgLnJlcGxhY2UoLzxcLz9kaXZbXj5dKj4vZywnJykNCiAgICAgICAgICAgICAgICAvL+WOu+aOieWkmuS9meeahOWxnuaApw0KICAgICAgICAgICAgICAgIC5yZXBsYWNlKCAvdjpcdys9KFsiJ10/KVteJyJdK1wxL2csICcnICkNCiAgICAgICAgICAgICAgICAucmVwbGFjZSggLzwoIXxzY3JpcHRbXj5dKj4uKj88XC9zY3JpcHQoPz1bPlxzXSl8XC8/KFw/eG1sKDpcdyspP3x4bWx8bWV0YXxsaW5rfHN0eWxlfFx3KzpcdyspKD89W1xzXC8+XSkpW14+XSo+L2dpLCAiIiApDQogICAgICAgICAgICAgICAgLnJlcGxhY2UoIC88cCBbXj5dKmNsYXNzPSI/TXNvSGVhZGluZyI/W14+XSo+KC4qPyk8XC9wPi9naSwgIjxwPjxzdHJvbmc+JDE8L3N0cm9uZz48L3A+IiApDQogICAgICAgICAgICAgICAgLy/ljrvmjonlpJrkvZnnmoTlsZ7mgKcNCiAgICAgICAgICAgICAgICAucmVwbGFjZSggL1xzKyhjbGFzc3xsYW5nfGFsaWduKVxzKj1ccyooWyciXT8pKFtcdy1dKylcMi9pZywgZnVuY3Rpb24oc3RyLG5hbWUsbWFya3MsdmFsKXsNCiAgICAgICAgICAgICAgICAgICAgLy/kv53nlZlsaXN055qE5qCH56S6DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBuYW1lID09ICdjbGFzcycgJiYgdmFsID09ICdNc29MaXN0UGFyYWdyYXBoJyA/IHN0ciA6ICcnDQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAvL+a4hemZpOWkmuS9meeahGZvbnQvc3BhbuS4jeiDveWMuemFjSZuYnNwO+acieWPr+iDveaYr+epuuagvA0KICAgICAgICAgICAgICAgIC5yZXBsYWNlKCAvPChmb250fHNwYW4pW14+XSo+XHMqPFwvXDE+L2dpLCAnJyApDQogICAgICAgICAgICAgICAgLy/lpITnkIZzdHlsZeeahOmXrumimA0KICAgICAgICAgICAgICAgIC5yZXBsYWNlKCAvKDxbYS16XVtePl0qKVxzc3R5bGU9KFsiJ10pKFteXDJdKj8pXDIvZ2ksIGZ1bmN0aW9uKCBzdHIsIHRhZywgdG1wLCBzdHlsZSApIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSBbXSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHMgPSBzdHlsZS5yZXBsYWNlKCAvXlxzK3xccyskLywgJycgKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC8mIzM5Oy9nLCdcJycpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoIC8mcXVvdDsvZ2ksICInIiApDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNwbGl0KCAvO1xzKi9nICk7DQoNCiAgICAgICAgICAgICAgICAgICAgZm9yICggdmFyIGkgPSAwLHY7IHYgPSBzW2ldO2krKyApIHsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWUsIHZhbHVlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRzID0gdi5zcGxpdCggIjoiICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggcGFydHMubGVuZ3RoID09IDIgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA9IHBhcnRzWzBdLnRvTG93ZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBwYXJ0c1sxXS50b0xvd2VyQ2FzZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKC9eKGJhY2tncm91bmQpXHcqLy50ZXN0KG5hbWUpICYmIHZhbHVlLnJlcGxhY2UoLyhpbml0aWFsfFxzKS9nLCcnKS5sZW5ndGggPT0gMA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvXihtYXJnaW4pXHcqLy50ZXN0KG5hbWUpICYmIC9eMFx3KyQvLnRlc3QodmFsdWUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICggbmFtZSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAibXNvLXBhZGRpbmctYWx0IjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAibXNvLXBhZGRpbmctdG9wLWFsdCI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIm1zby1wYWRkaW5nLXJpZ2h0LWFsdCI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIm1zby1wYWRkaW5nLWJvdHRvbS1hbHQiOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJtc28tcGFkZGluZy1sZWZ0LWFsdCI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIm1zby1tYXJnaW4tYWx0IjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAibXNvLW1hcmdpbi10b3AtYWx0IjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAibXNvLW1hcmdpbi1yaWdodC1hbHQiOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJtc28tbWFyZ2luLWJvdHRvbS1hbHQiOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJtc28tbWFyZ2luLWxlZnQtYWx0IjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9pZeS4i+S8muWHuueOsOaMpOWIsOS4gOi1t+eahOaDheWGtQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY2FzZSAibXNvLXRhYmxlLWxheW91dC1hbHQiOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJtc28taGVpZ2h0IjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAibXNvLXdpZHRoIjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAibXNvLXZlcnRpY2FsLWFsaWduLWFsdCI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3RyYWNlOjE4MTkgZmbkuIvkvJrop6PmnpDlh7pwYWRkaW5n5ZyodGFibGXkuIoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCEvPHRhYmxlLy50ZXN0KHRhZykpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbltpXSA9IG5hbWUucmVwbGFjZSggL15tc28tfC1hbHQkL2csICIiICkgKyAiOiIgKyB0cmFuc1VuaXQoIHZhbHVlICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiaG9yaXotYWxpZ24iOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbltpXSA9ICJ0ZXh0LWFsaWduOiIgKyB2YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgInZlcnQtYWxpZ24iOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbltpXSA9ICJ2ZXJ0aWNhbC1hbGlnbjoiICsgdmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJmb250LWNvbG9yIjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAibXNvLWZvcmVncm91bmQiOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbltpXSA9ICJjb2xvcjoiICsgdmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJtc28tYmFja2dyb3VuZCI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIm1zby1oaWdobGlnaHQiOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbltpXSA9ICJiYWNrZ3JvdW5kOiIgKyB2YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIm1zby1kZWZhdWx0LWhlaWdodCI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuW2ldID0gIm1pbi1oZWlnaHQ6IiArIHRyYW5zVW5pdCggdmFsdWUgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIm1zby1kZWZhdWx0LXdpZHRoIjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5baV0gPSAibWluLXdpZHRoOiIgKyB0cmFuc1VuaXQoIHZhbHVlICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJtc28tcGFkZGluZy1iZXR3ZWVuLWFsdCI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuW2ldID0gImJvcmRlci1jb2xsYXBzZTpzZXBhcmF0ZTtib3JkZXItc3BhY2luZzoiICsgdHJhbnNVbml0KCB2YWx1ZSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAidGV4dC1saW5lLXRocm91Z2giOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAodmFsdWUgPT0gInNpbmdsZSIpIHx8ICh2YWx1ZSA9PSAiZG91YmxlIikgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbltpXSA9ICJ0ZXh0LWRlY29yYXRpb246bGluZS10aHJvdWdoIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJtc28temVyby1oZWlnaHQiOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB2YWx1ZSA9PSAieWVzIiApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuW2ldID0gImRpc3BsYXk6bm9uZSI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYmFja2dyb3VuZCc6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbWFyZ2luJzoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggIS9bMS05XS8udGVzdCggdmFsdWUgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggL14obXNvfGNvbHVtbnxmb250LWVtcGh8bGFuZ3xsYXlvdXR8bGluZS1icmVha3xsaXN0LWltYWdlfG5hdnxwYW5vc2V8cHVuY3R8cm93fHJ1Ynl8c2VwfHNpemV8c3JjfHRhYi18dGFibGUtYm9yZGVyfHRleHQtKD86ZGVjb3J8dHJhbnMpfHRvcC1iYXJ8dmVyc2lvbnx2bmR8d29yZC1icmVhaykvLnRlc3QoIG5hbWUgKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvdGV4dFwtaW5kZW50fHBhZGRpbmd8bWFyZ2luLy50ZXN0KG5hbWUpICYmIC9cLVtcZC5dKy8udGVzdCh2YWx1ZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbltpXSA9IG5hbWUgKyAiOiIgKyBwYXJ0c1sxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFnICsgKG4ubGVuZ3RoID8gJyBzdHlsZT0iJyArIG4uam9pbiggJzsnKS5yZXBsYWNlKC87ezIsfS9nLCc7JykgKyAnIicgOiAnJyk7DQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIC5yZXBsYWNlKC9bXGQuXSsoY218cHQpL2csZnVuY3Rpb24oc3RyKXsNCiAgICAgICAgICAgICAgICByZXR1cm4gdXRpbHMudHJhbnNVbml0VG9QeChzdHIpDQogICAgICAgICAgICB9KQ0KDQogICAgfQ0KDQogICAgcmV0dXJuIGZ1bmN0aW9uICggaHRtbCApIHsNCiAgICAgICAgcmV0dXJuIChpc1dvcmREb2N1bWVudCggaHRtbCApID8gZmlsdGVyUGFzdGVXb3JkKCBodG1sICkgOiBodG1sKTsNCiAgICB9Ow0KfSgpOwovLy9pbXBvcnQgZWRpdG9yLmpzCi8vL2ltcG9ydCBjb3JlL3V0aWxzLmpzCi8vL2ltcG9ydCBjb3JlL2RvbS9kb20uanMKLy8vaW1wb3J0IGNvcmUvZG9tL2R0ZC5qcwovLy9pbXBvcnQgY29yZS9odG1scGFyc2VyLmpzCi8v5qih5ouf55qE6IqC54K557G7Ci8vYnkgemhhbnlpCihmdW5jdGlvbiAoKSB7CiAgICB2YXIgdU5vZGUgPSBVRS51Tm9kZSA9IGZ1bmN0aW9uIChvYmopIHsKICAgICAgICB0aGlzLnR5cGUgPSBvYmoudHlwZTsKICAgICAgICB0aGlzLmRhdGEgPSBvYmouZGF0YTsKICAgICAgICB0aGlzLnRhZ05hbWUgPSBvYmoudGFnTmFtZTsKICAgICAgICB0aGlzLnBhcmVudE5vZGUgPSBvYmoucGFyZW50Tm9kZTsKICAgICAgICB0aGlzLmF0dHJzID0gb2JqLmF0dHJzIHx8IHt9OwogICAgICAgIHRoaXMuY2hpbGRyZW4gPSBvYmouY2hpbGRyZW47CiAgICB9OwogICAgdmFyIGluZGVudENoYXIgPSAnICAgICcsCiAgICAgICAgYnJlYWtDaGFyID0gJ1xuJzsKCiAgICBmdW5jdGlvbiBpbnNlcnRMaW5lKGFyciwgY3VycmVudCwgYmVnaW4pIHsKICAgICAgICBhcnIucHVzaChicmVha0NoYXIpOwogICAgICAgIHJldHVybiBjdXJyZW50ICsgKGJlZ2luID8gMSA6IC0xKTsKICAgIH0KCiAgICBmdW5jdGlvbiBpbnNlcnRJbmRlbnQoYXJyLCBjdXJyZW50KSB7CiAgICAgICAgLy/mj5LlhaXnvKnov5sKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGN1cnJlbnQ7IGkrKykgewogICAgICAgICAgICBhcnIucHVzaChpbmRlbnRDaGFyKTsKICAgICAgICB9CiAgICB9CgogICAgLy/liJvlu7p1Tm9kZeeahOmdmeaAgeaWueazlQogICAgLy/mlK/mjIHmoIfnrb7lkoxodG1sCiAgICB1Tm9kZS5jcmVhdGVFbGVtZW50ID0gZnVuY3Rpb24gKGh0bWwpIHsKICAgICAgICBpZiAoL1s8Pl0vLnRlc3QoaHRtbCkpIHsKICAgICAgICAgICAgcmV0dXJuIFVFLmh0bWxwYXJzZXIoaHRtbCkuY2hpbGRyZW5bMF0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gbmV3IHVOb2RlKHsKICAgICAgICAgICAgICAgIHR5cGU6J2VsZW1lbnQnLAogICAgICAgICAgICAgICAgY2hpbGRyZW46W10sCiAgICAgICAgICAgICAgICB0YWdOYW1lOmh0bWwKICAgICAgICAgICAgfSkKICAgICAgICB9CiAgICB9OwogICAgdU5vZGUuY3JlYXRlVGV4dCA9IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIG5ldyBVRS51Tm9kZSh7CiAgICAgICAgICAgIHR5cGU6J3RleHQnLAogICAgICAgICAgICAnZGF0YSc6dXRpbHMudW5odG1sKGRhdGEgfHwgJycpCiAgICAgICAgfSkKICAgIH07CiAgICBmdW5jdGlvbiBub2RlVG9IdG1sKG5vZGUsIGFyciwgZm9ybWF0dGVyLCBjdXJyZW50KSB7CiAgICAgICAgc3dpdGNoIChub2RlLnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAncm9vdCc6CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgY2k7IGNpID0gbm9kZS5jaGlsZHJlbltpKytdOykgewogICAgICAgICAgICAgICAgICAgIC8v5o+S5YWl5paw6KGMCiAgICAgICAgICAgICAgICAgICAgaWYgKGZvcm1hdHRlciAmJiBjaS50eXBlID09ICdlbGVtZW50JyAmJiAhZHRkLiRpbmxpbmVXaXRoQVtjaS50YWdOYW1lXSAmJiBpID4gMSkgewogICAgICAgICAgICAgICAgICAgICAgICBpbnNlcnRMaW5lKGFyciwgY3VycmVudCwgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGluc2VydEluZGVudChhcnIsIGN1cnJlbnQpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIG5vZGVUb0h0bWwoY2ksIGFyciwgZm9ybWF0dGVyLCBjdXJyZW50KQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ3RleHQnOgogICAgICAgICAgICAgICAgaXNUZXh0KG5vZGUsIGFycik7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnZWxlbWVudCc6CiAgICAgICAgICAgICAgICBpc0VsZW1lbnQobm9kZSwgYXJyLCBmb3JtYXR0ZXIsIGN1cnJlbnQpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ2NvbW1lbnQnOgogICAgICAgICAgICAgICAgaXNDb21tZW50KG5vZGUsIGFyciwgZm9ybWF0dGVyKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGFycjsKICAgIH0KCiAgICBmdW5jdGlvbiBpc1RleHQobm9kZSwgYXJyKSB7CiAgICAgICAgYXJyLnB1c2gobm9kZS5wYXJlbnROb2RlLnRhZ05hbWUgPT0gJ3ByZScgPyBub2RlLmRhdGEgOiBub2RlLmRhdGEucmVwbGFjZSgvWyBdezJ9L2csJyAmbmJzcDsnKSkKICAgIH0KCiAgICBmdW5jdGlvbiBpc0VsZW1lbnQobm9kZSwgYXJyLCBmb3JtYXR0ZXIsIGN1cnJlbnQpIHsKICAgICAgICB2YXIgYXR0cmh0bWwgPSAnJzsKICAgICAgICBpZiAobm9kZS5hdHRycykgewogICAgICAgICAgICBhdHRyaHRtbCA9IFtdOwogICAgICAgICAgICB2YXIgYXR0cnMgPSBub2RlLmF0dHJzOwogICAgICAgICAgICBmb3IgKHZhciBhIGluIGF0dHJzKSB7CiAgICAgICAgICAgICAgICBhdHRyaHRtbC5wdXNoKGEgKyAoYXR0cnNbYV0gIT09IHVuZGVmaW5lZCA/ICc9IicgKyB1dGlscy51bmh0bWwoYXR0cnNbYV0pICsgJyInIDogJycpKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGF0dHJodG1sID0gYXR0cmh0bWwuam9pbignICcpOwogICAgICAgIH0KICAgICAgICBhcnIucHVzaCgnPCcgKyBub2RlLnRhZ05hbWUgKwogICAgICAgICAgICAoYXR0cmh0bWwgPyAnICcgKyBhdHRyaHRtbCAgOiAnJykgKwogICAgICAgICAgICAoZHRkLiRlbXB0eVtub2RlLnRhZ05hbWVdID8gJ1wvJyA6ICcnICkgKyAnPicKICAgICAgICApOwogICAgICAgIC8v5o+S5YWl5paw6KGMCiAgICAgICAgaWYgKGZvcm1hdHRlciAgJiYgICFkdGQuJGlubGluZVdpdGhBW25vZGUudGFnTmFtZV0gJiYgbm9kZS50YWdOYW1lICE9ICdwcmUnKSB7CiAgICAgICAgICAgIGlmKG5vZGUuY2hpbGRyZW4gJiYgbm9kZS5jaGlsZHJlbi5sZW5ndGgpewogICAgICAgICAgICAgICAgY3VycmVudCA9IGluc2VydExpbmUoYXJyLCBjdXJyZW50LCB0cnVlKTsKICAgICAgICAgICAgICAgIGluc2VydEluZGVudChhcnIsIGN1cnJlbnQpCiAgICAgICAgICAgIH0KCiAgICAgICAgfQogICAgICAgIGlmIChub2RlLmNoaWxkcmVuICYmIG5vZGUuY2hpbGRyZW4ubGVuZ3RoKSB7CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjaTsgY2kgPSBub2RlLmNoaWxkcmVuW2krK107KSB7CiAgICAgICAgICAgICAgICBpZiAoZm9ybWF0dGVyICYmIGNpLnR5cGUgPT0gJ2VsZW1lbnQnICYmICAhZHRkLiRpbmxpbmVXaXRoQVtjaS50YWdOYW1lXSAmJiBpID4gMSkgewogICAgICAgICAgICAgICAgICAgIGluc2VydExpbmUoYXJyLCBjdXJyZW50KTsKICAgICAgICAgICAgICAgICAgICBpbnNlcnRJbmRlbnQoYXJyLCBjdXJyZW50KQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbm9kZVRvSHRtbChjaSwgYXJyLCBmb3JtYXR0ZXIsIGN1cnJlbnQpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKCFkdGQuJGVtcHR5W25vZGUudGFnTmFtZV0pIHsKICAgICAgICAgICAgaWYgKGZvcm1hdHRlciAmJiAhZHRkLiRpbmxpbmVXaXRoQVtub2RlLnRhZ05hbWVdICAmJiBub2RlLnRhZ05hbWUgIT0gJ3ByZScpIHsKCiAgICAgICAgICAgICAgICBpZihub2RlLmNoaWxkcmVuICYmIG5vZGUuY2hpbGRyZW4ubGVuZ3RoKXsKICAgICAgICAgICAgICAgICAgICBjdXJyZW50ID0gaW5zZXJ0TGluZShhcnIsIGN1cnJlbnQpOwogICAgICAgICAgICAgICAgICAgIGluc2VydEluZGVudChhcnIsIGN1cnJlbnQpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYXJyLnB1c2goJzxcLycgKyBub2RlLnRhZ05hbWUgKyAnPicpOwogICAgICAgIH0KCiAgICB9CgogICAgZnVuY3Rpb24gaXNDb21tZW50KG5vZGUsIGFycikgewogICAgICAgIGFyci5wdXNoKCc8IS0tJyArIG5vZGUuZGF0YSArICctLT4nKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXROb2RlQnlJZChyb290LCBpZCkgewogICAgICAgIHZhciBub2RlOwogICAgICAgIGlmIChyb290LnR5cGUgPT0gJ2VsZW1lbnQnICYmIHJvb3QuZ2V0QXR0cignaWQnKSA9PSBpZCkgewogICAgICAgICAgICByZXR1cm4gcm9vdDsKICAgICAgICB9CiAgICAgICAgaWYgKHJvb3QuY2hpbGRyZW4gJiYgcm9vdC5jaGlsZHJlbi5sZW5ndGgpIHsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNpOyBjaSA9IHJvb3QuY2hpbGRyZW5baSsrXTspIHsKICAgICAgICAgICAgICAgIGlmIChub2RlID0gZ2V0Tm9kZUJ5SWQoY2ksIGlkKSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBub2RlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGdldE5vZGVzQnlUYWdOYW1lKG5vZGUsIHRhZ05hbWUsIGFycikgewogICAgICAgIGlmIChub2RlLnR5cGUgPT0gJ2VsZW1lbnQnICYmIG5vZGUudGFnTmFtZSA9PSB0YWdOYW1lKSB7CiAgICAgICAgICAgIGFyci5wdXNoKG5vZGUpOwogICAgICAgIH0KICAgICAgICBpZiAobm9kZS5jaGlsZHJlbiAmJiBub2RlLmNoaWxkcmVuLmxlbmd0aCkgewogICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgY2k7IGNpID0gbm9kZS5jaGlsZHJlbltpKytdOykgewogICAgICAgICAgICAgICAgZ2V0Tm9kZXNCeVRhZ05hbWUoY2ksIHRhZ05hbWUsIGFycikKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIGZ1bmN0aW9uIG5vZGVUcmF2ZXJzYWwocm9vdCxmbil7CiAgICAgICAgaWYocm9vdC5jaGlsZHJlbiAmJiByb290LmNoaWxkcmVuLmxlbmd0aCl7CiAgICAgICAgICAgIGZvcih2YXIgaT0gMCxjaTtjaT1yb290LmNoaWxkcmVuW2ldOyl7CiAgICAgICAgICAgICAgICBub2RlVHJhdmVyc2FsKGNpLGZuKTsKICAgICAgICAgICAgICAgIC8vY2nooqvmm7/mjaLnmoTmg4XlhrXvvIzov5nph4zlsLHkuI3lho3otbAgZm7kuoYKICAgICAgICAgICAgICAgIGlmKGNpLnBhcmVudE5vZGUgKXsKICAgICAgICAgICAgICAgICAgICBpZihjaS5jaGlsZHJlbiAmJiBjaS5jaGlsZHJlbi5sZW5ndGgpewogICAgICAgICAgICAgICAgICAgICAgICBmbihjaSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYoY2kucGFyZW50Tm9kZSkgaSsrCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgZm4ocm9vdCkKICAgICAgICB9CgogICAgfQogICAgdU5vZGUucHJvdG90eXBlID0gewogICAgICAgIHRvSHRtbDpmdW5jdGlvbiAoZm9ybWF0dGVyKSB7CiAgICAgICAgICAgIHZhciBhcnIgPSBbXTsKICAgICAgICAgICAgbm9kZVRvSHRtbCh0aGlzLCBhcnIsIGZvcm1hdHRlciwgMCk7CiAgICAgICAgICAgIHJldHVybiBhcnIuam9pbignJykKICAgICAgICB9LAogICAgICAgIGlubmVySFRNTDpmdW5jdGlvbiAoaHRtbHN0cikgewogICAgICAgICAgICBpZiAodGhpcy50eXBlICE9ICdlbGVtZW50JyB8fCBkdGQuJGVtcHR5W3RoaXMudGFnTmFtZV0pIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh1dGlscy5pc1N0cmluZyhodG1sc3RyKSkgewogICAgICAgICAgICAgICAgaWYodGhpcy5jaGlsZHJlbil7CiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNpOyBjaSA9IHRoaXMuY2hpbGRyZW5baSsrXTspIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2kucGFyZW50Tm9kZSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbiA9IFtdOwogICAgICAgICAgICAgICAgdmFyIHRtcFJvb3QgPSBVRS5odG1scGFyc2VyKGh0bWxzdHIpOwogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNpOyBjaSA9IHRtcFJvb3QuY2hpbGRyZW5baSsrXTspIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuLnB1c2goY2kpOwogICAgICAgICAgICAgICAgICAgIGNpLnBhcmVudE5vZGUgPSB0aGlzOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB2YXIgdG1wUm9vdCA9IG5ldyBVRS51Tm9kZSh7CiAgICAgICAgICAgICAgICAgICAgdHlwZToncm9vdCcsCiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46dGhpcy5jaGlsZHJlbgogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm4gdG1wUm9vdC50b0h0bWwoKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgaW5uZXJUZXh0OmZ1bmN0aW9uICh0ZXh0U3RyKSB7CiAgICAgICAgICAgIGlmICh0aGlzLnR5cGUgIT0gJ2VsZW1lbnQnIHx8IGR0ZC4kZW1wdHlbdGhpcy50YWdOYW1lXSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHRleHRTdHIpIHsKICAgICAgICAgICAgICAgIGlmKHRoaXMuY2hpbGRyZW4pewogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjaTsgY2kgPSB0aGlzLmNoaWxkcmVuW2krK107KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNpLnBhcmVudE5vZGUgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4gPSBbXTsKICAgICAgICAgICAgICAgIHRoaXMuYXBwZW5kQ2hpbGQodU5vZGUuY3JlYXRlVGV4dCh0ZXh0U3RyKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRvSHRtbCgpLnJlcGxhY2UoLzxbXj5dKz4vZywgJycpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBnZXREYXRhOmZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKHRoaXMudHlwZSA9PSAnZWxlbWVudCcpCiAgICAgICAgICAgICAgICByZXR1cm4gJyc7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmRhdGEKICAgICAgICB9LAogICAgICAgIGZpcnN0Q2hpbGQ6ZnVuY3Rpb24gKCkgewovLyAgICAgICAgICAgIGlmICh0aGlzLnR5cGUgIT0gJ2VsZW1lbnQnIHx8IGR0ZC4kZW1wdHlbdGhpcy50YWdOYW1lXSkgewovLyAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsKLy8gICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0aGlzLmNoaWxkcmVuID8gdGhpcy5jaGlsZHJlblswXSA6IG51bGw7CiAgICAgICAgfSwKICAgICAgICBsYXN0Q2hpbGQ6ZnVuY3Rpb24gKCkgewovLyAgICAgICAgICAgIGlmICh0aGlzLnR5cGUgIT0gJ2VsZW1lbnQnIHx8IGR0ZC4kZW1wdHlbdGhpcy50YWdOYW1lXSApIHsKLy8gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7Ci8vICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdGhpcy5jaGlsZHJlbiA/IHRoaXMuY2hpbGRyZW5bdGhpcy5jaGlsZHJlbi5sZW5ndGggLSAxXSA6IG51bGw7CiAgICAgICAgfSwKICAgICAgICBwcmV2aW91c1NpYmxpbmcgOiBmdW5jdGlvbigpewogICAgICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnROb2RlOwogICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgY2k7IGNpID0gcGFyZW50LmNoaWxkcmVuW2ldOyBpKyspIHsKICAgICAgICAgICAgICAgIGlmIChjaSA9PT0gdGhpcykgewogICAgICAgICAgICAgICAgICAgcmV0dXJuIGkgPT0gMCA/IG51bGwgOiBwYXJlbnQuY2hpbGRyZW5baS0xXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICB9LAogICAgICAgIG5leHRTaWJsaW5nIDogZnVuY3Rpb24oKXsKICAgICAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50Tm9kZTsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNpOyBjaSA9IHBhcmVudC5jaGlsZHJlbltpKytdOykgewogICAgICAgICAgICAgICAgaWYgKGNpID09PSB0aGlzKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcmVudC5jaGlsZHJlbltpXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgcmVwbGFjZUNoaWxkOmZ1bmN0aW9uICh0YXJnZXQsIHNvdXJjZSkgewogICAgICAgICAgICBpZiAodGhpcy5jaGlsZHJlbikgewogICAgICAgICAgICAgICAgaWYodGFyZ2V0LnBhcmVudE5vZGUpewogICAgICAgICAgICAgICAgICAgIHRhcmdldC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRhcmdldCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgY2k7IGNpID0gdGhpcy5jaGlsZHJlbltpXTsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNpID09PSBzb3VyY2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5zcGxpY2UoaSwgMSwgdGFyZ2V0KTsKICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlLnBhcmVudE5vZGUgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQucGFyZW50Tm9kZSA9IHRoaXM7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXQ7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBhcHBlbmRDaGlsZDpmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICBpZiAodGhpcy50eXBlID09ICdyb290JyB8fCAodGhpcy50eXBlID09ICdlbGVtZW50JyAmJiAhZHRkLiRlbXB0eVt0aGlzLnRhZ05hbWVdKSkgewogICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNoaWxkcmVuKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbiA9IFtdCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZihub2RlLnBhcmVudE5vZGUpewogICAgICAgICAgICAgICAgICAgIG5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChub2RlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjaTsgY2kgPSB0aGlzLmNoaWxkcmVuW2ldOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAoY2kgPT09IG5vZGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5zcGxpY2UoaSwgMSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4ucHVzaChub2RlKTsKICAgICAgICAgICAgICAgIG5vZGUucGFyZW50Tm9kZSA9IHRoaXM7CiAgICAgICAgICAgICAgICByZXR1cm4gbm9kZTsKICAgICAgICAgICAgfQoKCiAgICAgICAgfSwKICAgICAgICBpbnNlcnRCZWZvcmU6ZnVuY3Rpb24gKHRhcmdldCwgc291cmNlKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmNoaWxkcmVuKSB7CiAgICAgICAgICAgICAgICBpZih0YXJnZXQucGFyZW50Tm9kZSl7CiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGFyZ2V0KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjaTsgY2kgPSB0aGlzLmNoaWxkcmVuW2ldOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAoY2kgPT09IHNvdXJjZSkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuLnNwbGljZShpLCAwLCB0YXJnZXQpOwogICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQucGFyZW50Tm9kZSA9IHRoaXM7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXQ7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgaW5zZXJ0QWZ0ZXI6ZnVuY3Rpb24gKHRhcmdldCwgc291cmNlKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmNoaWxkcmVuKSB7CiAgICAgICAgICAgICAgICBpZih0YXJnZXQucGFyZW50Tm9kZSl7CiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGFyZ2V0KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjaTsgY2kgPSB0aGlzLmNoaWxkcmVuW2ldOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAoY2kgPT09IHNvdXJjZSkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuLnNwbGljZShpICsgMSwgMCwgdGFyZ2V0KTsKICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LnBhcmVudE5vZGUgPSB0aGlzOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0OwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHJlbW92ZUNoaWxkOmZ1bmN0aW9uIChub2RlLGtlZXBDaGlsZHJlbikgewogICAgICAgICAgICBpZiAodGhpcy5jaGlsZHJlbikgewogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNpOyBjaSA9IHRoaXMuY2hpbGRyZW5baV07IGkrKykgewogICAgICAgICAgICAgICAgICAgIGlmIChjaSA9PT0gbm9kZSkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuLnNwbGljZShpLCAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgY2kucGFyZW50Tm9kZSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGtlZXBDaGlsZHJlbiAmJiBjaS5jaGlsZHJlbiAmJiBjaS5jaGlsZHJlbi5sZW5ndGgpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBqPSAwLGNqO2NqPWNpLmNoaWxkcmVuW2pdO2orKyl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5zcGxpY2UoaStqLDAsY2opOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNqLnBhcmVudE5vZGUgPSB0aGlzOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2k7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBnZXRBdHRyOmZ1bmN0aW9uIChhdHRyTmFtZSkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5hdHRycyAmJiB0aGlzLmF0dHJzW2F0dHJOYW1lLnRvTG93ZXJDYXNlKCldCiAgICAgICAgfSwKICAgICAgICBzZXRBdHRyOmZ1bmN0aW9uIChhdHRyTmFtZSwgYXR0clZhbCkgewogICAgICAgICAgICBpZiAoIWF0dHJOYW1lKSB7CiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5hdHRyczsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZighdGhpcy5hdHRycyl7CiAgICAgICAgICAgICAgICB0aGlzLmF0dHJzID0ge307CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHV0aWxzLmlzT2JqZWN0KGF0dHJOYW1lKSkgewogICAgICAgICAgICAgICAgZm9yICh2YXIgYSBpbiBhdHRyTmFtZSkgewogICAgICAgICAgICAgICAgICAgIGlmICghYXR0ck5hbWVbYV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuYXR0cnNbYV0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmF0dHJzW2EudG9Mb3dlckNhc2UoKV0gPSBhdHRyTmFtZVthXTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAoIWF0dHJWYWwpIHsKICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5hdHRyc1thdHRyTmFtZV0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hdHRyc1thdHRyTmFtZS50b0xvd2VyQ2FzZSgpXSA9IGF0dHJWYWw7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBnZXRJbmRleDpmdW5jdGlvbigpewogICAgICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnROb2RlOwogICAgICAgICAgICBmb3IodmFyIGk9IDAsY2k7Y2k9cGFyZW50LmNoaWxkcmVuW2ldO2krKyl7CiAgICAgICAgICAgICAgICBpZihjaSA9PT0gdGhpcyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIH0sCiAgICAgICAgZ2V0Tm9kZUJ5SWQ6ZnVuY3Rpb24gKGlkKSB7CiAgICAgICAgICAgIHZhciBub2RlOwogICAgICAgICAgICBpZiAodGhpcy5jaGlsZHJlbiAmJiB0aGlzLmNoaWxkcmVuLmxlbmd0aCkgewogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNpOyBjaSA9IHRoaXMuY2hpbGRyZW5baSsrXTspIHsKICAgICAgICAgICAgICAgICAgICBpZiAobm9kZSA9IGdldE5vZGVCeUlkKGNpLCBpZCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBnZXROb2Rlc0J5VGFnTmFtZTpmdW5jdGlvbiAodGFnTmFtZXMpIHsKICAgICAgICAgICAgdGFnTmFtZXMgPSB1dGlscy50cmltKHRhZ05hbWVzKS5yZXBsYWNlKC9bIF17Mix9L2csICcgJykuc3BsaXQoJyAnKTsKICAgICAgICAgICAgdmFyIGFyciA9IFtdLCBtZSA9IHRoaXM7CiAgICAgICAgICAgIHV0aWxzLmVhY2godGFnTmFtZXMsIGZ1bmN0aW9uICh0YWdOYW1lKSB7CiAgICAgICAgICAgICAgICBpZiAobWUuY2hpbGRyZW4gJiYgbWUuY2hpbGRyZW4ubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNpOyBjaSA9IG1lLmNoaWxkcmVuW2krK107KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldE5vZGVzQnlUYWdOYW1lKGNpLCB0YWdOYW1lLCBhcnIpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIGFycjsKICAgICAgICB9LAogICAgICAgIGdldFN0eWxlOmZ1bmN0aW9uIChuYW1lKSB7CiAgICAgICAgICAgIHZhciBjc3NTdHlsZSA9IHRoaXMuZ2V0QXR0cignc3R5bGUnKTsKICAgICAgICAgICAgaWYgKCFjc3NTdHlsZSkgewogICAgICAgICAgICAgICAgcmV0dXJuICcnCiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyIHJlZyA9IG5ldyBSZWdFeHAobmFtZSArICc6KFteO10rKScsJ2knKTsKICAgICAgICAgICAgdmFyIG1hdGNoID0gY3NzU3R5bGUubWF0Y2gocmVnKTsKICAgICAgICAgICAgaWYgKG1hdGNoICYmIG1hdGNoWzBdKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2hbMV0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gJyc7CiAgICAgICAgfSwKICAgICAgICBzZXRTdHlsZTpmdW5jdGlvbiAobmFtZSwgdmFsKSB7CiAgICAgICAgICAgIGZ1bmN0aW9uIGV4ZWMobmFtZSwgdmFsKSB7CiAgICAgICAgICAgICAgICB2YXIgcmVnID0gbmV3IFJlZ0V4cChuYW1lICsgJzooW147XSs7PyknLCAnZ2knKTsKICAgICAgICAgICAgICAgIGNzc1N0eWxlID0gY3NzU3R5bGUucmVwbGFjZShyZWcsICcnKTsKICAgICAgICAgICAgICAgIGlmICh2YWwpIHsKICAgICAgICAgICAgICAgICAgICBjc3NTdHlsZSA9IG5hbWUgKyAnOicgKyB1dGlscy51bmh0bWwodmFsKSArICc7JyArIGNzc1N0eWxlCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgY3NzU3R5bGUgPSB0aGlzLmdldEF0dHIoJ3N0eWxlJyk7CiAgICAgICAgICAgIGlmICghY3NzU3R5bGUpIHsKICAgICAgICAgICAgICAgIGNzc1N0eWxlID0gJyc7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHV0aWxzLmlzT2JqZWN0KG5hbWUpKSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBhIGluIG5hbWUpIHsKICAgICAgICAgICAgICAgICAgICBleGVjKGEsIG5hbWVbYV0pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBleGVjKG5hbWUsIHZhbCkKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnNldEF0dHIoJ3N0eWxlJywgdXRpbHMudHJpbShjc3NTdHlsZSkpCiAgICAgICAgfSwKICAgICAgICB0cmF2ZXJzYWw6ZnVuY3Rpb24oZm4pewogICAgICAgICAgICBpZih0aGlzLmNoaWxkcmVuICYmIHRoaXMuY2hpbGRyZW4ubGVuZ3RoKXsKICAgICAgICAgICAgICAgIG5vZGVUcmF2ZXJzYWwodGhpcyxmbik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQogICAgfQp9KSgpOwoKLy9odG1s5a2X56ym5Liy6L2s5o2i5oiQdU5vZGXoioLngrkKLy9ieSB6aGFueWkKdmFyIGh0bWxwYXJzZXIgPSBVRS5odG1scGFyc2VyID0gZnVuY3Rpb24gKGh0bWxzdHIsaWdub3JlQmxhbmspIHsKICAgIHZhciByZV90YWcgPSAvPCg/Oig/OlwvKFtePl0rKT4pfCg/OiEtLShbXFN8XHNdKj8pLS0+KXwoPzooW15cc1wvPl0rKVxzKigoPzooPzoiW14iXSoiKXwoPzonW14nXSonKXxbXiInPD5dKSopXC8/PikpL2csCiAgICAgICAgcmVfYXR0ciA9IC8oW1x3XC06Ll0rKSg/Oig/OlxzKj1ccyooPzooPzoiKFteIl0qKSIpfCg/OicoW14nXSopJyl8KFteXHM+XSspKSl8KD89XHN8JCkpL2c7CgogICAgLy9pZeS4i+WPluW+l+eahGh0bWzlj6/og73kvJrmnIlcbuWtmOWcqO+8jOimgeWOu+aOie+8jOWcqOWkhOeQhnJlcGxhY2UoL1tcdFxyXG5dKi9nLCcnKTvku6PnoIHpq5jph4/nmoRcbuS4jeiDveWOu+mZpAogICAgdmFyIGFsbG93RW1wdHlUYWdzID0gewogICAgICAgIGI6MSxjb2RlOjEsaToxLHU6MSxzdHJpa2U6MSxzOjEsdHQ6MSxzdHJvbmc6MSxxOjEsc2FtcDoxLGVtOjEsc3BhbjoxLAogICAgICAgIHN1YjoxLGltZzoxLHN1cDoxLGZvbnQ6MSxiaWc6MSxzbWFsbDoxLGlmcmFtZToxLGE6MSxicjoxLHByZToxCiAgICB9OwogICAgaHRtbHN0ciA9IGh0bWxzdHIucmVwbGFjZShuZXcgUmVnRXhwKGRvbVV0aWxzLmZpbGxDaGFyLCAnZycpLCAnJyk7CiAgICBpZighaWdub3JlQmxhbmspewogICAgICAgIGh0bWxzdHIgPSBodG1sc3RyLnJlcGxhY2UobmV3IFJlZ0V4cCgnW1xcclxcdFxcbicrKGlnbm9yZUJsYW5rPycnOicgJykrJ10qPFwvPyhcXHcrKVxccyooPzpbXj5dKik+W1xcclxcdFxcbicrKGlnbm9yZUJsYW5rPycnOicgJykrJ10qJywnZycpLCBmdW5jdGlvbihhLGIpewogICAgICAgICAgICAvL2Jy5pqC5pe25Y2V54us5aSE55CGCiAgICAgICAgICAgIGlmKGIgJiYgYWxsb3dFbXB0eVRhZ3NbYi50b0xvd2VyQ2FzZSgpXSl7CiAgICAgICAgICAgICAgICByZXR1cm4gYS5yZXBsYWNlKC8oXltcblxyXSspfChbXG5ccl0rJCkvZywnJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGEucmVwbGFjZShuZXcgUmVnRXhwKCdeW1xcclxcbicrKGlnbm9yZUJsYW5rPycnOicgJykrJ10rJyksJycpLnJlcGxhY2UobmV3IFJlZ0V4cCgnW1xcclxcbicrKGlnbm9yZUJsYW5rPycnOicgJykrJ10rJCcpLCcnKTsKICAgICAgICB9KTsKICAgIH0KCgoKICAgIHZhciB1Tm9kZSA9IFVFLnVOb2RlLAogICAgICAgIG5lZWRQYXJlbnROb2RlID0gewogICAgICAgICAgICAndGQnOid0cicsCiAgICAgICAgICAgICd0cic6Wyd0Ym9keScsJ3RoZWFkJywndGZvb3QnXSwKICAgICAgICAgICAgJ3Rib2R5JzondGFibGUnLAogICAgICAgICAgICAndGgnOid0cicsCiAgICAgICAgICAgICd0aGVhZCc6J3RhYmxlJywKICAgICAgICAgICAgJ3Rmb290JzondGFibGUnLAogICAgICAgICAgICAnY2FwdGlvbic6J3RhYmxlJywKICAgICAgICAgICAgJ2xpJzpbJ3VsJywgJ29sJ10sCiAgICAgICAgICAgICdkdCc6J2RsJywKICAgICAgICAgICAgJ2RkJzonZGwnLAogICAgICAgICAgICAnb3B0aW9uJzonc2VsZWN0JwogICAgICAgIH0sCiAgICAgICAgbmVlZENoaWxkID0gewogICAgICAgICAgICAnb2wnOidsaScsCiAgICAgICAgICAgICd1bCc6J2xpJwogICAgICAgIH07CgogICAgZnVuY3Rpb24gdGV4dChwYXJlbnQsIGRhdGEpIHsKCiAgICAgICAgaWYobmVlZENoaWxkW3BhcmVudC50YWdOYW1lXSl7CiAgICAgICAgICAgIHZhciB0bXBOb2RlID0gdU5vZGUuY3JlYXRlRWxlbWVudChuZWVkQ2hpbGRbcGFyZW50LnRhZ05hbWVdKTsKICAgICAgICAgICAgcGFyZW50LmFwcGVuZENoaWxkKHRtcE5vZGUpOwogICAgICAgICAgICB0bXBOb2RlLmFwcGVuZENoaWxkKHVOb2RlLmNyZWF0ZVRleHQoZGF0YSkpOwogICAgICAgICAgICBwYXJlbnQgPSB0bXBOb2RlOwogICAgICAgIH1lbHNlewoKICAgICAgICAgICAgcGFyZW50LmFwcGVuZENoaWxkKHVOb2RlLmNyZWF0ZVRleHQoZGF0YSkpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBlbGVtZW50KHBhcmVudCwgdGFnTmFtZSwgaHRtbGF0dHIpIHsKICAgICAgICB2YXIgbmVlZFBhcmVudFRhZzsKICAgICAgICBpZiAobmVlZFBhcmVudFRhZyA9IG5lZWRQYXJlbnROb2RlW3RhZ05hbWVdKSB7CiAgICAgICAgICAgIHZhciB0bXBQYXJlbnQgPSBwYXJlbnQsaGFzUGFyZW50OwogICAgICAgICAgICB3aGlsZSh0bXBQYXJlbnQudHlwZSAhPSAncm9vdCcpewogICAgICAgICAgICAgICAgaWYodXRpbHMuaXNBcnJheShuZWVkUGFyZW50VGFnKSA/IHV0aWxzLmluZGV4T2YobmVlZFBhcmVudFRhZywgdG1wUGFyZW50LnRhZ05hbWUpICE9IC0xIDogbmVlZFBhcmVudFRhZyA9PSB0bXBQYXJlbnQudGFnTmFtZSl7CiAgICAgICAgICAgICAgICAgICAgcGFyZW50ID0gdG1wUGFyZW50OwogICAgICAgICAgICAgICAgICAgIGhhc1BhcmVudCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0bXBQYXJlbnQgPSB0bXBQYXJlbnQucGFyZW50Tm9kZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZighaGFzUGFyZW50KXsKICAgICAgICAgICAgICAgIHBhcmVudCA9IGVsZW1lbnQocGFyZW50LCB1dGlscy5pc0FycmF5KG5lZWRQYXJlbnRUYWcpID8gbmVlZFBhcmVudFRhZ1swXSA6IG5lZWRQYXJlbnRUYWcpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLy/mjIlkdGTlpITnkIbltYzlpZcKLy8gICAgICAgIGlmKHBhcmVudC50eXBlICE9ICdyb290JyAmJiAhZHRkW3BhcmVudC50YWdOYW1lXVt0YWdOYW1lXSkKLy8gICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50Tm9kZTsKICAgICAgICB2YXIgZWxtID0gbmV3IHVOb2RlKHsKICAgICAgICAgICAgcGFyZW50Tm9kZTpwYXJlbnQsCiAgICAgICAgICAgIHR5cGU6J2VsZW1lbnQnLAogICAgICAgICAgICB0YWdOYW1lOnRhZ05hbWUudG9Mb3dlckNhc2UoKSwKICAgICAgICAgICAgLy/mmK/oh6rpl63lkIjnmoTlpITnkIbkuIDkuIsKICAgICAgICAgICAgY2hpbGRyZW46ZHRkLiRlbXB0eVt0YWdOYW1lXSA/IG51bGwgOiBbXQogICAgICAgIH0pOwogICAgICAgIC8v5aaC5p6c5bGe5oCn5a2Y5Zyo77yM5aSE55CG5bGe5oCnCiAgICAgICAgaWYgKGh0bWxhdHRyKSB7CiAgICAgICAgICAgIHZhciBhdHRycyA9IHt9LCBtYXRjaDsKICAgICAgICAgICAgd2hpbGUgKG1hdGNoID0gcmVfYXR0ci5leGVjKGh0bWxhdHRyKSkgewogICAgICAgICAgICAgICAgYXR0cnNbbWF0Y2hbMV0udG9Mb3dlckNhc2UoKV0gPSB1dGlscy51bmh0bWwobWF0Y2hbMl0gfHwgbWF0Y2hbM10gfHwgbWF0Y2hbNF0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxtLmF0dHJzID0gYXR0cnM7CiAgICAgICAgfQoKICAgICAgICBwYXJlbnQuY2hpbGRyZW4ucHVzaChlbG0pOwogICAgICAgIC8v5aaC5p6c5piv6Ieq6Zet5ZCI6IqC54K56L+U5Zue54i25Lqy6IqC54K5CiAgICAgICAgcmV0dXJuICBkdGQuJGVtcHR5W3RhZ05hbWVdID8gcGFyZW50IDogZWxtCiAgICB9CgogICAgZnVuY3Rpb24gY29tbWVudChwYXJlbnQsIGRhdGEpIHsKICAgICAgICBwYXJlbnQuY2hpbGRyZW4ucHVzaChuZXcgdU5vZGUoewogICAgICAgICAgICB0eXBlOidjb21tZW50JywKICAgICAgICAgICAgZGF0YTpkYXRhLAogICAgICAgICAgICBwYXJlbnROb2RlOnBhcmVudAogICAgICAgIH0pKTsKICAgIH0KCiAgICB2YXIgbWF0Y2gsIGN1cnJlbnRJbmRleCA9IDAsIG5leHRJbmRleCA9IDA7CiAgICAvL+iuvue9ruagueiKgueCuQogICAgdmFyIHJvb3QgPSBuZXcgdU5vZGUoewogICAgICAgIHR5cGU6J3Jvb3QnLAogICAgICAgIGNoaWxkcmVuOltdCiAgICB9KTsKICAgIHZhciBjdXJyZW50UGFyZW50ID0gcm9vdDsKICAgIHdoaWxlIChtYXRjaCA9IHJlX3RhZy5leGVjKGh0bWxzdHIpKSB7CiAgICAgICAgY3VycmVudEluZGV4ID0gbWF0Y2guaW5kZXg7CiAgICAgICAgdHJ5ewogICAgICAgICAgICBpZiAoY3VycmVudEluZGV4ID4gbmV4dEluZGV4KSB7CiAgICAgICAgICAgICAgICAvL3RleHQgbm9kZQogICAgICAgICAgICAgICAgdGV4dChjdXJyZW50UGFyZW50LCBodG1sc3RyLnNsaWNlKG5leHRJbmRleCwgY3VycmVudEluZGV4KSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKG1hdGNoWzNdKSB7CiAgICAgICAgICAgICAgICAvL3N0YXJ0IHRhZwogICAgICAgICAgICAgICAgY3VycmVudFBhcmVudCA9IGVsZW1lbnQoY3VycmVudFBhcmVudCwgbWF0Y2hbM10udG9Mb3dlckNhc2UoKSwgbWF0Y2hbNF0pOwoKICAgICAgICAgICAgfSBlbHNlIGlmIChtYXRjaFsxXSkgewogICAgICAgICAgICAgICAgaWYoY3VycmVudFBhcmVudC50eXBlICE9ICdyb290Jyl7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRtcFBhcmVudCA9IGN1cnJlbnRQYXJlbnQ7CiAgICAgICAgICAgICAgICAgICAgd2hpbGUoY3VycmVudFBhcmVudC50eXBlID09ICdlbGVtZW50JyAmJiBjdXJyZW50UGFyZW50LnRhZ05hbWUgIT0gbWF0Y2hbMV0udG9Mb3dlckNhc2UoKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQYXJlbnQgPSBjdXJyZW50UGFyZW50LnBhcmVudE5vZGU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGN1cnJlbnRQYXJlbnQudHlwZSA9PSAncm9vdCcpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFBhcmVudCA9IHRtcFBhcmVudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93ICdicmVhaycKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAvL2VuZCB0YWcKICAgICAgICAgICAgICAgICAgICBjdXJyZW50UGFyZW50ID0gY3VycmVudFBhcmVudC5wYXJlbnROb2RlOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfSBlbHNlIGlmIChtYXRjaFsyXSkgewogICAgICAgICAgICAgICAgLy9jb21tZW50CiAgICAgICAgICAgICAgICBjb21tZW50KGN1cnJlbnRQYXJlbnQsIG1hdGNoWzJdKQogICAgICAgICAgICB9CiAgICAgICAgfWNhdGNoKGUpe30KCiAgICAgICAgbmV4dEluZGV4ID0gcmVfdGFnLmxhc3RJbmRleDsKCiAgICB9CiAgICAvL+WmguaenOe7k+adn+aYr+aWh+acrO+8jOWwseacieWPr+iDveS4ouaOie+8jOaJgOS7pei/memHjOaJi+WKqOWIpOaWreS4gOS4iwogICAgLy/kvovlpoIgPGxpPnNkZnNkZnNkZjxsaT5zZGZzZGZzZGZzZGYKICAgIGlmIChuZXh0SW5kZXggPCBodG1sc3RyLmxlbmd0aCkgewogICAgICAgIHRleHQoY3VycmVudFBhcmVudCwgaHRtbHN0ci5zbGljZShuZXh0SW5kZXgpKTsKICAgIH0KICAgIHJldHVybiByb290Owp9OwovKioNCiAqIEBmaWxlDQogKiBAbmFtZSBVRS5maWx0ZXJOb2RlDQogKiBAc2hvcnQgZmlsdGVyTm9kZQ0KICogQGRlc2Mg5qC55o2u57uZ5a6a55qE6KeE5YiZ6L+H5ruk6IqC54K5DQogKiBAaW1wb3J0IGVkaXRvci5qcyxjb3JlL3V0aWxzLmpzDQogKiBAYW50aG9yIHpoYW55aQ0KICovDQp2YXIgZmlsdGVyTm9kZSA9IFVFLmZpbHRlck5vZGUgPSBmdW5jdGlvbiAoKSB7DQogICAgZnVuY3Rpb24gZmlsdGVyTm9kZShub2RlLHJ1bGVzKXsNCiAgICAgICAgc3dpdGNoIChub2RlLnR5cGUpIHsNCiAgICAgICAgICAgIGNhc2UgJ3RleHQnOg0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnZWxlbWVudCc6DQogICAgICAgICAgICAgICAgdmFyIHZhbDsNCiAgICAgICAgICAgICAgICBpZih2YWwgPSBydWxlc1tub2RlLnRhZ05hbWVdKXsNCiAgICAgICAgICAgICAgICAgICBpZih2YWwgPT09ICctJyl7DQogICAgICAgICAgICAgICAgICAgICAgIG5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChub2RlKQ0KICAgICAgICAgICAgICAgICAgIH1lbHNlIGlmKHV0aWxzLmlzRnVuY3Rpb24odmFsKSl7DQogICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnROb2RlID0gbm9kZS5wYXJlbnROb2RlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBub2RlLmdldEluZGV4KCk7DQogICAgICAgICAgICAgICAgICAgICAgIHZhbChub2RlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgaWYobm9kZS5wYXJlbnROb2RlKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG5vZGUuY2hpbGRyZW4pew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaSA9IDAsY2k7Y2k9bm9kZS5jaGlsZHJlbltpXTspew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJOb2RlKGNpLHJ1bGVzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY2kucGFyZW50Tm9kZSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpID0gaW5kZXgsY2k7Y2k9cGFyZW50Tm9kZS5jaGlsZHJlbltpXTspew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlck5vZGUoY2kscnVsZXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGNpLnBhcmVudE5vZGUpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cnMgPSB2YWxbJyQnXTsNCiAgICAgICAgICAgICAgICAgICAgICAgaWYoYXR0cnMgJiYgbm9kZS5hdHRycyl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG1wQXR0cnMgPSB7fSx0bXBWYWw7DQogICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGEgaW4gYXR0cnMpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcFZhbCA9IG5vZGUuZ2V0QXR0cihhKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3RvZG8g5Y+q5YWI5a+5c3R5bGXljZXni6zlpITnkIYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihhID09ICdzdHlsZScgJiYgdXRpbHMuaXNBcnJheShhdHRyc1thXSkpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG1wQ3NzU3R5bGUgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXRpbHMuZWFjaChhdHRyc1thXSxmdW5jdGlvbih2KXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0bXA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0bXAgPSBub2RlLmdldFN0eWxlKHYpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBDc3NTdHlsZS5wdXNoKHYgKyAnOicgKyB0bXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wVmFsID0gdG1wQ3NzU3R5bGUuam9pbignOycpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRtcFZhbCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcEF0dHJzW2FdID0gdG1wVmFsOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5hdHRycyA9IHRtcEF0dHJzOw0KICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgIGlmKG5vZGUuY2hpbGRyZW4pew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpID0gMCxjaTtjaT1ub2RlLmNoaWxkcmVuW2ldOyl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyTm9kZShjaSxydWxlcyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY2kucGFyZW50Tm9kZSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgIC8v5aaC5p6c5LiN5Zyo5ZCN5Y2V6YeM5omj5Ye65a2Q6IqC54K55bm25Yig6Zmk6K+l6IqC54K5LGNkYXRh6Zmk5aSWDQogICAgICAgICAgICAgICAgICAgIGlmKGR0ZC4kY2RhdGFbbm9kZS50YWdOYW1lXSl7DQogICAgICAgICAgICAgICAgICAgICAgICBub2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobm9kZSkNCiAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50Tm9kZSA9IG5vZGUucGFyZW50Tm9kZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9IG5vZGUuZ2V0SW5kZXgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChub2RlLHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpID0gaW5kZXgsY2k7Y2k9cGFyZW50Tm9kZS5jaGlsZHJlbltpXTspew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlck5vZGUoY2kscnVsZXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGNpLnBhcmVudE5vZGUpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAnY29tbWVudCc6DQogICAgICAgICAgICAgICAgbm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUpDQogICAgICAgIH0NCg0KICAgIH0NCiAgICByZXR1cm4gZnVuY3Rpb24ocm9vdCxydWxlcyl7DQogICAgICAgIGlmKHV0aWxzLmlzRW1wdHlPYmplY3QocnVsZXMpKXsNCiAgICAgICAgICAgIHJldHVybiByb290Ow0KICAgICAgICB9DQogICAgICAgIHZhciB2YWw7DQogICAgICAgIGlmKHZhbCA9IHJ1bGVzWyctJ10pew0KICAgICAgICAgICAgdXRpbHMuZWFjaCh2YWwuc3BsaXQoJyAnKSxmdW5jdGlvbihrKXsNCiAgICAgICAgICAgICAgICBydWxlc1trXSA9ICctJw0KICAgICAgICAgICAgfSkNCiAgICAgICAgfQ0KICAgICAgICBmb3IodmFyIGk9IDAsY2k7Y2k9cm9vdC5jaGlsZHJlbltpXTspew0KICAgICAgICAgICAgZmlsdGVyTm9kZShjaSxydWxlcyk7DQogICAgICAgICAgICBpZihjaS5wYXJlbnROb2RlKXsNCiAgICAgICAgICAgICAgIGkrKzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gcm9vdDsNCiAgICB9DQp9KCk7Ci8vL2ltcG9ydCBjb3JlDQovLy9wbHVnaW4g57yW6L6R5Zmo6buY6K6k55qE6L+H5ruk6L2s5o2i5py65Yi2DQoNClVFLnBsdWdpbnNbJ2RlZmF1bHRmaWx0ZXInXSA9IGZ1bmN0aW9uICgpIHsNCiAgICB2YXIgbWUgPSB0aGlzOw0KICAgIG1lLnNldE9wdCgnYWxsb3dEaXZUcmFuc1RvUCcsdHJ1ZSk7DQogICAgLy/pu5jorqTnmoTov4fmu6TlpITnkIYNCiAgICAvL+i/m+WFpee8lui+keWZqOeahOWGheWuueWkhOeQhg0KICAgIG1lLmFkZElucHV0UnVsZShmdW5jdGlvbiAocm9vdCkgew0KICAgICAgICB2YXIgYWxsb3dEaXZUcmFuc1RvUCA9IHRoaXMub3B0aW9ucy5hbGxvd0RpdlRyYW5zVG9QOw0KICAgICAgICB2YXIgdmFsOw0KICAgICAgICAvL+i/m+ihjOm7mOiupOeahOWkhOeQhg0KICAgICAgICByb290LnRyYXZlcnNhbChmdW5jdGlvbiAobm9kZSkgew0KICAgICAgICAgICAgaWYgKG5vZGUudHlwZSA9PSAnZWxlbWVudCcpIHsNCiAgICAgICAgICAgICAgICBpZiAoIWR0ZC4kY2RhdGFbbm9kZS50YWdOYW1lXSAmJiBtZS5vcHRpb25zLmF1dG9DbGVhckVtcHR5Tm9kZSAmJiBkdGQuJGlubGluZVtub2RlLnRhZ05hbWVdICYmICFkdGQuJGVtcHR5W25vZGUudGFnTmFtZV0gJiYgKCFub2RlLmF0dHJzIHx8IHV0aWxzLmlzRW1wdHlPYmplY3Qobm9kZS5hdHRycykpKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICghbm9kZS5maXJzdENoaWxkKCkpIG5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChub2RlKTsNCiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAobm9kZS50YWdOYW1lID09ICdzcGFuJyAmJiAoIW5vZGUuYXR0cnMgfHwgdXRpbHMuaXNFbXB0eU9iamVjdChub2RlLmF0dHJzKSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChub2RlLCB0cnVlKQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgc3dpdGNoIChub2RlLnRhZ05hbWUpIHsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3R5bGUnOg0KICAgICAgICAgICAgICAgICAgICBjYXNlICdzY3JpcHQnOg0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5zZXRBdHRyKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZGF0YV90YWc6IG5vZGUudGFnTmFtZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZGF0YV9kYXRhOiBlbmNvZGVVUklDb21wb25lbnQobm9kZS5pbm5lclRleHQoKSB8fCAnJykNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS50YWdOYW1lID0gJ2Rpdic7DQogICAgICAgICAgICAgICAgICAgICAgICBub2RlLnJlbW92ZUNoaWxkKG5vZGUuZmlyc3RDaGlsZCgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICBjYXNlICdhJzoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWwgPSBub2RlLmdldEF0dHIoJ2hyZWYnKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuc2V0QXR0cignX2hyZWYnLCB2YWwpDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAnaW1nJzoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vdG9kbyBiYXNlNjTmmoLml7bljrvmjonvvIzlkI7ovrnlgZrov5znqIvlm77niYfkuIrkvKDlkI7vvIzlubLmjonov5nkuKoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWwgPSBub2RlLmdldEF0dHIoJ3NyYycpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKC9eZGF0YTovLnRlc3QodmFsKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobm9kZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuc2V0QXR0cignX3NyYycsIG5vZGUuZ2V0QXR0cignc3JjJykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NwYW4nOg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJyb3dzZXIud2Via2l0ICYmICh2YWwgPSBub2RlLmdldFN0eWxlKCd3aGl0ZS1zcGFjZScpKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgvbm93cmFwfG5vcm1hbC8udGVzdCh2YWwpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuc2V0U3R5bGUoJ3doaXRlLXNwYWNlJywgJycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobWUub3B0aW9ucy5hdXRvQ2xlYXJFbXB0eU5vZGUgJiYgdXRpbHMuaXNFbXB0eU9iamVjdChub2RlLmF0dHJzKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUsIHRydWUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAncCc6DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsID0gbm9kZS5nZXRBdHRyKCdhbGlnbicpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5zZXRBdHRyKCdhbGlnbicpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuc2V0U3R5bGUoJ3RleHQtYWxpZ24nLCB2YWwpDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAvL3RyYWNlOjM0MzENCi8vICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNzc1N0eWxlID0gbm9kZS5nZXRBdHRyKCdzdHlsZScpOw0KLy8gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3NzU3R5bGUpIHsNCi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNzc1N0eWxlID0gY3NzU3R5bGUucmVwbGFjZSgvKG1hcmdpbnxwYWRkaW5nKVteO10rL2csICcnKTsNCi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuc2V0QXR0cignc3R5bGUnLCBjc3NTdHlsZSkNCi8vDQovLyAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbm9kZS5maXJzdENoaWxkKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLmlubmVySFRNTChicm93c2VyLmllID8gJyZuYnNwOycgOiAnPGJyLz4nKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgJ2Rpdic6DQogICAgICAgICAgICAgICAgICAgICAgICBpZihub2RlLmdldEF0dHIoJ2NkYXRhX3RhZycpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIC8v6ZKI5a+55Luj56CB6L+Z6YeM5LiN5aSE55CG5o+S5YWl5Luj56CB55qEZGl2DQogICAgICAgICAgICAgICAgICAgICAgICB2YWwgPSBub2RlLmdldEF0dHIoJ2NsYXNzJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZih2YWwgJiYgL15saW5lIG51bWJlclxkKy8udGVzdCh2YWwpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFhbGxvd0RpdlRyYW5zVG9QKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0bXBOb2RlLCBwID0gVUUudU5vZGUuY3JlYXRlRWxlbWVudCgncCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHRtcE5vZGUgPSBub2RlLmZpcnN0Q2hpbGQoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0bXBOb2RlLnR5cGUgPT0gJ3RleHQnIHx8ICFVRS5kb20uZHRkLiRibG9ja1t0bXBOb2RlLnRhZ05hbWVdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAuYXBwZW5kQ2hpbGQodG1wTm9kZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHAuZmlyc3RDaGlsZCgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHAsIG5vZGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcCA9IFVFLnVOb2RlLmNyZWF0ZUVsZW1lbnQoJ3AnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUodG1wTm9kZSwgbm9kZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocC5maXJzdENoaWxkKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHAsIG5vZGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RsJzoNCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUudGFnTmFtZSA9ICd1bCc7DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZHQnOg0KICAgICAgICAgICAgICAgICAgICBjYXNlICdkZCc6DQogICAgICAgICAgICAgICAgICAgICAgICBub2RlLnRhZ05hbWUgPSAnbGknOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgJ2xpJzoNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjbGFzc05hbWUgPSBub2RlLmdldEF0dHIoJ2NsYXNzJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNsYXNzTmFtZSB8fCAhL2xpc3RcLS8udGVzdChjbGFzc05hbWUpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5zZXRBdHRyKCkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0bXBOb2RlcyA9IG5vZGUuZ2V0Tm9kZXNCeVRhZ05hbWUoJ29sIHVsJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBVRS51dGlscy5lYWNoKHRtcE5vZGVzLCBmdW5jdGlvbiAobikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUucGFyZW50Tm9kZS5pbnNlcnRBZnRlcihuLCBub2RlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgJ3RkJzoNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAndGgnOg0KICAgICAgICAgICAgICAgICAgICBjYXNlICdjYXB0aW9uJzoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFub2RlLmNoaWxkcmVuIHx8ICFub2RlLmNoaWxkcmVuLmxlbmd0aCl7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLmFwcGVuZENoaWxkKGJyb3dzZXIuaWUgPyBVRS51Tm9kZS5jcmVhdGVUZXh0KCcgJykgOiBVRS51Tm9kZS5jcmVhdGVFbGVtZW50KCdicicpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYobm9kZS50eXBlID09ICdjb21tZW50Jyl7DQogICAgICAgICAgICAgICAgbm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KQ0KDQogICAgfSk7DQoNCiAgICAvL+S7jue8lui+keWZqOWHuuWOu+eahOWGheWuueWkhOeQhg0KICAgIG1lLmFkZE91dHB1dFJ1bGUoZnVuY3Rpb24gKHJvb3QpIHsNCg0KICAgICAgICB2YXIgdmFsOw0KICAgICAgICByb290LnRyYXZlcnNhbChmdW5jdGlvbiAobm9kZSkgew0KICAgICAgICAgICAgaWYgKG5vZGUudHlwZSA9PSAnZWxlbWVudCcpIHsNCg0KICAgICAgICAgICAgICAgIGlmIChtZS5vcHRpb25zLmF1dG9DbGVhckVtcHR5Tm9kZSAmJiBkdGQuJGlubGluZVtub2RlLnRhZ05hbWVdICYmICFkdGQuJGVtcHR5W25vZGUudGFnTmFtZV0gJiYgKCFub2RlLmF0dHJzIHx8IHV0aWxzLmlzRW1wdHlPYmplY3Qobm9kZS5hdHRycykpKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKCFub2RlLmZpcnN0Q2hpbGQoKSkgbm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUpOw0KICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChub2RlLnRhZ05hbWUgPT0gJ3NwYW4nICYmICghbm9kZS5hdHRycyB8fCB1dGlscy5pc0VtcHR5T2JqZWN0KG5vZGUuYXR0cnMpKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUsIHRydWUpDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBzd2l0Y2ggKG5vZGUudGFnTmFtZSkgew0KICAgICAgICAgICAgICAgICAgICBjYXNlICdkaXYnOg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbCA9IG5vZGUuZ2V0QXR0cignY2RhdGFfdGFnJykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLnRhZ05hbWUgPSB2YWw7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5hcHBlbmRDaGlsZChVRS51Tm9kZS5jcmVhdGVUZXh0KG5vZGUuZ2V0QXR0cignY2RhdGFfZGF0YScpKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5zZXRBdHRyKHtjZGF0YV90YWc6ICcnLCBjZGF0YV9kYXRhOiAnJ30pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgJ2EnOg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbCA9IG5vZGUuZ2V0QXR0cignX2hyZWYnKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuc2V0QXR0cih7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdocmVmJzogdmFsLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnX2hyZWYnOiAnJw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAnaW1nJzoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWwgPSBub2RlLmdldEF0dHIoJ19zcmMnKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuc2V0QXR0cih7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzcmMnOiBub2RlLmdldEF0dHIoJ19zcmMnKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ19zcmMnOiAnJw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9KQ0KDQoNCiAgICB9KTsNCn07DQoKLy8vaW1wb3J0IGNvcmUNCi8qKg0KICogQGRlc2NyaXB0aW9uIOaPkuWFpeWGheWuuQ0KICogQG5hbWUgYmFpZHUuZWRpdG9yLmV4ZWNDb21tYW5kDQogKiBAcGFyYW0gICB7U3RyaW5nfSAgIGNtZE5hbWUgICAgIGluc2VydGh0bWzmj5LlhaXlhoXlrrnnmoTlkb3ku6QNCiAqIEBwYXJhbSAgIHtTdHJpbmd9ICAgaHRtbCAgICAgICAgICAgICAgICDopoHmj5LlhaXnmoTlhoXlrrkNCiAqIEBhdXRob3IgemhhbnlpDQogKi8NClVFLmNvbW1hbmRzWydpbnNlcnRodG1sJ10gPSB7DQogICAgZXhlY0NvbW1hbmQ6IGZ1bmN0aW9uIChjb21tYW5kLGh0bWwsbm90TmVlZEZpbHRlcil7DQogICAgICAgIHZhciBtZSA9IHRoaXMsDQogICAgICAgICAgICByYW5nZSwNCiAgICAgICAgICAgIGRpdjsNCiAgICAgICAgaWYoIWh0bWwpew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICAgIGlmKG1lLmZpcmVFdmVudCgnYmVmb3JlaW5zZXJ0aHRtbCcsaHRtbCkgPT09IHRydWUpew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICAgIHJhbmdlID0gbWUuc2VsZWN0aW9uLmdldFJhbmdlKCk7DQogICAgICAgIGRpdiA9IHJhbmdlLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdkaXYnICk7DQogICAgICAgIGRpdi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7DQoNCiAgICAgICAgaWYgKCFub3ROZWVkRmlsdGVyKSB7DQogICAgICAgICAgICB2YXIgcm9vdCA9IFVFLmh0bWxwYXJzZXIoaHRtbCk7DQogICAgICAgICAgICAvL+WmguaenOe7meS6hui/h+a7pOinhOWImeWwseWFiOi/m+ihjOi/h+a7pA0KICAgICAgICAgICAgaWYobWUub3B0aW9ucy5maWx0ZXJSdWxlcyl7DQogICAgICAgICAgICAgICAgVUUuZmlsdGVyTm9kZShyb290LG1lLm9wdGlvbnMuZmlsdGVyUnVsZXMpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy/miafooYzpu5jorqTnmoTlpITnkIYNCiAgICAgICAgICAgIG1lLmZpbHRlcklucHV0UnVsZShyb290KTsNCiAgICAgICAgICAgIGh0bWwgPSByb290LnRvSHRtbCgpDQogICAgICAgIH0NCiAgICAgICAgZGl2LmlubmVySFRNTCA9IHV0aWxzLnRyaW0oIGh0bWwgKTsNCg0KICAgICAgICBpZiAoICFyYW5nZS5jb2xsYXBzZWQgKSB7DQogICAgICAgICAgICB2YXIgdG1wTm9kZSA9IHJhbmdlLnN0YXJ0Q29udGFpbmVyOw0KICAgICAgICAgICAgaWYoZG9tVXRpbHMuaXNGaWxsQ2hhcih0bXBOb2RlKSl7DQogICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnRCZWZvcmUodG1wTm9kZSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRtcE5vZGUgPSByYW5nZS5lbmRDb250YWluZXI7DQogICAgICAgICAgICBpZihkb21VdGlscy5pc0ZpbGxDaGFyKHRtcE5vZGUpKXsNCiAgICAgICAgICAgICAgICByYW5nZS5zZXRFbmRBZnRlcih0bXBOb2RlKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmFuZ2UudHh0VG9FbG1Cb3VuZGFyeSgpOw0KICAgICAgICAgICAgLy/nu5PmnZ/ovrnnlYzlj6/og73mlL7liLDkuoZicueahOWJjei+ue+8jOimgeaKimJy5YyF5ZCr6L+b5p2lDQogICAgICAgICAgICAvLyB4W3h4eF08YnIvPg0KICAgICAgICAgICAgaWYocmFuZ2UuZW5kQ29udGFpbmVyICYmIHJhbmdlLmVuZENvbnRhaW5lci5ub2RlVHlwZSA9PSAxKXsNCiAgICAgICAgICAgICAgICB0bXBOb2RlID0gcmFuZ2UuZW5kQ29udGFpbmVyLmNoaWxkTm9kZXNbcmFuZ2UuZW5kT2Zmc2V0XTsNCiAgICAgICAgICAgICAgICBpZih0bXBOb2RlICYmIGRvbVV0aWxzLmlzQnIodG1wTm9kZSkpew0KICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRFbmRBZnRlcih0bXBOb2RlKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZihyYW5nZS5zdGFydE9mZnNldCA9PSAwKXsNCiAgICAgICAgICAgICAgICB0bXBOb2RlID0gcmFuZ2Uuc3RhcnRDb250YWluZXI7DQogICAgICAgICAgICAgICAgaWYoZG9tVXRpbHMuaXNCb3VuZGFyeU5vZGUodG1wTm9kZSwnZmlyc3RDaGlsZCcpICl7DQogICAgICAgICAgICAgICAgICAgIHRtcE5vZGUgPSByYW5nZS5lbmRDb250YWluZXI7DQogICAgICAgICAgICAgICAgICAgIGlmKHJhbmdlLmVuZE9mZnNldCA9PSAodG1wTm9kZS5ub2RlVHlwZSA9PSAzID8gdG1wTm9kZS5ub2RlVmFsdWUubGVuZ3RoIDogdG1wTm9kZS5jaGlsZE5vZGVzLmxlbmd0aCkgJiYgZG9tVXRpbHMuaXNCb3VuZGFyeU5vZGUodG1wTm9kZSwnbGFzdENoaWxkJykpew0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuYm9keS5pbm5lckhUTUwgPSAnPHA+JysoYnJvd3Nlci5pZSA/ICcnIDogJzxici8+JykrJzwvcD4nOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQobWUuYm9keS5maXJzdENoaWxkLDApLmNvbGxhcHNlKHRydWUpDQoNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICFyYW5nZS5jb2xsYXBzZWQgJiYgcmFuZ2UuZGVsZXRlQ29udGVudHMoKTsNCiAgICAgICAgICAgIGlmKHJhbmdlLnN0YXJ0Q29udGFpbmVyLm5vZGVUeXBlID09IDEpew0KICAgICAgICAgICAgICAgIHZhciBjaGlsZCA9IHJhbmdlLnN0YXJ0Q29udGFpbmVyLmNoaWxkTm9kZXNbcmFuZ2Uuc3RhcnRPZmZzZXRdLHByZTsNCiAgICAgICAgICAgICAgICBpZihjaGlsZCAmJiBkb21VdGlscy5pc0Jsb2NrRWxtKGNoaWxkKSAmJiAocHJlID0gY2hpbGQucHJldmlvdXNTaWJsaW5nKSAmJiBkb21VdGlscy5pc0Jsb2NrRWxtKHByZSkpew0KICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRFbmQocHJlLHByZS5jaGlsZE5vZGVzLmxlbmd0aCkuY29sbGFwc2UoKTsNCiAgICAgICAgICAgICAgICAgICAgd2hpbGUoY2hpbGQuZmlyc3RDaGlsZCl7DQogICAgICAgICAgICAgICAgICAgICAgICBwcmUuYXBwZW5kQ2hpbGQoY2hpbGQuZmlyc3RDaGlsZCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKGNoaWxkKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KDQoNCiAgICAgICAgdmFyIGNoaWxkLHBhcmVudCxwcmUsdG1wLGhhZEJyZWFrID0gMCwgbmV4dE5vZGU7DQogICAgICAgIC8v5aaC5p6c5b2T5YmN5L2N572u6YCJ5Lit5LqGZmlsbGNoYXLopoHlubLmjonvvIzopoHkuI3kvJrkuqfnlJ/nqbrooYwNCiAgICAgICAgaWYocmFuZ2UuaW5GaWxsQ2hhcigpKXsNCiAgICAgICAgICAgIGNoaWxkID0gcmFuZ2Uuc3RhcnRDb250YWluZXI7DQogICAgICAgICAgICBpZihkb21VdGlscy5pc0ZpbGxDaGFyKGNoaWxkKSl7DQogICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnRCZWZvcmUoY2hpbGQpLmNvbGxhcHNlKHRydWUpOw0KICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShjaGlsZCk7DQogICAgICAgICAgICB9ZWxzZSBpZihkb21VdGlscy5pc0ZpbGxDaGFyKGNoaWxkLHRydWUpKXsNCiAgICAgICAgICAgICAgICBjaGlsZC5ub2RlVmFsdWUgPSBjaGlsZC5ub2RlVmFsdWUucmVwbGFjZShmaWxsQ2hhclJlZywnJyk7DQogICAgICAgICAgICAgICAgcmFuZ2Uuc3RhcnRPZmZzZXQtLTsNCiAgICAgICAgICAgICAgICByYW5nZS5jb2xsYXBzZWQgJiYgcmFuZ2UuY29sbGFwc2UodHJ1ZSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAvL+WIl+ihqOWNleeLrOWkhOeQhg0KICAgICAgICB2YXIgbGkgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKHJhbmdlLnN0YXJ0Q29udGFpbmVyLCdsaScsdHJ1ZSk7DQogICAgICAgIGlmKGxpKXsNCiAgICAgICAgICAgIHZhciBuZXh0LGxhc3Q7DQogICAgICAgICAgICB3aGlsZShjaGlsZCA9IGRpdi5maXJzdENoaWxkKXsNCiAgICAgICAgICAgICAgICAvL+mSiOWvuWhy5Y2V54us5aSE55CG5LiA5LiL5YWIDQogICAgICAgICAgICAgICAgd2hpbGUoY2hpbGQgJiYgKGNoaWxkLm5vZGVUeXBlID09IDMgfHwgIWRvbVV0aWxzLmlzQmxvY2tFbG0oY2hpbGQpIHx8IGNoaWxkLnRhZ05hbWU9PSdIUicgKSl7DQogICAgICAgICAgICAgICAgICAgIG5leHQgPSBjaGlsZC5uZXh0U2libGluZzsNCiAgICAgICAgICAgICAgICAgICAgcmFuZ2UuaW5zZXJ0Tm9kZSggY2hpbGQpLmNvbGxhcHNlKCk7DQogICAgICAgICAgICAgICAgICAgIGxhc3QgPSBjaGlsZDsNCiAgICAgICAgICAgICAgICAgICAgY2hpbGQgPSBuZXh0Ow0KDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmKGNoaWxkKXsNCiAgICAgICAgICAgICAgICAgICAgaWYoL14ob2x8dWwpJC9pLnRlc3QoY2hpbGQudGFnTmFtZSkpew0KICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUoY2hpbGQuZmlyc3RDaGlsZCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdCA9IGNoaWxkLmZpcnN0Q2hpbGQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMuaW5zZXJ0QWZ0ZXIobGksY2hpbGQuZmlyc3RDaGlsZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGkgPSBsaS5uZXh0U2libGluZzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShjaGlsZCkNCiAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG1wTGk7DQogICAgICAgICAgICAgICAgICAgICAgICBuZXh0ID0gY2hpbGQubmV4dFNpYmxpbmc7DQogICAgICAgICAgICAgICAgICAgICAgICB0bXBMaSA9IG1lLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5pbnNlcnRBZnRlcihsaSx0bXBMaSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0bXBMaS5hcHBlbmRDaGlsZChjaGlsZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBsYXN0ID0gY2hpbGQ7DQogICAgICAgICAgICAgICAgICAgICAgICBjaGlsZCA9IG5leHQ7DQogICAgICAgICAgICAgICAgICAgICAgICBsaSA9IHRtcExpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgbGkgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKHJhbmdlLnN0YXJ0Q29udGFpbmVyLCdsaScsdHJ1ZSk7DQogICAgICAgICAgICBpZihkb21VdGlscy5pc0VtcHR5QmxvY2sobGkpKXsNCiAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUobGkpDQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZihsYXN0KXsNCg0KICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0QWZ0ZXIobGFzdCkuY29sbGFwc2UodHJ1ZSkuc2VsZWN0KHRydWUpDQogICAgICAgICAgICB9DQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAgd2hpbGUgKCBjaGlsZCA9IGRpdi5maXJzdENoaWxkICkgew0KICAgICAgICAgICAgICAgIGlmKGhhZEJyZWFrKXsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7DQogICAgICAgICAgICAgICAgICAgIHdoaWxlKGNoaWxkICYmIChjaGlsZC5ub2RlVHlwZSA9PSAzIHx8ICFkdGQuJGJsb2NrW2NoaWxkLnRhZ05hbWVdKSl7DQogICAgICAgICAgICAgICAgICAgICAgICBuZXh0Tm9kZSA9IGNoaWxkLm5leHRTaWJsaW5nOw0KICAgICAgICAgICAgICAgICAgICAgICAgcC5hcHBlbmRDaGlsZChjaGlsZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBjaGlsZCA9IG5leHROb2RlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmKHAuZmlyc3RDaGlsZCl7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkID0gcA0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJhbmdlLmluc2VydE5vZGUoIGNoaWxkICk7DQogICAgICAgICAgICAgICAgbmV4dE5vZGUgPSBjaGlsZC5uZXh0U2libGluZzsNCiAgICAgICAgICAgICAgICBpZiAoICFoYWRCcmVhayAmJiBjaGlsZC5ub2RlVHlwZSA9PSBkb21VdGlscy5OT0RFX0VMRU1FTlQgJiYgZG9tVXRpbHMuaXNCbG9ja0VsbSggY2hpbGQgKSApew0KDQogICAgICAgICAgICAgICAgICAgIHBhcmVudCA9IGRvbVV0aWxzLmZpbmRQYXJlbnQoIGNoaWxkLGZ1bmN0aW9uICggbm9kZSApeyByZXR1cm4gZG9tVXRpbHMuaXNCbG9ja0VsbSggbm9kZSApOyB9ICk7DQogICAgICAgICAgICAgICAgICAgIGlmICggcGFyZW50ICYmIHBhcmVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgIT0gJ2JvZHknICYmICEoZHRkW3BhcmVudC50YWdOYW1lXVtjaGlsZC5ub2RlTmFtZV0gJiYgY2hpbGQucGFyZW50Tm9kZSA9PT0gcGFyZW50KSl7DQogICAgICAgICAgICAgICAgICAgICAgICBpZighZHRkW3BhcmVudC50YWdOYW1lXVtjaGlsZC5ub2RlTmFtZV0pew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZSA9IHBhcmVudDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcCA9IGNoaWxkLnBhcmVudE5vZGU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHRtcCAhPT0gcGFyZW50KXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlID0gdG1wOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXAgPSB0bXAucGFyZW50Tm9kZTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5icmVha1BhcmVudCggY2hpbGQsIHByZSB8fCB0bXAgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8v5Y675o6JYnJlYWvlkI7liY3kuIDkuKrlpJrkvZnnmoToioLngrkgIDxwPnw8W3A+ID09PiA8cD48L3A+PGRpdj48L2Rpdj48cD58PC9wPg0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByZSA9IGNoaWxkLnByZXZpb3VzU2libGluZzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnRyaW1XaGl0ZVRleHROb2RlKHByZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZighcHJlLmNoaWxkTm9kZXMubGVuZ3RoKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUocHJlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIC8vdHJhY2U6MjAxMizlnKjpnZ5pZeeahOaDheWGte+8jOWIh+W8gOWQjuWJqeS4i+eahOiKgueCueacieWPr+iDveS4jeiDveeCueWFpeWFieagh+a3u+WKoGJy5Y2g5L2NDQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFicm93c2VyLmllICYmDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKG5leHQgPSBjaGlsZC5uZXh0U2libGluZykgJiYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5pc0Jsb2NrRWxtKG5leHQpICYmDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dC5sYXN0Q2hpbGQgJiYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhZG9tVXRpbHMuaXNCcihuZXh0Lmxhc3RDaGlsZCkpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHQuYXBwZW5kQ2hpbGQobWUuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnInKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBoYWRCcmVhayA9IDE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdmFyIG5leHQgPSBjaGlsZC5uZXh0U2libGluZzsNCiAgICAgICAgICAgICAgICBpZighZGl2LmZpcnN0Q2hpbGQgJiYgbmV4dCAmJiBkb21VdGlscy5pc0Jsb2NrRWxtKG5leHQpKXsNCg0KICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydChuZXh0LDApLmNvbGxhcHNlKHRydWUpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmFuZ2Uuc2V0RW5kQWZ0ZXIoIGNoaWxkICkuY29sbGFwc2UoKTsNCg0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBjaGlsZCA9IHJhbmdlLnN0YXJ0Q29udGFpbmVyOw0KDQogICAgICAgICAgICBpZihuZXh0Tm9kZSAmJiBkb21VdGlscy5pc0JyKG5leHROb2RlKSl7DQogICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKG5leHROb2RlKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy/nlKhjaHJvbWXlj6/og73mnInnqbrnmb3lsZXkvY3nrKYNCiAgICAgICAgICAgIGlmKGRvbVV0aWxzLmlzQmxvY2tFbG0oY2hpbGQpICYmIGRvbVV0aWxzLmlzRW1wdHlOb2RlKGNoaWxkKSl7DQogICAgICAgICAgICAgICAgaWYobmV4dE5vZGUgPSBjaGlsZC5uZXh0U2libGluZyl7DQogICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShjaGlsZCk7DQogICAgICAgICAgICAgICAgICAgIGlmKG5leHROb2RlLm5vZGVUeXBlID09IDEgJiYgZHRkLiRibG9ja1tuZXh0Tm9kZS50YWdOYW1lXSl7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KG5leHROb2RlLDApLmNvbGxhcHNlKHRydWUpLnNocmlua0JvdW5kYXJ5KCkNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH1lbHNlew0KDQogICAgICAgICAgICAgICAgICAgIHRyeXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkLmlubmVySFRNTCA9IGJyb3dzZXIuaWUgPyBkb21VdGlscy5maWxsQ2hhciA6ICc8YnIvPic7DQogICAgICAgICAgICAgICAgICAgIH1jYXRjaChlKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0QmVmb3JlKGNoaWxkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShjaGlsZCkNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB9DQogICAgICAgICAgICAvL+WKoOS4inRydWXlm6DkuLrlnKjliKDpmaTooajmg4XnrYnml7bkvJrliKDkuKTmrKHvvIznrKzkuIDmrKHmmK/liKDnmoRmaWxsRGF0YQ0KICAgICAgICAgICAgdHJ5ew0KICAgICAgICAgICAgICAgIHJhbmdlLnNlbGVjdCh0cnVlKTsNCiAgICAgICAgICAgIH1jYXRjaChlKXt9DQoNCiAgICAgICAgfQ0KDQoNCg0KICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7DQogICAgICAgICAgICByYW5nZSA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpOw0KICAgICAgICAgICAgcmFuZ2Uuc2Nyb2xsVG9WaWV3KG1lLmF1dG9IZWlnaHRFbmFibGVkLG1lLmF1dG9IZWlnaHRFbmFibGVkID8gZG9tVXRpbHMuZ2V0WFkobWUuaWZyYW1lKS55OjApOw0KICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCdhZnRlcmluc2VydGh0bWwnKTsNCiAgICAgICAgfSwyMDApOw0KICAgIH0NCn07DQoKLy8vaW1wb3J0IGNvcmUNCi8vL2NvbW1hbmRzIOiHquWKqOaOkueJiA0KLy8vY29tbWFuZHNOYW1lICBhdXRvdHlwZXNldA0KLy8vY29tbWFuZHNUaXRsZSAg6Ieq5Yqo5o6S54mIDQovKioNCiAqIOiHquWKqOaOkueJiA0KICogQGZ1bmN0aW9uDQogKiBAbmFtZSBiYWlkdS5lZGl0b3IuZXhlY0NvbW1hbmRzDQogKi8NCg0KVUUucGx1Z2luc1snYXV0b3R5cGVzZXQnXSA9IGZ1bmN0aW9uKCl7DQoNCiAgICB0aGlzLnNldE9wdCh7J2F1dG90eXBlc2V0Jzp7DQogICAgICAgIG1lcmdlRW1wdHlsaW5lIDogdHJ1ZSwgICAgICAgICAgLy/lkIjlubbnqbrooYwNCiAgICAgICAgICAgIHJlbW92ZUNsYXNzIDogdHJ1ZSwgICAgICAgICAgICAvL+WOu+aOieWGl+S9meeahGNsYXNzDQogICAgICAgICAgICByZW1vdmVFbXB0eWxpbmUgOiBmYWxzZSwgICAgICAgIC8v5Y675o6J56m66KGMDQogICAgICAgICAgICB0ZXh0QWxpZ24gOiAibGVmdCIsICAgICAgICAgICAgIC8v5q616JC955qE5o6S54mI5pa55byP77yM5Y+v5Lul5pivIGxlZnQscmlnaHQsY2VudGVyLGp1c3RpZnkg5Y675o6J6L+Z5Liq5bGe5oCn6KGo56S65LiN5omn6KGM5o6S54mIDQogICAgICAgICAgICBpbWFnZUJsb2NrTGluZSA6ICdjZW50ZXInLCAgICAgIC8v5Zu+54mH55qE5rWu5Yqo5pa55byP77yM54us5Y2g5LiA6KGM5Ymn5LitLOW3puWPs+a1ruWKqO+8jOm7mOiupDogY2VudGVyLGxlZnQscmlnaHQsbm9uZSDljrvmjonov5nkuKrlsZ7mgKfooajnpLrkuI3miafooYzmjpLniYgNCiAgICAgICAgICAgIHBhc3RlRmlsdGVyIDogZmFsc2UsICAgICAgICAgICAgIC8v5qC55o2u6KeE5YiZ6L+H5ruk5rKh5LqL57KY6LS06L+b5p2l55qE5YaF5a65DQogICAgICAgICAgICBjbGVhckZvbnRTaXplIDogZmFsc2UsICAgICAgICAgICAvL+WOu+aOieaJgOacieeahOWGheW1jOWtl+WPt++8jOS9v+eUqOe8lui+keWZqOm7mOiupOeahOWtl+WPtw0KICAgICAgICAgICAgY2xlYXJGb250RmFtaWx5IDogZmFsc2UsICAgICAgICAgLy/ljrvmjonmiYDmnInnmoTlhoXltYzlrZfkvZPvvIzkvb/nlKjnvJbovpHlmajpu5jorqTnmoTlrZfkvZMNCiAgICAgICAgICAgIHJlbW92ZUVtcHR5Tm9kZSA6IGZhbHNlLCAgICAgICAgIC8vIOWOu+aOieepuuiKgueCuQ0KICAgICAgICAgICAgLy/lj6/ku6XljrvmjonnmoTmoIfnrb4NCiAgICAgICAgICAgIHJlbW92ZVRhZ05hbWVzIDogdXRpbHMuZXh0ZW5kKHtkaXY6MX0sZHRkLiRyZW1vdmVFbXB0eSksDQogICAgICAgICAgICBpbmRlbnQgOiBmYWxzZSwgICAgICAgICAgICAgICAgICAvLyDooYzpppbnvKnov5sNCiAgICAgICAgICAgIGluZGVudFZhbHVlIDogJzJlbScgICAgICAgICAgICAgLy/ooYzpppbnvKnov5vnmoTlpKflsI8NCiAgICB9fSk7DQogICAgdmFyIG1lID0gdGhpcywNCiAgICAgICAgb3B0ID0gbWUub3B0aW9ucy5hdXRvdHlwZXNldCwNCiAgICAgICAgcmVtYWluQ2xhc3MgPSB7DQogICAgICAgICAgICAnc2VsZWN0VGRDbGFzcyc6MSwNCiAgICAgICAgICAgICdwYWdlYnJlYWsnOjEsDQogICAgICAgICAgICAnYW5jaG9yY2xhc3MnOjENCiAgICAgICAgfSwNCiAgICAgICAgcmVtYWluVGFnID0gew0KICAgICAgICAgICAgJ2xpJzoxDQogICAgICAgIH0sDQogICAgICAgIHRhZ3MgPSB7DQogICAgICAgICAgICBkaXY6MSwNCiAgICAgICAgICAgIHA6MSwNCiAgICAgICAgICAgIC8vdHJhY2U6MjE4MyDov5nkupvkuZ/orqTkuLrmmK/ooYwNCiAgICAgICAgICAgIGJsb2NrcXVvdGU6MSxjZW50ZXI6MSxoMToxLGgyOjEsaDM6MSxoNDoxLGg1OjEsaDY6MSwNCiAgICAgICAgICAgIHNwYW46MQ0KICAgICAgICB9LA0KICAgICAgICBoaWdobGlnaHRDb250Ow0KICAgIC8v5Y2H57qn5LqG54mI5pys77yM5L2G6YWN572u6aG555uu6YeM5rKh5pyJYXV0b3R5cGVzZXQNCiAgICBpZighb3B0KXsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICBmdW5jdGlvbiBpc0xpbmUobm9kZSxub3RFbXB0eSl7DQogICAgICAgIGlmKCFub2RlIHx8IG5vZGUubm9kZVR5cGUgPT0gMykNCiAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICBpZihkb21VdGlscy5pc0JyKG5vZGUpKQ0KICAgICAgICAgICAgcmV0dXJuIDE7DQogICAgICAgIGlmKG5vZGUgJiYgbm9kZS5wYXJlbnROb2RlICYmIHRhZ3Nbbm9kZS50YWdOYW1lLnRvTG93ZXJDYXNlKCldKXsNCiAgICAgICAgICAgIGlmKGhpZ2hsaWdodENvbnQgJiYgaGlnaGxpZ2h0Q29udC5jb250YWlucyhub2RlKQ0KICAgICAgICAgICAgICAgIHx8DQogICAgICAgICAgICAgICAgbm9kZS5nZXRBdHRyaWJ1dGUoJ3BhZ2VicmVhaycpDQogICAgICAgICAgICApew0KICAgICAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gbm90RW1wdHkgPyAhZG9tVXRpbHMuaXNFbXB0eUJsb2NrKG5vZGUpIDogZG9tVXRpbHMuaXNFbXB0eUJsb2NrKG5vZGUsbmV3IFJlZ0V4cCgnW1xccycrZG9tVXRpbHMuZmlsbENoYXINCiAgICAgICAgICAgICAgICArJ10nLCdnJykpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gcmVtb3ZlTm90QXR0cmlidXRlU3Bhbihub2RlKXsNCiAgICAgICAgaWYoIW5vZGUuc3R5bGUuY3NzVGV4dCl7DQogICAgICAgICAgICBkb21VdGlscy5yZW1vdmVBdHRyaWJ1dGVzKG5vZGUsWydzdHlsZSddKTsNCiAgICAgICAgICAgIGlmKG5vZGUudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09ICdzcGFuJyAmJiBkb21VdGlscy5oYXNOb0F0dHJpYnV0ZXMobm9kZSkpew0KICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShub2RlLHRydWUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIGZ1bmN0aW9uIGF1dG90eXBlKHR5cGUsaHRtbCl7DQogICAgICAgIHZhciBtZSA9IHRoaXMsY29udDsNCiAgICAgICAgaWYoaHRtbCl7DQogICAgICAgICAgICBpZighb3B0LnBhc3RlRmlsdGVyKXsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICBjb250ID0gbWUuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgICAgICAgICBjb250LmlubmVySFRNTCA9IGh0bWwuaHRtbDsNCiAgICAgICAgfWVsc2V7DQogICAgICAgICAgICBjb250ID0gbWUuZG9jdW1lbnQuYm9keTsNCiAgICAgICAgfQ0KICAgICAgICB2YXIgbm9kZXMgPSBkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZShjb250LCcqJyk7DQoNCiAgICAgICAgICAvLyDooYzpppbnvKnov5vvvIzmrrXokL3mlrnlkJHvvIzmrrXpl7Tot53vvIzmrrXlhoXpl7Tot50NCiAgICAgICAgZm9yKHZhciBpPTAsY2k7Y2k9bm9kZXNbaSsrXTspew0KDQogICAgICAgICAgICBpZihtZS5maXJlRXZlbnQoJ2V4Y2x1ZGVOb2RlaW5hdXRvdHlwZScsY2kpID09PSB0cnVlKXsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAvL2ZvbnQtc2l6ZQ0KICAgICAgICAgICAgaWYob3B0LmNsZWFyRm9udFNpemUgJiYgY2kuc3R5bGUuZm9udFNpemUpew0KICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZVN0eWxlKGNpLCdmb250LXNpemUnKTsNCg0KICAgICAgICAgICAgICAgIHJlbW92ZU5vdEF0dHJpYnV0ZVNwYW4oY2kpOw0KDQogICAgICAgICAgICB9DQogICAgICAgICAgICAvL2ZvbnQtZmFtaWx5DQogICAgICAgICAgICBpZihvcHQuY2xlYXJGb250RmFtaWx5ICYmIGNpLnN0eWxlLmZvbnRGYW1pbHkpew0KICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZVN0eWxlKGNpLCdmb250LWZhbWlseScpOw0KICAgICAgICAgICAgICAgIHJlbW92ZU5vdEF0dHJpYnV0ZVNwYW4oY2kpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZihpc0xpbmUoY2kpKXsNCiAgICAgICAgICAgICAgICAvL+WQiOW5tuepuuihjA0KICAgICAgICAgICAgICAgIGlmKG9wdC5tZXJnZUVtcHR5bGluZSApew0KICAgICAgICAgICAgICAgICAgICB2YXIgbmV4dCA9IGNpLm5leHRTaWJsaW5nLHRtcE5vZGUsaXNCciA9IGRvbVV0aWxzLmlzQnIoY2kpOw0KICAgICAgICAgICAgICAgICAgICB3aGlsZShpc0xpbmUobmV4dCkpew0KICAgICAgICAgICAgICAgICAgICAgICAgdG1wTm9kZSA9IG5leHQ7DQogICAgICAgICAgICAgICAgICAgICAgICBuZXh0ID0gdG1wTm9kZS5uZXh0U2libGluZzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGlzQnIgJiYgKCFuZXh0IHx8IG5leHQgJiYgIWRvbVV0aWxzLmlzQnIobmV4dCkpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZSh0bXBOb2RlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAvL+WOu+aOieepuuihjO+8jOS/neeVmeWNoOS9jeeahOepuuihjA0KICAgICAgICAgICAgICAgIGlmKG9wdC5yZW1vdmVFbXB0eWxpbmUgJiYgZG9tVXRpbHMuaW5Eb2MoY2ksY29udCkgJiYgIXJlbWFpblRhZ1tjaS5wYXJlbnROb2RlLnRhZ05hbWUudG9Mb3dlckNhc2UoKV0gKXsNCiAgICAgICAgICAgICAgICAgICAgaWYoZG9tVXRpbHMuaXNCcihjaSkpew0KICAgICAgICAgICAgICAgICAgICAgICAgbmV4dCA9IGNpLm5leHRTaWJsaW5nOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYobmV4dCAmJiAhZG9tVXRpbHMuaXNCcihuZXh0KSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKGNpKTsNCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQoNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmKGlzTGluZShjaSx0cnVlKSAmJiBjaS50YWdOYW1lICE9ICdTUEFOJyl7DQogICAgICAgICAgICAgICAgaWYob3B0LmluZGVudCl7DQogICAgICAgICAgICAgICAgICAgIGNpLnN0eWxlLnRleHRJbmRlbnQgPSBvcHQuaW5kZW50VmFsdWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmKG9wdC50ZXh0QWxpZ24pew0KICAgICAgICAgICAgICAgICAgICBjaS5zdHlsZS50ZXh0QWxpZ24gPSBvcHQudGV4dEFsaWduOw0KICAgICAgICAgICAgICAgIH0NCi8vICAgICAgICAgICAgICAgIGlmKG9wdC5saW5lSGVpZ2h0KQ0KLy8gICAgICAgICAgICAgICAgICAgIGNpLnN0eWxlLmxpbmVIZWlnaHQgPSBvcHQubGluZUhlaWdodCArICdjbSc7DQoNCg0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvL+WOu+aOiWNsYXNzLOS/neeVmeeahGNsYXNz5LiN5Y675o6JDQogICAgICAgICAgICBpZihvcHQucmVtb3ZlQ2xhc3MgJiYgY2kuY2xhc3NOYW1lICYmICFyZW1haW5DbGFzc1tjaS5jbGFzc05hbWUudG9Mb3dlckNhc2UoKV0pew0KDQogICAgICAgICAgICAgICAgaWYoaGlnaGxpZ2h0Q29udCAmJiBoaWdobGlnaHRDb250LmNvbnRhaW5zKGNpKSl7DQogICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlQXR0cmlidXRlcyhjaSxbJ2NsYXNzJ10pOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvL+ihqOaDheS4jeWkhOeQhg0KICAgICAgICAgICAgaWYob3B0LmltYWdlQmxvY2tMaW5lICYmIGNpLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PSAnaW1nJyAmJiAhY2kuZ2V0QXR0cmlidXRlKCdlbW90aW9uJykpew0KICAgICAgICAgICAgICAgIGlmKGh0bWwpew0KICAgICAgICAgICAgICAgICAgICB2YXIgaW1nID0gY2k7DQogICAgICAgICAgICAgICAgICAgIHN3aXRjaCAob3B0LmltYWdlQmxvY2tMaW5lKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2xlZnQnOg0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAncmlnaHQnOg0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbm9uZSc6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBOID0gaW1nLnBhcmVudE5vZGUsdG1wTm9kZSxwcmUsbmV4dDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZShkdGQuJGlubGluZVtwTi50YWdOYW1lXSB8fCBwTi50YWdOYW1lID09ICdBJyl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOID0gcE4ucGFyZW50Tm9kZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wTm9kZSA9IHBOOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRtcE5vZGUudGFnTmFtZSA9PSAnUCcgJiYgZG9tVXRpbHMuZ2V0U3R5bGUodG1wTm9kZSwndGV4dC1hbGlnbicpID09ICdjZW50ZXInKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIWRvbVV0aWxzLmlzQm9keSh0bXBOb2RlKSAmJiBkb21VdGlscy5nZXRDaGlsZENvdW50KHRtcE5vZGUsZnVuY3Rpb24obm9kZSl7cmV0dXJuICFkb21VdGlscy5pc0JyKG5vZGUpICYmICFkb21VdGlscy5pc1doaXRlc3BhY2Uobm9kZSl9KSA9PSAxKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZSA9IHRtcE5vZGUucHJldmlvdXNTaWJsaW5nOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dCA9IHRtcE5vZGUubmV4dFNpYmxpbmc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihwcmUgJiYgbmV4dCAmJiBwcmUubm9kZVR5cGUgPT0gMSAmJiAgbmV4dC5ub2RlVHlwZSA9PSAxICYmIHByZS50YWdOYW1lID09IG5leHQudGFnTmFtZSAmJiBkb21VdGlscy5pc0Jsb2NrRWxtKHByZSkpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZS5hcHBlbmRDaGlsZCh0bXBOb2RlLmZpcnN0Q2hpbGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlKG5leHQuZmlyc3RDaGlsZCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZS5hcHBlbmRDaGlsZChuZXh0LmZpcnN0Q2hpbGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUodG1wTm9kZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKG5leHQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMuc2V0U3R5bGUodG1wTm9kZSwndGV4dC1hbGlnbicsJycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMuc2V0U3R5bGUoaW1nLCdmbG9hdCcsb3B0LmltYWdlQmxvY2tMaW5lKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NlbnRlcic6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobWUucXVlcnlDb21tYW5kVmFsdWUoJ2ltYWdlZmxvYXQnKSAhPSAnY2VudGVyJyl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOID0gaW1nLnBhcmVudE5vZGU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnNldFN0eWxlKGltZywnZmxvYXQnLCdub25lJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcE5vZGUgPSBpbWc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlKHBOICYmIGRvbVV0aWxzLmdldENoaWxkQ291bnQocE4sZnVuY3Rpb24obm9kZSl7cmV0dXJuICFkb21VdGlscy5pc0JyKG5vZGUpICYmICFkb21VdGlscy5pc1doaXRlc3BhY2Uobm9kZSl9KSA9PSAxDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiAoZHRkLiRpbmxpbmVbcE4udGFnTmFtZV0gfHwgcE4udGFnTmFtZSA9PSAnQScpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcE5vZGUgPSBwTjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOID0gcE4ucGFyZW50Tm9kZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcE5vZGUgPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnNldEF0dHJpYnV0ZXMocE5vZGUsew0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZTondGV4dC1hbGlnbjpjZW50ZXInDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBOb2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHBOb2RlLHRtcE5vZGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwTm9kZS5hcHBlbmRDaGlsZCh0bXBOb2RlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMuc2V0U3R5bGUodG1wTm9kZSwnZmxvYXQnLCcnKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gbWUuc2VsZWN0aW9uLmdldFJhbmdlKCk7DQogICAgICAgICAgICAgICAgICAgIHJhbmdlLnNlbGVjdE5vZGUoY2kpLnNlbGVjdCgpOw0KICAgICAgICAgICAgICAgICAgICBtZS5leGVjQ29tbWFuZCgnaW1hZ2VmbG9hdCcsb3B0LmltYWdlQmxvY2tMaW5lKTsNCiAgICAgICAgICAgICAgICB9DQoNCg0KDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8v5Y675o6J5YaX5L2Z55qE5qCH562+DQogICAgICAgICAgICBpZihvcHQucmVtb3ZlRW1wdHlOb2RlKXsNCiAgICAgICAgICAgICAgICBpZihvcHQucmVtb3ZlVGFnTmFtZXNbY2kudGFnTmFtZS50b0xvd2VyQ2FzZSgpXSAmJiBkb21VdGlscy5oYXNOb0F0dHJpYnV0ZXMoY2kpICYmIGRvbVV0aWxzLmlzRW1wdHlCbG9jayhjaSkpew0KICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUoY2kpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZihodG1sKXsNCiAgICAgICAgICAgIGh0bWwuaHRtbCA9IGNvbnQuaW5uZXJIVE1MOw0KICAgICAgICB9DQogICAgfQ0KICAgIGlmKG9wdC5wYXN0ZUZpbHRlcil7DQogICAgICAgIG1lLmFkZExpc3RlbmVyKCdiZWZvcmVwYXN0ZScsYXV0b3R5cGUpOw0KICAgIH0NCg0KICAgIG1lLmNvbW1hbmRzWydhdXRvdHlwZXNldCddID0gew0KICAgICAgICBleGVjQ29tbWFuZDpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBtZS5yZW1vdmVMaXN0ZW5lcignYmVmb3JlcGFzdGUnLGF1dG90eXBlKTsNCiAgICAgICAgICAgIGlmKG9wdC5wYXN0ZUZpbHRlcil7DQogICAgICAgICAgICAgICAgbWUuYWRkTGlzdGVuZXIoJ2JlZm9yZXBhc3RlJyxhdXRvdHlwZSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBhdXRvdHlwZS5jYWxsKG1lKQ0KICAgICAgICB9DQoNCiAgICB9Ow0KDQp9Ow0KDQoKLy8vaW1wb3J0IGNvcmUNCi8vL2NvbW1hbmRzIOiHquWKqOaPkOS6pA0KLy8vY29tbWFuZHNOYW1lICBhdXRvc3VibWl0DQovLy9jb21tYW5kc1RpdGxlICDoh6rliqjmj5DkuqQNClVFLnBsdWdpbnNbJ2F1dG9zdWJtaXQnXSA9IGZ1bmN0aW9uKCl7DQogICAgdmFyIG1lID0gdGhpczsNCiAgICBtZS5jb21tYW5kc1snYXV0b3N1Ym1pdCddID0gew0KICAgICAgICBleGVjQ29tbWFuZDpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgbWU9dGhpcywNCiAgICAgICAgICAgICAgICBmb3JtID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShtZS5pZnJhbWUsImZvcm0iLCBmYWxzZSk7DQogICAgICAgICAgICBpZiAoZm9ybSkgICAgew0KICAgICAgICAgICAgICAgIGlmKG1lLmZpcmVFdmVudCgiYmVmb3Jlc3VibWl0Iik9PT1mYWxzZSl7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgbWUuc3luYygpOw0KICAgICAgICAgICAgICAgIGZvcm0uc3VibWl0KCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9Ow0KICAgIC8v5b+r5o236ZSuDQogICAgbWUuYWRkc2hvcnRjdXRrZXkoew0KICAgICAgICAiYXV0b3N1Ym1pdCIgOiAiY3RybCsxMyIgLy/miYvliqjmj5DkuqQNCiAgICB9KTsNCn07DQoKLy8vaW1wb3J0IGNvcmUKLy8vaW1wb3J0IHBsdWdpbnNcaW5zZXJ0aHRtbC5qcwovLy9jb21tYW5kcyDmj5LlhaXlm77niYfvvIzmk43kvZzlm77niYfnmoTlr7npvZDmlrnlvI8KLy8vY29tbWFuZHNOYW1lICBJbnNlcnRJbWFnZSxJbWFnZU5vbmUsSW1hZ2VMZWZ0LEltYWdlUmlnaHQsSW1hZ2VDZW50ZXIKLy8vY29tbWFuZHNUaXRsZSAg5Zu+54mHLOm7mOiupCzlsYXlt6Ys5bGF5Y+zLOWxheS4rQovLy9jb21tYW5kc0RpYWxvZyAgZGlhbG9nc1xpbWFnZQovKioKICogQ3JlYXRlZCBieSAuCiAqIFVzZXI6IHpoYW55aQogKiBmb3IgaW1hZ2UKICovCgpVRS5jb21tYW5kc1snaW1hZ2VmbG9hdCddID0gewogICAgZXhlY0NvbW1hbmQ6ZnVuY3Rpb24gKGNtZCwgYWxpZ24pIHsKICAgICAgICB2YXIgbWUgPSB0aGlzLAogICAgICAgICAgICByYW5nZSA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpOwogICAgICAgIGlmICghcmFuZ2UuY29sbGFwc2VkKSB7CiAgICAgICAgICAgIHZhciBpbWcgPSByYW5nZS5nZXRDbG9zZWROb2RlKCk7CiAgICAgICAgICAgIGlmIChpbWcgJiYgaW1nLnRhZ05hbWUgPT0gJ0lNRycpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoYWxpZ24pIHsKICAgICAgICAgICAgICAgICAgICBjYXNlICdsZWZ0JzoKICAgICAgICAgICAgICAgICAgICBjYXNlICdyaWdodCc6CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnbm9uZSc6CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwTiA9IGltZy5wYXJlbnROb2RlLCB0bXBOb2RlLCBwcmUsIG5leHQ7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChkdGQuJGlubGluZVtwTi50YWdOYW1lXSB8fCBwTi50YWdOYW1lID09ICdBJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcE4gPSBwTi5wYXJlbnROb2RlOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHRtcE5vZGUgPSBwTjsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRtcE5vZGUudGFnTmFtZSA9PSAnUCcgJiYgZG9tVXRpbHMuZ2V0U3R5bGUodG1wTm9kZSwgJ3RleHQtYWxpZ24nKSA9PSAnY2VudGVyJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkb21VdGlscy5pc0JvZHkodG1wTm9kZSkgJiYgZG9tVXRpbHMuZ2V0Q2hpbGRDb3VudCh0bXBOb2RlLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhZG9tVXRpbHMuaXNCcihub2RlKSAmJiAhZG9tVXRpbHMuaXNXaGl0ZXNwYWNlKG5vZGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkgPT0gMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZSA9IHRtcE5vZGUucHJldmlvdXNTaWJsaW5nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHQgPSB0bXBOb2RlLm5leHRTaWJsaW5nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcmUgJiYgbmV4dCAmJiBwcmUubm9kZVR5cGUgPT0gMSAmJiBuZXh0Lm5vZGVUeXBlID09IDEgJiYgcHJlLnRhZ05hbWUgPT0gbmV4dC50YWdOYW1lICYmIGRvbVV0aWxzLmlzQmxvY2tFbG0ocHJlKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmUuYXBwZW5kQ2hpbGQodG1wTm9kZS5maXJzdENoaWxkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKG5leHQuZmlyc3RDaGlsZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlLmFwcGVuZENoaWxkKG5leHQuZmlyc3RDaGlsZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHRtcE5vZGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUobmV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMuc2V0U3R5bGUodG1wTm9kZSwgJ3RleHQtYWxpZ24nLCAnJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2VsZWN0Tm9kZShpbWcpLnNlbGVjdCgpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnNldFN0eWxlKGltZywgJ2Zsb2F0JywgYWxpZ24gPT0gJ25vbmUnID8gJycgOiBhbGlnbik7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGFsaWduID09ICdub25lJyl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmVBdHRyaWJ1dGVzKGltZywnYWxpZ24nKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnY2VudGVyJzoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1lLnF1ZXJ5Q29tbWFuZFZhbHVlKCdpbWFnZWZsb2F0JykgIT0gJ2NlbnRlcicpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOID0gaW1nLnBhcmVudE5vZGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5zZXRTdHlsZShpbWcsICdmbG9hdCcsICcnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZUF0dHJpYnV0ZXMoaW1nLCdhbGlnbicpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wTm9kZSA9IGltZzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChwTiAmJiBkb21VdGlscy5nZXRDaGlsZENvdW50KHBOLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhZG9tVXRpbHMuaXNCcihub2RlKSAmJiAhZG9tVXRpbHMuaXNXaGl0ZXNwYWNlKG5vZGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkgPT0gMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIChkdGQuJGlubGluZVtwTi50YWdOYW1lXSB8fCBwTi50YWdOYW1lID09ICdBJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBOb2RlID0gcE47CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcE4gPSBwTi5wYXJlbnROb2RlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnRCZWZvcmUodG1wTm9kZSkuc2V0Q3Vyc29yKGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOID0gbWUuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwTi5hcHBlbmRDaGlsZCh0bXBOb2RlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnNldFN0eWxlKHRtcE5vZGUsICdmbG9hdCcsICcnKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZS5leGVjQ29tbWFuZCgnaW5zZXJ0SHRtbCcsICc8cCBpZD0iX2ltZ19wYXJlbnRfdG1wIiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXIiPicgKyBwTi5pbm5lckhUTUwgKyAnPC9wPicpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcE5vZGUgPSBtZS5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnX2ltZ19wYXJlbnRfdG1wJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBOb2RlLnJlbW92ZUF0dHJpYnV0ZSgnaWQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcE5vZGUgPSB0bXBOb2RlLmZpcnN0Q2hpbGQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZWxlY3ROb2RlKHRtcE5vZGUpLnNlbGVjdCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/ljrvmjonlkI7ovrnlpJrkvZnnmoTlhYPntKAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHQgPSB0bXBOb2RlLnBhcmVudE5vZGUubmV4dFNpYmxpbmc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV4dCAmJiBkb21VdGlscy5pc0VtcHR5Tm9kZShuZXh0KSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShuZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0sCiAgICBxdWVyeUNvbW1hbmRWYWx1ZTpmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIHJhbmdlID0gdGhpcy5zZWxlY3Rpb24uZ2V0UmFuZ2UoKSwKICAgICAgICAgICAgc3RhcnROb2RlLCBmbG9hdFN0eWxlOwogICAgICAgIGlmIChyYW5nZS5jb2xsYXBzZWQpIHsKICAgICAgICAgICAgcmV0dXJuICdub25lJzsKICAgICAgICB9CiAgICAgICAgc3RhcnROb2RlID0gcmFuZ2UuZ2V0Q2xvc2VkTm9kZSgpOwogICAgICAgIGlmIChzdGFydE5vZGUgJiYgc3RhcnROb2RlLm5vZGVUeXBlID09IDEgJiYgc3RhcnROb2RlLnRhZ05hbWUgPT0gJ0lNRycpIHsKICAgICAgICAgICAgZmxvYXRTdHlsZSA9IHN0YXJ0Tm9kZS5nZXRBdHRyaWJ1dGUoJ2FsaWduJyl8fGRvbVV0aWxzLmdldENvbXB1dGVkU3R5bGUoc3RhcnROb2RlLCAnZmxvYXQnKTsKICAgICAgICAgICAgaWYgKGZsb2F0U3R5bGUgPT0gJ25vbmUnKSB7CiAgICAgICAgICAgICAgICBmbG9hdFN0eWxlID0gZG9tVXRpbHMuZ2V0Q29tcHV0ZWRTdHlsZShzdGFydE5vZGUucGFyZW50Tm9kZSwgJ3RleHQtYWxpZ24nKSA9PSAnY2VudGVyJyA/ICdjZW50ZXInIDogZmxvYXRTdHlsZTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgbGVmdDoxLAogICAgICAgICAgICAgICAgcmlnaHQ6MSwKICAgICAgICAgICAgICAgIGNlbnRlcjoxCiAgICAgICAgICAgIH1bZmxvYXRTdHlsZV0gPyBmbG9hdFN0eWxlIDogJ25vbmUnOwogICAgICAgIH0KICAgICAgICByZXR1cm4gJ25vbmUnOwoKCiAgICB9LAogICAgcXVlcnlDb21tYW5kU3RhdGU6ZnVuY3Rpb24gKCkgewogICAgICAgIHZhciByYW5nZSA9IHRoaXMuc2VsZWN0aW9uLmdldFJhbmdlKCksCiAgICAgICAgICAgIHN0YXJ0Tm9kZTsKCiAgICAgICAgaWYgKHJhbmdlLmNvbGxhcHNlZCkgIHJldHVybiAtMTsKCiAgICAgICAgc3RhcnROb2RlID0gcmFuZ2UuZ2V0Q2xvc2VkTm9kZSgpOwogICAgICAgIGlmIChzdGFydE5vZGUgJiYgc3RhcnROb2RlLm5vZGVUeXBlID09IDEgJiYgc3RhcnROb2RlLnRhZ05hbWUgPT0gJ0lNRycpIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgICAgIHJldHVybiAtMTsKICAgIH0KfTsKClVFLmNvbW1hbmRzWydpbnNlcnRpbWFnZSddID0gewogICAgZXhlY0NvbW1hbmQ6ZnVuY3Rpb24gKGNtZCwgb3B0KSB7CgogICAgICAgIG9wdCA9IHV0aWxzLmlzQXJyYXkob3B0KSA/IG9wdCA6IFtvcHRdOwogICAgICAgIGlmICghb3B0Lmxlbmd0aCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHZhciBtZSA9IHRoaXMsCiAgICAgICAgICAgIHJhbmdlID0gbWUuc2VsZWN0aW9uLmdldFJhbmdlKCksCiAgICAgICAgICAgIGltZyA9IHJhbmdlLmdldENsb3NlZE5vZGUoKTsKICAgICAgICBpZiAoaW1nICYmIC9pbWcvaS50ZXN0KGltZy50YWdOYW1lKSAmJiBpbWcuY2xhc3NOYW1lICE9ICJlZHVpLWZha2VkLXZpZGVvIiAmJiAhaW1nLmdldEF0dHJpYnV0ZSgid29yZF9pbWciKSkgewogICAgICAgICAgICB2YXIgZmlyc3QgPSBvcHQuc2hpZnQoKTsKICAgICAgICAgICAgdmFyIGZsb2F0U3R5bGUgPSBmaXJzdFsnZmxvYXRTdHlsZSddOwogICAgICAgICAgICBkZWxldGUgZmlyc3RbJ2Zsb2F0U3R5bGUnXTsKLy8vLyAgICAgICAgICAgICAgICBpbWcuc3R5bGUuYm9yZGVyID0gKGZpcnN0LmJvcmRlcnx8MCkgKyJweCBzb2xpZCAjMDAwIjsKLy8vLyAgICAgICAgICAgICAgICBpbWcuc3R5bGUubWFyZ2luID0gKGZpcnN0Lm1hcmdpbnx8MCkgKyJweCI7Ci8vICAgICAgICAgICAgICAgIGltZy5zdHlsZS5jc3NUZXh0ICs9ICc7bWFyZ2luOicgKyAoZmlyc3QubWFyZ2lufHwwKSArInB4OyIgKyAnYm9yZGVyOicgKyAoZmlyc3QuYm9yZGVyfHwwKSArInB4IHNvbGlkICMwMDAiOwogICAgICAgICAgICBkb21VdGlscy5zZXRBdHRyaWJ1dGVzKGltZywgZmlyc3QpOwogICAgICAgICAgICBtZS5leGVjQ29tbWFuZCgnaW1hZ2VmbG9hdCcsIGZsb2F0U3R5bGUpOwogICAgICAgICAgICBpZiAob3B0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0QWZ0ZXIoaW1nKS5zZXRDdXJzb3IoZmFsc2UsIHRydWUpOwogICAgICAgICAgICAgICAgbWUuZXhlY0NvbW1hbmQoJ2luc2VydGltYWdlJywgb3B0KTsKICAgICAgICAgICAgfQoKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2YXIgaHRtbCA9IFtdLCBzdHIgPSAnJywgY2k7CiAgICAgICAgICAgIGNpID0gb3B0WzBdOwogICAgICAgICAgICBpZiAob3B0Lmxlbmd0aCA9PSAxKSB7CiAgICAgICAgICAgICAgICBzdHIgPSAnPGltZyBzcmM9IicgKyBjaS5zcmMgKyAnIiAnICsgKGNpLl9zcmMgPyAnIF9zcmM9IicgKyBjaS5fc3JjICsgJyIgJyA6ICcnKSArCiAgICAgICAgICAgICAgICAgICAgKGNpLndpZHRoID8gJ3dpZHRoPSInICsgY2kud2lkdGggKyAnIiAnIDogJycpICsKICAgICAgICAgICAgICAgICAgICAoY2kuaGVpZ2h0ID8gJyBoZWlnaHQ9IicgKyBjaS5oZWlnaHQgKyAnIiAnIDogJycpICsKICAgICAgICAgICAgICAgICAgICAoY2lbJ2Zsb2F0U3R5bGUnXSA9PSAnbGVmdCcgfHwgY2lbJ2Zsb2F0U3R5bGUnXSA9PSAncmlnaHQnID8gJyBzdHlsZT0iZmxvYXQ6JyArIGNpWydmbG9hdFN0eWxlJ10gKyAnOyInIDogJycpICsKICAgICAgICAgICAgICAgICAgICAoY2kudGl0bGUgJiYgY2kudGl0bGUgIT0gIiIgPyAnIHRpdGxlPSInICsgY2kudGl0bGUgKyAnIicgOiAnJykgKwogICAgICAgICAgICAgICAgICAgIChjaS5ib3JkZXIgJiYgY2kuYm9yZGVyICE9ICIwIiA/ICcgYm9yZGVyPSInICsgY2kuYm9yZGVyICsgJyInIDogJycpICsKICAgICAgICAgICAgICAgICAgICAoY2kudGl0bGUgJiYgY2kudGl0bGUgIT0gIiIgPyAnIGFsdD0iJyArIGNpLnRpdGxlICsgJyInIDogJyBhbHQ9ImltYWdlIiAnKSArCiAgICAgICAgICAgICAgICAgICAgKGNpLmhzcGFjZSAmJiBjaS5oc3BhY2UgIT0gIjAiID8gJyBoc3BhY2UgPSAiJyArIGNpLmhzcGFjZSArICciJyA6ICcnKSArCiAgICAgICAgICAgICAgICAgICAgKGNpLnZzcGFjZSAmJiBjaS52c3BhY2UgIT0gIjAiID8gJyB2c3BhY2UgPSAiJyArIGNpLnZzcGFjZSArICciJyA6ICcnKSArICcvPic7CiAgICAgICAgICAgICAgICBpZiAoY2lbJ2Zsb2F0U3R5bGUnXSA9PSAnY2VudGVyJykgewogICAgICAgICAgICAgICAgICAgIHN0ciA9ICc8cCBzdHlsZT0idGV4dC1hbGlnbjogY2VudGVyIj4nICsgc3RyICsgJzwvcD4nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaHRtbC5wdXNoKHN0cik7CgogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGNpID0gb3B0W2krK107KSB7CiAgICAgICAgICAgICAgICAgICAgc3RyID0gJzxwICcgKyAoY2lbJ2Zsb2F0U3R5bGUnXSA9PSAnY2VudGVyJyA/ICdzdHlsZT0idGV4dC1hbGlnbjogY2VudGVyIiAnIDogJycpICsgJz48aW1nIHNyYz0iJyArIGNpLnNyYyArICciICcgKwogICAgICAgICAgICAgICAgICAgICAgICAoY2kud2lkdGggPyAnd2lkdGg9IicgKyBjaS53aWR0aCArICciICcgOiAnJykgKyAoY2kuX3NyYyA/ICcgX3NyYz0iJyArIGNpLl9zcmMgKyAnIiAnIDogJycpICsKICAgICAgICAgICAgICAgICAgICAgICAgKGNpLmhlaWdodCA/ICcgaGVpZ2h0PSInICsgY2kuaGVpZ2h0ICsgJyIgJyA6ICcnKSArCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9IicgKyAoY2lbJ2Zsb2F0U3R5bGUnXSAmJiBjaVsnZmxvYXRTdHlsZSddICE9ICdjZW50ZXInID8gJ2Zsb2F0OicgKyBjaVsnZmxvYXRTdHlsZSddICsgJzsnIDogJycpICsKICAgICAgICAgICAgICAgICAgICAgICAgKGNpLmJvcmRlciB8fCAnJykgKyAnIiAnICsKICAgICAgICAgICAgICAgICAgICAgICAgKGNpLnRpdGxlID8gJyB0aXRsZT0iJyArIGNpLnRpdGxlICsgJyInIDogJycpICsgCiAgICAgICAgICAgICAgICAgICAgICAgIChjaS50aXRsZSA/ICcgYWx0PSInICsgY2kudGl0bGUgKyAnIicgOiAnIGFsdD0iaW1hZ2UiICcpICsgCiAgICAgICAgICAgICAgICAgICAgICAgICcgLz48L3A+JzsKICAgICAgICAgICAgICAgICAgICBodG1sLnB1c2goc3RyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgbWUuZXhlY0NvbW1hbmQoJ2luc2VydEh0bWwnLCBodG1sLmpvaW4oJycpKTsKICAgICAgICB9CiAgICB9Cn07Ci8vL2ltcG9ydCBjb3JlDQovLy9jb21tYW5kcyDmrrXokL3moLzlvI8s5bGF5bemLOWxheWPsyzlsYXkuK0s5Lik56uv5a+56b2QDQovLy9jb21tYW5kc05hbWUgIEp1c3RpZnlMZWZ0LEp1c3RpZnlDZW50ZXIsSnVzdGlmeVJpZ2h0LEp1c3RpZnlKdXN0aWZ5DQovLy9jb21tYW5kc1RpdGxlICDlsYXlt6blr7npvZAs5bGF5Lit5a+56b2QLOWxheWPs+Wvuem9kCzkuKTnq6/lr7npvZANCi8qKg0KICogQGRlc2NyaXB0aW9uIOWxheW3puWPs+S4rQ0KICogQG5hbWUgYmFpZHUuZWRpdG9yLmV4ZWNDb21tYW5kDQogKiBAcGFyYW0gICB7U3RyaW5nfSAgIGNtZE5hbWUgICAgIGp1c3RpZnnmiafooYzlr7npvZDmlrnlvI/nmoTlkb3ku6QNCiAqIEBwYXJhbSAgIHtTdHJpbmd9ICAgYWxpZ24gICAgICAgICAgICAgICDlr7npvZDmlrnlvI/vvJpsZWZ05bGF5bem77yMcmlnaHTlsYXlj7PvvIxjZW50ZXLlsYXkuK3vvIxqdXN0aWZ55Lik56uv5a+56b2QDQogKiBAYXV0aG9yIHpoYW55aQ0KICovDQpVRS5wbHVnaW5zWydqdXN0aWZ5J109ZnVuY3Rpb24oKXsNCiAgICB2YXIgbWU9dGhpcywNCiAgICAgICAgYmxvY2sgPSBkb21VdGlscy5pc0Jsb2NrRWxtLA0KICAgICAgICBkZWZhdWx0VmFsdWUgPSB7DQogICAgICAgICAgICBsZWZ0OjEsDQogICAgICAgICAgICByaWdodDoxLA0KICAgICAgICAgICAgY2VudGVyOjEsDQogICAgICAgICAgICBqdXN0aWZ5OjENCiAgICAgICAgfSwNCiAgICAgICAgZG9KdXN0aWZ5ID0gZnVuY3Rpb24gKHJhbmdlLCBzdHlsZSkgew0KICAgICAgICAgICAgdmFyIGJvb2ttYXJrID0gcmFuZ2UuY3JlYXRlQm9va21hcmsoKSwNCiAgICAgICAgICAgICAgICBmaWx0ZXJGbiA9IGZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBub2RlLm5vZGVUeXBlID09IDEgPyBub2RlLnRhZ05hbWUudG9Mb3dlckNhc2UoKSAhPSAnYnInICYmICFkb21VdGlscy5pc0Jvb2ttYXJrTm9kZShub2RlKSA6ICFkb21VdGlscy5pc1doaXRlc3BhY2Uobm9kZSk7DQogICAgICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgcmFuZ2UuZW5sYXJnZSh0cnVlKTsNCiAgICAgICAgICAgIHZhciBib29rbWFyazIgPSByYW5nZS5jcmVhdGVCb29rbWFyaygpLA0KICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBkb21VdGlscy5nZXROZXh0RG9tTm9kZShib29rbWFyazIuc3RhcnQsIGZhbHNlLCBmaWx0ZXJGbiksDQogICAgICAgICAgICAgICAgdG1wUmFuZ2UgPSByYW5nZS5jbG9uZVJhbmdlKCksDQogICAgICAgICAgICAgICAgdG1wTm9kZTsNCiAgICAgICAgICAgIHdoaWxlIChjdXJyZW50ICYmICEoZG9tVXRpbHMuZ2V0UG9zaXRpb24oY3VycmVudCwgYm9va21hcmsyLmVuZCkgJiBkb21VdGlscy5QT1NJVElPTl9GT0xMT1dJTkcpKSB7DQogICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQubm9kZVR5cGUgPT0gMyB8fCAhYmxvY2soY3VycmVudCkpIHsNCiAgICAgICAgICAgICAgICAgICAgdG1wUmFuZ2Uuc2V0U3RhcnRCZWZvcmUoY3VycmVudCk7DQogICAgICAgICAgICAgICAgICAgIHdoaWxlIChjdXJyZW50ICYmIGN1cnJlbnQgIT09IGJvb2ttYXJrMi5lbmQgJiYgIWJsb2NrKGN1cnJlbnQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0bXBOb2RlID0gY3VycmVudDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBkb21VdGlscy5nZXROZXh0RG9tTm9kZShjdXJyZW50LCBmYWxzZSwgbnVsbCwgZnVuY3Rpb24gKG5vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIWJsb2NrKG5vZGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdG1wUmFuZ2Uuc2V0RW5kQWZ0ZXIodG1wTm9kZSk7DQogICAgICAgICAgICAgICAgICAgIHZhciBjb21tb24gPSB0bXBSYW5nZS5nZXRDb21tb25BbmNlc3RvcigpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoIWRvbVV0aWxzLmlzQm9keShjb21tb24pICYmIGJsb2NrKGNvbW1vbikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnNldFN0eWxlcyhjb21tb24sIHV0aWxzLmlzU3RyaW5nKHN0eWxlKSA/IHsndGV4dC1hbGlnbic6c3R5bGV9IDogc3R5bGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IGNvbW1vbjsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwID0gcmFuZ2UuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMuc2V0U3R5bGVzKHAsIHV0aWxzLmlzU3RyaW5nKHN0eWxlKSA/IHsndGV4dC1hbGlnbic6c3R5bGV9IDogc3R5bGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZyYWcgPSB0bXBSYW5nZS5leHRyYWN0Q29udGVudHMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHAuYXBwZW5kQ2hpbGQoZnJhZyk7DQogICAgICAgICAgICAgICAgICAgICAgICB0bXBSYW5nZS5pbnNlcnROb2RlKHApOw0KICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IHA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IGRvbVV0aWxzLmdldE5leHREb21Ob2RlKGN1cnJlbnQsIGZhbHNlLCBmaWx0ZXJGbik7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IGRvbVV0aWxzLmdldE5leHREb21Ob2RlKGN1cnJlbnQsIHRydWUsIGZpbHRlckZuKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gcmFuZ2UubW92ZVRvQm9va21hcmsoYm9va21hcmsyKS5tb3ZlVG9Cb29rbWFyayhib29rbWFyayk7DQogICAgICAgIH07DQoNCiAgICBVRS5jb21tYW5kc1snanVzdGlmeSddID0gew0KICAgICAgICBleGVjQ29tbWFuZDpmdW5jdGlvbiAoY21kTmFtZSwgYWxpZ24pIHsNCiAgICAgICAgICAgIHZhciByYW5nZSA9IHRoaXMuc2VsZWN0aW9uLmdldFJhbmdlKCksDQogICAgICAgICAgICAgICAgdHh0Ow0KDQogICAgICAgICAgICAvL+mXreWQiOaXtuWNleeLrOWkhOeQhg0KICAgICAgICAgICAgaWYgKHJhbmdlLmNvbGxhcHNlZCkgew0KICAgICAgICAgICAgICAgIHR4dCA9IHRoaXMuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJ3AnKTsNCiAgICAgICAgICAgICAgICByYW5nZS5pbnNlcnROb2RlKHR4dCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBkb0p1c3RpZnkocmFuZ2UsIGFsaWduKTsNCiAgICAgICAgICAgIGlmICh0eHQpIHsNCiAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydEJlZm9yZSh0eHQpLmNvbGxhcHNlKHRydWUpOw0KICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZSh0eHQpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByYW5nZS5zZWxlY3QoKTsNCg0KDQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfSwNCiAgICAgICAgcXVlcnlDb21tYW5kVmFsdWU6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIHN0YXJ0Tm9kZSA9IHRoaXMuc2VsZWN0aW9uLmdldFN0YXJ0KCksDQogICAgICAgICAgICAgICAgdmFsdWUgPSBkb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKHN0YXJ0Tm9kZSwgJ3RleHQtYWxpZ24nKTsNCiAgICAgICAgICAgIHJldHVybiBkZWZhdWx0VmFsdWVbdmFsdWVdID8gdmFsdWUgOiAnbGVmdCc7DQogICAgICAgIH0sDQogICAgICAgIHF1ZXJ5Q29tbWFuZFN0YXRlOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBzdGFydCA9IHRoaXMuc2VsZWN0aW9uLmdldFN0YXJ0KCksDQogICAgICAgICAgICAgICAgY2VsbCA9IHN0YXJ0ICYmIGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUoc3RhcnQsIFsidGQiLCAidGgiLCJjYXB0aW9uIl0sIHRydWUpOw0KDQogICAgICAgICAgICByZXR1cm4gY2VsbD8gLTE6MDsNCiAgICAgICAgfQ0KDQogICAgfTsNCn07DQoKLy8vaW1wb3J0IGNvcmUNCi8vL2ltcG9ydCBwbHVnaW5zXHJlbW92ZWZvcm1hdC5qcw0KLy8vY29tbWFuZHMg5a2X5L2T6aKc6ImyLOiDjOaZr+iJsizlrZflj7cs5a2X5L2TLOS4i+WIkue6vyzliKDpmaTnur8NCi8vL2NvbW1hbmRzTmFtZSAgRm9yZUNvbG9yLEJhY2tDb2xvcixGb250U2l6ZSxGb250RmFtaWx5LFVuZGVybGluZSxTdHJpa2VUaHJvdWdoDQovLy9jb21tYW5kc1RpdGxlICDlrZfkvZPpopzoibIs6IOM5pmv6ImyLOWtl+WPtyzlrZfkvZMs5LiL5YiS57q/LOWIoOmZpOe6vw0KLyoqDQogKiBAZGVzY3JpcHRpb24g5a2X5L2TDQogKiBAbmFtZSBiYWlkdS5lZGl0b3IuZXhlY0NvbW1hbmQNCiAqIEBwYXJhbSB7U3RyaW5nfSAgICAgY21kTmFtZSAgICDmiafooYznmoTlip/og73lkI3np7ANCiAqIEBwYXJhbSB7U3RyaW5nfSAgICB2YWx1ZSAgICAgICAgICAgICDkvKDlhaXnmoTlgLwNCiAqLw0KVUUucGx1Z2luc1snZm9udCddID0gZnVuY3Rpb24gKCkgew0KICAgIHZhciBtZSA9IHRoaXMsDQogICAgICAgIGZvbnRzID0gew0KICAgICAgICAgICAgJ2ZvcmVjb2xvcic6ICdjb2xvcicsDQogICAgICAgICAgICAnYmFja2NvbG9yJzogJ2JhY2tncm91bmQtY29sb3InLA0KICAgICAgICAgICAgJ2ZvbnRzaXplJzogJ2ZvbnQtc2l6ZScsDQogICAgICAgICAgICAnZm9udGZhbWlseSc6ICdmb250LWZhbWlseScsDQogICAgICAgICAgICAndW5kZXJsaW5lJzogJ3RleHQtZGVjb3JhdGlvbicsDQogICAgICAgICAgICAnc3RyaWtldGhyb3VnaCc6ICd0ZXh0LWRlY29yYXRpb24nLA0KICAgICAgICAgICAgJ2ZvbnRib3JkZXInOiAnYm9yZGVyJw0KICAgICAgICB9LA0KICAgICAgICBuZWVkQ21kID0geyd1bmRlcmxpbmUnOiAxLCAnc3RyaWtldGhyb3VnaCc6IDEsICdmb250Ym9yZGVyJzogMX0sDQogICAgICAgIG5lZWRTZXRDaGlsZCA9IHsNCiAgICAgICAgICAgICdmb3JlY29sb3InOiAnY29sb3InLA0KICAgICAgICAgICAgJ2JhY2tjb2xvcic6ICdiYWNrZ3JvdW5kLWNvbG9yJywNCiAgICAgICAgICAgICdmb250c2l6ZSc6ICdmb250LXNpemUnLA0KICAgICAgICAgICAgJ2ZvbnRmYW1pbHknOiAnZm9udC1mYW1pbHknDQoNCiAgICAgICAgfTsNCiAgICBtZS5zZXRPcHQoew0KICAgICAgICAnZm9udGZhbWlseSc6IFsNCiAgICAgICAgICAgIHsgbmFtZTogJ3Nvbmd0aScsIHZhbDogJ+Wui+S9kyxTaW1TdW4nfSwNCiAgICAgICAgICAgIHsgbmFtZTogJ3lhaGVpJywgdmFsOiAn5b6u6L2v6ZuF6buRLE1pY3Jvc29mdCBZYUhlaSd9LA0KICAgICAgICAgICAgeyBuYW1lOiAna2FpdGknLCB2YWw6ICfmpbfkvZMs5qW35L2TX0dCMjMxMiwgU2ltS2FpJ30sDQogICAgICAgICAgICB7IG5hbWU6ICdoZWl0aScsIHZhbDogJ+m7keS9kywgU2ltSGVpJ30sDQogICAgICAgICAgICB7IG5hbWU6ICdsaXNodScsIHZhbDogJ+matuS5piwgU2ltTGknfSwNCiAgICAgICAgICAgIHsgbmFtZTogJ2FuZGFsZU1vbm8nLCB2YWw6ICdhbmRhbGUgbW9ubyd9LA0KICAgICAgICAgICAgeyBuYW1lOiAnYXJpYWwnLCB2YWw6ICdhcmlhbCwgaGVsdmV0aWNhLHNhbnMtc2VyaWYnfSwNCiAgICAgICAgICAgIHsgbmFtZTogJ2FyaWFsQmxhY2snLCB2YWw6ICdhcmlhbCBibGFjayxhdmFudCBnYXJkZSd9LA0KICAgICAgICAgICAgeyBuYW1lOiAnY29taWNTYW5zTXMnLCB2YWw6ICdjb21pYyBzYW5zIG1zJ30sDQogICAgICAgICAgICB7IG5hbWU6ICdpbXBhY3QnLCB2YWw6ICdpbXBhY3QsY2hpY2Fnbyd9LA0KICAgICAgICAgICAgeyBuYW1lOiAndGltZXNOZXdSb21hbicsIHZhbDogJ3RpbWVzIG5ldyByb21hbid9DQogICAgICAgIF0sDQogICAgICAgICdmb250c2l6ZSc6IFsxMCwgMTEsIDEyLCAxNCwgMTYsIDE4LCAyMCwgMjQsIDM2XQ0KICAgIH0pOw0KDQogICAgZnVuY3Rpb24gbWVyZ2VXaXRoUGFyZW50KG5vZGUpew0KICAgICAgICB2YXIgcGFyZW50Ow0KICAgICAgICB3aGlsZShwYXJlbnQgPSBub2RlLnBhcmVudE5vZGUpew0KICAgICAgICAgICAgaWYocGFyZW50LnRhZ05hbWUgPT0gJ1NQQU4nICYmIGRvbVV0aWxzLmdldENoaWxkQ291bnQocGFyZW50LGZ1bmN0aW9uKGNoaWxkKXsNCiAgICAgICAgICAgICAgICByZXR1cm4gIWRvbVV0aWxzLmlzQm9va21hcmtOb2RlKGNoaWxkKSAmJiAhZG9tVXRpbHMuaXNCcihjaGlsZCkNCiAgICAgICAgICAgIH0pID09IDEpIHsNCiAgICAgICAgICAgICAgICBwYXJlbnQuc3R5bGUuY3NzVGV4dCArPSBub2RlLnN0eWxlLmNzc1RleHQ7DQogICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKG5vZGUsdHJ1ZSk7DQogICAgICAgICAgICAgICAgbm9kZSA9IHBhcmVudDsNCg0KICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgIH0NCiAgICBmdW5jdGlvbiBtZXJnZUNoaWxkKHJuZyxjbWROYW1lLHZhbHVlKXsNCiAgICAgICAgaWYobmVlZFNldENoaWxkW2NtZE5hbWVdKXsNCiAgICAgICAgICAgIHJuZy5hZGp1c3RtZW50Qm91bmRhcnkoKTsNCiAgICAgICAgICAgIGlmKCFybmcuY29sbGFwc2VkICYmIHJuZy5zdGFydENvbnRhaW5lci5ub2RlVHlwZSA9PSAxKXsNCiAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSBybmcuc3RhcnRDb250YWluZXIuY2hpbGROb2Rlc1tybmcuc3RhcnRPZmZzZXRdOw0KICAgICAgICAgICAgICAgIGlmKHN0YXJ0ICYmIGRvbVV0aWxzLmlzVGFnTm9kZShzdGFydCwnc3BhbicpKXsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGJrID0gcm5nLmNyZWF0ZUJvb2ttYXJrKCk7DQogICAgICAgICAgICAgICAgICAgIHV0aWxzLmVhY2goZG9tVXRpbHMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoc3RhcnQsICdzcGFuJyksIGZ1bmN0aW9uIChzcGFuKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNwYW4ucGFyZW50Tm9kZSB8fCBkb21VdGlscy5pc0Jvb2ttYXJrTm9kZShzcGFuKSlyZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICBpZihjbWROYW1lID09ICdiYWNrY29sb3InICYmIGRvbVV0aWxzLmdldENvbXB1dGVkU3R5bGUoc3BhbiwnYmFja2dyb3VuZC1jb2xvcicpLnRvTG93ZXJDYXNlKCkgPT09IHZhbHVlKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmVTdHlsZShzcGFuLG5lZWRTZXRDaGlsZFtjbWROYW1lXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZihzcGFuLnN0eWxlLmNzc1RleHQucmVwbGFjZSgvXlxzKyQvLCcnKS5sZW5ndGggPT0gMCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHNwYW4sdHJ1ZSkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIHJuZy5tb3ZlVG9Cb29rbWFyayhiaykNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgIH0NCiAgICBmdW5jdGlvbiBtZXJnZXNpYmxpbmcocm5nLGNtZE5hbWUsdmFsdWUpIHsNCiAgICAgICAgdmFyIGNvbGxhcHNlZCA9IHJuZy5jb2xsYXBzZWQsDQogICAgICAgICAgICBiayA9IHJuZy5jcmVhdGVCb29rbWFyaygpLCBjb21tb247DQogICAgICAgIGlmIChjb2xsYXBzZWQpIHsNCiAgICAgICAgICAgIGNvbW1vbiA9IGJrLnN0YXJ0LnBhcmVudE5vZGU7DQogICAgICAgICAgICB3aGlsZSAoZHRkLiRpbmxpbmVbY29tbW9uLnRhZ05hbWVdKSB7DQogICAgICAgICAgICAgICAgY29tbW9uID0gY29tbW9uLnBhcmVudE5vZGU7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBjb21tb24gPSBkb21VdGlscy5nZXRDb21tb25BbmNlc3Rvcihiay5zdGFydCwgYmsuZW5kKTsNCiAgICAgICAgfQ0KICAgICAgICB1dGlscy5lYWNoKGRvbVV0aWxzLmdldEVsZW1lbnRzQnlUYWdOYW1lKGNvbW1vbiwgJ3NwYW4nKSwgZnVuY3Rpb24gKHNwYW4pIHsNCiAgICAgICAgICAgIGlmICghc3Bhbi5wYXJlbnROb2RlIHx8IGRvbVV0aWxzLmlzQm9va21hcmtOb2RlKHNwYW4pKXJldHVybjsNCiAgICAgICAgICAgIGlmICgvXHMqYm9yZGVyXHMqOlxzKm5vbmU7P1xzKi9pLnRlc3Qoc3Bhbi5zdHlsZS5jc3NUZXh0KSkgew0KICAgICAgICAgICAgICAgIGlmKC9eXHMqYm9yZGVyXHMqOlxzKm5vbmU7P1xzKiQvLnRlc3Qoc3Bhbi5zdHlsZS5jc3NUZXh0KSl7DQogICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShzcGFuLCB0cnVlKTsNCiAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlU3R5bGUoc3BhbiwnYm9yZGVyJyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybg0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKC9ib3JkZXIvaS50ZXN0KHNwYW4uc3R5bGUuY3NzVGV4dCkgJiYgc3Bhbi5wYXJlbnROb2RlLnRhZ05hbWUgPT0gJ1NQQU4nICYmIC9ib3JkZXIvaS50ZXN0KHNwYW4ucGFyZW50Tm9kZS5zdHlsZS5jc3NUZXh0KSkgew0KICAgICAgICAgICAgICAgIHNwYW4uc3R5bGUuY3NzVGV4dCA9IHNwYW4uc3R5bGUuY3NzVGV4dC5yZXBsYWNlKC9ib3JkZXJbXjpdKjpbXjtdKzs/L2dpLCAnJyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZighKGNtZE5hbWU9PSdmb250Ym9yZGVyJyAmJiB2YWx1ZT09J25vbmUnKSl7DQogICAgICAgICAgICAgICAgdmFyIG5leHQgPSBzcGFuLm5leHRTaWJsaW5nOw0KICAgICAgICAgICAgICAgIHdoaWxlIChuZXh0ICYmIG5leHQubm9kZVR5cGUgPT0gMSAmJiBuZXh0LnRhZ05hbWUgPT0gJ1NQQU4nICkgew0KICAgICAgICAgICAgICAgICAgICBpZihkb21VdGlscy5pc0Jvb2ttYXJrTm9kZShuZXh0KSAmJiBjbWROYW1lID09ICdmb250Ym9yZGVyJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgc3Bhbi5hcHBlbmRDaGlsZChuZXh0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG5leHQgPSBzcGFuLm5leHRTaWJsaW5nOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKG5leHQuc3R5bGUuY3NzVGV4dCA9PSBzcGFuLnN0eWxlLmNzc1RleHQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLm1vdmVDaGlsZChuZXh0LCBzcGFuKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShuZXh0KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoc3Bhbi5uZXh0U2libGluZyA9PT0gbmV4dCkNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICBuZXh0ID0gc3Bhbi5uZXh0U2libGluZzsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgbWVyZ2VXaXRoUGFyZW50KHNwYW4pOw0KICAgICAgICAgICAgaWYoYnJvd3Nlci5pZSAmJiBicm93c2VyLnZlcnNpb24gPiA4ICl7DQogICAgICAgICAgICAgICAgLy/mi7fotJ3niLbkurLku6znmoTnibnliKvnmoTlsZ7mgKcs6L+Z6YeM5Y+q5YGa6IOM5pmv6aKc6Imy55qE5aSE55CGDQogICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IGRvbVV0aWxzLmZpbmRQYXJlbnQoc3BhbixmdW5jdGlvbihuKXtyZXR1cm4gbi50YWdOYW1lID09ICdTUEFOJyAmJiAvYmFja2dyb3VuZC1jb2xvci8udGVzdChuLnN0eWxlLmNzc1RleHQpfSk7DQogICAgICAgICAgICAgICAgaWYocGFyZW50ICYmICEvYmFja2dyb3VuZC1jb2xvci8udGVzdChzcGFuLnN0eWxlLmNzc1RleHQpKXsNCiAgICAgICAgICAgICAgICAgICAgc3Bhbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBwYXJlbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9KTsNCiAgICAgICAgcm5nLm1vdmVUb0Jvb2ttYXJrKGJrKTsNCiAgICAgICAgbWVyZ2VDaGlsZChybmcsY21kTmFtZSx2YWx1ZSkNCiAgICB9DQoNCiAgICBtZS5hZGRJbnB1dFJ1bGUoZnVuY3Rpb24gKHJvb3QpIHsNCiAgICAgICAgdXRpbHMuZWFjaChyb290LmdldE5vZGVzQnlUYWdOYW1lKCd1IHMgZGVsIGZvbnQgc3RyaWtlJyksIGZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgICAgICBpZiAobm9kZS50YWdOYW1lID09ICdmb250Jykgew0KICAgICAgICAgICAgICAgIHZhciBjc3NTdHlsZSA9IFtdOw0KICAgICAgICAgICAgICAgIGZvciAodmFyIHAgaW4gbm9kZS5hdHRycykgew0KICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NpemUnOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNzc1N0eWxlLnB1c2goJ2ZvbnQtc2l6ZTonICsgbm9kZS5hdHRyc1twXSArICdweCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnY29sb3InOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNzc1N0eWxlLnB1c2goJ2NvbG9yOicgKyBub2RlLmF0dHJzW3BdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2ZhY2UnOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNzc1N0eWxlLnB1c2goJ2ZvbnQtZmFtaWx5OicgKyBub2RlLmF0dHJzW3BdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3N0eWxlJzoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjc3NTdHlsZS5wdXNoKG5vZGUuYXR0cnNbcF0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIG5vZGUuYXR0cnMgPSB7DQogICAgICAgICAgICAgICAgICAgICdzdHlsZSc6IGNzc1N0eWxlLmpvaW4oJzsnKQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHZhciB2YWwgPSBub2RlLnRhZ05hbWUgPT0gJ3UnID8gJ3VuZGVybGluZScgOiAnbGluZS10aHJvdWdoJzsNCiAgICAgICAgICAgICAgICBub2RlLmF0dHJzID0gew0KICAgICAgICAgICAgICAgICAgICAnc3R5bGUnOiAobm9kZS5nZXRBdHRyKCdzdHlsZScpIHx8ICcnKSArICd0ZXh0LWRlY29yYXRpb246JyArIHZhbCArICc7Jw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIG5vZGUudGFnTmFtZSA9ICdzcGFuJzsNCiAgICAgICAgfSk7DQovLyAgICAgICAgdXRpbHMuZWFjaChyb290LmdldE5vZGVzQnlUYWdOYW1lKCdzcGFuJyksIGZ1bmN0aW9uIChub2RlKSB7DQovLyAgICAgICAgICAgIHZhciB2YWw7DQovLyAgICAgICAgICAgIGlmKHZhbCA9IG5vZGUuZ2V0QXR0cignY2xhc3MnKSl7DQovLyAgICAgICAgICAgICAgICBpZigvZm9udHN0cmlrZXRocm91Z2gvLnRlc3QodmFsKSl7DQovLyAgICAgICAgICAgICAgICAgICAgbm9kZS5zZXRTdHlsZSgndGV4dC1kZWNvcmF0aW9uJywnbGluZS10aHJvdWdoJyk7DQovLyAgICAgICAgICAgICAgICAgICAgaWYobm9kZS5hdHRyc1snY2xhc3MnXSl7DQovLyAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuYXR0cnNbJ2NsYXNzJ10gPSBub2RlLmF0dHJzWydjbGFzcyddLnJlcGxhY2UoL2ZvbnRzdHJpa2V0aHJvdWdoLywnJyk7DQovLyAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQovLyAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuc2V0QXR0cignY2xhc3MnKQ0KLy8gICAgICAgICAgICAgICAgICAgIH0NCi8vICAgICAgICAgICAgICAgIH0NCi8vICAgICAgICAgICAgICAgIGlmKC9mb250Ym9yZGVyLy50ZXN0KHZhbCkpew0KLy8gICAgICAgICAgICAgICAgICAgIG5vZGUuc2V0U3R5bGUoJ2JvcmRlcicsJzFweCBzb2xpZCAjMDAwJyk7DQovLyAgICAgICAgICAgICAgICAgICAgaWYobm9kZS5hdHRyc1snY2xhc3MnXSl7DQovLyAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuYXR0cnNbJ2NsYXNzJ10gPSBub2RlLmF0dHJzWydjbGFzcyddLnJlcGxhY2UoL2ZvbnRib3JkZXIvLCcnKTsNCi8vICAgICAgICAgICAgICAgICAgICB9ZWxzZXsNCi8vICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5zZXRBdHRyKCdjbGFzcycpDQovLyAgICAgICAgICAgICAgICAgICAgfQ0KLy8gICAgICAgICAgICAgICAgfQ0KLy8gICAgICAgICAgICB9DQovLyAgICAgICAgfSk7DQogICAgfSk7DQovLyAgICBtZS5hZGRPdXRwdXRSdWxlKGZ1bmN0aW9uKHJvb3Qpew0KLy8gICAgICAgIHV0aWxzLmVhY2gocm9vdC5nZXROb2Rlc0J5VGFnTmFtZSgnc3BhbicpLCBmdW5jdGlvbiAobm9kZSkgew0KLy8gICAgICAgICAgICB2YXIgdmFsOw0KLy8gICAgICAgICAgICBpZih2YWwgPSBub2RlLmdldFN0eWxlKCd0ZXh0LWRlY29yYXRpb24nKSl7DQovLyAgICAgICAgICAgICAgICBpZigvbGluZS10aHJvdWdoLy50ZXN0KHZhbCkpew0KLy8gICAgICAgICAgICAgICAgICAgIGlmKG5vZGUuYXR0cnNbJ2NsYXNzJ10pew0KLy8gICAgICAgICAgICAgICAgICAgICAgICBub2RlLmF0dHJzWydjbGFzcyddICs9ICcgZm9udHN0cmlrZXRocm91Z2gnOw0KLy8gICAgICAgICAgICAgICAgICAgIH1lbHNlew0KLy8gICAgICAgICAgICAgICAgICAgICAgICBub2RlLnNldEF0dHIoJ2NsYXNzJywnZm9udHN0cmlrZXRocm91Z2gnKQ0KLy8gICAgICAgICAgICAgICAgICAgIH0NCi8vICAgICAgICAgICAgICAgIH0NCi8vDQovLyAgICAgICAgICAgICAgICBub2RlLnNldFN0eWxlKCd0ZXh0LWRlY29yYXRpb24nKQ0KLy8gICAgICAgICAgICB9DQovLyAgICAgICAgICAgIGlmKHZhbCA9IG5vZGUuZ2V0U3R5bGUoJ2JvcmRlcicpKXsNCi8vICAgICAgICAgICAgICAgIGlmKC8xcHgvLnRlc3QodmFsKSAmJiAvc29saWQvLnRlc3QodmFsKSl7DQovLyAgICAgICAgICAgICAgICAgICAgaWYobm9kZS5hdHRyc1snY2xhc3MnXSl7DQovLyAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuYXR0cnNbJ2NsYXNzJ10gKz0gJyBmb250Ym9yZGVyJzsNCi8vDQovLyAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQovLyAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuc2V0QXR0cignY2xhc3MnLCdmb250Ym9yZGVyJykNCi8vICAgICAgICAgICAgICAgICAgICB9DQovLyAgICAgICAgICAgICAgICB9DQovLyAgICAgICAgICAgICAgICBub2RlLnNldFN0eWxlKCdib3JkZXInKQ0KLy8NCi8vICAgICAgICAgICAgfQ0KLy8gICAgICAgIH0pOw0KLy8gICAgfSk7DQogICAgZm9yICh2YXIgcCBpbiBmb250cykgew0KICAgICAgICAoZnVuY3Rpb24gKGNtZCwgc3R5bGUpIHsNCiAgICAgICAgICAgIFVFLmNvbW1hbmRzW2NtZF0gPSB7DQogICAgICAgICAgICAgICAgZXhlY0NvbW1hbmQ6IGZ1bmN0aW9uIChjbWROYW1lLCB2YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlIHx8ICh0aGlzLnF1ZXJ5Q29tbWFuZFN0YXRlKGNtZE5hbWUpID8gJ25vbmUnIDogY21kTmFtZSA9PSAndW5kZXJsaW5lJyA/ICd1bmRlcmxpbmUnIDoNCiAgICAgICAgICAgICAgICAgICAgICAgIGNtZE5hbWUgPT0gJ2ZvbnRib3JkZXInID8gJzFweCBzb2xpZCAjMDAwJyA6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2xpbmUtdGhyb3VnaCcpOw0KICAgICAgICAgICAgICAgICAgICB2YXIgbWUgPSB0aGlzLA0KICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2UgPSB0aGlzLnNlbGVjdGlvbi5nZXRSYW5nZSgpLA0KICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT0gJ2RlZmF1bHQnKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyYW5nZS5jb2xsYXBzZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gbWUuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJ2ZvbnQnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5pbnNlcnROb2RlKHRleHQpLnNlbGVjdCgpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBtZS5leGVjQ29tbWFuZCgncmVtb3ZlRm9ybWF0JywgJ3NwYW4sYScsIHN0eWxlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZXh0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnRCZWZvcmUodGV4dCkuY29sbGFwc2UodHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHRleHQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgbWVyZ2VzaWJsaW5nKHJhbmdlLGNtZE5hbWUsdmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2VsZWN0KCkNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmFuZ2UuY29sbGFwc2VkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5lZWRDbWRbY21kXSAmJiBtZS5xdWVyeUNvbW1hbmRWYWx1ZShjbWQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lLmV4ZWNDb21tYW5kKCdyZW1vdmVGb3JtYXQnLCAnc3BhbixhJywgc3R5bGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZSA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2UuYXBwbHlJbmxpbmVTdHlsZSgnc3BhbicsIHsnc3R5bGUnOiBzdHlsZSArICc6JyArIHZhbHVlfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVyZ2VzaWJsaW5nKHJhbmdlLCBjbWROYW1lLHZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZWxlY3QoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3BhbiA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUocmFuZ2Uuc3RhcnRDb250YWluZXIsICdzcGFuJywgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IG1lLmRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCdmb250Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNwYW4gJiYgIXNwYW4uY2hpbGRyZW4ubGVuZ3RoICYmICFzcGFuW2Jyb3dzZXIuaWUgPyAnaW5uZXJUZXh0JyA6ICd0ZXh0Q29udGVudCddLnJlcGxhY2UoZmlsbENoYXJSZWcsICcnKS5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9mb3IgaWUgaGFjayB3aGVuIGVudGVyDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLmluc2VydE5vZGUodGV4dCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZWVkQ21kW2NtZF0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNlbGVjdE5vZGUodGV4dCkuc2VsZWN0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZS5leGVjQ29tbWFuZCgncmVtb3ZlRm9ybWF0JywgJ3NwYW4sYScsIHN0eWxlLCBudWxsKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BhbiA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUodGV4dCwgJ3NwYW4nLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0QmVmb3JlKHRleHQpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BhbiAmJiAoc3Bhbi5zdHlsZS5jc3NUZXh0ICs9ICc7JyArIHN0eWxlICsgJzonICsgdmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5jb2xsYXBzZSh0cnVlKS5zZWxlY3QoKTsNCg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2UuaW5zZXJ0Tm9kZSh0ZXh0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2VsZWN0Tm9kZSh0ZXh0KS5zZWxlY3QoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BhbiA9IHJhbmdlLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmVlZENtZFtjbWRdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2HmoIfnrb7lhoXnmoTkuI3lpITnkIbot7Pov4cNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKHRleHQsICdhJywgdHJ1ZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydEJlZm9yZSh0ZXh0KS5zZXRDdXJzb3IoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUodGV4dCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUuZXhlY0NvbW1hbmQoJ3JlbW92ZUZvcm1hdCcsICdzcGFuLGEnLCBzdHlsZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGFuLnN0eWxlLmNzc1RleHQgPSBzdHlsZSArICc6JyArIHZhbHVlOw0KDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShzcGFuLCB0ZXh0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/kv67lpI3vvIxzcGFu5aWXc3BhbiDkvYbmoLflvI/kuI3nu6fmib/nmoTpl67popgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFicm93c2VyLmllIHx8IGJyb3dzZXIuaWUgJiYgYnJvd3Nlci52ZXJzaW9uID09IDkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzcGFuUGFyZW50ID0gc3Bhbi5wYXJlbnROb2RlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKCFkb21VdGlscy5pc0Jsb2NrRWxtKHNwYW5QYXJlbnQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNwYW5QYXJlbnQudGFnTmFtZSA9PSAnU1BBTicpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9vcGVyYeWQiOW5tnN0eWxl5LiN5Lya5Yqg5YWlIjsiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwYW4uc3R5bGUuY3NzVGV4dCA9IHNwYW5QYXJlbnQuc3R5bGUuY3NzVGV4dCArICI7IiArIHNwYW4uc3R5bGUuY3NzVGV4dDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BhblBhcmVudCA9IHNwYW5QYXJlbnQucGFyZW50Tm9kZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wZXJhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydChzcGFuLCAwKS5jb2xsYXBzZSh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJnZXNpYmxpbmcocmFuZ2UsIGNtZE5hbWUsdmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNlbGVjdCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydChzcGFuLCAwKS5jb2xsYXBzZSh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lcmdlc2libGluZyhyYW5nZSxjbWROYW1lLHZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNlbGVjdCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy90cmFjZTo5ODENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9kb21VdGlscy5tZXJnZVRvUGFyZW50KHNwYW4pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZSh0ZXh0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBxdWVyeUNvbW1hbmRWYWx1ZTogZnVuY3Rpb24gKGNtZE5hbWUpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXJ0Tm9kZSA9IHRoaXMuc2VsZWN0aW9uLmdldFN0YXJ0KCk7DQoNCiAgICAgICAgICAgICAgICAgICAgLy90cmFjZTo5NDYNCiAgICAgICAgICAgICAgICAgICAgaWYgKGNtZE5hbWUgPT0gJ3VuZGVybGluZScgfHwgY21kTmFtZSA9PSAnc3RyaWtldGhyb3VnaCcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0bXBOb2RlID0gc3RhcnROb2RlLCB2YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICh0bXBOb2RlICYmICFkb21VdGlscy5pc0Jsb2NrRWxtKHRtcE5vZGUpICYmICFkb21VdGlscy5pc0JvZHkodG1wTm9kZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG1wTm9kZS5ub2RlVHlwZSA9PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZG9tVXRpbHMuZ2V0Q29tcHV0ZWRTdHlsZSh0bXBOb2RlLCBzdHlsZSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9ICdub25lJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wTm9kZSA9IHRtcE5vZGUucGFyZW50Tm9kZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnbm9uZSc7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKGNtZE5hbWUgPT0gJ2ZvbnRib3JkZXInKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG1wID0gc3RhcnROb2RlLCB2YWw7DQogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAodG1wICYmIGR0ZC4kaW5saW5lW3RtcC50YWdOYW1lXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWwgPSBkb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKHRtcCwgJ2JvcmRlcicpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgvMXB4Ly50ZXN0KHZhbCkgJiYgL3NvbGlkLy50ZXN0KHZhbCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWw7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wID0gdG1wLnBhcmVudE5vZGU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJycNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGlmKCBjbWROYW1lID09ICdGb250U2l6ZScgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3R5bGVWYWwgPSBkb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKHN0YXJ0Tm9kZSwgc3R5bGUpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcCA9IC9eKFtcZFwuXSspKFx3KykkLy5leGVjKCBzdHlsZVZhbCApOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBpZiggdG1wICkgew0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoIHRtcFsxXSApICsgdG1wWzJdOw0KDQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzdHlsZVZhbDsNCg0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICBkb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKHN0YXJ0Tm9kZSwgc3R5bGUpOw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgcXVlcnlDb21tYW5kU3RhdGU6IGZ1bmN0aW9uIChjbWROYW1lKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICghbmVlZENtZFtjbWROYW1lXSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgdmFsID0gdGhpcy5xdWVyeUNvbW1hbmRWYWx1ZShjbWROYW1lKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGNtZE5hbWUgPT0gJ2ZvbnRib3JkZXInKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLzFweC8udGVzdCh2YWwpICYmIC9zb2xpZC8udGVzdCh2YWwpDQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIHZhbCA9PSAoY21kTmFtZSA9PSAndW5kZXJsaW5lJyA/DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3VuZGVybGluZScgOiAnbGluZS10aHJvdWdoJyk7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH07DQogICAgICAgIH0pKHAsIGZvbnRzW3BdKTsNCiAgICB9DQp9OwovLy9pbXBvcnQgY29yZQ0KLy8vY29tbWFuZHMg6LaF6ZO+5o6lLOWPlua2iOmTvuaOpQ0KLy8vY29tbWFuZHNOYW1lICBMaW5rLFVubGluaw0KLy8vY29tbWFuZHNUaXRsZSAg6LaF6ZO+5o6lLOWPlua2iOmTvuaOpQ0KLy8vY29tbWFuZHNEaWFsb2cgIGRpYWxvZ3NcbGluaw0KLyoqDQogKiDotoXpk77mjqUNCiAqIEBmdW5jdGlvbg0KICogQG5hbWUgYmFpZHUuZWRpdG9yLmV4ZWNDb21tYW5kDQogKiBAcGFyYW0gICB7U3RyaW5nfSAgIGNtZE5hbWUgICAgIGxpbmvmj5LlhaXotoXpk77mjqUNCiAqIEBwYXJhbSAgIHtPYmplY3R9ICBvcHRpb25zICAgICAgICAgdXJs5Zyw5Z2A77yMdGl0bGXmoIfpopjvvIx0YXJnZXTmmK/lkKbmiZPlvIDmlrDpobUNCiAqIEBhdXRob3IgemhhbnlpDQogKi8NCi8qKg0KICog5Y+W5raI6ZO+5o6lDQogKiBAZnVuY3Rpb24NCiAqIEBuYW1lIGJhaWR1LmVkaXRvci5leGVjQ29tbWFuZA0KICogQHBhcmFtICAge1N0cmluZ30gICBjbWROYW1lICAgICB1bmxpbmvlj5bmtojpk77mjqUNCiAqIEBhdXRob3IgemhhbnlpDQogKi8NCg0KVUUucGx1Z2luc1snbGluayddID0gZnVuY3Rpb24oKXsNCiAgICBmdW5jdGlvbiBvcHRpbWl6ZSggcmFuZ2UgKSB7DQogICAgICAgIHZhciBzdGFydCA9IHJhbmdlLnN0YXJ0Q29udGFpbmVyLGVuZCA9IHJhbmdlLmVuZENvbnRhaW5lcjsNCg0KICAgICAgICBpZiAoIHN0YXJ0ID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZSggc3RhcnQsICdhJywgdHJ1ZSApICkgew0KICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnRCZWZvcmUoIHN0YXJ0ICk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCBlbmQgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKCBlbmQsICdhJywgdHJ1ZSApICkgew0KICAgICAgICAgICAgcmFuZ2Uuc2V0RW5kQWZ0ZXIoIGVuZCApOw0KICAgICAgICB9DQogICAgfQ0KDQoNCiAgICBVRS5jb21tYW5kc1sndW5saW5rJ10gPSB7DQogICAgICAgIGV4ZWNDb21tYW5kIDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgcmFuZ2UgPSB0aGlzLnNlbGVjdGlvbi5nZXRSYW5nZSgpLA0KICAgICAgICAgICAgICAgIGJvb2ttYXJrOw0KICAgICAgICAgICAgaWYocmFuZ2UuY29sbGFwc2VkICYmICFkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKCByYW5nZS5zdGFydENvbnRhaW5lciwgJ2EnLCB0cnVlICkpew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGJvb2ttYXJrID0gcmFuZ2UuY3JlYXRlQm9va21hcmsoKTsNCiAgICAgICAgICAgIG9wdGltaXplKCByYW5nZSApOw0KICAgICAgICAgICAgcmFuZ2UucmVtb3ZlSW5saW5lU3R5bGUoICdhJyApLm1vdmVUb0Jvb2ttYXJrKCBib29rbWFyayApLnNlbGVjdCgpOw0KICAgICAgICB9LA0KICAgICAgICBxdWVyeUNvbW1hbmRTdGF0ZSA6IGZ1bmN0aW9uKCl7DQogICAgICAgICAgICByZXR1cm4gIXRoaXMuaGlnaGxpZ2h0ICYmIHRoaXMucXVlcnlDb21tYW5kVmFsdWUoJ2xpbmsnKSA/ICAwIDogLTE7DQogICAgICAgIH0NCg0KICAgIH07DQogICAgZnVuY3Rpb24gZG9MaW5rKHJhbmdlLG9wdCxtZSl7DQogICAgICAgIHZhciBybmdDbG9uZSA9IHJhbmdlLmNsb25lUmFuZ2UoKSwNCiAgICAgICAgICAgIGxpbmsgPSBtZS5xdWVyeUNvbW1hbmRWYWx1ZSgnbGluaycpOw0KICAgICAgICBvcHRpbWl6ZSggcmFuZ2UgPSByYW5nZS5hZGp1c3RtZW50Qm91bmRhcnkoKSApOw0KICAgICAgICB2YXIgc3RhcnQgPSByYW5nZS5zdGFydENvbnRhaW5lcjsNCiAgICAgICAgaWYoc3RhcnQubm9kZVR5cGUgPT0gMSAmJiBsaW5rKXsNCiAgICAgICAgICAgIHN0YXJ0ID0gc3RhcnQuY2hpbGROb2Rlc1tyYW5nZS5zdGFydE9mZnNldF07DQogICAgICAgICAgICBpZihzdGFydCAmJiBzdGFydC5ub2RlVHlwZSA9PSAxICYmIHN0YXJ0LnRhZ05hbWUgPT0gJ0EnICYmIC9eKD86aHR0cHM/fGZ0cHxmaWxlKVxzKjpccypcL1wvLy50ZXN0KHN0YXJ0W2Jyb3dzZXIuaWU/J2lubmVyVGV4dCc6J3RleHRDb250ZW50J10pKXsNCiAgICAgICAgICAgICAgICBzdGFydFticm93c2VyLmllID8gJ2lubmVyVGV4dCcgOiAndGV4dENvbnRlbnQnXSA9ICB1dGlscy5odG1sKG9wdC50ZXh0VmFsdWV8fG9wdC5ocmVmKTsNCg0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmKCAhcm5nQ2xvbmUuY29sbGFwc2VkIHx8IGxpbmspew0KICAgICAgICAgICAgcmFuZ2UucmVtb3ZlSW5saW5lU3R5bGUoICdhJyApOw0KICAgICAgICAgICAgcm5nQ2xvbmUgPSByYW5nZS5jbG9uZVJhbmdlKCk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoIHJuZ0Nsb25lLmNvbGxhcHNlZCApIHsNCiAgICAgICAgICAgIHZhciBhID0gcmFuZ2UuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2EnKSwNCiAgICAgICAgICAgICAgICB0ZXh0ID0gJyc7DQogICAgICAgICAgICBpZihvcHQudGV4dFZhbHVlKXsNCg0KICAgICAgICAgICAgICAgIHRleHQgPSAgIHV0aWxzLmh0bWwob3B0LnRleHRWYWx1ZSk7DQogICAgICAgICAgICAgICAgZGVsZXRlIG9wdC50ZXh0VmFsdWU7DQogICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICB0ZXh0ID0gICB1dGlscy5odG1sKG9wdC5ocmVmKTsNCg0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZG9tVXRpbHMuc2V0QXR0cmlidXRlcyggYSwgb3B0ICk7DQogICAgICAgICAgICBzdGFydCA9ICBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKCBybmdDbG9uZS5zdGFydENvbnRhaW5lciwgJ2EnLCB0cnVlICk7DQogICAgICAgICAgICBpZihzdGFydCAmJiBkb21VdGlscy5pc0luTm9kZUVuZEJvdW5kYXJ5KHJuZ0Nsb25lLHN0YXJ0KSl7DQogICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnRBZnRlcihzdGFydCkuY29sbGFwc2UodHJ1ZSk7DQoNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGFbYnJvd3Nlci5pZSA/ICdpbm5lclRleHQnIDogJ3RleHRDb250ZW50J10gPSB0ZXh0Ow0KICAgICAgICAgICAgcmFuZ2UuaW5zZXJ0Tm9kZShhKS5zZWxlY3ROb2RlKCBhICk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByYW5nZS5hcHBseUlubGluZVN0eWxlKCAnYScsIG9wdCApOw0KDQogICAgICAgIH0NCiAgICB9DQogICAgVUUuY29tbWFuZHNbJ2xpbmsnXSA9IHsNCiAgICAgICAgZXhlY0NvbW1hbmQgOiBmdW5jdGlvbiggY21kTmFtZSwgb3B0ICkgew0KICAgICAgICAgICAgdmFyIHJhbmdlOw0KICAgICAgICAgICAgb3B0Ll9ocmVmICYmIChvcHQuX2hyZWYgPSB1dGlscy51bmh0bWwob3B0Ll9ocmVmLC9bPCI+XS9nKSk7DQogICAgICAgICAgICBvcHQuaHJlZiAmJiAob3B0LmhyZWYgPSB1dGlscy51bmh0bWwob3B0LmhyZWYsL1s8Ij5dL2cpKTsNCiAgICAgICAgICAgIG9wdC50ZXh0VmFsdWUgJiYgKG9wdC50ZXh0VmFsdWUgPSB1dGlscy51bmh0bWwob3B0LnRleHRWYWx1ZSwvWzwiPl0vZykpOw0KICAgICAgICAgICAgZG9MaW5rKHJhbmdlPXRoaXMuc2VsZWN0aW9uLmdldFJhbmdlKCksb3B0LHRoaXMpOw0KICAgICAgICAgICAgLy/pl63lkIjpg73kuI3liqDljaDkvY3nrKbvvIzlpoLmnpzliqDkuobkvJrlnKhh5ZCO6L655aSa5Liq5Y2g5L2N56ym6IqC54K577yM5a+86Ie0YeaYr+WbvueJh+iDjOaZr+e7hOaIkOeahOWIl+ihqO+8jOWHuueOsOepuueZvemXrumimA0KICAgICAgICAgICAgcmFuZ2UuY29sbGFwc2UoKS5zZWxlY3QodHJ1ZSk7DQoNCiAgICAgICAgfSwNCiAgICAgICAgcXVlcnlDb21tYW5kVmFsdWUgOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciByYW5nZSA9IHRoaXMuc2VsZWN0aW9uLmdldFJhbmdlKCksDQogICAgICAgICAgICAgICAgbm9kZTsNCiAgICAgICAgICAgIGlmICggcmFuZ2UuY29sbGFwc2VkICkgew0KLy8gICAgICAgICAgICAgICAgICAgIG5vZGUgPSB0aGlzLnNlbGVjdGlvbi5nZXRTdGFydCgpOw0KICAgICAgICAgICAgICAgIC8v5ZyoaWXkuItnZXRzdGFydCgp5Y+W5YC85YGP5LiK5LqGDQogICAgICAgICAgICAgICAgbm9kZSA9IHJhbmdlLnN0YXJ0Q29udGFpbmVyOw0KICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLm5vZGVUeXBlID09IDEgPyBub2RlIDogbm9kZS5wYXJlbnROb2RlOw0KDQogICAgICAgICAgICAgICAgaWYgKCBub2RlICYmIChub2RlID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZSggbm9kZSwgJ2EnLCB0cnVlICkpICYmICEgZG9tVXRpbHMuaXNJbk5vZGVFbmRCb3VuZGFyeShyYW5nZSxub2RlKSkgew0KDQogICAgICAgICAgICAgICAgICAgIHJldHVybiBub2RlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgLy90cmFjZToxMTExICDlpoLmnpzmmK88cD48YT54eDwvYT48L3A+IHN0YXJ0Q29udGFpbmVy5pivcOWwseS8muaJvuS4jeWIsGENCiAgICAgICAgICAgICAgICByYW5nZS5zaHJpbmtCb3VuZGFyeSgpOw0KICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IHJhbmdlLnN0YXJ0Q29udGFpbmVyLm5vZGVUeXBlICA9PSAzIHx8ICFyYW5nZS5zdGFydENvbnRhaW5lci5jaGlsZE5vZGVzW3JhbmdlLnN0YXJ0T2Zmc2V0XSA/IHJhbmdlLnN0YXJ0Q29udGFpbmVyIDogcmFuZ2Uuc3RhcnRDb250YWluZXIuY2hpbGROb2Rlc1tyYW5nZS5zdGFydE9mZnNldF0sDQogICAgICAgICAgICAgICAgICAgIGVuZCA9ICByYW5nZS5lbmRDb250YWluZXIubm9kZVR5cGUgPT0gMyB8fCByYW5nZS5lbmRPZmZzZXQgPT0gMCA/IHJhbmdlLmVuZENvbnRhaW5lciA6IHJhbmdlLmVuZENvbnRhaW5lci5jaGlsZE5vZGVzW3JhbmdlLmVuZE9mZnNldC0xXSwNCiAgICAgICAgICAgICAgICAgICAgY29tbW9uID0gcmFuZ2UuZ2V0Q29tbW9uQW5jZXN0b3IoKTsNCiAgICAgICAgICAgICAgICBub2RlID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZSggY29tbW9uLCAnYScsIHRydWUgKTsNCiAgICAgICAgICAgICAgICBpZiAoICFub2RlICYmIGNvbW1vbi5ub2RlVHlwZSA9PSAxKXsNCg0KICAgICAgICAgICAgICAgICAgICB2YXIgYXMgPSBjb21tb24uZ2V0RWxlbWVudHNCeVRhZ05hbWUoICdhJyApLA0KICAgICAgICAgICAgICAgICAgICAgICAgcHMscGU7DQoNCiAgICAgICAgICAgICAgICAgICAgZm9yICggdmFyIGkgPSAwLGNpOyBjaSA9IGFzW2krK107ICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcHMgPSBkb21VdGlscy5nZXRQb3NpdGlvbiggY2ksIHN0YXJ0ICkscGUgPSBkb21VdGlscy5nZXRQb3NpdGlvbiggY2ksZW5kKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggKHBzICYgZG9tVXRpbHMuUE9TSVRJT05fRk9MTE9XSU5HIHx8IHBzICYgZG9tVXRpbHMuUE9TSVRJT05fQ09OVEFJTlMpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAocGUgJiBkb21VdGlscy5QT1NJVElPTl9QUkVDRURJTkcgfHwgcGUgJiBkb21VdGlscy5QT1NJVElPTl9DT05UQUlOUykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlID0gY2k7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuIG5vZGU7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfSwNCiAgICAgICAgcXVlcnlDb21tYW5kU3RhdGUgOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIC8v5Yik5pat5aaC5p6c5piv6KeG6aKR55qE6K+d6L+e5o6l5LiN5Y+v55SoDQogICAgICAgICAgICAvL2ZpeCA4NTMNCiAgICAgICAgICAgIHZhciBpbWcgPSB0aGlzLnNlbGVjdGlvbi5nZXRSYW5nZSgpLmdldENsb3NlZE5vZGUoKSwNCiAgICAgICAgICAgICAgICBmbGFnID0gaW1nICYmIChpbWcuY2xhc3NOYW1lID09ICJlZHVpLWZha2VkLXZpZGVvIik7DQogICAgICAgICAgICByZXR1cm4gZmxhZyA/IC0xIDogMDsNCiAgICAgICAgfQ0KICAgIH07DQp9OwovLy9pbXBvcnQgY29yZQovLy9pbXBvcnQgcGx1Z2luc1xpbnNlcnRodG1sLmpzCi8vL2NvbW1hbmRzIOaPkuWFpeahhuaetgovLy9jb21tYW5kc05hbWUgIEluc2VydEZyYW1lCi8vL2NvbW1hbmRzVGl0bGUgIOaPkuWFpUlmcmFtZQovLy9jb21tYW5kc0RpYWxvZyAgZGlhbG9nc1xpbnNlcnRmcmFtZQoKVUUucGx1Z2luc1snaW5zZXJ0ZnJhbWUnXSA9IGZ1bmN0aW9uKCkgewogICB2YXIgbWUgPXRoaXM7CiAgICBmdW5jdGlvbiBkZWxldGVJZnJhbWUoKXsKICAgICAgICBtZS5faWZyYW1lICYmIGRlbGV0ZSBtZS5faWZyYW1lOwogICAgfQoKICAgIG1lLmFkZExpc3RlbmVyKCJzZWxlY3Rpb25jaGFuZ2UiLGZ1bmN0aW9uKCl7CiAgICAgICAgZGVsZXRlSWZyYW1lKCk7CiAgICB9KTsKCn07CgoKLy8vaW1wb3J0IGNvcmUNCi8vL2NvbW1hbmRzIOa2gum4pg0KLy8vY29tbWFuZHNOYW1lICBTY3Jhd2wNCi8vL2NvbW1hbmRzVGl0bGUgIOa2gum4pg0KLy8vY29tbWFuZHNEaWFsb2cgIGRpYWxvZ3Ncc2NyYXdsDQpVRS5jb21tYW5kc1snc2NyYXdsJ10gPSB7DQogICAgcXVlcnlDb21tYW5kU3RhdGUgOiBmdW5jdGlvbigpew0KICAgICAgICByZXR1cm4gKCBicm93c2VyLmllICYmIGJyb3dzZXIudmVyc2lvbiAgPD0gOCApID8gLTEgOjA7DQogICAgfQ0KfTsNCgovLy9pbXBvcnQgY29yZQ0KLy8vY29tbWFuZHMg5riF6Zmk5qC85byPDQovLy9jb21tYW5kc05hbWUgIFJlbW92ZUZvcm1hdA0KLy8vY29tbWFuZHNUaXRsZSAg5riF6Zmk5qC85byPDQovKioNCiAqIEBkZXNjcmlwdGlvbiDmuIXpmaTmoLzlvI8NCiAqIEBuYW1lIGJhaWR1LmVkaXRvci5leGVjQ29tbWFuZA0KICogQHBhcmFtICAge1N0cmluZ30gICBjbWROYW1lICAgICByZW1vdmVmb3JtYXTmuIXpmaTmoLzlvI/lkb3ku6QNCiAqIEBwYXJhbSAgIHtTdHJpbmd9ICAgdGFncyAgICAgICAgICAgICAgICDku6XpgJflj7fpmpTlvIDnmoTmoIfnrb7jgILlpoLvvJpzcGFuLGENCiAqIEBwYXJhbSAgIHtTdHJpbmd9ICAgc3R5bGUgICAgICAgICAgICAgICDmoLflvI8NCiAqIEBwYXJhbSAgIHtTdHJpbmd9ICAgYXR0cnMgICAgICAgICAgICAgICDlsZ7mgKcNCiAqIEBwYXJhbSAgIHtTdHJpbmd9ICAgbm90SW5jbHVlZEEgICAg5piv5ZCm5oqKYeagh+etvuWIh+W8gA0KICogQGF1dGhvciB6aGFueWkNCiAqLw0KVUUucGx1Z2luc1sncmVtb3ZlZm9ybWF0J10gPSBmdW5jdGlvbigpew0KICAgIHZhciBtZSA9IHRoaXM7DQogICAgbWUuc2V0T3B0KHsNCiAgICAgICAncmVtb3ZlRm9ybWF0VGFncyc6ICdiLGJpZyxjb2RlLGRlbCxkZm4sZW0sZm9udCxpLGlucyxrYmQscSxzYW1wLHNtYWxsLHNwYW4sc3RyaWtlLHN0cm9uZyxzdWIsc3VwLHR0LHUsdmFyJywNCiAgICAgICAncmVtb3ZlRm9ybWF0QXR0cmlidXRlcyc6J2NsYXNzLHN0eWxlLGxhbmcsd2lkdGgsaGVpZ2h0LGFsaWduLGhzcGFjZSx2YWxpZ24nDQogICAgfSk7DQogICAgbWUuY29tbWFuZHNbJ3JlbW92ZWZvcm1hdCddID0gew0KICAgICAgICBleGVjQ29tbWFuZCA6IGZ1bmN0aW9uKCBjbWROYW1lLCB0YWdzLCBzdHlsZSwgYXR0cnMsbm90SW5jbHVkZUEgKSB7DQoNCiAgICAgICAgICAgIHZhciB0YWdSZWcgPSBuZXcgUmVnRXhwKCAnXig/OicgKyAodGFncyB8fCB0aGlzLm9wdGlvbnMucmVtb3ZlRm9ybWF0VGFncykucmVwbGFjZSggLywvZywgJ3wnICkgKyAnKSQnLCAnaScgKSAsDQogICAgICAgICAgICAgICAgcmVtb3ZlRm9ybWF0QXR0cmlidXRlcyA9IHN0eWxlID8gW10gOiAoYXR0cnMgfHwgdGhpcy5vcHRpb25zLnJlbW92ZUZvcm1hdEF0dHJpYnV0ZXMpLnNwbGl0KCAnLCcgKSwNCiAgICAgICAgICAgICAgICByYW5nZSA9IG5ldyBkb20uUmFuZ2UoIHRoaXMuZG9jdW1lbnQgKSwNCiAgICAgICAgICAgICAgICBib29rbWFyayxub2RlLHBhcmVudCwNCiAgICAgICAgICAgICAgICBmaWx0ZXIgPSBmdW5jdGlvbiggbm9kZSApIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT0gMTsNCiAgICAgICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICBmdW5jdGlvbiBpc1JlZHVuZGFudFNwYW4gKG5vZGUpIHsNCiAgICAgICAgICAgICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PSAzIHx8IG5vZGUudGFnTmFtZS50b0xvd2VyQ2FzZSgpICE9ICdzcGFuJyl7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoYnJvd3Nlci5pZSkgew0KICAgICAgICAgICAgICAgICAgICAvL2llIOS4i+WIpOaWreWunuaViO+8jOaJgOS7peWPquiDveeugOWNleeUqHN0eWxl5p2l5Yik5patDQogICAgICAgICAgICAgICAgICAgIC8vcmV0dXJuIG5vZGUuc3R5bGUuY3NzVGV4dCA9PSAnJyA/IDEgOiAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cnMgPSBub2RlLmF0dHJpYnV0ZXM7DQogICAgICAgICAgICAgICAgICAgIGlmICggYXR0cnMubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICggdmFyIGkgPSAwLGwgPSBhdHRycy5sZW5ndGg7IGk8bDsgaSsrICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggYXR0cnNbaV0uc3BlY2lmaWVkICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICByZXR1cm4gIW5vZGUuYXR0cmlidXRlcy5sZW5ndGg7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBmdW5jdGlvbiBkb1JlbW92ZSggcmFuZ2UgKSB7DQoNCiAgICAgICAgICAgICAgICB2YXIgYm9va21hcmsxID0gcmFuZ2UuY3JlYXRlQm9va21hcmsoKTsNCiAgICAgICAgICAgICAgICBpZiAoIHJhbmdlLmNvbGxhcHNlZCApIHsNCiAgICAgICAgICAgICAgICAgICAgcmFuZ2UuZW5sYXJnZSggdHJ1ZSApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8v5LiN6IO95oqKYeagh+etvuWIh+S6hg0KICAgICAgICAgICAgICAgIGlmKCFub3RJbmNsdWRlQSl7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTm9kZSA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUocmFuZ2Uuc3RhcnRDb250YWluZXIsJ2EnLHRydWUpOw0KICAgICAgICAgICAgICAgICAgICBpZihhTm9kZSl7DQogICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydEJlZm9yZShhTm9kZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBhTm9kZSA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUocmFuZ2UuZW5kQ29udGFpbmVyLCdhJyx0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgaWYoYU5vZGUpew0KICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0RW5kQWZ0ZXIoYU5vZGUpOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgICAgIGJvb2ttYXJrID0gcmFuZ2UuY3JlYXRlQm9va21hcmsoKTsNCg0KICAgICAgICAgICAgICAgIG5vZGUgPSBib29rbWFyay5zdGFydDsNCg0KICAgICAgICAgICAgICAgIC8v5YiH5byA5aeLDQogICAgICAgICAgICAgICAgd2hpbGUgKCAocGFyZW50ID0gbm9kZS5wYXJlbnROb2RlKSAmJiAhZG9tVXRpbHMuaXNCbG9ja0VsbSggcGFyZW50ICkgKSB7DQogICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLmJyZWFrUGFyZW50KCBub2RlLCBwYXJlbnQgKTsNCg0KICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5jbGVhckVtcHR5U2libGluZyggbm9kZSApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoIGJvb2ttYXJrLmVuZCApIHsNCiAgICAgICAgICAgICAgICAgICAgLy/liIfnu5PmnZ8NCiAgICAgICAgICAgICAgICAgICAgbm9kZSA9IGJvb2ttYXJrLmVuZDsNCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKCAocGFyZW50ID0gbm9kZS5wYXJlbnROb2RlKSAmJiAhZG9tVXRpbHMuaXNCbG9ja0VsbSggcGFyZW50ICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5icmVha1BhcmVudCggbm9kZSwgcGFyZW50ICk7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5jbGVhckVtcHR5U2libGluZyggbm9kZSApOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgLy/lvIDlp4vljrvpmaTmoLflvI8NCiAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnQgPSBkb21VdGlscy5nZXROZXh0RG9tTm9kZSggYm9va21hcmsuc3RhcnQsIGZhbHNlLCBmaWx0ZXIgKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIG5leHQ7DQogICAgICAgICAgICAgICAgICAgIHdoaWxlICggY3VycmVudCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggY3VycmVudCA9PSBib29rbWFyay5lbmQgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIG5leHQgPSBkb21VdGlscy5nZXROZXh0RG9tTm9kZSggY3VycmVudCwgdHJ1ZSwgZmlsdGVyICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggIWR0ZC4kZW1wdHlbY3VycmVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCldICYmICFkb21VdGlscy5pc0Jvb2ttYXJrTm9kZSggY3VycmVudCApICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggdGFnUmVnLnRlc3QoIGN1cnJlbnQudGFnTmFtZSApICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIHN0eWxlICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlU3R5bGUoIGN1cnJlbnQsIHN0eWxlICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGlzUmVkdW5kYW50U3BhbiggY3VycmVudCApICYmIHN0eWxlICE9ICd0ZXh0LWRlY29yYXRpb24nKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUoIGN1cnJlbnQsIHRydWUgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZSggY3VycmVudCwgdHJ1ZSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy90cmFjZTo5MzkgIOS4jeiDveaKimxpc3TkuIrnmoTmoLflvI/ljrvmjokNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIWR0ZC4kdGFibGVDb250ZW50W2N1cnJlbnQudGFnTmFtZV0gJiYgIWR0ZC4kbGlzdFtjdXJyZW50LnRhZ05hbWVdKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZUF0dHJpYnV0ZXMoIGN1cnJlbnQsIHJlbW92ZUZvcm1hdEF0dHJpYnV0ZXMgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggaXNSZWR1bmRhbnRTcGFuKCBjdXJyZW50ICkgKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUoIGN1cnJlbnQsIHRydWUgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IG5leHQ7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy90cmFjZToxMDM1DQogICAgICAgICAgICAgICAgLy90cmFjZToxMDk2IOS4jeiDveaKinRk5LiK55qE5qC35byP5Y675o6J77yM5q+U5aaC6L655qGGDQogICAgICAgICAgICAgICAgdmFyIHBOID0gYm9va21hcmsuc3RhcnQucGFyZW50Tm9kZTsNCiAgICAgICAgICAgICAgICBpZihkb21VdGlscy5pc0Jsb2NrRWxtKHBOKSAmJiAhZHRkLiR0YWJsZUNvbnRlbnRbcE4udGFnTmFtZV0gJiYgIWR0ZC4kbGlzdFtwTi50YWdOYW1lXSl7DQogICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZUF0dHJpYnV0ZXMoICBwTixyZW1vdmVGb3JtYXRBdHRyaWJ1dGVzICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHBOID0gYm9va21hcmsuZW5kLnBhcmVudE5vZGU7DQogICAgICAgICAgICAgICAgaWYoYm9va21hcmsuZW5kICYmIGRvbVV0aWxzLmlzQmxvY2tFbG0ocE4pICYmICFkdGQuJHRhYmxlQ29udGVudFtwTi50YWdOYW1lXSYmICFkdGQuJGxpc3RbcE4udGFnTmFtZV0pew0KICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmVBdHRyaWJ1dGVzKCAgcE4scmVtb3ZlRm9ybWF0QXR0cmlidXRlcyApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICByYW5nZS5tb3ZlVG9Cb29rbWFyayggYm9va21hcmsgKS5tb3ZlVG9Cb29rbWFyayhib29rbWFyazEpOw0KICAgICAgICAgICAgICAgIC8v5riF6Zmk5YaX5L2Z55qE5Luj56CBIDxiPjxib29rbWFyaz48L2I+DQogICAgICAgICAgICAgICAgdmFyIG5vZGUgPSByYW5nZS5zdGFydENvbnRhaW5lciwNCiAgICAgICAgICAgICAgICAgICAgdG1wLA0KICAgICAgICAgICAgICAgICAgICBjb2xsYXBzZWQgPSByYW5nZS5jb2xsYXBzZWQ7DQogICAgICAgICAgICAgICAgd2hpbGUobm9kZS5ub2RlVHlwZSA9PSAxICYmIGRvbVV0aWxzLmlzRW1wdHlOb2RlKG5vZGUpICYmIGR0ZC4kcmVtb3ZlRW1wdHlbbm9kZS50YWdOYW1lXSl7DQogICAgICAgICAgICAgICAgICAgIHRtcCA9IG5vZGUucGFyZW50Tm9kZTsNCiAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnRCZWZvcmUobm9kZSk7DQogICAgICAgICAgICAgICAgICAgIC8vdHJhY2U6OTM3DQogICAgICAgICAgICAgICAgICAgIC8v5pu05paw57uT5p2f6L6555WMDQogICAgICAgICAgICAgICAgICAgIGlmKHJhbmdlLnN0YXJ0Q29udGFpbmVyID09PSByYW5nZS5lbmRDb250YWluZXIpew0KICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2UuZW5kT2Zmc2V0LS07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKG5vZGUpOw0KICAgICAgICAgICAgICAgICAgICBub2RlID0gdG1wOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmKCFjb2xsYXBzZWQpew0KICAgICAgICAgICAgICAgICAgICBub2RlID0gcmFuZ2UuZW5kQ29udGFpbmVyOw0KICAgICAgICAgICAgICAgICAgICB3aGlsZShub2RlLm5vZGVUeXBlID09IDEgJiYgZG9tVXRpbHMuaXNFbXB0eU5vZGUobm9kZSkgJiYgZHRkLiRyZW1vdmVFbXB0eVtub2RlLnRhZ05hbWVdKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRtcCA9IG5vZGUucGFyZW50Tm9kZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldEVuZEJlZm9yZShub2RlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShub2RlKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IHRtcDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCg0KDQogICAgICAgICAgICByYW5nZSA9IHRoaXMuc2VsZWN0aW9uLmdldFJhbmdlKCk7DQogICAgICAgICAgICBkb1JlbW92ZSggcmFuZ2UgKTsNCiAgICAgICAgICAgIHJhbmdlLnNlbGVjdCgpOw0KDQogICAgICAgIH0NCg0KICAgIH07DQoNCn07DQoKLy8vaW1wb3J0IGNvcmUNCi8vL2NvbW1hbmRzIOW8leeUqA0KLy8vY29tbWFuZHNOYW1lICBCbG9ja1F1b3RlDQovLy9jb21tYW5kc1RpdGxlICDlvJXnlKgNCi8qKg0KICogDQogKiDlvJXnlKjmqKHlnZflrp7njrANCiAqIEBmdW5jdGlvbg0KICogQG5hbWUgYmFpZHUuZWRpdG9yLmV4ZWNDb21tYW5kDQogKiBAcGFyYW0gICB7U3RyaW5nfSAgIGNtZE5hbWUgICAgIGJsb2NrcXVvdGXlvJXnlKgNCiAqLw0KDQoNClVFLnBsdWdpbnNbJ2Jsb2NrcXVvdGUnXSA9IGZ1bmN0aW9uKCl7DQogICAgdmFyIG1lID0gdGhpczsNCiAgICBmdW5jdGlvbiBnZXRPYmooZWRpdG9yKXsNCiAgICAgICAgcmV0dXJuIGRvbVV0aWxzLmZpbHRlck5vZGVMaXN0KGVkaXRvci5zZWxlY3Rpb24uZ2V0U3RhcnRFbGVtZW50UGF0aCgpLCdibG9ja3F1b3RlJyk7DQogICAgfQ0KICAgIG1lLmNvbW1hbmRzWydibG9ja3F1b3RlJ10gPSB7DQogICAgICAgIGV4ZWNDb21tYW5kIDogZnVuY3Rpb24oIGNtZE5hbWUsIGF0dHJzICkgew0KICAgICAgICAgICAgdmFyIHJhbmdlID0gdGhpcy5zZWxlY3Rpb24uZ2V0UmFuZ2UoKSwNCiAgICAgICAgICAgICAgICBvYmogPSBnZXRPYmoodGhpcyksDQogICAgICAgICAgICAgICAgYmxvY2txdW90ZSA9IGR0ZC5ibG9ja3F1b3RlLA0KICAgICAgICAgICAgICAgIGJvb2ttYXJrID0gcmFuZ2UuY3JlYXRlQm9va21hcmsoKTsNCg0KICAgICAgICAgICAgaWYgKCBvYmogKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXJ0ID0gcmFuZ2Uuc3RhcnRDb250YWluZXIsDQogICAgICAgICAgICAgICAgICAgICAgICBzdGFydEJsb2NrID0gZG9tVXRpbHMuaXNCbG9ja0VsbShzdGFydCkgPyBzdGFydCA6IGRvbVV0aWxzLmZpbmRQYXJlbnQoc3RhcnQsZnVuY3Rpb24obm9kZSl7cmV0dXJuIGRvbVV0aWxzLmlzQmxvY2tFbG0obm9kZSl9KSwNCg0KICAgICAgICAgICAgICAgICAgICAgICAgZW5kID0gcmFuZ2UuZW5kQ29udGFpbmVyLA0KICAgICAgICAgICAgICAgICAgICAgICAgZW5kQmxvY2sgPSBkb21VdGlscy5pc0Jsb2NrRWxtKGVuZCkgPyBlbmQgOiAgZG9tVXRpbHMuZmluZFBhcmVudChlbmQsZnVuY3Rpb24obm9kZSl7cmV0dXJuIGRvbVV0aWxzLmlzQmxvY2tFbG0obm9kZSl9KTsNCg0KICAgICAgICAgICAgICAgICAgICAvL+WkhOeQhuS4gOS4i2xpDQogICAgICAgICAgICAgICAgICAgIHN0YXJ0QmxvY2sgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKHN0YXJ0QmxvY2ssJ2xpJyx0cnVlKSB8fCBzdGFydEJsb2NrOw0KICAgICAgICAgICAgICAgICAgICBlbmRCbG9jayA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUoZW5kQmxvY2ssJ2xpJyx0cnVlKSB8fCBlbmRCbG9jazsNCg0KDQogICAgICAgICAgICAgICAgICAgIGlmKHN0YXJ0QmxvY2sudGFnTmFtZSA9PSAnTEknIHx8IHN0YXJ0QmxvY2sudGFnTmFtZSA9PSAnVEQnIHx8IHN0YXJ0QmxvY2sgPT09IG9iaiB8fCBkb21VdGlscy5pc0JvZHkoc3RhcnRCbG9jaykpew0KICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKG9iaix0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5icmVha1BhcmVudChzdGFydEJsb2NrLG9iaik7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBpZihzdGFydEJsb2NrICE9PSBlbmRCbG9jayl7DQogICAgICAgICAgICAgICAgICAgICAgICBvYmogPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKGVuZEJsb2NrLCdibG9ja3F1b3RlJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZihvYmopew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGVuZEJsb2NrLnRhZ05hbWUgPT0gJ0xJJyB8fCBlbmRCbG9jay50YWdOYW1lID09ICdURCd8fCBkb21VdGlscy5pc0JvZHkoZW5kQmxvY2spKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqLnBhcmVudE5vZGUgJiYgZG9tVXRpbHMucmVtb3ZlKG9iaix0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMuYnJlYWtQYXJlbnQoZW5kQmxvY2ssb2JqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIHZhciBibG9ja3F1b3RlcyA9IGRvbVV0aWxzLmdldEVsZW1lbnRzQnlUYWdOYW1lKHRoaXMuZG9jdW1lbnQsJ2Jsb2NrcXVvdGUnKTsNCiAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpPTAsYmk7Ymk9YmxvY2txdW90ZXNbaSsrXTspew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoIWJpLmNoaWxkTm9kZXMubGVuZ3RoKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUoYmkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2UgaWYoZG9tVXRpbHMuZ2V0UG9zaXRpb24oYmksc3RhcnRCbG9jaykmZG9tVXRpbHMuUE9TSVRJT05fRk9MTE9XSU5HICYmIGRvbVV0aWxzLmdldFBvc2l0aW9uKGJpLGVuZEJsb2NrKSZkb21VdGlscy5QT1NJVElPTl9QUkVDRURJTkcpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShiaSx0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KDQoNCg0KDQogICAgICAgICAgICB9IGVsc2Ugew0KDQogICAgICAgICAgICAgICAgdmFyIHRtcFJhbmdlID0gcmFuZ2UuY2xvbmVSYW5nZSgpLA0KICAgICAgICAgICAgICAgICAgICBub2RlID0gdG1wUmFuZ2Uuc3RhcnRDb250YWluZXIubm9kZVR5cGUgPT0gMSA/IHRtcFJhbmdlLnN0YXJ0Q29udGFpbmVyIDogdG1wUmFuZ2Uuc3RhcnRDb250YWluZXIucGFyZW50Tm9kZSwNCiAgICAgICAgICAgICAgICAgICAgcHJlTm9kZSA9IG5vZGUsDQogICAgICAgICAgICAgICAgICAgIGRvRW5kID0gMTsNCg0KICAgICAgICAgICAgICAgIC8v6LCD5pW05byA5aeLDQogICAgICAgICAgICAgICAgd2hpbGUgKCAxICkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIGRvbVV0aWxzLmlzQm9keShub2RlKSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggcHJlTm9kZSAhPT0gbm9kZSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIHJhbmdlLmNvbGxhcHNlZCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wUmFuZ2Uuc2VsZWN0Tm9kZSggcHJlTm9kZSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb0VuZCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wUmFuZ2Uuc2V0U3RhcnRCZWZvcmUoIHByZU5vZGUgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBSYW5nZS5zZXRTdGFydChub2RlLDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoICFibG9ja3F1b3RlW25vZGUudGFnTmFtZV0gKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIHJhbmdlLmNvbGxhcHNlZCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBSYW5nZS5zZWxlY3ROb2RlKCBwcmVOb2RlICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wUmFuZ2Uuc2V0U3RhcnRCZWZvcmUoIHByZU5vZGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBwcmVOb2RlID0gbm9kZTsNCiAgICAgICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUucGFyZW50Tm9kZTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvL+iwg+aVtOe7k+adnw0KICAgICAgICAgICAgICAgIGlmICggZG9FbmQgKSB7DQogICAgICAgICAgICAgICAgICAgIHByZU5vZGUgPSBub2RlID0gIG5vZGUgPSB0bXBSYW5nZS5lbmRDb250YWluZXIubm9kZVR5cGUgPT0gMSA/IHRtcFJhbmdlLmVuZENvbnRhaW5lciA6IHRtcFJhbmdlLmVuZENvbnRhaW5lci5wYXJlbnROb2RlOw0KICAgICAgICAgICAgICAgICAgICB3aGlsZSAoIDEgKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggZG9tVXRpbHMuaXNCb2R5KCBub2RlICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBwcmVOb2RlICE9PSBub2RlICkgew0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcFJhbmdlLnNldEVuZEFmdGVyKCBwcmVOb2RlICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBSYW5nZS5zZXRFbmQoIG5vZGUsIG5vZGUuY2hpbGROb2Rlcy5sZW5ndGggKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggIWJsb2NrcXVvdGVbbm9kZS50YWdOYW1lXSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBSYW5nZS5zZXRFbmRBZnRlciggcHJlTm9kZSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICBwcmVOb2RlID0gbm9kZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLnBhcmVudE5vZGU7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICAgICAgbm9kZSA9IHJhbmdlLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdibG9ja3F1b3RlJyApOw0KICAgICAgICAgICAgICAgIGRvbVV0aWxzLnNldEF0dHJpYnV0ZXMoIG5vZGUsIGF0dHJzICk7DQogICAgICAgICAgICAgICAgbm9kZS5hcHBlbmRDaGlsZCggdG1wUmFuZ2UuZXh0cmFjdENvbnRlbnRzKCkgKTsNCiAgICAgICAgICAgICAgICB0bXBSYW5nZS5pbnNlcnROb2RlKCBub2RlICk7DQogICAgICAgICAgICAgICAgLy/ljrvpmaTph43lpI3nmoQNCiAgICAgICAgICAgICAgICB2YXIgY2hpbGRzID0gZG9tVXRpbHMuZ2V0RWxlbWVudHNCeVRhZ05hbWUobm9kZSwnYmxvY2txdW90ZScpOw0KICAgICAgICAgICAgICAgIGZvcih2YXIgaT0wLGNpO2NpPWNoaWxkc1tpKytdOyl7DQogICAgICAgICAgICAgICAgICAgIGlmKGNpLnBhcmVudE5vZGUpew0KICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKGNpLHRydWUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB9DQogICAgICAgICAgICByYW5nZS5tb3ZlVG9Cb29rbWFyayggYm9va21hcmsgKS5zZWxlY3QoKTsNCiAgICAgICAgfSwNCiAgICAgICAgcXVlcnlDb21tYW5kU3RhdGUgOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHJldHVybiBnZXRPYmoodGhpcykgPyAxIDogMDsNCiAgICAgICAgfQ0KICAgIH07DQp9Ow0KDQoKLy8vaW1wb3J0IGNvcmUNCi8vL2ltcG9ydCBwbHVnaW5zXHBhcmFncmFwaC5qcw0KLy8vY29tbWFuZHMg6aaW6KGM57yp6L+bDQovLy9jb21tYW5kc05hbWUgIE91dGRlbnQsSW5kZW50DQovLy9jb21tYW5kc1RpdGxlICDlj5bmtojnvKnov5ss6aaW6KGM57yp6L+bDQovKioNCiAqIOmmluihjOe8qei/mw0KICogQGZ1bmN0aW9uDQogKiBAbmFtZSBiYWlkdS5lZGl0b3IuZXhlY0NvbW1hbmQNCiAqIEBwYXJhbSAgIHtTdHJpbmd9ICAgY21kTmFtZSAgICAgb3V0ZGVudOWPlua2iOe8qei/m++8jGluZGVudOe8qei/mw0KICovDQpVRS5jb21tYW5kc1snaW5kZW50J10gPSB7DQogICAgZXhlY0NvbW1hbmQgOiBmdW5jdGlvbigpIHsNCiAgICAgICAgIHZhciBtZSA9IHRoaXMsdmFsdWUgPSBtZS5xdWVyeUNvbW1hbmRTdGF0ZSgiaW5kZW50IikgPyAiMGVtIiA6IChtZS5vcHRpb25zLmluZGVudFZhbHVlIHx8ICcyZW0nKTsNCiAgICAgICAgIG1lLmV4ZWNDb21tYW5kKCdQYXJhZ3JhcGgnLCdwJyx7c3R5bGU6J3RleHQtaW5kZW50OicrIHZhbHVlfSk7DQogICAgfSwNCiAgICBxdWVyeUNvbW1hbmRTdGF0ZSA6IGZ1bmN0aW9uKCkgew0KICAgICAgICB2YXIgcE4gPSBkb21VdGlscy5maWx0ZXJOb2RlTGlzdCh0aGlzLnNlbGVjdGlvbi5nZXRTdGFydEVsZW1lbnRQYXRoKCksJ3AgaDEgaDIgaDMgaDQgaDUgaDYnKTsNCiAgICAgICAgcmV0dXJuIHBOICYmIHBOLnN0eWxlLnRleHRJbmRlbnQgJiYgcGFyc2VJbnQocE4uc3R5bGUudGV4dEluZGVudCkgPyAgMSA6IDA7DQogICAgfQ0KDQp9Ow0KCi8vL2ltcG9ydCBjb3JlDQovLy9jb21tYW5kcyDmiZPljbANCi8vL2NvbW1hbmRzTmFtZSAgUHJpbnQNCi8vL2NvbW1hbmRzVGl0bGUgIOaJk+WNsA0KLyoqDQogKiBAZGVzY3JpcHRpb24g5omT5Y2wDQogKiBAbmFtZSBiYWlkdS5lZGl0b3IuZXhlY0NvbW1hbmQNCiAqIEBwYXJhbSAgIHtTdHJpbmd9ICAgY21kTmFtZSAgICAgcHJpbnTmiZPljbDnvJbovpHlmajlhoXlrrkNCiAqIEBhdXRob3IgemhhbnlpDQogKi8NClVFLmNvbW1hbmRzWydwcmludCddID0gew0KICAgIGV4ZWNDb21tYW5kIDogZnVuY3Rpb24oKXsNCiAgICAgICAgdGhpcy53aW5kb3cucHJpbnQoKTsNCiAgICB9LA0KICAgIG5vdE5lZWRVbmRvIDogMQ0KfTsNCg0KCi8vL2ltcG9ydCBjb3JlDQovLy9jb21tYW5kcyDlhajpgIkNCi8vL2NvbW1hbmRzTmFtZSAgU2VsZWN0QWxsDQovLy9jb21tYW5kc1RpdGxlICDlhajpgIkNCi8qKg0KICog6YCJ5Lit5omA5pyJDQogKiBAZnVuY3Rpb24NCiAqIEBuYW1lIGJhaWR1LmVkaXRvci5leGVjQ29tbWFuZA0KICogQHBhcmFtICAge1N0cmluZ30gICBjbWROYW1lICAgIHNlbGVjdGFsbOmAieS4ree8lui+keWZqOmHjOeahOaJgOacieWGheWuuQ0KICogQGF1dGhvciB6aGFueWkNCiovDQpVRS5wbHVnaW5zWydzZWxlY3RhbGwnXSA9IGZ1bmN0aW9uKCl7DQogICAgdmFyIG1lID0gdGhpczsNCiAgICBtZS5jb21tYW5kc1snc2VsZWN0YWxsJ10gPSB7DQogICAgICAgIGV4ZWNDb21tYW5kIDogZnVuY3Rpb24oKXsNCiAgICAgICAgICAgIC8v5Y675o6J5LqG5Y6f55Sf55qEc2VsZWN0QWxsLOWboOS4uuS8muWHuueOsOaKpemUmeWSjOW9k+WGheWuueS4uuepuuaXtu+8jOS4jeiDveWHuueOsOmXreWQiOeKtuaAgeeahOWFieaghw0KICAgICAgICAgICAgdmFyIG1lID0gdGhpcyxib2R5ID0gbWUuYm9keSwNCiAgICAgICAgICAgICAgICByYW5nZSA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpOw0KICAgICAgICAgICAgcmFuZ2Uuc2VsZWN0Tm9kZUNvbnRlbnRzKGJvZHkpOw0KICAgICAgICAgICAgaWYoZG9tVXRpbHMuaXNFbXB0eUJsb2NrKGJvZHkpKXsNCiAgICAgICAgICAgICAgICAvL29wZXJh5LiN6IO96Ieq5Yqo5ZCI5bm25Yiw5YWD57Sg55qE6YeM6L6577yM6KaB5omL5Yqo5aSE55CG5LiA5LiLDQogICAgICAgICAgICAgICAgaWYoYnJvd3Nlci5vcGVyYSAmJiBib2R5LmZpcnN0Q2hpbGQgJiYgYm9keS5maXJzdENoaWxkLm5vZGVUeXBlID09IDEpew0KICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydEF0Rmlyc3QoYm9keS5maXJzdENoaWxkKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmFuZ2UuY29sbGFwc2UodHJ1ZSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByYW5nZS5zZWxlY3QodHJ1ZSk7DQogICAgICAgIH0sDQogICAgICAgIG5vdE5lZWRVbmRvIDogMQ0KICAgIH07DQoNCg0KICAgIC8v5b+r5o236ZSuDQogICAgbWUuYWRkc2hvcnRjdXRrZXkoew0KICAgICAgICAgInNlbGVjdEFsbCIgOiAiY3RybCs2NSINCiAgICB9KTsNCn07DQoKLy8vaW1wb3J0IGNvcmUNCi8vL2NvbW1hbmRzIOagvOW8jw0KLy8vY29tbWFuZHNOYW1lICBQYXJhZ3JhcGgNCi8vL2NvbW1hbmRzVGl0bGUgIOauteiQveagvOW8jw0KLyoqDQogKiDmrrXokL3moLflvI8NCiAqIEBmdW5jdGlvbg0KICogQG5hbWUgYmFpZHUuZWRpdG9yLmV4ZWNDb21tYW5kDQogKiBAcGFyYW0gICB7U3RyaW5nfSAgIGNtZE5hbWUgICAgIHBhcmFncmFwaOaPkuWFpeauteiQveaJp+ihjOWRveS7pA0KICogQHBhcmFtICAge1N0cmluZ30gICBzdHlsZSAgICAgICAgICAgICAgIOagh+etvuWAvOS4uu+8midwJywgJ2gxJywgJ2gyJywgJ2gzJywgJ2g0JywgJ2g1JywgJ2g2Jw0KICogQHBhcmFtICAge1N0cmluZ30gICBhdHRycyAgICAgICAgICAgICAgIOagh+etvueahOWxnuaApw0KICogQGF1dGhvciB6aGFueWkNCiAqLw0KVUUucGx1Z2luc1sncGFyYWdyYXBoJ10gPSBmdW5jdGlvbigpIHsNCiAgICB2YXIgbWUgPSB0aGlzLA0KICAgICAgICBibG9jayA9IGRvbVV0aWxzLmlzQmxvY2tFbG0sDQogICAgICAgIG5vdEV4Y2hhbmdlID0gWydURCcsJ0xJJywnUFJFJ10sDQoNCiAgICAgICAgZG9QYXJhZ3JhcGggPSBmdW5jdGlvbihyYW5nZSxzdHlsZSxhdHRycyxzb3VyY2VDbWROYW1lKXsNCiAgICAgICAgICAgIHZhciBib29rbWFyayA9IHJhbmdlLmNyZWF0ZUJvb2ttYXJrKCksDQogICAgICAgICAgICAgICAgZmlsdGVyRm4gPSBmdW5jdGlvbiggbm9kZSApIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAgbm9kZS5ub2RlVHlwZSA9PSAxID8gbm9kZS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgIT0gJ2JyJyAmJiAgIWRvbVV0aWxzLmlzQm9va21hcmtOb2RlKG5vZGUpIDogIWRvbVV0aWxzLmlzV2hpdGVzcGFjZSggbm9kZSApOw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgcGFyYTsNCg0KICAgICAgICAgICAgcmFuZ2UuZW5sYXJnZSggdHJ1ZSApOw0KICAgICAgICAgICAgdmFyIGJvb2ttYXJrMiA9IHJhbmdlLmNyZWF0ZUJvb2ttYXJrKCksDQogICAgICAgICAgICAgICAgY3VycmVudCA9IGRvbVV0aWxzLmdldE5leHREb21Ob2RlKCBib29rbWFyazIuc3RhcnQsIGZhbHNlLCBmaWx0ZXJGbiApLA0KICAgICAgICAgICAgICAgIHRtcFJhbmdlID0gcmFuZ2UuY2xvbmVSYW5nZSgpLA0KICAgICAgICAgICAgICAgIHRtcE5vZGU7DQogICAgICAgICAgICB3aGlsZSAoIGN1cnJlbnQgJiYgIShkb21VdGlscy5nZXRQb3NpdGlvbiggY3VycmVudCwgYm9va21hcmsyLmVuZCApICYgZG9tVXRpbHMuUE9TSVRJT05fRk9MTE9XSU5HKSApIHsNCiAgICAgICAgICAgICAgICBpZiAoIGN1cnJlbnQubm9kZVR5cGUgPT0gMyB8fCAhYmxvY2soIGN1cnJlbnQgKSApIHsNCiAgICAgICAgICAgICAgICAgICAgdG1wUmFuZ2Uuc2V0U3RhcnRCZWZvcmUoIGN1cnJlbnQgKTsNCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKCBjdXJyZW50ICYmIGN1cnJlbnQgIT09IGJvb2ttYXJrMi5lbmQgJiYgIWJsb2NrKCBjdXJyZW50ICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0bXBOb2RlID0gY3VycmVudDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBkb21VdGlscy5nZXROZXh0RG9tTm9kZSggY3VycmVudCwgZmFsc2UsIG51bGwsIGZ1bmN0aW9uKCBub2RlICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhYmxvY2soIG5vZGUgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0bXBSYW5nZS5zZXRFbmRBZnRlciggdG1wTm9kZSApOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgcGFyYSA9IHJhbmdlLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIHN0eWxlICk7DQogICAgICAgICAgICAgICAgICAgIGlmKGF0dHJzKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnNldEF0dHJpYnV0ZXMocGFyYSxhdHRycyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZihzb3VyY2VDbWROYW1lICYmIHNvdXJjZUNtZE5hbWUgPT0gJ2N1c3RvbXN0eWxlJyAmJiBhdHRycy5zdHlsZSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYS5zdHlsZS5jc3NUZXh0ID0gYXR0cnMuc3R5bGU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcGFyYS5hcHBlbmRDaGlsZCggdG1wUmFuZ2UuZXh0cmFjdENvbnRlbnRzKCkgKTsNCiAgICAgICAgICAgICAgICAgICAgLy/pnIDopoHlhoXlrrnljaDkvY0NCiAgICAgICAgICAgICAgICAgICAgaWYoZG9tVXRpbHMuaXNFbXB0eU5vZGUocGFyYSkpew0KICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMuZmlsbENoYXIocmFuZ2UuZG9jdW1lbnQscGFyYSk7DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIHRtcFJhbmdlLmluc2VydE5vZGUoIHBhcmEgKTsNCg0KICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gcGFyYS5wYXJlbnROb2RlOw0KICAgICAgICAgICAgICAgICAgICAvL+WmguaenHBhcmHkuIrkuIDnuqfmmK/kuIDkuKpibG9ja+WFg+e0oOS4lOS4jeaYr2JvZHksdGTlsLHliKDpmaTlroMNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBibG9jayggcGFyZW50ICkgJiYgIWRvbVV0aWxzLmlzQm9keSggcGFyYS5wYXJlbnROb2RlICkgJiYgdXRpbHMuaW5kZXhPZihub3RFeGNoYW5nZSxwYXJlbnQudGFnTmFtZSk9PS0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvL+WtmOWCqGRpcixzdHlsZQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoIShzb3VyY2VDbWROYW1lICYmIHNvdXJjZUNtZE5hbWUgPT0gJ2N1c3RvbXN0eWxlJykpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5nZXRBdHRyaWJ1dGUoJ2RpcicpICYmIHBhcmEuc2V0QXR0cmlidXRlKCdkaXInLHBhcmVudC5nZXRBdHRyaWJ1dGUoJ2RpcicpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3RyYWNlOjEwNzANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuc3R5bGUuY3NzVGV4dCAmJiAocGFyYS5zdHlsZS5jc3NUZXh0ID0gcGFyZW50LnN0eWxlLmNzc1RleHQgKyAnOycgKyBwYXJhLnN0eWxlLmNzc1RleHQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdHJhY2U6MTAzMA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5zdHlsZS50ZXh0QWxpZ24gJiYgIXBhcmEuc3R5bGUudGV4dEFsaWduICYmIChwYXJhLnN0eWxlLnRleHRBbGlnbiA9IHBhcmVudC5zdHlsZS50ZXh0QWxpZ24pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5zdHlsZS50ZXh0SW5kZW50ICYmICFwYXJhLnN0eWxlLnRleHRJbmRlbnQgJiYgKHBhcmEuc3R5bGUudGV4dEluZGVudCA9IHBhcmVudC5zdHlsZS50ZXh0SW5kZW50KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuc3R5bGUucGFkZGluZyAmJiAhcGFyYS5zdHlsZS5wYWRkaW5nICYmIChwYXJhLnN0eWxlLnBhZGRpbmcgPSBwYXJlbnQuc3R5bGUucGFkZGluZyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vdHJhY2U6MTcwNiDpgInmi6nnmoTlsLHmmK9oMS026KaB5Yig6ZmkDQogICAgICAgICAgICAgICAgICAgICAgICBpZihhdHRycyAmJiAvaFxkL2kudGVzdChwYXJlbnQudGFnTmFtZSkgJiYgIS9oXGQvaS50ZXN0KHBhcmEudGFnTmFtZSkgKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5zZXRBdHRyaWJ1dGVzKHBhcmVudCxhdHRycyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc291cmNlQ21kTmFtZSAmJiBzb3VyY2VDbWROYW1lID09ICdjdXN0b21zdHlsZScgJiYgYXR0cnMuc3R5bGUpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuc3R5bGUuY3NzVGV4dCA9IGF0dHJzLnN0eWxlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUocGFyYSx0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhID0gcGFyZW50Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKCBwYXJhLnBhcmVudE5vZGUsIHRydWUgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmKCAgdXRpbHMuaW5kZXhPZihub3RFeGNoYW5nZSxwYXJlbnQudGFnTmFtZSkhPS0xKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBwYXJlbnQ7DQogICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50ID0gcGFyYTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IGRvbVV0aWxzLmdldE5leHREb21Ob2RlKCBjdXJyZW50LCBmYWxzZSwgZmlsdGVyRm4gKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBjdXJyZW50ID0gZG9tVXRpbHMuZ2V0TmV4dERvbU5vZGUoIGN1cnJlbnQsIHRydWUsIGZpbHRlckZuICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIHJhbmdlLm1vdmVUb0Jvb2ttYXJrKCBib29rbWFyazIgKS5tb3ZlVG9Cb29rbWFyayggYm9va21hcmsgKTsNCiAgICAgICAgfTsNCiAgICBtZS5zZXRPcHQoJ3BhcmFncmFwaCcseydwJzonJywgJ2gxJzonJywgJ2gyJzonJywgJ2gzJzonJywgJ2g0JzonJywgJ2g1JzonJywgJ2g2JzonJ30pOw0KICAgIG1lLmNvbW1hbmRzWydwYXJhZ3JhcGgnXSA9IHsNCiAgICAgICAgZXhlY0NvbW1hbmQgOiBmdW5jdGlvbiggY21kTmFtZSwgc3R5bGUsYXR0cnMsc291cmNlQ21kTmFtZSApIHsNCiAgICAgICAgICAgIHZhciByYW5nZSA9IHRoaXMuc2VsZWN0aW9uLmdldFJhbmdlKCk7DQogICAgICAgICAgICAgLy/pl63lkIjml7bljZXni6zlpITnkIYNCiAgICAgICAgICAgIGlmKHJhbmdlLmNvbGxhcHNlZCl7DQogICAgICAgICAgICAgICAgdmFyIHR4dCA9IHRoaXMuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJ3AnKTsNCiAgICAgICAgICAgICAgICByYW5nZS5pbnNlcnROb2RlKHR4dCk7DQogICAgICAgICAgICAgICAgLy/ljrvmjonlhpfkvZnnmoRmaWxsY2hhcg0KICAgICAgICAgICAgICAgIGlmKGJyb3dzZXIuaWUpew0KICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IHR4dC5wcmV2aW91c1NpYmxpbmc7DQogICAgICAgICAgICAgICAgICAgIGlmKG5vZGUgJiYgZG9tVXRpbHMuaXNXaGl0ZXNwYWNlKG5vZGUpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShub2RlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBub2RlID0gdHh0Lm5leHRTaWJsaW5nOw0KICAgICAgICAgICAgICAgICAgICBpZihub2RlICYmIGRvbVV0aWxzLmlzV2hpdGVzcGFjZShub2RlKSl7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUobm9kZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJhbmdlID0gZG9QYXJhZ3JhcGgocmFuZ2Usc3R5bGUsYXR0cnMsc291cmNlQ21kTmFtZSk7DQogICAgICAgICAgICBpZih0eHQpew0KICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0QmVmb3JlKHR4dCkuY29sbGFwc2UodHJ1ZSk7DQogICAgICAgICAgICAgICAgcE4gPSB0eHQucGFyZW50Tm9kZTsNCg0KICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZSh0eHQpOw0KDQogICAgICAgICAgICAgICAgaWYoZG9tVXRpbHMuaXNCbG9ja0VsbShwTikmJmRvbVV0aWxzLmlzRW1wdHlOb2RlKHBOKSl7DQogICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLmZpbGxOb2RlKHRoaXMuZG9jdW1lbnQscE4pOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZihicm93c2VyLmdlY2tvICYmIHJhbmdlLmNvbGxhcHNlZCAmJiByYW5nZS5zdGFydENvbnRhaW5lci5ub2RlVHlwZSA9PSAxKXsNCiAgICAgICAgICAgICAgICB2YXIgY2hpbGQgPSByYW5nZS5zdGFydENvbnRhaW5lci5jaGlsZE5vZGVzW3JhbmdlLnN0YXJ0T2Zmc2V0XTsNCiAgICAgICAgICAgICAgICBpZihjaGlsZCAmJiBjaGlsZC5ub2RlVHlwZSA9PSAxICYmIGNoaWxkLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PSBzdHlsZSl7DQogICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KGNoaWxkLDApLmNvbGxhcHNlKHRydWUpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8vdHJhY2U6MTA5NyDljp/mnaXmnIl0cnVl77yM5Y6f5Zug5b+Y5LqG77yM5L2G5Y675LqG5bCx5LiN6IO95riF6Zmk5aSa5L2Z55qE5Y2g5L2N56ym5LqGDQogICAgICAgICAgICByYW5nZS5zZWxlY3QoKTsNCg0KDQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfSwNCiAgICAgICAgcXVlcnlDb21tYW5kVmFsdWUgOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBub2RlID0gZG9tVXRpbHMuZmlsdGVyTm9kZUxpc3QodGhpcy5zZWxlY3Rpb24uZ2V0U3RhcnRFbGVtZW50UGF0aCgpLCdwIGgxIGgyIGgzIGg0IGg1IGg2Jyk7DQogICAgICAgICAgICByZXR1cm4gbm9kZSA/IG5vZGUudGFnTmFtZS50b0xvd2VyQ2FzZSgpIDogJyc7DQogICAgICAgIH0NCiAgICB9Ow0KfTsNCgovLy9pbXBvcnQgY29yZQ0KLy8vaW1wb3J0IHBsdWdpbnNcaW5zZXJ0aHRtbC5qcw0KLy8vY29tbWFuZHMg5YiG5Ymy57q/DQovLy9jb21tYW5kc05hbWUgIEhvcml6b250YWwNCi8vL2NvbW1hbmRzVGl0bGUgIOWIhumalOe6vw0KLyoqDQogKiDliIblibLnur8NCiAqIEBmdW5jdGlvbg0KICogQG5hbWUgYmFpZHUuZWRpdG9yLmV4ZWNDb21tYW5kDQogKiBAcGFyYW0ge1N0cmluZ30gICAgIGNtZE5hbWUgICAgaG9yaXpvbnRhbOaPkuWFpeWIhuWJsue6vw0KICovDQpVRS5wbHVnaW5zWydob3Jpem9udGFsJ10gPSBmdW5jdGlvbigpew0KICAgIHZhciBtZSA9IHRoaXM7DQogICAgbWUuY29tbWFuZHNbJ2hvcml6b250YWwnXSA9IHsNCiAgICAgICAgZXhlY0NvbW1hbmQgOiBmdW5jdGlvbiggY21kTmFtZSApIHsNCiAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7DQogICAgICAgICAgICBpZihtZS5xdWVyeUNvbW1hbmRTdGF0ZShjbWROYW1lKSE9PS0xKXsNCiAgICAgICAgICAgICAgICBpZiAobWUuZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImhyIikubGVuZ3RoICE9IDApIHsNCiAgICAgICAgICAgICAgICAgICAgbWUuZXhlY0NvbW1hbmQoImluc2VydEh0bWwiLCAiPGhyPiIpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIG1lLmV4ZWNDb21tYW5kKCJpbnNlcnRIdG1sIiwgJzxociBjbGFzcz0ibW9yZSIvPicpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB2YXIgcmFuZ2UgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKSwNCiAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSByYW5nZS5zdGFydENvbnRhaW5lcjsNCiAgICAgICAgICAgICAgICBpZihzdGFydC5ub2RlVHlwZSA9PSAxICYmICFzdGFydC5jaGlsZE5vZGVzW3JhbmdlLnN0YXJ0T2Zmc2V0XSApew0KDQogICAgICAgICAgICAgICAgICAgIHZhciB0bXA7DQogICAgICAgICAgICAgICAgICAgIGlmKHRtcCA9IHN0YXJ0LmNoaWxkTm9kZXNbcmFuZ2Uuc3RhcnRPZmZzZXQgLSAxXSl7DQogICAgICAgICAgICAgICAgICAgICAgICBpZih0bXAubm9kZVR5cGUgPT0gMSAmJiB0bXAudGFnTmFtZSA9PSAnSFInKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtZS5vcHRpb25zLmVudGVyVGFnID09ICdwJyl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcCA9IG1lLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2UuaW5zZXJ0Tm9kZSh0bXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydCh0bXAsMCkuc2V0Q3Vyc29yKCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wID0gbWUuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnInKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2UuaW5zZXJ0Tm9kZSh0bXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydEJlZm9yZSh0bXApLnNldEN1cnNvcigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0sDQogICAgICAgIC8v6L6555WM5ZyodGFibGXph4zkuI3og73liqDliIbpmpTnur8NCiAgICAgICAgcXVlcnlDb21tYW5kU3RhdGUgOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHJldHVybiBkb21VdGlscy5maWx0ZXJOb2RlTGlzdCh0aGlzLnNlbGVjdGlvbi5nZXRTdGFydEVsZW1lbnRQYXRoKCksJ3RhYmxlJykgPyAtMSA6IDA7DQogICAgICAgIH0NCiAgICB9Ow0KLy8gICAgbWUuYWRkTGlzdGVuZXIoJ2RlbGtleXVwJyxmdW5jdGlvbigpew0KLy8gICAgICAgIHZhciBybmcgPSB0aGlzLnNlbGVjdGlvbi5nZXRSYW5nZSgpOw0KLy8gICAgICAgIGlmKGJyb3dzZXIuaWUgJiYgYnJvd3Nlci52ZXJzaW9uID4gOCl7DQovLyAgICAgICAgICAgIHJuZy50eHRUb0VsbUJvdW5kYXJ5KHRydWUpOw0KLy8gICAgICAgICAgICBpZihkb21VdGlscy5pc1N0YXJ0SW5ibG9jayhybmcpKXsNCi8vICAgICAgICAgICAgICAgIHZhciB0bXBOb2RlID0gcm5nLnN0YXJ0Q29udGFpbmVyOw0KLy8gICAgICAgICAgICAgICAgdmFyIHByZSA9IHRtcE5vZGUucHJldmlvdXNTaWJsaW5nOw0KLy8gICAgICAgICAgICAgICAgaWYocHJlICYmIGRvbVV0aWxzLmlzVGFnTm9kZShwcmUsJ2hyJykpew0KLy8gICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShwcmUpOw0KLy8gICAgICAgICAgICAgICAgICAgIHJuZy5zZWxlY3QoKTsNCi8vICAgICAgICAgICAgICAgICAgICByZXR1cm47DQovLyAgICAgICAgICAgICAgICB9DQovLyAgICAgICAgICAgIH0NCi8vICAgICAgICB9DQovLyAgICAgICAgaWYoZG9tVXRpbHMuaXNCb2R5KHJuZy5zdGFydENvbnRhaW5lcikpew0KLy8gICAgICAgICAgICB2YXIgaHIgPSBybmcuc3RhcnRDb250YWluZXIuY2hpbGROb2Rlc1tybmcuc3RhcnRPZmZzZXQgLTFdOw0KLy8gICAgICAgICAgICBpZihociAmJiBoci5ub2RlTmFtZSA9PSAnSFInKXsNCi8vICAgICAgICAgICAgICAgIHZhciBuZXh0ID0gaHIubmV4dFNpYmxpbmc7DQovLyAgICAgICAgICAgICAgICBpZihuZXh0KXsNCi8vICAgICAgICAgICAgICAgICAgICBybmcuc2V0U3RhcnQobmV4dCwwKQ0KLy8gICAgICAgICAgICAgICAgfWVsc2UgaWYoaHIucHJldmlvdXNTaWJsaW5nKXsNCi8vICAgICAgICAgICAgICAgICAgICBybmcuc2V0U3RhcnRBdExhc3QoaHIucHJldmlvdXNTaWJsaW5nKQ0KLy8gICAgICAgICAgICAgICAgfWVsc2V7DQovLyAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSB0aGlzLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTsNCi8vICAgICAgICAgICAgICAgICAgICBoci5wYXJlbnROb2RlLmluc2VydEJlZm9yZShwLGhyKTsNCi8vICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5maWxsTm9kZSh0aGlzLmRvY3VtZW50LHApOw0KLy8gICAgICAgICAgICAgICAgICAgIHJuZy5zZXRTdGFydChwLDApOw0KLy8gICAgICAgICAgICAgICAgfQ0KLy8gICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKGhyKTsNCi8vICAgICAgICAgICAgICAgIHJuZy5zZXRDdXJzb3IoZmFsc2UsdHJ1ZSk7DQovLyAgICAgICAgICAgIH0NCi8vICAgICAgICB9DQovLyAgICB9KQ0KICAgIG1lLmFkZExpc3RlbmVyKCdkZWxrZXlkb3duJyxmdW5jdGlvbihuYW1lLGV2dCl7DQogICAgICAgIHZhciBybmcgPSB0aGlzLnNlbGVjdGlvbi5nZXRSYW5nZSgpOw0KICAgICAgICBybmcudHh0VG9FbG1Cb3VuZGFyeSh0cnVlKTsNCiAgICAgICAgaWYoZG9tVXRpbHMuaXNTdGFydEluYmxvY2socm5nKSl7DQogICAgICAgICAgICB2YXIgdG1wTm9kZSA9IHJuZy5zdGFydENvbnRhaW5lcjsNCiAgICAgICAgICAgIHZhciBwcmUgPSB0bXBOb2RlLnByZXZpb3VzU2libGluZzsNCiAgICAgICAgICAgIGlmKHByZSAmJiBkb21VdGlscy5pc1RhZ05vZGUocHJlLCdocicpKXsNCiAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUocHJlKTsNCiAgICAgICAgICAgICAgICBybmcuc2VsZWN0KCk7DQogICAgICAgICAgICAgICAgZG9tVXRpbHMucHJldmVudERlZmF1bHQoZXZ0KTsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCg0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICB9KQ0KfTsNCg0KCi8vL2ltcG9ydCBjb3JlDQovLy9pbXBvcnQgcGx1Z2luc1xpbnNlcnRodG1sLmpzDQovLy9jb21tYW5kcyDml6XmnJ8s5pe26Ze0DQovLy9jb21tYW5kc05hbWUgIERhdGUsVGltZQ0KLy8vY29tbWFuZHNUaXRsZSAg5pel5pyfLOaXtumXtA0KLyoqDQogKiDmj5LlhaXml6XmnJ8NCiAqIEBmdW5jdGlvbg0KICogQG5hbWUgYmFpZHUuZWRpdG9yLmV4ZWNDb21tYW5kDQogKiBAcGFyYW0gICB7U3RyaW5nfSAgIGNtZE5hbWUgICAgZGF0ZeaPkuWFpeaXpeacnw0KICogQGF1dGhvciB6aHV3ZW54dWFuDQoqLw0KLyoqDQogKiDmj5LlhaXml7bpl7QNCiAqIEBmdW5jdGlvbg0KICogQG5hbWUgYmFpZHUuZWRpdG9yLmV4ZWNDb21tYW5kDQogKiBAcGFyYW0gICB7U3RyaW5nfSAgIGNtZE5hbWUgICAgdGltZeaPkuWFpeaXtumXtA0KICogQGF1dGhvciB6aHV3ZW54dWFuDQoqLw0KVUUuY29tbWFuZHNbJ3RpbWUnXSA9IFVFLmNvbW1hbmRzWyJkYXRlIl0gPSB7DQogICAgZXhlY0NvbW1hbmQgOiBmdW5jdGlvbihjbWQpew0KICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlOw0KICAgICAgICB0aGlzLmV4ZWNDb21tYW5kKCdpbnNlcnRIdG1sJyxjbWQgPT0gInRpbWUiID8NCiAgICAgICAgICAgIChkYXRlLmdldEhvdXJzKCkrIjoiKyAoZGF0ZS5nZXRNaW51dGVzKCk8MTAgPyAiMCIrZGF0ZS5nZXRNaW51dGVzKCkgOiBkYXRlLmdldE1pbnV0ZXMoKSkrIjoiKyhkYXRlLmdldFNlY29uZHMoKTwxMCA/ICIwIitkYXRlLmdldFNlY29uZHMoKSA6IGRhdGUuZ2V0U2Vjb25kcygpKSkgOg0KICAgICAgICAgICAgKGRhdGUuZ2V0RnVsbFllYXIoKSsiLSIrKChkYXRlLmdldE1vbnRoKCkrMSk8MTAgPyAiMCIrKGRhdGUuZ2V0TW9udGgoKSsxKSA6IGRhdGUuZ2V0TW9udGgoKSsxKSsiLSIrKGRhdGUuZ2V0RGF0ZSgpPDEwPyIwIitkYXRlLmdldERhdGUoKTpkYXRlLmdldERhdGUoKSkpKTsNCiAgICB9DQp9Ow0KDQoNCg0KCi8vL2ltcG9ydCBjb3JlDQovLy9pbXBvcnQgcGx1Z2luc1xwYXJhZ3JhcGguanMNCi8vL2NvbW1hbmRzIOautemXtOi3nQ0KLy8vY29tbWFuZHNOYW1lICBSb3dTcGFjaW5nQm90dG9tLFJvd1NwYWNpbmdUb3ANCi8vL2NvbW1hbmRzVGl0bGUgIOautemXtOi3nQ0KLyoqDQogKiBAZGVzY3JpcHRpb24g6K6+572u5q615YmN6LedLOauteWQjui3nQ0KICogQG5hbWUgYmFpZHUuZWRpdG9yLmV4ZWNDb21tYW5kDQogKiBAcGFyYW0gICB7U3RyaW5nfSAgIGNtZE5hbWUgICAgIHJvd3NwYWNpbmforr7nva7mrrXpl7Tot50NCiAqIEBwYXJhbSAgIHtTdHJpbmd9ICAgdmFsdWUgICAgICAgICAgICAgIOWAvO+8jOS7pXB45Li65Y2V5L2NDQogKiBAcGFyYW0gICB7U3RyaW5nfSAgIGRpciAgICAgICAgICB0b3DmiJZib3R0b23mrrXliY3lkI7mrrXlkI4NCiAqIEBhdXRob3IgemhhbnlpDQogKi8NClVFLnBsdWdpbnNbJ3Jvd3NwYWNpbmcnXSA9IGZ1bmN0aW9uKCl7DQogICAgdmFyIG1lID0gdGhpczsNCiAgICBtZS5zZXRPcHQoew0KICAgICAgICAncm93c3BhY2luZ3RvcCc6Wyc1JywgJzEwJywgJzE1JywgJzIwJywgJzI1J10sDQogICAgICAgICdyb3dzcGFjaW5nYm90dG9tJzpbJzUnLCAnMTAnLCAnMTUnLCAnMjAnLCAnMjUnXQ0KDQogICAgfSk7DQogICAgbWUuY29tbWFuZHNbJ3Jvd3NwYWNpbmcnXSA9ICB7DQogICAgICAgIGV4ZWNDb21tYW5kIDogZnVuY3Rpb24oIGNtZE5hbWUsdmFsdWUsZGlyICkgew0KICAgICAgICAgICAgdGhpcy5leGVjQ29tbWFuZCgncGFyYWdyYXBoJywncCcse3N0eWxlOidtYXJnaW4tJytkaXIrJzonK3ZhbHVlICsgJ3B4J30pOw0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0sDQogICAgICAgIHF1ZXJ5Q29tbWFuZFZhbHVlIDogZnVuY3Rpb24oY21kTmFtZSxkaXIpIHsNCiAgICAgICAgICAgIHZhciBwTiA9IGRvbVV0aWxzLmZpbHRlck5vZGVMaXN0KHRoaXMuc2VsZWN0aW9uLmdldFN0YXJ0RWxlbWVudFBhdGgoKSxmdW5jdGlvbihub2RlKXtyZXR1cm4gZG9tVXRpbHMuaXNCbG9ja0VsbShub2RlKSB9KSwNCiAgICAgICAgICAgICAgICB2YWx1ZTsNCiAgICAgICAgICAgIC8vdHJhY2U6MTAyNg0KICAgICAgICAgICAgaWYocE4pew0KICAgICAgICAgICAgICAgIHZhbHVlID0gZG9tVXRpbHMuZ2V0Q29tcHV0ZWRTdHlsZShwTiwnbWFyZ2luLScrZGlyKS5yZXBsYWNlKC9bXlxkXS9nLCcnKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gIXZhbHVlID8gMCA6IHZhbHVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIDA7DQoNCiAgICAgICAgfQ0KICAgIH07DQp9Ow0KDQoNCgovLy9pbXBvcnQgY29yZQ0KLy8vaW1wb3J0IHBsdWdpbnNccGFyYWdyYXBoLmpzDQovLy9jb21tYW5kcyDooYzpl7Tot50NCi8vL2NvbW1hbmRzTmFtZSAgTGluZUhlaWdodA0KLy8vY29tbWFuZHNUaXRsZSAg6KGM6Ze06LedDQovKioNCiAqIEBkZXNjcmlwdGlvbiDorr7nva7ooYzlhoXpl7Tot50NCiAqIEBuYW1lIGJhaWR1LmVkaXRvci5leGVjQ29tbWFuZA0KICogQHBhcmFtICAge1N0cmluZ30gICBjbWROYW1lICAgICBsaW5laGVpZ2h06K6+572u6KGM5YaF6Ze06LedDQogKiBAcGFyYW0gICB7U3RyaW5nfSAgIHZhbHVlICAgICAgICAgICAgICDlgLwNCiAqIEBhdXRob3Igemh1d2VueHVhbg0KICovDQpVRS5wbHVnaW5zWydsaW5laGVpZ2h0J10gPSBmdW5jdGlvbigpew0KICAgIHZhciBtZSA9IHRoaXM7DQogICAgbWUuc2V0T3B0KHsnbGluZWhlaWdodCc6WycxJywgJzEuNScsJzEuNzUnLCcyJywgJzMnLCAnNCcsICc1J119KTsNCiAgICBtZS5jb21tYW5kc1snbGluZWhlaWdodCddID0gIHsNCiAgICAgICAgZXhlY0NvbW1hbmQgOiBmdW5jdGlvbiggY21kTmFtZSx2YWx1ZSApIHsNCiAgICAgICAgICAgIHRoaXMuZXhlY0NvbW1hbmQoJ3BhcmFncmFwaCcsJ3AnLHtzdHlsZTonbGluZS1oZWlnaHQ6JysgKHZhbHVlID09ICIxIiA/ICJub3JtYWwiIDogdmFsdWUgKyAnZW0nKSB9KTsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9LA0KICAgICAgICBxdWVyeUNvbW1hbmRWYWx1ZSA6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIHBOID0gZG9tVXRpbHMuZmlsdGVyTm9kZUxpc3QodGhpcy5zZWxlY3Rpb24uZ2V0U3RhcnRFbGVtZW50UGF0aCgpLGZ1bmN0aW9uKG5vZGUpe3JldHVybiBkb21VdGlscy5pc0Jsb2NrRWxtKG5vZGUpfSk7DQogICAgICAgICAgICBpZihwTil7DQogICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZG9tVXRpbHMuZ2V0Q29tcHV0ZWRTdHlsZShwTiwnbGluZS1oZWlnaHQnKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUgPT0gJ25vcm1hbCcgPyAxIDogdmFsdWUucmVwbGFjZSgvW15cZC5dKi9pZywiIik7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9Ow0KfTsNCg0KDQoKLy8vaW1wb3J0IGNvcmUKLy8vaW1wb3J0IHBsdWdpbnMvaW5zZXJ0aHRtbC5qcwovLy9jb21tYW5kcyDmj5LlhaXku6PnoIEKLy8vY29tbWFuZHNOYW1lICBjb2RlCi8vL2NvbW1hbmRzVGl0bGUgIOaPkuWFpeS7o+eggQpVRS5wbHVnaW5zWydpbnNlcnRjb2RlJ10gPSBmdW5jdGlvbigpIHsKICAgIHZhciBtZSA9IHRoaXM7CiAgICBtZS5yZWFkeShmdW5jdGlvbigpewogICAgICAgIHV0aWxzLmNzc1J1bGUoJ3ByZScsJ3ByZXttYXJnaW46LjVlbSAwO3BhZGRpbmc6LjRlbSAuNmVtO2JvcmRlci1yYWRpdXM6OHB4O2JhY2tncm91bmQ6I2Y4ZjhmODt9JywKICAgICAgICAgICAgbWUuZG9jdW1lbnQpCiAgICB9KTsKICAgIG1lLnNldE9wdCgnaW5zZXJ0Y29kZScsewogICAgICAgICAgICAnYXMzJzonQWN0aW9uU2NyaXB0MycsCiAgICAgICAgICAgICdiYXNoJzonQmFzaC9TaGVsbCcsCiAgICAgICAgICAgICdjcHAnOidDL0MrKycsCiAgICAgICAgICAgICdjc3MnOidDc3MnLAogICAgICAgICAgICAnY2YnOidDb2RlRnVuY3Rpb24nLAogICAgICAgICAgICAnYyMnOidDIycsCiAgICAgICAgICAgICdkZWxwaGknOidEZWxwaGknLAogICAgICAgICAgICAnZGlmZic6J0RpZmYnLAogICAgICAgICAgICAnZXJsYW5nJzonRXJsYW5nJywKICAgICAgICAgICAgJ2dyb292eSc6J0dyb292eScsCiAgICAgICAgICAgICdodG1sJzonSHRtbCcsCiAgICAgICAgICAgICdqYXZhJzonSmF2YScsCiAgICAgICAgICAgICdqZngnOidKYXZhRngnLAogICAgICAgICAgICAnanMnOidKYXZhc2NyaXB0JywKICAgICAgICAgICAgJ3BsJzonUGVybCcsCiAgICAgICAgICAgICdwaHAnOidQaHAnLAogICAgICAgICAgICAncGxhaW4nOidQbGFpbiBUZXh0JywKICAgICAgICAgICAgJ3BzJzonUG93ZXJTaGVsbCcsCiAgICAgICAgICAgICdweXRob24nOidQeXRob24nLAogICAgICAgICAgICAncnVieSc6J1J1YnknLAogICAgICAgICAgICAnc2NhbGEnOidTY2FsYScsCiAgICAgICAgICAgICdzcWwnOidTcWwnLAogICAgICAgICAgICAndmInOidWYicsCiAgICAgICAgICAgICd4bWwnOidYbWwnCiAgICB9KTsKICAgIG1lLmNvbW1hbmRzWydpbnNlcnRjb2RlJ10gPSB7CiAgICAgICAgZXhlY0NvbW1hbmQgOiBmdW5jdGlvbihjbWQsbGFuZyl7CiAgICAgICAgICAgIHZhciBtZSA9IHRoaXMsCiAgICAgICAgICAgICAgICBybmcgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKSwKICAgICAgICAgICAgICAgIHByZSA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUocm5nLnN0YXJ0Q29udGFpbmVyLCdwcmUnLHRydWUpOwogICAgICAgICAgICBpZihwcmUpewogICAgICAgICAgICAgICAgcHJlLmNsYXNzTmFtZSA9ICdicnVzaDonK2xhbmcrJzt0b29sYmFyOmZhbHNlOyc7CiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgdmFyIGNvZGUgPSAnJzsKICAgICAgICAgICAgICAgIGlmKHJuZy5jb2xsYXBzZWQpewogICAgICAgICAgICAgICAgICAgIGNvZGUgPSBicm93c2VyLmllPyAoYnJvd3Nlci52ZXJzaW9uID4gOCA/ICcnIDogJyZuYnNwOycpOic8YnIvPic7CiAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICB2YXIgZnJhZyA9IHJuZy5leHRyYWN0Q29udGVudHMoKTsKICAgICAgICAgICAgICAgICAgICB2YXIgZGl2ID0gbWUuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgZGl2LmFwcGVuZENoaWxkKGZyYWcpOwoKICAgICAgICAgICAgICAgICAgICB1dGlscy5lYWNoKFVFLmZpbHRlck5vZGUoVUUuaHRtbHBhcnNlcihkaXYuaW5uZXJIVE1MLnJlcGxhY2UoL1tcclx0XS9nLCcnKSksbWUub3B0aW9ucy5maWx0ZXJUeHRSdWxlcykuY2hpbGRyZW4sZnVuY3Rpb24obm9kZSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGJyb3dzZXIuaWUgJiYgYnJvd3Nlci52ZXJzaW9uID4gOCl7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobm9kZS50eXBlID09J2VsZW1lbnQnKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihub2RlLnRhZ05hbWUgPT0gJ2JyJyl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGUgKz0gJ1xuJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlIGlmKCFkdGQuJGVtcHR5W25vZGUudGFnTmFtZV0pewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGlscy5lYWNoKG5vZGUuY2hpbGRyZW4sZnVuY3Rpb24oY24pewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY24udHlwZSA9PSdlbGVtZW50Jyl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY24udGFnTmFtZSA9PSAnYnInKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29kZSArPSAnXG4nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2UgaWYoIWR0ZC4kZW1wdHlbbm9kZS50YWdOYW1lXSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGUgKz0gY24uaW5uZXJUZXh0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29kZSArPSBjbi5kYXRhCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCEvXG4kLy50ZXN0KGNvZGUpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGUgKz0gJ1xuJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGUgKz0gbm9kZS5kYXRhICsgJ1xuJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIW5vZGUubmV4dFNpYmxpbmcoKSAmJiAvXG4kLy50ZXN0KGNvZGUpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2RlID0gY29kZS5yZXBsYWNlKC9cbiQvLCcnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihicm93c2VyLmllKXsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobm9kZS50eXBlID09J2VsZW1lbnQnKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobm9kZS50YWdOYW1lID09ICdicicpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29kZSArPSAnPGJyPicKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2UgaWYoIWR0ZC4kZW1wdHlbbm9kZS50YWdOYW1lXSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGlscy5lYWNoKG5vZGUuY2hpbGRyZW4sZnVuY3Rpb24oY24pewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGNuLnR5cGUgPT0nZWxlbWVudCcpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihjbi50YWdOYW1lID09ICdicicpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29kZSArPSAnPGJyPicKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2UgaWYoIWR0ZC4kZW1wdHlbbm9kZS50YWdOYW1lXSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2RlICs9IGNuLmlubmVyVGV4dCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGUgKz0gY24uZGF0YQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIS9icj4kLy50ZXN0KGNvZGUpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2RlICs9ICc8YnI+JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2RlICs9IG5vZGUuZGF0YSArICc8YnI+JwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighbm9kZS5uZXh0U2libGluZygpICYmIC88YnI+JC8udGVzdChjb2RlKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGUgPSBjb2RlLnJlcGxhY2UoLzxicj4kLywnJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGUgKz0gKG5vZGUudHlwZSA9PSAnZWxlbWVudCcgPyAoZHRkLiRlbXB0eVtub2RlLnRhZ05hbWVdID8gICcnIDogbm9kZS5pbm5lclRleHQoKSkgOiBub2RlLmRhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCEvYnJcLz9ccyo+JC8udGVzdChjb2RlKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFub2RlLm5leHRTaWJsaW5nKCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGUgKz0gJzxicj4nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIG1lLmV4ZWNDb21tYW5kKCdpbnNlcnRodG1sJywnPHByZSBpZD0iY29kZXIiY2xhc3M9ImJydXNoOicrbGFuZysnO3Rvb2xiYXI6ZmFsc2UiPicrY29kZSsnPC9wcmU+Jyx0cnVlKTsKCiAgICAgICAgICAgICAgICBwcmUgPSBtZS5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29kZXInKTsKICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZUF0dHJpYnV0ZXMocHJlLCdpZCcpOwogICAgICAgICAgICAgICAgdmFyIHRtcE5vZGUgPSBwcmUucHJldmlvdXNTaWJsaW5nOwoKICAgICAgICAgICAgICAgIGlmKHRtcE5vZGUgJiYgKHRtcE5vZGUubm9kZVR5cGUgPT0gMyAmJiB0bXBOb2RlLm5vZGVWYWx1ZS5sZW5ndGggPT0gMSAmJiBicm93c2VyLmllICYmIGJyb3dzZXIudmVyc2lvbiA9PSA2IHx8ICBkb21VdGlscy5pc0VtcHR5QmxvY2sodG1wTm9kZSkpKXsKCiAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHRtcE5vZGUpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgcm5nID0gbWUuc2VsZWN0aW9uLmdldFJhbmdlKCk7CiAgICAgICAgICAgICAgICBpZihkb21VdGlscy5pc0VtcHR5QmxvY2socHJlKSl7CiAgICAgICAgICAgICAgICAgICAgcm5nLnNldFN0YXJ0KHByZSwwKS5zZXRDdXJzb3IoZmFsc2UsdHJ1ZSkKICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgIHJuZy5zZWxlY3ROb2RlQ29udGVudHMocHJlKS5zZWxlY3QoKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgoKCiAgICAgICAgfSwKICAgICAgICBxdWVyeUNvbW1hbmRWYWx1ZSA6IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHZhciBwYXRoID0gdGhpcy5zZWxlY3Rpb24uZ2V0U3RhcnRFbGVtZW50UGF0aCgpOwogICAgICAgICAgICB2YXIgbGFuZyA9ICcnOwogICAgICAgICAgICB1dGlscy5lYWNoKHBhdGgsZnVuY3Rpb24obm9kZSl7CiAgICAgICAgICAgICAgICBpZihub2RlLm5vZGVOYW1lID09J1BSRScpewogICAgICAgICAgICAgICAgICAgIHZhciBtYXRjaCA9IG5vZGUuY2xhc3NOYW1lLm1hdGNoKC9icnVzaDooW147XSspLyk7CiAgICAgICAgICAgICAgICAgICAgbGFuZyA9IG1hdGNoICYmIG1hdGNoWzFdID8gbWF0Y2hbMV0gOiAnJzsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm4gbGFuZzsKICAgICAgICB9CiAgICB9OwoKICAgIG1lLmFkZElucHV0UnVsZShmdW5jdGlvbihyb290KXsKICAgICAgIHV0aWxzLmVhY2gocm9vdC5nZXROb2Rlc0J5VGFnTmFtZSgncHJlJyksZnVuY3Rpb24ocHJlKXsKICAgICAgICAgICB2YXIgYnJzID0gcHJlLmdldE5vZGVzQnlUYWdOYW1lKCdicicpOwogICAgICAgICAgIGlmKGJycy5sZW5ndGgpewogICAgICAgICAgICAgICBicm93c2VyLmllICYmIGJyb3dzZXIudmVyc2lvbiA+IDggJiYgdXRpbHMuZWFjaChicnMsZnVuY3Rpb24oYnIpewogICAgICAgICAgICAgICAgICAgdmFyIHR4dCA9IFVFLnVOb2RlLmNyZWF0ZVRleHQoJ1xuJyk7CiAgICAgICAgICAgICAgICAgICBici5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0eHQsYnIpOwogICAgICAgICAgICAgICAgICAgYnIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChicik7CiAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICBpZihicm93c2VyLmllICYmIGJyb3dzZXIudmVyc2lvbiA+IDgpCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIHZhciBjb2RlID0gcHJlLmlubmVyVGV4dCgpLnNwbGl0KC9cbi8pOwogICAgICAgICAgICBwcmUuaW5uZXJIVE1MKCcnKTsKICAgICAgICAgICAgdXRpbHMuZWFjaChjb2RlLGZ1bmN0aW9uKGMpewogICAgICAgICAgICAgICAgaWYoYy5sZW5ndGgpewogICAgICAgICAgICAgICAgICAgIHByZS5hcHBlbmRDaGlsZChVRS51Tm9kZS5jcmVhdGVUZXh0KGMpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHByZS5hcHBlbmRDaGlsZChVRS51Tm9kZS5jcmVhdGVFbGVtZW50KCdicicpKQogICAgICAgICAgICB9KQogICAgICAgfSkKICAgIH0pOwogICAgbWUuYWRkT3V0cHV0UnVsZShmdW5jdGlvbihyb290KXsKICAgICAgICB1dGlscy5lYWNoKHJvb3QuZ2V0Tm9kZXNCeVRhZ05hbWUoJ3ByZScpLGZ1bmN0aW9uKHByZSl7CiAgICAgICAgICAgIHZhciBjb2RlID0gJyc7CiAgICAgICAgICAgIHV0aWxzLmVhY2gocHJlLmNoaWxkcmVuLGZ1bmN0aW9uKG4pewogICAgICAgICAgICAgICBpZihuLnR5cGUgPT0gJ3RleHQnKXsKICAgICAgICAgICAgICAgICAgIC8v5ZyoaWXkuIvmlofmnKzlhoXlrrnmnInlj6/og73mnKvlsL7luKbmnIlcbuimgeWOu+aOiQogICAgICAgICAgICAgICAgICAgLy90cmFjZTozMzk2CiAgICAgICAgICAgICAgICAgICBjb2RlICs9IG4uZGF0YS5yZXBsYWNlKC9bIF0vZywnJm5ic3A7JykucmVwbGFjZSgvXG4kLywnJyk7CiAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgaWYobi50YWdOYW1lID09ICdicicpewogICAgICAgICAgICAgICAgICAgICAgIGNvZGUgICs9ICdcbicKICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgIGNvZGUgKz0gKCFkdGQuJGVtcHR5W24udGFnTmFtZV0gPyAnJyA6IG4uaW5uZXJUZXh0KCkpOwogICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBwcmUuaW5uZXJUZXh0KGNvZGUucmVwbGFjZSgvKCZuYnNwO3xcbikrJC8sJycpKQogICAgICAgIH0pCiAgICB9KTsKICAgIC8v5LiN6ZyA6KaB5Yik5pataGlnaGxpZ2h055qEY29tbWFuZOWIl+ihqAogICAgbWUubm90TmVlZENvZGVRdWVyeSA9ewogICAgICAgIGhlbHA6MSwKICAgICAgICB1bmRvOjEsCiAgICAgICAgcmVkbzoxLAogICAgICAgIHNvdXJjZToxLAogICAgICAgIHByaW50OjEsCiAgICAgICAgc2VhcmNocmVwbGFjZToxLAogICAgICAgIGZ1bGxzY3JlZW46MSwKICAgICAgICBwcmV2aWV3OjEsCiAgICAgICAgaW5zZXJ0cGFyYWdyYXBoOjEsCiAgICAgICAgZWxlbWVudHBhdGg6MSwKICAgICAgICBoaWdobGlnaHRjb2RlOjEsCiAgICAgICAgaW5zZXJ0Y29kZToxLAogICAgICAgIGluc2VydGh0bWw6MSwKICAgICAgICBzZWxlY3RhbGw6MQogICAgfTsKICAgIC8v5bCGcXVleUNvbW1hbW5kU3RhdGXph43nva4KICAgIHZhciBvcmdRdWVyeSA9IG1lLnF1ZXJ5Q29tbWFuZFN0YXRlOwogICAgbWUucXVlcnlDb21tYW5kU3RhdGUgPSBmdW5jdGlvbihjbWQpewogICAgICAgIHZhciBtZSA9IHRoaXM7CgogICAgICAgIGlmKCFtZS5ub3ROZWVkQ29kZVF1ZXJ5W2NtZC50b0xvd2VyQ2FzZSgpXSAmJiBtZS5zZWxlY3Rpb24gJiYgbWUucXVlcnlDb21tYW5kVmFsdWUoJ2luc2VydGNvZGUnKSl7CiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIFVFLkVkaXRvci5wcm90b3R5cGUucXVlcnlDb21tYW5kU3RhdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpCiAgICB9OwogICAgbWUuYWRkTGlzdGVuZXIoJ2JlZm9yZWVudGVya2V5ZG93bicsZnVuY3Rpb24oKXsKICAgICAgICB2YXIgcm5nID0gbWUuc2VsZWN0aW9uLmdldFJhbmdlKCk7CiAgICAgICAgdmFyIHByZSA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUocm5nLnN0YXJ0Q29udGFpbmVyLCdwcmUnLHRydWUpOwogICAgICAgIGlmKHByZSl7CiAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnc2F2ZVNjZW5lJyk7CiAgICAgICAgICAgIGlmKCFybmcuY29sbGFwc2VkKXsKICAgICAgICAgICAgICAgcm5nLmRlbGV0ZUNvbnRlbnRzKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoIWJyb3dzZXIuaWUgKXsKICAgICAgICAgICAgICAgIHZhciB0bXBOb2RlID0gbWUuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnInKSxwcmU7CiAgICAgICAgICAgICAgICBybmcuaW5zZXJ0Tm9kZSh0bXBOb2RlKS5zZXRTdGFydEFmdGVyKHRtcE5vZGUpLmNvbGxhcHNlKHRydWUpOwogICAgICAgICAgICAgICAgdmFyIG5leHQgPSB0bXBOb2RlLm5leHRTaWJsaW5nOwogICAgICAgICAgICAgICAgaWYoIW5leHQpewogICAgICAgICAgICAgICAgICAgIHJuZy5pbnNlcnROb2RlKHRtcE5vZGUuY2xvbmVOb2RlKGZhbHNlKSk7CiAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICBybmcuc2V0U3RhcnRBZnRlcih0bXBOb2RlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHByZSA9IHRtcE5vZGUucHJldmlvdXNTaWJsaW5nOwogICAgICAgICAgICAgICAgdmFyIHRtcDsKICAgICAgICAgICAgICAgIHdoaWxlKHByZSApewogICAgICAgICAgICAgICAgICAgIHRtcCA9IHByZTsKICAgICAgICAgICAgICAgICAgICBwcmUgPSBwcmUucHJldmlvdXNTaWJsaW5nOwogICAgICAgICAgICAgICAgICAgIGlmKCFwcmUgfHwgcHJlLm5vZGVOYW1lID09ICdCUicpewogICAgICAgICAgICAgICAgICAgICAgICBwcmUgPSB0bXA7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKHByZSl7CiAgICAgICAgICAgICAgICAgICAgdmFyIHN0ciA9ICcnOwogICAgICAgICAgICAgICAgICAgIHdoaWxlKHByZSAmJiBwcmUubm9kZU5hbWUgIT0gJ0JSJyAmJiAgbmV3IFJlZ0V4cCgnXltcXHMnK2RvbVV0aWxzLmZpbGxDaGFyKyddKiQnKS50ZXN0KHByZS5ub2RlVmFsdWUpKXsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9IHByZS5ub2RlVmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgIHByZSA9IHByZS5uZXh0U2libGluZzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYocHJlLm5vZGVOYW1lICE9ICdCUicpewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWF0Y2ggPSBwcmUubm9kZVZhbHVlLm1hdGNoKG5ldyBSZWdFeHAoJ14oW1xccycrZG9tVXRpbHMuZmlsbENoYXIrJ10rKScpKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYobWF0Y2ggJiYgbWF0Y2hbMV0pewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9IG1hdGNoWzFdCiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKHN0cil7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciA9IG1lLmRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHN0cik7CiAgICAgICAgICAgICAgICAgICAgICAgIHJuZy5pbnNlcnROb2RlKHN0cikuc2V0U3RhcnRBZnRlcihzdHIpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJuZy5jb2xsYXBzZSh0cnVlKS5zZWxlY3QodHJ1ZSk7CiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgaWYoYnJvd3Nlci52ZXJzaW9uID4gOCl7CgogICAgICAgICAgICAgICAgICAgIHZhciB0eHQgPSBtZS5kb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnXG4nKTsKICAgICAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSBybmcuc3RhcnRDb250YWluZXI7CiAgICAgICAgICAgICAgICAgICAgaWYocm5nLnN0YXJ0T2Zmc2V0ID09IDApewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJlTm9kZSA9IHN0YXJ0LnByZXZpb3VzU2libGluZzsKICAgICAgICAgICAgICAgICAgICAgICAgaWYocHJlTm9kZSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBybmcuaW5zZXJ0Tm9kZSh0eHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGxjaGFyID0gbWUuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJyAnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJuZy5zZXRTdGFydEFmdGVyKHR4dCkuaW5zZXJ0Tm9kZShmaWxsY2hhcikuc2V0U3RhcnQoZmlsbGNoYXIsMCkuY29sbGFwc2UodHJ1ZSkuc2VsZWN0KHRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgcm5nLmluc2VydE5vZGUodHh0KS5zZXRTdGFydEFmdGVyKHR4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaWxsY2hhciA9IG1lLmRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCcgJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gcm5nLnN0YXJ0Q29udGFpbmVyLmNoaWxkTm9kZXNbcm5nLnN0YXJ0T2Zmc2V0XTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoc3RhcnQgJiYgIS9eXG4vLnRlc3Qoc3RhcnQubm9kZVZhbHVlKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBybmcuc2V0U3RhcnRCZWZvcmUodHh0KQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHJuZy5pbnNlcnROb2RlKGZpbGxjaGFyKS5zZXRTdGFydChmaWxsY2hhciwwKS5jb2xsYXBzZSh0cnVlKS5zZWxlY3QodHJ1ZSkKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRtcE5vZGUgPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdicicpOwogICAgICAgICAgICAgICAgICAgIHJuZy5pbnNlcnROb2RlKHRtcE5vZGUpOwogICAgICAgICAgICAgICAgICAgIHJuZy5pbnNlcnROb2RlKG1lLmRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGRvbVV0aWxzLmZpbGxDaGFyKSk7CiAgICAgICAgICAgICAgICAgICAgcm5nLnNldFN0YXJ0QWZ0ZXIodG1wTm9kZSk7CiAgICAgICAgICAgICAgICAgICAgcHJlID0gdG1wTm9kZS5wcmV2aW91c1NpYmxpbmc7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRtcDsKICAgICAgICAgICAgICAgICAgICB3aGlsZShwcmUgKXsKICAgICAgICAgICAgICAgICAgICAgICAgdG1wID0gcHJlOwogICAgICAgICAgICAgICAgICAgICAgICBwcmUgPSBwcmUucHJldmlvdXNTaWJsaW5nOwogICAgICAgICAgICAgICAgICAgICAgICBpZighcHJlIHx8IHByZS5ub2RlTmFtZSA9PSAnQlInKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZSA9IHRtcDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKHByZSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdHIgPSAnJzsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUocHJlICYmIHByZS5ub2RlTmFtZSAhPSAnQlInICYmICBuZXcgUmVnRXhwKCdeWyAnK2RvbVV0aWxzLmZpbGxDaGFyKyddKiQnKS50ZXN0KHByZS5ub2RlVmFsdWUpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSBwcmUubm9kZVZhbHVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlID0gcHJlLm5leHRTaWJsaW5nOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHByZS5ub2RlTmFtZSAhPSAnQlInKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYXRjaCA9IHByZS5ub2RlVmFsdWUubWF0Y2gobmV3IFJlZ0V4cCgnXihbICcrZG9tVXRpbHMuZmlsbENoYXIrJ10rKScpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG1hdGNoICYmIG1hdGNoWzFdKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gbWF0Y2hbMV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciA9IG1lLmRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHN0cik7CiAgICAgICAgICAgICAgICAgICAgICAgIHJuZy5pbnNlcnROb2RlKHN0cikuc2V0U3RhcnRBZnRlcihzdHIpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBybmcuY29sbGFwc2UodHJ1ZSkuc2VsZWN0KCk7CiAgICAgICAgICAgICAgICB9CgoKICAgICAgICAgICAgfQogICAgICAgICAgICBtZS5maXJlRXZlbnQoJ3NhdmVTY2VuZScpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgoKICAgIH0pOwoKICAgIG1lLmFkZExpc3RlbmVyKCd0YWJrZXlkb3duJyxmdW5jdGlvbihjbWQsZXZ0KXsKICAgICAgICB2YXIgcm5nID0gbWUuc2VsZWN0aW9uLmdldFJhbmdlKCk7CiAgICAgICAgdmFyIHByZSA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUocm5nLnN0YXJ0Q29udGFpbmVyLCdwcmUnLHRydWUpOwogICAgICAgIGlmKHByZSl7CiAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnc2F2ZVNjZW5lJyk7CiAgICAgICAgICAgIGlmKGV2dC5zaGlmdEtleSl7CgovLyAgICAgICAgICAgICAgICBpZighcm5nLmNvbGxhcHNlZCl7Ci8vICAgICAgICAgICAgICAgICAgICB2YXIgYmsgPSBybmcuY3JlYXRlQm9va21hcmsoKTsKLy8gICAgICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IGJrLnN0YXJ0LnByZXZpb3VzU2libGluZzsKLy8gICAgICAgICAgICAgICAgICAgIGlmKHN0YXJ0ID09PSBwcmUuZmlyc3RDaGlsZCl7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQubm9kZVZhbHVlID0gc3RhcnQubm9kZVZhbHVlLnJlcGxhY2UoL15cc3s0fS8sJycpOwovLyAgICAgICAgICAgICAgICAgICAgfWVsc2V7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUoc3RhcnQpewovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihkb21VdGlscy5pc0JyKHN0YXJ0KSl7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydCA9IHN0YXJ0Lm5leHRTaWJsaW5nOwovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQubm9kZVZhbHVlID0gc3RhcnQubm9kZVZhbHVlLnJlcGxhY2UoL15cc3s0fS8sJycpOwovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUoc3RhcnQucHJldmlvdXNTaWJsaW5nICYmIHN0YXJ0LnByZXZpb3VzU2libGluZy5ub2RlVHlwZSA9PSAzKXsKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0Lm5vZGVWYWx1ZSA9IHN0YXJ0LnByZXZpb3VzU2libGluZy5ub2RlVmFsdWUgKyBzdGFydC5ub2RlVmFsdWU7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUoc3RhcnQucHJldmlvdXNTaWJsaW5nKQovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gc3RhcnQucHJldmlvdXNTaWJsaW5nOwovLyAgICAgICAgICAgICAgICAgICAgICAgIH0KLy8gICAgICAgICAgICAgICAgICAgIH0KLy8KLy8gICAgICAgICAgICAgICAgICAgIHZhciBlbmQgPSBiay5lbmQ7Ci8vICAgICAgICAgICAgICAgICAgICBzdGFydCA9IGJrLnN0YXJ0Lm5leHRTaWJsaW5nOwovLwovLyAgICAgICAgICAgICAgICAgICAgd2hpbGUoc3RhcnQgJiYgc3RhcnQgIT09IGVuZCl7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgaWYoZG9tVXRpbHMuaXNCcihzdGFydCkgJiYgc3RhcnQubmV4dFNpYmxpbmcpewovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzdGFydC5uZXh0U2libGluZyA9PT0gZW5kKXsKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gc3RhcnQubmV4dFNpYmxpbmc7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlKHN0YXJ0Lm5leHRTaWJsaW5nICYmIHN0YXJ0Lm5leHRTaWJsaW5nLm5vZGVUeXBlID09IDMpewovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQubm9kZVZhbHVlICs9IHN0YXJ0Lm5leHRTaWJsaW5nLm5vZGVWYWx1ZTsKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShzdGFydC5uZXh0U2libGluZykKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgfQovLwovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydC5ub2RlVmFsdWUgPSBzdGFydC5ub2RlVmFsdWUucmVwbGFjZSgvXlxzezR9LywnJyk7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgfQovLwovLyAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gc3RhcnQubmV4dFNpYmxpbmc7Ci8vICAgICAgICAgICAgICAgICAgICB9Ci8vICAgICAgICAgICAgICAgICAgICBybmcubW92ZVRvQm9va21hcmsoYmspLnNlbGVjdCgpOwovLyAgICAgICAgICAgICAgICB9ZWxzZXsKLy8gICAgICAgICAgICAgICAgICAgIHZhciBiayA9IHJuZy5jcmVhdGVCb29rbWFyaygpOwovLyAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXJ0ID0gYmsuc3RhcnQucHJldmlvdXNTaWJsaW5nOwovLyAgICAgICAgICAgICAgICAgICAgaWYoc3RhcnQgPT09IHByZS5maXJzdENoaWxkKXsKLy8gICAgICAgICAgICAgICAgICAgICAgICBzdGFydC5ub2RlVmFsdWUgPSBzdGFydC5ub2RlVmFsdWUucmVwbGFjZSgvXlxzezR9LywnJyk7Ci8vICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKLy8gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZShzdGFydCl7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRvbVV0aWxzLmlzQnIoc3RhcnQpKXsKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gc3RhcnQubmV4dFNpYmxpbmc7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydC5ub2RlVmFsdWUgPSBzdGFydC5ub2RlVmFsdWUucmVwbGFjZSgvXlxzezR9LywnJyk7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgfQovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZShzdGFydC5wcmV2aW91c1NpYmxpbmcgJiYgc3RhcnQucHJldmlvdXNTaWJsaW5nLm5vZGVUeXBlID09IDMpewovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQubm9kZVZhbHVlID0gc3RhcnQucHJldmlvdXNTaWJsaW5nLm5vZGVWYWx1ZSArIHN0YXJ0Lm5vZGVWYWx1ZTsKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShzdGFydC5wcmV2aW91c1NpYmxpbmcpCi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBzdGFydC5wcmV2aW91c1NpYmxpbmc7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgfQovLyAgICAgICAgICAgICAgICAgICAgfQovLyAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgaWYoIXJuZy5jb2xsYXBzZWQpewogICAgICAgICAgICAgICAgICAgIHZhciBiayA9IHJuZy5jcmVhdGVCb29rbWFyaygpOwogICAgICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IGJrLnN0YXJ0LnByZXZpb3VzU2libGluZzsKCiAgICAgICAgICAgICAgICAgICAgd2hpbGUoc3RhcnQpewogICAgICAgICAgICAgICAgICAgICAgICBpZihwcmUuZmlyc3RDaGlsZCA9PT0gc3RhcnQgJiYgIWRvbVV0aWxzLmlzQnIoc3RhcnQpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZS5pbnNlcnRCZWZvcmUobWUuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJyAgICAnKSxzdGFydCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoZG9tVXRpbHMuaXNCcihzdGFydCkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlLmluc2VydEJlZm9yZShtZS5kb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnICAgICcpLHN0YXJ0Lm5leHRTaWJsaW5nKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBzdGFydCA9IHN0YXJ0LnByZXZpb3VzU2libGluZzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdmFyIGVuZCA9IGJrLmVuZDsKICAgICAgICAgICAgICAgICAgICBzdGFydCA9IGJrLnN0YXJ0Lm5leHRTaWJsaW5nOwogICAgICAgICAgICAgICAgICAgIGlmKHByZS5maXJzdENoaWxkID09PSBiay5zdGFydCl7CiAgICAgICAgICAgICAgICAgICAgICAgIHByZS5pbnNlcnRCZWZvcmUobWUuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJyAgICAnKSxzdGFydC5uZXh0U2libGluZykKCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHdoaWxlKHN0YXJ0ICYmIHN0YXJ0ICE9PSBlbmQpewogICAgICAgICAgICAgICAgICAgICAgICBpZihkb21VdGlscy5pc0JyKHN0YXJ0KSAmJiBzdGFydC5uZXh0U2libGluZyl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzdGFydC5uZXh0U2libGluZyA9PT0gZW5kKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZS5pbnNlcnRCZWZvcmUobWUuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJyAgICAnKSxzdGFydC5uZXh0U2libGluZykKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBzdGFydC5uZXh0U2libGluZzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcm5nLm1vdmVUb0Jvb2ttYXJrKGJrKS5zZWxlY3QoKTsKICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgIHZhciB0bXBOb2RlID0gbWUuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJyAgICAnKTsKICAgICAgICAgICAgICAgICAgICBybmcuaW5zZXJ0Tm9kZSh0bXBOb2RlKS5zZXRTdGFydEFmdGVyKHRtcE5vZGUpLmNvbGxhcHNlKHRydWUpLnNlbGVjdCh0cnVlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKCiAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnc2F2ZVNjZW5lJyk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCgogICAgfSk7CgoKICAgIG1lLmFkZExpc3RlbmVyKCdiZWZvcmVpbnNlcnRodG1sJyxmdW5jdGlvbihldnROYW1lLGh0bWwpewogICAgICAgIHZhciBtZSA9IHRoaXMsCiAgICAgICAgICAgIHJuZyA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpLAogICAgICAgICAgICBwcmUgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKHJuZy5zdGFydENvbnRhaW5lciwncHJlJyx0cnVlKTsKICAgICAgICBpZihwcmUpewogICAgICAgICAgICBpZighcm5nLmNvbGxhcHNlZCl7CiAgICAgICAgICAgICAgICBybmcuZGVsZXRlQ29udGVudHMoKQogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciBodG1sc3RyID0gJyc7CiAgICAgICAgICAgIGlmKGJyb3dzZXIuaWUgJiYgYnJvd3Nlci52ZXJzaW9uID4gOCl7CgogICAgICAgICAgICAgICAgdXRpbHMuZWFjaChVRS5maWx0ZXJOb2RlKFVFLmh0bWxwYXJzZXIoaHRtbCksbWUub3B0aW9ucy5maWx0ZXJUeHRSdWxlcykuY2hpbGRyZW4sZnVuY3Rpb24obm9kZSl7CiAgICAgICAgICAgICAgICAgICAgaWYobm9kZS50eXBlID09J2VsZW1lbnQnKXsKICAgICAgICAgICAgICAgICAgICAgICAgaWYobm9kZS50YWdOYW1lID09ICdicicpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAnXG4nCiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlIGlmKCFkdGQuJGVtcHR5W25vZGUudGFnTmFtZV0pewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXRpbHMuZWFjaChub2RlLmNoaWxkcmVuLGZ1bmN0aW9uKGNuKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihjbi50eXBlID09J2VsZW1lbnQnKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY24udGFnTmFtZSA9PSAnYnInKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gJ1xuJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZSBpZighZHRkLiRlbXB0eVtub2RlLnRhZ05hbWVdKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gY24uaW5uZXJUZXh0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSBjbi5kYXRhCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCEvXG4kLy50ZXN0KGh0bWxzdHIpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICdcbic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSBub2RlLmRhdGEgKyAnXG4nCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKCFub2RlLm5leHRTaWJsaW5nKCkgJiYgL1xuJC8udGVzdChodG1sc3RyKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgPSBodG1sc3RyLnJlcGxhY2UoL1xuJC8sJycpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgdmFyIHRtcE5vZGUgPSBtZS5kb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh1dGlscy5odG1sKGh0bWxzdHIucmVwbGFjZSgvJm5ic3A7L2csJyAnKSkpOwogICAgICAgICAgICAgICAgcm5nLmluc2VydE5vZGUodG1wTm9kZSkuc2VsZWN0Tm9kZSh0bXBOb2RlKS5zZWxlY3QoKTsKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICB2YXIgZnJhZyA9IG1lLmRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTsKCiAgICAgICAgICAgICAgICB1dGlscy5lYWNoKFVFLmZpbHRlck5vZGUoVUUuaHRtbHBhcnNlcihodG1sKSxtZS5vcHRpb25zLmZpbHRlclR4dFJ1bGVzKS5jaGlsZHJlbixmdW5jdGlvbihub2RlKXsKICAgICAgICAgICAgICAgICAgICBpZihub2RlLnR5cGUgPT0nZWxlbWVudCcpewogICAgICAgICAgICAgICAgICAgICAgICBpZihub2RlLnRhZ05hbWUgPT0gJ2JyJyl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcmFnLmFwcGVuZENoaWxkKG1lLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2JyJykpCiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlIGlmKCFkdGQuJGVtcHR5W25vZGUudGFnTmFtZV0pewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXRpbHMuZWFjaChub2RlLmNoaWxkcmVuLGZ1bmN0aW9uKGNuKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihjbi50eXBlID09J2VsZW1lbnQnKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY24udGFnTmFtZSA9PSAnYnInKXsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcmFnLmFwcGVuZENoaWxkKG1lLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2JyJykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlIGlmKCFkdGQuJGVtcHR5W25vZGUudGFnTmFtZV0pewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJhZy5hcHBlbmRDaGlsZChtZS5kb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh1dGlscy5odG1sKGNuLmlubmVyVGV4dCgpLnJlcGxhY2UoLyZuYnNwOy9nLCcgJykpKSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyYWcuYXBwZW5kQ2hpbGQobWUuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodXRpbHMuaHRtbCggY24uZGF0YS5yZXBsYWNlKC8mbmJzcDsvZywnICcpKSkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZnJhZy5sYXN0Q2hpbGQubm9kZU5hbWUgIT0gJ0JSJyl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJhZy5hcHBlbmRDaGlsZChtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdicicpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIGZyYWcuYXBwZW5kQ2hpbGQobWUuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodXRpbHMuaHRtbCggbm9kZS5kYXRhLnJlcGxhY2UoLyZuYnNwOy9nLCcgJykpKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKCFub2RlLm5leHRTaWJsaW5nKCkgJiYgZnJhZy5sYXN0Q2hpbGQubm9kZU5hbWUgPT0gJ0JSJyl7CiAgICAgICAgICAgICAgICAgICAgICAgZnJhZy5yZW1vdmVDaGlsZChmcmFnLmxhc3RDaGlsZCkKICAgICAgICAgICAgICAgICAgICB9CgoKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcm5nLmluc2VydE5vZGUoZnJhZykuc2VsZWN0KCk7CgogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9KTsKICAgIC8v5pa55ZCR6ZSu55qE5aSE55CGCiAgICBtZS5hZGRMaXN0ZW5lcigna2V5ZG93bicsZnVuY3Rpb24oY21kLGV2dCl7CiAgICAgICAgdmFyIG1lID0gdGhpcyxrZXlDb2RlID0gZXZ0LmtleUNvZGUgfHwgZXZ0LndoaWNoOwogICAgICAgIGlmKGtleUNvZGUgPT0gNDApewogICAgICAgICAgICB2YXIgcm5nID0gbWUuc2VsZWN0aW9uLmdldFJhbmdlKCkscHJlLHN0YXJ0ID0gcm5nLnN0YXJ0Q29udGFpbmVyOwogICAgICAgICAgICBpZihybmcuY29sbGFwc2VkICYmIChwcmUgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKHJuZy5zdGFydENvbnRhaW5lciwncHJlJyx0cnVlKSkgJiYgIXByZS5uZXh0U2libGluZyl7CiAgICAgICAgICAgICAgICB2YXIgbGFzdCA9IHByZS5sYXN0Q2hpbGQKICAgICAgICAgICAgICAgIHdoaWxlKGxhc3QgJiYgbGFzdC5ub2RlTmFtZSA9PSAnQlInKXsKICAgICAgICAgICAgICAgICAgICBsYXN0ID0gbGFzdC5wcmV2aW91c1NpYmxpbmc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZihsYXN0ID09PSBzdGFydCB8fCBybmcuc3RhcnRDb250YWluZXIgPT09IHByZSAmJiBybmcuc3RhcnRPZmZzZXQgPT0gcHJlLmNoaWxkTm9kZXMubGVuZ3RoKXsKICAgICAgICAgICAgICAgICAgICBtZS5leGVjQ29tbWFuZCgnaW5zZXJ0cGFyYWdyYXBoJyk7CiAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucHJldmVudERlZmF1bHQoZXZ0KQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0pOwogICAgLy90cmFjZTozMzk1CiAgICBtZS5hZGRMaXN0ZW5lcignZGVsa2V5ZG93bicsZnVuY3Rpb24odHlwZSxldnQpewogICAgICAgIHZhciBybmcgPSB0aGlzLnNlbGVjdGlvbi5nZXRSYW5nZSgpOwogICAgICAgIHJuZy50eHRUb0VsbUJvdW5kYXJ5KHRydWUpOwogICAgICAgIHZhciBzdGFydCA9IHJuZy5zdGFydENvbnRhaW5lcjsKICAgICAgICBpZihkb21VdGlscy5pc1RhZ05vZGUoc3RhcnQsJ3ByZScpICYmIHJuZy5jb2xsYXBzZWQgJiYgZG9tVXRpbHMuaXNTdGFydEluYmxvY2socm5nKSl7CiAgICAgICAgICAgIHZhciBwID0gbWUuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpOwogICAgICAgICAgICBkb21VdGlscy5maWxsTm9kZShtZS5kb2N1bWVudCxwKTsKICAgICAgICAgICAgc3RhcnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUocCxzdGFydCk7CiAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShzdGFydCk7CiAgICAgICAgICAgIHJuZy5zZXRTdGFydChwLDApLnNldEN1cnNvcihmYWxzZSx0cnVlKTsKICAgICAgICAgICAgZG9tVXRpbHMucHJldmVudERlZmF1bHQoZXZ0KTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgfSkKfTsKCi8vL2ltcG9ydCBjb3JlDQovLy9jb21tYW5kcyDmuIXnqbrmlofmoaMNCi8vL2NvbW1hbmRzTmFtZSAgQ2xlYXJEb2MNCi8vL2NvbW1hbmRzVGl0bGUgIOa4heepuuaWh+ahow0KLyoqDQogKg0KICog5riF56m65paH5qGjDQogKiBAZnVuY3Rpb24NCiAqIEBuYW1lIGJhaWR1LmVkaXRvci5leGVjQ29tbWFuZA0KICogQHBhcmFtICAge1N0cmluZ30gICBjbWROYW1lICAgICBjbGVhcmRvY+a4heepuuaWh+ahow0KICovDQoNClVFLmNvbW1hbmRzWydjbGVhcmRvYyddID0gew0KICAgIGV4ZWNDb21tYW5kIDogZnVuY3Rpb24oIGNtZE5hbWUpIHsNCiAgICAgICAgdmFyIG1lID0gdGhpcywNCiAgICAgICAgICAgIGVudGVyVGFnID0gbWUub3B0aW9ucy5lbnRlclRhZywNCiAgICAgICAgICAgIHJhbmdlID0gbWUuc2VsZWN0aW9uLmdldFJhbmdlKCk7DQogICAgICAgIGlmKGVudGVyVGFnID09ICJiciIpew0KICAgICAgICAgICAgbWUuYm9keS5pbm5lckhUTUwgPSAiPGJyLz4iOw0KICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQobWUuYm9keSwwKS5zZXRDdXJzb3IoKTsNCiAgICAgICAgfWVsc2V7DQogICAgICAgICAgICBtZS5ib2R5LmlubmVySFRNTCA9ICI8cD4iKyhpZSA/ICIiIDogIjxici8+IikrIjwvcD4iOw0KICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQobWUuYm9keS5maXJzdENoaWxkLDApLnNldEN1cnNvcihmYWxzZSx0cnVlKTsNCiAgICAgICAgfQ0KICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7DQogICAgICAgICAgICBtZS5maXJlRXZlbnQoImNsZWFyRG9jIik7DQogICAgICAgIH0sMCk7DQoNCiAgICB9DQp9Ow0KDQoKLy8vaW1wb3J0IGNvcmUNCi8vL2NvbW1hbmRzIOmUmueCuQ0KLy8vY29tbWFuZHNOYW1lICBBbmNob3INCi8vL2NvbW1hbmRzVGl0bGUgIOmUmueCuQ0KLy8vY29tbWFuZHNEaWFsb2cgIGRpYWxvZ3NcYW5jaG9yDQovKioNCiAqIOmUmueCuQ0KICogQGZ1bmN0aW9uDQogKiBAbmFtZSBiYWlkdS5lZGl0b3IuZXhlY0NvbW1hbmRzDQogKiBAcGFyYW0ge1N0cmluZ30gY21kTmFtZSAgICAgY21kTmFtZT0iYW5jaG9yIuaPkuWFpemUmueCuQ0KICovDQpVRS5wbHVnaW5zWydhbmNob3InXSA9IGZ1bmN0aW9uICgpew0KICAgIHZhciBtZSA9IHRoaXM7DQoNCiAgICBtZS5yZWFkeShmdW5jdGlvbigpew0KICAgICAgICB1dGlscy5jc3NSdWxlKCdhbmNob3InLA0KICAgICAgICAgICAgJy5hbmNob3JjbGFzc3tiYWNrZ3JvdW5kOiB1cmwoXCcnDQogICAgICAgICAgICAgICAgKyBtZS5vcHRpb25zLlVFRElUT1JfSE9NRV9VUkwgKw0KICAgICAgICAgICAgICAgICd0aGVtZXMvZGVmYXVsdC9pbWFnZXMvYW5jaG9yLmdpZlwnKSBuby1yZXBlYXQgc2Nyb2xsIGxlZnQgY2VudGVyIHRyYW5zcGFyZW50O2JvcmRlcjogMXB4IGRvdHRlZCAjMDAwMEZGO2N1cnNvcjogYXV0bztkaXNwbGF5OiBpbmxpbmUtYmxvY2s7aGVpZ2h0OiAxNnB4O3dpZHRoOiAxNXB4O30nLA0KICAgICAgICAgICAgbWUuZG9jdW1lbnQpDQogICAgfSk7DQogICAgbWUuYWRkT3V0cHV0UnVsZShmdW5jdGlvbihyb290KXsNCiAgICAgICAgdXRpbHMuZWFjaChyb290LmdldE5vZGVzQnlUYWdOYW1lKCdpbWcnKSxmdW5jdGlvbihhKXsNCiAgICAgICAgICAgIHZhciB2YWw7DQogICAgICAgICAgICBpZih2YWwgPSBhLmdldEF0dHIoJ2FuY2hvcm5hbWUnKSl7DQogICAgICAgICAgICAgICAgYS50YWdOYW1lID0gJ2EnOw0KICAgICAgICAgICAgICAgIGEuc2V0QXR0cih7DQogICAgICAgICAgICAgICAgICAgIGFuY2hvcm5hbWUgOiAnJywNCiAgICAgICAgICAgICAgICAgICAgbmFtZSA6IHZhbCwNCiAgICAgICAgICAgICAgICAgICAgJ2NsYXNzJyA6ICcnDQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICB9KTsNCiAgICBtZS5hZGRJbnB1dFJ1bGUoZnVuY3Rpb24ocm9vdCl7DQogICAgICAgIHV0aWxzLmVhY2gocm9vdC5nZXROb2Rlc0J5VGFnTmFtZSgnYScpLGZ1bmN0aW9uKGEpew0KICAgICAgICAgICAgdmFyIHZhbDsNCiAgICAgICAgICAgIGlmKCh2YWwgPSBhLmdldEF0dHIoJ25hbWUnKSkgJiYgIWEuZ2V0QXR0cignaHJlZicpKXsNCiAgICAgICAgICAgICAgICBhLnRhZ05hbWUgPSAnaW1nJzsNCiAgICAgICAgICAgICAgICBhLnNldEF0dHIoew0KICAgICAgICAgICAgICAgICAgICBhbmNob3JuYW1lIDphLmdldEF0dHIoJ25hbWUnKSwNCiAgICAgICAgICAgICAgICAgICAgJ2NsYXNzJyA6ICdhbmNob3JjbGFzcycNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBhLnNldEF0dHIoJ25hbWUnKQ0KDQogICAgICAgICAgICB9DQogICAgICAgIH0pDQogICAgfSk7DQogICAgbWUuY29tbWFuZHNbJ2FuY2hvciddID0gew0KICAgICAgICBleGVjQ29tbWFuZDpmdW5jdGlvbiAoY21kLCBuYW1lKSB7DQogICAgICAgICAgICB2YXIgcmFuZ2UgPSB0aGlzLnNlbGVjdGlvbi5nZXRSYW5nZSgpLGltZyA9IHJhbmdlLmdldENsb3NlZE5vZGUoKTsNCiAgICAgICAgICAgIGlmIChpbWcgJiYgaW1nLmdldEF0dHJpYnV0ZSgnYW5jaG9ybmFtZScpKSB7DQogICAgICAgICAgICAgICAgaWYgKG5hbWUpIHsNCiAgICAgICAgICAgICAgICAgICAgaW1nLnNldEF0dHJpYnV0ZSgnYW5jaG9ybmFtZScsIG5hbWUpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0QmVmb3JlKGltZykuc2V0Q3Vyc29yKCk7DQogICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShpbWcpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgaWYgKG5hbWUpIHsNCiAgICAgICAgICAgICAgICAgICAgLy/lj6rlnKjpgInljLrnmoTlvIDlp4vmj5LlhaUNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFuY2hvciA9IHRoaXMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7DQogICAgICAgICAgICAgICAgICAgIHJhbmdlLmNvbGxhcHNlKHRydWUpOw0KICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5zZXRBdHRyaWJ1dGVzKGFuY2hvcix7DQogICAgICAgICAgICAgICAgICAgICAgICAnYW5jaG9ybmFtZSc6bmFtZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICdjbGFzcyc6J2FuY2hvcmNsYXNzJw0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgcmFuZ2UuaW5zZXJ0Tm9kZShhbmNob3IpLnNldFN0YXJ0QWZ0ZXIoYW5jaG9yKS5zZXRDdXJzb3IoZmFsc2UsdHJ1ZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICB9Ow0KDQoNCn07DQoKLy8vaW1wb3J0IGNvcmUNCi8vL2NvbW1hbmRzIOWtl+aVsOe7n+iuoQ0KLy8vY29tbWFuZHNOYW1lICBXb3JkQ291bnQsd29yZENvdW50DQovLy9jb21tYW5kc1RpdGxlICDlrZfmlbDnu5/orqENCi8qKg0KICogQ3JlYXRlZCBieSBKZXRCcmFpbnMgV2ViU3Rvcm0uDQogKiBVc2VyOiB0YW9xaWxpDQogKiBEYXRlOiAxMS05LTcNCiAqIFRpbWU6IOS4i+WNiDg6MTgNCiAqIFRvIGNoYW5nZSB0aGlzIHRlbXBsYXRlIHVzZSBGaWxlIHwgU2V0dGluZ3MgfCBGaWxlIFRlbXBsYXRlcy4NCiAqLw0KDQpVRS5wbHVnaW5zWyd3b3JkY291bnQnXSA9IGZ1bmN0aW9uKCl7DQogICAgdmFyIG1lID0gdGhpczsNCiAgICBtZS5hZGRMaXN0ZW5lcignY29udGVudGNoYW5nZScsZnVuY3Rpb24oKXsNCiAgICAgICAgbWUuZmlyZUV2ZW50KCd3b3JkY291bnQnKTsNCiAgICB9KTsNCiAgICB2YXIgdGltZXI7DQogICAgbWUuYWRkTGlzdGVuZXIoJ3JlYWR5JyxmdW5jdGlvbigpew0KICAgICAgICB2YXIgbWUgPSB0aGlzOw0KICAgICAgICBkb21VdGlscy5vbihtZS5ib2R5LCJrZXl1cCIsZnVuY3Rpb24oZXZ0KXsNCiAgICAgICAgICAgIHZhciBjb2RlID0gZXZ0LmtleUNvZGV8fGV2dC53aGljaCwNCiAgICAgICAgICAgICAgICAvL+W/veeVpeeahOaMiemUrixjdHIsYWx0LHNoaWZ0LOaWueWQkemUrg0KICAgICAgICAgICAgICAgIGlnbm9yZXMgPSB7IjE2IjoxLCIxOCI6MSwiMjAiOjEsIjM3IjoxLCIzOCI6MSwiMzkiOjEsIjQwIjoxfTsNCiAgICAgICAgICAgIGlmKGNvZGUgaW4gaWdub3JlcykgcmV0dXJuOw0KICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTsNCiAgICAgICAgICAgIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpew0KICAgICAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnd29yZGNvdW50Jyk7DQogICAgICAgICAgICB9LDIwMCkNCiAgICAgICAgfSkNCiAgICB9KTsNCn07DQoKLy8vaW1wb3J0IGNvcmUNCi8vL2NvbW1hbmRzIOacrOWcsOWbvueJh+W8leWvvOS4iuS8oA0KLy8vY29tbWFuZHNOYW1lICBXb3JkSW1hZ2UNCi8vL2NvbW1hbmRzVGl0bGUgIOacrOWcsOWbvueJh+W8leWvvOS4iuS8oA0KLy8vY29tbWFuZHNEaWFsb2cgIGRpYWxvZ3Ncd29yZGltYWdlDQoNCg0KVUUucGx1Z2luc1sid29yZGltYWdlIl0gPSBmdW5jdGlvbiAoKSB7DQogICAgdmFyIG1lID0gdGhpcywNCiAgICAgICAgaW1hZ2VzOw0KICAgIG1lLmFkZElucHV0UnVsZShmdW5jdGlvbiAocm9vdCkgew0KICAgICAgICB1dGlscy5lYWNoKHJvb3QuZ2V0Tm9kZXNCeVRhZ05hbWUoJ2ltZycpLCBmdW5jdGlvbiAoaW1nKSB7DQogICAgICAgICAgICB2YXIgYXR0cnMgPSBpbWcuYXR0cnMsDQogICAgICAgICAgICAgICAgZmxhZyA9IHBhcnNlSW50KGF0dHJzLndpZHRoKSA8IDEyOCB8fCBwYXJzZUludChhdHRycy5oZWlnaHQpIDwgNDMsDQogICAgICAgICAgICAgICAgb3B0ID0gbWUub3B0aW9ucywNCiAgICAgICAgICAgICAgICBzcmMgPSBvcHQuVUVESVRPUl9IT01FX1VSTCArICd0aGVtZXMvZGVmYXVsdC9pbWFnZXMvc3BhY2VyLmdpZic7DQogICAgICAgICAgICBpZiAoYXR0cnNbJ19zcmMnXSAmJiBhdHRyc1snX3NyYyddLmluZGV4T2YoImZpbGU6Ly8vIikhPT0tMSkgew0KICAgICAgICAgICAgICAgIGltZy5zZXRBdHRyKHsNCiAgICAgICAgICAgICAgICAgICAgd2lkdGg6YXR0cnMud2lkdGgsDQogICAgICAgICAgICAgICAgICAgIGhlaWdodDphdHRycy5oZWlnaHQsDQogICAgICAgICAgICAgICAgICAgIGFsdDphdHRycy5hbHQsDQogICAgICAgICAgICAgICAgICAgIHdvcmRfaW1nOmF0dHJzLl9zcmMsDQogICAgICAgICAgICAgICAgICAgIHNyYzpzcmMsDQogICAgICAgICAgICAgICAgICAgIF9zcmM6c3JjLA0KICAgICAgICAgICAgICAgICAgICAnc3R5bGUnOidiYWNrZ3JvdW5kOnVybCgnICsgKCBmbGFnID8gb3B0LnRoZW1lUGF0aCArIG9wdC50aGVtZSArICcvaW1hZ2VzL3dvcmQuZ2lmJyA6IG9wdC5sYW5nUGF0aCArIG9wdC5sYW5nICsgJy9pbWFnZXMvbG9jYWxpbWFnZS5wbmcnKSArICcpIG5vLXJlcGVhdCBjZW50ZXIgY2VudGVyO2JvcmRlcjoxcHggc29saWQgI2RkZCcNCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9KQ0KICAgIH0pOw0KICAgIG1lLmNvbW1hbmRzWyd3b3JkaW1hZ2UnXSA9IHsNCiAgICAgICAgZXhlY0NvbW1hbmQ6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgaW1hZ2VzID0gZG9tVXRpbHMuZ2V0RWxlbWVudHNCeVRhZ05hbWUobWUuZG9jdW1lbnQuYm9keSwgImltZyIpOw0KICAgICAgICAgICAgdmFyIHVybExpc3QgPSBbXTsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjaTsgY2kgPSBpbWFnZXNbaSsrXTspIHsNCiAgICAgICAgICAgICAgICB2YXIgdXJsID0gY2kuZ2V0QXR0cmlidXRlKCJ3b3JkX2ltZyIpOw0KICAgICAgICAgICAgICAgIHVybCAmJiB1cmxMaXN0LnB1c2godXJsKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChpbWFnZXMubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgdGhpc1sid29yZF9pbWciXSA9IHVybExpc3Q7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIHF1ZXJ5Q29tbWFuZFN0YXRlOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIGltYWdlcyA9IGRvbVV0aWxzLmdldEVsZW1lbnRzQnlUYWdOYW1lKG1lLmRvY3VtZW50LmJvZHksICJpbWciKTsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjaTsgY2kgPSBpbWFnZXNbaSsrXTspIHsNCiAgICAgICAgICAgICAgICBpZiAoY2kuZ2V0QXR0cmlidXRlKCJ3b3JkX2ltZyIpKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAxOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgfQ0KICAgIH07DQoNCn07ClVFLnBsdWdpbnNbJ2RyYWdkcm9wJ10gPSBmdW5jdGlvbiAoKXsNCg0KICAgIHZhciBtZSA9IHRoaXM7DQogICAgbWUucmVhZHkoZnVuY3Rpb24oKXsNCiAgICAgICAgZG9tVXRpbHMub24odGhpcy5ib2R5LCdkcmFnZW5kJyxmdW5jdGlvbigpew0KICAgICAgICAgICAgdmFyIHJuZyA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpOw0KICAgICAgICAgICAgdmFyIG5vZGUgPSBybmcuZ2V0Q2xvc2VkTm9kZSgpfHxtZS5zZWxlY3Rpb24uZ2V0U3RhcnQoKTsNCg0KICAgICAgICAgICAgaWYobm9kZSAmJiBub2RlLnRhZ05hbWUgPT0gJ0lNRycpew0KDQogICAgICAgICAgICAgICAgdmFyIHByZSA9IG5vZGUucHJldmlvdXNTaWJsaW5nLG5leHQ7DQogICAgICAgICAgICAgICAgd2hpbGUobmV4dCA9IG5vZGUubmV4dFNpYmxpbmcpew0KICAgICAgICAgICAgICAgICAgICBpZihuZXh0Lm5vZGVUeXBlID09IDEgJiYgbmV4dC50YWdOYW1lID09ICdTUEFOJyAmJiAhbmV4dC5maXJzdENoaWxkKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShuZXh0KQ0KICAgICAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgICAgICBpZigocHJlICYmIHByZS5ub2RlVHlwZSA9PSAxICYmICFkb21VdGlscy5pc0VtcHR5QmxvY2socHJlKSB8fCAhcHJlKSAmJiAoIW5leHQgfHwgbmV4dCAmJiAhZG9tVXRpbHMuaXNFbXB0eUJsb2NrKG5leHQpKSl7DQogICAgICAgICAgICAgICAgICAgIGlmKHByZSAmJiBwcmUudGFnTmFtZSA9PSAnUCcgJiYgIWRvbVV0aWxzLmlzRW1wdHlCbG9jayhwcmUpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHByZS5hcHBlbmRDaGlsZChub2RlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLm1vdmVDaGlsZChuZXh0LHByZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUobmV4dCk7DQogICAgICAgICAgICAgICAgICAgIH1lbHNlICBpZihuZXh0ICYmIG5leHQudGFnTmFtZSA9PSAnUCcgJiYgIWRvbVV0aWxzLmlzRW1wdHlCbG9jayhuZXh0KSl7DQogICAgICAgICAgICAgICAgICAgICAgICBuZXh0Lmluc2VydEJlZm9yZShub2RlLG5leHQuZmlyc3RDaGlsZCk7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBpZihwcmUgJiYgcHJlLnRhZ05hbWUgPT0gJ1AnICYmIGRvbVV0aWxzLmlzRW1wdHlCbG9jayhwcmUpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShwcmUpDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYobmV4dCAmJiBuZXh0LnRhZ05hbWUgPT0gJ1AnICYmIGRvbVV0aWxzLmlzRW1wdHlCbG9jayhuZXh0KSl7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUobmV4dCkNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBybmcuc2VsZWN0Tm9kZShub2RlKS5zZWxlY3QoKTsNCiAgICAgICAgICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCdzYXZlU2NlbmUnKTsNCg0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0pDQogICAgfSk7DQogICAgbWUuYWRkTGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24odHlwZSwgZXZ0KSB7DQogICAgICAgIHZhciBrZXlDb2RlID0gZXZ0LmtleUNvZGUgfHwgZXZ0LndoaWNoOw0KICAgICAgICBpZiAoa2V5Q29kZSA9PSAxMykgew0KICAgICAgICAgICAgdmFyIHJuZyA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpLG5vZGU7DQogICAgICAgICAgICBpZihub2RlID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShybmcuc3RhcnRDb250YWluZXIsJ3AnLHRydWUpKXsNCiAgICAgICAgICAgICAgICBpZihkb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKG5vZGUsJ3RleHQtYWxpZ24nKSA9PSAnY2VudGVyJyl7DQogICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZVN0eWxlKG5vZGUsJ3RleHQtYWxpZ24nKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0pDQp9Ow0KCi8vL2ltcG9ydCBjb3JlDQovLy9jb21tYW5kcyDmkqTplIDlkozph43lgZoNCi8vL2NvbW1hbmRzTmFtZSAgVW5kbyxSZWRvDQovLy9jb21tYW5kc1RpdGxlICDmkqTplIAs6YeN5YGaDQovKioNCiAqIEBkZXNjcmlwdGlvbiDlm57pgIANCiAqIEBhdXRob3IgemhhbnlpDQogKi8NCg0KVUUucGx1Z2luc1sndW5kbyddID0gZnVuY3Rpb24gKCkgew0KICAgIHZhciBzYXZlU2NlbmVUaW1lcjsNCiAgICB2YXIgbWUgPSB0aGlzLA0KICAgICAgICBtYXhVbmRvQ291bnQgPSBtZS5vcHRpb25zLm1heFVuZG9Db3VudCB8fCAyMCwNCiAgICAgICAgbWF4SW5wdXRDb3VudCA9IG1lLm9wdGlvbnMubWF4SW5wdXRDb3VudCB8fCAyMCwNCiAgICAgICAgZmlsbGNoYXIgPSBuZXcgUmVnRXhwKGRvbVV0aWxzLmZpbGxDaGFyICsgJ3w8XC9ocj4nLCAnZ2knKTsvLyBpZeS8muS6p+eUn+WkmuS9meeahDwvaHI+DQogICAgdmFyIG5vTmVlZEZpbGxDaGFyVGFncyA9IHsNCiAgICAgICAgb2w6MSx1bDoxLHRhYmxlOjEsdGJvZHk6MSx0cjoxLGJvZHk6MQ0KICAgIH07DQogICAgdmFyIG9yZ1N0YXRlID0gbWUub3B0aW9ucy5hdXRvQ2xlYXJFbXB0eU5vZGU7DQogICAgZnVuY3Rpb24gY29tcGFyZUFkZHIoaW5kZXhBLCBpbmRleEIpIHsNCiAgICAgICAgaWYgKGluZGV4QS5sZW5ndGggIT0gaW5kZXhCLmxlbmd0aCkNCiAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGluZGV4QS5sZW5ndGg7IGkgPCBsOyBpKyspIHsNCiAgICAgICAgICAgIGlmIChpbmRleEFbaV0gIT0gaW5kZXhCW2ldKQ0KICAgICAgICAgICAgICAgIHJldHVybiAwDQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIDE7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gY29tcGFyZVJhbmdlQWRkcmVzcyhybmdBZGRyQSwgcm5nQWRkckIpIHsNCiAgICAgICAgaWYgKHJuZ0FkZHJBLmNvbGxhcHNlZCAhPSBybmdBZGRyQi5jb2xsYXBzZWQpIHsNCiAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICB9DQogICAgICAgIGlmICghY29tcGFyZUFkZHIocm5nQWRkckEuc3RhcnRBZGRyZXNzLCBybmdBZGRyQi5zdGFydEFkZHJlc3MpIHx8ICFjb21wYXJlQWRkcihybmdBZGRyQS5lbmRBZGRyZXNzLCBybmdBZGRyQi5lbmRBZGRyZXNzKSkgew0KICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIDE7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gVW5kb01hbmFnZXIoKSB7DQogICAgICAgIHRoaXMubGlzdCA9IFtdOw0KICAgICAgICB0aGlzLmluZGV4ID0gMDsNCiAgICAgICAgdGhpcy5oYXNVbmRvID0gZmFsc2U7DQogICAgICAgIHRoaXMuaGFzUmVkbyA9IGZhbHNlOw0KICAgICAgICB0aGlzLnVuZG8gPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBpZiAodGhpcy5oYXNVbmRvKSB7DQogICAgICAgICAgICAgICAgaWYgKCF0aGlzLmxpc3RbdGhpcy5pbmRleCAtIDFdICYmIHRoaXMubGlzdC5sZW5ndGggPT0gMSkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2V0KCk7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgd2hpbGUgKHRoaXMubGlzdFt0aGlzLmluZGV4XS5jb250ZW50ID09IHRoaXMubGlzdFt0aGlzLmluZGV4IC0gMV0uY29udGVudCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmluZGV4LS07DQogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmluZGV4ID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlc3RvcmUoMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5yZXN0b3JlKC0tdGhpcy5pbmRleCk7DQogICAgICAgICAgICB9DQogICAgICAgIH07DQogICAgICAgIHRoaXMucmVkbyA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIGlmICh0aGlzLmhhc1JlZG8pIHsNCiAgICAgICAgICAgICAgICB3aGlsZSAodGhpcy5saXN0W3RoaXMuaW5kZXhdLmNvbnRlbnQgPT0gdGhpcy5saXN0W3RoaXMuaW5kZXggKyAxXS5jb250ZW50KSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5kZXgrKzsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5kZXggPT0gdGhpcy5saXN0Lmxlbmd0aCAtIDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlc3RvcmUodGhpcy5pbmRleCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5yZXN0b3JlKCsrdGhpcy5pbmRleCk7DQogICAgICAgICAgICB9DQogICAgICAgIH07DQoNCiAgICAgICAgdGhpcy5yZXN0b3JlID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpcy5lZGl0b3I7DQogICAgICAgICAgICB2YXIgc2NlbmUgPSB0aGlzLmxpc3RbdGhpcy5pbmRleF07DQogICAgICAgICAgICB2YXIgcm9vdCA9IFVFLmh0bWxwYXJzZXIoc2NlbmUuY29udGVudC5yZXBsYWNlKGZpbGxjaGFyLCAnJykpOw0KICAgICAgICAgICAgbWUub3B0aW9ucy5hdXRvQ2xlYXJFbXB0eU5vZGUgPSBmYWxzZTsNCiAgICAgICAgICAgIG1lLmZpbHRlcklucHV0UnVsZShyb290KTsNCiAgICAgICAgICAgIG1lLm9wdGlvbnMuYXV0b0NsZWFyRW1wdHlOb2RlID0gb3JnU3RhdGU7DQogICAgICAgICAgICAvL3RyYWNlOjg3Mw0KICAgICAgICAgICAgLy/ljrvmjonlsZXkvY3nrKYNCiAgICAgICAgICAgIG1lLmRvY3VtZW50LmJvZHkuaW5uZXJIVE1MID0gcm9vdC50b0h0bWwoKTsNCiAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnYWZ0ZXJzY2VuY2VyZXN0b3JlJyk7DQogICAgICAgICAgICAvL+WkhOeQhnVuZG/lkI7nqbrmoLzkuI3lsZXkvY3nmoTpl67popgNCiAgICAgICAgICAgIGlmIChicm93c2VyLmllKSB7DQogICAgICAgICAgICAgICAgdXRpbHMuZWFjaChkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZShtZS5kb2N1bWVudCwndGQgdGggY2FwdGlvbiBwJyksZnVuY3Rpb24obm9kZSl7DQogICAgICAgICAgICAgICAgICAgIGlmKGRvbVV0aWxzLmlzRW1wdHlOb2RlKG5vZGUpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLmZpbGxOb2RlKG1lLmRvY3VtZW50LCBub2RlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRyeXsNCiAgICAgICAgICAgICAgICB2YXIgcm5nID0gbmV3IGRvbS5SYW5nZShtZS5kb2N1bWVudCkubW92ZVRvQWRkcmVzcyhzY2VuZS5hZGRyZXNzKTsNCiAgICAgICAgICAgICAgICBybmcuc2VsZWN0KG5vTmVlZEZpbGxDaGFyVGFnc1tybmcuc3RhcnRDb250YWluZXIubm9kZU5hbWUudG9Mb3dlckNhc2UoKV0pOw0KICAgICAgICAgICAgfWNhdGNoKGUpe30NCg0KICAgICAgICAgICAgdGhpcy51cGRhdGUoKTsNCiAgICAgICAgICAgIHRoaXMuY2xlYXJLZXkoKTsNCiAgICAgICAgICAgIC8v5LiN6IO95oqK6Ieq5bexcmVzZXTkuoYNCiAgICAgICAgICAgIG1lLmZpcmVFdmVudCgncmVzZXQnLCB0cnVlKTsNCiAgICAgICAgfTsNCg0KICAgICAgICB0aGlzLmdldFNjZW5lID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpcy5lZGl0b3I7DQogICAgICAgICAgICB2YXIgcm5nID0gbWUuc2VsZWN0aW9uLmdldFJhbmdlKCksDQogICAgICAgICAgICAgICAgcm5nQWRkcmVzcyA9IHJuZy5jcmVhdGVBZGRyZXNzKGZhbHNlLHRydWUpOw0KICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCdiZWZvcmVnZXRzY2VuZScpOw0KICAgICAgICAgICAgdmFyIHJvb3QgPSBVRS5odG1scGFyc2VyKG1lLmJvZHkuaW5uZXJIVE1MKTsNCiAgICAgICAgICAgIG1lLm9wdGlvbnMuYXV0b0NsZWFyRW1wdHlOb2RlID0gZmFsc2U7DQogICAgICAgICAgICBtZS5maWx0ZXJPdXRwdXRSdWxlKHJvb3QpOw0KICAgICAgICAgICAgbWUub3B0aW9ucy5hdXRvQ2xlYXJFbXB0eU5vZGUgPSBvcmdTdGF0ZTsNCiAgICAgICAgICAgIHZhciBjb250ID0gcm9vdC50b0h0bWwoKTsNCiAgICAgICAgICAgIC8vdHJhY2U6MzQ2MQ0KICAgICAgICAgICAgLy/ov5nkuKrkvJrlvJXotbflm57pgIDml7blr7zoh7TnqbrmoLzkuKLlpLHnmoTmg4XlhrUNCi8vICAgICAgICAgICAgYnJvd3Nlci5pZSAmJiAoY29udCA9IGNvbnQucmVwbGFjZSgvPiZuYnNwOzwvZywgJz48JykucmVwbGFjZSgvXHMqPC9nLCAnPCcpLnJlcGxhY2UoLz5ccyovZywgJz4nKSk7DQogICAgICAgICAgICBtZS5maXJlRXZlbnQoJ2FmdGVyZ2V0c2NlbmUnKTsNCg0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICBhZGRyZXNzOnJuZ0FkZHJlc3MsDQogICAgICAgICAgICAgICAgY29udGVudDpjb250DQogICAgICAgICAgICB9DQogICAgICAgIH07DQogICAgICAgIHRoaXMuc2F2ZSA9IGZ1bmN0aW9uIChub3RDb21wYXJlUmFuZ2Usbm90U2V0Q3Vyc29yKSB7DQogICAgICAgICAgICBjbGVhclRpbWVvdXQoc2F2ZVNjZW5lVGltZXIpOw0KICAgICAgICAgICAgdmFyIGN1cnJlbnRTY2VuZSA9IHRoaXMuZ2V0U2NlbmUobm90U2V0Q3Vyc29yKSwNCiAgICAgICAgICAgICAgICBsYXN0U2NlbmUgPSB0aGlzLmxpc3RbdGhpcy5pbmRleF07DQogICAgICAgICAgICAvL+WGheWuueebuOWQjOS9jee9ruebuOWQjOS4jeWtmA0KICAgICAgICAgICAgaWYgKGxhc3RTY2VuZSAmJiBsYXN0U2NlbmUuY29udGVudCA9PSBjdXJyZW50U2NlbmUuY29udGVudCAmJg0KICAgICAgICAgICAgICAgICggbm90Q29tcGFyZVJhbmdlID8gMSA6IGNvbXBhcmVSYW5nZUFkZHJlc3MobGFzdFNjZW5lLmFkZHJlc3MsIGN1cnJlbnRTY2VuZS5hZGRyZXNzKSApDQogICAgICAgICAgICAgICAgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5saXN0ID0gdGhpcy5saXN0LnNsaWNlKDAsIHRoaXMuaW5kZXggKyAxKTsNCiAgICAgICAgICAgIHRoaXMubGlzdC5wdXNoKGN1cnJlbnRTY2VuZSk7DQogICAgICAgICAgICAvL+WmguaenOWkp+S6juacgOWkp+aVsOmHj+S6hu+8jOWwseaKiuacgOWJjeeahOWJlOmZpA0KICAgICAgICAgICAgaWYgKHRoaXMubGlzdC5sZW5ndGggPiBtYXhVbmRvQ291bnQpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmxpc3Quc2hpZnQoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuaW5kZXggPSB0aGlzLmxpc3QubGVuZ3RoIC0gMTsNCiAgICAgICAgICAgIHRoaXMuY2xlYXJLZXkoKTsNCiAgICAgICAgICAgIC8v6Lef5pawdW5kby9yZWRv54q25oCBDQogICAgICAgICAgICB0aGlzLnVwZGF0ZSgpOw0KDQogICAgICAgIH07DQogICAgICAgIHRoaXMudXBkYXRlID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdGhpcy5oYXNSZWRvID0gISF0aGlzLmxpc3RbdGhpcy5pbmRleCArIDFdOw0KICAgICAgICAgICAgdGhpcy5oYXNVbmRvID0gISF0aGlzLmxpc3RbdGhpcy5pbmRleCAtIDFdOw0KICAgICAgICB9Ow0KICAgICAgICB0aGlzLnJlc2V0ID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdGhpcy5saXN0ID0gW107DQogICAgICAgICAgICB0aGlzLmluZGV4ID0gMDsNCiAgICAgICAgICAgIHRoaXMuaGFzVW5kbyA9IGZhbHNlOw0KICAgICAgICAgICAgdGhpcy5oYXNSZWRvID0gZmFsc2U7DQogICAgICAgICAgICB0aGlzLmNsZWFyS2V5KCk7DQogICAgICAgIH07DQogICAgICAgIHRoaXMuY2xlYXJLZXkgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBrZXljb250ID0gMDsNCiAgICAgICAgICAgIGxhc3RLZXlDb2RlID0gbnVsbDsNCiAgICAgICAgfTsNCiAgICB9DQoNCiAgICBtZS51bmRvTWFuZ2VyID0gbmV3IFVuZG9NYW5hZ2VyKCk7DQogICAgbWUudW5kb01hbmdlci5lZGl0b3IgPSBtZTsNCiAgICBmdW5jdGlvbiBzYXZlU2NlbmUoKSB7DQogICAgICAgIHRoaXMudW5kb01hbmdlci5zYXZlKCk7DQogICAgfQ0KDQogICAgbWUuYWRkTGlzdGVuZXIoJ3NhdmVTY2VuZScsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc3BsaWNlLmNhbGwoYXJndW1lbnRzLDEpOw0KICAgICAgICB0aGlzLnVuZG9NYW5nZXIuc2F2ZS5hcHBseSh0aGlzLnVuZG9NYW5nZXIsYXJncyk7DQogICAgfSk7DQoNCiAgICBtZS5hZGRMaXN0ZW5lcignYmVmb3JlZXhlY2NvbW1hbmQnLCBzYXZlU2NlbmUpOw0KICAgIG1lLmFkZExpc3RlbmVyKCdhZnRlcmV4ZWNjb21tYW5kJywgc2F2ZVNjZW5lKTsNCg0KICAgIG1lLmFkZExpc3RlbmVyKCdyZXNldCcsIGZ1bmN0aW9uICh0eXBlLCBleGNsdWRlKSB7DQogICAgICAgIGlmICghZXhjbHVkZSkgew0KICAgICAgICAgICAgdGhpcy51bmRvTWFuZ2VyLnJlc2V0KCk7DQogICAgICAgIH0NCiAgICB9KTsNCiAgICBtZS5jb21tYW5kc1sncmVkbyddID0gbWUuY29tbWFuZHNbJ3VuZG8nXSA9IHsNCiAgICAgICAgZXhlY0NvbW1hbmQ6ZnVuY3Rpb24gKGNtZE5hbWUpIHsNCiAgICAgICAgICAgIHRoaXMudW5kb01hbmdlcltjbWROYW1lXSgpOw0KICAgICAgICB9LA0KICAgICAgICBxdWVyeUNvbW1hbmRTdGF0ZTpmdW5jdGlvbiAoY21kTmFtZSkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMudW5kb01hbmdlclsnaGFzJyArIChjbWROYW1lLnRvTG93ZXJDYXNlKCkgPT0gJ3VuZG8nID8gJ1VuZG8nIDogJ1JlZG8nKV0gPyAwIDogLTE7DQogICAgICAgIH0sDQogICAgICAgIG5vdE5lZWRVbmRvOjENCiAgICB9Ow0KDQogICAgdmFyIGtleXMgPSB7DQogICAgICAgICAgICAvLyAgLypCYWNrc3BhY2UqLyA4OjEsIC8qRGVsZXRlKi8gNDY6MSwNCiAgICAgICAgICAgIC8qU2hpZnQqLyAxNjoxLCAvKkN0cmwqLyAxNzoxLCAvKkFsdCovIDE4OjEsDQogICAgICAgICAgICAzNzoxLCAzODoxLCAzOToxLCA0MDoxDQoNCiAgICAgICAgfSwNCiAgICAgICAga2V5Y29udCA9IDAsDQogICAgICAgIGxhc3RLZXlDb2RlOw0KICAgIC8v6L6T5YWl5rOV54q25oCB5LiL5LiN6K6h566X5a2X56ym5pWwDQogICAgdmFyIGlucHV0VHlwZSA9IGZhbHNlOw0KICAgIG1lLmFkZExpc3RlbmVyKCdyZWFkeScsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgZG9tVXRpbHMub24odGhpcy5ib2R5LCAnY29tcG9zaXRpb25zdGFydCcsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIGlucHV0VHlwZSA9IHRydWU7DQogICAgICAgIH0pOw0KICAgICAgICBkb21VdGlscy5vbih0aGlzLmJvZHksICdjb21wb3NpdGlvbmVuZCcsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIGlucHV0VHlwZSA9IGZhbHNlOw0KICAgICAgICB9KQ0KICAgIH0pOw0KICAgIC8v5b+r5o236ZSuDQogICAgbWUuYWRkc2hvcnRjdXRrZXkoew0KICAgICAgICAiVW5kbyI6ImN0cmwrOTAiLCAvL3VuZG8NCiAgICAgICAgIlJlZG8iOiJjdHJsKzg5IiAvL3JlZG8NCg0KICAgIH0pOw0KICAgIHZhciBpc0NvbGxhcHNlZCA9IHRydWU7DQogICAgbWUuYWRkTGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbiAodHlwZSwgZXZ0KSB7DQoNCiAgICAgICAgdmFyIG1lID0gdGhpczsNCiAgICAgICAgdmFyIGtleUNvZGUgPSBldnQua2V5Q29kZSB8fCBldnQud2hpY2g7DQogICAgICAgIGlmICgha2V5c1trZXlDb2RlXSAmJiAhZXZ0LmN0cmxLZXkgJiYgIWV2dC5tZXRhS2V5ICYmICFldnQuc2hpZnRLZXkgJiYgIWV2dC5hbHRLZXkpIHsNCiAgICAgICAgICAgIGlmIChpbnB1dFR5cGUpDQogICAgICAgICAgICAgICAgcmV0dXJuOw0KDQogICAgICAgICAgICBpZighbWUuc2VsZWN0aW9uLmdldFJhbmdlKCkuY29sbGFwc2VkKXsNCiAgICAgICAgICAgICAgICBtZS51bmRvTWFuZ2VyLnNhdmUoZmFsc2UsdHJ1ZSk7DQogICAgICAgICAgICAgICAgaXNDb2xsYXBzZWQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAobWUudW5kb01hbmdlci5saXN0Lmxlbmd0aCA9PSAwKSB7DQogICAgICAgICAgICAgICAgbWUudW5kb01hbmdlci5zYXZlKHRydWUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHNhdmVTY2VuZVRpbWVyKTsNCiAgICAgICAgICAgIGZ1bmN0aW9uIHNhdmUoY29udCl7DQoNCiAgICAgICAgICAgICAgICBpZiAoY29udC5zZWxlY3Rpb24uZ2V0UmFuZ2UoKS5jb2xsYXBzZWQpDQogICAgICAgICAgICAgICAgICAgIGNvbnQuZmlyZUV2ZW50KCdjb250ZW50Y2hhbmdlJyk7DQogICAgICAgICAgICAgICAgY29udC51bmRvTWFuZ2VyLnNhdmUoZmFsc2UsdHJ1ZSk7DQogICAgICAgICAgICAgICAgY29udC5maXJlRXZlbnQoJ3NlbGVjdGlvbmNoYW5nZScpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgc2F2ZVNjZW5lVGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgICAgaWYoaW5wdXRUeXBlKXsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGludGVyYWxUaW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgICAgICAgICAgICBpZighaW5wdXRUeXBlKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYXZlKG1lKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGludGVyYWxUaW1lcikNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSwzMDApDQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgc2F2ZShtZSk7DQogICAgICAgICAgICB9LDIwMCk7DQoNCiAgICAgICAgICAgIGxhc3RLZXlDb2RlID0ga2V5Q29kZTsNCiAgICAgICAgICAgIGtleWNvbnQrKzsNCiAgICAgICAgICAgIGlmIChrZXljb250ID49IG1heElucHV0Q291bnQgKSB7DQogICAgICAgICAgICAgICAgc2F2ZShtZSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIG1lLmFkZExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uICh0eXBlLCBldnQpIHsNCiAgICAgICAgdmFyIGtleUNvZGUgPSBldnQua2V5Q29kZSB8fCBldnQud2hpY2g7DQogICAgICAgIGlmICgha2V5c1trZXlDb2RlXSAmJiAhZXZ0LmN0cmxLZXkgJiYgIWV2dC5tZXRhS2V5ICYmICFldnQuc2hpZnRLZXkgJiYgIWV2dC5hbHRLZXkpIHsNCiAgICAgICAgICAgIGlmIChpbnB1dFR5cGUpDQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgaWYoIWlzQ29sbGFwc2VkKXsNCiAgICAgICAgICAgICAgICB0aGlzLnVuZG9NYW5nZXIuc2F2ZShmYWxzZSx0cnVlKTsNCiAgICAgICAgICAgICAgICBpc0NvbGxhcHNlZCA9IHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9KTsNCg0KfTsNCgovLy9pbXBvcnQgY29yZQovLy9pbXBvcnQgcGx1Z2lucy9pbnNlcnRodG1sLmpzCi8vL2ltcG9ydCBwbHVnaW5zL3VuZG8uanMKLy8vaW1wb3J0IHBsdWdpbnMvc2VyaWFsaXplLmpzCi8vL2NvbW1hbmRzIOeymOi0tAovLy9jb21tYW5kc05hbWUgIFBhc3RlUGxhaW4KLy8vY29tbWFuZHNUaXRsZSAg57qv5paH5pys57KY6LS05qih5byPCi8qCiAqKiBAZGVzY3JpcHRpb24g57KY6LS0CiAqIEBhdXRob3IgemhhbnlpCiAqLwpVRS5wbHVnaW5zWydwYXN0ZSddID0gZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gZ2V0Q2xpcGJvYXJkRGF0YShjYWxsYmFjaykgewogICAgICAgIHZhciBkb2MgPSB0aGlzLmRvY3VtZW50OwogICAgICAgIGlmIChkb2MuZ2V0RWxlbWVudEJ5SWQoJ2JhaWR1X3Bhc3RlYmluJykpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB2YXIgcmFuZ2UgPSB0aGlzLnNlbGVjdGlvbi5nZXRSYW5nZSgpLAogICAgICAgICAgICBiayA9IHJhbmdlLmNyZWF0ZUJvb2ttYXJrKCksCiAgICAgICAgLy/liJvlu7rliarotLTnmoTlrrnlmahkaXYKICAgICAgICAgICAgcGFzdGViaW4gPSBkb2MuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgcGFzdGViaW4uaWQgPSAnYmFpZHVfcGFzdGViaW4nOwogICAgICAgIC8vIFNhZmFyaSDopoHmsYJkaXblv4XpobvmnInlhoXlrrnvvIzmiY3og73nspjotLTlhoXlrrnov5vmnaUKICAgICAgICBicm93c2VyLndlYmtpdCAmJiBwYXN0ZWJpbi5hcHBlbmRDaGlsZChkb2MuY3JlYXRlVGV4dE5vZGUoZG9tVXRpbHMuZmlsbENoYXIgKyBkb21VdGlscy5maWxsQ2hhcikpOwogICAgICAgIGRvYy5ib2R5LmFwcGVuZENoaWxkKHBhc3RlYmluKTsKICAgICAgICAvL3RyYWNlOjcxNyDpmpDol4/nmoRzcGFu5LiN6IO95b6X5YiwdG9wCiAgICAgICAgLy9iay5zdGFydC5pbm5lckhUTUwgPSAnJm5ic3A7JzsKICAgICAgICBiay5zdGFydC5zdHlsZS5kaXNwbGF5ID0gJyc7CiAgICAgICAgcGFzdGViaW4uc3R5bGUuY3NzVGV4dCA9ICJwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDoxcHg7aGVpZ2h0OjFweDtvdmVyZmxvdzpoaWRkZW47bGVmdDotMTAwMHB4O3doaXRlLXNwYWNlOm5vd3JhcDt0b3A6IiArCiAgICAgICAgICAgIC8v6KaB5Zyo546w5Zyo5YWJ5qCH5bmz6KGM55qE5L2N572u5Yqg5YWl77yM5ZCm5YiZ5Lya5Ye6546w6Lez5Yqo55qE6Zeu6aKYCiAgICAgICAgICAgIGRvbVV0aWxzLmdldFhZKGJrLnN0YXJ0KS55ICsgJ3B4JzsKCiAgICAgICAgcmFuZ2Uuc2VsZWN0Tm9kZUNvbnRlbnRzKHBhc3RlYmluKS5zZWxlY3QodHJ1ZSk7CgogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBpZiAoYnJvd3Nlci53ZWJraXQpIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBwYXN0ZWJpbnMgPSBkb2MucXVlcnlTZWxlY3RvckFsbCgnI2JhaWR1X3Bhc3RlYmluJyksIHBpOyBwaSA9IHBhc3RlYmluc1tpKytdOykgewogICAgICAgICAgICAgICAgICAgIGlmIChkb21VdGlscy5pc0VtcHR5Tm9kZShwaSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHBpKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBwYXN0ZWJpbiA9IHBpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHBhc3RlYmluLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQocGFzdGViaW4pOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmFuZ2UubW92ZVRvQm9va21hcmsoYmspLnNlbGVjdCh0cnVlKTsKICAgICAgICAgICAgY2FsbGJhY2socGFzdGViaW4pOwogICAgICAgIH0sIDApOwogICAgfQoKICAgIHZhciBtZSA9IHRoaXM7CgogICAgdmFyIHR4dENvbnRlbnQsIGh0bWxDb250ZW50LCBhZGRyZXNzOwoKICAgIGZ1bmN0aW9uIGZpbHRlcihkaXYpIHsKICAgICAgICB2YXIgaHRtbDsKICAgICAgICBpZiAoZGl2LmZpcnN0Q2hpbGQpIHsKICAgICAgICAgICAgLy/ljrvmjoljdXTkuK3mt7vliqDnmoTovrnnlYzlgLwKICAgICAgICAgICAgdmFyIG5vZGVzID0gZG9tVXRpbHMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoZGl2LCAnc3BhbicpOwogICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbmk7IG5pID0gbm9kZXNbaSsrXTspIHsKICAgICAgICAgICAgICAgIGlmIChuaS5pZCA9PSAnX2JhaWR1X2N1dF9zdGFydCcgfHwgbmkuaWQgPT0gJ19iYWlkdV9jdXRfZW5kJykgewogICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShuaSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChicm93c2VyLndlYmtpdCkgewoKICAgICAgICAgICAgICAgIHZhciBicnMgPSBkaXYucXVlcnlTZWxlY3RvckFsbCgnZGl2IGJyJyk7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgYmk7IGJpID0gYnJzW2krK107KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHBOID0gYmkucGFyZW50Tm9kZTsKICAgICAgICAgICAgICAgICAgICBpZiAocE4udGFnTmFtZSA9PSAnRElWJyAmJiBwTi5jaGlsZE5vZGVzLmxlbmd0aCA9PSAxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBOLmlubmVySFRNTCA9ICc8cD48YnIvPjwvcD4nOwogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUocE4pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHZhciBkaXZzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoJyNiYWlkdV9wYXN0ZWJpbicpOwogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGRpOyBkaSA9IGRpdnNbaSsrXTspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgdG1wUCA9IG1lLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTsKICAgICAgICAgICAgICAgICAgICBkaS5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0bXBQLCBkaSk7CiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGRpLmZpcnN0Q2hpbGQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdG1wUC5hcHBlbmRDaGlsZChkaS5maXJzdENoaWxkKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKGRpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB2YXIgbWV0YXMgPSBkaXYucXVlcnlTZWxlY3RvckFsbCgnbWV0YScpOwogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNpOyBjaSA9IG1ldGFzW2krK107KSB7CiAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKGNpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB2YXIgYnJzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoJ2JyJyk7CiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBjaSA9IGJyc1tpKytdOykgewogICAgICAgICAgICAgICAgICAgIGlmICgvXmFwcGxlLS9pLnRlc3QoY2kuY2xhc3NOYW1lKSkgewogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUoY2kpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoYnJvd3Nlci5nZWNrbykgewogICAgICAgICAgICAgICAgdmFyIGRpcnR5Tm9kZXMgPSBkaXYucXVlcnlTZWxlY3RvckFsbCgnW19tb3pfZGlydHldJyk7CiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBjaSA9IGRpcnR5Tm9kZXNbaSsrXTspIHsKICAgICAgICAgICAgICAgICAgICBjaS5yZW1vdmVBdHRyaWJ1dGUoJ19tb3pfZGlydHknKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIWJyb3dzZXIuaWUpIHsKICAgICAgICAgICAgICAgIHZhciBzcGFucyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKCdzcGFuLkFwcGxlLXN0eWxlLXNwYW4nKTsKICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjaTsgY2kgPSBzcGFuc1tpKytdOykgewogICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShjaSwgdHJ1ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vaWXkuIvkvb/nlKhpbm5lckhUTUzkvJrkuqfnlJ/lpJrkvZnnmoRcclxu5a2X56ym77yM5Lmf5Lya5Lqn55SfJm5ic3A76L+Z6YeM6L+H5ruk5o6JCiAgICAgICAgICAgIGh0bWwgPSBkaXYuaW5uZXJIVE1MOy8vLnJlcGxhY2UoLz4oPzooXHN8Jm5ic3A7KSo/KTwvZywnPjwnKTsKCiAgICAgICAgICAgIC8v6L+H5rukd29yZOeymOi0tOi/h+adpeeahOWGl+S9meWxnuaApwogICAgICAgICAgICBodG1sID0gVUUuZmlsdGVyV29yZChodG1sKTsKICAgICAgICAgICAgLy/lj5bmtojkuoblv73nlaXnqbrnmb3nmoTnrKzkuozkuKrlj4LmlbDvvIznspjotLTov4fmnaXnmoTmnInkupvmmK/mnInnqbrnmb3nmoTvvIzkvJrooqvlpZfkuIrnm7jlhbPnmoTmoIfnrb4KICAgICAgICAgICAgdmFyIHJvb3QgPSBVRS5odG1scGFyc2VyKGh0bWwpOwogICAgICAgICAgICAvL+WmguaenOe7meS6hui/h+a7pOinhOWImeWwseWFiOi/m+ihjOi/h+a7pAogICAgICAgICAgICBpZiAobWUub3B0aW9ucy5maWx0ZXJSdWxlcykgewogICAgICAgICAgICAgICAgVUUuZmlsdGVyTm9kZShyb290LCBtZS5vcHRpb25zLmZpbHRlclJ1bGVzKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvL+aJp+ihjOm7mOiupOeahOWkhOeQhgogICAgICAgICAgICBtZS5maWx0ZXJJbnB1dFJ1bGUocm9vdCk7CiAgICAgICAgICAgIC8v6ZKI5a+5Y2hyb21l55qE5aSE55CGCiAgICAgICAgICAgIGlmIChicm93c2VyLndlYmtpdCkgewogICAgICAgICAgICAgICAgdmFyIGJyID0gcm9vdC5sYXN0Q2hpbGQoKTsKICAgICAgICAgICAgICAgIGlmIChiciAmJiBici50eXBlID09ICdlbGVtZW50JyAmJiBici50YWdOYW1lID09ICdicicpIHsKICAgICAgICAgICAgICAgICAgICByb290LnJlbW92ZUNoaWxkKGJyKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdXRpbHMuZWFjaChtZS5ib2R5LnF1ZXJ5U2VsZWN0b3JBbGwoJ2RpdicpLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChkb21VdGlscy5pc0VtcHR5QmxvY2sobm9kZSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKG5vZGUpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgICAgICBodG1sID0geydodG1sJzogcm9vdC50b0h0bWwoKX07CiAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnYmVmb3JlcGFzdGUnLCBodG1sLCByb290KTsKICAgICAgICAgICAgLy/miqLkuobpu5jorqTnmoTnspjotLTvvIzpgqPlkI7ovrnnmoTlhoXlrrnlsLHkuI3miafooYzkuobvvIzmr5TlpoLooajmoLznspjotLQKICAgICAgICAgICAgaWYoIWh0bWwuaHRtbCl7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcm9vdCA9IFVFLmh0bWxwYXJzZXIoaHRtbC5odG1sLHRydWUpOwogICAgICAgICAgICAvL+WmguaenOW8gOWQr+S6hue6r+aWh+acrOaooeW8jwogICAgICAgICAgICBpZiAobWUucXVlcnlDb21tYW5kU3RhdGUoJ3Bhc3RlcGxhaW4nKSA9PT0gMSkgewogICAgICAgICAgICAgICAgbWUuZXhlY0NvbW1hbmQoJ2luc2VydEh0bWwnLCBVRS5maWx0ZXJOb2RlKHJvb3QsIG1lLm9wdGlvbnMuZmlsdGVyVHh0UnVsZXMpLnRvSHRtbCgpLCB0cnVlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8v5paH5pys5qih5byPCiAgICAgICAgICAgICAgICBVRS5maWx0ZXJOb2RlKHJvb3QsIG1lLm9wdGlvbnMuZmlsdGVyVHh0UnVsZXMpOwogICAgICAgICAgICAgICAgdHh0Q29udGVudCA9IHJvb3QudG9IdG1sKCk7CiAgICAgICAgICAgICAgICAvL+WujOWFqOaooeW8jwogICAgICAgICAgICAgICAgaHRtbENvbnRlbnQgPSBodG1sLmh0bWw7CgogICAgICAgICAgICAgICAgYWRkcmVzcyA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpLmNyZWF0ZUFkZHJlc3ModHJ1ZSk7CiAgICAgICAgICAgICAgICBtZS5leGVjQ29tbWFuZCgnaW5zZXJ0SHRtbCcsIGh0bWxDb250ZW50LCB0cnVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBtZS5maXJlRXZlbnQoImFmdGVycGFzdGUiLCBodG1sKTsKICAgICAgICB9CiAgICB9CgogICAgbWUuYWRkTGlzdGVuZXIoJ3Bhc3RlVHJhbnNmZXInLCBmdW5jdGlvbiAoY21kLCBwbGFpblR5cGUpIHsKCiAgICAgICAgaWYgKGFkZHJlc3MgJiYgdHh0Q29udGVudCAmJiBodG1sQ29udGVudCAmJiB0eHRDb250ZW50ICE9IGh0bWxDb250ZW50KSB7CiAgICAgICAgICAgIHZhciByYW5nZSA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpOwogICAgICAgICAgICByYW5nZS5tb3ZlVG9BZGRyZXNzKGFkZHJlc3MsIHRydWUpOwoKICAgICAgICAgICAgaWYgKCFyYW5nZS5jb2xsYXBzZWQpIHsKCiAgICAgICAgICAgICAgICB3aGlsZSAoIWRvbVV0aWxzLmlzQm9keShyYW5nZS5zdGFydENvbnRhaW5lcikKICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSByYW5nZS5zdGFydENvbnRhaW5lcjsKICAgICAgICAgICAgICAgICAgICBpZihzdGFydC5ub2RlVHlwZSA9PSAxKXsKICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBzdGFydC5jaGlsZE5vZGVzW3JhbmdlLnN0YXJ0T2Zmc2V0XTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoIXN0YXJ0KXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0QmVmb3JlKHJhbmdlLnN0YXJ0Q29udGFpbmVyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcmUgPSBzdGFydC5wcmV2aW91c1NpYmxpbmc7CgogICAgICAgICAgICAgICAgICAgICAgICBpZihwcmUgJiYgcHJlLm5vZGVUeXBlID09IDMgJiYgbmV3IFJlZ0V4cCgnXltcblxyXHQgJytkb21VdGlscy5maWxsQ2hhcisnXSokJykudGVzdChwcmUubm9kZVZhbHVlKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydEJlZm9yZShwcmUpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYocmFuZ2Uuc3RhcnRPZmZzZXQgPT0gMCl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0QmVmb3JlKHJhbmdlLnN0YXJ0Q29udGFpbmVyKTsKICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHdoaWxlICghZG9tVXRpbHMuaXNCb2R5KHJhbmdlLmVuZENvbnRhaW5lcikKICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICB2YXIgZW5kID0gcmFuZ2UuZW5kQ29udGFpbmVyOwogICAgICAgICAgICAgICAgICAgIGlmKGVuZC5ub2RlVHlwZSA9PSAxKXsKICAgICAgICAgICAgICAgICAgICAgICAgZW5kID0gZW5kLmNoaWxkTm9kZXNbcmFuZ2UuZW5kT2Zmc2V0XTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoIWVuZCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRFbmRBZnRlcihyYW5nZS5lbmRDb250YWluZXIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5leHQgPSBlbmQubmV4dFNpYmxpbmc7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKG5leHQgJiYgbmV4dC5ub2RlVHlwZSA9PSAzICYmIG5ldyBSZWdFeHAoJ15bXG5cclx0Jytkb21VdGlscy5maWxsQ2hhcisnXSokJykudGVzdChuZXh0Lm5vZGVWYWx1ZSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0RW5kQWZ0ZXIobmV4dCkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZihyYW5nZS5lbmRPZmZzZXQgPT0gcmFuZ2UuZW5kQ29udGFpbmVyW3JhbmdlLmVuZENvbnRhaW5lci5ub2RlVHlwZSA9PSAzID8gJ25vZGVWYWx1ZScgOiAnY2hpbGROb2RlcyddLmxlbmd0aCl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldEVuZEFmdGVyKHJhbmdlLmVuZENvbnRhaW5lcik7CiAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICB9CgogICAgICAgICAgICByYW5nZS5kZWxldGVDb250ZW50cygpOwogICAgICAgICAgICByYW5nZS5zZWxlY3QodHJ1ZSk7CiAgICAgICAgICAgIG1lLl9faGFzRW50ZXJFeGVjQ29tbWFuZCA9IHRydWU7CiAgICAgICAgICAgIHZhciBodG1sID0gaHRtbENvbnRlbnQ7CiAgICAgICAgICAgIGlmIChwbGFpblR5cGUgPT09IDIpIHsKICAgICAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoLzwoXC8/KShbXHdcLV0rKShbXj5dKik+L2dpLCBmdW5jdGlvbiAoYSwgYiwgdGFnTmFtZSwgYXR0cnMpIHsKICAgICAgICAgICAgICAgICAgICB0YWdOYW1lID0gdGFnTmFtZS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICAgICAgICAgIGlmICh7aW1nOiAxfVt0YWdOYW1lXSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYXR0cnMgPSBhdHRycy5yZXBsYWNlKC8oW1x3XC1dKj8pXHMqPVxzKigoIihbXiJdKikiKXwoJyhbXiddKiknKXwoW15ccz5dKykpL2dpLCBmdW5jdGlvbiAoc3RyLCBhdHIsIHZhbCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NyYyc6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaHJlZic6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbmFtZSc6IDEKICAgICAgICAgICAgICAgICAgICAgICAgfVthdHIudG9Mb3dlckNhc2UoKV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhdHIgKyAnPScgKyB2YWwgKyAnICcKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJycKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBpZiAoewogICAgICAgICAgICAgICAgICAgICAgICAnc3Bhbic6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICdkaXYnOiAxCiAgICAgICAgICAgICAgICAgICAgfVt0YWdOYW1lXSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJycKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8JyArIGIgKyB0YWdOYW1lICsgJyAnICsgdXRpbHMudHJpbShhdHRycykgKyAnPicKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocGxhaW5UeXBlKSB7CiAgICAgICAgICAgICAgICBodG1sID0gdHh0Q29udGVudDsKICAgICAgICAgICAgfQogICAgICAgICAgICBtZS5leGVjQ29tbWFuZCgnaW5zZXJ0aHRtbCcsIGh0bWwsIHRydWUpOwogICAgICAgICAgICBtZS5fX2hhc0VudGVyRXhlY0NvbW1hbmQgPSBmYWxzZTsKICAgICAgICAgICAgdmFyIHJuZyA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpOwogICAgICAgICAgICB3aGlsZSAoIWRvbVV0aWxzLmlzQm9keShybmcuc3RhcnRDb250YWluZXIpICYmICFybmcuc3RhcnRPZmZzZXQgJiYKICAgICAgICAgICAgICAgIHJuZy5zdGFydENvbnRhaW5lcltybmcuc3RhcnRDb250YWluZXIubm9kZVR5cGUgPT0gMyA/ICdub2RlVmFsdWUnIDogJ2NoaWxkTm9kZXMnXS5sZW5ndGgKICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgcm5nLnNldFN0YXJ0QmVmb3JlKHJuZy5zdGFydENvbnRhaW5lcik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyIHRtcEFkZHJlc3MgPSBybmcuY3JlYXRlQWRkcmVzcyh0cnVlKTsKICAgICAgICAgICAgYWRkcmVzcy5lbmRBZGRyZXNzID0gdG1wQWRkcmVzcy5zdGFydEFkZHJlc3M7CiAgICAgICAgfQogICAgfSk7CiAgICBtZS5hZGRMaXN0ZW5lcigncmVhZHknLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgZG9tVXRpbHMub24obWUuYm9keSwgJ2N1dCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIHJhbmdlID0gbWUuc2VsZWN0aW9uLmdldFJhbmdlKCk7CiAgICAgICAgICAgIGlmICghcmFuZ2UuY29sbGFwc2VkICYmIG1lLnVuZG9NYW5nZXIpIHsKICAgICAgICAgICAgICAgIG1lLnVuZG9NYW5nZXIuc2F2ZSgpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIC8vaWXkuItiZWZvcmVwYXN0ZeWcqOeCueWHu+WPs+mUruaXtuS5n+S8muinpuWPke+8jOaJgOS7peeUqOebkeaOp+mUruebmOaJjeWkhOeQhgogICAgICAgIGRvbVV0aWxzLm9uKG1lLmJvZHksIGJyb3dzZXIuaWUgfHwgYnJvd3Nlci5vcGVyYSA/ICdrZXlkb3duJyA6ICdwYXN0ZScsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGlmICgoYnJvd3Nlci5pZSB8fCBicm93c2VyLm9wZXJhKSAmJiAoKCFlLmN0cmxLZXkgJiYgIWUubWV0YUtleSkgfHwgZS5rZXlDb2RlICE9ICc4NicpKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ2V0Q2xpcGJvYXJkRGF0YS5jYWxsKG1lLCBmdW5jdGlvbiAoZGl2KSB7CiAgICAgICAgICAgICAgICBmaWx0ZXIoZGl2KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CgogICAgfSk7Cn07CgoKLy8vaW1wb3J0IGNvcmUNCi8vL2NvbW1hbmRzIOacieW6j+WIl+ihqCzml6Dluo/liJfooagNCi8vL2NvbW1hbmRzTmFtZSAgSW5zZXJ0T3JkZXJlZExpc3QsSW5zZXJ0VW5vcmRlcmVkTGlzdA0KLy8vY29tbWFuZHNUaXRsZSAg5pyJ5bqP5YiX6KGoLOaXoOW6j+WIl+ihqA0KLyoqDQogKiDmnInluo/liJfooagNCiAqIEBmdW5jdGlvbg0KICogQG5hbWUgYmFpZHUuZWRpdG9yLmV4ZWNDb21tYW5kDQogKiBAcGFyYW0gICB7U3RyaW5nfSAgIGNtZE5hbWUgICAgIGluc2VydG9yZGVybGlzdOaPkuWFpeacieW6j+WIl+ihqA0KICogQHBhcmFtICAge1N0cmluZ30gICBzdHlsZSAgICAgICAgICAgICAgIOWAvOS4uu+8mmRlY2ltYWwsbG93ZXItYWxwaGEsbG93ZXItcm9tYW4sdXBwZXItYWxwaGEsdXBwZXItcm9tYW4NCiAqIEBhdXRob3IgemhhbnlpDQogKi8NCi8qKg0KICog5peg5bqP6ZO+5o6lDQogKiBAZnVuY3Rpb24NCiAqIEBuYW1lIGJhaWR1LmVkaXRvci5leGVjQ29tbWFuZA0KICogQHBhcmFtICAge1N0cmluZ30gICBjbWROYW1lICAgICBpbnNlcnR1bm9yZGVybGlzdOaPkuWFpeaXoOW6j+WIl+ihqA0KICogKiBAcGFyYW0gICB7U3RyaW5nfSAgIHN0eWxlICAgICAgICAgICAg5YC85Li677yaY2lyY2xlLGRpc2Msc3F1YXJlDQogKiBAYXV0aG9yIHpoYW55aQ0KICovDQoNClVFLnBsdWdpbnNbJ2xpc3QnXSA9IGZ1bmN0aW9uICgpIHsNCiAgICB2YXIgbWUgPSB0aGlzLA0KICAgICAgICBub3RFeGNoYW5nZSA9IHsNCiAgICAgICAgICAgICdURCc6MSwNCiAgICAgICAgICAgICdQUkUnOjEsDQogICAgICAgICAgICAnQkxPQ0tRVU9URSc6MQ0KICAgICAgICB9Ow0KICAgIHZhciBjdXN0b21TdHlsZSA9IHsNCiAgICAgICAgJ2NuJyA6ICdjbi0xLScsDQogICAgICAgICdjbjEnIDogJ2NuLTItJywNCiAgICAgICAgJ2NuMicgOiAnY24tMy0nLA0KICAgICAgICAnbnVtJzogICdudW0tMS0nLA0KICAgICAgICAnbnVtMScgOiAnbnVtLTItJywNCiAgICAgICAgJ251bTInIDogJ251bS0zLScsDQogICAgICAgICdkYXNoJyAgOiAnZGFzaCcsDQogICAgICAgICdkb3QnOidkb3QnDQogICAgfTsNCg0KICAgIG1lLnNldE9wdCggew0KICAgICAgICAnaW5zZXJ0b3JkZXJlZGxpc3QnOnsNCiAgICAgICAgICAgICdudW0nOicnLA0KICAgICAgICAgICAgJ251bTEnOicnLA0KICAgICAgICAgICAgJ251bTInOicnLA0KICAgICAgICAgICAgJ2NuJzonJywNCiAgICAgICAgICAgICdjbjEnOicnLA0KICAgICAgICAgICAgJ2NuMic6JycsDQogICAgICAgICAgICAnZGVjaW1hbCc6JycsDQogICAgICAgICAgICAnbG93ZXItYWxwaGEnOicnLA0KICAgICAgICAgICAgJ2xvd2VyLXJvbWFuJzonJywNCiAgICAgICAgICAgICd1cHBlci1hbHBoYSc6JycsDQogICAgICAgICAgICAndXBwZXItcm9tYW4nOicnDQogICAgICAgIH0sDQogICAgICAgICdpbnNlcnR1bm9yZGVyZWRsaXN0Jzp7DQogICAgICAgICAgICAnY2lyY2xlJzonJywNCiAgICAgICAgICAgICdkaXNjJzonJywNCiAgICAgICAgICAgICdzcXVhcmUnOicnLA0KICAgICAgICAgICAgJ2Rhc2gnIDogJycsDQogICAgICAgICAgICAnZG90JzonJw0KICAgICAgICB9LA0KICAgICAgICBsaXN0RGVmYXVsdFBhZGRpbmdMZWZ0IDogJzMwJywNCiAgICAgICAgbGlzdGljb25wYXRoIDogJ2h0dHA6Ly9icy5iYWlkdS5jb20vbGlzdGljb24vJywNCiAgICAgICAgbWF4TGlzdExldmVsIDogLTEvLy0x5LiN6ZmQ5Yi2DQogICAgfSApOw0KICAgIGZ1bmN0aW9uIGxpc3RUb0FycmF5KGxpc3Qpew0KICAgICAgICB2YXIgYXJyID0gW107DQogICAgICAgIGZvcih2YXIgcCBpbiBsaXN0KXsNCiAgICAgICAgICAgIGFyci5wdXNoKHApDQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIGFycjsNCiAgICB9DQogICAgdmFyIGxpc3RTdHlsZSA9IHsNCiAgICAgICAgJ09MJzpsaXN0VG9BcnJheShtZS5vcHRpb25zLmluc2VydG9yZGVyZWRsaXN0KSwNCiAgICAgICAgJ1VMJzpsaXN0VG9BcnJheShtZS5vcHRpb25zLmluc2VydHVub3JkZXJlZGxpc3QpDQogICAgfTsNCiAgICB2YXIgbGlpY29ucGF0aCA9IG1lLm9wdGlvbnMubGlzdGljb25wYXRoOw0KDQogICAgLy/moLnmja7nlKjmiLfphY3nva7vvIzosIPmlbRjdXN0b21TdHlsZQ0KICAgIGZvcih2YXIgcyBpbiBjdXN0b21TdHlsZSl7DQogICAgICAgIGlmKCFtZS5vcHRpb25zLmluc2VydG9yZGVyZWRsaXN0Lmhhc093blByb3BlcnR5KHMpICYmICFtZS5vcHRpb25zLmluc2VydHVub3JkZXJlZGxpc3QuaGFzT3duUHJvcGVydHkocykpew0KICAgICAgICAgICAgZGVsZXRlIGN1c3RvbVN0eWxlW3NdOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgbWUucmVhZHkoZnVuY3Rpb24gKCkgew0KICAgICAgICB2YXIgY3VzdG9tQ3NzID0gW107DQogICAgICAgIGZvcih2YXIgcCBpbiBjdXN0b21TdHlsZSl7DQogICAgICAgICAgICBpZihwID09ICdkYXNoJyB8fCBwID09ICdkb3QnKXsNCiAgICAgICAgICAgICAgICBjdXN0b21Dc3MucHVzaCgnbGkubGlzdC0nICsgY3VzdG9tU3R5bGVbcF0gKyAne2JhY2tncm91bmQtaW1hZ2U6dXJsKCcgKyBsaWljb25wYXRoICtjdXN0b21TdHlsZVtwXSsnLmdpZil9Jyk7DQogICAgICAgICAgICAgICAgY3VzdG9tQ3NzLnB1c2goJ3VsLmN1c3RvbV8nK3ArJ3tsaXN0LXN0eWxlOm5vbmU7fXVsLmN1c3RvbV8nK3ArJyBsaXtiYWNrZ3JvdW5kLXBvc2l0aW9uOjAgM3B4O2JhY2tncm91bmQtcmVwZWF0Om5vLXJlcGVhdH0nKTsNCiAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgIGZvcih2YXIgaT0gMDtpPDk5O2krKyl7DQogICAgICAgICAgICAgICAgICAgIGN1c3RvbUNzcy5wdXNoKCdsaS5saXN0LScgKyBjdXN0b21TdHlsZVtwXSArIGkgKyAne2JhY2tncm91bmQtaW1hZ2U6dXJsKCcgKyBsaWljb25wYXRoICsgJ2xpc3QtJytjdXN0b21TdHlsZVtwXSArIGkgKyAnLmdpZil9JykNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgY3VzdG9tQ3NzLnB1c2goJ29sLmN1c3RvbV8nK3ArJ3tsaXN0LXN0eWxlOm5vbmU7fW9sLmN1c3RvbV8nK3ArJyBsaXtiYWNrZ3JvdW5kLXBvc2l0aW9uOjAgM3B4O2JhY2tncm91bmQtcmVwZWF0Om5vLXJlcGVhdH0nKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHN3aXRjaChwKXsNCiAgICAgICAgICAgICAgICBjYXNlICdjbic6DQogICAgICAgICAgICAgICAgICAgIGN1c3RvbUNzcy5wdXNoKCdsaS5saXN0LScrcCsnLXBhZGRpbmdsZWZ0LTF7cGFkZGluZy1sZWZ0OjI1cHh9Jyk7DQogICAgICAgICAgICAgICAgICAgIGN1c3RvbUNzcy5wdXNoKCdsaS5saXN0LScrcCsnLXBhZGRpbmdsZWZ0LTJ7cGFkZGluZy1sZWZ0OjQwcHh9Jyk7DQogICAgICAgICAgICAgICAgICAgIGN1c3RvbUNzcy5wdXNoKCdsaS5saXN0LScrcCsnLXBhZGRpbmdsZWZ0LTN7cGFkZGluZy1sZWZ0OjU1cHh9Jyk7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIGNhc2UgJ2NuMSc6DQogICAgICAgICAgICAgICAgICAgIGN1c3RvbUNzcy5wdXNoKCdsaS5saXN0LScrcCsnLXBhZGRpbmdsZWZ0LTF7cGFkZGluZy1sZWZ0OjMwcHh9Jyk7DQogICAgICAgICAgICAgICAgICAgIGN1c3RvbUNzcy5wdXNoKCdsaS5saXN0LScrcCsnLXBhZGRpbmdsZWZ0LTJ7cGFkZGluZy1sZWZ0OjQwcHh9Jyk7DQogICAgICAgICAgICAgICAgICAgIGN1c3RvbUNzcy5wdXNoKCdsaS5saXN0LScrcCsnLXBhZGRpbmdsZWZ0LTN7cGFkZGluZy1sZWZ0OjU1cHh9Jyk7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIGNhc2UgJ2NuMic6DQogICAgICAgICAgICAgICAgICAgIGN1c3RvbUNzcy5wdXNoKCdsaS5saXN0LScrcCsnLXBhZGRpbmdsZWZ0LTF7cGFkZGluZy1sZWZ0OjQwcHh9Jyk7DQogICAgICAgICAgICAgICAgICAgIGN1c3RvbUNzcy5wdXNoKCdsaS5saXN0LScrcCsnLXBhZGRpbmdsZWZ0LTJ7cGFkZGluZy1sZWZ0OjU1cHh9Jyk7DQogICAgICAgICAgICAgICAgICAgIGN1c3RvbUNzcy5wdXNoKCdsaS5saXN0LScrcCsnLXBhZGRpbmdsZWZ0LTN7cGFkZGluZy1sZWZ0OjY4cHh9Jyk7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIGNhc2UgJ251bSc6DQogICAgICAgICAgICAgICAgY2FzZSAnbnVtMSc6DQogICAgICAgICAgICAgICAgICAgIGN1c3RvbUNzcy5wdXNoKCdsaS5saXN0LScrcCsnLXBhZGRpbmdsZWZ0LTF7cGFkZGluZy1sZWZ0OjI1cHh9Jyk7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIGNhc2UgJ251bTInOg0KICAgICAgICAgICAgICAgICAgICBjdXN0b21Dc3MucHVzaCgnbGkubGlzdC0nK3ArJy1wYWRkaW5nbGVmdC0xe3BhZGRpbmctbGVmdDozNXB4fScpOw0KICAgICAgICAgICAgICAgICAgICBjdXN0b21Dc3MucHVzaCgnbGkubGlzdC0nK3ArJy1wYWRkaW5nbGVmdC0ye3BhZGRpbmctbGVmdDo0MHB4fScpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlICdkYXNoJzoNCiAgICAgICAgICAgICAgICAgICAgY3VzdG9tQ3NzLnB1c2goJ2xpLmxpc3QtJytwKyctcGFkZGluZ2xlZnR7cGFkZGluZy1sZWZ0OjM1cHh9Jyk7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIGNhc2UgJ2RvdCc6DQogICAgICAgICAgICAgICAgICAgIGN1c3RvbUNzcy5wdXNoKCdsaS5saXN0LScrcCsnLXBhZGRpbmdsZWZ0e3BhZGRpbmctbGVmdDoyMHB4fScpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGN1c3RvbUNzcy5wdXNoKCcubGlzdC1wYWRkaW5nbGVmdC0xe3BhZGRpbmctbGVmdDowfScpOw0KICAgICAgICBjdXN0b21Dc3MucHVzaCgnLmxpc3QtcGFkZGluZ2xlZnQtMntwYWRkaW5nLWxlZnQ6JyttZS5vcHRpb25zLmxpc3REZWZhdWx0UGFkZGluZ0xlZnQrJ3B4fScpOw0KICAgICAgICBjdXN0b21Dc3MucHVzaCgnLmxpc3QtcGFkZGluZ2xlZnQtM3twYWRkaW5nLWxlZnQ6JyttZS5vcHRpb25zLmxpc3REZWZhdWx0UGFkZGluZ0xlZnQqMisncHh9Jyk7DQogICAgICAgIC8v5aaC5p6c5LiN57uZ5a695bqm5Lya5Zyo6Ieq5a6a5bqU5qC35byP6YeM5Ye6546w5rua5Yqo5p2hDQogICAgICAgIHV0aWxzLmNzc1J1bGUoJ2xpc3QnLCAnb2wsdWx7bWFyZ2luOjA7cGFkaW5nOjA7JysoYnJvd3Nlci5pZSA/ICcnIDogJ3dpZHRoOjk1JScpKyd9bGl7Y2xlYXI6Ym90aDt9JytjdXN0b21Dc3Muam9pbignXG4nKSwgbWUuZG9jdW1lbnQpOw0KICAgIH0pOw0KICAgIC8v5Y2V54us5aSE55CG5Ymq5YiH55qE6Zeu6aKYDQogICAgbWUucmVhZHkoZnVuY3Rpb24oKXsNCiAgICAgICAgZG9tVXRpbHMub24obWUuYm9keSwnY3V0JyxmdW5jdGlvbigpew0KICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpew0KICAgICAgICAgICAgICAgIHZhciBybmcgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKSxsaTsNCiAgICAgICAgICAgICAgICAvL3RyYWNlOjM0MTYNCiAgICAgICAgICAgICAgICBpZighcm5nLmNvbGxhcHNlZCl7DQogICAgICAgICAgICAgICAgICAgIGlmKGxpID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShybmcuc3RhcnRDb250YWluZXIsJ2xpJyx0cnVlKSl7DQogICAgICAgICAgICAgICAgICAgICAgICBpZighbGkubmV4dFNpYmxpbmcgJiYgZG9tVXRpbHMuaXNFbXB0eUJsb2NrKGxpKSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBuID0gbGkucGFyZW50Tm9kZSxub2RlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG5vZGUgPSBwbi5wcmV2aW91c1NpYmxpbmcpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUocG4pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBybmcuc2V0U3RhcnRBdExhc3Qobm9kZSkuY29sbGFwc2UodHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJuZy5zZWxlY3QodHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2UgaWYobm9kZSA9IHBuLm5leHRTaWJsaW5nKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHBuKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm5nLnNldFN0YXJ0QXRGaXJzdChub2RlKS5jb2xsYXBzZSh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm5nLnNlbGVjdCh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRtcE5vZGUgPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLmZpbGxOb2RlKG1lLmRvY3VtZW50LHRtcE5vZGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbi5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0bXBOb2RlLHBuKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHBuKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm5nLnNldFN0YXJ0KHRtcE5vZGUsMCkuY29sbGFwc2UodHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJuZy5zZWxlY3QodHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB9KQ0KICAgICAgICB9KQ0KICAgIH0pOw0KDQogICAgZnVuY3Rpb24gZ2V0U3R5bGUobm9kZSl7DQogICAgICAgIHZhciBjbHMgPSBub2RlLmNsYXNzTmFtZTsNCiAgICAgICAgaWYoZG9tVXRpbHMuaGFzQ2xhc3Mobm9kZSwvY3VzdG9tXy8pKXsNCiAgICAgICAgICAgIHJldHVybiBjbHMubWF0Y2goL2N1c3RvbV8oXHcrKS8pWzFdDQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIGRvbVV0aWxzLmdldFN0eWxlKG5vZGUsICdsaXN0LXN0eWxlLXR5cGUnKQ0KDQogICAgfQ0KDQogICAgbWUuYWRkTGlzdGVuZXIoJ2JlZm9yZXBhc3RlJyxmdW5jdGlvbih0eXBlLGh0bWwpew0KICAgICAgICB2YXIgbWUgPSB0aGlzLA0KICAgICAgICAgICAgcm5nID0gbWUuc2VsZWN0aW9uLmdldFJhbmdlKCksbGk7DQogICAgICAgIHZhciByb290ID0gVUUuaHRtbHBhcnNlcihodG1sLmh0bWwsdHJ1ZSk7DQogICAgICAgIGlmKGxpID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShybmcuc3RhcnRDb250YWluZXIsJ2xpJyx0cnVlKSl7DQogICAgICAgICAgICB2YXIgbGlzdCA9IGxpLnBhcmVudE5vZGUsdGFnTmFtZSA9IGxpc3QudGFnTmFtZSA9PSAnT0wnID8gJ3VsJzonb2wnOw0KICAgICAgICAgICAgdXRpbHMuZWFjaChyb290LmdldE5vZGVzQnlUYWdOYW1lKHRhZ05hbWUpLGZ1bmN0aW9uKG4pew0KICAgICAgICAgICAgICAgIG4udGFnTmFtZSA9IGxpc3QudGFnTmFtZTsNCiAgICAgICAgICAgICAgICBuLnNldEF0dHIoKTsNCiAgICAgICAgICAgICAgICBpZihuLnBhcmVudE5vZGUgPT09IHJvb3Qpew0KICAgICAgICAgICAgICAgICAgICB0eXBlID0gZ2V0U3R5bGUobGlzdCkgfHwgKGxpc3QudGFnTmFtZSA9PSAnT0wnID8gJ2RlY2ltYWwnIDogJ2Rpc2MnKQ0KICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICB2YXIgY2xhc3NOYW1lID0gbi5wYXJlbnROb2RlLmdldEF0dHIoJ2NsYXNzJyk7DQogICAgICAgICAgICAgICAgICAgIGlmKGNsYXNzTmFtZSAmJiAvY3VzdG9tXy8udGVzdChjbGFzc05hbWUpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSBjbGFzc05hbWUubWF0Y2goL2N1c3RvbV8oXHcrKS8pWzFdDQogICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9IG4ucGFyZW50Tm9kZS5nZXRTdHlsZSgnbGlzdC1zdHlsZS10eXBlJyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYoIXR5cGUpew0KICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9IGxpc3QudGFnTmFtZSA9PSAnT0wnID8gJ2RlY2ltYWwnIDogJ2Rpc2MnOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IHV0aWxzLmluZGV4T2YobGlzdFN0eWxlW2xpc3QudGFnTmFtZV0sIHR5cGUpOw0KICAgICAgICAgICAgICAgIGlmKG4ucGFyZW50Tm9kZSAhPT0gcm9vdCkNCiAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBpbmRleCArIDEgPT0gbGlzdFN0eWxlW2xpc3QudGFnTmFtZV0ubGVuZ3RoID8gMCA6IGluZGV4ICsgMTsNCiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFN0eWxlID0gbGlzdFN0eWxlW2xpc3QudGFnTmFtZV1baW5kZXhdOw0KICAgICAgICAgICAgICAgIGlmKGN1c3RvbVN0eWxlW2N1cnJlbnRTdHlsZV0pew0KICAgICAgICAgICAgICAgICAgICBuLnNldEF0dHIoJ2NsYXNzJywgJ2N1c3RvbV8nICsgY3VycmVudFN0eWxlKQ0KDQogICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgIG4uc2V0U3R5bGUoJ2xpc3Qtc3R5bGUtdHlwZScsY3VycmVudFN0eWxlKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pDQoNCiAgICAgICAgfQ0KDQogICAgICAgIGh0bWwuaHRtbCA9IHJvb3QudG9IdG1sKCk7DQogICAgfSk7DQogICAgLy/ov5vlhaXnvJbovpHlmajnmoRsaeimgeWll3DmoIfnrb4NCiAgICBtZS5hZGRJbnB1dFJ1bGUoZnVuY3Rpb24ocm9vdCl7DQogICAgICAgIHV0aWxzLmVhY2gocm9vdC5nZXROb2Rlc0J5VGFnTmFtZSgnbGknKSxmdW5jdGlvbihsaSl7DQogICAgICAgICAgICB2YXIgdG1wUCA9IFVFLnVOb2RlLmNyZWF0ZUVsZW1lbnQoJ3AnKTsNCiAgICAgICAgICAgIGZvcih2YXIgaT0gMCxjaTtjaT1saS5jaGlsZHJlbltpXTspew0KICAgICAgICAgICAgICAgIGlmKGNpLnR5cGUgPT0gJ3RleHQnIHx8IGR0ZC5wW2NpLnRhZ05hbWVdKXsNCiAgICAgICAgICAgICAgICAgICAgdG1wUC5hcHBlbmRDaGlsZChjaSk7DQogICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgIGlmKHRtcFAuZmlyc3RDaGlsZCgpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxpLmluc2VydEJlZm9yZSh0bXBQLGNpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRtcFAgPSBVRS51Tm9kZS5jcmVhdGVFbGVtZW50KCdwJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpID0gaSArIDI7DQogICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgaSsrOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZih0bXBQLmZpcnN0Q2hpbGQoKSAmJiAhdG1wUC5wYXJlbnROb2RlIHx8ICFsaS5maXJzdENoaWxkKCkpew0KICAgICAgICAgICAgICAgIGxpLmFwcGVuZENoaWxkKHRtcFApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy90cmFjZTozMzU3DQogICAgICAgICAgICAvL3DkuI3og73kuLrnqboNCiAgICAgICAgICAgIGlmICghdG1wUC5maXJzdENoaWxkKCkpIHsNCiAgICAgICAgICAgICAgICB0bXBQLmlubmVySFRNTChicm93c2VyLmllID8gJyZuYnNwOycgOiAnPGJyLz4nKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy/ljrvmjonmnKvlsL7nmoTnqbrnmb0NCiAgICAgICAgICAgIHZhciBwID0gbGkuZmlyc3RDaGlsZCgpOw0KICAgICAgICAgICAgdmFyIGxhc3RDaGlsZCA9IHAubGFzdENoaWxkKCk7DQogICAgICAgICAgICBpZihsYXN0Q2hpbGQgJiYgbGFzdENoaWxkLnR5cGUgPT0gJ3RleHQnICYmIC9eXHMqJC8udGVzdChsYXN0Q2hpbGQuZGF0YSkpew0KICAgICAgICAgICAgICAgIHAucmVtb3ZlQ2hpbGQobGFzdENoaWxkKQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgICAgdmFyIG9yZGVybGlzdHR5cGUgPSB7DQogICAgICAgICAgICAgICAgJ251bTEnOi9eXGQrXCkvLA0KICAgICAgICAgICAgICAgICdkZWNpbWFsJzovXlxkK1wuLywNCiAgICAgICAgICAgICAgICAnbG93ZXItYWxwaGEnOi9eW2Etel0rXCkvLA0KICAgICAgICAgICAgICAgICd1cHBlci1hbHBoYSc6L15bQS1aXStcLi8sDQogICAgICAgICAgICAgICAgJ2NuJzovXltcdTRFMDBcdTRFOENcdTRFMDlcdTU2REJcdTUxNmRcdTRlOTRcdTRlMDNcdTUxNmJcdTRlNWRdK1tcdTMwMDFdLywNCiAgICAgICAgICAgICAgICAnY24yJzovXlwoW1x1NEUwMFx1NEU4Q1x1NEUwOVx1NTZEQlx1NTE2ZFx1NGU5NFx1NGUwM1x1NTE2Ylx1NGU1ZF0rXCkvDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgdW5vcmRlcmxpc3R0eXBlID0gew0KICAgICAgICAgICAgICAgICdzcXVhcmUnOiduJw0KICAgICAgICAgICAgfTsNCiAgICAgICAgZnVuY3Rpb24gY2hlY2tMaXN0VHlwZShjb250ZW50LGNvbnRhaW5lcil7DQogICAgICAgICAgICB2YXIgc3BhbiA9IGNvbnRhaW5lci5maXJzdENoaWxkKCk7DQogICAgICAgICAgICBpZihzcGFuICYmICBzcGFuLnR5cGUgPT0gJ2VsZW1lbnQnICYmIHNwYW4udGFnTmFtZSA9PSAnc3BhbicgJiYgL1dpbmdkaW5nc3xTeW1ib2wvLnRlc3Qoc3Bhbi5nZXRTdHlsZSgnZm9udC1mYW1pbHknKSkpew0KICAgICAgICAgICAgICAgIGZvcih2YXIgcCBpbiB1bm9yZGVybGlzdHR5cGUpew0KICAgICAgICAgICAgICAgICAgICBpZih1bm9yZGVybGlzdHR5cGVbcF0gPT0gc3Bhbi5kYXRhKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuICdkaXNjJw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZm9yKHZhciBwIGluIG9yZGVybGlzdHR5cGUpew0KICAgICAgICAgICAgICAgIGlmKG9yZGVybGlzdHR5cGVbcF0udGVzdChjb250ZW50KSl7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBwOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9DQogICAgICAgIHV0aWxzLmVhY2gocm9vdC5nZXROb2Rlc0J5VGFnTmFtZSgncCcpLGZ1bmN0aW9uKG5vZGUpew0KICAgICAgICAgICAgaWYobm9kZS5nZXRBdHRyKCdjbGFzcycpICE9ICdNc29MaXN0UGFyYWdyYXBoJyl7DQogICAgICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vd29yZOeymOi0tOi/h+adpeeahOS8muW4puaciW1hcmdpbuimgeWOu+aOiSzkvYbov5nmoLfkuZ/lj6/og73kvJror6/lkb3kuK3kuIDkupvlpK7op4YNCiAgICAgICAgICAgIG5vZGUuc2V0U3R5bGUoJ21hcmdpbicsJycpOw0KICAgICAgICAgICAgbm9kZS5zZXRTdHlsZSgnbWFyZ2luLWxlZnQnLCcnKTsNCiAgICAgICAgICAgIG5vZGUuc2V0QXR0cignY2xhc3MnLCcnKTsNCg0KICAgICAgICAgICAgZnVuY3Rpb24gYXBwZW5kTGkobGlzdCxwLHR5cGUpew0KICAgICAgICAgICAgICAgIGlmKGxpc3QudGFnTmFtZSA9PSAnb2wnKXsNCiAgICAgICAgICAgICAgICAgICAgaWYoYnJvd3Nlci5pZSl7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlyc3QgPSBwLmZpcnN0Q2hpbGQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGZpcnN0LnR5cGUgPT0nZWxlbWVudCcgJiYgZmlyc3QudGFnTmFtZSA9PSAnc3BhbicgJiYgb3JkZXJsaXN0dHlwZVt0eXBlXS50ZXN0KGZpcnN0LmlubmVyVGV4dCgpKSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5yZW1vdmVDaGlsZChmaXJzdCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgcC5pbm5lckhUTUwocC5pbm5lckhUTUwoKS5yZXBsYWNlKG9yZGVybGlzdHR5cGVbdHlwZV0sJycpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICBwLnJlbW92ZUNoaWxkKHAuZmlyc3RDaGlsZCgpKQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHZhciBsaSA9IFVFLnVOb2RlLmNyZWF0ZUVsZW1lbnQoJ2xpJyk7DQogICAgICAgICAgICAgICAgbGkuYXBwZW5kQ2hpbGQocCk7DQogICAgICAgICAgICAgICAgbGlzdC5hcHBlbmRDaGlsZChsaSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB2YXIgdG1wID0gbm9kZSx0eXBlLGNhY2hlTm9kZSA9IG5vZGU7DQoNCiAgICAgICAgICAgIGlmKG5vZGUucGFyZW50Tm9kZS50YWdOYW1lICE9ICdsaScgJiYgKHR5cGUgPSBjaGVja0xpc3RUeXBlKG5vZGUuaW5uZXJUZXh0KCksbm9kZSkpKXsNCg0KICAgICAgICAgICAgICAgIHZhciBsaXN0ID0gVUUudU5vZGUuY3JlYXRlRWxlbWVudChtZS5vcHRpb25zLmluc2VydG9yZGVyZWRsaXN0Lmhhc093blByb3BlcnR5KHR5cGUpID8gJ29sJyA6ICd1bCcpOw0KICAgICAgICAgICAgICAgIGlmKGN1c3RvbVN0eWxlW3R5cGVdKXsNCiAgICAgICAgICAgICAgICAgICAgbGlzdC5zZXRBdHRyKCdjbGFzcycsJ2N1c3RvbV8nK3R5cGUpDQogICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgIGxpc3Quc2V0U3R5bGUoJ2xpc3Qtc3R5bGUtdHlwZScsdHlwZSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgd2hpbGUobm9kZSAmJiBub2RlLnBhcmVudE5vZGUudGFnTmFtZSAhPSAnbGknICYmIGNoZWNrTGlzdFR5cGUobm9kZS5pbm5lclRleHQoKSxub2RlKSl7DQogICAgICAgICAgICAgICAgICAgIHRtcCA9IG5vZGUubmV4dFNpYmxpbmcoKTsNCiAgICAgICAgICAgICAgICAgICAgaWYoIXRtcCl7DQogICAgICAgICAgICAgICAgICAgICAgICBub2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGxpc3Qsbm9kZSkNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBhcHBlbmRMaShsaXN0LG5vZGUsdHlwZSk7DQogICAgICAgICAgICAgICAgICAgIG5vZGUgPSB0bXA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmKCFsaXN0LnBhcmVudE5vZGUgJiYgbm9kZSAmJiBub2RlLnBhcmVudE5vZGUpew0KICAgICAgICAgICAgICAgICAgICBub2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGxpc3Qsbm9kZSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICB2YXIgc3BhbiA9IGNhY2hlTm9kZS5maXJzdENoaWxkKCk7DQogICAgICAgICAgICBpZihzcGFuICYmIHNwYW4udHlwZSA9PSAnZWxlbWVudCcgJiYgc3Bhbi50YWdOYW1lID09ICdzcGFuJyAmJiAvXlxzKigmbmJzcDspK1xzKiQvLnRlc3Qoc3Bhbi5pbm5lclRleHQoKSkpew0KICAgICAgICAgICAgICAgIHNwYW4ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzcGFuKQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9KQ0KICAgIH0pOw0KDQogICAgLy/osIPmlbTntKLlvJXmoIfnrb4NCiAgICBtZS5hZGRMaXN0ZW5lcignY29udGVudGNoYW5nZScsZnVuY3Rpb24oKXsNCiAgICAgICAgYWRqdXN0TGlzdFN0eWxlKG1lLmRvY3VtZW50KQ0KICAgIH0pOw0KDQogICAgZnVuY3Rpb24gYWRqdXN0TGlzdFN0eWxlKGRvYyxpZ25vcmUpew0KICAgICAgICB1dGlscy5lYWNoKGRvbVV0aWxzLmdldEVsZW1lbnRzQnlUYWdOYW1lKGRvYywnb2wgdWwnKSxmdW5jdGlvbihub2RlKXsNCg0KICAgICAgICAgICAgaWYoIWRvbVV0aWxzLmluRG9jKG5vZGUsZG9jKSkNCiAgICAgICAgICAgICAgICByZXR1cm47DQoNCiAgICAgICAgICAgIHZhciBwYXJlbnQgPSBub2RlLnBhcmVudE5vZGU7DQogICAgICAgICAgICBpZihwYXJlbnQudGFnTmFtZSA9PSBub2RlLnRhZ05hbWUpew0KICAgICAgICAgICAgICAgIHZhciBub2RlU3R5bGVUeXBlID0gZ2V0U3R5bGUobm9kZSkgfHwgKG5vZGUudGFnTmFtZSA9PSAnT0wnID8gJ2RlY2ltYWwnIDogJ2Rpc2MnKSwNCiAgICAgICAgICAgICAgICAgICAgcGFyZW50U3R5bGVUeXBlID0gZ2V0U3R5bGUocGFyZW50KSB8fCAocGFyZW50LnRhZ05hbWUgPT0gJ09MJyA/ICdkZWNpbWFsJyA6ICdkaXNjJyk7DQogICAgICAgICAgICAgICAgaWYobm9kZVN0eWxlVHlwZSA9PSBwYXJlbnRTdHlsZVR5cGUpew0KICAgICAgICAgICAgICAgICAgICB2YXIgc3R5bGVJbmRleCA9IHV0aWxzLmluZGV4T2YobGlzdFN0eWxlW25vZGUudGFnTmFtZV0sIG5vZGVTdHlsZVR5cGUpOw0KICAgICAgICAgICAgICAgICAgICBzdHlsZUluZGV4ID0gc3R5bGVJbmRleCArIDEgPT0gbGlzdFN0eWxlW25vZGUudGFnTmFtZV0ubGVuZ3RoID8gMCA6IHN0eWxlSW5kZXggKyAxOw0KICAgICAgICAgICAgICAgICAgICBzZXRMaXN0U3R5bGUobm9kZSxsaXN0U3R5bGVbbm9kZS50YWdOYW1lXVtzdHlsZUluZGV4XSkNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZhciBpbmRleCA9IDAsdHlwZSA9IDI7DQogICAgICAgICAgICBpZiggZG9tVXRpbHMuaGFzQ2xhc3Mobm9kZSwvY3VzdG9tXy8pKXsNCiAgICAgICAgICAgICAgICBpZighKC9bb3VdbC9pLnRlc3QocGFyZW50LnRhZ05hbWUpICYmIGRvbVV0aWxzLmhhc0NsYXNzKHBhcmVudCwvY3VzdG9tXy8pKSl7DQogICAgICAgICAgICAgICAgICAgIHR5cGUgPSAxOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgIGlmKC9bb3VdbC9pLnRlc3QocGFyZW50LnRhZ05hbWUpICYmIGRvbVV0aWxzLmhhc0NsYXNzKHBhcmVudCwvY3VzdG9tXy8pKXsNCiAgICAgICAgICAgICAgICAgICAgdHlwZSA9IDM7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB2YXIgc3R5bGUgPSBkb21VdGlscy5nZXRTdHlsZShub2RlLCAnbGlzdC1zdHlsZS10eXBlJyk7DQogICAgICAgICAgICBzdHlsZSAmJiAobm9kZS5zdHlsZS5jc3NUZXh0ID0gJ2xpc3Qtc3R5bGUtdHlwZTonICsgc3R5bGUpOw0KICAgICAgICAgICAgbm9kZS5jbGFzc05hbWUgPSB1dGlscy50cmltKG5vZGUuY2xhc3NOYW1lLnJlcGxhY2UoL2xpc3QtcGFkZGluZ2xlZnQtXHcrLywnJykpICsgJyBsaXN0LXBhZGRpbmdsZWZ0LScgKyB0eXBlOw0KICAgICAgICAgICAgdXRpbHMuZWFjaChkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZShub2RlLCdsaScpLGZ1bmN0aW9uKGxpKXsNCiAgICAgICAgICAgICAgICBsaS5zdHlsZS5jc3NUZXh0ICYmIChsaS5zdHlsZS5jc3NUZXh0ID0gJycpOw0KICAgICAgICAgICAgICAgIGlmKCFsaS5maXJzdENoaWxkKXsNCiAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKGxpKTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZihsaS5wYXJlbnROb2RlICE9PSBub2RlKXsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpbmRleCsrOw0KICAgICAgICAgICAgICAgIGlmKGRvbVV0aWxzLmhhc0NsYXNzKG5vZGUsL2N1c3RvbV8vKSApew0KICAgICAgICAgICAgICAgICAgICB2YXIgcGFkZGluZ0xlZnQgPSAxLGN1cnJlbnRTdHlsZSA9IGdldFN0eWxlKG5vZGUpOw0KICAgICAgICAgICAgICAgICAgICBpZihub2RlLnRhZ05hbWUgPT0gJ09MJyl7DQogICAgICAgICAgICAgICAgICAgICAgICBpZihjdXJyZW50U3R5bGUpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChjdXJyZW50U3R5bGUpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdjbicgOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdjbjEnOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdjbjInOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5kZXggPiAxMCAmJiAoaW5kZXggJSAxMCA9PSAwIHx8IGluZGV4ID4gMTAgJiYgaW5kZXggPCAyMCkpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmdMZWZ0ID0gMg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2UgaWYoaW5kZXggPiAyMCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZ0xlZnQgPSAzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbnVtMicgOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5kZXggPiA5KXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nTGVmdCA9IDINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBsaS5jbGFzc05hbWUgPSAnbGlzdC0nK2N1c3RvbVN0eWxlW2N1cnJlbnRTdHlsZV0rIGluZGV4ICsgJyAnICsgJ2xpc3QtJytjdXJyZW50U3R5bGUrJy1wYWRkaW5nbGVmdC0nICsgcGFkZGluZ0xlZnQ7DQogICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgbGkuY2xhc3NOYW1lID0gJ2xpc3QtJytjdXN0b21TdHlsZVtjdXJyZW50U3R5bGVdICArICcgJyArICdsaXN0LScrY3VycmVudFN0eWxlKyctcGFkZGluZ2xlZnQnOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgIGxpLmNsYXNzTmFtZSA9IGxpLmNsYXNzTmFtZS5yZXBsYWNlKC9saXN0LVtcd1wtXSsvZ2ksJycpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB2YXIgY2xhc3NOYW1lID0gbGkuZ2V0QXR0cmlidXRlKCdjbGFzcycpOw0KICAgICAgICAgICAgICAgIGlmKGNsYXNzTmFtZSAhPT0gbnVsbCAmJiAhY2xhc3NOYW1lLnJlcGxhY2UoL1xzL2csJycpKXsNCiAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlQXR0cmlidXRlcyhsaSwnY2xhc3MnKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgIWlnbm9yZSAmJiBhZGp1c3RMaXN0KG5vZGUsbm9kZS50YWdOYW1lLnRvTG93ZXJDYXNlKCksZ2V0U3R5bGUobm9kZSl8fGRvbVV0aWxzLmdldFN0eWxlKG5vZGUsICdsaXN0LXN0eWxlLXR5cGUnKSx0cnVlKTsNCiAgICAgICAgfSkNCiAgICB9DQogICAgZnVuY3Rpb24gYWRqdXN0TGlzdChsaXN0LCB0YWcsIHN0eWxlLGlnbm9yZUVtcHR5KSB7DQogICAgICAgIHZhciBuZXh0TGlzdCA9IGxpc3QubmV4dFNpYmxpbmc7DQogICAgICAgIGlmIChuZXh0TGlzdCAmJiBuZXh0TGlzdC5ub2RlVHlwZSA9PSAxICYmIG5leHRMaXN0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PSB0YWcgJiYgKGdldFN0eWxlKG5leHRMaXN0KSB8fCBkb21VdGlscy5nZXRTdHlsZShuZXh0TGlzdCwgJ2xpc3Qtc3R5bGUtdHlwZScpIHx8ICh0YWcgPT0gJ29sJyA/ICdkZWNpbWFsJyA6ICdkaXNjJykpID09IHN0eWxlKSB7DQogICAgICAgICAgICBkb21VdGlscy5tb3ZlQ2hpbGQobmV4dExpc3QsIGxpc3QpOw0KICAgICAgICAgICAgaWYgKG5leHRMaXN0LmNoaWxkTm9kZXMubGVuZ3RoID09IDApIHsNCiAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUobmV4dExpc3QpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmKG5leHRMaXN0ICYmIGRvbVV0aWxzLmlzRmlsbENoYXIobmV4dExpc3QpKXsNCiAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShuZXh0TGlzdCk7DQogICAgICAgIH0NCiAgICAgICAgdmFyIHByZUxpc3QgPSBsaXN0LnByZXZpb3VzU2libGluZzsNCiAgICAgICAgaWYgKHByZUxpc3QgJiYgcHJlTGlzdC5ub2RlVHlwZSA9PSAxICYmIHByZUxpc3QudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09IHRhZyAmJiAoZ2V0U3R5bGUocHJlTGlzdCkgfHwgZG9tVXRpbHMuZ2V0U3R5bGUocHJlTGlzdCwgJ2xpc3Qtc3R5bGUtdHlwZScpIHx8ICh0YWcgPT0gJ29sJyA/ICdkZWNpbWFsJyA6ICdkaXNjJykpID09IHN0eWxlKSB7DQogICAgICAgICAgICBkb21VdGlscy5tb3ZlQ2hpbGQobGlzdCwgcHJlTGlzdCk7DQogICAgICAgIH0NCiAgICAgICAgaWYocHJlTGlzdCAmJiBkb21VdGlscy5pc0ZpbGxDaGFyKHByZUxpc3QpKXsNCiAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShwcmVMaXN0KTsNCiAgICAgICAgfQ0KICAgICAgICAhaWdub3JlRW1wdHkgJiYgZG9tVXRpbHMuaXNFbXB0eUJsb2NrKGxpc3QpICYmIGRvbVV0aWxzLnJlbW92ZShsaXN0KTsNCiAgICAgICAgaWYoZ2V0U3R5bGUobGlzdCkpew0KICAgICAgICAgICAgYWRqdXN0TGlzdFN0eWxlKGxpc3Qub3duZXJEb2N1bWVudCx0cnVlKQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2V0TGlzdFN0eWxlKGxpc3Qsc3R5bGUpew0KICAgICAgICBpZihjdXN0b21TdHlsZVtzdHlsZV0pew0KICAgICAgICAgICAgbGlzdC5jbGFzc05hbWUgPSAnY3VzdG9tXycgKyBzdHlsZTsNCiAgICAgICAgfQ0KICAgICAgICB0cnl7DQogICAgICAgICAgICBkb21VdGlscy5zZXRTdHlsZShsaXN0LCAnbGlzdC1zdHlsZS10eXBlJywgc3R5bGUpOw0KICAgICAgICB9Y2F0Y2goZSl7fQ0KICAgIH0NCiAgICBmdW5jdGlvbiBjbGVhckVtcHR5U2libGluZyhub2RlKSB7DQogICAgICAgIHZhciB0bXBOb2RlID0gbm9kZS5wcmV2aW91c1NpYmxpbmc7DQogICAgICAgIGlmICh0bXBOb2RlICYmIGRvbVV0aWxzLmlzRW1wdHlCbG9jayh0bXBOb2RlKSkgew0KICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHRtcE5vZGUpOw0KICAgICAgICB9DQogICAgICAgIHRtcE5vZGUgPSBub2RlLm5leHRTaWJsaW5nOw0KICAgICAgICBpZiAodG1wTm9kZSAmJiBkb21VdGlscy5pc0VtcHR5QmxvY2sodG1wTm9kZSkpIHsNCiAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZSh0bXBOb2RlKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIG1lLmFkZExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24gKHR5cGUsIGV2dCkgew0KICAgICAgICBmdW5jdGlvbiBwcmV2ZW50QW5kU2F2ZSgpIHsNCiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCA/IGV2dC5wcmV2ZW50RGVmYXVsdCgpIDogKGV2dC5yZXR1cm5WYWx1ZSA9IGZhbHNlKTsNCiAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnY29udGVudGNoYW5nZScpOw0KICAgICAgICAgICAgbWUudW5kb01hbmdlciAmJiBtZS51bmRvTWFuZ2VyLnNhdmUoKTsNCiAgICAgICAgfQ0KICAgICAgICBmdW5jdGlvbiBmaW5kTGlzdChub2RlLGZpbHRlckZuKXsNCiAgICAgICAgICAgIHdoaWxlKG5vZGUgJiYgIWRvbVV0aWxzLmlzQm9keShub2RlKSl7DQogICAgICAgICAgICAgICAgaWYoZmlsdGVyRm4obm9kZSkpew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZihub2RlLm5vZGVUeXBlID09IDEgJiYgL1tvdV1sL2kudGVzdChub2RlLnRhZ05hbWUpKXsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLnBhcmVudE5vZGU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgfQ0KICAgICAgICB2YXIga2V5Q29kZSA9IGV2dC5rZXlDb2RlIHx8IGV2dC53aGljaDsNCiAgICAgICAgaWYgKGtleUNvZGUgPT0gMTMgJiYgIWV2dC5zaGlmdEtleSkgey8v5Zue6L2mDQogICAgICAgICAgICB2YXIgcm5nID0gbWUuc2VsZWN0aW9uLmdldFJhbmdlKCksDQogICAgICAgICAgICAgICAgcGFyZW50ID0gZG9tVXRpbHMuZmluZFBhcmVudChybmcuc3RhcnRDb250YWluZXIsZnVuY3Rpb24obm9kZSl7cmV0dXJuIGRvbVV0aWxzLmlzQmxvY2tFbG0obm9kZSl9LHRydWUpLA0KICAgICAgICAgICAgICAgIGxpID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShybmcuc3RhcnRDb250YWluZXIsJ2xpJyx0cnVlKTsNCiAgICAgICAgICAgIGlmKHBhcmVudCAmJiBwYXJlbnQudGFnTmFtZSAhPSAnUFJFJyAmJiAhbGkpew0KICAgICAgICAgICAgICAgIHZhciBodG1sID0gcGFyZW50LmlubmVySFRNTC5yZXBsYWNlKG5ldyBSZWdFeHAoZG9tVXRpbHMuZmlsbENoYXIsICdnJyksJycpOw0KICAgICAgICAgICAgICAgIGlmKC9eXHMqMVxzKlwuW15cZF0vLnRlc3QoaHRtbCkpew0KICAgICAgICAgICAgICAgICAgICBwYXJlbnQuaW5uZXJIVE1MID0gaHRtbC5yZXBsYWNlKC9eXHMqMVxzKlwuLywnJyk7DQogICAgICAgICAgICAgICAgICAgIHJuZy5zZXRTdGFydEF0TGFzdChwYXJlbnQpLmNvbGxhcHNlKHRydWUpLnNlbGVjdCgpOw0KICAgICAgICAgICAgICAgICAgICBtZS5fX2hhc0VudGVyRXhlY0NvbW1hbmQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICBtZS5leGVjQ29tbWFuZCgnaW5zZXJ0b3JkZXJlZGxpc3QnKTsNCiAgICAgICAgICAgICAgICAgICAgbWUuX19oYXNFbnRlckV4ZWNDb21tYW5kID0gZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdmFyIHJhbmdlID0gbWUuc2VsZWN0aW9uLmdldFJhbmdlKCksDQogICAgICAgICAgICAgICAgc3RhcnQgPSBmaW5kTGlzdChyYW5nZS5zdGFydENvbnRhaW5lcixmdW5jdGlvbiAobm9kZSkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gbm9kZS50YWdOYW1lID09ICdUQUJMRSc7DQogICAgICAgICAgICAgICAgfSksDQogICAgICAgICAgICAgICAgZW5kID0gcmFuZ2UuY29sbGFwc2VkID8gc3RhcnQgOiBmaW5kTGlzdChyYW5nZS5lbmRDb250YWluZXIsZnVuY3Rpb24gKG5vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGUudGFnTmFtZSA9PSAnVEFCTEUnOw0KICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBpZiAoc3RhcnQgJiYgZW5kICYmIHN0YXJ0ID09PSBlbmQpIHsNCg0KICAgICAgICAgICAgICAgIGlmICghcmFuZ2UuY29sbGFwc2VkKSB7DQogICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShyYW5nZS5zdGFydENvbnRhaW5lciwgJ2xpJywgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIGVuZCA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUocmFuZ2UuZW5kQ29udGFpbmVyLCAnbGknLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0ICYmIGVuZCAmJiBzdGFydCA9PT0gZW5kKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5kZWxldGVDb250ZW50cygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbGkgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKHJhbmdlLnN0YXJ0Q29udGFpbmVyLCAnbGknLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaSAmJiBkb21VdGlscy5pc0VtcHR5QmxvY2sobGkpKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmUgPSBsaS5wcmV2aW91c1NpYmxpbmc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dCA9IGxpLm5leHRTaWJsaW5nOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5maWxsTm9kZShtZS5kb2N1bWVudCwgcCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50TGlzdCA9IGxpLnBhcmVudE5vZGU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByZSAmJiBuZXh0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KG5leHQsIDApLmNvbGxhcHNlKHRydWUpLnNlbGVjdCh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKGxpKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcHJlICYmICFuZXh0IHx8ICFwcmUpIHsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50TGlzdC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShwLCBwYXJlbnRMaXN0KTsNCg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaS5wYXJlbnROb2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHAsIHBhcmVudExpc3QubmV4dFNpYmxpbmcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShsaSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcGFyZW50TGlzdC5maXJzdENoaWxkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUocGFyZW50TGlzdCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQocCwgMCkuc2V0Q3Vyc29yKCk7DQoNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2ZW50QW5kU2F2ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRtcFJhbmdlID0gcmFuZ2UuY2xvbmVSYW5nZSgpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJrID0gdG1wUmFuZ2UuY29sbGFwc2UoZmFsc2UpLmNyZWF0ZUJvb2ttYXJrKCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLmRlbGV0ZUNvbnRlbnRzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0bXBSYW5nZS5tb3ZlVG9Cb29rbWFyayhiayk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGkgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKHRtcFJhbmdlLnN0YXJ0Q29udGFpbmVyLCAnbGknLCB0cnVlKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJFbXB0eVNpYmxpbmcobGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG1wUmFuZ2Uuc2VsZWN0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBwcmV2ZW50QW5kU2F2ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgICAgICBsaSA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUocmFuZ2Uuc3RhcnRDb250YWluZXIsICdsaScsIHRydWUpOw0KDQogICAgICAgICAgICAgICAgaWYgKGxpKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChkb21VdGlscy5pc0VtcHR5QmxvY2sobGkpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiayA9IHJhbmdlLmNyZWF0ZUJvb2ttYXJrKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50TGlzdCA9IGxpLnBhcmVudE5vZGU7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAobGkgIT09IHBhcmVudExpc3QubGFzdENoaWxkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMuYnJlYWtQYXJlbnQobGksIHBhcmVudExpc3QpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyRW1wdHlTaWJsaW5nKGxpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnRMaXN0LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGxpLCBwYXJlbnRMaXN0Lm5leHRTaWJsaW5nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9tVXRpbHMuaXNFbXB0eU5vZGUocGFyZW50TGlzdCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHBhcmVudExpc3QpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIC8v5bWM5aWX5LiN5aSE55CGDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWR0ZC4kbGlzdFtsaS5wYXJlbnROb2RlLnRhZ05hbWVdKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRvbVV0aWxzLmlzQmxvY2tFbG0obGkuZmlyc3RDaGlsZCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcCA9IG1lLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGkucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUocCwgbGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAobGkuZmlyc3RDaGlsZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5hcHBlbmRDaGlsZChsaS5maXJzdENoaWxkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUobGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShsaSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2UubW92ZVRvQm9va21hcmsoYmspLnNlbGVjdCgpOw0KDQoNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaXJzdCA9IGxpLmZpcnN0Q2hpbGQ7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWZpcnN0IHx8ICFkb21VdGlscy5pc0Jsb2NrRWxtKGZpcnN0KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwID0gbWUuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIWxpLmZpcnN0Q2hpbGQgJiYgZG9tVXRpbHMuZmlsbE5vZGUobWUuZG9jdW1lbnQsIHApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChsaS5maXJzdENoaWxkKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5hcHBlbmRDaGlsZChsaS5maXJzdENoaWxkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGkuYXBwZW5kQ2hpbGQocCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3QgPSBwOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3BhbiA9IG1lLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2UuaW5zZXJ0Tm9kZShzcGFuKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLmJyZWFrUGFyZW50KHNwYW4sIGxpKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5leHRMaSA9IHNwYW4ubmV4dFNpYmxpbmc7DQogICAgICAgICAgICAgICAgICAgICAgICBmaXJzdCA9IG5leHRMaS5maXJzdENoaWxkOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWZpcnN0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcCA9IG1lLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLmZpbGxOb2RlKG1lLmRvY3VtZW50LCBwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0TGkuYXBwZW5kQ2hpbGQocCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3QgPSBwOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvbVV0aWxzLmlzRW1wdHlOb2RlKGZpcnN0KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0LmlubmVySFRNTCA9ICcnOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLmZpbGxOb2RlKG1lLmRvY3VtZW50LCBmaXJzdCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KGZpcnN0LCAwKS5jb2xsYXBzZSh0cnVlKS5zaHJpbmtCb3VuZGFyeSgpLnNlbGVjdCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHNwYW4pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByZSA9IG5leHRMaS5wcmV2aW91c1NpYmxpbmc7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJlICYmIGRvbVV0aWxzLmlzRW1wdHlCbG9jayhwcmUpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlLmlubmVySFRNTCA9ICc8cD48L3A+JzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5maWxsTm9kZShtZS5kb2N1bWVudCwgcHJlLmZpcnN0Q2hpbGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIH0NCi8vICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBwcmV2ZW50QW5kU2F2ZSgpOw0KICAgICAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICB9DQoNCg0KICAgICAgICB9DQogICAgICAgIGlmIChrZXlDb2RlID09IDgpIHsNCiAgICAgICAgICAgIC8v5L+u5LitaWXkuK1saeS4i+eahOmXrumimA0KICAgICAgICAgICAgcmFuZ2UgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKTsNCiAgICAgICAgICAgIGlmIChyYW5nZS5jb2xsYXBzZWQgJiYgZG9tVXRpbHMuaXNTdGFydEluYmxvY2socmFuZ2UpKSB7DQogICAgICAgICAgICAgICAgdG1wUmFuZ2UgPSByYW5nZS5jbG9uZVJhbmdlKCkudHJpbUJvdW5kYXJ5KCk7DQogICAgICAgICAgICAgICAgbGkgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKHJhbmdlLnN0YXJ0Q29udGFpbmVyLCAnbGknLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAvL+imgeWcqGxp55qE5pyA5bem6L6577yM5omN6IO95aSE55CGDQogICAgICAgICAgICAgICAgaWYgKGxpICYmIGRvbVV0aWxzLmlzU3RhcnRJbmJsb2NrKHRtcFJhbmdlKSkgew0KICAgICAgICAgICAgICAgICAgICBzdGFydCA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUocmFuZ2Uuc3RhcnRDb250YWluZXIsICdwJywgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIGlmIChzdGFydCAmJiBzdGFydCAhPT0gbGkuZmlyc3RDaGlsZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudExpc3QgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKHN0YXJ0LFsnb2wnLCd1bCddKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLmJyZWFrUGFyZW50KHN0YXJ0LHBhcmVudExpc3QpOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJFbXB0eVNpYmxpbmcoc3RhcnQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCdjb250ZW50Y2hhbmdlJyk7DQogICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydChzdGFydCwwKS5zZXRDdXJzb3IoZmFsc2UsdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBtZS5maXJlRXZlbnQoJ3NhdmVTY2VuZScpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucHJldmVudERlZmF1bHQoZXZ0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGlmIChsaSAmJiAocHJlID0gbGkucHJldmlvdXNTaWJsaW5nKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGtleUNvZGUgPT0gNDYgJiYgbGkuY2hpbGROb2Rlcy5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAvL+acieWPr+iDveS4iui+ueeahOWFhOW8n+iKgueCueaYr+S4qjLnuqfoj5zljZXvvIzopoHov73liqDliLAy57qn6I+c5Y2V55qE5pyA5ZCO55qEbGkNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkdGQuJGxpc3RbcHJlLnRhZ05hbWVdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlID0gcHJlLmxhc3RDaGlsZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIG1lLnVuZG9NYW5nZXIgJiYgbWUudW5kb01hbmdlci5zYXZlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBmaXJzdCA9IGxpLmZpcnN0Q2hpbGQ7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9tVXRpbHMuaXNCbG9ja0VsbShmaXJzdCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9tVXRpbHMuaXNFbXB0eU5vZGUoZmlyc3QpKSB7DQovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldEVuZChwcmUsIHByZS5jaGlsZE5vZGVzLmxlbmd0aCkuc2hyaW5rQm91bmRhcnkoKS5jb2xsYXBzZSgpLnNlbGVjdCh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlLmFwcGVuZENoaWxkKGZpcnN0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQoZmlyc3QsIDApLnNldEN1cnNvcihmYWxzZSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vZmlyc3TkuI3mmK/llK/kuIDnmoToioLngrkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGxpLmZpcnN0Q2hpbGQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZS5hcHBlbmRDaGlsZChsaS5maXJzdENoaWxkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BhbiA9IG1lLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2UuaW5zZXJ0Tm9kZShzcGFuKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/liKTmlq1wcmXmmK/lkKbmmK/nqbrnmoToioLngrks5aaC5p6c5pivPHA+PGJyLz48L3A+57G75Z6L55qE56m66IqC54K577yM5bmy5o6JcOagh+etvumYsuatouWug+WNoOS9jQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9tVXRpbHMuaXNFbXB0eUJsb2NrKHByZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZS5pbm5lckhUTUwgPSAnJzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5tb3ZlQ2hpbGQobGksIHByZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0QmVmb3JlKHNwYW4pLmNvbGxhcHNlKHRydWUpLnNlbGVjdCh0cnVlKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUoc3Bhbik7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb21VdGlscy5pc0VtcHR5Tm9kZShsaSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZS5hcHBlbmRDaGlsZChwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQocCwgMCkuc2V0Q3Vyc29yKCk7DQovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldEVuZChwcmUsIHByZS5jaGlsZE5vZGVzLmxlbmd0aCkuc2hyaW5rQm91bmRhcnkoKS5jb2xsYXBzZSgpLnNlbGVjdCh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRFbmQocHJlLCBwcmUuY2hpbGROb2Rlcy5sZW5ndGgpLmNvbGxhcHNlKCkuc2VsZWN0KHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAobGkuZmlyc3RDaGlsZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlLmFwcGVuZENoaWxkKGxpLmZpcnN0Q2hpbGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKGxpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnY29udGVudGNoYW5nZScpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCdzYXZlU2NlbmUnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnByZXZlbnREZWZhdWx0KGV2dCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQoNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAvL3RyYWNlOjk4MA0KDQogICAgICAgICAgICAgICAgICAgIGlmIChsaSAmJiAhbGkucHJldmlvdXNTaWJsaW5nKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50TGlzdCA9IGxpLnBhcmVudE5vZGU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYmsgPSByYW5nZS5jcmVhdGVCb29rbWFyaygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoZG9tVXRpbHMuaXNUYWdOb2RlKHBhcmVudExpc3QucGFyZW50Tm9kZSwnb2wgdWwnKSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50TGlzdC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShsaSxwYXJlbnRMaXN0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihkb21VdGlscy5pc0VtcHR5Tm9kZShwYXJlbnRMaXN0KSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShwYXJlbnRMaXN0KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlew0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUobGkuZmlyc3RDaGlsZCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudExpc3QucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobGkuZmlyc3RDaGlsZCxwYXJlbnRMaXN0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUobGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRvbVV0aWxzLmlzRW1wdHlOb2RlKHBhcmVudExpc3QpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHBhcmVudExpc3QpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5tb3ZlVG9Cb29rbWFyayhiaykuc2V0Q3Vyc29yKGZhbHNlLHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCdjb250ZW50Y2hhbmdlJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBtZS5maXJlRXZlbnQoJ3NhdmVTY2VuZScpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucHJldmVudERlZmF1bHQoZXZ0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCg0KICAgICAgICAgICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KICAgIH0pOw0KDQogICAgbWUuYWRkTGlzdGVuZXIoJ2tleXVwJyxmdW5jdGlvbih0eXBlLCBldnQpew0KICAgICAgICB2YXIga2V5Q29kZSA9IGV2dC5rZXlDb2RlIHx8IGV2dC53aGljaDsNCiAgICAgICAgaWYgKGtleUNvZGUgPT0gOCkgew0KICAgICAgICAgICAgdmFyIHJuZyA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpLGxpc3Q7DQogICAgICAgICAgICBpZihsaXN0ID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShybmcuc3RhcnRDb250YWluZXIsWydvbCcsICd1bCddLHRydWUpKXsNCiAgICAgICAgICAgICAgICBhZGp1c3RMaXN0KGxpc3QsbGlzdC50YWdOYW1lLnRvTG93ZXJDYXNlKCksZ2V0U3R5bGUobGlzdCl8fGRvbVV0aWxzLmdldENvbXB1dGVkU3R5bGUobGlzdCwnbGlzdC1zdHlsZS10eXBlJyksdHJ1ZSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIC8v5aSE55CGdGFi6ZSuDQogICAgbWUuYWRkTGlzdGVuZXIoJ3RhYmtleWRvd24nLGZ1bmN0aW9uKCl7DQoNCiAgICAgICAgdmFyIHJhbmdlID0gbWUuc2VsZWN0aW9uLmdldFJhbmdlKCk7DQoNCiAgICAgICAgLy/mjqfliLbnuqfmlbANCiAgICAgICAgZnVuY3Rpb24gY2hlY2tMZXZlbChsaSl7DQogICAgICAgICAgICBpZihtZS5vcHRpb25zLm1heExpc3RMZXZlbCAhPSAtMSl7DQogICAgICAgICAgICAgICAgdmFyIGxldmVsID0gbGkucGFyZW50Tm9kZSxsZXZlbE51bSA9IDA7DQogICAgICAgICAgICAgICAgd2hpbGUoL1tvdV1sL2kudGVzdChsZXZlbC50YWdOYW1lKSl7DQogICAgICAgICAgICAgICAgICAgIGxldmVsTnVtKys7DQogICAgICAgICAgICAgICAgICAgIGxldmVsID0gbGV2ZWwucGFyZW50Tm9kZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYobGV2ZWxOdW0gPj0gbWUub3B0aW9ucy5tYXhMaXN0TGV2ZWwpew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgLy/lj6rku6XlvIDlp4vkuLrlh4YNCiAgICAgICAgLy90b2RvIOWQjue7reaUuei/mw0KICAgICAgICB2YXIgbGkgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKHJhbmdlLnN0YXJ0Q29udGFpbmVyLCAnbGknLCB0cnVlKTsNCiAgICAgICAgaWYobGkpew0KDQogICAgICAgICAgICB2YXIgYms7DQogICAgICAgICAgICBpZihyYW5nZS5jb2xsYXBzZWQpew0KICAgICAgICAgICAgICAgIGlmKGNoZWNrTGV2ZWwobGkpKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICB2YXIgcGFyZW50TGkgPSBsaS5wYXJlbnROb2RlLA0KICAgICAgICAgICAgICAgICAgICBsaXN0ID0gbWUuZG9jdW1lbnQuY3JlYXRlRWxlbWVudChwYXJlbnRMaS50YWdOYW1lKSwNCiAgICAgICAgICAgICAgICAgICAgaW5kZXggPSB1dGlscy5pbmRleE9mKGxpc3RTdHlsZVtsaXN0LnRhZ05hbWVdLCBnZXRTdHlsZShwYXJlbnRMaSl8fGRvbVV0aWxzLmdldENvbXB1dGVkU3R5bGUocGFyZW50TGksICdsaXN0LXN0eWxlLXR5cGUnKSk7DQogICAgICAgICAgICAgICAgaW5kZXggPSBpbmRleCArIDEgPT0gbGlzdFN0eWxlW2xpc3QudGFnTmFtZV0ubGVuZ3RoID8gMCA6IGluZGV4ICsgMTsNCiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFN0eWxlID0gbGlzdFN0eWxlW2xpc3QudGFnTmFtZV1baW5kZXhdOw0KICAgICAgICAgICAgICAgIHNldExpc3RTdHlsZShsaXN0LGN1cnJlbnRTdHlsZSk7DQogICAgICAgICAgICAgICAgaWYoZG9tVXRpbHMuaXNTdGFydEluYmxvY2socmFuZ2UpKXsNCiAgICAgICAgICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCdzYXZlU2NlbmUnKTsNCiAgICAgICAgICAgICAgICAgICAgYmsgPSByYW5nZS5jcmVhdGVCb29rbWFyaygpOw0KICAgICAgICAgICAgICAgICAgICBwYXJlbnRMaS5pbnNlcnRCZWZvcmUobGlzdCwgbGkpOw0KICAgICAgICAgICAgICAgICAgICBsaXN0LmFwcGVuZENoaWxkKGxpKTsNCiAgICAgICAgICAgICAgICAgICAgYWRqdXN0TGlzdChsaXN0LGxpc3QudGFnTmFtZS50b0xvd2VyQ2FzZSgpLGN1cnJlbnRTdHlsZSk7DQogICAgICAgICAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnY29udGVudGNoYW5nZScpOw0KICAgICAgICAgICAgICAgICAgICByYW5nZS5tb3ZlVG9Cb29rbWFyayhiaykuc2VsZWN0KHRydWUpOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICBtZS5maXJlRXZlbnQoJ3NhdmVTY2VuZScpOw0KICAgICAgICAgICAgICAgIGJrID0gcmFuZ2UuY3JlYXRlQm9va21hcmsoKTsNCiAgICAgICAgICAgICAgICBmb3IodmFyIGk9IDAsY2xvc2VMaXN0LHBhcmVudHMgPSBkb21VdGlscy5maW5kUGFyZW50cyhsaSksY2k7Y2k9cGFyZW50c1tpKytdOyl7DQogICAgICAgICAgICAgICAgICAgIGlmKGRvbVV0aWxzLmlzVGFnTm9kZShjaSwnb2wgdWwnKSl7DQogICAgICAgICAgICAgICAgICAgICAgICBjbG9zZUxpc3QgPSBjaTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHZhciBjdXJyZW50ID0gbGk7DQogICAgICAgICAgICAgICAgaWYoYmsuZW5kKXsNCiAgICAgICAgICAgICAgICAgICAgd2hpbGUoY3VycmVudCAmJiAhKGRvbVV0aWxzLmdldFBvc2l0aW9uKGN1cnJlbnQsIGJrLmVuZCkgJiBkb21VdGlscy5QT1NJVElPTl9GT0xMT1dJTkcpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGNoZWNrTGV2ZWwoY3VycmVudCkpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBkb21VdGlscy5nZXROZXh0RG9tTm9kZShjdXJyZW50LGZhbHNlLG51bGwsZnVuY3Rpb24obm9kZSl7cmV0dXJuIG5vZGUgIT09IGNsb3NlTGlzdH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudExpID0gY3VycmVudC5wYXJlbnROb2RlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QgPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KHBhcmVudExpLnRhZ05hbWUpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0gdXRpbHMuaW5kZXhPZihsaXN0U3R5bGVbbGlzdC50YWdOYW1lXSwgZ2V0U3R5bGUocGFyZW50TGkpfHxkb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKHBhcmVudExpLCAnbGlzdC1zdHlsZS10eXBlJykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRJbmRleCA9IGluZGV4ICsgMSA9PSBsaXN0U3R5bGVbbGlzdC50YWdOYW1lXS5sZW5ndGggPyAwIDogaW5kZXggKyAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRTdHlsZSA9IGxpc3RTdHlsZVtsaXN0LnRhZ05hbWVdW2N1cnJlbnRJbmRleF07DQogICAgICAgICAgICAgICAgICAgICAgICBzZXRMaXN0U3R5bGUobGlzdCxjdXJyZW50U3R5bGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50TGkuaW5zZXJ0QmVmb3JlKGxpc3QsIGN1cnJlbnQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUoY3VycmVudCAmJiAhKGRvbVV0aWxzLmdldFBvc2l0aW9uKGN1cnJlbnQsIGJrLmVuZCkgJiBkb21VdGlscy5QT1NJVElPTl9GT0xMT1dJTkcpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaSA9IGN1cnJlbnQubmV4dFNpYmxpbmc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdC5hcHBlbmRDaGlsZChjdXJyZW50KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighbGkgfHwgZG9tVXRpbHMuaXNUYWdOb2RlKGxpLCdvbCB1bCcpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobGkpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUobGkgPSBsaS5maXJzdENoaWxkKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihsaS50YWdOYW1lID09ICdMSScpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGkgPSBkb21VdGlscy5nZXROZXh0RG9tTm9kZShjdXJyZW50LGZhbHNlLG51bGwsZnVuY3Rpb24obm9kZSl7cmV0dXJuIG5vZGUgIT09IGNsb3NlTGlzdH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50ID0gbGk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhZGp1c3RMaXN0KGxpc3QsbGlzdC50YWdOYW1lLnRvTG93ZXJDYXNlKCksY3VycmVudFN0eWxlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBsaTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBtZS5maXJlRXZlbnQoJ2NvbnRlbnRjaGFuZ2UnKTsNCiAgICAgICAgICAgICAgICByYW5nZS5tb3ZlVG9Cb29rbWFyayhiaykuc2VsZWN0KCk7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgIH0pOw0KICAgIGZ1bmN0aW9uIGdldExpKHN0YXJ0KXsNCiAgICAgICAgd2hpbGUoc3RhcnQgJiYgIWRvbVV0aWxzLmlzQm9keShzdGFydCkpew0KICAgICAgICAgICAgaWYoc3RhcnQubm9kZU5hbWUgPT0gJ1RBQkxFJyl7DQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZihzdGFydC5ub2RlTmFtZSA9PSAnTEknKXsNCiAgICAgICAgICAgICAgICByZXR1cm4gc3RhcnQNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHN0YXJ0ID0gc3RhcnQucGFyZW50Tm9kZTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBtZS5jb21tYW5kc1snaW5zZXJ0b3JkZXJlZGxpc3QnXSA9DQogICAgbWUuY29tbWFuZHNbJ2luc2VydHVub3JkZXJlZGxpc3QnXSA9IHsNCiAgICAgICAgICAgIGV4ZWNDb21tYW5kOmZ1bmN0aW9uIChjb21tYW5kLCBzdHlsZSkgew0KDQogICAgICAgICAgICAgICAgaWYgKCFzdHlsZSkgew0KICAgICAgICAgICAgICAgICAgICBzdHlsZSA9IGNvbW1hbmQudG9Mb3dlckNhc2UoKSA9PSAnaW5zZXJ0b3JkZXJlZGxpc3QnID8gJ2RlY2ltYWwnIDogJ2Rpc2MnOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB2YXIgbWUgPSB0aGlzLA0KICAgICAgICAgICAgICAgICAgICByYW5nZSA9IHRoaXMuc2VsZWN0aW9uLmdldFJhbmdlKCksDQogICAgICAgICAgICAgICAgICAgIGZpbHRlckZuID0gZnVuY3Rpb24gKG5vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAgIG5vZGUubm9kZVR5cGUgPT0gMSA/IG5vZGUudGFnTmFtZS50b0xvd2VyQ2FzZSgpICE9ICdicicgOiAhZG9tVXRpbHMuaXNXaGl0ZXNwYWNlKG5vZGUpOw0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICB0YWcgPSBjb21tYW5kLnRvTG93ZXJDYXNlKCkgPT0gJ2luc2VydG9yZGVyZWRsaXN0JyA/ICdvbCcgOiAndWwnLA0KICAgICAgICAgICAgICAgICAgICBmcmFnID0gbWUuZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpOw0KICAgICAgICAgICAgICAgIC8v5Y675o6J5piv5Zug5Li65Lya5Ye6546w6YCJ5Yiw5pyr5bC+77yM5a+86Ie0YWRqdXN0bWVudEJvdW5kYXJ557yp5Yiwb2wvdWznmoTkvY3nva4NCiAgICAgICAgICAgICAgICAvL3JhbmdlLnNocmlua0JvdW5kYXJ5KCk7Ly8uYWRqdXN0bWVudEJvdW5kYXJ5KCk7DQogICAgICAgICAgICAgICAgcmFuZ2UuYWRqdXN0bWVudEJvdW5kYXJ5KCkuc2hyaW5rQm91bmRhcnkoKTsNCiAgICAgICAgICAgICAgICB2YXIgYmtvID0gcmFuZ2UuY3JlYXRlQm9va21hcmsodHJ1ZSksDQogICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gZ2V0TGkobWUuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYmtvLnN0YXJ0KSksDQogICAgICAgICAgICAgICAgICAgIG1vZGlmeVN0YXJ0ID0gMCwNCiAgICAgICAgICAgICAgICAgICAgZW5kID0gIGdldExpKG1lLmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGJrby5lbmQpKSwNCiAgICAgICAgICAgICAgICAgICAgbW9kaWZ5RW5kID0gMCwNCiAgICAgICAgICAgICAgICAgICAgc3RhcnRQYXJlbnQsIGVuZFBhcmVudCwNCiAgICAgICAgICAgICAgICAgICAgbGlzdCwgdG1wOw0KDQogICAgICAgICAgICAgICAgaWYgKHN0YXJ0IHx8IGVuZCkgew0KICAgICAgICAgICAgICAgICAgICBzdGFydCAmJiAoc3RhcnRQYXJlbnQgPSBzdGFydC5wYXJlbnROb2RlKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCFia28uZW5kKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBlbmQgPSBzdGFydDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBlbmQgJiYgKGVuZFBhcmVudCA9IGVuZC5wYXJlbnROb2RlKTsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAoc3RhcnRQYXJlbnQgPT09IGVuZFBhcmVudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0ICE9PSBlbmQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXAgPSBzdGFydDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydCA9IHN0YXJ0Lm5leHRTaWJsaW5nOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZG9tVXRpbHMuaXNCbG9ja0VsbSh0bXAuZmlyc3RDaGlsZCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICh0bXAuZmlyc3RDaGlsZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5hcHBlbmRDaGlsZCh0bXAuZmlyc3RDaGlsZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wLmFwcGVuZENoaWxkKHApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcmFnLmFwcGVuZENoaWxkKHRtcCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0bXAgPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBzdGFydFBhcmVudC5pbnNlcnRCZWZvcmUodG1wLCBlbmQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkb21VdGlscy5pc0Jsb2NrRWxtKGVuZC5maXJzdENoaWxkKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGVuZC5maXJzdENoaWxkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAuYXBwZW5kQ2hpbGQoZW5kLmZpcnN0Q2hpbGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQuYXBwZW5kQ2hpbGQocCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBmcmFnLmFwcGVuZENoaWxkKGVuZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5icmVha1BhcmVudCh0bXAsIHN0YXJ0UGFyZW50KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb21VdGlscy5pc0VtcHR5Tm9kZSh0bXAucHJldmlvdXNTaWJsaW5nKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZSh0bXAucHJldmlvdXNTaWJsaW5nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb21VdGlscy5pc0VtcHR5Tm9kZSh0bXAubmV4dFNpYmxpbmcpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHRtcC5uZXh0U2libGluZykNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub2RlU3R5bGUgPSBnZXRTdHlsZShzdGFydFBhcmVudCkgfHwgZG9tVXRpbHMuZ2V0Q29tcHV0ZWRTdHlsZShzdGFydFBhcmVudCwgJ2xpc3Qtc3R5bGUtdHlwZScpIHx8IChjb21tYW5kLnRvTG93ZXJDYXNlKCkgPT0gJ2luc2VydG9yZGVyZWRsaXN0JyA/ICdkZWNpbWFsJyA6ICdkaXNjJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhcnRQYXJlbnQudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09IHRhZyAmJiBub2RlU3R5bGUgPT0gc3R5bGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgY2ksIHRtcEZyYWcgPSBtZS5kb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7IGNpID0gZnJhZy5jaGlsZE5vZGVzW2krK107KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRvbVV0aWxzLmlzVGFnTm9kZShjaSwnb2wgdWwnKSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGlscy5lYWNoKGRvbVV0aWxzLmdldEVsZW1lbnRzQnlUYWdOYW1lKGNpLCdsaScpLGZ1bmN0aW9uKGxpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZShsaS5maXJzdENoaWxkKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wRnJhZy5hcHBlbmRDaGlsZChsaS5maXJzdENoaWxkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChjaS5maXJzdENoaWxkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wRnJhZy5hcHBlbmRDaGlsZChjaS5maXJzdENoaWxkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcC5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0bXBGcmFnLCB0bXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0ID0gbWUuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldExpc3RTdHlsZShsaXN0LHN0eWxlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0LmFwcGVuZENoaWxkKGZyYWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShsaXN0LCB0bXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUodG1wKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QgJiYgYWRqdXN0TGlzdChsaXN0LCB0YWcsIHN0eWxlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLm1vdmVUb0Jvb2ttYXJrKGJrbykuc2VsZWN0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgLy/lvIDlp4sNCiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoc3RhcnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXAgPSBzdGFydC5uZXh0U2libGluZzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9tVXRpbHMuaXNUYWdOb2RlKHN0YXJ0LCAnb2wgdWwnKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcmFnLmFwcGVuZENoaWxkKHN0YXJ0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG1wZnJhZyA9IG1lLmRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0Jsb2NrID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0LmZpcnN0Q2hpbGQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb21VdGlscy5pc0Jsb2NrRWxtKHN0YXJ0LmZpcnN0Q2hpbGQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzQmxvY2sgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wZnJhZy5hcHBlbmRDaGlsZChzdGFydC5maXJzdENoaWxkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWhhc0Jsb2NrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG1wUCA9IG1lLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcFAuYXBwZW5kQ2hpbGQodG1wZnJhZyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcmFnLmFwcGVuZENoaWxkKHRtcFApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJhZy5hcHBlbmRDaGlsZCh0bXBmcmFnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUoc3RhcnQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gdG1wOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRQYXJlbnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZnJhZywgc3RhcnRQYXJlbnQubmV4dFNpYmxpbmcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvbVV0aWxzLmlzRW1wdHlOb2RlKHN0YXJ0UGFyZW50KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0QmVmb3JlKHN0YXJ0UGFyZW50KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUoc3RhcnRQYXJlbnQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydEFmdGVyKHN0YXJ0UGFyZW50KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmeVN0YXJ0ID0gMTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGlmIChlbmQgJiYgZG9tVXRpbHMuaW5Eb2MoZW5kUGFyZW50LCBtZS5kb2N1bWVudCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8v57uT5p2fDQogICAgICAgICAgICAgICAgICAgICAgICBzdGFydCA9IGVuZFBhcmVudC5maXJzdENoaWxkOw0KICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0ICYmIHN0YXJ0ICE9PSBlbmQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXAgPSBzdGFydC5uZXh0U2libGluZzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9tVXRpbHMuaXNUYWdOb2RlKHN0YXJ0LCAnb2wgdWwnKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcmFnLmFwcGVuZENoaWxkKHN0YXJ0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBmcmFnID0gbWUuZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNCbG9jayA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChzdGFydC5maXJzdENoaWxkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9tVXRpbHMuaXNCbG9ja0VsbShzdGFydC5maXJzdENoaWxkKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0Jsb2NrID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcGZyYWcuYXBwZW5kQ2hpbGQoc3RhcnQuZmlyc3RDaGlsZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoYXNCbG9jaykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wUCA9IG1lLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcFAuYXBwZW5kQ2hpbGQodG1wZnJhZyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcmFnLmFwcGVuZENoaWxkKHRtcFApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJhZy5hcHBlbmRDaGlsZCh0bXBmcmFnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUoc3RhcnQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydCA9IHRtcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0bXBEaXYgPSBkb21VdGlscy5jcmVhdGVFbGVtZW50KG1lLmRvY3VtZW50LCAnZGl2Jywgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0bXBEaXYnOjENCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMubW92ZUNoaWxkKGVuZCwgdG1wRGl2KTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgZnJhZy5hcHBlbmRDaGlsZCh0bXBEaXYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKGVuZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBlbmRQYXJlbnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZnJhZywgZW5kUGFyZW50KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldEVuZEJlZm9yZShlbmRQYXJlbnQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvbVV0aWxzLmlzRW1wdHlOb2RlKGVuZFBhcmVudCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUoZW5kUGFyZW50KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgbW9kaWZ5RW5kID0gMTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAoIW1vZGlmeVN0YXJ0KSB7DQogICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0QmVmb3JlKG1lLmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGJrby5zdGFydCkpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoYmtvLmVuZCAmJiAhbW9kaWZ5RW5kKSB7DQogICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldEVuZEFmdGVyKG1lLmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGJrby5lbmQpKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmFuZ2UuZW5sYXJnZSh0cnVlLCBmdW5jdGlvbiAobm9kZSkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gbm90RXhjaGFuZ2Vbbm9kZS50YWdOYW1lXTsNCiAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgIGZyYWcgPSBtZS5kb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7DQoNCiAgICAgICAgICAgICAgICB2YXIgYmsgPSByYW5nZS5jcmVhdGVCb29rbWFyaygpLA0KICAgICAgICAgICAgICAgICAgICBjdXJyZW50ID0gZG9tVXRpbHMuZ2V0TmV4dERvbU5vZGUoYmsuc3RhcnQsIGZhbHNlLCBmaWx0ZXJGbiksDQogICAgICAgICAgICAgICAgICAgIHRtcFJhbmdlID0gcmFuZ2UuY2xvbmVSYW5nZSgpLA0KICAgICAgICAgICAgICAgICAgICB0bXBOb2RlLA0KICAgICAgICAgICAgICAgICAgICBibG9jayA9IGRvbVV0aWxzLmlzQmxvY2tFbG07DQoNCiAgICAgICAgICAgICAgICB3aGlsZSAoY3VycmVudCAmJiBjdXJyZW50ICE9PSBiay5lbmQgJiYgKGRvbVV0aWxzLmdldFBvc2l0aW9uKGN1cnJlbnQsIGJrLmVuZCkgJiBkb21VdGlscy5QT1NJVElPTl9QUkVDRURJTkcpKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQubm9kZVR5cGUgPT0gMyB8fCBkdGQubGlbY3VycmVudC50YWdOYW1lXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQubm9kZVR5cGUgPT0gMSAmJiBkdGQuJGxpc3RbY3VycmVudC50YWdOYW1lXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChjdXJyZW50LmZpcnN0Q2hpbGQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJhZy5hcHBlbmRDaGlsZChjdXJyZW50LmZpcnN0Q2hpbGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBOb2RlID0gZG9tVXRpbHMuZ2V0TmV4dERvbU5vZGUoY3VycmVudCwgZmFsc2UsIGZpbHRlckZuKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUoY3VycmVudCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IHRtcE5vZGU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRtcE5vZGUgPSBjdXJyZW50Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdG1wUmFuZ2Uuc2V0U3RhcnRCZWZvcmUoY3VycmVudCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChjdXJyZW50ICYmIGN1cnJlbnQgIT09IGJrLmVuZCAmJiAoIWJsb2NrKGN1cnJlbnQpIHx8IGRvbVV0aWxzLmlzQm9va21hcmtOb2RlKGN1cnJlbnQpICkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBOb2RlID0gY3VycmVudDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50ID0gZG9tVXRpbHMuZ2V0TmV4dERvbU5vZGUoY3VycmVudCwgZmFsc2UsIG51bGwsIGZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhbm90RXhjaGFuZ2Vbbm9kZS50YWdOYW1lXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQgJiYgYmxvY2soY3VycmVudCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXAgPSBkb21VdGlscy5nZXROZXh0RG9tTm9kZSh0bXBOb2RlLCBmYWxzZSwgZmlsdGVyRm4pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0bXAgJiYgZG9tVXRpbHMuaXNCb29rbWFya05vZGUodG1wKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50ID0gZG9tVXRpbHMuZ2V0TmV4dERvbU5vZGUodG1wLCBmYWxzZSwgZmlsdGVyRm4pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBOb2RlID0gdG1wOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRtcFJhbmdlLnNldEVuZEFmdGVyKHRtcE5vZGUpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50ID0gZG9tVXRpbHMuZ2V0TmV4dERvbU5vZGUodG1wTm9kZSwgZmFsc2UsIGZpbHRlckZuKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxpID0gcmFuZ2UuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgbGkuYXBwZW5kQ2hpbGQodG1wUmFuZ2UuZXh0cmFjdENvbnRlbnRzKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoZG9tVXRpbHMuaXNFbXB0eU5vZGUobGkpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG1wTm9kZSA9IHJhbmdlLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZShsaS5maXJzdENoaWxkKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wTm9kZS5hcHBlbmRDaGlsZChsaS5maXJzdENoaWxkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaS5hcHBlbmRDaGlsZCh0bXBOb2RlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZyYWcuYXBwZW5kQ2hpbGQobGkpOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IGRvbVV0aWxzLmdldE5leHREb21Ob2RlKGN1cnJlbnQsIHRydWUsIGZpbHRlckZuKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICByYW5nZS5tb3ZlVG9Cb29rbWFyayhiaykuY29sbGFwc2UodHJ1ZSk7DQogICAgICAgICAgICAgICAgbGlzdCA9IG1lLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnKTsNCiAgICAgICAgICAgICAgICBzZXRMaXN0U3R5bGUobGlzdCxzdHlsZSk7DQogICAgICAgICAgICAgICAgbGlzdC5hcHBlbmRDaGlsZChmcmFnKTsNCiAgICAgICAgICAgICAgICByYW5nZS5pbnNlcnROb2RlKGxpc3QpOw0KICAgICAgICAgICAgICAgIC8v5b2T5YmNbGlzdOS4iuS4i+eci+iDveWQpuWQiOW5tg0KICAgICAgICAgICAgICAgIGFkanVzdExpc3QobGlzdCwgdGFnLCBzdHlsZSk7DQogICAgICAgICAgICAgICAgLy/ljrvmjonlhpfkvZnnmoR0bXBEaXYNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgY2ksIHRtcERpdnMgPSBkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZShsaXN0LCAnZGl2Jyk7IGNpID0gdG1wRGl2c1tpKytdOykgew0KICAgICAgICAgICAgICAgICAgICBpZiAoY2kuZ2V0QXR0cmlidXRlKCd0bXBEaXYnKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKGNpLCB0cnVlKQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJhbmdlLm1vdmVUb0Jvb2ttYXJrKGJrbykuc2VsZWN0KCk7DQoNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBxdWVyeUNvbW1hbmRTdGF0ZTpmdW5jdGlvbiAoY29tbWFuZCkgew0KICAgICAgICAgICAgICAgIHZhciB0YWcgPSBjb21tYW5kLnRvTG93ZXJDYXNlKCkgPT0gJ2luc2VydG9yZGVyZWRsaXN0JyA/ICdvbCcgOiAndWwnOw0KICAgICAgICAgICAgICAgIHZhciBwYXRoID0gdGhpcy5zZWxlY3Rpb24uZ2V0U3RhcnRFbGVtZW50UGF0aCgpOw0KICAgICAgICAgICAgICAgIGZvcih2YXIgaT0gMCxjaTtjaSA9IHBhdGhbaSsrXTspew0KICAgICAgICAgICAgICAgICAgICBpZihjaS5ub2RlTmFtZSA9PSAnVEFCTEUnKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYodGFnID09IGNpLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDENCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuIDA7DQoNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBxdWVyeUNvbW1hbmRWYWx1ZTpmdW5jdGlvbiAoY29tbWFuZCkgew0KICAgICAgICAgICAgICAgIHZhciB0YWcgPSBjb21tYW5kLnRvTG93ZXJDYXNlKCkgPT0gJ2luc2VydG9yZGVyZWRsaXN0JyA/ICdvbCcgOiAndWwnOw0KICAgICAgICAgICAgICAgIHZhciBwYXRoID0gdGhpcy5zZWxlY3Rpb24uZ2V0U3RhcnRFbGVtZW50UGF0aCgpLA0KICAgICAgICAgICAgICAgICAgICBub2RlOw0KICAgICAgICAgICAgICAgIGZvcih2YXIgaT0gMCxjaTtjaSA9IHBhdGhbaSsrXTspew0KICAgICAgICAgICAgICAgICAgICBpZihjaS5ub2RlTmFtZSA9PSAnVEFCTEUnKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYodGFnID09IGNpLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpew0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IGNpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiBub2RlID8gZ2V0U3R5bGUobm9kZSkgfHwgZG9tVXRpbHMuZ2V0Q29tcHV0ZWRTdHlsZShub2RlLCAnbGlzdC1zdHlsZS10eXBlJykgOiBudWxsOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9Ow0KfTsNCg0KCi8vL2ltcG9ydCBjb3JlDQovLy9pbXBvcnQgcGx1Z2lucy9zZXJpYWxpemUuanMNCi8vL2ltcG9ydCBwbHVnaW5zL3VuZG8uanMNCi8vL2NvbW1hbmRzIOafpeeci+a6kOeggQ0KLy8vY29tbWFuZHNOYW1lICBTb3VyY2UNCi8vL2NvbW1hbmRzVGl0bGUgIOafpeeci+a6kOeggQ0KKGZ1bmN0aW9uICgpew0KICAgIHZhciBzb3VyY2VFZGl0b3JzID0gew0KICAgICAgICB0ZXh0YXJlYTogZnVuY3Rpb24gKGVkaXRvciwgaG9sZGVyKXsNCiAgICAgICAgICAgIHZhciB0ZXh0YXJlYSA9IGhvbGRlci5vd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJyk7DQogICAgICAgICAgICB0ZXh0YXJlYS5zdHlsZS5jc3NUZXh0ID0gJ3Bvc2l0aW9uOmFic29sdXRlO3Jlc2l6ZTpub25lO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7Ym9yZGVyOjA7cGFkZGluZzowO21hcmdpbjowO292ZXJmbG93LXk6YXV0bzsnOw0KICAgICAgICAgICAgLy8gdG9kbzogSUXkuIvlj6rmnIlvbnJlc2l6ZeWxnuaAp+WPr+eUqC4uLiDlvojnuqDnu5MNCiAgICAgICAgICAgIGlmIChicm93c2VyLmllICYmIGJyb3dzZXIudmVyc2lvbiA8IDgpIHsNCiAgICAgICAgICAgICAgICB0ZXh0YXJlYS5zdHlsZS53aWR0aCA9IGhvbGRlci5vZmZzZXRXaWR0aCArICdweCc7DQogICAgICAgICAgICAgICAgdGV4dGFyZWEuc3R5bGUuaGVpZ2h0ID0gaG9sZGVyLm9mZnNldEhlaWdodCArICdweCc7DQogICAgICAgICAgICAgICAgaG9sZGVyLm9ucmVzaXplID0gZnVuY3Rpb24gKCl7DQogICAgICAgICAgICAgICAgICAgIHRleHRhcmVhLnN0eWxlLndpZHRoID0gaG9sZGVyLm9mZnNldFdpZHRoICsgJ3B4JzsNCiAgICAgICAgICAgICAgICAgICAgdGV4dGFyZWEuc3R5bGUuaGVpZ2h0ID0gaG9sZGVyLm9mZnNldEhlaWdodCArICdweCc7DQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGhvbGRlci5hcHBlbmRDaGlsZCh0ZXh0YXJlYSk7DQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgIHNldENvbnRlbnQ6IGZ1bmN0aW9uIChjb250ZW50KXsNCiAgICAgICAgICAgICAgICAgICAgdGV4dGFyZWEudmFsdWUgPSBjb250ZW50Ow0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgZ2V0Q29udGVudDogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0ZXh0YXJlYS52YWx1ZTsNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHNlbGVjdDogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICAgICAgICAgIHZhciByYW5nZTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGJyb3dzZXIuaWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlID0gdGV4dGFyZWEuY3JlYXRlVGV4dFJhbmdlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5jb2xsYXBzZSh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNlbGVjdCgpOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgLy90b2RvOiBjaHJvbWXkuIvml6Dms5Xorr7nva7nhKbngrkNCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRhcmVhLnNldFNlbGVjdGlvblJhbmdlKDAsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGV4dGFyZWEuZm9jdXMoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgZGlzcG9zZTogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICAgICAgICAgIGhvbGRlci5yZW1vdmVDaGlsZCh0ZXh0YXJlYSk7DQogICAgICAgICAgICAgICAgICAgIC8vIHRvZG8NCiAgICAgICAgICAgICAgICAgICAgaG9sZGVyLm9ucmVzaXplID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGV4dGFyZWEgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICBob2xkZXIgPSBudWxsOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH07DQogICAgICAgIH0sDQogICAgICAgIGNvZGVtaXJyb3I6IGZ1bmN0aW9uIChlZGl0b3IsIGhvbGRlcil7DQoNCiAgICAgICAgICAgIHZhciBjb2RlRWRpdG9yID0gd2luZG93LkNvZGVNaXJyb3IoaG9sZGVyLCB7DQogICAgICAgICAgICAgICAgbW9kZTogInRleHQvaHRtbCIsDQogICAgICAgICAgICAgICAgdGFiTW9kZTogImluZGVudCIsDQogICAgICAgICAgICAgICAgbGluZU51bWJlcnM6IHRydWUsDQogICAgICAgICAgICAgICAgbGluZVdyYXBwaW5nOnRydWUNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgdmFyIGRvbSA9IGNvZGVFZGl0b3IuZ2V0V3JhcHBlckVsZW1lbnQoKTsNCiAgICAgICAgICAgIGRvbS5zdHlsZS5jc3NUZXh0ID0gJ3Bvc2l0aW9uOmFic29sdXRlO2xlZnQ6MDt0b3A6MDt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO2ZvbnQtZmFtaWx5OmNvbnNvbGFzLCJDb3VyaWVyIG5ldyIsbW9ub3NwYWNlO2ZvbnQtc2l6ZToxM3B4Oyc7DQogICAgICAgICAgICBjb2RlRWRpdG9yLmdldFNjcm9sbGVyRWxlbWVudCgpLnN0eWxlLmNzc1RleHQgPSAncG9zaXRpb246YWJzb2x1dGU7bGVmdDowO3RvcDowO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7JzsNCiAgICAgICAgICAgIGNvZGVFZGl0b3IucmVmcmVzaCgpOw0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICBnZXRDb2RlTWlycm9yOmZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBjb2RlRWRpdG9yOw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgc2V0Q29udGVudDogZnVuY3Rpb24gKGNvbnRlbnQpew0KICAgICAgICAgICAgICAgICAgICBjb2RlRWRpdG9yLnNldFZhbHVlKGNvbnRlbnQpOw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgZ2V0Q29udGVudDogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBjb2RlRWRpdG9yLmdldFZhbHVlKCk7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBzZWxlY3Q6IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgICAgICAgICBjb2RlRWRpdG9yLmZvY3VzKCk7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBkaXNwb3NlOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgICAgICAgICAgaG9sZGVyLnJlbW92ZUNoaWxkKGRvbSk7DQogICAgICAgICAgICAgICAgICAgIGRvbSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIGNvZGVFZGl0b3IgPSBudWxsOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH07DQogICAgICAgIH0NCiAgICB9Ow0KDQogICAgVUUucGx1Z2luc1snc291cmNlJ10gPSBmdW5jdGlvbiAoKXsNCiAgICAgICAgdmFyIG1lID0gdGhpczsNCiAgICAgICAgdmFyIG9wdCA9IHRoaXMub3B0aW9uczsNCiAgICAgICAgdmFyIHNvdXJjZU1vZGUgPSBmYWxzZTsNCiAgICAgICAgdmFyIHNvdXJjZUVkaXRvcjsNCg0KICAgICAgICBvcHQuc291cmNlRWRpdG9yID0gYnJvd3Nlci5pZSAgPyAndGV4dGFyZWEnIDogKG9wdC5zb3VyY2VFZGl0b3IgfHwgJ2NvZGVtaXJyb3InKTsNCg0KICAgICAgICBtZS5zZXRPcHQoew0KICAgICAgICAgICAgc291cmNlRWRpdG9yRmlyc3Q6ZmFsc2UNCiAgICAgICAgfSk7DQogICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVNvdXJjZUVkaXRvcihob2xkZXIpew0KICAgICAgICAgICAgcmV0dXJuIHNvdXJjZUVkaXRvcnNbb3B0LnNvdXJjZUVkaXRvciA9PSAnY29kZW1pcnJvcicgJiYgd2luZG93LkNvZGVNaXJyb3IgPyAnY29kZW1pcnJvcicgOiAndGV4dGFyZWEnXShtZSwgaG9sZGVyKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHZhciBiYWtDc3NUZXh0Ow0KICAgICAgICAvL+ino+WGs+WcqOa6kOeggeaooeW8j+S4i2dldENvbnRlbnTkuI3og73lvpfliLDmnIDmlrDnmoTlhoXlrrnpl67popgNCiAgICAgICAgdmFyIG9sZEdldENvbnRlbnQgPSBtZS5nZXRDb250ZW50LA0KICAgICAgICAgICAgYmFrQWRkcmVzczsNCg0KICAgICAgICBtZS5jb21tYW5kc1snc291cmNlJ10gPSB7DQogICAgICAgICAgICBleGVjQ29tbWFuZDogZnVuY3Rpb24gKCl7DQoNCiAgICAgICAgICAgICAgICBzb3VyY2VNb2RlID0gIXNvdXJjZU1vZGU7DQogICAgICAgICAgICAgICAgaWYgKHNvdXJjZU1vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgYmFrQWRkcmVzcyA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpLmNyZWF0ZUFkZHJlc3MoZmFsc2UsdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIG1lLnVuZG9NYW5nZXIgJiYgbWUudW5kb01hbmdlci5zYXZlKHRydWUpOw0KICAgICAgICAgICAgICAgICAgICBpZihicm93c2VyLmdlY2tvKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lLmJvZHkuY29udGVudEVkaXRhYmxlID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBiYWtDc3NUZXh0ID0gbWUuaWZyYW1lLnN0eWxlLmNzc1RleHQ7DQogICAgICAgICAgICAgICAgICAgIG1lLmlmcmFtZS5zdHlsZS5jc3NUZXh0ICs9ICdwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0Oi0zMjc2OHB4O3RvcDotMzI3NjhweDsnOw0KDQoNCiAgICAgICAgICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCdiZWZvcmVnZXRjb250ZW50Jyk7DQogICAgICAgICAgICAgICAgICAgIHZhciByb290ID0gVUUuaHRtbHBhcnNlcihtZS5ib2R5LmlubmVySFRNTCk7DQogICAgICAgICAgICAgICAgICAgIG1lLmZpbHRlck91dHB1dFJ1bGUocm9vdCk7DQogICAgICAgICAgICAgICAgICAgIHJvb3QudHJhdmVyc2FsKGZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS50eXBlID09ICdlbGVtZW50Jykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAobm9kZS50YWdOYW1lKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3RkJzoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAndGgnOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdjYXB0aW9uJzoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobm9kZS5jaGlsZHJlbiAmJiBub2RlLmNoaWxkcmVuLmxlbmd0aCA9PSAxKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG5vZGUuZmlyc3RDaGlsZCgpLnRhZ05hbWUgPT0gJ2JyJyApew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUucmVtb3ZlQ2hpbGQobm9kZS5maXJzdENoaWxkKCkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdwcmUnOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5pbm5lclRleHQobm9kZS5pbm5lclRleHQoKS5yZXBsYWNlKC8mbmJzcDsvZywnICcpKQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgICBtZS5maXJlRXZlbnQoJ2FmdGVyZ2V0Y29udGVudCcpOw0KDQogICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50ID0gcm9vdC50b0h0bWwodHJ1ZSk7DQoNCiAgICAgICAgICAgICAgICAgICAgc291cmNlRWRpdG9yID0gY3JlYXRlU291cmNlRWRpdG9yKG1lLmlmcmFtZS5wYXJlbnROb2RlKTsNCg0KICAgICAgICAgICAgICAgICAgICBzb3VyY2VFZGl0b3Iuc2V0Q29udGVudChjb250ZW50KTsNCiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZUVkaXRvci5zZWxlY3QoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lLmFkZExpc3RlbmVyKCdmdWxsc2NyZWVuY2hhbmdlZCcsIGZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5ew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VFZGl0b3IuZ2V0Q29kZU1pcnJvcigpLnJlZnJlc2goKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1jYXRjaChlKXt9DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIC8v6YeN572uZ2V0Q29udGVudO+8jOa6kOeggeaooeW8j+S4i+WPluWAvOS5n+iDveaYr+acgOaWsOeahOaVsOaNrg0KICAgICAgICAgICAgICAgICAgICBtZS5nZXRDb250ZW50ID0gZnVuY3Rpb24gKCl7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc291cmNlRWRpdG9yLmdldENvbnRlbnQoKSB8fCAnPHA+JyArIChicm93c2VyLmllID8gJycgOiAnPGJyLz4nKSsnPC9wPic7DQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgbWUuaWZyYW1lLnN0eWxlLmNzc1RleHQgPSBiYWtDc3NUZXh0Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgY29udCA9IHNvdXJjZUVkaXRvci5nZXRDb250ZW50KCkgfHwgJzxwPicgKyAoYnJvd3Nlci5pZSA/ICcnIDogJzxici8+JykrJzwvcD4nOw0KICAgICAgICAgICAgICAgICAgICAvL+WkhOeQhuaOiWJsb2Nr6IqC54K55YmN5ZCO55qE56m65qC8LOacieWPr+iDveS8muivr+WRveS4re+8jOaaguaXtuS4jeiAg+iZkQ0KICAgICAgICAgICAgICAgICAgICBjb250ID0gY29udC5yZXBsYWNlKG5ldyBSZWdFeHAoJ1tcXHJcXHRcXG4gXSo8XC8/KFxcdyspXFxzKig/OltePl0qKT4nLCdnJyksIGZ1bmN0aW9uKGEsYil7DQogICAgICAgICAgICAgICAgICAgICAgICBpZihiICYmICFkdGQuJGlubGluZVdpdGhBW2IudG9Mb3dlckNhc2UoKV0pew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhLnJlcGxhY2UoLyheW1xuXHJcdCBdKil8KFtcblxyXHQgXSokKS9nLCcnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhLnJlcGxhY2UoLyheW1xuXHJcdF0qKXwoW1xuXHJcdF0qJCkvZywnJykNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIG1lLnNldENvbnRlbnQoY29udCk7DQogICAgICAgICAgICAgICAgICAgIHNvdXJjZUVkaXRvci5kaXNwb3NlKCk7DQogICAgICAgICAgICAgICAgICAgIHNvdXJjZUVkaXRvciA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIC8v6L+Y5Y6fZ2V0Q29udGVudOaWueazlQ0KICAgICAgICAgICAgICAgICAgICBtZS5nZXRDb250ZW50ID0gb2xkR2V0Q29udGVudDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGZpcnN0ID0gbWUuYm9keS5maXJzdENoaWxkOw0KICAgICAgICAgICAgICAgICAgICAvL3RyYWNlOjExMDYg6YO95Yig6Zmk56m65LqG77yM5LiL6L655Lya5oql6ZSZ77yM5omA5Lul6KGl5YWF5LiA5LiqcOWNoOS9jQ0KICAgICAgICAgICAgICAgICAgICBpZighZmlyc3Qpew0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuYm9keS5pbm5lckhUTUwgPSAnPHA+JysoYnJvd3Nlci5pZT8nJzonPGJyLz4nKSsnPC9wPic7DQogICAgICAgICAgICAgICAgICAgICAgICBmaXJzdCA9IG1lLmJvZHkuZmlyc3RDaGlsZDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAvL+imgeWcqGlmbeS4uuaYvuekuuaXtmZm5omN6IO95Y+W5Yiwc2VsZWN0aW9uLOWQpuWImeaKpemUmQ0KICAgICAgICAgICAgICAgICAgICAvL+i/memHjOS4jeiDveavlOi+g+S9jee9ruS6hg0KICAgICAgICAgICAgICAgICAgICBtZS51bmRvTWFuZ2VyICYmIG1lLnVuZG9NYW5nZXIuc2F2ZSh0cnVlKTsNCg0KICAgICAgICAgICAgICAgICAgICBpZihicm93c2VyLmdlY2tvKXsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LnN0eWxlLmNzc1RleHQgPSAncG9zaXRpb246YWJzb2x1dGU7bGVmdDowO3RvcDotMzI3NjhweCc7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaW5wdXQpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBtZS5ib2R5LmNvbnRlbnRFZGl0YWJsZSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnNldFZpZXdwb3J0T2Zmc2V0KGlucHV0LCB7IGxlZnQ6IC0zMjc2OCwgdG9wOiAwIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LmZvY3VzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZS5ib2R5LmNvbnRlbnRFZGl0YWJsZSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpLm1vdmVUb0FkZHJlc3MoYmFrQWRkcmVzcykuc2VsZWN0KHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUoaW5wdXQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICAvL2ll5LiL5pyJ5Y+v6IO95oql6ZSZ77yM5q+U5aaC5Zyo5Luj56CB6aG25aS055qE5oOF5Ya1DQogICAgICAgICAgICAgICAgICAgICAgICB0cnl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUuc2VsZWN0aW9uLmdldFJhbmdlKCkubW92ZVRvQWRkcmVzcyhiYWtBZGRyZXNzKS5zZWxlY3QodHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9Y2F0Y2goZSl7fQ0KDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5maXJlRXZlbnQoJ3NvdXJjZW1vZGVjaGFuZ2VkJywgc291cmNlTW9kZSk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgcXVlcnlDb21tYW5kU3RhdGU6IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgICAgIHJldHVybiBzb3VyY2VNb2RlfDA7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgbm90TmVlZFVuZG8gOiAxDQogICAgICAgIH07DQogICAgICAgIHZhciBvbGRRdWVyeUNvbW1hbmRTdGF0ZSA9IG1lLnF1ZXJ5Q29tbWFuZFN0YXRlOw0KDQogICAgICAgIG1lLnF1ZXJ5Q29tbWFuZFN0YXRlID0gZnVuY3Rpb24gKGNtZE5hbWUpew0KICAgICAgICAgICAgY21kTmFtZSA9IGNtZE5hbWUudG9Mb3dlckNhc2UoKTsNCiAgICAgICAgICAgIGlmIChzb3VyY2VNb2RlKSB7DQogICAgICAgICAgICAgICAgLy/mupDnoIHmqKHlvI/kuIvlj6/ku6XlvIDlkK/nmoTlkb3ku6QNCiAgICAgICAgICAgICAgICByZXR1cm4gY21kTmFtZSBpbiB7DQogICAgICAgICAgICAgICAgICAgICdzb3VyY2UnIDogMSwNCiAgICAgICAgICAgICAgICAgICAgJ2Z1bGxzY3JlZW4nIDogMQ0KICAgICAgICAgICAgICAgIH0gPyAxIDogLTENCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBvbGRRdWVyeUNvbW1hbmRTdGF0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOw0KICAgICAgICB9Ow0KDQogICAgICAgIGlmKG9wdC5zb3VyY2VFZGl0b3IgPT0gImNvZGVtaXJyb3IiKXsNCg0KICAgICAgICAgICAgbWUuYWRkTGlzdGVuZXIoInJlYWR5IixmdW5jdGlvbigpew0KICAgICAgICAgICAgICAgIHV0aWxzLmxvYWRGaWxlKGRvY3VtZW50LHsNCiAgICAgICAgICAgICAgICAgICAgc3JjIDogb3B0LmNvZGVNaXJyb3JKc1VybCB8fCBvcHQuVUVESVRPUl9IT01FX1VSTCArICJ0aGlyZC1wYXJ0eS9jb2RlbWlycm9yL2NvZGVtaXJyb3IuanMiLA0KICAgICAgICAgICAgICAgICAgICB0YWcgOiAic2NyaXB0IiwNCiAgICAgICAgICAgICAgICAgICAgdHlwZSA6ICJ0ZXh0L2phdmFzY3JpcHQiLA0KICAgICAgICAgICAgICAgICAgICBkZWZlciA6ICJkZWZlciINCiAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgICAgICAgIGlmKG9wdC5zb3VyY2VFZGl0b3JGaXJzdCl7DQogICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUuZXhlY0NvbW1hbmQoInNvdXJjZSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIHV0aWxzLmxvYWRGaWxlKGRvY3VtZW50LHsNCiAgICAgICAgICAgICAgICAgICAgdGFnIDogImxpbmsiLA0KICAgICAgICAgICAgICAgICAgICByZWwgOiAic3R5bGVzaGVldCIsDQogICAgICAgICAgICAgICAgICAgIHR5cGUgOiAidGV4dC9jc3MiLA0KICAgICAgICAgICAgICAgICAgICBocmVmIDogb3B0LmNvZGVNaXJyb3JDc3NVcmwgfHwgb3B0LlVFRElUT1JfSE9NRV9VUkwgKyAidGhpcmQtcGFydHkvY29kZW1pcnJvci9jb2RlbWlycm9yLmNzcyINCiAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCg0KICAgIH07DQoNCn0pKCk7Ci8vL2ltcG9ydCBjb3JlDQovLy9pbXBvcnQgcGx1Z2lucy91bmRvLmpzDQovLy9jb21tYW5kcyDorr7nva7lm57ovabmoIfnrb5w5oiWYnINCi8vL2NvbW1hbmRzTmFtZSAgRW50ZXJLZXkNCi8vL2NvbW1hbmRzVGl0bGUgIOiuvue9ruWbnui9puagh+etvnDmiJZicg0KLyoqDQogKiBAZGVzY3JpcHRpb24g5aSE55CG5Zue6L2mDQogKiBAYXV0aG9yIHpoYW55aQ0KICovDQpVRS5wbHVnaW5zWydlbnRlcmtleSddID0gZnVuY3Rpb24oKSB7DQogICAgdmFyIGhUYWcsDQogICAgICAgIG1lID0gdGhpcywNCiAgICAgICAgdGFnID0gbWUub3B0aW9ucy5lbnRlclRhZzsNCiAgICBtZS5hZGRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbih0eXBlLCBldnQpIHsNCg0KICAgICAgICB2YXIga2V5Q29kZSA9IGV2dC5rZXlDb2RlIHx8IGV2dC53aGljaDsNCiAgICAgICAgaWYgKGtleUNvZGUgPT0gMTMpIHsNCiAgICAgICAgICAgIHZhciByYW5nZSA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpLA0KICAgICAgICAgICAgICAgIHN0YXJ0ID0gcmFuZ2Uuc3RhcnRDb250YWluZXIsDQogICAgICAgICAgICAgICAgZG9TYXZlOw0KDQogICAgICAgICAgICAvL+S/ruato+WcqGgxLWg26YeM6L655Zue6L2m5ZCO5LiN6IO95bWM5aWXcOeahOmXrumimA0KICAgICAgICAgICAgaWYgKCFicm93c2VyLmllKSB7DQoNCiAgICAgICAgICAgICAgICBpZiAoL2hcZC9pLnRlc3QoaFRhZykpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGJyb3dzZXIuZ2Vja28pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShzdGFydCwgWyAnaDEnLCAnaDInLCAnaDMnLCAnaDQnLCAnaDUnLCAnaDYnLCdibG9ja3F1b3RlJywnY2FwdGlvbicsJ3RhYmxlJ10sIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUuZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ2Zvcm1hdEJsb2NrJywgZmFsc2UsICc8cD4nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb1NhdmUgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgLy9jaHJvbWUgcmVtb3ZlIGRpdg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0Lm5vZGVUeXBlID09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG1wID0gbWUuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJycpLGRpdjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5pbnNlcnROb2RlKHRtcCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2ID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZSh0bXAsICdkaXYnLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGl2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwID0gbWUuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZGl2LmZpcnN0Q2hpbGQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAuYXBwZW5kQ2hpbGQoZGl2LmZpcnN0Q2hpbGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5wYXJlbnROb2RlLmluc2VydEJlZm9yZShwLCBkaXYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUoZGl2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnRCZWZvcmUodG1wKS5zZXRDdXJzb3IoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9TYXZlID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHRtcCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGlmIChtZS51bmRvTWFuZ2VyICYmIGRvU2F2ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbWUudW5kb01hbmdlci5zYXZlKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy/msqHmnInnq5nkvY3nrKbvvIzkvJrlh7rnjrDlpJrooYznmoTpl67popgNCiAgICAgICAgICAgICAgICBicm93c2VyLm9wZXJhICYmICByYW5nZS5zZWxlY3QoKTsNCiAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnc2F2ZVNjZW5lJyx0cnVlLHRydWUpDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9KTsNCg0KICAgIG1lLmFkZExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24odHlwZSwgZXZ0KSB7DQogICAgICAgIHZhciBrZXlDb2RlID0gZXZ0LmtleUNvZGUgfHwgZXZ0LndoaWNoOw0KICAgICAgICBpZiAoa2V5Q29kZSA9PSAxMykgey8v5Zue6L2mDQogICAgICAgICAgICBpZihtZS5maXJlRXZlbnQoJ2JlZm9yZWVudGVya2V5ZG93bicpKXsNCiAgICAgICAgICAgICAgICBkb21VdGlscy5wcmV2ZW50RGVmYXVsdChldnQpOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnc2F2ZVNjZW5lJyx0cnVlLHRydWUpOw0KICAgICAgICAgICAgaFRhZyA9ICcnOw0KDQoNCiAgICAgICAgICAgIHZhciByYW5nZSA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpOw0KDQogICAgICAgICAgICBpZiAoIXJhbmdlLmNvbGxhcHNlZCkgew0KICAgICAgICAgICAgICAgIC8v6LeodGTkuI3og73liKANCiAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSByYW5nZS5zdGFydENvbnRhaW5lciwNCiAgICAgICAgICAgICAgICAgICAgZW5kID0gcmFuZ2UuZW5kQ29udGFpbmVyLA0KICAgICAgICAgICAgICAgICAgICBzdGFydFRkID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShzdGFydCwgJ3RkJywgdHJ1ZSksDQogICAgICAgICAgICAgICAgICAgIGVuZFRkID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShlbmQsICd0ZCcsIHRydWUpOw0KICAgICAgICAgICAgICAgIGlmIChzdGFydFRkICYmIGVuZFRkICYmIHN0YXJ0VGQgIT09IGVuZFRkIHx8ICFzdGFydFRkICYmIGVuZFRkIHx8IHN0YXJ0VGQgJiYgIWVuZFRkKSB7DQogICAgICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCA/IGV2dC5wcmV2ZW50RGVmYXVsdCgpIDogKCBldnQucmV0dXJuVmFsdWUgPSBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAodGFnID09ICdwJykgew0KDQoNCiAgICAgICAgICAgICAgICBpZiAoIWJyb3dzZXIuaWUpIHsNCg0KICAgICAgICAgICAgICAgICAgICBzdGFydCA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUocmFuZ2Uuc3RhcnRDb250YWluZXIsIFsnb2wnLCd1bCcsJ3AnLCAnaDEnLCAnaDInLCAnaDMnLCAnaDQnLCAnaDUnLCAnaDYnLCdibG9ja3F1b3RlJywnY2FwdGlvbiddLCB0cnVlKTsNCg0KICAgICAgICAgICAgICAgICAgICAvL29wZXJh5LiL5omn6KGMZm9ybWF0YmxvY2vkvJrlnKh0YWJsZeeahOWcuuaZr+S4i+aciemXrumimO+8jOWbnui9puWcqG9wZXJh5Y6f55Sf5pSv5oyB5b6I5aW977yM5omA5Lul5pqC5pe25Zyob3BlcmHljrvmjonosIPnlKjov5nkuKrljp/nlJ/nmoRjb21tYW5kDQogICAgICAgICAgICAgICAgICAgIC8vdHJhY2U6MjQzMQ0KICAgICAgICAgICAgICAgICAgICBpZiAoIXN0YXJ0ICYmICFicm93c2VyLm9wZXJhKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lLmRvY3VtZW50LmV4ZWNDb21tYW5kKCdmb3JtYXRCbG9jaycsIGZhbHNlLCAnPHA+Jyk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChicm93c2VyLmdlY2tvKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2UgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydCA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUocmFuZ2Uuc3RhcnRDb250YWluZXIsICdwJywgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQgJiYgZG9tVXRpbHMucmVtb3ZlRGlydHlBdHRyKHN0YXJ0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBoVGFnID0gc3RhcnQudGFnTmFtZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PSAncCcgJiYgYnJvd3Nlci5nZWNrbyAmJiBkb21VdGlscy5yZW1vdmVEaXJ0eUF0dHIoc3RhcnQpOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0ID8gZXZ0LnByZXZlbnREZWZhdWx0KCkgOiAoIGV2dC5yZXR1cm5WYWx1ZSA9IGZhbHNlKTsNCg0KICAgICAgICAgICAgICAgIGlmICghcmFuZ2UuY29sbGFwc2VkKSB7DQogICAgICAgICAgICAgICAgICAgIHJhbmdlLmRlbGV0ZUNvbnRlbnRzKCk7DQogICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gcmFuZ2Uuc3RhcnRDb250YWluZXI7DQogICAgICAgICAgICAgICAgICAgIGlmIChzdGFydC5ub2RlVHlwZSA9PSAxICYmIChzdGFydCA9IHN0YXJ0LmNoaWxkTm9kZXNbcmFuZ2Uuc3RhcnRPZmZzZXRdKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0Lm5vZGVUeXBlID09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZHRkLiRlbXB0eVtzdGFydC50YWdOYW1lXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydEJlZm9yZShzdGFydCkuc2V0Q3Vyc29yKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZS51bmRvTWFuZ2VyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZS51bmRvTWFuZ2VyLnNhdmUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc3RhcnQuZmlyc3RDaGlsZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYnIgPSByYW5nZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdicicpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydC5hcHBlbmRDaGlsZChicik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KHN0YXJ0LCAwKS5zZXRDdXJzb3IoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1lLnVuZG9NYW5nZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lLnVuZG9NYW5nZXIuc2F2ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBzdGFydC5maXJzdENoaWxkOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0ID09PSByYW5nZS5zdGFydENvbnRhaW5lci5jaGlsZE5vZGVzW3JhbmdlLnN0YXJ0T2Zmc2V0XSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyID0gcmFuZ2UuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnInKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5pbnNlcnROb2RlKGJyKS5zZXRDdXJzb3IoKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydChzdGFydCwgMCkuc2V0Q3Vyc29yKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgYnIgPSByYW5nZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdicicpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2UuaW5zZXJ0Tm9kZShicikuc2V0U3RhcnRBZnRlcihicikuc2V0Q3Vyc29yKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgYnIgPSByYW5nZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdicicpOw0KICAgICAgICAgICAgICAgICAgICByYW5nZS5pbnNlcnROb2RlKGJyKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IGJyLnBhcmVudE5vZGU7DQogICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnQubGFzdENoaWxkID09PSBicikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYnIucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoYnIuY2xvbmVOb2RlKHRydWUpLCBicik7DQogICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydEJlZm9yZShicik7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydEFmdGVyKGJyKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRDdXJzb3IoKTsNCg0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0NCiAgICB9KTsNCn07DQoKLyoNCiAqICAg5aSE55CG54m55q6K6ZSu55qE5YW85a655oCn6Zeu6aKYDQogKi8NClVFLnBsdWdpbnNbJ2tleXN0cm9rZXMnXSA9IGZ1bmN0aW9uKCkgew0KICAgIHZhciBtZSA9IHRoaXM7DQogICAgdmFyIGNvbGxhcHNlZCA9IHRydWU7DQogICAgbWUuYWRkTGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbih0eXBlLCBldnQpIHsNCiAgICAgICAgdmFyIGtleUNvZGUgPSBldnQua2V5Q29kZSB8fCBldnQud2hpY2gsDQogICAgICAgICAgICBybmcgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKTsNCg0KICAgICAgICAvL+WkhOeQhuWFqOmAieeahOaDheWGtQ0KICAgICAgICBpZighcm5nLmNvbGxhcHNlZCAmJiAhKGV2dC5jdHJsS2V5IHx8IGV2dC5zaGlmdEtleSB8fCBldnQuYWx0S2V5IHx8IGV2dC5tZXRhS2V5KSAmJiAoa2V5Q29kZSA+PSA2NSAmJiBrZXlDb2RlIDw9OTANCiAgICAgICAgICAgIHx8IGtleUNvZGUgPj0gNDggJiYga2V5Q29kZSA8PSA1NyB8fA0KICAgICAgICAgICAga2V5Q29kZSA+PSA5NiAmJiBrZXlDb2RlIDw9IDExMSB8fCB7DQogICAgICAgICAgICAgICAgICAgIDEzOjEsDQogICAgICAgICAgICAgICAgICAgIDg6MSwNCiAgICAgICAgICAgICAgICAgICAgNDY6MQ0KICAgICAgICAgICAgICAgIH1ba2V5Q29kZV0pDQogICAgICAgICAgICApew0KDQogICAgICAgICAgICB2YXIgdG1wTm9kZSA9IHJuZy5zdGFydENvbnRhaW5lcjsNCiAgICAgICAgICAgIGlmKGRvbVV0aWxzLmlzRmlsbENoYXIodG1wTm9kZSkpew0KICAgICAgICAgICAgICAgIHJuZy5zZXRTdGFydEJlZm9yZSh0bXBOb2RlKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdG1wTm9kZSA9IHJuZy5lbmRDb250YWluZXI7DQogICAgICAgICAgICBpZihkb21VdGlscy5pc0ZpbGxDaGFyKHRtcE5vZGUpKXsNCiAgICAgICAgICAgICAgICBybmcuc2V0RW5kQWZ0ZXIodG1wTm9kZSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJuZy50eHRUb0VsbUJvdW5kYXJ5KCk7DQogICAgICAgICAgICAvL+e7k+adn+i+ueeVjOWPr+iDveaUvuWIsOS6hmJy55qE5YmN6L6577yM6KaB5oqKYnLljIXlkKvov5vmnaUNCiAgICAgICAgICAgIC8vIHhbeHh4XTxici8+DQogICAgICAgICAgICBpZihybmcuZW5kQ29udGFpbmVyICYmIHJuZy5lbmRDb250YWluZXIubm9kZVR5cGUgPT0gMSl7DQogICAgICAgICAgICAgICAgdG1wTm9kZSA9IHJuZy5lbmRDb250YWluZXIuY2hpbGROb2Rlc1tybmcuZW5kT2Zmc2V0XTsNCiAgICAgICAgICAgICAgICBpZih0bXBOb2RlICYmIGRvbVV0aWxzLmlzQnIodG1wTm9kZSkpew0KICAgICAgICAgICAgICAgICAgICBybmcuc2V0RW5kQWZ0ZXIodG1wTm9kZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYocm5nLnN0YXJ0T2Zmc2V0ID09IDApew0KICAgICAgICAgICAgICAgIHRtcE5vZGUgPSBybmcuc3RhcnRDb250YWluZXI7DQogICAgICAgICAgICAgICAgaWYoZG9tVXRpbHMuaXNCb3VuZGFyeU5vZGUodG1wTm9kZSwnZmlyc3RDaGlsZCcpICl7DQogICAgICAgICAgICAgICAgICAgIHRtcE5vZGUgPSBybmcuZW5kQ29udGFpbmVyOw0KICAgICAgICAgICAgICAgICAgICBpZihybmcuZW5kT2Zmc2V0ID09ICh0bXBOb2RlLm5vZGVUeXBlID09IDMgPyB0bXBOb2RlLm5vZGVWYWx1ZS5sZW5ndGggOiB0bXBOb2RlLmNoaWxkTm9kZXMubGVuZ3RoKSAmJiBkb21VdGlscy5pc0JvdW5kYXJ5Tm9kZSh0bXBOb2RlLCdsYXN0Q2hpbGQnKSl7DQogICAgICAgICAgICAgICAgICAgICAgICBtZS5maXJlRXZlbnQoJ3NhdmVTY2VuZScpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuYm9keS5pbm5lckhUTUwgPSAnPHA+JysoYnJvd3Nlci5pZSA/ICcnIDogJzxici8+JykrJzwvcD4nOw0KICAgICAgICAgICAgICAgICAgICAgICAgcm5nLnNldFN0YXJ0KG1lLmJvZHkuZmlyc3RDaGlsZCwwKS5zZXRDdXJzb3IoZmFsc2UsdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBtZS5fc2VsZWN0aW9uQ2hhbmdlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvL+WkhOeQhmJhY2tzcGFjZQ0KICAgICAgICBpZiAoa2V5Q29kZSA9PSA4KSB7DQogICAgICAgICAgICBybmcgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKTsNCiAgICAgICAgICAgIGNvbGxhcHNlZCA9IHJuZy5jb2xsYXBzZWQ7DQogICAgICAgICAgICBpZihtZS5maXJlRXZlbnQoJ2RlbGtleWRvd24nLGV2dCkpew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZhciBzdGFydCxlbmQ7DQogICAgICAgICAgICAvL+mBv+WFjeaMieS4pOasoeWIoOmZpOaJjeiDveeUn+aViOeahOmXrumimA0KICAgICAgICAgICAgaWYocm5nLmNvbGxhcHNlZCAmJiBybmcuaW5GaWxsQ2hhcigpKXsNCiAgICAgICAgICAgICAgICBzdGFydCA9IHJuZy5zdGFydENvbnRhaW5lcjsNCg0KICAgICAgICAgICAgICAgIGlmKGRvbVV0aWxzLmlzRmlsbENoYXIoc3RhcnQpKXsNCiAgICAgICAgICAgICAgICAgICAgcm5nLnNldFN0YXJ0QmVmb3JlKHN0YXJ0KS5zaHJpbmtCb3VuZGFyeSh0cnVlKS5jb2xsYXBzZSh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHN0YXJ0KQ0KICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICBzdGFydC5ub2RlVmFsdWUgPSBzdGFydC5ub2RlVmFsdWUucmVwbGFjZShuZXcgUmVnRXhwKCdeJyArIGRvbVV0aWxzLmZpbGxDaGFyICksJycpOw0KICAgICAgICAgICAgICAgICAgICBybmcuc3RhcnRPZmZzZXQtLTsNCiAgICAgICAgICAgICAgICAgICAgcm5nLmNvbGxhcHNlKHRydWUpLnNlbGVjdCh0cnVlKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy/op6PlhrPpgInkuK1jb250cm9s5YWD57Sg5LiN6IO95Yig6Zmk55qE6Zeu6aKYDQogICAgICAgICAgICBpZiAoc3RhcnQgPSBybmcuZ2V0Q2xvc2VkTm9kZSgpKSB7DQogICAgICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCdzYXZlU2NlbmUnKTsNCiAgICAgICAgICAgICAgICBybmcuc2V0U3RhcnRCZWZvcmUoc3RhcnQpOw0KICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShzdGFydCk7DQogICAgICAgICAgICAgICAgcm5nLnNldEN1cnNvcigpOw0KICAgICAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnc2F2ZVNjZW5lJyk7DQogICAgICAgICAgICAgICAgZG9tVXRpbHMucHJldmVudERlZmF1bHQoZXZ0KTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICAvL+mYu+atouWcqHRhYmxl5LiK55qE5Yig6ZmkDQogICAgICAgICAgICBpZiAoIWJyb3dzZXIuaWUpIHsNCiAgICAgICAgICAgICAgICBzdGFydCA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUocm5nLnN0YXJ0Q29udGFpbmVyLCAndGFibGUnLCB0cnVlKTsNCiAgICAgICAgICAgICAgICBlbmQgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKHJuZy5lbmRDb250YWluZXIsICd0YWJsZScsIHRydWUpOw0KICAgICAgICAgICAgICAgIGlmIChzdGFydCAmJiAhZW5kIHx8ICFzdGFydCAmJiBlbmQgfHwgc3RhcnQgIT09IGVuZCkgew0KICAgICAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9DQogICAgICAgIC8v5aSE55CGdGFi6ZSu55qE6YC76L6RDQogICAgICAgIGlmIChrZXlDb2RlID09IDkpIHsNCiAgICAgICAgICAgIC8v5LiN5aSE55CG5Lul5LiL5qCH562+DQogICAgICAgICAgICB2YXIgZXhjbHVkZVRhZ05hbWVGb3JUYWJLZXkgPSB7DQogICAgICAgICAgICAgICAgJ29sJyA6IDEsDQogICAgICAgICAgICAgICAgJ3VsJyA6IDEsDQogICAgICAgICAgICAgICAgJ3RhYmxlJzoxDQogICAgICAgICAgICB9Ow0KICAgICAgICAgICAgLy/lpITnkIbnu4Tku7bph4znmoR0YWLmjInkuIvkuovku7YNCiAgICAgICAgICAgIGlmKG1lLmZpcmVFdmVudCgndGFia2V5ZG93bicsZXZ0KSl7DQogICAgICAgICAgICAgICAgZG9tVXRpbHMucHJldmVudERlZmF1bHQoZXZ0KTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICB2YXIgcmFuZ2UgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKTsNCiAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnc2F2ZVNjZW5lJyk7DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMCx0eHQgPSAnJyx0YWJTaXplID0gbWUub3B0aW9ucy50YWJTaXplfHwgNCx0YWJOb2RlID0gIG1lLm9wdGlvbnMudGFiTm9kZSB8fCAnJm5ic3A7JzsgaSA8IHRhYlNpemU7IGkrKykgew0KICAgICAgICAgICAgICAgIHR4dCArPSB0YWJOb2RlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdmFyIHNwYW4gPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7DQogICAgICAgICAgICBzcGFuLmlubmVySFRNTCA9IHR4dCArIGRvbVV0aWxzLmZpbGxDaGFyOw0KICAgICAgICAgICAgaWYgKHJhbmdlLmNvbGxhcHNlZCkgew0KICAgICAgICAgICAgICAgIHJhbmdlLmluc2VydE5vZGUoc3Bhbi5jbG9uZU5vZGUodHJ1ZSkuZmlyc3RDaGlsZCkuc2V0Q3Vyc29yKHRydWUpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAvL+aZrumAmueahOaDheWGtQ0KICAgICAgICAgICAgICAgIHN0YXJ0ID0gZG9tVXRpbHMuZmluZFBhcmVudChyYW5nZS5zdGFydENvbnRhaW5lciwgZmlsdGVyRm4pOw0KICAgICAgICAgICAgICAgIGVuZCA9IGRvbVV0aWxzLmZpbmRQYXJlbnQocmFuZ2UuZW5kQ29udGFpbmVyLCBmaWx0ZXJGbik7DQogICAgICAgICAgICAgICAgaWYgKHN0YXJ0ICYmIGVuZCAmJiBzdGFydCA9PT0gZW5kKSB7DQogICAgICAgICAgICAgICAgICAgIHJhbmdlLmRlbGV0ZUNvbnRlbnRzKCk7DQogICAgICAgICAgICAgICAgICAgIHJhbmdlLmluc2VydE5vZGUoc3Bhbi5jbG9uZU5vZGUodHJ1ZSkuZmlyc3RDaGlsZCkuc2V0Q3Vyc29yKHRydWUpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBib29rbWFyayA9IHJhbmdlLmNyZWF0ZUJvb2ttYXJrKCksDQogICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJGbiA9IGZ1bmN0aW9uKG5vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9tVXRpbHMuaXNCbG9ja0VsbShub2RlKSAmJiAhZXhjbHVkZVRhZ05hbWVGb3JUYWJLZXlbbm9kZS50YWdOYW1lLnRvTG93ZXJDYXNlKCldDQoNCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIHJhbmdlLmVubGFyZ2UodHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIHZhciBib29rbWFyazIgPSByYW5nZS5jcmVhdGVCb29rbWFyaygpLA0KICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IGRvbVV0aWxzLmdldE5leHREb21Ob2RlKGJvb2ttYXJrMi5zdGFydCwgZmFsc2UsIGZpbHRlckZuKTsNCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGN1cnJlbnQgJiYgIShkb21VdGlscy5nZXRQb3NpdGlvbihjdXJyZW50LCBib29rbWFyazIuZW5kKSAmIGRvbVV0aWxzLlBPU0lUSU9OX0ZPTExPV0lORykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQuaW5zZXJ0QmVmb3JlKHNwYW4uY2xvbmVOb2RlKHRydWUpLmZpcnN0Q2hpbGQsIGN1cnJlbnQuZmlyc3RDaGlsZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50ID0gZG9tVXRpbHMuZ2V0TmV4dERvbU5vZGUoY3VycmVudCwgZmFsc2UsIGZpbHRlckZuKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByYW5nZS5tb3ZlVG9Cb29rbWFyayhib29rbWFyazIpLm1vdmVUb0Jvb2ttYXJrKGJvb2ttYXJrKS5zZWxlY3QoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBkb21VdGlscy5wcmV2ZW50RGVmYXVsdChldnQpDQogICAgICAgIH0NCiAgICAgICAgLy90cmFjZToxNjM0DQogICAgICAgIC8vZmbnmoRkZWzplK7lnKjlrrnlmajnqbrnmoTml7blgJnvvIzkuZ/kvJrliKDpmaQNCiAgICAgICAgaWYoYnJvd3Nlci5nZWNrbyAmJiBrZXlDb2RlID09IDQ2KXsNCiAgICAgICAgICAgIHJhbmdlID0gbWUuc2VsZWN0aW9uLmdldFJhbmdlKCk7DQogICAgICAgICAgICBpZihyYW5nZS5jb2xsYXBzZWQpew0KICAgICAgICAgICAgICAgIHN0YXJ0ID0gcmFuZ2Uuc3RhcnRDb250YWluZXI7DQogICAgICAgICAgICAgICAgaWYoZG9tVXRpbHMuaXNFbXB0eUJsb2NrKHN0YXJ0KSl7DQogICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBzdGFydC5wYXJlbnROb2RlOw0KICAgICAgICAgICAgICAgICAgICB3aGlsZShkb21VdGlscy5nZXRDaGlsZENvdW50KHBhcmVudCkgPT0gMSAmJiAhZG9tVXRpbHMuaXNCb2R5KHBhcmVudCkpew0KICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBwYXJlbnQ7DQogICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50Tm9kZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZihzdGFydCA9PT0gcGFyZW50Lmxhc3RDaGlsZCkNCiAgICAgICAgICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSk7DQogICAgbWUuYWRkTGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24odHlwZSwgZXZ0KSB7DQogICAgICAgIHZhciBrZXlDb2RlID0gZXZ0LmtleUNvZGUgfHwgZXZ0LndoaWNoLA0KICAgICAgICAgICAgcm5nLG1lID0gdGhpczsNCiAgICAgICAgaWYoa2V5Q29kZSA9PSA4KXsNCiAgICAgICAgICAgIGlmKG1lLmZpcmVFdmVudCgnZGVsa2V5dXAnKSl7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcm5nID0gbWUuc2VsZWN0aW9uLmdldFJhbmdlKCk7DQogICAgICAgICAgICBpZihybmcuY29sbGFwc2VkKXsNCiAgICAgICAgICAgICAgICB2YXIgdG1wTm9kZSwNCiAgICAgICAgICAgICAgICAgICAgYXV0b0NsZWFyVGFnTmFtZSA9IFsnaDEnLCdoMicsJ2gzJywnaDQnLCdoNScsJ2g2J107DQogICAgICAgICAgICAgICAgaWYodG1wTm9kZSA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUocm5nLnN0YXJ0Q29udGFpbmVyLGF1dG9DbGVhclRhZ05hbWUsdHJ1ZSkpew0KICAgICAgICAgICAgICAgICAgICBpZihkb21VdGlscy5pc0VtcHR5QmxvY2sodG1wTm9kZSkpew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByZSA9IHRtcE5vZGUucHJldmlvdXNTaWJsaW5nOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYocHJlICYmIHByZS5ub2RlTmFtZSAhPSAnVEFCTEUnKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUodG1wTm9kZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcm5nLnNldFN0YXJ0QXRMYXN0KHByZSkuc2V0Q3Vyc29yKGZhbHNlLHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXh0ID0gdG1wTm9kZS5uZXh0U2libGluZzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihuZXh0ICYmIG5leHQubm9kZU5hbWUgIT0gJ1RBQkxFJyl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZSh0bXBOb2RlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm5nLnNldFN0YXJ0QXRGaXJzdChuZXh0KS5zZXRDdXJzb3IoZmFsc2UsdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy/lpITnkIblvZPliKDpmaTliLBib2R55pe277yM6KaB6YeN5paw57uZcOagh+etvuWxleS9jQ0KICAgICAgICAgICAgICAgIGlmKGRvbVV0aWxzLmlzQm9keShybmcuc3RhcnRDb250YWluZXIpKXsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHRtcE5vZGUgPSBkb21VdGlscy5jcmVhdGVFbGVtZW50KG1lLmRvY3VtZW50LCdwJyx7DQogICAgICAgICAgICAgICAgICAgICAgICAnaW5uZXJIVE1MJyA6IGJyb3dzZXIuaWUgPyBkb21VdGlscy5maWxsQ2hhciA6ICc8YnIvPicNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIHJuZy5pbnNlcnROb2RlKHRtcE5vZGUpLnNldFN0YXJ0KHRtcE5vZGUsMCkuc2V0Q3Vyc29yKGZhbHNlLHRydWUpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICAvL2Nocm9tZeS4i+WmguaenOWIoOmZpOS6hmlubGluZeagh+etvu+8jOa1j+iniOWZqOS8muacieiusOW/hu+8jOWcqOi+k+WFpeaWh+Wtl+i/mOaYr+S8muWll+S4iuWImuaJjeWIoOmZpOeahOagh+etvu+8jOaJgOS7pei/memHjOWGjemAieS4gOasoeWwseS4jeS8muS6hg0KICAgICAgICAgICAgaWYoICFjb2xsYXBzZWQgJiYgKHJuZy5zdGFydENvbnRhaW5lci5ub2RlVHlwZSA9PSAzIHx8IHJuZy5zdGFydENvbnRhaW5lci5ub2RlVHlwZSA9PSAxICYmIGRvbVV0aWxzLmlzRW1wdHlCbG9jayhybmcuc3RhcnRDb250YWluZXIpKSl7DQogICAgICAgICAgICAgICAgaWYoYnJvd3Nlci5pZSl7DQogICAgICAgICAgICAgICAgICAgIHZhciBzcGFuID0gcm5nLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsNCiAgICAgICAgICAgICAgICAgICAgcm5nLmluc2VydE5vZGUoc3Bhbikuc2V0U3RhcnRCZWZvcmUoc3BhbikuY29sbGFwc2UodHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIHJuZy5zZWxlY3QoKTsNCiAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHNwYW4pDQogICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgIHJuZy5zZWxlY3QoKQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICB9KQ0KfTsKLy8vaW1wb3J0IGNvcmUKLy8vY29tbWFuZHMg5L+u5aSNY2hyb21l5LiL5Zu+54mH5LiN6IO954K55Ye755qE6Zeu6aKYCi8vL2NvbW1hbmRzTmFtZSAgRml4SW1nQ2xpY2sKLy8vY29tbWFuZHNUaXRsZSAg5L+u5aSNY2hyb21l5LiL5Zu+54mH5LiN6IO954K55Ye755qE6Zeu6aKYCi8v5L+u5aSNY2hyb21l5LiL5Zu+54mH5LiN6IO954K55Ye755qE6Zeu6aKYCi8vdG9kbyDlj6/ku6XmlLnlpKflsI8KVUUucGx1Z2luc1snZml4aW1nY2xpY2snXSA9IGZ1bmN0aW9uKCkgewogICAgdmFyIG1lID0gdGhpczsKICAgIGlmICggYnJvd3Nlci53ZWJraXQgKSB7CiAgICAgICAgbWUuYWRkTGlzdGVuZXIoICdjbGljaycsIGZ1bmN0aW9uKCB0eXBlLCBlICkgewogICAgICAgICAgICBpZiAoIGUudGFyZ2V0LnRhZ05hbWUgPT0gJ0lNRycgKSB7CiAgICAgICAgICAgICAgICB2YXIgcmFuZ2UgPSBuZXcgZG9tLlJhbmdlKCBtZS5kb2N1bWVudCApOwogICAgICAgICAgICAgICAgcmFuZ2Uuc2VsZWN0Tm9kZSggZS50YXJnZXQgKS5zZWxlY3QoKTsKCiAgICAgICAgICAgIH0KICAgICAgICB9ICk7CiAgICB9Cn07Ci8vL2ltcG9ydCBjb3JlDQovLy9jb21tYW5kcyDkuLrpnZ5pZea1j+iniOWZqOiHquWKqOa3u+WKoGHmoIfnrb4NCi8vL2NvbW1hbmRzTmFtZSAgQXV0b0xpbmsNCi8vL2NvbW1hbmRzVGl0bGUgIOiHquWKqOWinuWKoOmTvuaOpQ0KLyoqDQogKiBAZGVzY3JpcHRpb24g5Li66Z2eaWXmtY/op4jlmajoh6rliqjmt7vliqBh5qCH562+DQogKiBAYXV0aG9yIHpoYW55aQ0KICovDQogICAgVUUucGx1Z2luc1snYXV0b2xpbmsnXSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICB2YXIgY29udCA9IDA7DQogICAgICAgIGlmIChicm93c2VyLmllKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgdmFyIG1lID0gdGhpczsNCiAgICAgICAgbWUuYWRkTGlzdGVuZXIoJ3Jlc2V0JyxmdW5jdGlvbigpew0KICAgICAgICAgICBjb250ID0gMDsNCiAgICAgICAgfSk7DQogICAgICAgIG1lLmFkZExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24odHlwZSwgZXZ0KSB7DQogICAgICAgICAgICB2YXIga2V5Q29kZSA9IGV2dC5rZXlDb2RlIHx8IGV2dC53aGljaDsNCg0KICAgICAgICAgICAgaWYgKGtleUNvZGUgPT0gMzIgfHwga2V5Q29kZSA9PSAxMykgew0KDQogICAgICAgICAgICAgICAgdmFyIHNlbCA9IG1lLnNlbGVjdGlvbi5nZXROYXRpdmUoKSwNCiAgICAgICAgICAgICAgICAgICAgcmFuZ2UgPSBzZWwuZ2V0UmFuZ2VBdCgwKS5jbG9uZVJhbmdlKCksDQogICAgICAgICAgICAgICAgICAgIG9mZnNldCwNCiAgICAgICAgICAgICAgICAgICAgY2hhckNvZGU7DQoNCiAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSByYW5nZS5zdGFydENvbnRhaW5lcjsNCiAgICAgICAgICAgICAgICB3aGlsZSAoc3RhcnQubm9kZVR5cGUgPT0gMSAmJiByYW5nZS5zdGFydE9mZnNldCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSByYW5nZS5zdGFydENvbnRhaW5lci5jaGlsZE5vZGVzW3JhbmdlLnN0YXJ0T2Zmc2V0IC0gMV07DQogICAgICAgICAgICAgICAgICAgIGlmICghc3RhcnQpew0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQoc3RhcnQsIHN0YXJ0Lm5vZGVUeXBlID09IDEgPyBzdGFydC5jaGlsZE5vZGVzLmxlbmd0aCA6IHN0YXJ0Lm5vZGVWYWx1ZS5sZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICByYW5nZS5jb2xsYXBzZSh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSByYW5nZS5zdGFydENvbnRhaW5lcjsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBkb3sNCiAgICAgICAgICAgICAgICAgICAgaWYgKHJhbmdlLnN0YXJ0T2Zmc2V0ID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gcmFuZ2Uuc3RhcnRDb250YWluZXIucHJldmlvdXNTaWJsaW5nOw0KDQogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoc3RhcnQgJiYgc3RhcnQubm9kZVR5cGUgPT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gc3RhcnQubGFzdENoaWxkOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzdGFydCB8fCBkb21VdGlscy5pc0ZpbGxDaGFyKHN0YXJ0KSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSBzdGFydC5ub2RlVmFsdWUubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSByYW5nZS5zdGFydENvbnRhaW5lcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IHJhbmdlLnN0YXJ0T2Zmc2V0Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KHN0YXJ0LCBvZmZzZXQgLSAxKTsNCiAgICAgICAgICAgICAgICAgICAgY2hhckNvZGUgPSByYW5nZS50b1N0cmluZygpLmNoYXJDb2RlQXQoMCk7DQogICAgICAgICAgICAgICAgfSB3aGlsZSAoY2hhckNvZGUgIT0gMTYwICYmIGNoYXJDb2RlICE9IDMyKTsNCg0KICAgICAgICAgICAgICAgIGlmIChyYW5nZS50b1N0cmluZygpLnJlcGxhY2UobmV3IFJlZ0V4cChkb21VdGlscy5maWxsQ2hhciwgJ2cnKSwgJycpLm1hdGNoKC8oPzpodHRwcz86XC9cL3xzc2g6XC9cL3xmdHA6XC9cL3xmaWxlOlwvfHd3d1wuKS9pKSkgew0KICAgICAgICAgICAgICAgICAgICB3aGlsZShyYW5nZS50b1N0cmluZygpLmxlbmd0aCl7DQogICAgICAgICAgICAgICAgICAgICAgICBpZigvXig/Omh0dHBzPzpcL1wvfHNzaDpcL1wvfGZ0cDpcL1wvfGZpbGU6XC98d3d3XC4pL2kudGVzdChyYW5nZS50b1N0cmluZygpKSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0cnl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQocmFuZ2Uuc3RhcnRDb250YWluZXIscmFuZ2Uuc3RhcnRPZmZzZXQrMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9Y2F0Y2goZSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy90cmFjZToyMTIxDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXJ0ID0gcmFuZ2Uuc3RhcnRDb250YWluZXI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUoIShuZXh0ID0gc3RhcnQubmV4dFNpYmxpbmcpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZG9tVXRpbHMuaXNCb2R5KHN0YXJ0KSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBzdGFydC5wYXJlbnROb2RlOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KG5leHQsMCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIC8vcmFuZ2XnmoTlvIDlp4vovrnnlYzlt7Lnu4/lnKhh5qCH562+6YeM55qE5LiN5YaN5aSE55CGDQogICAgICAgICAgICAgICAgICAgIGlmKGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUocmFuZ2Uuc3RhcnRDb250YWluZXIsJ2EnLHRydWUpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IG1lLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKSx0ZXh0ID0gbWUuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJyAnKSxocmVmOw0KDQogICAgICAgICAgICAgICAgICAgIG1lLnVuZG9NYW5nZXIgJiYgbWUudW5kb01hbmdlci5zYXZlKCk7DQogICAgICAgICAgICAgICAgICAgIGEuYXBwZW5kQ2hpbGQocmFuZ2UuZXh0cmFjdENvbnRlbnRzKCkpOw0KICAgICAgICAgICAgICAgICAgICBhLmhyZWYgPSBhLmlubmVySFRNTCA9IGEuaW5uZXJIVE1MLnJlcGxhY2UoLzxbXj5dKz4vZywnJyk7DQogICAgICAgICAgICAgICAgICAgIGhyZWYgPSBhLmdldEF0dHJpYnV0ZSgiaHJlZiIpLnJlcGxhY2UobmV3IFJlZ0V4cChkb21VdGlscy5maWxsQ2hhciwnZycpLCcnKTsNCiAgICAgICAgICAgICAgICAgICAgaHJlZiA9IC9eKD86aHR0cHM/OlwvXC8pL2lnLnRlc3QoaHJlZikgPyBocmVmIDogImh0dHA6Ly8iKyBocmVmOw0KICAgICAgICAgICAgICAgICAgICBhLnNldEF0dHJpYnV0ZSgnX3NyYycsdXRpbHMuaHRtbChocmVmKSk7DQogICAgICAgICAgICAgICAgICAgIGEuaHJlZiA9IHV0aWxzLmh0bWwoaHJlZik7DQoNCiAgICAgICAgICAgICAgICAgICAgcmFuZ2UuaW5zZXJ0Tm9kZShhKTsNCiAgICAgICAgICAgICAgICAgICAgYS5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0ZXh0LCBhLm5leHRTaWJsaW5nKTsNCiAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQodGV4dCwgMCk7DQogICAgICAgICAgICAgICAgICAgIHJhbmdlLmNvbGxhcHNlKHRydWUpOw0KICAgICAgICAgICAgICAgICAgICBzZWwucmVtb3ZlQWxsUmFuZ2VzKCk7DQogICAgICAgICAgICAgICAgICAgIHNlbC5hZGRSYW5nZShyYW5nZSk7DQogICAgICAgICAgICAgICAgICAgIG1lLnVuZG9NYW5nZXIgJiYgbWUudW5kb01hbmdlci5zYXZlKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9Ow0KCi8vL2ltcG9ydCBjb3JlDQovLy9jb21tYW5kcyDlvZPovpPlhaXlhoXlrrnotoXov4fnvJbovpHlmajpq5jluqbml7bvvIznvJbovpHlmajoh6rliqjlop7pq5gNCi8vL2NvbW1hbmRzTmFtZSAgQXV0b0hlaWdodCxhdXRvSGVpZ2h0RW5hYmxlZA0KLy8vY29tbWFuZHNUaXRsZSAg6Ieq5Yqo5aKe6auYDQovKioNCiAqIEBkZXNjcmlwdGlvbiDoh6rliqjkvLjlsZUNCiAqIEBhdXRob3IgemhhbnlpDQogKi8NClVFLnBsdWdpbnNbJ2F1dG9oZWlnaHQnXSA9IGZ1bmN0aW9uICgpIHsNCiAgICB2YXIgbWUgPSB0aGlzOw0KICAgIC8v5o+Q5L6b5byA5YWz77yM5bCx566X5Yqg6L295Lmf5Y+v5Lul5YWz6ZetDQogICAgbWUuYXV0b0hlaWdodEVuYWJsZWQgPSBtZS5vcHRpb25zLmF1dG9IZWlnaHRFbmFibGVkICE9PSBmYWxzZTsNCiAgICBpZiAoIW1lLmF1dG9IZWlnaHRFbmFibGVkKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICB2YXIgYmFrT3ZlcmZsb3csDQogICAgICAgIHNwYW4sIHRtcE5vZGUsDQogICAgICAgIGxhc3RIZWlnaHQgPSAwLA0KICAgICAgICBvcHRpb25zID0gbWUub3B0aW9ucywNCiAgICAgICAgY3VycmVudEhlaWdodCwNCiAgICAgICAgdGltZXI7DQoNCiAgICBmdW5jdGlvbiBhZGp1c3RIZWlnaHQoKSB7DQogICAgICAgIHZhciBtZSA9IHRoaXM7DQogICAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7DQogICAgICAgIGlmKGlzRnVsbHNjcmVlbilyZXR1cm47DQogICAgICAgIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBpZiAoIW1lLnF1ZXJ5Q29tbWFuZFN0YXRlIHx8IG1lLnF1ZXJ5Q29tbWFuZFN0YXRlICYmIG1lLnF1ZXJ5Q29tbWFuZFN0YXRlKCdzb3VyY2UnKSAhPSAxKSB7DQogICAgICAgICAgICAgICAgaWYgKCFzcGFuKSB7DQogICAgICAgICAgICAgICAgICAgIHNwYW4gPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7DQogICAgICAgICAgICAgICAgICAgIC8vdHJhY2U6MTc2NA0KICAgICAgICAgICAgICAgICAgICBzcGFuLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTpibG9jazt3aWR0aDowO21hcmdpbjowO3BhZGRpbmc6MDtib3JkZXI6MDtjbGVhcjpib3RoOyc7DQogICAgICAgICAgICAgICAgICAgIHNwYW4uaW5uZXJIVE1MID0gJy4nOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0bXBOb2RlID0gc3Bhbi5jbG9uZU5vZGUodHJ1ZSk7DQogICAgICAgICAgICAgICAgbWUuYm9keS5hcHBlbmRDaGlsZCh0bXBOb2RlKTsNCiAgICAgICAgICAgICAgICBjdXJyZW50SGVpZ2h0ID0gTWF0aC5tYXgoZG9tVXRpbHMuZ2V0WFkodG1wTm9kZSkueSArIHRtcE5vZGUub2Zmc2V0SGVpZ2h0LE1hdGgubWF4KG9wdGlvbnMubWluRnJhbWVIZWlnaHQsIG9wdGlvbnMuaW5pdGlhbEZyYW1lSGVpZ2h0KSk7DQogICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRIZWlnaHQgIT0gbGFzdEhlaWdodCkgew0KDQogICAgICAgICAgICAgICAgICAgIG1lLnNldEhlaWdodChjdXJyZW50SGVpZ2h0LHRydWUpOw0KDQogICAgICAgICAgICAgICAgICAgIGxhc3RIZWlnaHQgPSBjdXJyZW50SGVpZ2h0Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUodG1wTm9kZSk7DQoNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwgNTApOw0KICAgIH0NCiAgICB2YXIgaXNGdWxsc2NyZWVuOw0KICAgIG1lLmFkZExpc3RlbmVyKCdmdWxsc2NyZWVuY2hhbmdlZCcsZnVuY3Rpb24oY21kLGYpew0KICAgICAgICBpc0Z1bGxzY3JlZW4gPSBmDQogICAgfSk7DQogICAgbWUuYWRkTGlzdGVuZXIoJ2Rlc3Ryb3knLCBmdW5jdGlvbiAoKSB7DQogICAgICAgIG1lLnJlbW92ZUxpc3RlbmVyKCdjb250ZW50Y2hhbmdlIGFmdGVyaW5zZXJ0aHRtbCBrZXl1cCBtb3VzZXVwJyxhZGp1c3RIZWlnaHQpDQogICAgfSk7DQogICAgbWUuZW5hYmxlQXV0b0hlaWdodCA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgdmFyIG1lID0gdGhpczsNCiAgICAgICAgaWYgKCFtZS5hdXRvSGVpZ2h0RW5hYmxlZCkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICAgIHZhciBkb2MgPSBtZS5kb2N1bWVudDsNCiAgICAgICAgbWUuYXV0b0hlaWdodEVuYWJsZWQgPSB0cnVlOw0KICAgICAgICBiYWtPdmVyZmxvdyA9IGRvYy5ib2R5LnN0eWxlLm92ZXJmbG93WTsNCiAgICAgICAgZG9jLmJvZHkuc3R5bGUub3ZlcmZsb3dZID0gJ2hpZGRlbic7DQogICAgICAgIG1lLmFkZExpc3RlbmVyKCdjb250ZW50Y2hhbmdlIGFmdGVyaW5zZXJ0aHRtbCBrZXl1cCBtb3VzZXVwJyxhZGp1c3RIZWlnaHQpOw0KICAgICAgICAvL2Zm5LiN57uZ5LqL5Lu2566X5b6X5LiN5a+5DQoNCiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBhZGp1c3RIZWlnaHQuY2FsbChtZSk7DQogICAgICAgIH0sIGJyb3dzZXIuZ2Vja28gPyAxMDAgOiAwKTsNCiAgICAgICAgbWUuZmlyZUV2ZW50KCdhdXRvaGVpZ2h0Y2hhbmdlZCcsIG1lLmF1dG9IZWlnaHRFbmFibGVkKTsNCiAgICB9Ow0KICAgIG1lLmRpc2FibGVBdXRvSGVpZ2h0ID0gZnVuY3Rpb24gKCkgew0KDQogICAgICAgIG1lLmJvZHkuc3R5bGUub3ZlcmZsb3dZID0gYmFrT3ZlcmZsb3cgfHwgJyc7DQoNCiAgICAgICAgbWUucmVtb3ZlTGlzdGVuZXIoJ2NvbnRlbnRjaGFuZ2UnLCBhZGp1c3RIZWlnaHQpOw0KICAgICAgICBtZS5yZW1vdmVMaXN0ZW5lcigna2V5dXAnLCBhZGp1c3RIZWlnaHQpOw0KICAgICAgICBtZS5yZW1vdmVMaXN0ZW5lcignbW91c2V1cCcsIGFkanVzdEhlaWdodCk7DQogICAgICAgIG1lLmF1dG9IZWlnaHRFbmFibGVkID0gZmFsc2U7DQogICAgICAgIG1lLmZpcmVFdmVudCgnYXV0b2hlaWdodGNoYW5nZWQnLCBtZS5hdXRvSGVpZ2h0RW5hYmxlZCk7DQogICAgfTsNCiAgICBtZS5hZGRMaXN0ZW5lcigncmVhZHknLCBmdW5jdGlvbiAoKSB7DQogICAgICAgIG1lLmVuYWJsZUF1dG9IZWlnaHQoKTsNCiAgICAgICAgLy90cmFjZToxNzY0DQogICAgICAgIHZhciB0aW1lcjsNCiAgICAgICAgZG9tVXRpbHMub24oYnJvd3Nlci5pZSA/IG1lLmJvZHkgOiBtZS5kb2N1bWVudCwgYnJvd3Nlci53ZWJraXQgPyAnZHJhZ292ZXInIDogJ2Ryb3AnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZXIpOw0KICAgICAgICAgICAgdGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICBhZGp1c3RIZWlnaHQuY2FsbCh0aGlzKTsNCiAgICAgICAgICAgIH0sIDEwMCk7DQoNCiAgICAgICAgfSk7DQogICAgfSk7DQoNCg0KfTsNCg0KCi8vL2ltcG9ydCBjb3JlDQovLy9jb21tYW5kcyDmgqzmta7lt6XlhbfmoI8NCi8vL2NvbW1hbmRzTmFtZSAgQXV0b0Zsb2F0LGF1dG9GbG9hdEVuYWJsZWQNCi8vL2NvbW1hbmRzVGl0bGUgIOaCrOa1ruW3peWFt+agjw0KLyoNCiAqICBtb2RpZmllZCBieSBjaGVuZ2NoYW8wMQ0KICoNCiAqICDms6jmhI/vvJog5byV5YWl5q2k5Yqf6IO95ZCO77yM5ZyoSUU25LiL5Lya5bCGYm9keeeahOiDjOaZr+WbvueJh+imhuebluaOie+8gQ0KICovDQogICAgVUUucGx1Z2luc1snYXV0b2Zsb2F0J10gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgdmFyIG1lID0gdGhpcywNCiAgICAgICAgICAgICAgICBsYW5nID0gbWUuZ2V0TGFuZygpOw0KICAgICAgICBtZS5zZXRPcHQoew0KICAgICAgICAgICAgdG9wT2Zmc2V0OjANCiAgICAgICAgfSk7DQogICAgICAgIHZhciBvcHRzQXV0b0Zsb2F0RW5hYmxlZCA9IG1lLm9wdGlvbnMuYXV0b0Zsb2F0RW5hYmxlZCAhPT0gZmFsc2UsDQogICAgICAgIHRvcE9mZnNldCA9IG1lLm9wdGlvbnMudG9wT2Zmc2V0Ow0KDQoNCiAgICAgICAgLy/lpoLmnpzkuI3lm7rlrpp0b29sYmFy55qE5L2N572u77yM5YiZ55u05o6l6YCA5Ye6DQogICAgICAgIGlmKCFvcHRzQXV0b0Zsb2F0RW5hYmxlZCl7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgdmFyIHVpVXRpbHMgPSBVRS51aS51aVV0aWxzLA0KICAgICAgIAkJTHRlSUU2ID0gYnJvd3Nlci5pZSAmJiBicm93c2VyLnZlcnNpb24gPD0gNiwNCiAgICAgICAgICAgIHF1aXJrcyA9IGJyb3dzZXIucXVpcmtzOw0KDQogICAgICAgIGZ1bmN0aW9uIGNoZWNrSGFzVUkoKXsNCiAgICAgICAgICAgaWYoIVVFLnVpKXsNCiAgICAgICAgICAgICAgYWxlcnQobGFuZy5hdXRvZmxvYXRNc2cpOw0KICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgIH0NCiAgICAgICAgICAgcmV0dXJuIDE7DQogICAgICAgfQ0KICAgICAgICBmdW5jdGlvbiBmaXhJRTZGaXhlZFBvcygpew0KICAgICAgICAgICAgdmFyIGRvY1N0eWxlID0gZG9jdW1lbnQuYm9keS5zdHlsZTsNCiAgICAgICAgICAgZG9jU3R5bGUuYmFja2dyb3VuZEltYWdlID0gJ3VybCgiYWJvdXQ6YmxhbmsiKSc7DQogICAgICAgICAgIGRvY1N0eWxlLmJhY2tncm91bmRBdHRhY2htZW50ID0gJ2ZpeGVkJzsNCiAgICAgICAgfQ0KCQl2YXIJYmFrQ3NzVGV4dCwNCgkJCXBsYWNlSG9sZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksDQogICAgICAgICAgICB0b29sYmFyQm94LG9yZ1RvcCwNCiAgICAgICAgICAgIGdldFBvc2l0aW9uLA0KICAgICAgICAgICAgZmxhZyA9dHJ1ZTsgICAvL2llN+aooeW8j+S4i+mcgOimgeWBj+enuw0KCQlmdW5jdGlvbiBzZXRGbG9hdGluZygpew0KCQkJdmFyIHRvb2JhckJveFBvcyA9IGRvbVV0aWxzLmdldFhZKHRvb2xiYXJCb3gpLA0KCQkJCW9yaWdhbEZsb2F0ID0gZG9tVXRpbHMuZ2V0Q29tcHV0ZWRTdHlsZSh0b29sYmFyQm94LCdwb3NpdGlvbicpLA0KICAgICAgICAgICAgICAgIG9yaWdhbExlZnQgPSBkb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKHRvb2xiYXJCb3gsJ2xlZnQnKTsNCgkJCXRvb2xiYXJCb3guc3R5bGUud2lkdGggPSB0b29sYmFyQm94Lm9mZnNldFdpZHRoICsgJ3B4JzsNCiAgICAgICAgICAgIHRvb2xiYXJCb3guc3R5bGUuekluZGV4ID0gbWUub3B0aW9ucy56SW5kZXggKiAxICsgMTsNCgkJCXRvb2xiYXJCb3gucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUocGxhY2VIb2xkZXIsIHRvb2xiYXJCb3gpOw0KCQkJaWYgKEx0ZUlFNiB8fCAocXVpcmtzICYmIGJyb3dzZXIuaWUpKSB7DQogICAgICAgICAgICAgICAgaWYodG9vbGJhckJveC5zdHlsZS5wb3NpdGlvbiAhPSAnYWJzb2x1dGUnKXsNCiAgICAgICAgICAgICAgICAgICAgdG9vbGJhckJveC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRvb2xiYXJCb3guc3R5bGUudG9wID0gKGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wfHxkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wKSAtIG9yZ1RvcCArIHRvcE9mZnNldCAgKyAncHgnOw0KCQkJfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpZiAoYnJvd3Nlci5pZTdDb21wYXQgJiYgZmxhZykgew0KICAgICAgICAgICAgICAgICAgICBmbGFnID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHRvb2xiYXJCb3guc3R5bGUubGVmdCA9ICBkb21VdGlscy5nZXRYWSh0b29sYmFyQm94KS54IC0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQrMiAgKyAncHgnOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZih0b29sYmFyQm94LnN0eWxlLnBvc2l0aW9uICE9ICdmaXhlZCcpew0KICAgICAgICAgICAgICAgICAgICB0b29sYmFyQm94LnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJzsNCiAgICAgICAgICAgICAgICAgICAgdG9vbGJhckJveC5zdHlsZS50b3AgPSB0b3BPZmZzZXQgKyJweCI7DQogICAgICAgICAgICAgICAgICAgICgob3JpZ2FsRmxvYXQgPT0gJ2Fic29sdXRlJyB8fCBvcmlnYWxGbG9hdCA9PSAncmVsYXRpdmUnKSAmJiBwYXJzZUZsb2F0KG9yaWdhbExlZnQpKSAmJiAodG9vbGJhckJveC5zdHlsZS5sZWZ0ID0gdG9vYmFyQm94UG9zLnggKyAncHgnKTsNCiAgICAgICAgICAgICAgICB9DQoJCQl9DQoJCX0NCgkJZnVuY3Rpb24gdW5zZXRGbG9hdGluZygpew0KICAgICAgICAgICAgZmxhZyA9IHRydWU7DQogICAgICAgICAgICBpZihwbGFjZUhvbGRlci5wYXJlbnROb2RlKXsNCiAgICAgICAgICAgICAgICBwbGFjZUhvbGRlci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHBsYWNlSG9sZGVyKTsNCiAgICAgICAgICAgIH0NCgkJCXRvb2xiYXJCb3guc3R5bGUuY3NzVGV4dCA9IGJha0Nzc1RleHQ7DQoJCX0NCg0KICAgICAgICBmdW5jdGlvbiB1cGRhdGVGbG9hdGluZygpew0KICAgICAgICAgICAgdmFyIHJlY3QzID0gZ2V0UG9zaXRpb24obWUuY29udGFpbmVyKTsNCiAgICAgICAgICAgIHZhciBvZmZzZXQ9bWUub3B0aW9ucy50b29sYmFyVG9wT2Zmc2V0fHwwOw0KICAgICAgICAgICAgaWYgKHJlY3QzLnRvcCA8IDAgJiYgcmVjdDMuYm90dG9tIC0gdG9vbGJhckJveC5vZmZzZXRIZWlnaHQgPiBvZmZzZXQpIHsNCiAgICAgICAgICAgICAgICBzZXRGbG9hdGluZygpOw0KICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgdW5zZXRGbG9hdGluZygpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHZhciBkZWZlcl91cGRhdGVGbG9hdGluZyA9IHV0aWxzLmRlZmVyKGZ1bmN0aW9uKCl7DQogICAgICAgICAgICB1cGRhdGVGbG9hdGluZygpOw0KICAgICAgICB9LGJyb3dzZXIuaWUgPyAyMDAgOiAxMDAsdHJ1ZSk7DQoNCiAgICAgICAgbWUuYWRkTGlzdGVuZXIoJ2Rlc3Ryb3knLGZ1bmN0aW9uKCl7DQogICAgICAgICAgICBkb21VdGlscy51bih3aW5kb3csIFsnc2Nyb2xsJywncmVzaXplJ10sIHVwZGF0ZUZsb2F0aW5nKTsNCiAgICAgICAgICAgIG1lLnJlbW92ZUxpc3RlbmVyKCdrZXlkb3duJywgZGVmZXJfdXBkYXRlRmxvYXRpbmcpOw0KICAgICAgICB9KTsNCg0KICAgICAgICBtZS5hZGRMaXN0ZW5lcigncmVhZHknLCBmdW5jdGlvbigpew0KICAgICAgICAgICAgaWYoY2hlY2tIYXNVSShtZSkpew0KDQogICAgICAgICAgICAgICAgZ2V0UG9zaXRpb24gPSB1aVV0aWxzLmdldENsaWVudFJlY3Q7DQogICAgICAgICAgICAgICAgdG9vbGJhckJveCA9IG1lLnVpLmdldERvbSgndG9vbGJhcmJveCcpOw0KICAgICAgICAgICAgICAgIG9yZ1RvcCA9IGdldFBvc2l0aW9uKHRvb2xiYXJCb3gpLnRvcDsNCiAgICAgICAgICAgICAgICBiYWtDc3NUZXh0ID0gdG9vbGJhckJveC5zdHlsZS5jc3NUZXh0Ow0KICAgICAgICAgICAgICAgIHBsYWNlSG9sZGVyLnN0eWxlLmhlaWdodCA9IHRvb2xiYXJCb3gub2Zmc2V0SGVpZ2h0ICsgJ3B4JzsNCiAgICAgICAgICAgICAgICBpZihMdGVJRTYpew0KICAgICAgICAgICAgICAgICAgICBmaXhJRTZGaXhlZFBvcygpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBkb21VdGlscy5vbih3aW5kb3csIFsnc2Nyb2xsJywncmVzaXplJ10sIHVwZGF0ZUZsb2F0aW5nKTsNCiAgICAgICAgICAgICAgICBtZS5hZGRMaXN0ZW5lcigna2V5ZG93bicsIGRlZmVyX3VwZGF0ZUZsb2F0aW5nKTsNCg0KICAgICAgICAgICAgICAgIG1lLmFkZExpc3RlbmVyKCdiZWZvcmVmdWxsc2NyZWVuY2hhbmdlJywgZnVuY3Rpb24gKHQsIGVuYWJsZWQpew0KICAgICAgICAgICAgICAgICAgICBpZiAoZW5hYmxlZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdW5zZXRGbG9hdGluZygpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgbWUuYWRkTGlzdGVuZXIoJ2Z1bGxzY3JlZW5jaGFuZ2VkJywgZnVuY3Rpb24gKHQsIGVuYWJsZWQpew0KICAgICAgICAgICAgICAgICAgICBpZiAoIWVuYWJsZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZUZsb2F0aW5nKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBtZS5hZGRMaXN0ZW5lcignc291cmNlbW9kZWNoYW5nZWQnLCBmdW5jdGlvbiAodCwgZW5hYmxlZCl7DQogICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCl7DQogICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVGbG9hdGluZygpOw0KICAgICAgICAgICAgICAgICAgICB9LDApOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIG1lLmFkZExpc3RlbmVyKCJjbGVhckRvYyIsZnVuY3Rpb24oKXsNCiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpew0KICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlRmxvYXRpbmcoKTsNCiAgICAgICAgICAgICAgICAgICAgfSwwKTsNCg0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KCX07DQoKLyoqDQogKiBAZGVzY3JpcHRpb24g57qv5paH5pys57KY6LS0DQogKiBAbmFtZSBwdXJldHh0cGFzdGUNCiAqIEBhdXRob3IgemhhbnlpDQogKi8NCg0KVUUucGx1Z2luc1sncGFzdGVwbGFpbiddID0gZnVuY3Rpb24oKXsNCiAgICB2YXIgbWUgPSB0aGlzOw0KICAgIG1lLnNldE9wdCh7DQogICAgICAgICdwYXN0ZXBsYWluJzpmYWxzZSwNCiAgICAgICAgJ2ZpbHRlclR4dFJ1bGVzJyA6IGZ1bmN0aW9uKCl7DQogICAgICAgICAgICBmdW5jdGlvbiB0cmFuc1Aobm9kZSl7DQogICAgICAgICAgICAgICAgbm9kZS50YWdOYW1lID0gJ3AnOw0KICAgICAgICAgICAgICAgIG5vZGUuc2V0U3R5bGUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGZ1bmN0aW9uIHJlbW92ZU5vZGUobm9kZSl7DQogICAgICAgICAgICAgICAgbm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUsdHJ1ZSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgLy/nm7TmjqXliKDpmaTlj4rlhbblrZfoioLngrnlhoXlrrkNCiAgICAgICAgICAgICAgICAnLScgOiAnc2NyaXB0IHN0eWxlIG9iamVjdCBpZnJhbWUgZW1iZWQgaW5wdXQgc2VsZWN0JywNCiAgICAgICAgICAgICAgICAncCc6IHskOnt9fSwNCiAgICAgICAgICAgICAgICAnYnInOnskOnt9fSwNCiAgICAgICAgICAgICAgICBkaXY6IGZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciB0bXBOb2RlLCBwID0gVUUudU5vZGUuY3JlYXRlRWxlbWVudCgncCcpOw0KICAgICAgICAgICAgICAgICAgICB3aGlsZSAodG1wTm9kZSA9IG5vZGUuZmlyc3RDaGlsZCgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodG1wTm9kZS50eXBlID09ICd0ZXh0JyB8fCAhVUUuZG9tLmR0ZC4kYmxvY2tbdG1wTm9kZS50YWdOYW1lXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAuYXBwZW5kQ2hpbGQodG1wTm9kZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwLmZpcnN0Q2hpbGQoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHAsIG5vZGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gVUUudU5vZGUuY3JlYXRlRWxlbWVudCgncCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUodG1wTm9kZSwgbm9kZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmIChwLmZpcnN0Q2hpbGQoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShwLCBub2RlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBub2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobm9kZSk7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBvbDogcmVtb3ZlTm9kZSwNCiAgICAgICAgICAgICAgICB1bDogcmVtb3ZlTm9kZSwNCiAgICAgICAgICAgICAgICBkbDpyZW1vdmVOb2RlLA0KICAgICAgICAgICAgICAgIGR0OnJlbW92ZU5vZGUsDQogICAgICAgICAgICAgICAgZGQ6cmVtb3ZlTm9kZSwNCiAgICAgICAgICAgICAgICAnbGknOnJlbW92ZU5vZGUsDQogICAgICAgICAgICAgICAgJ2NhcHRpb24nOnRyYW5zUCwNCiAgICAgICAgICAgICAgICAndGgnOnRyYW5zUCwNCiAgICAgICAgICAgICAgICAndHInOnRyYW5zUCwNCiAgICAgICAgICAgICAgICAnaDEnOnRyYW5zUCwnaDInOnRyYW5zUCwnaDMnOnRyYW5zUCwnaDQnOnRyYW5zUCwnaDUnOnRyYW5zUCwnaDYnOnRyYW5zUCwNCiAgICAgICAgICAgICAgICAndGQnOmZ1bmN0aW9uKG5vZGUpew0KICAgICAgICAgICAgICAgICAgICAgICAgLy/msqHmnInlhoXlrrnnmoR0ZOebtOaOpeWIoOaOiQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHR4dCA9ICEhbm9kZS5pbm5lclRleHQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHR4dCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5wYXJlbnROb2RlLmluc2VydEFmdGVyKFVFLnVOb2RlLmNyZWF0ZVRleHQoJyAmbmJzcDsgJm5ic3A7Jyksbm9kZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgbm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUsbm9kZS5pbm5lclRleHQoKSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0oKQ0KICAgIH0pOw0KICAgIC8v5pqC5pe26L+Z6YeM5pSv5oyB5LiA5LiL6ICB54mI5pys55qE5bGe5oCnDQogICAgdmFyIHBhc3RlcGxhaW4gPSBtZS5vcHRpb25zLnBhc3RlcGxhaW47DQoNCiAgICBtZS5jb21tYW5kc1sncGFzdGVwbGFpbiddID0gew0KICAgICAgICBxdWVyeUNvbW1hbmRTdGF0ZTogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICByZXR1cm4gcGFzdGVwbGFpbiA/IDEgOiAwOw0KICAgICAgICB9LA0KICAgICAgICBleGVjQ29tbWFuZDogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICBwYXN0ZXBsYWluID0gIXBhc3RlcGxhaW58MDsNCiAgICAgICAgfSwNCiAgICAgICAgbm90TmVlZFVuZG8gOiAxDQogICAgfTsNCn07Ci8vL2ltcG9ydCBjb3JlDQovLy9pbXBvcnQgcGx1Z2lucy9pbnNlcnRodG1sLmpzDQovLy9jb21tYW5kcyDop4bpopENCi8vL2NvbW1hbmRzTmFtZSBJbnNlcnRWaWRlbw0KLy8vY29tbWFuZHNUaXRsZSAg5o+S5YWl6KeG6aKRDQovLy9jb21tYW5kc0RpYWxvZyAgZGlhbG9nc1x2aWRlbw0KVUUucGx1Z2luc1sndmlkZW8nXSA9IGZ1bmN0aW9uICgpew0KICAgIHZhciBtZSA9dGhpcywNCiAgICAgICAgZGl2Ow0KDQogICAgLyoqDQogICAgICog5Yib5bu65o+S5YWl6KeG6aKR5a2X56ym56qcDQogICAgICogQHBhcmFtIHVybCDop4bpopHlnLDlnYANCiAgICAgKiBAcGFyYW0gd2lkdGgg6KeG6aKR5a695bqmDQogICAgICogQHBhcmFtIGhlaWdodCDop4bpopHpq5jluqYNCiAgICAgKiBAcGFyYW0gYWxpZ24g6KeG6aKR5a+56b2QDQogICAgICogQHBhcmFtIHRvRW1iZWQg5piv5ZCm5LulZmxhc2jku6Pmm7/mmL7npLoNCiAgICAgKiBAcGFyYW0gYWRkUGFyYWdyYXBoICDmmK/lkKbpnIDopoHmt7vliqBQIOagh+etvg0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGNyZWF0SW5zZXJ0U3RyKHVybCx3aWR0aCxoZWlnaHQsaWQsYWxpZ24sdG9FbWJlZCl7DQogICAgICAgIHJldHVybiAgIXRvRW1iZWQgPw0KDQogICAgICAgICAgICAgICAgJzxpbWcgJyArIChpZCA/ICdpZD0iJyArIGlkKyciJyA6ICcnKSArICcgd2lkdGg9IicrIHdpZHRoICsnIiBoZWlnaHQ9IicgKyBoZWlnaHQgKyAnIiBfdXJsPSInK3VybCsnIiBjbGFzcz0iZWR1aS1mYWtlZC12aWRlbyInICArDQogICAgICAgICAgICAgICAgJyBzcmM9IicgKyBtZS5vcHRpb25zLlVFRElUT1JfSE9NRV9VUkwrJ3RoZW1lcy9kZWZhdWx0L2ltYWdlcy9zcGFjZXIuZ2lmIiBzdHlsZT0iYmFja2dyb3VuZDp1cmwoJyttZS5vcHRpb25zLlVFRElUT1JfSE9NRV9VUkwrJ3RoZW1lcy9kZWZhdWx0L2ltYWdlcy92aWRlb2xvZ28uZ2lmKSBuby1yZXBlYXQgY2VudGVyIGNlbnRlcjsgYm9yZGVyOjFweCBzb2xpZCBncmF5OycrKGFsaWduID8gJ2Zsb2F0OicgKyBhbGlnbiArICc7JzogJycpKyciIC8+Jw0KDQogICAgICAgICAgICAgICAgOg0KICAgICAgICAgICAgICAgICc8ZW1iZWQgdHlwZT0iYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2giIGNsYXNzPSJlZHVpLWZha2VkLXZpZGVvIiBwbHVnaW5zcGFnZT0iaHR0cDovL3d3dy5tYWNyb21lZGlhLmNvbS9nby9nZXRmbGFzaHBsYXllciInICsNCiAgICAgICAgICAgICAgICAnIHNyYz0iJyArIHVybCArICciIHdpZHRoPSInICsgd2lkdGggICsgJyIgaGVpZ2h0PSInICsgaGVpZ2h0ICArICciJyAgKyAoYWxpZ24gPyAnIHN0eWxlPSJmbG9hdDonICsgYWxpZ24gKyAnIic6ICcnKSArDQogICAgICAgICAgICAgICAgJyB3bW9kZT0idHJhbnNwYXJlbnQiIHBsYXk9InRydWUiIGxvb3A9ImZhbHNlIiBtZW51PSJmYWxzZSIgYWxsb3dzY3JpcHRhY2Nlc3M9Im5ldmVyIiBhbGxvd2Z1bGxzY3JlZW49InRydWUiID4nOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHN3aXRjaEltZ0FuZEVtYmVkKHJvb3QsaW1nMmVtYmVkKXsNCiAgICAgICAgdXRpbHMuZWFjaChyb290LmdldE5vZGVzQnlUYWdOYW1lKGltZzJlbWJlZCA/ICdpbWcnIDogJ2VtYmVkJyksZnVuY3Rpb24obm9kZSl7DQogICAgICAgICAgICBpZihub2RlLmdldEF0dHIoJ2NsYXNzJykgPT0gJ2VkdWktZmFrZWQtdmlkZW8nKXsNCg0KICAgICAgICAgICAgICAgIHZhciBodG1sID0gY3JlYXRJbnNlcnRTdHIoIGltZzJlbWJlZCA/IG5vZGUuZ2V0QXR0cignX3VybCcpIDogbm9kZS5nZXRBdHRyKCdzcmMnKSxub2RlLmdldEF0dHIoJ3dpZHRoJyksbm9kZS5nZXRBdHRyKCdoZWlnaHQnKSxudWxsLG5vZGUuZ2V0U3R5bGUoJ2Zsb2F0JykgfHwgJycsaW1nMmVtYmVkKTsNCiAgICAgICAgICAgICAgICBub2RlLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKFVFLnVOb2RlLmNyZWF0ZUVsZW1lbnQoaHRtbCksbm9kZSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICB9DQoNCiAgICBtZS5hZGRPdXRwdXRSdWxlKGZ1bmN0aW9uKHJvb3Qpew0KICAgICAgICBzd2l0Y2hJbWdBbmRFbWJlZChyb290LHRydWUpDQogICAgfSk7DQogICAgbWUuYWRkSW5wdXRSdWxlKGZ1bmN0aW9uKHJvb3Qpew0KICAgICAgICBzd2l0Y2hJbWdBbmRFbWJlZChyb290KQ0KICAgIH0pOw0KDQogICAgbWUuY29tbWFuZHNbImluc2VydHZpZGVvIl0gPSB7DQogICAgICAgIGV4ZWNDb21tYW5kOiBmdW5jdGlvbiAoY21kLCB2aWRlb09ianMpew0KICAgICAgICAgICAgdmlkZW9PYmpzID0gdXRpbHMuaXNBcnJheSh2aWRlb09ianMpP3ZpZGVvT2JqczpbdmlkZW9PYmpzXTsNCiAgICAgICAgICAgIHZhciBodG1sID0gW10saWQgPSAndG1wVmVkaW8nOw0KICAgICAgICAgICAgZm9yKHZhciBpPTAsdmksbGVuID0gdmlkZW9PYmpzLmxlbmd0aDtpPGxlbjtpKyspew0KICAgICAgICAgICAgICAgICB2aSA9IHZpZGVvT2Jqc1tpXTsNCiAgICAgICAgICAgICAgICAgaHRtbC5wdXNoKGNyZWF0SW5zZXJ0U3RyKCB2aS51cmwsIHZpLndpZHRoIHx8IDQyMCwgIHZpLmhlaWdodCB8fCAyODAsIGlkICsgaSxudWxsLGZhbHNlKSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBtZS5leGVjQ29tbWFuZCgiaW5zZXJ0aHRtbCIsaHRtbC5qb2luKCIiKSx0cnVlKTsNCiAgICAgICAgICAgIHZhciBybmcgPSB0aGlzLnNlbGVjdGlvbi5nZXRSYW5nZSgpOw0KICAgICAgICAgICAgZm9yKHZhciBpPSAwLGxlbj12aWRlb09ianMubGVuZ3RoO2k8bGVuO2krKyl7DQogICAgICAgICAgICAgICAgdmFyIGltZyA9IHRoaXMuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RtcFZlZGlvJytpKTsNCiAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmVBdHRyaWJ1dGVzKGltZywnaWQnKTsNCiAgICAgICAgICAgICAgICBybmcuc2VsZWN0Tm9kZShpbWcpLnNlbGVjdCgpOw0KICAgICAgICAgICAgICAgIG1lLmV4ZWNDb21tYW5kKCdpbWFnZWZsb2F0Jyx2aWRlb09ianNbaV0uYWxpZ24pDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIHF1ZXJ5Q29tbWFuZFN0YXRlIDogZnVuY3Rpb24oKXsNCiAgICAgICAgICAgIHZhciBpbWcgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKS5nZXRDbG9zZWROb2RlKCksDQogICAgICAgICAgICAgICAgZmxhZyA9IGltZyAmJiAoaW1nLmNsYXNzTmFtZSA9PSAiZWR1aS1mYWtlZC12aWRlbyIpOw0KICAgICAgICAgICAgcmV0dXJuIGZsYWcgPyAxIDogMDsNCiAgICAgICAgfQ0KICAgIH07DQp9OwovKioNCiAqIENyZWF0ZWQgd2l0aCBKZXRCcmFpbnMgV2ViU3Rvcm0uDQogKiBVc2VyOiB0YW9xaWxpDQogKiBEYXRlOiAxMy0xLTE4DQogKiBUaW1lOiDkuIrljYgxMTowOQ0KICogVG8gY2hhbmdlIHRoaXMgdGVtcGxhdGUgdXNlIEZpbGUgfCBTZXR0aW5ncyB8IEZpbGUgVGVtcGxhdGVzLg0KICovDQovKioNCiAqIFVF6KGo5qC85pON5L2c57G7DQogKiBAcGFyYW0gdGFibGUNCiAqIEBjb25zdHJ1Y3Rvcg0KICovDQooZnVuY3Rpb24gKCkgew0KICAgIHZhciBVRVRhYmxlID0gVUUuVUVUYWJsZSA9IGZ1bmN0aW9uICh0YWJsZSkgew0KICAgICAgICB0aGlzLnRhYmxlID0gdGFibGU7DQogICAgICAgIHRoaXMuaW5kZXhUYWJsZSA9IFtdOw0KICAgICAgICB0aGlzLnNlbGVjdGVkVGRzID0gW107DQogICAgICAgIHRoaXMuY2VsbHNSYW5nZSA9IHt9Ow0KICAgICAgICB0aGlzLnVwZGF0ZSh0YWJsZSk7DQogICAgfTsNCg0KICAgIC8vPT095Lul5LiL5Li66Z2Z5oCB5bel5YW35pa55rOVPT09DQogICAgVUVUYWJsZS5yZW1vdmVTZWxlY3RlZENsYXNzID0gZnVuY3Rpb24gKGNlbGxzKSB7DQogICAgICAgIHV0aWxzLmVhY2goY2VsbHMsIGZ1bmN0aW9uIChjZWxsKSB7DQogICAgICAgICAgICBkb21VdGlscy5yZW1vdmVDbGFzc2VzKGNlbGwsICJzZWxlY3RUZENsYXNzIik7DQogICAgICAgIH0pDQogICAgfTsNCiAgICBVRVRhYmxlLmFkZFNlbGVjdGVkQ2xhc3MgPSBmdW5jdGlvbiAoY2VsbHMpIHsNCiAgICAgICAgdXRpbHMuZWFjaChjZWxscywgZnVuY3Rpb24gKGNlbGwpIHsNCiAgICAgICAgICAgIGRvbVV0aWxzLmFkZENsYXNzKGNlbGwsICJzZWxlY3RUZENsYXNzIik7DQogICAgICAgIH0pDQogICAgfTsNCiAgICBVRVRhYmxlLmlzRW1wdHlCbG9jayA9IGZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgIHZhciByZWcgPSBuZXcgUmVnRXhwKGRvbVV0aWxzLmZpbGxDaGFyLCAnZycpOw0KICAgICAgICBpZiAobm9kZVticm93c2VyLmllID8gJ2lubmVyVGV4dCcgOiAndGV4dENvbnRlbnQnXS5yZXBsYWNlKC9eXHMqJC8sICcnKS5yZXBsYWNlKHJlZywgJycpLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICB9DQogICAgICAgIGZvciAodmFyIGkgaW4gZHRkLiRpc05vdEVtcHR5KSBpZiAoZHRkLiRpc05vdEVtcHR5Lmhhc093blByb3BlcnR5KGkpKSB7DQogICAgICAgICAgICBpZiAobm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZShpKS5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gMTsNCiAgICB9Ow0KICAgIFVFVGFibGUuZ2V0V2lkdGggPSBmdW5jdGlvbiAoY2VsbCkgew0KICAgICAgICBpZiAoIWNlbGwpcmV0dXJuIDA7DQogICAgICAgIHJldHVybiBwYXJzZUludChkb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKGNlbGwsICJ3aWR0aCIpLCAxMCk7DQogICAgfTsNCg0KICAgIC8qKg0KICAgICAqIOiOt+WPluWNleWFg+agvOaIluiAheWNleWFg+agvOe7hOeahOKAnOWvuem9kOKAneeKtuaAgeOAgiDlpoLmnpzlvZPliY3nmoTmo4DmtYvlr7nosaHmmK/kuIDkuKrljZXlhYPmoLznu4TvvIwg5Y+q5pyJ5Zyo5ruh6Laz5omA5pyJ5Y2V5YWD5qC855qEIOawtOW5s+WSjOerluebtCDlr7npvZDlsZ7mgKfpg73nm7jlkIznmoQNCiAgICAgKiDmnaHku7bml7bmiY3kvJrov5Tlm57lhbbnirbmgIHlgLzvvIzlkKbliJnlsIbov5Tlm55udWxs77ybIOWmguaenOW9k+WJjeWPquajgOa1i+S6huS4gOS4quWNleWFg+agvO+8jCDliJnnm7TmjqXov5Tlm57lvZPliY3ljZXlhYPmoLznmoTlr7npvZDnirbmgIHvvJsNCiAgICAgKiBAcGFyYW0gdGFibGUgY2VsbCBvciB0YWJsZSBjZWxscyAsIOaUr+aMgeWNleS4quWNleWFg+agvGRvbeWvueixoSDmiJbogIUg5Y2V5YWD5qC8ZG9t5a+56LGh5pWw57uEDQogICAgICogQHJldHVybiB7IGFsaWduOiAnbGVmdCcgfHwgJ3JpZ2h0JyB8fCAnY2VudGVyJywgdmFsaWduOiAndG9wJyB8fCAnbWlkZGxlJyB8fCAnYm90dG9tJyB9IOaIluiAhSBudWxsDQogICAgICovDQogICAgVUVUYWJsZS5nZXRUYWJsZUNlbGxBbGlnblN0YXRlID0gZnVuY3Rpb24gKCBjZWxscyApIHsNCg0KICAgICAgICAhdXRpbHMuaXNBcnJheSggY2VsbHMgKSAmJiAoIGNlbGxzID0gW2NlbGxzXSApOw0KDQogICAgICAgIHZhciByZXN1bHQgPSB7fSwNCiAgICAgICAgICAgIHN0YXR1cyA9IFsnYWxpZ24nLCAndmFsaWduJ10sDQogICAgICAgICAgICB0ZW1wU3RhdHVzID0gbnVsbCwNCiAgICAgICAgICAgIGlzU2FtZSA9IHRydWU7Ly/nirbmgIHmmK/lkKbnm7jlkIwNCg0KICAgICAgICB1dGlscy5lYWNoKCBjZWxscywgZnVuY3Rpb24oIGNlbGxOb2RlICl7DQoNCiAgICAgICAgICAgIHV0aWxzLmVhY2goIHN0YXR1cywgZnVuY3Rpb24oIGN1cnJlbnRTdGF0ZSApew0KDQogICAgICAgICAgICAgICAgdGVtcFN0YXR1cyA9IGNlbGxOb2RlLmdldEF0dHJpYnV0ZSggY3VycmVudFN0YXRlICk7DQoNCiAgICAgICAgICAgICAgICBpZiggIXJlc3VsdFsgY3VycmVudFN0YXRlIF0gJiYgdGVtcFN0YXR1cyApIHsNCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0WyBjdXJyZW50U3RhdGUgXSA9IHRlbXBTdGF0dXM7DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmKCAhcmVzdWx0WyBjdXJyZW50U3RhdGUgXSB8fCAoIHRlbXBTdGF0dXMgIT09IHJlc3VsdFsgY3VycmVudFN0YXRlIF0gKSApIHsNCiAgICAgICAgICAgICAgICAgICAgaXNTYW1lID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgcmV0dXJuIGlzU2FtZTsNCg0KICAgICAgICB9KTsNCg0KICAgICAgICByZXR1cm4gaXNTYW1lID8gcmVzdWx0IDogbnVsbDsNCg0KICAgIH07DQoNCiAgICAvKioNCiAgICAgKiDmoLnmja7lvZPliY3pgInljLrojrflj5bnm7jlhbPnmoR0YWJsZeS/oeaBrw0KICAgICAqIEByZXR1cm4ge09iamVjdH0NCiAgICAgKi8NCiAgICBVRVRhYmxlLmdldFRhYmxlSXRlbXNCeVJhbmdlID0gZnVuY3Rpb24gKGVkaXRvcikgew0KICAgICAgICB2YXIgc3RhcnQgPSBlZGl0b3Iuc2VsZWN0aW9uLmdldFN0YXJ0KCk7DQoNCiAgICAgICAgLy9mZuS4i+S8mumAieS4rWJvb2ttYXJrDQogICAgICAgIGlmKCBzdGFydCAmJiBzdGFydC5pZCAmJiBzdGFydC5pZC5pbmRleE9mKCdfYmFpZHVfYm9va21hcmtfc3RhcnRfJykgPT09IDAgKSB7DQogICAgICAgICAgICBzdGFydCA9IHN0YXJ0Lm5leHRTaWJsaW5nOw0KICAgICAgICB9DQoNCiAgICAgICAgLy/lnKh0YWJsZeaIluiAhXRk6L6557yY5pyJ5Y+v6IO95a2Y5Zyo6YCJ5LitdHLnmoTmg4XlhrUNCiAgICAgICAgdmFyIGNlbGwgPSBzdGFydCAmJiBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKHN0YXJ0LCBbInRkIiwgInRoIl0sIHRydWUpLA0KICAgICAgICAgICAgdHIgPSBjZWxsICYmIGNlbGwucGFyZW50Tm9kZSwNCiAgICAgICAgICAgIGNhcHRpb24gPSBzdGFydCAmJiBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKHN0YXJ0LCAnY2FwdGlvbicsIHRydWUpLA0KICAgICAgICAgICAgdGFibGUgPSBjYXB0aW9uID8gY2FwdGlvbi5wYXJlbnROb2RlIDogdHIgJiYgdHIucGFyZW50Tm9kZS5wYXJlbnROb2RlOw0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBjZWxsOmNlbGwsDQogICAgICAgICAgICB0cjp0ciwNCiAgICAgICAgICAgIHRhYmxlOnRhYmxlLA0KICAgICAgICAgICAgY2FwdGlvbjpjYXB0aW9uDQogICAgICAgIH0NCiAgICB9Ow0KICAgIFVFVGFibGUuZ2V0VUVUYWJsZUJ5U2VsZWN0ZWQgPSBmdW5jdGlvbiAoZWRpdG9yKSB7DQogICAgICAgIHZhciB0YWJsZSA9IFVFVGFibGUuZ2V0VGFibGVJdGVtc0J5UmFuZ2UoZWRpdG9yKS50YWJsZTsNCiAgICAgICAgaWYgKHRhYmxlICYmIHRhYmxlLnVlVGFibGUgJiYgdGFibGUudWVUYWJsZS5zZWxlY3RlZFRkcy5sZW5ndGgpIHsNCiAgICAgICAgICAgIHJldHVybiB0YWJsZS51ZVRhYmxlOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBudWxsOw0KICAgIH07DQoNCiAgICBVRVRhYmxlLmdldERlZmF1bHRWYWx1ZSA9IGZ1bmN0aW9uIChlZGl0b3IsIHRhYmxlKSB7DQogICAgICAgIHZhciBib3JkZXJNYXAgPSB7DQogICAgICAgICAgICAgICAgdGhpbjonMHB4JywNCiAgICAgICAgICAgICAgICBtZWRpdW06JzFweCcsDQogICAgICAgICAgICAgICAgdGhpY2s6JzJweCcNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB0YWJsZUJvcmRlciwgdGRQYWRkaW5nLCB0ZEJvcmRlciwgdG1wVmFsdWU7DQogICAgICAgIGlmICghdGFibGUpIHsNCiAgICAgICAgICAgIHRhYmxlID0gZWRpdG9yLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RhYmxlJyk7DQogICAgICAgICAgICB0YWJsZS5pbnNlcnRSb3coMCkuaW5zZXJ0Q2VsbCgwKS5pbm5lckhUTUwgPSAneHh4JzsNCiAgICAgICAgICAgIGVkaXRvci5ib2R5LmFwcGVuZENoaWxkKHRhYmxlKTsNCiAgICAgICAgICAgIHZhciB0ZCA9IHRhYmxlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0ZCcpWzBdOw0KICAgICAgICAgICAgdG1wVmFsdWUgPSBkb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKHRhYmxlLCAnYm9yZGVyLWxlZnQtd2lkdGgnKTsNCiAgICAgICAgICAgIHRhYmxlQm9yZGVyID0gcGFyc2VJbnQoYm9yZGVyTWFwW3RtcFZhbHVlXSB8fCB0bXBWYWx1ZSwgMTApOw0KICAgICAgICAgICAgdG1wVmFsdWUgPSBkb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKHRkLCAncGFkZGluZy1sZWZ0Jyk7DQogICAgICAgICAgICB0ZFBhZGRpbmcgPSBwYXJzZUludChib3JkZXJNYXBbdG1wVmFsdWVdIHx8IHRtcFZhbHVlLCAxMCk7DQogICAgICAgICAgICB0bXBWYWx1ZSA9IGRvbVV0aWxzLmdldENvbXB1dGVkU3R5bGUodGQsICdib3JkZXItbGVmdC13aWR0aCcpOw0KICAgICAgICAgICAgdGRCb3JkZXIgPSBwYXJzZUludChib3JkZXJNYXBbdG1wVmFsdWVdIHx8IHRtcFZhbHVlLCAxMCk7DQogICAgICAgICAgICBkb21VdGlscy5yZW1vdmUodGFibGUpOw0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICB0YWJsZUJvcmRlcjp0YWJsZUJvcmRlciwNCiAgICAgICAgICAgICAgICB0ZFBhZGRpbmc6dGRQYWRkaW5nLA0KICAgICAgICAgICAgICAgIHRkQm9yZGVyOnRkQm9yZGVyDQogICAgICAgICAgICB9Ow0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGQgPSB0YWJsZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGQnKVswXTsNCiAgICAgICAgICAgIHRtcFZhbHVlID0gZG9tVXRpbHMuZ2V0Q29tcHV0ZWRTdHlsZSh0YWJsZSwgJ2JvcmRlci1sZWZ0LXdpZHRoJyk7DQogICAgICAgICAgICB0YWJsZUJvcmRlciA9IHBhcnNlSW50KGJvcmRlck1hcFt0bXBWYWx1ZV0gfHwgdG1wVmFsdWUsIDEwKTsNCiAgICAgICAgICAgIHRtcFZhbHVlID0gZG9tVXRpbHMuZ2V0Q29tcHV0ZWRTdHlsZSh0ZCwgJ3BhZGRpbmctbGVmdCcpOw0KICAgICAgICAgICAgdGRQYWRkaW5nID0gcGFyc2VJbnQoYm9yZGVyTWFwW3RtcFZhbHVlXSB8fCB0bXBWYWx1ZSwgMTApOw0KICAgICAgICAgICAgdG1wVmFsdWUgPSBkb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKHRkLCAnYm9yZGVyLWxlZnQtd2lkdGgnKTsNCiAgICAgICAgICAgIHRkQm9yZGVyID0gcGFyc2VJbnQoYm9yZGVyTWFwW3RtcFZhbHVlXSB8fCB0bXBWYWx1ZSwgMTApOw0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICB0YWJsZUJvcmRlcjp0YWJsZUJvcmRlciwNCiAgICAgICAgICAgICAgICB0ZFBhZGRpbmc6dGRQYWRkaW5nLA0KICAgICAgICAgICAgICAgIHRkQm9yZGVyOnRkQm9yZGVyDQogICAgICAgICAgICB9Ow0KICAgICAgICB9DQogICAgfTsNCiAgICAvKioNCiAgICAgKiDmoLnmja7lvZPliY3ngrnlh7vnmoR0ZOaIluiAhXRhYmxl6I635Y+W57Si5byV5a+56LGhDQogICAgICogQHBhcmFtIHRkT3JUYWJsZQ0KICAgICAqLw0KICAgIFVFVGFibGUuZ2V0VUVUYWJsZSA9IGZ1bmN0aW9uICh0ZE9yVGFibGUpIHsNCiAgICAgICAgdmFyIHRhZyA9IHRkT3JUYWJsZS50YWdOYW1lLnRvTG93ZXJDYXNlKCk7DQogICAgICAgIHRkT3JUYWJsZSA9ICh0YWcgPT0gInRkIiB8fCB0YWcgPT0gInRoIiB8fCB0YWcgPT0gJ2NhcHRpb24nKSA/IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUodGRPclRhYmxlLCAidGFibGUiLCB0cnVlKSA6IHRkT3JUYWJsZTsNCiAgICAgICAgaWYgKCF0ZE9yVGFibGUudWVUYWJsZSkgew0KICAgICAgICAgICAgdGRPclRhYmxlLnVlVGFibGUgPSBuZXcgVUVUYWJsZSh0ZE9yVGFibGUpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0ZE9yVGFibGUudWVUYWJsZTsNCiAgICB9Ow0KDQogICAgVUVUYWJsZS5jbG9uZUNlbGwgPSBmdW5jdGlvbihjZWxsLGlnbm9yZU1lcmdlLGtlZXBQcm8pew0KICAgICAgICBpZiAoIWNlbGwgfHwgdXRpbHMuaXNTdHJpbmcoY2VsbCkpIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLnRhYmxlLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudChjZWxsIHx8ICd0ZCcpOw0KICAgICAgICB9DQogICAgICAgIHZhciBmbGFnID0gZG9tVXRpbHMuaGFzQ2xhc3MoY2VsbCwgInNlbGVjdFRkQ2xhc3MiKTsNCiAgICAgICAgZmxhZyAmJiBkb21VdGlscy5yZW1vdmVDbGFzc2VzKGNlbGwsICJzZWxlY3RUZENsYXNzIik7DQogICAgICAgIHZhciB0bXBDZWxsID0gY2VsbC5jbG9uZU5vZGUodHJ1ZSk7DQogICAgICAgIGlmIChpZ25vcmVNZXJnZSkgew0KICAgICAgICAgICAgdG1wQ2VsbC5yb3dTcGFuID0gdG1wQ2VsbC5jb2xTcGFuID0gMTsNCiAgICAgICAgfQ0KICAgICAgICAvL+WOu+aOieWuvemrmA0KICAgICAgICAha2VlcFBybyAmJiBkb21VdGlscy5yZW1vdmVBdHRyaWJ1dGVzKHRtcENlbGwsJ3dpZHRoIGhlaWdodCcpOw0KICAgICAgICAha2VlcFBybyAmJiBkb21VdGlscy5yZW1vdmVBdHRyaWJ1dGVzKHRtcENlbGwsJ3N0eWxlJyk7DQoNCiAgICAgICAgdG1wQ2VsbC5zdHlsZS5ib3JkZXJMZWZ0U3R5bGUgPSAiIjsNCiAgICAgICAgdG1wQ2VsbC5zdHlsZS5ib3JkZXJUb3BTdHlsZSA9ICIiOw0KICAgICAgICB0bXBDZWxsLnN0eWxlLmJvcmRlckxlZnRDb2xvciA9IGNlbGwuc3R5bGUuYm9yZGVyUmlnaHRDb2xvcjsNCiAgICAgICAgdG1wQ2VsbC5zdHlsZS5ib3JkZXJMZWZ0V2lkdGggPSBjZWxsLnN0eWxlLmJvcmRlclJpZ2h0V2lkdGg7DQogICAgICAgIHRtcENlbGwuc3R5bGUuYm9yZGVyVG9wQ29sb3IgPSBjZWxsLnN0eWxlLmJvcmRlckJvdHRvbUNvbG9yOw0KICAgICAgICB0bXBDZWxsLnN0eWxlLmJvcmRlclRvcFdpZHRoID0gY2VsbC5zdHlsZS5ib3JkZXJCb3R0b21XaWR0aDsNCiAgICAgICAgZmxhZyAmJiBkb21VdGlscy5hZGRDbGFzcyhjZWxsLCAic2VsZWN0VGRDbGFzcyIpOw0KICAgICAgICByZXR1cm4gdG1wQ2VsbDsNCiAgICB9DQoNCiAgICBVRVRhYmxlLnByb3RvdHlwZSA9IHsNCiAgICAgICAgZ2V0TWF4Um93czpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgcm93cyA9IHRoaXMudGFibGUucm93cywgbWF4TGVuID0gMTsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCByb3c7IHJvdyA9IHJvd3NbaV07IGkrKykgew0KICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TWF4ID0gMTsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgY2o7IGNqID0gcm93LmNlbGxzW2orK107KSB7DQogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRNYXggPSBNYXRoLm1heChjai5yb3dTcGFuIHx8IDEsIGN1cnJlbnRNYXgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBtYXhMZW4gPSBNYXRoLm1heChjdXJyZW50TWF4ICsgaSwgbWF4TGVuKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBtYXhMZW47DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDojrflj5blvZPliY3ooajmoLznmoTmnIDlpKfliJfmlbANCiAgICAgICAgICovDQogICAgICAgIGdldE1heENvbHM6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIHJvd3MgPSB0aGlzLnRhYmxlLnJvd3MsIG1heExlbiA9IDAsIGNlbGxSb3dzID0ge307DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgcm93OyByb3cgPSByb3dzW2ldOyBpKyspIHsNCiAgICAgICAgICAgICAgICB2YXIgY2VsbHNOdW0gPSAwOw0KICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwLCBjajsgY2ogPSByb3cuY2VsbHNbaisrXTspIHsNCiAgICAgICAgICAgICAgICAgICAgY2VsbHNOdW0gKz0gKGNqLmNvbFNwYW4gfHwgMSk7DQogICAgICAgICAgICAgICAgICAgIGlmIChjai5yb3dTcGFuICYmIGNqLnJvd1NwYW4gPiAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMTsgayA8IGNqLnJvd1NwYW47IGsrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY2VsbFJvd3NbJ3Jvd18nICsgKGkgKyBrKV0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2VsbFJvd3NbJ3Jvd18nICsgKGkgKyBrKV0gPSAoY2ouY29sU3BhbiB8fCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZWxsUm93c1sncm93XycgKyAoaSArIGspXSsrDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgY2VsbHNOdW0gKz0gY2VsbFJvd3NbJ3Jvd18nICsgaV0gfHwgMDsNCiAgICAgICAgICAgICAgICBtYXhMZW4gPSBNYXRoLm1heChjZWxsc051bSwgbWF4TGVuKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBtYXhMZW47DQogICAgICAgIH0sDQogICAgICAgIGdldENlbGxDb2xJbmRleDpmdW5jdGlvbiAoY2VsbCkgew0KDQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDojrflj5blvZPliY1jZWxs5peB6L6555qE5Y2V5YWD5qC877yMDQogICAgICAgICAqIEBwYXJhbSBjZWxsDQogICAgICAgICAqIEBwYXJhbSByaWdodA0KICAgICAgICAgKi8NCiAgICAgICAgZ2V0SFNpZGVDZWxsOmZ1bmN0aW9uIChjZWxsLCByaWdodCkgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICB2YXIgY2VsbEluZm8gPSB0aGlzLmdldENlbGxJbmZvKGNlbGwpLA0KICAgICAgICAgICAgICAgICAgICBwcmV2aWV3Um93SW5kZXgsIHByZXZpZXdDb2xJbmRleDsNCiAgICAgICAgICAgICAgICB2YXIgbGVuID0gdGhpcy5zZWxlY3RlZFRkcy5sZW5ndGgsDQogICAgICAgICAgICAgICAgICAgIHJhbmdlID0gdGhpcy5jZWxsc1JhbmdlOw0KICAgICAgICAgICAgICAgIC8v6aaW6KGM5oiW6ICF6aaW5YiX5rKh5pyJ5YmN572u5Y2V5YWD5qC8DQogICAgICAgICAgICAgICAgaWYgKCghcmlnaHQgJiYgKCFsZW4gPyAhY2VsbEluZm8uY29sSW5kZXggOiAhcmFuZ2UuYmVnaW5Db2xJbmRleCkpIHx8IChyaWdodCAmJiAoIWxlbiA/IChjZWxsSW5mby5jb2xJbmRleCA9PSAodGhpcy5jb2xzTnVtIC0gMSkpIDogKHJhbmdlLmVuZENvbEluZGV4ID09IHRoaXMuY29sc051bSAtIDEpKSkpIHJldHVybiBudWxsOw0KDQogICAgICAgICAgICAgICAgcHJldmlld1Jvd0luZGV4ID0gIWxlbiA/IGNlbGxJbmZvLnJvd0luZGV4IDogcmFuZ2UuYmVnaW5Sb3dJbmRleDsNCiAgICAgICAgICAgICAgICBwcmV2aWV3Q29sSW5kZXggPSAhcmlnaHQgPyAoICFsZW4gPyAoY2VsbEluZm8uY29sSW5kZXggPCAxID8gMCA6IChjZWxsSW5mby5jb2xJbmRleCAtIDEpKSA6IHJhbmdlLmJlZ2luQ29sSW5kZXggLSAxKQ0KICAgICAgICAgICAgICAgICAgICA6ICggIWxlbiA/IGNlbGxJbmZvLmNvbEluZGV4ICsgMSA6IHJhbmdlLmVuZENvbEluZGV4ICsgMSk7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q2VsbCh0aGlzLmluZGV4VGFibGVbcHJldmlld1Jvd0luZGV4XVtwcmV2aWV3Q29sSW5kZXhdLnJvd0luZGV4LCB0aGlzLmluZGV4VGFibGVbcHJldmlld1Jvd0luZGV4XVtwcmV2aWV3Q29sSW5kZXhdLmNlbGxJbmRleCk7DQogICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgc2hvd0Vycm9yKGUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBnZXRUYWJOZXh0Q2VsbDpmdW5jdGlvbiAoY2VsbCwgcHJlUm93SW5kZXgpIHsNCiAgICAgICAgICAgIHZhciBjZWxsSW5mbyA9IHRoaXMuZ2V0Q2VsbEluZm8oY2VsbCksDQogICAgICAgICAgICAgICAgcm93SW5kZXggPSBwcmVSb3dJbmRleCB8fCBjZWxsSW5mby5yb3dJbmRleCwNCiAgICAgICAgICAgICAgICBjb2xJbmRleCA9IGNlbGxJbmZvLmNvbEluZGV4ICsgMSArIChjZWxsSW5mby5jb2xTcGFuIC0gMSksDQogICAgICAgICAgICAgICAgbmV4dENlbGw7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIG5leHRDZWxsID0gdGhpcy5nZXRDZWxsKHRoaXMuaW5kZXhUYWJsZVtyb3dJbmRleF1bY29sSW5kZXhdLnJvd0luZGV4LCB0aGlzLmluZGV4VGFibGVbcm93SW5kZXhdW2NvbEluZGV4XS5jZWxsSW5kZXgpOw0KICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIHJvd0luZGV4ID0gcm93SW5kZXggKiAxICsgMTsNCiAgICAgICAgICAgICAgICAgICAgY29sSW5kZXggPSAwOw0KICAgICAgICAgICAgICAgICAgICBuZXh0Q2VsbCA9IHRoaXMuZ2V0Q2VsbCh0aGlzLmluZGV4VGFibGVbcm93SW5kZXhdW2NvbEluZGV4XS5yb3dJbmRleCwgdGhpcy5pbmRleFRhYmxlW3Jvd0luZGV4XVtjb2xJbmRleF0uY2VsbEluZGV4KTsNCiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIG5leHRDZWxsOw0KDQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDojrflj5bop4bop4nkuIrnmoTlkI7nva7ljZXlhYPmoLwNCiAgICAgICAgICogQHBhcmFtIGNlbGwNCiAgICAgICAgICogQHBhcmFtIGJvdHRvbQ0KICAgICAgICAgKi8NCiAgICAgICAgZ2V0VlNpZGVDZWxsOmZ1bmN0aW9uIChjZWxsLCBib3R0b20sIGlnbm9yZVJhbmdlKSB7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIHZhciBjZWxsSW5mbyA9IHRoaXMuZ2V0Q2VsbEluZm8oY2VsbCksDQogICAgICAgICAgICAgICAgICAgIG5leHRSb3dJbmRleCwgbmV4dENvbEluZGV4Ow0KICAgICAgICAgICAgICAgIHZhciBsZW4gPSB0aGlzLnNlbGVjdGVkVGRzLmxlbmd0aCAmJiAhaWdub3JlUmFuZ2UsDQogICAgICAgICAgICAgICAgICAgIHJhbmdlID0gdGhpcy5jZWxsc1JhbmdlOw0KICAgICAgICAgICAgICAgIC8v5pyr6KGM5oiW6ICF5pyr5YiX5rKh5pyJ5ZCO572u5Y2V5YWD5qC8DQogICAgICAgICAgICAgICAgaWYgKCghYm90dG9tICYmIChjZWxsSW5mby5yb3dJbmRleCA9PSAwKSkgfHwgKGJvdHRvbSAmJiAoIWxlbiA/IChjZWxsSW5mby5yb3dJbmRleCArIGNlbGxJbmZvLnJvd1NwYW4gPiB0aGlzLnJvd3NOdW0gLSAxKSA6IChyYW5nZS5lbmRSb3dJbmRleCA9PSB0aGlzLnJvd3NOdW0gLSAxKSkpKSByZXR1cm4gbnVsbDsNCg0KICAgICAgICAgICAgICAgIG5leHRSb3dJbmRleCA9ICFib3R0b20gPyAoICFsZW4gPyBjZWxsSW5mby5yb3dJbmRleCAtIDEgOiByYW5nZS5iZWdpblJvd0luZGV4IC0gMSkNCiAgICAgICAgICAgICAgICAgICAgOiAoICFsZW4gPyAoY2VsbEluZm8ucm93SW5kZXggKyBjZWxsSW5mby5yb3dTcGFuKSA6IHJhbmdlLmVuZFJvd0luZGV4ICsgMSk7DQogICAgICAgICAgICAgICAgbmV4dENvbEluZGV4ID0gIWxlbiA/IGNlbGxJbmZvLmNvbEluZGV4IDogcmFuZ2UuYmVnaW5Db2xJbmRleDsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDZWxsKHRoaXMuaW5kZXhUYWJsZVtuZXh0Um93SW5kZXhdW25leHRDb2xJbmRleF0ucm93SW5kZXgsIHRoaXMuaW5kZXhUYWJsZVtuZXh0Um93SW5kZXhdW25leHRDb2xJbmRleF0uY2VsbEluZGV4KTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICBzaG93RXJyb3IoZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDojrflj5bnm7jlkIznu5PmnZ/kvY3nva7nmoTljZXlhYPmoLzvvIx4T3JZ5oyH5Luj5LqG5piv6I635Y+WeOi9tOebuOWQjOi/mOaYr3novbTnm7jlkIwNCiAgICAgICAgICovDQogICAgICAgIGdldFNhbWVFbmRQb3NDZWxsczpmdW5jdGlvbiAoY2VsbCwgeE9yWSkgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICB2YXIgZmxhZyA9ICh4T3JZLnRvTG93ZXJDYXNlKCkgPT09ICJ4IiksDQogICAgICAgICAgICAgICAgICAgIGVuZCA9IGRvbVV0aWxzLmdldFhZKGNlbGwpW2ZsYWcgPyAneCcgOiAneSddICsgY2VsbFsib2Zmc2V0IiArIChmbGFnID8gJ1dpZHRoJyA6ICdIZWlnaHQnKV0sDQogICAgICAgICAgICAgICAgICAgIHJvd3MgPSB0aGlzLnRhYmxlLnJvd3MsDQogICAgICAgICAgICAgICAgICAgIGNlbGxzID0gbnVsbCwgcmV0dXJucyA9IFtdOw0KICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5yb3dzTnVtOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgY2VsbHMgPSByb3dzW2ldLmNlbGxzOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgdG1wQ2VsbDsgdG1wQ2VsbCA9IGNlbGxzW2orK107KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG1wRW5kID0gZG9tVXRpbHMuZ2V0WFkodG1wQ2VsbClbZmxhZyA/ICd4JyA6ICd5J10gKyB0bXBDZWxsWyJvZmZzZXQiICsgKGZsYWcgPyAnV2lkdGgnIDogJ0hlaWdodCcpXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8v5a+55bqU6KGM55qEdGTlt7Lnu4/ooqvkuIrpnaLooYxyb3dTcGFu5LqGDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodG1wRW5kID4gZW5kICYmIGZsYWcpIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNlbGwgPT0gdG1wQ2VsbCB8fCBlbmQgPT0gdG1wRW5kKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/lj6rojrflj5bljZXkuIDnmoTljZXlhYPmoLwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3RvZG8g5LuF6I635Y+W5Y2V5LiA5Y2V5YWD5qC85Zyo54m55a6a5oOF5Ya15LiL5Lya6YCg5oiQcmV0dXJuc+S4uuepuu+8jOS7juiAjOW9seWTjeWQjue7reeahOaLluaLveWunueOsO+8jOS/ruato+i/meS4quOAgumcgOiAg+iZkeaAp+iDvQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0bXBDZWxsW2ZsYWcgPyAiY29sU3BhbiIgOiAicm93U3BhbiJdID09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJucy5wdXNoKHRtcENlbGwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmxhZykgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuIHJldHVybnM7DQogICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgc2hvd0Vycm9yKGUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBzZXRDZWxsQ29udGVudDpmdW5jdGlvbiAoY2VsbCwgY29udGVudCkgew0KICAgICAgICAgICAgY2VsbC5pbm5lckhUTUwgPSBjb250ZW50IHx8IChicm93c2VyLmllID8gZG9tVXRpbHMuZmlsbENoYXIgOiAiPGJyIC8+Iik7DQogICAgICAgIH0sDQogICAgICAgIGNsb25lQ2VsbDpVRVRhYmxlLmNsb25lQ2VsbCwNCiAgICAgICAgLyoqDQogICAgICAgICAqIOiOt+WPlui3n+W9k+WJjeWNleWFg+agvOeahOWPs+i+ueerlue6v+S4uuW3pui+ueeahOaJgOacieacquWQiOW5tuWNleWFg+agvA0KICAgICAgICAgKi8NCiAgICAgICAgZ2V0U2FtZVN0YXJ0UG9zWENlbGxzOmZ1bmN0aW9uIChjZWxsKSB7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IGRvbVV0aWxzLmdldFhZKGNlbGwpLnggKyBjZWxsLm9mZnNldFdpZHRoLA0KICAgICAgICAgICAgICAgICAgICByb3dzID0gdGhpcy50YWJsZS5yb3dzLCBjZWxscyAsIHJldHVybnMgPSBbXTsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMucm93c051bTsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgIGNlbGxzID0gcm93c1tpXS5jZWxsczsNCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDAsIHRtcENlbGw7IHRtcENlbGwgPSBjZWxsc1tqKytdOykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRtcFN0YXJ0ID0gZG9tVXRpbHMuZ2V0WFkodG1wQ2VsbCkueDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0bXBTdGFydCA+IHN0YXJ0KSBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0bXBTdGFydCA9PSBzdGFydCAmJiB0bXBDZWxsLmNvbFNwYW4gPT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybnMucHVzaCh0bXBDZWxsKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICByZXR1cm4gcmV0dXJuczsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICBzaG93RXJyb3IoZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDmm7TmlrB0YWJsZeWvueW6lOeahOe0ouW8leihqA0KICAgICAgICAgKi8NCiAgICAgICAgdXBkYXRlOmZ1bmN0aW9uICh0YWJsZSkgew0KICAgICAgICAgICAgdGhpcy50YWJsZSA9IHRhYmxlIHx8IHRoaXMudGFibGU7DQogICAgICAgICAgICB0aGlzLnNlbGVjdGVkVGRzID0gW107DQogICAgICAgICAgICB0aGlzLmNlbGxzUmFuZ2UgPSB7fTsNCiAgICAgICAgICAgIHRoaXMuaW5kZXhUYWJsZSA9IFtdOw0KICAgICAgICAgICAgdmFyIHJvd3MgPSB0aGlzLnRhYmxlLnJvd3MsDQogICAgICAgICAgICAgICAgcm93c051bSA9IHRoaXMuZ2V0TWF4Um93cygpLA0KICAgICAgICAgICAgICAgIGROdW0gPSByb3dzTnVtIC0gcm93cy5sZW5ndGgsDQogICAgICAgICAgICAgICAgY29sc051bSA9IHRoaXMuZ2V0TWF4Q29scygpOw0KICAgICAgICAgICAgd2hpbGUgKGROdW0tLSkgew0KICAgICAgICAgICAgICAgIHRoaXMudGFibGUuaW5zZXJ0Um93KHJvd3MubGVuZ3RoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMucm93c051bSA9IHJvd3NOdW07DQogICAgICAgICAgICB0aGlzLmNvbHNOdW0gPSBjb2xzTnVtOw0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHJvd3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsNCiAgICAgICAgICAgICAgICB0aGlzLmluZGV4VGFibGVbaV0gPSBuZXcgQXJyYXkoY29sc051bSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAvL+Whq+WFhee0ouW8leihqA0KICAgICAgICAgICAgZm9yICh2YXIgcm93SW5kZXggPSAwLCByb3c7IHJvdyA9IHJvd3Nbcm93SW5kZXhdOyByb3dJbmRleCsrKSB7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgY2VsbEluZGV4ID0gMCwgY2VsbCwgY2VsbHMgPSByb3cuY2VsbHM7IGNlbGwgPSBjZWxsc1tjZWxsSW5kZXhdOyBjZWxsSW5kZXgrKykgew0KICAgICAgICAgICAgICAgICAgICAvL+S/ruato+aVtOihjOiiq3Jvd1NwYW7ml7blr7zoh7TnmoTooYzmlbDorqHnrpfplJnor68NCiAgICAgICAgICAgICAgICAgICAgaWYgKGNlbGwucm93U3BhbiA+IHJvd3NOdW0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNlbGwucm93U3BhbiA9IHJvd3NOdW07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbEluZGV4ID0gY2VsbEluZGV4LA0KICAgICAgICAgICAgICAgICAgICAgICAgcm93U3BhbiA9IGNlbGwucm93U3BhbiB8fCAxLA0KICAgICAgICAgICAgICAgICAgICAgICAgY29sU3BhbiA9IGNlbGwuY29sU3BhbiB8fCAxOw0KICAgICAgICAgICAgICAgICAgICAvL+W9k+W3sue7j+iiq+S4iuS4gOihjHJvd1NwYW7miJbogIXooqvliY3kuIDliJdjb2xTcGFu5LqG77yM5YiZ6Lez5Yiw5LiL5LiA5Liq5Y2V5YWD5qC86L+b6KGMDQogICAgICAgICAgICAgICAgICAgIHdoaWxlICh0aGlzLmluZGV4VGFibGVbcm93SW5kZXhdW2NvbEluZGV4XSkgY29sSW5kZXgrKzsNCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCByb3dTcGFuOyBqKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgY29sU3BhbjsgaysrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbmRleFRhYmxlW3Jvd0luZGV4ICsgal1bY29sSW5kZXggKyBrXSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93SW5kZXg6cm93SW5kZXgsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbGxJbmRleDpjZWxsSW5kZXgsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbEluZGV4OmNvbEluZGV4LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dTcGFuOnJvd1NwYW4sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbFNwYW46Y29sU3Bhbg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8v5L+u5aSN5q6L57y6dGQNCiAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCByb3dzTnVtOyBqKyspIHsNCiAgICAgICAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgY29sc051bTsgaysrKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmluZGV4VGFibGVbal1ba10gPT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcm93ID0gcm93c1tqXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNlbGwgPSByb3cuY2VsbHNbcm93LmNlbGxzLmxlbmd0aCAtIDFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2VsbCA9IGNlbGwgPyBjZWxsLmNsb25lTm9kZSh0cnVlKSA6IHRoaXMudGFibGUub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ZCIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRDZWxsQ29udGVudChjZWxsKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjZWxsLmNvbFNwYW4gIT09IDEpY2VsbC5jb2xTcGFuID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjZWxsLnJvd1NwYW4gIT09IDEpY2VsbC5yb3dTcGFuID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChjZWxsKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5kZXhUYWJsZVtqXVtrXSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dJbmRleDpqLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbGxJbmRleDpjZWxsLmNlbGxJbmRleCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xJbmRleDprLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd1NwYW46MSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xTcGFuOjENCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8v5b2T5qGG6YCJ5ZCO5Yig6Zmk6KGM5oiW6ICF5YiX5ZCO5pKk6ZSA77yM6ZyA6KaB6YeN5bu66YCJ5Yy644CCDQogICAgICAgICAgICB2YXIgdGRzID0gZG9tVXRpbHMuZ2V0RWxlbWVudHNCeVRhZ05hbWUodGhpcy50YWJsZSwgInRkIiksDQogICAgICAgICAgICAgICAgc2VsZWN0VGRzID0gW107DQogICAgICAgICAgICB1dGlscy5lYWNoKHRkcywgZnVuY3Rpb24gKHRkKSB7DQogICAgICAgICAgICAgICAgaWYgKGRvbVV0aWxzLmhhc0NsYXNzKHRkLCAic2VsZWN0VGRDbGFzcyIpKSB7DQogICAgICAgICAgICAgICAgICAgIHNlbGVjdFRkcy5wdXNoKHRkKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIGlmIChzZWxlY3RUZHMubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgdmFyIHN0YXJ0ID0gc2VsZWN0VGRzWzBdLA0KICAgICAgICAgICAgICAgICAgICBlbmQgPSBzZWxlY3RUZHNbc2VsZWN0VGRzLmxlbmd0aCAtIDFdLA0KICAgICAgICAgICAgICAgICAgICBzdGFydEluZm8gPSB0aGlzLmdldENlbGxJbmZvKHN0YXJ0KSwNCiAgICAgICAgICAgICAgICAgICAgZW5kSW5mbyA9IHRoaXMuZ2V0Q2VsbEluZm8oZW5kKTsNCiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkVGRzID0gc2VsZWN0VGRzOw0KICAgICAgICAgICAgICAgIHRoaXMuY2VsbHNSYW5nZSA9IHsNCiAgICAgICAgICAgICAgICAgICAgYmVnaW5Sb3dJbmRleDpzdGFydEluZm8ucm93SW5kZXgsDQogICAgICAgICAgICAgICAgICAgIGJlZ2luQ29sSW5kZXg6c3RhcnRJbmZvLmNvbEluZGV4LA0KICAgICAgICAgICAgICAgICAgICBlbmRSb3dJbmRleDplbmRJbmZvLnJvd0luZGV4ICsgZW5kSW5mby5yb3dTcGFuIC0gMSwNCiAgICAgICAgICAgICAgICAgICAgZW5kQ29sSW5kZXg6ZW5kSW5mby5jb2xJbmRleCArIGVuZEluZm8uY29sU3BhbiAtIDENCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDojrflj5bljZXlhYPmoLznmoTntKLlvJXkv6Hmga8NCiAgICAgICAgICovDQogICAgICAgIGdldENlbGxJbmZvOmZ1bmN0aW9uIChjZWxsKSB7DQogICAgICAgICAgICBpZiAoIWNlbGwpIHJldHVybjsNCiAgICAgICAgICAgIHZhciBjZWxsSW5kZXggPSBjZWxsLmNlbGxJbmRleCwNCiAgICAgICAgICAgICAgICByb3dJbmRleCA9IGNlbGwucGFyZW50Tm9kZS5yb3dJbmRleCwNCiAgICAgICAgICAgICAgICByb3dJbmZvID0gdGhpcy5pbmRleFRhYmxlW3Jvd0luZGV4XSwNCiAgICAgICAgICAgICAgICBudW1Db2xzID0gdGhpcy5jb2xzTnVtOw0KICAgICAgICAgICAgZm9yICh2YXIgY29sSW5kZXggPSBjZWxsSW5kZXg7IGNvbEluZGV4IDwgbnVtQ29sczsgY29sSW5kZXgrKykgew0KICAgICAgICAgICAgICAgIHZhciBjZWxsSW5mbyA9IHJvd0luZm9bY29sSW5kZXhdOw0KICAgICAgICAgICAgICAgIGlmIChjZWxsSW5mby5yb3dJbmRleCA9PT0gcm93SW5kZXggJiYgY2VsbEluZm8uY2VsbEluZGV4ID09PSBjZWxsSW5kZXgpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNlbGxJbmZvOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIOagueaNruihjOWIl+WPt+iOt+WPluWNleWFg+agvA0KICAgICAgICAgKi8NCiAgICAgICAgZ2V0Q2VsbDpmdW5jdGlvbiAocm93SW5kZXgsIGNlbGxJbmRleCkgew0KICAgICAgICAgICAgcmV0dXJuIHJvd0luZGV4IDwgdGhpcy5yb3dzTnVtICYmIHRoaXMudGFibGUucm93c1tyb3dJbmRleF0uY2VsbHNbY2VsbEluZGV4XSB8fCBudWxsOw0KICAgICAgICB9LA0KICAgICAgICAvKioNCiAgICAgICAgICog5Yig6Zmk5Y2V5YWD5qC8DQogICAgICAgICAqLw0KICAgICAgICBkZWxldGVDZWxsOmZ1bmN0aW9uIChjZWxsLCByb3dJbmRleCkgew0KICAgICAgICAgICAgcm93SW5kZXggPSB0eXBlb2Ygcm93SW5kZXggPT0gJ251bWJlcicgPyByb3dJbmRleCA6IGNlbGwucGFyZW50Tm9kZS5yb3dJbmRleDsNCiAgICAgICAgICAgIHZhciByb3cgPSB0aGlzLnRhYmxlLnJvd3Nbcm93SW5kZXhdOw0KICAgICAgICAgICAgcm93LmRlbGV0ZUNlbGwoY2VsbC5jZWxsSW5kZXgpOw0KICAgICAgICB9LA0KICAgICAgICAvKioNCiAgICAgICAgICog5qC55o2u5aeL5pyr5Lik5Liq5Y2V5YWD5qC86I635Y+W6KKr5qGG6YCJ55qE5omA5pyJ5Y2V5YWD5qC86IyD5Zu0DQogICAgICAgICAqLw0KICAgICAgICBnZXRDZWxsc1JhbmdlOmZ1bmN0aW9uIChjZWxsQSwgY2VsbEIpIHsNCiAgICAgICAgICAgIGZ1bmN0aW9uIGNoZWNrUmFuZ2UoYmVnaW5Sb3dJbmRleCwgYmVnaW5Db2xJbmRleCwgZW5kUm93SW5kZXgsIGVuZENvbEluZGV4KSB7DQogICAgICAgICAgICAgICAgdmFyIHRtcEJlZ2luUm93SW5kZXggPSBiZWdpblJvd0luZGV4LA0KICAgICAgICAgICAgICAgICAgICB0bXBCZWdpbkNvbEluZGV4ID0gYmVnaW5Db2xJbmRleCwNCiAgICAgICAgICAgICAgICAgICAgdG1wRW5kUm93SW5kZXggPSBlbmRSb3dJbmRleCwNCiAgICAgICAgICAgICAgICAgICAgdG1wRW5kQ29sSW5kZXggPSBlbmRDb2xJbmRleCwNCiAgICAgICAgICAgICAgICAgICAgY2VsbEluZm8sIGNvbEluZGV4LCByb3dJbmRleDsNCiAgICAgICAgICAgICAgICAvLyDpgJrov4dpbmRleFRhYmxl5qOA5p+l5piv5ZCm5a2Y5Zyo6LaF5Ye6VGFibGVSYW5nZeS4iui+ueeVjOeahOaDheWGtQ0KICAgICAgICAgICAgICAgIGlmIChiZWdpblJvd0luZGV4ID4gMCkgew0KICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbEluZGV4ID0gYmVnaW5Db2xJbmRleDsgY29sSW5kZXggPCBlbmRDb2xJbmRleDsgY29sSW5kZXgrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgY2VsbEluZm8gPSBtZS5pbmRleFRhYmxlW2JlZ2luUm93SW5kZXhdW2NvbEluZGV4XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJvd0luZGV4ID0gY2VsbEluZm8ucm93SW5kZXg7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93SW5kZXggPCBiZWdpblJvd0luZGV4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wQmVnaW5Sb3dJbmRleCA9IE1hdGgubWluKHJvd0luZGV4LCB0bXBCZWdpblJvd0luZGV4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAvLyDpgJrov4dpbmRleFRhYmxl5qOA5p+l5piv5ZCm5a2Y5Zyo6LaF5Ye6VGFibGVSYW5nZeWPs+i+ueeVjOeahOaDheWGtQ0KICAgICAgICAgICAgICAgIGlmIChlbmRDb2xJbmRleCA8IG1lLmNvbHNOdW0pIHsNCiAgICAgICAgICAgICAgICAgICAgZm9yIChyb3dJbmRleCA9IGJlZ2luUm93SW5kZXg7IHJvd0luZGV4IDwgZW5kUm93SW5kZXg7IHJvd0luZGV4KyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNlbGxJbmZvID0gbWUuaW5kZXhUYWJsZVtyb3dJbmRleF1bZW5kQ29sSW5kZXhdOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29sSW5kZXggPSBjZWxsSW5mby5jb2xJbmRleCArIGNlbGxJbmZvLmNvbFNwYW4gLSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbEluZGV4ID4gZW5kQ29sSW5kZXgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBFbmRDb2xJbmRleCA9IE1hdGgubWF4KGNvbEluZGV4LCB0bXBFbmRDb2xJbmRleCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy8g5qOA5p+l5piv5ZCm5pyJ6LaF5Ye6VGFibGVSYW5nZeS4i+i+ueeVjOeahOaDheWGtQ0KICAgICAgICAgICAgICAgIGlmIChlbmRSb3dJbmRleCA8IG1lLnJvd3NOdW0pIHsNCiAgICAgICAgICAgICAgICAgICAgZm9yIChjb2xJbmRleCA9IGJlZ2luQ29sSW5kZXg7IGNvbEluZGV4IDwgZW5kQ29sSW5kZXg7IGNvbEluZGV4KyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNlbGxJbmZvID0gbWUuaW5kZXhUYWJsZVtlbmRSb3dJbmRleF1bY29sSW5kZXhdOw0KICAgICAgICAgICAgICAgICAgICAgICAgcm93SW5kZXggPSBjZWxsSW5mby5yb3dJbmRleCArIGNlbGxJbmZvLnJvd1NwYW4gLSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJvd0luZGV4ID4gZW5kUm93SW5kZXgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBFbmRSb3dJbmRleCA9IE1hdGgubWF4KHJvd0luZGV4LCB0bXBFbmRSb3dJbmRleCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy8g5qOA5p+l5piv5ZCm5pyJ6LaF5Ye6VGFibGVSYW5nZeW3pui+ueeVjOeahOaDheWGtQ0KICAgICAgICAgICAgICAgIGlmIChiZWdpbkNvbEluZGV4ID4gMCkgew0KICAgICAgICAgICAgICAgICAgICBmb3IgKHJvd0luZGV4ID0gYmVnaW5Sb3dJbmRleDsgcm93SW5kZXggPCBlbmRSb3dJbmRleDsgcm93SW5kZXgrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgY2VsbEluZm8gPSBtZS5pbmRleFRhYmxlW3Jvd0luZGV4XVtiZWdpbkNvbEluZGV4XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbEluZGV4ID0gY2VsbEluZm8uY29sSW5kZXg7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29sSW5kZXggPCBiZWdpbkNvbEluZGV4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wQmVnaW5Db2xJbmRleCA9IE1hdGgubWluKGNlbGxJbmZvLmNvbEluZGV4LCB0bXBCZWdpbkNvbEluZGV4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAvL+mAkuW9kuiwg+eUqOebtOiHs+aJgOacieWujOaIkOaJgOacieahhumAieWNleWFg+agvOeahOaJqeWxlQ0KICAgICAgICAgICAgICAgIGlmICh0bXBCZWdpblJvd0luZGV4ICE9IGJlZ2luUm93SW5kZXggfHwgdG1wQmVnaW5Db2xJbmRleCAhPSBiZWdpbkNvbEluZGV4IHx8IHRtcEVuZFJvd0luZGV4ICE9IGVuZFJvd0luZGV4IHx8IHRtcEVuZENvbEluZGV4ICE9IGVuZENvbEluZGV4KSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGVja1JhbmdlKHRtcEJlZ2luUm93SW5kZXgsIHRtcEJlZ2luQ29sSW5kZXgsIHRtcEVuZFJvd0luZGV4LCB0bXBFbmRDb2xJbmRleCk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgLy8g5LiN6ZyA6KaB5omp5bGVVGFibGVSYW5nZeeahOaDheWGtQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICAgICAgYmVnaW5Sb3dJbmRleDpiZWdpblJvd0luZGV4LA0KICAgICAgICAgICAgICAgICAgICAgICAgYmVnaW5Db2xJbmRleDpiZWdpbkNvbEluZGV4LA0KICAgICAgICAgICAgICAgICAgICAgICAgZW5kUm93SW5kZXg6ZW5kUm93SW5kZXgsDQogICAgICAgICAgICAgICAgICAgICAgICBlbmRDb2xJbmRleDplbmRDb2xJbmRleA0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICB2YXIgbWUgPSB0aGlzLA0KICAgICAgICAgICAgICAgICAgICBjZWxsQUluZm8gPSBtZS5nZXRDZWxsSW5mbyhjZWxsQSk7DQogICAgICAgICAgICAgICAgaWYgKGNlbGxBID09PSBjZWxsQikgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICAgICAgYmVnaW5Sb3dJbmRleDpjZWxsQUluZm8ucm93SW5kZXgsDQogICAgICAgICAgICAgICAgICAgICAgICBiZWdpbkNvbEluZGV4OmNlbGxBSW5mby5jb2xJbmRleCwNCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZFJvd0luZGV4OmNlbGxBSW5mby5yb3dJbmRleCArIGNlbGxBSW5mby5yb3dTcGFuIC0gMSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZENvbEluZGV4OmNlbGxBSW5mby5jb2xJbmRleCArIGNlbGxBSW5mby5jb2xTcGFuIC0gMQ0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB2YXIgY2VsbEJJbmZvID0gbWUuZ2V0Q2VsbEluZm8oY2VsbEIpOw0KICAgICAgICAgICAgICAgIC8vIOiuoeeul1RhYmxlUmFuZ2XnmoTlm5vkuKrovrkNCiAgICAgICAgICAgICAgICB2YXIgYmVnaW5Sb3dJbmRleCA9IE1hdGgubWluKGNlbGxBSW5mby5yb3dJbmRleCwgY2VsbEJJbmZvLnJvd0luZGV4KSwNCiAgICAgICAgICAgICAgICAgICAgYmVnaW5Db2xJbmRleCA9IE1hdGgubWluKGNlbGxBSW5mby5jb2xJbmRleCwgY2VsbEJJbmZvLmNvbEluZGV4KSwNCiAgICAgICAgICAgICAgICAgICAgZW5kUm93SW5kZXggPSBNYXRoLm1heChjZWxsQUluZm8ucm93SW5kZXggKyBjZWxsQUluZm8ucm93U3BhbiAtIDEsIGNlbGxCSW5mby5yb3dJbmRleCArIGNlbGxCSW5mby5yb3dTcGFuIC0gMSksDQogICAgICAgICAgICAgICAgICAgIGVuZENvbEluZGV4ID0gTWF0aC5tYXgoY2VsbEFJbmZvLmNvbEluZGV4ICsgY2VsbEFJbmZvLmNvbFNwYW4gLSAxLCBjZWxsQkluZm8uY29sSW5kZXggKyBjZWxsQkluZm8uY29sU3BhbiAtIDEpOw0KDQogICAgICAgICAgICAgICAgcmV0dXJuIGNoZWNrUmFuZ2UoYmVnaW5Sb3dJbmRleCwgYmVnaW5Db2xJbmRleCwgZW5kUm93SW5kZXgsIGVuZENvbEluZGV4KTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAvL3Rocm93IGU7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDkvp3mja5jZWxsc1Jhbmdl6I635Y+W5a+55bqU55qE5Y2V5YWD5qC86ZuG5ZCIDQogICAgICAgICAqLw0KICAgICAgICBnZXRDZWxsczpmdW5jdGlvbiAocmFuZ2UpIHsNCiAgICAgICAgICAgIC8v5q+P5qyh6I635Y+WY2VsbHPkuYvliY3lv4XpobvlhYjmuIXpmaTkuIrmrKHnmoTpgInmi6nvvIzlkKbliJnkvJrlr7nlkI7nu63ojrflj5bmk43kvZzpgKDmiJDlvbHlk40NCiAgICAgICAgICAgIHRoaXMuY2xlYXJTZWxlY3RlZCgpOw0KICAgICAgICAgICAgdmFyIGJlZ2luUm93SW5kZXggPSByYW5nZS5iZWdpblJvd0luZGV4LA0KICAgICAgICAgICAgICAgIGJlZ2luQ29sSW5kZXggPSByYW5nZS5iZWdpbkNvbEluZGV4LA0KICAgICAgICAgICAgICAgIGVuZFJvd0luZGV4ID0gcmFuZ2UuZW5kUm93SW5kZXgsDQogICAgICAgICAgICAgICAgZW5kQ29sSW5kZXggPSByYW5nZS5lbmRDb2xJbmRleCwNCiAgICAgICAgICAgICAgICBjZWxsSW5mbywgcm93SW5kZXgsIGNvbEluZGV4LCB0ZEhhc2ggPSB7fSwgcmV0dXJuVGRzID0gW107DQogICAgICAgICAgICBmb3IgKHZhciBpID0gYmVnaW5Sb3dJbmRleDsgaSA8PSBlbmRSb3dJbmRleDsgaSsrKSB7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IGJlZ2luQ29sSW5kZXg7IGogPD0gZW5kQ29sSW5kZXg7IGorKykgew0KICAgICAgICAgICAgICAgICAgICBjZWxsSW5mbyA9IHRoaXMuaW5kZXhUYWJsZVtpXVtqXTsNCiAgICAgICAgICAgICAgICAgICAgcm93SW5kZXggPSBjZWxsSW5mby5yb3dJbmRleDsNCiAgICAgICAgICAgICAgICAgICAgY29sSW5kZXggPSBjZWxsSW5mby5jb2xJbmRleDsNCiAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6cQ2VsbHPph4zlt7Lnu4/ljIXlkKvkuobmraRDZWxs5YiZ6Lez6L+HDQogICAgICAgICAgICAgICAgICAgIHZhciBrZXkgPSByb3dJbmRleCArICd8JyArIGNvbEluZGV4Ow0KICAgICAgICAgICAgICAgICAgICBpZiAodGRIYXNoW2tleV0pIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICB0ZEhhc2hba2V5XSA9IDE7DQogICAgICAgICAgICAgICAgICAgIGlmIChyb3dJbmRleCA8IGkgfHwgY29sSW5kZXggPCBqIHx8IHJvd0luZGV4ICsgY2VsbEluZm8ucm93U3BhbiAtIDEgPiBlbmRSb3dJbmRleCB8fCBjb2xJbmRleCArIGNlbGxJbmZvLmNvbFNwYW4gLSAxID4gZW5kQ29sSW5kZXgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJldHVyblRkcy5wdXNoKHRoaXMuZ2V0Q2VsbChyb3dJbmRleCwgY2VsbEluZm8uY2VsbEluZGV4KSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIHJldHVyblRkczsNCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIOa4heeQhuW3sue7j+mAieS4reeahOWNleWFg+agvA0KICAgICAgICAgKi8NCiAgICAgICAgY2xlYXJTZWxlY3RlZDpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBVRVRhYmxlLnJlbW92ZVNlbGVjdGVkQ2xhc3ModGhpcy5zZWxlY3RlZFRkcyk7DQogICAgICAgICAgICB0aGlzLnNlbGVjdGVkVGRzID0gW107DQogICAgICAgICAgICB0aGlzLmNlbGxzUmFuZ2UgPSB7fTsNCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIOagueaNrnJhbmdl6K6+572u5bey57uP6YCJ5Lit55qE5Y2V5YWD5qC8DQogICAgICAgICAqLw0KICAgICAgICBzZXRTZWxlY3RlZDpmdW5jdGlvbiAocmFuZ2UpIHsNCiAgICAgICAgICAgIHZhciBjZWxscyA9IHRoaXMuZ2V0Q2VsbHMocmFuZ2UpOw0KICAgICAgICAgICAgVUVUYWJsZS5hZGRTZWxlY3RlZENsYXNzKGNlbGxzKTsNCiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRUZHMgPSBjZWxsczsNCiAgICAgICAgICAgIHRoaXMuY2VsbHNSYW5nZSA9IHJhbmdlOw0KICAgICAgICB9LA0KICAgICAgICBpc0Z1bGxSb3c6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIHJhbmdlID0gdGhpcy5jZWxsc1JhbmdlOw0KICAgICAgICAgICAgcmV0dXJuIChyYW5nZS5lbmRDb2xJbmRleCAtIHJhbmdlLmJlZ2luQ29sSW5kZXggKyAxKSA9PSB0aGlzLmNvbHNOdW07DQogICAgICAgIH0sDQogICAgICAgIGlzRnVsbENvbDpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgcmFuZ2UgPSB0aGlzLmNlbGxzUmFuZ2UsDQogICAgICAgICAgICAgICAgdGFibGUgPSB0aGlzLnRhYmxlLA0KICAgICAgICAgICAgICAgIHRocyA9IHRhYmxlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0aCIpLA0KICAgICAgICAgICAgICAgIHJvd3MgPSByYW5nZS5lbmRSb3dJbmRleCAtIHJhbmdlLmJlZ2luUm93SW5kZXggKyAxOw0KICAgICAgICAgICAgcmV0dXJuICAhdGhzLmxlbmd0aCA/IHJvd3MgPT0gdGhpcy5yb3dzTnVtIDogcm93cyA9PSB0aGlzLnJvd3NOdW0gfHwgKHJvd3MgPT0gdGhpcy5yb3dzTnVtIC0gMSk7DQoNCiAgICAgICAgfSwNCiAgICAgICAgLyoqDQogICAgICAgICAqIOiOt+WPluinhuinieS4iueahOWJjee9ruWNleWFg+agvO+8jOm7mOiupOaYr+W3pui+ue+8jHRvcOS8oOWFpeaXtg0KICAgICAgICAgKiBAcGFyYW0gY2VsbA0KICAgICAgICAgKiBAcGFyYW0gdG9wDQogICAgICAgICAqLw0KICAgICAgICBnZXROZXh0Q2VsbDpmdW5jdGlvbiAoY2VsbCwgYm90dG9tLCBpZ25vcmVSYW5nZSkgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICB2YXIgY2VsbEluZm8gPSB0aGlzLmdldENlbGxJbmZvKGNlbGwpLA0KICAgICAgICAgICAgICAgICAgICBuZXh0Um93SW5kZXgsIG5leHRDb2xJbmRleDsNCiAgICAgICAgICAgICAgICB2YXIgbGVuID0gdGhpcy5zZWxlY3RlZFRkcy5sZW5ndGggJiYgIWlnbm9yZVJhbmdlLA0KICAgICAgICAgICAgICAgICAgICByYW5nZSA9IHRoaXMuY2VsbHNSYW5nZTsNCiAgICAgICAgICAgICAgICAvL+acq+ihjOaIluiAheacq+WIl+ayoeacieWQjue9ruWNleWFg+agvA0KICAgICAgICAgICAgICAgIGlmICgoIWJvdHRvbSAmJiAoY2VsbEluZm8ucm93SW5kZXggPT0gMCkpIHx8IChib3R0b20gJiYgKCFsZW4gPyAoY2VsbEluZm8ucm93SW5kZXggKyBjZWxsSW5mby5yb3dTcGFuID4gdGhpcy5yb3dzTnVtIC0gMSkgOiAocmFuZ2UuZW5kUm93SW5kZXggPT0gdGhpcy5yb3dzTnVtIC0gMSkpKSkgcmV0dXJuIG51bGw7DQoNCiAgICAgICAgICAgICAgICBuZXh0Um93SW5kZXggPSAhYm90dG9tID8gKCAhbGVuID8gY2VsbEluZm8ucm93SW5kZXggLSAxIDogcmFuZ2UuYmVnaW5Sb3dJbmRleCAtIDEpDQogICAgICAgICAgICAgICAgICAgIDogKCAhbGVuID8gKGNlbGxJbmZvLnJvd0luZGV4ICsgY2VsbEluZm8ucm93U3BhbikgOiByYW5nZS5lbmRSb3dJbmRleCArIDEpOw0KICAgICAgICAgICAgICAgIG5leHRDb2xJbmRleCA9ICFsZW4gPyBjZWxsSW5mby5jb2xJbmRleCA6IHJhbmdlLmJlZ2luQ29sSW5kZXg7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q2VsbCh0aGlzLmluZGV4VGFibGVbbmV4dFJvd0luZGV4XVtuZXh0Q29sSW5kZXhdLnJvd0luZGV4LCB0aGlzLmluZGV4VGFibGVbbmV4dFJvd0luZGV4XVtuZXh0Q29sSW5kZXhdLmNlbGxJbmRleCk7DQogICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgc2hvd0Vycm9yKGUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBnZXRQcmV2aWV3Q2VsbDpmdW5jdGlvbiAoY2VsbCwgdG9wKSB7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIHZhciBjZWxsSW5mbyA9IHRoaXMuZ2V0Q2VsbEluZm8oY2VsbCksDQogICAgICAgICAgICAgICAgICAgIHByZXZpZXdSb3dJbmRleCwgcHJldmlld0NvbEluZGV4Ow0KICAgICAgICAgICAgICAgIHZhciBsZW4gPSB0aGlzLnNlbGVjdGVkVGRzLmxlbmd0aCwNCiAgICAgICAgICAgICAgICAgICAgcmFuZ2UgPSB0aGlzLmNlbGxzUmFuZ2U7DQogICAgICAgICAgICAgICAgLy/pppbooYzmiJbogIXpppbliJfmsqHmnInliY3nva7ljZXlhYPmoLwNCiAgICAgICAgICAgICAgICBpZiAoKCF0b3AgJiYgKCFsZW4gPyAhY2VsbEluZm8uY29sSW5kZXggOiAhcmFuZ2UuYmVnaW5Db2xJbmRleCkpIHx8ICh0b3AgJiYgKCFsZW4gPyAoY2VsbEluZm8ucm93SW5kZXggPiAodGhpcy5jb2xzTnVtIC0gMSkpIDogKHJhbmdlLmVuZENvbEluZGV4ID09IHRoaXMuY29sc051bSAtIDEpKSkpIHJldHVybiBudWxsOw0KDQogICAgICAgICAgICAgICAgcHJldmlld1Jvd0luZGV4ID0gIXRvcCA/ICggIWxlbiA/IGNlbGxJbmZvLnJvd0luZGV4IDogcmFuZ2UuYmVnaW5Sb3dJbmRleCApDQogICAgICAgICAgICAgICAgICAgIDogKCAhbGVuID8gKGNlbGxJbmZvLnJvd0luZGV4IDwgMSA/IDAgOiAoY2VsbEluZm8ucm93SW5kZXggLSAxKSkgOiByYW5nZS5iZWdpblJvd0luZGV4KTsNCiAgICAgICAgICAgICAgICBwcmV2aWV3Q29sSW5kZXggPSAhdG9wID8gKCAhbGVuID8gKGNlbGxJbmZvLmNvbEluZGV4IDwgMSA/IDAgOiAoY2VsbEluZm8uY29sSW5kZXggLSAxKSkgOiByYW5nZS5iZWdpbkNvbEluZGV4IC0gMSkNCiAgICAgICAgICAgICAgICAgICAgOiAoICFsZW4gPyBjZWxsSW5mby5jb2xJbmRleCA6IHJhbmdlLmVuZENvbEluZGV4ICsgMSk7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q2VsbCh0aGlzLmluZGV4VGFibGVbcHJldmlld1Jvd0luZGV4XVtwcmV2aWV3Q29sSW5kZXhdLnJvd0luZGV4LCB0aGlzLmluZGV4VGFibGVbcHJldmlld1Jvd0luZGV4XVtwcmV2aWV3Q29sSW5kZXhdLmNlbGxJbmRleCk7DQogICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgc2hvd0Vycm9yKGUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICAvKioNCiAgICAgICAgICog56e75Yqo5Y2V5YWD5qC85Lit55qE5YaF5a65DQogICAgICAgICAqLw0KICAgICAgICBtb3ZlQ29udGVudDpmdW5jdGlvbiAoY2VsbFRvLCBjZWxsRnJvbSkgew0KICAgICAgICAgICAgaWYgKFVFVGFibGUuaXNFbXB0eUJsb2NrKGNlbGxGcm9tKSkgcmV0dXJuOw0KICAgICAgICAgICAgaWYgKFVFVGFibGUuaXNFbXB0eUJsb2NrKGNlbGxUbykpIHsNCiAgICAgICAgICAgICAgICBjZWxsVG8uaW5uZXJIVE1MID0gY2VsbEZyb20uaW5uZXJIVE1MOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZhciBjaGlsZCA9IGNlbGxUby5sYXN0Q2hpbGQ7DQogICAgICAgICAgICBpZiAoY2hpbGQubm9kZVR5cGUgPT0gMyB8fCAhZHRkLiRibG9ja1tjaGlsZC50YWdOYW1lXSkgew0KICAgICAgICAgICAgICAgIGNlbGxUby5hcHBlbmRDaGlsZChjZWxsVG8ub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KCdicicpKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgd2hpbGUgKGNoaWxkID0gY2VsbEZyb20uZmlyc3RDaGlsZCkgew0KICAgICAgICAgICAgICAgIGNlbGxUby5hcHBlbmRDaGlsZChjaGlsZCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDlkJHlj7PlkIjlubbljZXlhYPmoLwNCiAgICAgICAgICovDQogICAgICAgIG1lcmdlUmlnaHQ6ZnVuY3Rpb24gKGNlbGwpIHsNCiAgICAgICAgICAgIHZhciBjZWxsSW5mbyA9IHRoaXMuZ2V0Q2VsbEluZm8oY2VsbCksDQogICAgICAgICAgICAgICAgcmlnaHRDb2xJbmRleCA9IGNlbGxJbmZvLmNvbEluZGV4ICsgY2VsbEluZm8uY29sU3BhbiwNCiAgICAgICAgICAgICAgICByaWdodENlbGxJbmZvID0gdGhpcy5pbmRleFRhYmxlW2NlbGxJbmZvLnJvd0luZGV4XVtyaWdodENvbEluZGV4XSwNCiAgICAgICAgICAgICAgICByaWdodENlbGwgPSB0aGlzLmdldENlbGwocmlnaHRDZWxsSW5mby5yb3dJbmRleCwgcmlnaHRDZWxsSW5mby5jZWxsSW5kZXgpOw0KICAgICAgICAgICAgLy/lkIjlubYNCiAgICAgICAgICAgIGNlbGwuY29sU3BhbiA9IGNlbGxJbmZvLmNvbFNwYW4gKyByaWdodENlbGxJbmZvLmNvbFNwYW47DQogICAgICAgICAgICAvL+iiq+WQiOW5tueahOWNleWFg+agvOS4jeW6lOWtmOWcqOWuveW6puWxnuaApw0KICAgICAgICAgICAgY2VsbC5yZW1vdmVBdHRyaWJ1dGUoIndpZHRoIik7DQogICAgICAgICAgICAvL+enu+WKqOWGheWuuQ0KICAgICAgICAgICAgdGhpcy5tb3ZlQ29udGVudChjZWxsLCByaWdodENlbGwpOw0KICAgICAgICAgICAgLy/liKDmjonooqvlkIjlubbnmoRDZWxsDQogICAgICAgICAgICB0aGlzLmRlbGV0ZUNlbGwocmlnaHRDZWxsLCByaWdodENlbGxJbmZvLnJvd0luZGV4KTsNCiAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDlkJHkuIvlkIjlubbljZXlhYPmoLwNCiAgICAgICAgICovDQogICAgICAgIG1lcmdlRG93bjpmdW5jdGlvbiAoY2VsbCkgew0KICAgICAgICAgICAgdmFyIGNlbGxJbmZvID0gdGhpcy5nZXRDZWxsSW5mbyhjZWxsKSwNCiAgICAgICAgICAgICAgICBkb3duUm93SW5kZXggPSBjZWxsSW5mby5yb3dJbmRleCArIGNlbGxJbmZvLnJvd1NwYW4sDQogICAgICAgICAgICAgICAgZG93bkNlbGxJbmZvID0gdGhpcy5pbmRleFRhYmxlW2Rvd25Sb3dJbmRleF1bY2VsbEluZm8uY29sSW5kZXhdLA0KICAgICAgICAgICAgICAgIGRvd25DZWxsID0gdGhpcy5nZXRDZWxsKGRvd25DZWxsSW5mby5yb3dJbmRleCwgZG93bkNlbGxJbmZvLmNlbGxJbmRleCk7DQogICAgICAgICAgICBjZWxsLnJvd1NwYW4gPSBjZWxsSW5mby5yb3dTcGFuICsgZG93bkNlbGxJbmZvLnJvd1NwYW47DQogICAgICAgICAgICBjZWxsLnJlbW92ZUF0dHJpYnV0ZSgiaGVpZ2h0Iik7DQogICAgICAgICAgICB0aGlzLm1vdmVDb250ZW50KGNlbGwsIGRvd25DZWxsKTsNCiAgICAgICAgICAgIHRoaXMuZGVsZXRlQ2VsbChkb3duQ2VsbCwgZG93bkNlbGxJbmZvLnJvd0luZGV4KTsNCiAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDlkIjlubbmlbTkuKpyYW5nZeS4reeahOWGheWuuQ0KICAgICAgICAgKi8NCiAgICAgICAgbWVyZ2VSYW5nZTpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAvL+eUseS6juWQiOW5tuaTjeS9nOWPr+S7peWcqOS7u+aEj+aXtuWIu+i/m+ihjO+8jOaJgOS7peaXoOazlemAmui/h+m8oOagh+S9jee9ruetieS/oeaBr+WunuaXtueUn+aIkHJhbmdl77yM5Y+q6IO96YCa6L+H57yT5a2Y5a6e5L6L5Lit55qEY2VsbHNSYW5nZeWvueixoeadpeiuv+mXrg0KICAgICAgICAgICAgdmFyIHJhbmdlID0gdGhpcy5jZWxsc1JhbmdlLA0KICAgICAgICAgICAgICAgIGxlZnRUb3BDZWxsID0gdGhpcy5nZXRDZWxsKHJhbmdlLmJlZ2luUm93SW5kZXgsIHRoaXMuaW5kZXhUYWJsZVtyYW5nZS5iZWdpblJvd0luZGV4XVtyYW5nZS5iZWdpbkNvbEluZGV4XS5jZWxsSW5kZXgpOw0KDQogICAgICAgICAgICBpZiAobGVmdFRvcENlbGwudGFnTmFtZSA9PSAiVEgiICYmIHJhbmdlLmVuZFJvd0luZGV4ICE9PSByYW5nZS5iZWdpblJvd0luZGV4KSB7DQogICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5pbmRleFRhYmxlLA0KICAgICAgICAgICAgICAgICAgICBpbmZvID0gdGhpcy5nZXRDZWxsSW5mbyhsZWZ0VG9wQ2VsbCk7DQogICAgICAgICAgICAgICAgbGVmdFRvcENlbGwgPSB0aGlzLmdldENlbGwoMSwgaW5kZXhbMV1baW5mby5jb2xJbmRleF0uY2VsbEluZGV4KTsNCiAgICAgICAgICAgICAgICByYW5nZSA9IHRoaXMuZ2V0Q2VsbHNSYW5nZShsZWZ0VG9wQ2VsbCwgdGhpcy5nZXRDZWxsKGluZGV4W3RoaXMucm93c051bSAtIDFdW2luZm8uY29sSW5kZXhdLnJvd0luZGV4LCBpbmRleFt0aGlzLnJvd3NOdW0gLSAxXVtpbmZvLmNvbEluZGV4XS5jZWxsSW5kZXgpKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8g5Yig6Zmk5Ymp5L2Z55qEQ2VsbHMNCiAgICAgICAgICAgIHZhciBjZWxscyA9IHRoaXMuZ2V0Q2VsbHMocmFuZ2UpOw0KICAgICAgICAgICAgZm9yKHZhciBpPSAwLGNpO2NpPWNlbGxzW2krK107KXsNCiAgICAgICAgICAgICAgICBpZiAoY2kgIT09IGxlZnRUb3BDZWxsKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubW92ZUNvbnRlbnQobGVmdFRvcENlbGwsIGNpKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWxldGVDZWxsKGNpKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICAvLyDkv67mlLnlt6bkuIrop5JDZWxs55qEcm93U3BhbuWSjGNvbFNwYW7vvIzlubbosIPmlbTlrr3luqblsZ7mgKforr7nva4NCiAgICAgICAgICAgIGxlZnRUb3BDZWxsLnJvd1NwYW4gPSByYW5nZS5lbmRSb3dJbmRleCAtIHJhbmdlLmJlZ2luUm93SW5kZXggKyAxOw0KICAgICAgICAgICAgbGVmdFRvcENlbGwucm93U3BhbiA+IDEgJiYgbGVmdFRvcENlbGwucmVtb3ZlQXR0cmlidXRlKCJoZWlnaHQiKTsNCiAgICAgICAgICAgIGxlZnRUb3BDZWxsLmNvbFNwYW4gPSByYW5nZS5lbmRDb2xJbmRleCAtIHJhbmdlLmJlZ2luQ29sSW5kZXggKyAxOw0KICAgICAgICAgICAgbGVmdFRvcENlbGwuY29sU3BhbiA+IDEgJiYgbGVmdFRvcENlbGwucmVtb3ZlQXR0cmlidXRlKCJ3aWR0aCIpOw0KICAgICAgICAgICAgaWYgKGxlZnRUb3BDZWxsLnJvd1NwYW4gPT0gdGhpcy5yb3dzTnVtICYmIGxlZnRUb3BDZWxsLmNvbFNwYW4gIT0gMSkgew0KICAgICAgICAgICAgICAgIGxlZnRUb3BDZWxsLmNvbFNwYW4gPSAxOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAobGVmdFRvcENlbGwuY29sU3BhbiA9PSB0aGlzLmNvbHNOdW0gJiYgbGVmdFRvcENlbGwucm93U3BhbiAhPSAxKSB7DQogICAgICAgICAgICAgICAgdmFyIHJvd0luZGV4ID0gbGVmdFRvcENlbGwucGFyZW50Tm9kZS5yb3dJbmRleDsNCiAgICAgICAgICAgICAgICAvL+ino+WGs0lF5LiL55qE6KGo5qC85pON5L2c6Zeu6aKYDQogICAgICAgICAgICAgICAgaWYoIHRoaXMudGFibGUuZGVsZXRlUm93ICkgew0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gcm93SW5kZXgrIDEsIGN1ckluZGV4PXJvd0luZGV4KyAxLCBsZW49bGVmdFRvcENlbGwucm93U3BhbjsgaSA8IGxlbjsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRhYmxlLmRlbGV0ZVJvdyhjdXJJbmRleCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuPWxlZnRUb3BDZWxsLnJvd1NwYW4gLSAxOyBpIDwgbGVuOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByb3cgPSB0aGlzLnRhYmxlLnJvd3Nbcm93SW5kZXggKyAxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJvdy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHJvdyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgbGVmdFRvcENlbGwucm93U3BhbiA9IDE7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLnVwZGF0ZSgpOw0KICAgICAgICB9LA0KICAgICAgICAvKioNCiAgICAgICAgICog5o+S5YWl5LiA6KGM5Y2V5YWD5qC8DQogICAgICAgICAqLw0KICAgICAgICBpbnNlcnRSb3c6ZnVuY3Rpb24gKHJvd0luZGV4LCBzb3VyY2VDZWxsKSB7DQogICAgICAgICAgICB2YXIgbnVtQ29scyA9IHRoaXMuY29sc051bSwNCiAgICAgICAgICAgICAgICB0YWJsZSA9IHRoaXMudGFibGUsDQogICAgICAgICAgICAgICAgcm93ID0gdGFibGUuaW5zZXJ0Um93KHJvd0luZGV4KSwgY2VsbCwNCiAgICAgICAgICAgICAgICB3aWR0aCA9IHBhcnNlSW50KCh0YWJsZS5vZmZzZXRXaWR0aCAtIG51bUNvbHMgKiAyMCAtIG51bUNvbHMgLSAxKSAvIG51bUNvbHMsIDEwKTsNCiAgICAgICAgICAgIC8v6aaW6KGM55u05o6l5o+S5YWlLOaXoOmcgOiAg+iZkemDqOWIhuWNleWFg+agvOiiq3Jvd3NwYW7nmoTmg4XlhrUNCiAgICAgICAgICAgIGlmIChyb3dJbmRleCA9PSAwIHx8IHJvd0luZGV4ID09IHRoaXMucm93c051bSkgew0KICAgICAgICAgICAgICAgIGZvciAodmFyIGNvbEluZGV4ID0gMDsgY29sSW5kZXggPCBudW1Db2xzOyBjb2xJbmRleCsrKSB7DQogICAgICAgICAgICAgICAgICAgIGNlbGwgPSB0aGlzLmNsb25lQ2VsbChzb3VyY2VDZWxsLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRDZWxsQ29udGVudChjZWxsKTsNCiAgICAgICAgICAgICAgICAgICAgY2VsbC5nZXRBdHRyaWJ1dGUoJ3ZBbGlnbicpICYmIGNlbGwuc2V0QXR0cmlidXRlKCd2QWxpZ24nLCBjZWxsLmdldEF0dHJpYnV0ZSgndkFsaWduJykpOw0KICAgICAgICAgICAgICAgICAgICByb3cuYXBwZW5kQ2hpbGQoY2VsbCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB2YXIgaW5mb1JvdyA9IHRoaXMuaW5kZXhUYWJsZVtyb3dJbmRleF0sDQogICAgICAgICAgICAgICAgICAgIGNlbGxJbmRleCA9IDA7DQogICAgICAgICAgICAgICAgZm9yIChjb2xJbmRleCA9IDA7IGNvbEluZGV4IDwgbnVtQ29sczsgY29sSW5kZXgrKykgew0KICAgICAgICAgICAgICAgICAgICB2YXIgY2VsbEluZm8gPSBpbmZvUm93W2NvbEluZGV4XTsNCiAgICAgICAgICAgICAgICAgICAgLy/lpoLmnpzlrZjlnKjmn5DkuKrljZXlhYPmoLznmoRyb3dzcGFu56m/6L+H5b6F5o+S5YWl6KGM55qE5L2N572u77yM5YiZ5L+u5pS56K+l5Y2V5YWD5qC855qEcm93c3BhbuWNs+WPr++8jOaXoOmcgOaPkuWFpeWNleWFg+agvA0KICAgICAgICAgICAgICAgICAgICBpZiAoY2VsbEluZm8ucm93SW5kZXggPCByb3dJbmRleCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY2VsbCA9IHRoaXMuZ2V0Q2VsbChjZWxsSW5mby5yb3dJbmRleCwgY2VsbEluZm8uY2VsbEluZGV4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNlbGwucm93U3BhbiA9IGNlbGxJbmZvLnJvd1NwYW4gKyAxOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgY2VsbCA9IHRoaXMuY2xvbmVDZWxsKHNvdXJjZUNlbGwsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRDZWxsQ29udGVudChjZWxsKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChjZWxsKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8v5qGG6YCJ5pe25o+S5YWl5LiN6Kem5Y+RY29udGVudGNoYW5nZe+8jOmcgOimgeaJi+WKqOabtOaWsOe0ouW8leOAgg0KICAgICAgICAgICAgdGhpcy51cGRhdGUoKTsNCiAgICAgICAgICAgIHJldHVybiByb3c7DQogICAgICAgIH0sDQogICAgICAgIC8qKg0KICAgICAgICAgKiDliKDpmaTkuIDooYzljZXlhYPmoLwNCiAgICAgICAgICogQHBhcmFtIHJvd0luZGV4DQogICAgICAgICAqLw0KICAgICAgICBkZWxldGVSb3c6ZnVuY3Rpb24gKHJvd0luZGV4KSB7DQogICAgICAgICAgICB2YXIgcm93ID0gdGhpcy50YWJsZS5yb3dzW3Jvd0luZGV4XSwNCiAgICAgICAgICAgICAgICBpbmZvUm93ID0gdGhpcy5pbmRleFRhYmxlW3Jvd0luZGV4XSwNCiAgICAgICAgICAgICAgICBjb2xzTnVtID0gdGhpcy5jb2xzTnVtLA0KICAgICAgICAgICAgICAgIGNvdW50ID0gMDsgICAgIC8v5aSE55CG6K6h5pWwDQogICAgICAgICAgICBmb3IgKHZhciBjb2xJbmRleCA9IDA7IGNvbEluZGV4IDwgY29sc051bTspIHsNCiAgICAgICAgICAgICAgICB2YXIgY2VsbEluZm8gPSBpbmZvUm93W2NvbEluZGV4XSwNCiAgICAgICAgICAgICAgICAgICAgY2VsbCA9IHRoaXMuZ2V0Q2VsbChjZWxsSW5mby5yb3dJbmRleCwgY2VsbEluZm8uY2VsbEluZGV4KTsNCiAgICAgICAgICAgICAgICBpZiAoY2VsbC5yb3dTcGFuID4gMSkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoY2VsbEluZm8ucm93SW5kZXggPT0gcm93SW5kZXgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjbG9uZSA9IGNlbGwuY2xvbmVOb2RlKHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2xvbmUucm93U3BhbiA9IGNlbGwucm93U3BhbiAtIDE7DQogICAgICAgICAgICAgICAgICAgICAgICBjbG9uZS5pbm5lckhUTUwgPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNlbGwucm93U3BhbiA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV4dFJvd0luZGV4ID0gcm93SW5kZXggKyAxLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHRSb3cgPSB0aGlzLnRhYmxlLnJvd3NbbmV4dFJvd0luZGV4XSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnNlcnRDZWxsSW5kZXgsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlTWVyZ2VkID0gdGhpcy5nZXRQcmV2aWV3TWVyZ2VkQ2VsbHNOdW0obmV4dFJvd0luZGV4LCBjb2xJbmRleCkgLSBjb3VudDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcmVNZXJnZWQgPCBjb2xJbmRleCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc2VydENlbGxJbmRleCA9IGNvbEluZGV4IC0gcHJlTWVyZ2VkIC0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL25leHRSb3cuaW5zZXJ0Q2VsbChpbnNlcnRDZWxsSW5kZXgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLmluc2VydEFmdGVyKG5leHRSb3cuY2VsbHNbaW5zZXJ0Q2VsbEluZGV4XSwgY2xvbmUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV4dFJvdy5jZWxscy5sZW5ndGgpIG5leHRSb3cuaW5zZXJ0QmVmb3JlKGNsb25lLCBuZXh0Um93LmNlbGxzWzBdKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgY291bnQgKz0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vY2VsbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGNlbGwpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGNvbEluZGV4ICs9IGNlbGwuY29sU3BhbiB8fCAxOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdmFyIGRlbGV0ZVRkcyA9IFtdLCBjYWNoZU1hcCA9IHt9Ow0KICAgICAgICAgICAgZm9yIChjb2xJbmRleCA9IDA7IGNvbEluZGV4IDwgY29sc051bTsgY29sSW5kZXgrKykgew0KICAgICAgICAgICAgICAgIHZhciB0bXBSb3dJbmRleCA9IGluZm9Sb3dbY29sSW5kZXhdLnJvd0luZGV4LA0KICAgICAgICAgICAgICAgICAgICB0bXBDZWxsSW5kZXggPSBpbmZvUm93W2NvbEluZGV4XS5jZWxsSW5kZXgsDQogICAgICAgICAgICAgICAgICAgIGtleSA9IHRtcFJvd0luZGV4ICsgIl8iICsgdG1wQ2VsbEluZGV4Ow0KICAgICAgICAgICAgICAgIGlmIChjYWNoZU1hcFtrZXldKWNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIGNhY2hlTWFwW2tleV0gPSAxOw0KICAgICAgICAgICAgICAgIGNlbGwgPSB0aGlzLmdldENlbGwodG1wUm93SW5kZXgsIHRtcENlbGxJbmRleCk7DQogICAgICAgICAgICAgICAgZGVsZXRlVGRzLnB1c2goY2VsbCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB2YXIgbWVyZ2VUZHMgPSBbXTsNCiAgICAgICAgICAgIHV0aWxzLmVhY2goZGVsZXRlVGRzLCBmdW5jdGlvbiAodGQpIHsNCiAgICAgICAgICAgICAgICBpZiAodGQucm93U3BhbiA9PSAxKSB7DQogICAgICAgICAgICAgICAgICAgIHRkLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGQpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIG1lcmdlVGRzLnB1c2godGQpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgdXRpbHMuZWFjaChtZXJnZVRkcywgZnVuY3Rpb24gKHRkKSB7DQogICAgICAgICAgICAgICAgdGQucm93U3Bhbi0tOw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICByb3cucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChyb3cpOw0KICAgICAgICAgICAgLy/mtY/op4jlmajmlrnms5XmnKzouqvlrZjlnKhidWcs6YeH55So6Ieq5a6a5LmJ5pa55rOV5Yig6ZmkDQogICAgICAgICAgICAvL3RoaXMudGFibGUuZGVsZXRlUm93KHJvd0luZGV4KTsNCiAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7DQogICAgICAgIH0sDQogICAgICAgIGluc2VydENvbDpmdW5jdGlvbiAoY29sSW5kZXgsIHNvdXJjZUNlbGwsIGRlZmF1bHRWYWx1ZSkgew0KICAgICAgICAgICAgdmFyIHJvd3NOdW0gPSB0aGlzLnJvd3NOdW0sDQogICAgICAgICAgICAgICAgcm93SW5kZXggPSAwLA0KICAgICAgICAgICAgICAgIHRhYmxlUm93LCBjZWxsLA0KICAgICAgICAgICAgICAgIGJhY2tXaWR0aCA9IHBhcnNlSW50KCh0aGlzLnRhYmxlLm9mZnNldFdpZHRoIC0gKHRoaXMuY29sc051bSArIDEpICogMjAgLSAodGhpcy5jb2xzTnVtICsgMSkpIC8gKHRoaXMuY29sc051bSArIDEpLCAxMCk7DQoNCiAgICAgICAgICAgIGZ1bmN0aW9uIHJlcGxhY2VUZFRvVGgocm93SW5kZXgsIGNlbGwsIHRhYmxlUm93KSB7DQogICAgICAgICAgICAgICAgaWYgKHJvd0luZGV4ID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHRoID0gY2VsbC5uZXh0U2libGluZyB8fCBjZWxsLnByZXZpb3VzU2libGluZzsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHRoLnRhZ05hbWUgPT0gJ1RIJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGggPSBjZWxsLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGgiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoLmFwcGVuZENoaWxkKGNlbGwuZmlyc3RDaGlsZCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0YWJsZVJvdy5pbnNlcnRCZWZvcmUodGgsIGNlbGwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKGNlbGwpDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGNlbGwudGFnTmFtZSA9PSAnVEgnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGQgPSBjZWxsLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGQiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRkLmFwcGVuZENoaWxkKGNlbGwuZmlyc3RDaGlsZCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0YWJsZVJvdy5pbnNlcnRCZWZvcmUodGQsIGNlbGwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKGNlbGwpDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHZhciBwcmVDZWxsOw0KICAgICAgICAgICAgaWYgKGNvbEluZGV4ID09IDAgfHwgY29sSW5kZXggPT0gdGhpcy5jb2xzTnVtKSB7DQogICAgICAgICAgICAgICAgZm9yICg7IHJvd0luZGV4IDwgcm93c051bTsgcm93SW5kZXgrKykgew0KICAgICAgICAgICAgICAgICAgICB0YWJsZVJvdyA9IHRoaXMudGFibGUucm93c1tyb3dJbmRleF07DQogICAgICAgICAgICAgICAgICAgIHByZUNlbGwgPSB0YWJsZVJvdy5jZWxsc1tjb2xJbmRleCA9PSAwID8gY29sSW5kZXggOiB0YWJsZVJvdy5jZWxscy5sZW5ndGhdOw0KICAgICAgICAgICAgICAgICAgICBjZWxsID0gdGhpcy5jbG9uZUNlbGwoc291cmNlQ2VsbCwgdHJ1ZSk7IC8vdGFibGVSb3cuaW5zZXJ0Q2VsbChjb2xJbmRleCA9PSAwID8gY29sSW5kZXggOiB0YWJsZVJvdy5jZWxscy5sZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNldENlbGxDb250ZW50KGNlbGwpOw0KICAgICAgICAgICAgICAgICAgICBjZWxsLnNldEF0dHJpYnV0ZSgndkFsaWduJywgY2VsbC5nZXRBdHRyaWJ1dGUoJ3ZBbGlnbicpKTsNCiAgICAgICAgICAgICAgICAgICAgcHJlQ2VsbCAmJiBjZWxsLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCBwcmVDZWxsLmdldEF0dHJpYnV0ZSgnd2lkdGgnKSk7DQogICAgICAgICAgICAgICAgICAgIGlmICghY29sSW5kZXgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlUm93Lmluc2VydEJlZm9yZShjZWxsLCB0YWJsZVJvdy5jZWxsc1swXSk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5pbnNlcnRBZnRlcih0YWJsZVJvdy5jZWxsc1t0YWJsZVJvdy5jZWxscy5sZW5ndGggLSAxXSwgY2VsbCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmVwbGFjZVRkVG9UaChyb3dJbmRleCwgY2VsbCwgdGFibGVSb3cpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBmb3IgKDsgcm93SW5kZXggPCByb3dzTnVtOyByb3dJbmRleCsrKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBjZWxsSW5mbyA9IHRoaXMuaW5kZXhUYWJsZVtyb3dJbmRleF1bY29sSW5kZXhdOw0KICAgICAgICAgICAgICAgICAgICBpZiAoY2VsbEluZm8uY29sSW5kZXggPCBjb2xJbmRleCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY2VsbCA9IHRoaXMuZ2V0Q2VsbChjZWxsSW5mby5yb3dJbmRleCwgY2VsbEluZm8uY2VsbEluZGV4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNlbGwuY29sU3BhbiA9IGNlbGxJbmZvLmNvbFNwYW4gKyAxOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVSb3cgPSB0aGlzLnRhYmxlLnJvd3Nbcm93SW5kZXhdOw0KICAgICAgICAgICAgICAgICAgICAgICAgcHJlQ2VsbCA9IHRhYmxlUm93LmNlbGxzW2NlbGxJbmZvLmNlbGxJbmRleF07DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGNlbGwgPSB0aGlzLmNsb25lQ2VsbChzb3VyY2VDZWxsLCB0cnVlKTsvL3RhYmxlUm93Lmluc2VydENlbGwoY2VsbEluZm8uY2VsbEluZGV4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0Q2VsbENvbnRlbnQoY2VsbCk7DQogICAgICAgICAgICAgICAgICAgICAgICBjZWxsLnNldEF0dHJpYnV0ZSgndkFsaWduJywgY2VsbC5nZXRBdHRyaWJ1dGUoJ3ZBbGlnbicpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHByZUNlbGwgJiYgY2VsbC5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgcHJlQ2VsbC5nZXRBdHRyaWJ1dGUoJ3dpZHRoJykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgLy/pmLLmraJJReS4i+aKpemUmQ0KICAgICAgICAgICAgICAgICAgICAgICAgcHJlQ2VsbCA/IHRhYmxlUm93Lmluc2VydEJlZm9yZShjZWxsLCBwcmVDZWxsKSA6IHRhYmxlUm93LmFwcGVuZENoaWxkKGNlbGwpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJlcGxhY2VUZFRvVGgocm93SW5kZXgsIGNlbGwsIHRhYmxlUm93KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICAvL+ahhumAieaXtuaPkuWFpeS4jeinpuWPkWNvbnRlbnRjaGFuZ2XvvIzpnIDopoHmiYvliqjmm7TmlrDntKLlvJUNCiAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7DQogICAgICAgICAgICB0aGlzLnVwZGF0ZVdpZHRoKGJhY2tXaWR0aCwgZGVmYXVsdFZhbHVlIHx8IHt0ZFBhZGRpbmc6MTAsIHRkQm9yZGVyOjF9KTsNCiAgICAgICAgfSwNCiAgICAgICAgdXBkYXRlV2lkdGg6ZnVuY3Rpb24gKHdpZHRoLCBkZWZhdWx0VmFsdWUpIHsNCiAgICAgICAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGUsDQogICAgICAgICAgICAgICAgdG1wV2lkdGggPSBVRVRhYmxlLmdldFdpZHRoKHRhYmxlKSAtIGRlZmF1bHRWYWx1ZS50ZFBhZGRpbmcgKiAyIC0gZGVmYXVsdFZhbHVlLnRkQm9yZGVyICsgd2lkdGg7DQogICAgICAgICAgICBpZiAodG1wV2lkdGggPCB0YWJsZS5vd25lckRvY3VtZW50LmJvZHkub2Zmc2V0V2lkdGgpIHsNCiAgICAgICAgICAgICAgICB0YWJsZS5zZXRBdHRyaWJ1dGUoIndpZHRoIiwgdG1wV2lkdGgpOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZhciB0ZHMgPSBkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZSh0aGlzLnRhYmxlLCAidGQiKTsNCiAgICAgICAgICAgIHV0aWxzLmVhY2godGRzLCBmdW5jdGlvbiAodGQpIHsNCiAgICAgICAgICAgICAgICB0ZC5zZXRBdHRyaWJ1dGUoIndpZHRoIiwgd2lkdGgpOw0KICAgICAgICAgICAgfSkNCiAgICAgICAgfSwNCiAgICAgICAgZGVsZXRlQ29sOmZ1bmN0aW9uIChjb2xJbmRleCkgew0KICAgICAgICAgICAgdmFyIGluZGV4VGFibGUgPSB0aGlzLmluZGV4VGFibGUsDQogICAgICAgICAgICAgICAgdGFibGVSb3dzID0gdGhpcy50YWJsZS5yb3dzLA0KICAgICAgICAgICAgICAgIGJhY2tUYWJsZVdpZHRoID0gdGhpcy50YWJsZS5nZXRBdHRyaWJ1dGUoIndpZHRoIiksDQogICAgICAgICAgICAgICAgYmFja1RkV2lkdGggPSAwLA0KICAgICAgICAgICAgICAgIHJvd3NOdW0gPSB0aGlzLnJvd3NOdW0sDQogICAgICAgICAgICAgICAgY2FjaGVNYXAgPSB7fTsNCiAgICAgICAgICAgIGZvciAodmFyIHJvd0luZGV4ID0gMDsgcm93SW5kZXggPCByb3dzTnVtOykgew0KICAgICAgICAgICAgICAgIHZhciBpbmZvUm93ID0gaW5kZXhUYWJsZVtyb3dJbmRleF0sDQogICAgICAgICAgICAgICAgICAgIGNlbGxJbmZvID0gaW5mb1Jvd1tjb2xJbmRleF0sDQogICAgICAgICAgICAgICAgICAgIGtleSA9IGNlbGxJbmZvLnJvd0luZGV4ICsgJ18nICsgY2VsbEluZm8uY29sSW5kZXg7DQogICAgICAgICAgICAgICAgLy8g6Lez6L+H5bey57uP5aSE55CG6L+H55qEQ2VsbA0KICAgICAgICAgICAgICAgIGlmIChjYWNoZU1hcFtrZXldKWNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIGNhY2hlTWFwW2tleV0gPSAxOw0KICAgICAgICAgICAgICAgIHZhciBjZWxsID0gdGhpcy5nZXRDZWxsKGNlbGxJbmZvLnJvd0luZGV4LCBjZWxsSW5mby5jZWxsSW5kZXgpOw0KICAgICAgICAgICAgICAgIGlmICghYmFja1RkV2lkdGgpIGJhY2tUZFdpZHRoID0gY2VsbCAmJiBwYXJzZUludChjZWxsLm9mZnNldFdpZHRoIC8gY2VsbC5jb2xTcGFuLCAxMCkudG9GaXhlZCgwKTsNCiAgICAgICAgICAgICAgICAvLyDlpoLmnpxDZWxs55qEY29sU3BhbuWkp+S6jjEsIOWwseS/ruaUuWNvbFNwYW4sIOWQpuWImeWwseWIoOaOiei/meS4qkNlbGwNCiAgICAgICAgICAgICAgICBpZiAoY2VsbC5jb2xTcGFuID4gMSkgew0KICAgICAgICAgICAgICAgICAgICBjZWxsLmNvbFNwYW4tLTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICB0YWJsZVJvd3Nbcm93SW5kZXhdLmRlbGV0ZUNlbGwoY2VsbEluZm8uY2VsbEluZGV4KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcm93SW5kZXggKz0gY2VsbEluZm8ucm93U3BhbiB8fCAxOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy50YWJsZS5zZXRBdHRyaWJ1dGUoIndpZHRoIiwgYmFja1RhYmxlV2lkdGggLSBiYWNrVGRXaWR0aCk7DQogICAgICAgICAgICB0aGlzLnVwZGF0ZSgpOw0KICAgICAgICB9LA0KICAgICAgICBzcGxpdFRvQ2VsbHM6ZnVuY3Rpb24gKGNlbGwpIHsNCiAgICAgICAgICAgIHZhciBtZSA9IHRoaXMsDQogICAgICAgICAgICAgICAgY2VsbHMgPSB0aGlzLnNwbGl0VG9Sb3dzKGNlbGwpOw0KICAgICAgICAgICAgdXRpbHMuZWFjaChjZWxscywgZnVuY3Rpb24gKGNlbGwpIHsNCiAgICAgICAgICAgICAgICBtZS5zcGxpdFRvQ29scyhjZWxsKTsNCiAgICAgICAgICAgIH0pDQogICAgICAgIH0sDQogICAgICAgIHNwbGl0VG9Sb3dzOmZ1bmN0aW9uIChjZWxsKSB7DQogICAgICAgICAgICB2YXIgY2VsbEluZm8gPSB0aGlzLmdldENlbGxJbmZvKGNlbGwpLA0KICAgICAgICAgICAgICAgIHJvd0luZGV4ID0gY2VsbEluZm8ucm93SW5kZXgsDQogICAgICAgICAgICAgICAgY29sSW5kZXggPSBjZWxsSW5mby5jb2xJbmRleCwNCiAgICAgICAgICAgICAgICByZXN1bHRzID0gW107DQogICAgICAgICAgICAvLyDkv67mlLlDZWxs55qEcm93U3Bhbg0KICAgICAgICAgICAgY2VsbC5yb3dTcGFuID0gMTsNCiAgICAgICAgICAgIHJlc3VsdHMucHVzaChjZWxsKTsNCiAgICAgICAgICAgIC8vIOihpem9kOWNleWFg+agvA0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IHJvd0luZGV4LCBlbmRSb3cgPSByb3dJbmRleCArIGNlbGxJbmZvLnJvd1NwYW47IGkgPCBlbmRSb3c7IGkrKykgew0KICAgICAgICAgICAgICAgIGlmIChpID09IHJvd0luZGV4KWNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIHZhciB0YWJsZVJvdyA9IHRoaXMudGFibGUucm93c1tpXSwNCiAgICAgICAgICAgICAgICAgICAgdG1wQ2VsbCA9IHRhYmxlUm93Lmluc2VydENlbGwoY29sSW5kZXggLSB0aGlzLmdldFByZXZpZXdNZXJnZWRDZWxsc051bShpLCBjb2xJbmRleCkpOw0KICAgICAgICAgICAgICAgIHRtcENlbGwuY29sU3BhbiA9IGNlbGxJbmZvLmNvbFNwYW47DQogICAgICAgICAgICAgICAgdGhpcy5zZXRDZWxsQ29udGVudCh0bXBDZWxsKTsNCiAgICAgICAgICAgICAgICB0bXBDZWxsLnNldEF0dHJpYnV0ZSgndkFsaWduJywgY2VsbC5nZXRBdHRyaWJ1dGUoJ3ZBbGlnbicpKTsNCiAgICAgICAgICAgICAgICB0bXBDZWxsLnNldEF0dHJpYnV0ZSgnYWxpZ24nLCBjZWxsLmdldEF0dHJpYnV0ZSgnYWxpZ24nKSk7DQogICAgICAgICAgICAgICAgaWYgKGNlbGwuc3R5bGUuY3NzVGV4dCkgew0KICAgICAgICAgICAgICAgICAgICB0bXBDZWxsLnN0eWxlLmNzc1RleHQgPSBjZWxsLnN0eWxlLmNzc1RleHQ7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaCh0bXBDZWxsKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7DQogICAgICAgICAgICByZXR1cm4gcmVzdWx0czsNCiAgICAgICAgfSwNCiAgICAgICAgZ2V0UHJldmlld01lcmdlZENlbGxzTnVtOmZ1bmN0aW9uIChyb3dJbmRleCwgY29sSW5kZXgpIHsNCiAgICAgICAgICAgIHZhciBpbmRleFJvdyA9IHRoaXMuaW5kZXhUYWJsZVtyb3dJbmRleF0sDQogICAgICAgICAgICAgICAgbnVtID0gMDsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29sSW5kZXg7KSB7DQogICAgICAgICAgICAgICAgdmFyIGNvbFNwYW4gPSBpbmRleFJvd1tpXS5jb2xTcGFuLA0KICAgICAgICAgICAgICAgICAgICB0bXBSb3dJbmRleCA9IGluZGV4Um93W2ldLnJvd0luZGV4Ow0KICAgICAgICAgICAgICAgIG51bSArPSAoY29sU3BhbiAtICh0bXBSb3dJbmRleCA9PSByb3dJbmRleCA/IDEgOiAwKSk7DQogICAgICAgICAgICAgICAgaSArPSBjb2xTcGFuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIG51bTsNCiAgICAgICAgfSwNCiAgICAgICAgc3BsaXRUb0NvbHM6ZnVuY3Rpb24gKGNlbGwpIHsNCiAgICAgICAgICAgIHZhciBiYWNrV2lkdGggPSAoY2VsbC5vZmZzZXRXaWR0aCAvIGNlbGwuY29sU3BhbiAtIDIyKS50b0ZpeGVkKDApLA0KDQogICAgICAgICAgICAgICAgY2VsbEluZm8gPSB0aGlzLmdldENlbGxJbmZvKGNlbGwpLA0KICAgICAgICAgICAgICAgIHJvd0luZGV4ID0gY2VsbEluZm8ucm93SW5kZXgsDQogICAgICAgICAgICAgICAgY29sSW5kZXggPSBjZWxsSW5mby5jb2xJbmRleCwNCiAgICAgICAgICAgICAgICByZXN1bHRzID0gW107DQogICAgICAgICAgICAvLyDkv67mlLlDZWxs55qEcm93U3Bhbg0KICAgICAgICAgICAgY2VsbC5jb2xTcGFuID0gMTsNCiAgICAgICAgICAgIGNlbGwuc2V0QXR0cmlidXRlKCJ3aWR0aCIsIGJhY2tXaWR0aCk7DQogICAgICAgICAgICByZXN1bHRzLnB1c2goY2VsbCk7DQogICAgICAgICAgICAvLyDooaXpvZDljZXlhYPmoLwNCiAgICAgICAgICAgIGZvciAodmFyIGogPSBjb2xJbmRleCwgZW5kQ29sID0gY29sSW5kZXggKyBjZWxsSW5mby5jb2xTcGFuOyBqIDwgZW5kQ29sOyBqKyspIHsNCiAgICAgICAgICAgICAgICBpZiAoaiA9PSBjb2xJbmRleCljb250aW51ZTsNCiAgICAgICAgICAgICAgICB2YXIgdGFibGVSb3cgPSB0aGlzLnRhYmxlLnJvd3Nbcm93SW5kZXhdLA0KICAgICAgICAgICAgICAgICAgICB0bXBDZWxsID0gdGFibGVSb3cuaW5zZXJ0Q2VsbCh0aGlzLmluZGV4VGFibGVbcm93SW5kZXhdW2pdLmNlbGxJbmRleCArIDEpOw0KICAgICAgICAgICAgICAgIHRtcENlbGwucm93U3BhbiA9IGNlbGxJbmZvLnJvd1NwYW47DQogICAgICAgICAgICAgICAgdGhpcy5zZXRDZWxsQ29udGVudCh0bXBDZWxsKTsNCiAgICAgICAgICAgICAgICB0bXBDZWxsLnNldEF0dHJpYnV0ZSgndkFsaWduJywgY2VsbC5nZXRBdHRyaWJ1dGUoJ3ZBbGlnbicpKTsNCiAgICAgICAgICAgICAgICB0bXBDZWxsLnNldEF0dHJpYnV0ZSgnYWxpZ24nLCBjZWxsLmdldEF0dHJpYnV0ZSgnYWxpZ24nKSk7DQogICAgICAgICAgICAgICAgdG1wQ2VsbC5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgYmFja1dpZHRoKTsNCiAgICAgICAgICAgICAgICBpZiAoY2VsbC5zdHlsZS5jc3NUZXh0KSB7DQogICAgICAgICAgICAgICAgICAgIHRtcENlbGwuc3R5bGUuY3NzVGV4dCA9IGNlbGwuc3R5bGUuY3NzVGV4dDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy/lpITnkIZ0aOeahOaDheWGtQ0KICAgICAgICAgICAgICAgIGlmIChjZWxsLnRhZ05hbWUgPT0gJ1RIJykgew0KICAgICAgICAgICAgICAgICAgICB2YXIgdGggPSBjZWxsLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGgnKTsNCiAgICAgICAgICAgICAgICAgICAgdGguYXBwZW5kQ2hpbGQodG1wQ2VsbC5maXJzdENoaWxkKTsNCiAgICAgICAgICAgICAgICAgICAgdGguc2V0QXR0cmlidXRlKCd2QWxpZ24nLCBjZWxsLmdldEF0dHJpYnV0ZSgndkFsaWduJykpOw0KICAgICAgICAgICAgICAgICAgICB0aC5yb3dTcGFuID0gdG1wQ2VsbC5yb3dTcGFuOw0KICAgICAgICAgICAgICAgICAgICB0YWJsZVJvdy5pbnNlcnRCZWZvcmUodGgsIHRtcENlbGwpOw0KICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUodG1wQ2VsbCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaCh0bXBDZWxsKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7DQogICAgICAgICAgICByZXR1cm4gcmVzdWx0czsNCiAgICAgICAgfSwNCiAgICAgICAgaXNMYXN0Q2VsbDpmdW5jdGlvbiAoY2VsbCwgcm93c051bSwgY29sc051bSkgew0KICAgICAgICAgICAgcm93c051bSA9IHJvd3NOdW0gfHwgdGhpcy5yb3dzTnVtOw0KICAgICAgICAgICAgY29sc051bSA9IGNvbHNOdW0gfHwgdGhpcy5jb2xzTnVtOw0KICAgICAgICAgICAgdmFyIGNlbGxJbmZvID0gdGhpcy5nZXRDZWxsSW5mbyhjZWxsKTsNCiAgICAgICAgICAgIHJldHVybiAoKGNlbGxJbmZvLnJvd0luZGV4ICsgY2VsbEluZm8ucm93U3BhbikgPT0gcm93c051bSkgJiYNCiAgICAgICAgICAgICAgICAoKGNlbGxJbmZvLmNvbEluZGV4ICsgY2VsbEluZm8uY29sU3BhbikgPT0gY29sc051bSk7DQogICAgICAgIH0sDQogICAgICAgIGdldExhc3RDZWxsOmZ1bmN0aW9uIChjZWxscykgew0KICAgICAgICAgICAgY2VsbHMgPSBjZWxscyB8fCB0aGlzLnRhYmxlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0ZCIpOw0KICAgICAgICAgICAgdmFyIGZpcnN0SW5mbyA9IHRoaXMuZ2V0Q2VsbEluZm8oY2VsbHNbMF0pOw0KICAgICAgICAgICAgdmFyIG1lID0gdGhpcywgbGFzdCA9IGNlbGxzWzBdLA0KICAgICAgICAgICAgICAgIHRyID0gbGFzdC5wYXJlbnROb2RlLA0KICAgICAgICAgICAgICAgIGNlbGxzTnVtID0gMCwgY29scyA9IDAsIHJvd3M7DQogICAgICAgICAgICB1dGlscy5lYWNoKGNlbGxzLCBmdW5jdGlvbiAoY2VsbCkgew0KICAgICAgICAgICAgICAgIGlmIChjZWxsLnBhcmVudE5vZGUgPT0gdHIpY29scyArPSBjZWxsLmNvbFNwYW4gfHwgMTsNCiAgICAgICAgICAgICAgICBjZWxsc051bSArPSBjZWxsLnJvd1NwYW4gKiBjZWxsLmNvbFNwYW4gfHwgMTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgcm93cyA9IGNlbGxzTnVtIC8gY29sczsNCiAgICAgICAgICAgIHV0aWxzLmVhY2goY2VsbHMsIGZ1bmN0aW9uIChjZWxsKSB7DQogICAgICAgICAgICAgICAgaWYgKG1lLmlzTGFzdENlbGwoY2VsbCwgcm93cywgY29scykpIHsNCiAgICAgICAgICAgICAgICAgICAgbGFzdCA9IGNlbGw7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIHJldHVybiBsYXN0Ow0KDQogICAgICAgIH0sDQogICAgICAgIHNlbGVjdFJvdzpmdW5jdGlvbiAocm93SW5kZXgpIHsNCiAgICAgICAgICAgIHZhciBpbmRleFJvdyA9IHRoaXMuaW5kZXhUYWJsZVtyb3dJbmRleF0sDQogICAgICAgICAgICAgICAgc3RhcnQgPSB0aGlzLmdldENlbGwoaW5kZXhSb3dbMF0ucm93SW5kZXgsIGluZGV4Um93WzBdLmNlbGxJbmRleCksDQogICAgICAgICAgICAgICAgZW5kID0gdGhpcy5nZXRDZWxsKGluZGV4Um93W3RoaXMuY29sc051bSAtIDFdLnJvd0luZGV4LCBpbmRleFJvd1t0aGlzLmNvbHNOdW0gLSAxXS5jZWxsSW5kZXgpLA0KICAgICAgICAgICAgICAgIHJhbmdlID0gdGhpcy5nZXRDZWxsc1JhbmdlKHN0YXJ0LCBlbmQpOw0KICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3RlZChyYW5nZSk7DQogICAgICAgIH0sDQogICAgICAgIHNlbGVjdFRhYmxlOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciB0ZHMgPSB0aGlzLnRhYmxlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0ZCIpLA0KICAgICAgICAgICAgICAgIHJhbmdlID0gdGhpcy5nZXRDZWxsc1JhbmdlKHRkc1swXSwgdGRzW3Rkcy5sZW5ndGggLSAxXSk7DQogICAgICAgICAgICB0aGlzLnNldFNlbGVjdGVkKHJhbmdlKTsNCiAgICAgICAgfSwNCiAgICAgICAgc29ydFRhYmxlOmZ1bmN0aW9uIChzb3J0QnlDZWxsSW5kZXgsIGNvbXBhcmVGbikgew0KICAgICAgICAgICAgdmFyIHRhYmxlID0gdGhpcy50YWJsZSwNCiAgICAgICAgICAgICAgICByb3dzID0gdGFibGUucm93cywNCiAgICAgICAgICAgICAgICB0ckFycmF5ID0gW10sDQogICAgICAgICAgICAgICAgZmxhZyA9IHJvd3NbMF0uY2VsbHNbMF0udGFnTmFtZSA9PT0gIlRIIiwNCiAgICAgICAgICAgICAgICBsYXN0Um93SW5kZXggPSAwOw0KICAgICAgICAgICAgaWYodGhpcy5zZWxlY3RlZFRkcy5sZW5ndGgpew0KICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IHRoaXMuY2VsbHNSYW5nZSwNCiAgICAgICAgICAgICAgICAgICAgbGVuID0gcmFuZ2UuZW5kUm93SW5kZXggKyAxOw0KICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSByYW5nZS5iZWdpblJvd0luZGV4OyBpIDwgbGVuOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgdHJBcnJheVtpXSA9IHJvd3NbaV07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRyQXJyYXkuc3BsaWNlKDAscmFuZ2UuYmVnaW5Sb3dJbmRleCk7DQogICAgICAgICAgICAgICAgbGFzdFJvd0luZGV4ID0gKHJhbmdlLmVuZFJvd0luZGV4ICsxKSA9PT0gdGhpcy5yb3dzTnVtID8gMCA6IHJhbmdlLmVuZFJvd0luZGV4ICsxOw0KICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsbGVuID0gcm93cy5sZW5ndGg7IGkgPCBsZW47IGkrKykgew0KICAgICAgICAgICAgICAgICAgICB0ckFycmF5W2ldID0gcm93c1tpXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICAvL3Ro5LiN5Y+C5LiO5o6S5bqPDQogICAgICAgICAgICBmbGFnICYmIHRyQXJyYXkuc3BsaWNlKDAsIDEpOw0KICAgICAgICAgICAgdHJBcnJheSA9IHV0aWxzLnNvcnQodHJBcnJheSxmdW5jdGlvbiAodHIxLCB0cjIpIHsNCiAgICAgICAgICAgICAgICB2YXIgdHh0ID0gZnVuY3Rpb24obm9kZSl7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBub2RlLmlubmVyVGV4dHx8bm9kZS50ZXh0Q29udGVudDsNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIHJldHVybiBjb21wYXJlRm4gPyAodHlwZW9mIGNvbXBhcmVGbiA9PT0gIm51bWJlciIgPyBjb21wYXJlRm4gOiBjb21wYXJlRm4uY2FsbCh0aGlzLCB0cjEuY2VsbHNbc29ydEJ5Q2VsbEluZGV4XSwgdHIyLmNlbGxzW3NvcnRCeUNlbGxJbmRleF0pKSA6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlMSA9IHR4dCh0cjEuY2VsbHNbc29ydEJ5Q2VsbEluZGV4XSksDQogICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTIgPSB0eHQodHIyLmNlbGxzW3NvcnRCeUNlbGxJbmRleF0pOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUxLmxvY2FsZUNvbXBhcmUodmFsdWUyKTsNCiAgICAgICAgICAgICAgICB9KCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIHZhciBmcmFnbWVudCA9IHRhYmxlLm93bmVyRG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpOw0KICAgICAgICAgICAgZm9yICh2YXIgaiA9IDAsIGxlbiA9IHRyQXJyYXkubGVuZ3RoOyBqIDwgbGVuOyBqKyspIHsNCiAgICAgICAgICAgICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZCh0ckFycmF5W2pdKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZhciB0Ym9keSA9IHRhYmxlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0Ym9keSIpWzBdOw0KICAgICAgICAgICAgaWYoIWxhc3RSb3dJbmRleCl7DQogICAgICAgICAgICAgICAgdGJvZHkuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpOw0KICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgdGJvZHkuaW5zZXJ0QmVmb3JlKGZyYWdtZW50LHJvd3NbbGFzdFJvd0luZGV4LSByYW5nZS5lbmRSb3dJbmRleCArIHJhbmdlLmJlZ2luUm93SW5kZXggLSAxXSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgc2V0QmFja2dyb3VuZDpmdW5jdGlvbiAoY2VsbHMsIHZhbHVlKSB7DQogICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAic3RyaW5nIikgew0KICAgICAgICAgICAgICAgIHV0aWxzLmVhY2goY2VsbHMsIGZ1bmN0aW9uIChjZWxsKSB7DQogICAgICAgICAgICAgICAgICAgIGNlbGwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gdmFsdWU7DQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAib2JqZWN0Iikgew0KICAgICAgICAgICAgICAgIHZhbHVlID0gdXRpbHMuZXh0ZW5kKHsNCiAgICAgICAgICAgICAgICAgICAgcmVwZWF0OnRydWUsDQogICAgICAgICAgICAgICAgICAgIGNvbG9yTGlzdDpbIiNkZGQiLCAiI2ZmZiJdDQogICAgICAgICAgICAgICAgfSwgdmFsdWUpOw0KICAgICAgICAgICAgICAgIHZhciByb3dJbmRleCA9IHRoaXMuZ2V0Q2VsbEluZm8oY2VsbHNbMF0pLnJvd0luZGV4LA0KICAgICAgICAgICAgICAgICAgICBjb3VudCA9IDAsDQogICAgICAgICAgICAgICAgICAgIGNvbG9ycyA9IHZhbHVlLmNvbG9yTGlzdCwNCiAgICAgICAgICAgICAgICAgICAgZ2V0Q29sb3IgPSBmdW5jdGlvbiAobGlzdCwgaW5kZXgsIHJlcGVhdCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxpc3RbaW5kZXhdID8gbGlzdFtpbmRleF0gOiByZXBlYXQgPyBsaXN0W2luZGV4ICUgbGlzdC5sZW5ndGhdIDogIiI7DQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNlbGw7IGNlbGwgPSBjZWxsc1tpKytdOykgew0KICAgICAgICAgICAgICAgICAgICB2YXIgY2VsbEluZm8gPSB0aGlzLmdldENlbGxJbmZvKGNlbGwpOw0KICAgICAgICAgICAgICAgICAgICBjZWxsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGdldENvbG9yKGNvbG9ycywgKChyb3dJbmRleCArIGNvdW50KSA9PSBjZWxsSW5mby5yb3dJbmRleCkgPyBjb3VudCA6ICsrY291bnQsIHZhbHVlLnJlcGVhdCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICByZW1vdmVCYWNrZ3JvdW5kOmZ1bmN0aW9uIChjZWxscykgew0KICAgICAgICAgICAgdXRpbHMuZWFjaChjZWxscywgZnVuY3Rpb24gKGNlbGwpIHsNCiAgICAgICAgICAgICAgICBjZWxsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICIiOw0KICAgICAgICAgICAgfSkNCiAgICAgICAgfQ0KDQoNCiAgICB9Ow0KICAgIGZ1bmN0aW9uIHNob3dFcnJvcihlKSB7DQogICAgfQ0KfSkoKTsKLyoqDQogKiBDcmVhdGVkIHdpdGggSmV0QnJhaW5zIFBocFN0b3JtLg0KICogVXNlcjogdGFvcWlsaQ0KICogRGF0ZTogMTMtMi0yMA0KICogVGltZTog5LiL5Y2INjoyNQ0KICogVG8gY2hhbmdlIHRoaXMgdGVtcGxhdGUgdXNlIEZpbGUgfCBTZXR0aW5ncyB8IEZpbGUgVGVtcGxhdGVzLg0KICovDQo7DQooZnVuY3Rpb24gKCkgew0KICAgIHZhciBVVCA9IFVFLlVFVGFibGUsDQogICAgICAgIGdldFRhYmxlSXRlbXNCeVJhbmdlID0gZnVuY3Rpb24gKGVkaXRvcikgew0KICAgICAgICAgICAgcmV0dXJuIFVULmdldFRhYmxlSXRlbXNCeVJhbmdlKGVkaXRvcik7DQogICAgICAgIH0sDQogICAgICAgIGdldFVFVGFibGVCeVNlbGVjdGVkID0gZnVuY3Rpb24gKGVkaXRvcikgew0KICAgICAgICAgICAgcmV0dXJuIFVULmdldFVFVGFibGVCeVNlbGVjdGVkKGVkaXRvcikNCiAgICAgICAgfSwNCiAgICAgICAgZ2V0RGVmYXVsdFZhbHVlID0gZnVuY3Rpb24gKGVkaXRvciwgdGFibGUpIHsNCiAgICAgICAgICAgIHJldHVybiBVVC5nZXREZWZhdWx0VmFsdWUoZWRpdG9yLCB0YWJsZSk7DQogICAgICAgIH0sDQogICAgICAgIGdldFVFVGFibGUgPSBmdW5jdGlvbiAodGRPclRhYmxlKSB7DQogICAgICAgICAgICByZXR1cm4gVVQuZ2V0VUVUYWJsZSh0ZE9yVGFibGUpOw0KICAgICAgICB9Ow0KDQoNCiAgICBVRS5jb21tYW5kc1snaW5zZXJ0dGFibGUnXSA9IHsNCiAgICAgICAgcXVlcnlDb21tYW5kU3RhdGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHJldHVybiBnZXRUYWJsZUl0ZW1zQnlSYW5nZSh0aGlzKS50YWJsZSA/IC0xIDogMDsNCiAgICAgICAgfSwNCiAgICAgICAgZXhlY0NvbW1hbmQ6IGZ1bmN0aW9uIChjbWQsIG9wdCkgew0KICAgICAgICAgICAgZnVuY3Rpb24gY3JlYXRlVGFibGUob3B0LCB0ZFdpZHRoKSB7DQogICAgICAgICAgICAgICAgdmFyIGh0bWwgPSBbXSwNCiAgICAgICAgICAgICAgICAgICAgcm93c051bSA9IG9wdC5udW1Sb3dzLA0KICAgICAgICAgICAgICAgICAgICBjb2xzTnVtID0gb3B0Lm51bUNvbHM7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgciA9IDA7IHIgPCByb3dzTnVtOyByKyspIHsNCiAgICAgICAgICAgICAgICAgICAgaHRtbC5wdXNoKCc8dHI+Jyk7DQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGMgPSAwOyBjIDwgY29sc051bTsgYysrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBodG1sLnB1c2goJzx0ZCB3aWR0aD0iJyArIHRkV2lkdGggKyAnIiAgdkFsaWduPSInICsgb3B0LnRkdmFsaWduICsgJyIgPicgKyAoYnJvd3Nlci5pZSA/IGRvbVV0aWxzLmZpbGxDaGFyIDogJzxici8+JykgKyAnPC90ZD4nKQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGh0bWwucHVzaCgnPC90cj4nKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAvL+emgeatouaMh+WumnRhYmxlLXdpZHRoDQogICAgICAgICAgICAgICAgcmV0dXJuICc8dGFibGU+PHRib2R5PicgKyBodG1sLmpvaW4oJycpICsgJzwvdGJvZHk+PC90YWJsZT4nDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICghb3B0KSB7DQogICAgICAgICAgICAgICAgb3B0ID0gdXRpbHMuZXh0ZW5kKHt9LCB7DQogICAgICAgICAgICAgICAgICAgIG51bUNvbHM6IHRoaXMub3B0aW9ucy5kZWZhdWx0Q29scywNCiAgICAgICAgICAgICAgICAgICAgbnVtUm93czogdGhpcy5vcHRpb25zLmRlZmF1bHRSb3dzLA0KICAgICAgICAgICAgICAgICAgICB0ZHZhbGlnbjogdGhpcy5vcHRpb25zLnRkdmFsaWduDQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7DQogICAgICAgICAgICB2YXIgcmFuZ2UgPSB0aGlzLnNlbGVjdGlvbi5nZXRSYW5nZSgpLA0KICAgICAgICAgICAgICAgIHN0YXJ0ID0gcmFuZ2Uuc3RhcnRDb250YWluZXIsDQogICAgICAgICAgICAgICAgZmlyc3RQYXJlbnRCbG9jayA9IGRvbVV0aWxzLmZpbmRQYXJlbnQoc3RhcnQsIGZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBkb21VdGlscy5pc0Jsb2NrRWxtKG5vZGUpOw0KICAgICAgICAgICAgICAgIH0sIHRydWUpIHx8IG1lLmJvZHk7DQoNCiAgICAgICAgICAgIHZhciBkZWZhdWx0VmFsdWUgPSBnZXREZWZhdWx0VmFsdWUobWUpLA0KICAgICAgICAgICAgICAgIHRhYmxlV2lkdGggPSBmaXJzdFBhcmVudEJsb2NrLm9mZnNldFdpZHRoLA0KICAgICAgICAgICAgICAgIHRkV2lkdGggPSBNYXRoLmZsb29yKHRhYmxlV2lkdGggLyBvcHQubnVtQ29scyAtIGRlZmF1bHRWYWx1ZS50ZFBhZGRpbmcgKiAyIC0gZGVmYXVsdFZhbHVlLnRkQm9yZGVyKTsNCg0KICAgICAgICAgICAgLy90b2Rv5YW25LuW5bGe5oCnDQogICAgICAgICAgICAhb3B0LnRkdmFsaWduICYmIChvcHQudGR2YWxpZ24gPSBtZS5vcHRpb25zLnRkdmFsaWduKTsNCiAgICAgICAgICAgIG1lLmV4ZWNDb21tYW5kKCJpbnNlcnRodG1sIiwgY3JlYXRlVGFibGUob3B0LCB0ZFdpZHRoKSk7DQogICAgICAgIH0NCiAgICB9Ow0KDQogICAgVUUuY29tbWFuZHNbJ2luc2VydHBhcmFncmFwaGJlZm9yZXRhYmxlJ10gPSB7DQogICAgICAgIHF1ZXJ5Q29tbWFuZFN0YXRlOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICByZXR1cm4gZ2V0VGFibGVJdGVtc0J5UmFuZ2UodGhpcykuY2VsbCA/IDAgOiAtMTsNCiAgICAgICAgfSwNCiAgICAgICAgZXhlY0NvbW1hbmQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciB0YWJsZSA9IGdldFRhYmxlSXRlbXNCeVJhbmdlKHRoaXMpLnRhYmxlOw0KICAgICAgICAgICAgaWYgKHRhYmxlKSB7DQogICAgICAgICAgICAgICAgdmFyIHAgPSB0aGlzLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInAiKTsNCiAgICAgICAgICAgICAgICBwLmlubmVySFRNTCA9IGJyb3dzZXIuaWUgPyAnJm5ic3A7JyA6ICc8YnIgLz4nOw0KICAgICAgICAgICAgICAgIHRhYmxlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHAsIHRhYmxlKTsNCiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvbi5nZXRSYW5nZSgpLnNldFN0YXJ0KHAsIDApLnNldEN1cnNvcigpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfTsNCg0KICAgIFVFLmNvbW1hbmRzWydkZWxldGV0YWJsZSddID0gew0KICAgICAgICBxdWVyeUNvbW1hbmRTdGF0ZTogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIHJuZyA9IHRoaXMuc2VsZWN0aW9uLmdldFJhbmdlKCk7DQogICAgICAgICAgICByZXR1cm4gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShybmcuc3RhcnRDb250YWluZXIsICd0YWJsZScsIHRydWUpID8gMCA6IC0xOw0KICAgICAgICB9LA0KICAgICAgICBleGVjQ29tbWFuZDogZnVuY3Rpb24gKGNtZCwgdGFibGUpIHsNCiAgICAgICAgICAgIHZhciBybmcgPSB0aGlzLnNlbGVjdGlvbi5nZXRSYW5nZSgpOw0KICAgICAgICAgICAgdGFibGUgPSB0YWJsZSB8fCBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKHJuZy5zdGFydENvbnRhaW5lciwgJ3RhYmxlJywgdHJ1ZSk7DQogICAgICAgICAgICBpZiAodGFibGUpIHsNCiAgICAgICAgICAgICAgICB2YXIgbmV4dCA9IHRhYmxlLm5leHRTaWJsaW5nOw0KICAgICAgICAgICAgICAgIGlmICghbmV4dCkgew0KICAgICAgICAgICAgICAgICAgICBuZXh0ID0gZG9tVXRpbHMuY3JlYXRlRWxlbWVudCh0aGlzLmRvY3VtZW50LCAncCcsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICdpbm5lckhUTUwnOiBicm93c2VyLmllID8gZG9tVXRpbHMuZmlsbENoYXIgOiAnPGJyLz4nDQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB0YWJsZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShuZXh0LCB0YWJsZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZSh0YWJsZSk7DQogICAgICAgICAgICAgICAgcm5nID0gdGhpcy5zZWxlY3Rpb24uZ2V0UmFuZ2UoKTsNCiAgICAgICAgICAgICAgICBpZiAobmV4dC5ub2RlVHlwZSA9PSAzKSB7DQogICAgICAgICAgICAgICAgICAgIHJuZy5zZXRTdGFydEJlZm9yZShuZXh0KQ0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHJuZy5zZXRTdGFydChuZXh0LCAwKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBybmcuc2V0Q3Vyc29yKGZhbHNlLCB0cnVlKQ0KICAgICAgICAgICAgICAgIHRoaXMuZmlyZUV2ZW50KCJ0YWJsZWhhc2RlbGV0ZWQiKQ0KDQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KICAgIH07DQogICAgVUUuY29tbWFuZHNbJ2NlbGxhbGlnbiddID0gew0KICAgICAgICBxdWVyeUNvbW1hbmRTdGF0ZTogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgcmV0dXJuIGdldFNlbGVjdGVkQXJyKHRoaXMpLmxlbmd0aCA/IDAgOiAtMQ0KICAgICAgICB9LA0KICAgICAgICBleGVjQ29tbWFuZDogZnVuY3Rpb24gKGNtZCwgYWxpZ24pIHsNCiAgICAgICAgICAgIHZhciBzZWxlY3RlZFRkcyA9IGdldFNlbGVjdGVkQXJyKHRoaXMpOw0KICAgICAgICAgICAgaWYgKHNlbGVjdGVkVGRzLmxlbmd0aCkgew0KICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjaTsgY2kgPSBzZWxlY3RlZFRkc1tpKytdOykgew0KICAgICAgICAgICAgICAgICAgICBjaS5zZXRBdHRyaWJ1dGUoJ2FsaWduJywgYWxpZ24pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH07DQogICAgVUUuY29tbWFuZHNbJ2NlbGx2YWxpZ24nXSA9IHsNCiAgICAgICAgcXVlcnlDb21tYW5kU3RhdGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHJldHVybiBnZXRTZWxlY3RlZEFycih0aGlzKS5sZW5ndGggPyAwIDogLTE7DQogICAgICAgIH0sDQogICAgICAgIGV4ZWNDb21tYW5kOiBmdW5jdGlvbiAoY21kLCB2YWxpZ24pIHsNCiAgICAgICAgICAgIHZhciBzZWxlY3RlZFRkcyA9IGdldFNlbGVjdGVkQXJyKHRoaXMpOw0KICAgICAgICAgICAgaWYgKHNlbGVjdGVkVGRzLmxlbmd0aCkgew0KICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjaTsgY2kgPSBzZWxlY3RlZFRkc1tpKytdOykgew0KICAgICAgICAgICAgICAgICAgICBjaS5zZXRBdHRyaWJ1dGUoJ3ZBbGlnbicsIHZhbGlnbik7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfTsNCiAgICBVRS5jb21tYW5kc1snaW5zZXJ0Y2FwdGlvbiddID0gew0KICAgICAgICBxdWVyeUNvbW1hbmRTdGF0ZTogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIHRhYmxlID0gZ2V0VGFibGVJdGVtc0J5UmFuZ2UodGhpcykudGFibGU7DQogICAgICAgICAgICBpZiAodGFibGUpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGFibGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2NhcHRpb24nKS5sZW5ndGggPT0gMCA/IDEgOiAtMTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgfSwNCiAgICAgICAgZXhlY0NvbW1hbmQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciB0YWJsZSA9IGdldFRhYmxlSXRlbXNCeVJhbmdlKHRoaXMpLnRhYmxlOw0KICAgICAgICAgICAgaWYgKHRhYmxlKSB7DQogICAgICAgICAgICAgICAgdmFyIGNhcHRpb24gPSB0aGlzLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhcHRpb24nKTsNCiAgICAgICAgICAgICAgICBjYXB0aW9uLmlubmVySFRNTCA9IGJyb3dzZXIuaWUgPyBkb21VdGlscy5maWxsQ2hhciA6ICc8YnIvPic7DQogICAgICAgICAgICAgICAgdGFibGUuaW5zZXJ0QmVmb3JlKGNhcHRpb24sIHRhYmxlLmZpcnN0Q2hpbGQpOw0KICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IHRoaXMuc2VsZWN0aW9uLmdldFJhbmdlKCk7DQogICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQoY2FwdGlvbiwgMCkuc2V0Q3Vyc29yKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KICAgIH07DQogICAgVUUuY29tbWFuZHNbJ2RlbGV0ZWNhcHRpb24nXSA9IHsNCiAgICAgICAgcXVlcnlDb21tYW5kU3RhdGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBybmcgPSB0aGlzLnNlbGVjdGlvbi5nZXRSYW5nZSgpLA0KICAgICAgICAgICAgICAgIHRhYmxlID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShybmcuc3RhcnRDb250YWluZXIsICd0YWJsZScpOw0KICAgICAgICAgICAgaWYgKHRhYmxlKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRhYmxlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdjYXB0aW9uJykubGVuZ3RoID09IDAgPyAtMSA6IDE7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gLTE7DQogICAgICAgIH0sDQogICAgICAgIGV4ZWNDb21tYW5kOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgcm5nID0gdGhpcy5zZWxlY3Rpb24uZ2V0UmFuZ2UoKSwNCiAgICAgICAgICAgICAgICB0YWJsZSA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUocm5nLnN0YXJ0Q29udGFpbmVyLCAndGFibGUnKTsNCiAgICAgICAgICAgIGlmICh0YWJsZSkgew0KICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZSh0YWJsZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnY2FwdGlvbicpWzBdKTsNCiAgICAgICAgICAgICAgICB2YXIgcmFuZ2UgPSB0aGlzLnNlbGVjdGlvbi5nZXRSYW5nZSgpOw0KICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KHRhYmxlLnJvd3NbMF0uY2VsbHNbMF0sIDApLnNldEN1cnNvcigpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0NCiAgICB9Ow0KICAgIFVFLmNvbW1hbmRzWydpbnNlcnR0aXRsZSddID0gew0KICAgICAgICBxdWVyeUNvbW1hbmRTdGF0ZTogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIHRhYmxlID0gZ2V0VGFibGVJdGVtc0J5UmFuZ2UodGhpcykudGFibGU7DQogICAgICAgICAgICBpZiAodGFibGUpIHsNCiAgICAgICAgICAgICAgICB2YXIgZmlyc3RSb3cgPSB0YWJsZS5yb3dzWzBdOw0KICAgICAgICAgICAgICAgIHJldHVybiBmaXJzdFJvdy5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGgnKS5sZW5ndGggPT0gMCA/IDAgOiAtMQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgICB9LA0KICAgICAgICBleGVjQ29tbWFuZDogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIHRhYmxlID0gZ2V0VGFibGVJdGVtc0J5UmFuZ2UodGhpcykudGFibGU7DQogICAgICAgICAgICBpZiAodGFibGUpIHsNCiAgICAgICAgICAgICAgICBnZXRVRVRhYmxlKHRhYmxlKS5pbnNlcnRSb3coMCwgJ3RoJyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB2YXIgdGggPSB0YWJsZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGgnKVswXTsNCiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uLmdldFJhbmdlKCkuc2V0U3RhcnQodGgsIDApLnNldEN1cnNvcihmYWxzZSwgdHJ1ZSk7DQogICAgICAgIH0NCiAgICB9Ow0KICAgIFVFLmNvbW1hbmRzWydkZWxldGV0aXRsZSddID0gew0KICAgICAgICBxdWVyeUNvbW1hbmRTdGF0ZTogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIHRhYmxlID0gZ2V0VGFibGVJdGVtc0J5UmFuZ2UodGhpcykudGFibGU7DQogICAgICAgICAgICBpZiAodGFibGUpIHsNCiAgICAgICAgICAgICAgICB2YXIgZmlyc3RSb3cgPSB0YWJsZS5yb3dzWzBdOw0KICAgICAgICAgICAgICAgIHJldHVybiBmaXJzdFJvdy5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGgnKS5sZW5ndGggPyAwIDogLTENCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgfSwNCiAgICAgICAgZXhlY0NvbW1hbmQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciB0YWJsZSA9IGdldFRhYmxlSXRlbXNCeVJhbmdlKHRoaXMpLnRhYmxlOw0KICAgICAgICAgICAgaWYgKHRhYmxlKSB7DQogICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHRhYmxlLnJvd3NbMF0pDQogICAgICAgICAgICB9DQogICAgICAgICAgICB2YXIgdGQgPSB0YWJsZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGQnKVswXTsNCiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uLmdldFJhbmdlKCkuc2V0U3RhcnQodGQsIDApLnNldEN1cnNvcihmYWxzZSwgdHJ1ZSk7DQogICAgICAgIH0NCiAgICB9Ow0KDQogICAgVUUuY29tbWFuZHNbIm1lcmdlcmlnaHQiXSA9IHsNCiAgICAgICAgcXVlcnlDb21tYW5kU3RhdGU6IGZ1bmN0aW9uIChjbWQpIHsNCiAgICAgICAgICAgIHZhciB0YWJsZUl0ZW1zID0gZ2V0VGFibGVJdGVtc0J5UmFuZ2UodGhpcyk7DQogICAgICAgICAgICBpZiAoIXRhYmxlSXRlbXMuY2VsbCkgcmV0dXJuIC0xOw0KICAgICAgICAgICAgdmFyIHV0ID0gZ2V0VUVUYWJsZSh0YWJsZUl0ZW1zLnRhYmxlKTsNCiAgICAgICAgICAgIGlmICh1dC5zZWxlY3RlZFRkcy5sZW5ndGgpIHJldHVybiAtMTsNCiAgICAgICAgICAgIHZhciBjZWxsSW5mbyA9IHV0LmdldENlbGxJbmZvKHRhYmxlSXRlbXMuY2VsbCksDQogICAgICAgICAgICAgICAgcmlnaHRDb2xJbmRleCA9IGNlbGxJbmZvLmNvbEluZGV4ICsgY2VsbEluZm8uY29sU3BhbjsNCiAgICAgICAgICAgIGlmIChyaWdodENvbEluZGV4ID49IHV0LmNvbHNOdW0pIHJldHVybiAtMTsNCiAgICAgICAgICAgIHZhciByaWdodENlbGxJbmZvID0gdXQuaW5kZXhUYWJsZVtjZWxsSW5mby5yb3dJbmRleF1bcmlnaHRDb2xJbmRleF07DQogICAgICAgICAgICByZXR1cm4gKHJpZ2h0Q2VsbEluZm8ucm93SW5kZXggPT0gY2VsbEluZm8ucm93SW5kZXgNCiAgICAgICAgICAgICAgICAmJiByaWdodENlbGxJbmZvLnJvd1NwYW4gPT0gY2VsbEluZm8ucm93U3BhbikgPyAwIDogLTE7DQogICAgICAgIH0sDQogICAgICAgIGV4ZWNDb21tYW5kOiBmdW5jdGlvbiAoY21kKSB7DQogICAgICAgICAgICB2YXIgcm5nID0gdGhpcy5zZWxlY3Rpb24uZ2V0UmFuZ2UoKSwNCiAgICAgICAgICAgICAgICBiayA9IHJuZy5jcmVhdGVCb29rbWFyayh0cnVlKTsNCiAgICAgICAgICAgIHZhciBjZWxsID0gZ2V0VGFibGVJdGVtc0J5UmFuZ2UodGhpcykuY2VsbCwNCiAgICAgICAgICAgICAgICB1dCA9IGdldFVFVGFibGUoY2VsbCk7DQogICAgICAgICAgICB1dC5tZXJnZVJpZ2h0KGNlbGwpOw0KICAgICAgICAgICAgcm5nLm1vdmVUb0Jvb2ttYXJrKGJrKS5zZWxlY3QoKTsNCiAgICAgICAgfQ0KICAgIH07DQogICAgVUUuY29tbWFuZHNbIm1lcmdlZG93biJdID0gew0KICAgICAgICBxdWVyeUNvbW1hbmRTdGF0ZTogZnVuY3Rpb24gKGNtZCkgew0KICAgICAgICAgICAgdmFyIHRhYmxlSXRlbXMgPSBnZXRUYWJsZUl0ZW1zQnlSYW5nZSh0aGlzKSwNCiAgICAgICAgICAgICAgICBjZWxsID0gdGFibGVJdGVtcy5jZWxsOw0KICAgICAgICAgICAgaWYgKCFjZWxsIHx8IGNlbGwudGFnTmFtZSA9PSAiVEgiKSByZXR1cm4gLTE7DQogICAgICAgICAgICB2YXIgdXQgPSBnZXRVRVRhYmxlKHRhYmxlSXRlbXMudGFibGUpOw0KICAgICAgICAgICAgaWYgKHV0LnNlbGVjdGVkVGRzLmxlbmd0aClyZXR1cm4gLTE7DQogICAgICAgICAgICB2YXIgY2VsbEluZm8gPSB1dC5nZXRDZWxsSW5mbyh0YWJsZUl0ZW1zLmNlbGwpLA0KICAgICAgICAgICAgICAgIGRvd25Sb3dJbmRleCA9IGNlbGxJbmZvLnJvd0luZGV4ICsgY2VsbEluZm8ucm93U3BhbjsNCiAgICAgICAgICAgIC8vIOWmguaenOWkhOS6juacgOS4i+i+ueWImeS4jeiDvWblkJHlj7PlkIjlubYNCiAgICAgICAgICAgIGlmIChkb3duUm93SW5kZXggPj0gdXQucm93c051bSkgcmV0dXJuIC0xOw0KICAgICAgICAgICAgdmFyIGRvd25DZWxsSW5mbyA9IHV0LmluZGV4VGFibGVbZG93blJvd0luZGV4XVtjZWxsSW5mby5jb2xJbmRleF07DQogICAgICAgICAgICAvLyDlvZPkuJTku4XlvZPkuKTkuKpDZWxs55qE5byA5aeL5YiX5Y+35ZKM57uT5p2f5YiX5Y+35LiA6Ie05pe26IO96L+b6KGM5ZCI5bm2DQogICAgICAgICAgICByZXR1cm4gKGRvd25DZWxsSW5mby5jb2xJbmRleCA9PSBjZWxsSW5mby5jb2xJbmRleA0KICAgICAgICAgICAgICAgICYmIGRvd25DZWxsSW5mby5jb2xTcGFuID09IGNlbGxJbmZvLmNvbFNwYW4pICYmIHRhYmxlSXRlbXMuY2VsbC50YWdOYW1lICE9PSAnVEgnID8gMCA6IC0xOw0KICAgICAgICB9LA0KICAgICAgICBleGVjQ29tbWFuZDogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIHJuZyA9IHRoaXMuc2VsZWN0aW9uLmdldFJhbmdlKCksDQogICAgICAgICAgICAgICAgYmsgPSBybmcuY3JlYXRlQm9va21hcmsodHJ1ZSk7DQogICAgICAgICAgICB2YXIgY2VsbCA9IGdldFRhYmxlSXRlbXNCeVJhbmdlKHRoaXMpLmNlbGwsDQogICAgICAgICAgICAgICAgdXQgPSBnZXRVRVRhYmxlKGNlbGwpOw0KICAgICAgICAgICAgdXQubWVyZ2VEb3duKGNlbGwpOw0KICAgICAgICAgICAgcm5nLm1vdmVUb0Jvb2ttYXJrKGJrKS5zZWxlY3QoKTsNCiAgICAgICAgfQ0KICAgIH07DQogICAgVUUuY29tbWFuZHNbIm1lcmdlY2VsbHMiXSA9IHsNCiAgICAgICAgcXVlcnlDb21tYW5kU3RhdGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHJldHVybiBnZXRVRVRhYmxlQnlTZWxlY3RlZCh0aGlzKSA/IDAgOiAtMTsNCiAgICAgICAgfSwNCiAgICAgICAgZXhlY0NvbW1hbmQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciB1dCA9IGdldFVFVGFibGVCeVNlbGVjdGVkKHRoaXMpOw0KICAgICAgICAgICAgaWYgKHV0ICYmIHV0LnNlbGVjdGVkVGRzLmxlbmd0aCkgew0KICAgICAgICAgICAgICAgIHZhciBjZWxsID0gdXQuc2VsZWN0ZWRUZHNbMF07DQogICAgICAgICAgICAgICAgdXQubWVyZ2VSYW5nZSgpOw0KICAgICAgICAgICAgICAgIHZhciBybmcgPSB0aGlzLnNlbGVjdGlvbi5nZXRSYW5nZSgpOw0KICAgICAgICAgICAgICAgIGlmIChkb21VdGlscy5pc0VtcHR5QmxvY2soY2VsbCkpIHsNCiAgICAgICAgICAgICAgICAgICAgcm5nLnNldFN0YXJ0KGNlbGwsIDApLmNvbGxhcHNlKHRydWUpDQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgcm5nLnNlbGVjdE5vZGVDb250ZW50cyhjZWxsKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBybmcuc2VsZWN0KCk7DQogICAgICAgICAgICB9DQoNCg0KICAgICAgICB9DQogICAgfTsNCiAgICBVRS5jb21tYW5kc1siaW5zZXJ0cm93Il0gPSB7DQogICAgICAgIHF1ZXJ5Q29tbWFuZFN0YXRlOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgdGFibGVJdGVtcyA9IGdldFRhYmxlSXRlbXNCeVJhbmdlKHRoaXMpLA0KICAgICAgICAgICAgICAgIGNlbGwgPSB0YWJsZUl0ZW1zLmNlbGw7DQogICAgICAgICAgICByZXR1cm4gY2VsbCAmJiBjZWxsLnRhZ05hbWUgPT0gIlREIiAmJiBnZXRVRVRhYmxlKHRhYmxlSXRlbXMudGFibGUpLnJvd3NOdW0gPCB0aGlzLm9wdGlvbnMubWF4Um93TnVtID8gMCA6IC0xOw0KICAgICAgICB9LA0KICAgICAgICBleGVjQ29tbWFuZDogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIHJuZyA9IHRoaXMuc2VsZWN0aW9uLmdldFJhbmdlKCksDQogICAgICAgICAgICAgICAgYmsgPSBybmcuY3JlYXRlQm9va21hcmsodHJ1ZSk7DQogICAgICAgICAgICB2YXIgdGFibGVJdGVtcyA9IGdldFRhYmxlSXRlbXNCeVJhbmdlKHRoaXMpLA0KICAgICAgICAgICAgICAgIGNlbGwgPSB0YWJsZUl0ZW1zLmNlbGwsDQogICAgICAgICAgICAgICAgdGFibGUgPSB0YWJsZUl0ZW1zLnRhYmxlLA0KICAgICAgICAgICAgICAgIHV0ID0gZ2V0VUVUYWJsZSh0YWJsZSksDQogICAgICAgICAgICAgICAgY2VsbEluZm8gPSB1dC5nZXRDZWxsSW5mbyhjZWxsKTsNCiAgICAgICAgICAgIC8vdXQuaW5zZXJ0Um93KCF1dC5zZWxlY3RlZFRkcy5sZW5ndGggPyBjZWxsSW5mby5yb3dJbmRleDp1dC5jZWxsc1JhbmdlLmJlZ2luUm93SW5kZXgsJycpOw0KICAgICAgICAgICAgaWYgKCF1dC5zZWxlY3RlZFRkcy5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICB1dC5pbnNlcnRSb3coY2VsbEluZm8ucm93SW5kZXgsIGNlbGwpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB2YXIgcmFuZ2UgPSB1dC5jZWxsc1JhbmdlOw0KICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSByYW5nZS5lbmRSb3dJbmRleCAtIHJhbmdlLmJlZ2luUm93SW5kZXggKyAxOyBpIDwgbGVuOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgdXQuaW5zZXJ0Um93KHJhbmdlLmJlZ2luUm93SW5kZXgsIGNlbGwpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJuZy5tb3ZlVG9Cb29rbWFyayhiaykuc2VsZWN0KCk7DQogICAgICAgICAgICBpZiAodGFibGUuZ2V0QXR0cmlidXRlKCJpbnRlcmxhY2VkIikgPT09ICJlbmFibGVkIil0aGlzLmZpcmVFdmVudCgiaW50ZXJsYWNldGFibGUiLCB0YWJsZSk7DQogICAgICAgIH0NCiAgICB9Ow0KICAgIC8v5ZCO5o+S5YWl6KGMDQogICAgVUUuY29tbWFuZHNbImluc2VydHJvd25leHQiXSA9IHsNCiAgICAgICAgcXVlcnlDb21tYW5kU3RhdGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciB0YWJsZUl0ZW1zID0gZ2V0VGFibGVJdGVtc0J5UmFuZ2UodGhpcyksDQogICAgICAgICAgICAgICAgY2VsbCA9IHRhYmxlSXRlbXMuY2VsbDsNCiAgICAgICAgICAgIHJldHVybiBjZWxsICYmIChjZWxsLnRhZ05hbWUgPT0gIlREIikgJiYgZ2V0VUVUYWJsZSh0YWJsZUl0ZW1zLnRhYmxlKS5yb3dzTnVtIDwgdGhpcy5vcHRpb25zLm1heFJvd051bSA/IDAgOiAtMTsNCiAgICAgICAgfSwNCiAgICAgICAgZXhlY0NvbW1hbmQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBybmcgPSB0aGlzLnNlbGVjdGlvbi5nZXRSYW5nZSgpLA0KICAgICAgICAgICAgICAgIGJrID0gcm5nLmNyZWF0ZUJvb2ttYXJrKHRydWUpOw0KICAgICAgICAgICAgdmFyIHRhYmxlSXRlbXMgPSBnZXRUYWJsZUl0ZW1zQnlSYW5nZSh0aGlzKSwNCiAgICAgICAgICAgICAgICBjZWxsID0gdGFibGVJdGVtcy5jZWxsLA0KICAgICAgICAgICAgICAgIHRhYmxlID0gdGFibGVJdGVtcy50YWJsZSwNCiAgICAgICAgICAgICAgICB1dCA9IGdldFVFVGFibGUodGFibGUpLA0KICAgICAgICAgICAgICAgIGNlbGxJbmZvID0gdXQuZ2V0Q2VsbEluZm8oY2VsbCk7DQogICAgICAgICAgICAvL3V0Lmluc2VydFJvdyghdXQuc2VsZWN0ZWRUZHMubGVuZ3RoPyBjZWxsSW5mby5yb3dJbmRleCArIGNlbGxJbmZvLnJvd1NwYW4gOiB1dC5jZWxsc1JhbmdlLmVuZFJvd0luZGV4ICsgMSwnJyk7DQogICAgICAgICAgICBpZiAoIXV0LnNlbGVjdGVkVGRzLmxlbmd0aCkgew0KICAgICAgICAgICAgICAgIHV0Lmluc2VydFJvdyhjZWxsSW5mby5yb3dJbmRleCArIGNlbGxJbmZvLnJvd1NwYW4sIGNlbGwpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB2YXIgcmFuZ2UgPSB1dC5jZWxsc1JhbmdlOw0KICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSByYW5nZS5lbmRSb3dJbmRleCAtIHJhbmdlLmJlZ2luUm93SW5kZXggKyAxOyBpIDwgbGVuOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgdXQuaW5zZXJ0Um93KHJhbmdlLmVuZFJvd0luZGV4ICsgMSwgY2VsbCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcm5nLm1vdmVUb0Jvb2ttYXJrKGJrKS5zZWxlY3QoKTsNCiAgICAgICAgICAgIGlmICh0YWJsZS5nZXRBdHRyaWJ1dGUoImludGVybGFjZWQiKSA9PT0gImVuYWJsZWQiKXRoaXMuZmlyZUV2ZW50KCJpbnRlcmxhY2V0YWJsZSIsIHRhYmxlKTsNCiAgICAgICAgfQ0KICAgIH07DQogICAgVUUuY29tbWFuZHNbImRlbGV0ZXJvdyJdID0gew0KICAgICAgICBxdWVyeUNvbW1hbmRTdGF0ZTogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIHRhYmxlSXRlbXMgPSBnZXRUYWJsZUl0ZW1zQnlSYW5nZSh0aGlzKTsNCiAgICAgICAgICAgIGlmICghdGFibGVJdGVtcy5jZWxsKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBleGVjQ29tbWFuZDogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIGNlbGwgPSBnZXRUYWJsZUl0ZW1zQnlSYW5nZSh0aGlzKS5jZWxsLA0KICAgICAgICAgICAgICAgIHV0ID0gZ2V0VUVUYWJsZShjZWxsKSwNCiAgICAgICAgICAgICAgICBjZWxsc1JhbmdlID0gdXQuY2VsbHNSYW5nZSwNCiAgICAgICAgICAgICAgICBjZWxsSW5mbyA9IHV0LmdldENlbGxJbmZvKGNlbGwpLA0KICAgICAgICAgICAgICAgIHByZUNlbGwgPSB1dC5nZXRWU2lkZUNlbGwoY2VsbCksDQogICAgICAgICAgICAgICAgbmV4dENlbGwgPSB1dC5nZXRWU2lkZUNlbGwoY2VsbCwgdHJ1ZSksDQogICAgICAgICAgICAgICAgcm5nID0gdGhpcy5zZWxlY3Rpb24uZ2V0UmFuZ2UoKTsNCiAgICAgICAgICAgIGlmICh1dGlscy5pc0VtcHR5T2JqZWN0KGNlbGxzUmFuZ2UpKSB7DQogICAgICAgICAgICAgICAgdXQuZGVsZXRlUm93KGNlbGxJbmZvLnJvd0luZGV4KTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IGNlbGxzUmFuZ2UuYmVnaW5Sb3dJbmRleDsgaSA8IGNlbGxzUmFuZ2UuZW5kUm93SW5kZXggKyAxOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgdXQuZGVsZXRlUm93KGNlbGxzUmFuZ2UuYmVnaW5Sb3dJbmRleCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdmFyIHRhYmxlID0gdXQudGFibGU7DQogICAgICAgICAgICBpZiAoIXRhYmxlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0ZCcpLmxlbmd0aCkgew0KICAgICAgICAgICAgICAgIHZhciBuZXh0U2libGluZyA9IHRhYmxlLm5leHRTaWJsaW5nOw0KICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZSh0YWJsZSk7DQogICAgICAgICAgICAgICAgaWYgKG5leHRTaWJsaW5nKSB7DQogICAgICAgICAgICAgICAgICAgIHJuZy5zZXRTdGFydChuZXh0U2libGluZywgMCkuc2V0Q3Vyc29yKGZhbHNlLCB0cnVlKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGlmIChjZWxsSW5mby5yb3dTcGFuID09IDEgfHwgY2VsbEluZm8ucm93U3BhbiA9PSBjZWxsc1JhbmdlLmVuZFJvd0luZGV4IC0gY2VsbHNSYW5nZS5iZWdpblJvd0luZGV4ICsgMSkgew0KICAgICAgICAgICAgICAgICAgICBpZiAobmV4dENlbGwgfHwgcHJlQ2VsbCkgcm5nLnNlbGVjdE5vZGVDb250ZW50cyhuZXh0Q2VsbCB8fCBwcmVDZWxsKS5zZXRDdXJzb3IoZmFsc2UsIHRydWUpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBuZXdDZWxsID0gdXQuZ2V0Q2VsbChjZWxsSW5mby5yb3dJbmRleCwgdXQuaW5kZXhUYWJsZVtjZWxsSW5mby5yb3dJbmRleF1bY2VsbEluZm8uY29sSW5kZXhdLmNlbGxJbmRleCk7DQogICAgICAgICAgICAgICAgICAgIGlmIChuZXdDZWxsKSBybmcuc2VsZWN0Tm9kZUNvbnRlbnRzKG5ld0NlbGwpLnNldEN1cnNvcihmYWxzZSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKHRhYmxlLmdldEF0dHJpYnV0ZSgiaW50ZXJsYWNlZCIpID09PSAiZW5hYmxlZCIpdGhpcy5maXJlRXZlbnQoImludGVybGFjZXRhYmxlIiwgdGFibGUpOw0KICAgICAgICB9DQogICAgfTsNCiAgICBVRS5jb21tYW5kc1siaW5zZXJ0Y29sIl0gPSB7DQogICAgICAgIHF1ZXJ5Q29tbWFuZFN0YXRlOiBmdW5jdGlvbiAoY21kKSB7DQogICAgICAgICAgICB2YXIgdGFibGVJdGVtcyA9IGdldFRhYmxlSXRlbXNCeVJhbmdlKHRoaXMpLA0KICAgICAgICAgICAgICAgIGNlbGwgPSB0YWJsZUl0ZW1zLmNlbGw7DQogICAgICAgICAgICByZXR1cm4gY2VsbCAmJiAoY2VsbC50YWdOYW1lID09ICJURCIgfHwgY2VsbC50YWdOYW1lID09ICdUSCcpICYmIGdldFVFVGFibGUodGFibGVJdGVtcy50YWJsZSkuY29sc051bSA8IHRoaXMub3B0aW9ucy5tYXhDb2xOdW0gPyAwIDogLTE7DQogICAgICAgIH0sDQogICAgICAgIGV4ZWNDb21tYW5kOiBmdW5jdGlvbiAoY21kKSB7DQogICAgICAgICAgICB2YXIgcm5nID0gdGhpcy5zZWxlY3Rpb24uZ2V0UmFuZ2UoKSwNCiAgICAgICAgICAgICAgICBiayA9IHJuZy5jcmVhdGVCb29rbWFyayh0cnVlKTsNCiAgICAgICAgICAgIGlmICh0aGlzLnF1ZXJ5Q29tbWFuZFN0YXRlKGNtZCkgPT0gLTEpcmV0dXJuOw0KICAgICAgICAgICAgdmFyIGNlbGwgPSBnZXRUYWJsZUl0ZW1zQnlSYW5nZSh0aGlzKS5jZWxsLA0KICAgICAgICAgICAgICAgIHV0ID0gZ2V0VUVUYWJsZShjZWxsKSwNCiAgICAgICAgICAgICAgICBjZWxsSW5mbyA9IHV0LmdldENlbGxJbmZvKGNlbGwpOw0KDQogICAgICAgICAgICAvL3V0Lmluc2VydENvbCghdXQuc2VsZWN0ZWRUZHMubGVuZ3RoID8gY2VsbEluZm8uY29sSW5kZXg6dXQuY2VsbHNSYW5nZS5iZWdpbkNvbEluZGV4KTsNCiAgICAgICAgICAgIGlmICghdXQuc2VsZWN0ZWRUZHMubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgdXQuaW5zZXJ0Q29sKGNlbGxJbmZvLmNvbEluZGV4LCBjZWxsKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gdXQuY2VsbHNSYW5nZTsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gcmFuZ2UuZW5kQ29sSW5kZXggLSByYW5nZS5iZWdpbkNvbEluZGV4ICsgMTsgaSA8IGxlbjsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgIHV0Lmluc2VydENvbChyYW5nZS5iZWdpbkNvbEluZGV4LCBjZWxsKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBybmcubW92ZVRvQm9va21hcmsoYmspLnNlbGVjdCh0cnVlKTsNCiAgICAgICAgfQ0KICAgIH07DQogICAgVUUuY29tbWFuZHNbImluc2VydGNvbG5leHQiXSA9IHsNCiAgICAgICAgcXVlcnlDb21tYW5kU3RhdGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciB0YWJsZUl0ZW1zID0gZ2V0VGFibGVJdGVtc0J5UmFuZ2UodGhpcyksDQogICAgICAgICAgICAgICAgY2VsbCA9IHRhYmxlSXRlbXMuY2VsbDsNCiAgICAgICAgICAgIHJldHVybiBjZWxsICYmIGdldFVFVGFibGUodGFibGVJdGVtcy50YWJsZSkuY29sc051bSA8IHRoaXMub3B0aW9ucy5tYXhDb2xOdW0gPyAwIDogLTE7DQogICAgICAgIH0sDQogICAgICAgIGV4ZWNDb21tYW5kOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgcm5nID0gdGhpcy5zZWxlY3Rpb24uZ2V0UmFuZ2UoKSwNCiAgICAgICAgICAgICAgICBiayA9IHJuZy5jcmVhdGVCb29rbWFyayh0cnVlKTsNCiAgICAgICAgICAgIHZhciBjZWxsID0gZ2V0VGFibGVJdGVtc0J5UmFuZ2UodGhpcykuY2VsbCwNCiAgICAgICAgICAgICAgICB1dCA9IGdldFVFVGFibGUoY2VsbCksDQogICAgICAgICAgICAgICAgY2VsbEluZm8gPSB1dC5nZXRDZWxsSW5mbyhjZWxsKTsNCiAgICAgICAgICAgIC8vdXQuaW5zZXJ0Q29sKCF1dC5zZWxlY3RlZFRkcy5sZW5ndGggPyBjZWxsSW5mby5jb2xJbmRleCArIGNlbGxJbmZvLmNvbFNwYW46dXQuY2VsbHNSYW5nZS5lbmRDb2xJbmRleCArMSk7DQogICAgICAgICAgICBpZiAoIXV0LnNlbGVjdGVkVGRzLmxlbmd0aCkgew0KICAgICAgICAgICAgICAgIHV0Lmluc2VydENvbChjZWxsSW5mby5jb2xJbmRleCArIGNlbGxJbmZvLmNvbFNwYW4sIGNlbGwpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB2YXIgcmFuZ2UgPSB1dC5jZWxsc1JhbmdlOw0KICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSByYW5nZS5lbmRDb2xJbmRleCAtIHJhbmdlLmJlZ2luQ29sSW5kZXggKyAxOyBpIDwgbGVuOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgdXQuaW5zZXJ0Q29sKHJhbmdlLmVuZENvbEluZGV4ICsgMSwgY2VsbCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcm5nLm1vdmVUb0Jvb2ttYXJrKGJrKS5zZWxlY3QoKTsNCiAgICAgICAgfQ0KICAgIH07DQoNCiAgICBVRS5jb21tYW5kc1siZGVsZXRlY29sIl0gPSB7DQogICAgICAgIHF1ZXJ5Q29tbWFuZFN0YXRlOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgdGFibGVJdGVtcyA9IGdldFRhYmxlSXRlbXNCeVJhbmdlKHRoaXMpOw0KICAgICAgICAgICAgaWYgKCF0YWJsZUl0ZW1zLmNlbGwpIHJldHVybiAtMTsNCiAgICAgICAgfSwNCiAgICAgICAgZXhlY0NvbW1hbmQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBjZWxsID0gZ2V0VGFibGVJdGVtc0J5UmFuZ2UodGhpcykuY2VsbCwNCiAgICAgICAgICAgICAgICB1dCA9IGdldFVFVGFibGUoY2VsbCksDQogICAgICAgICAgICAgICAgcmFuZ2UgPSB1dC5jZWxsc1JhbmdlLA0KICAgICAgICAgICAgICAgIGNlbGxJbmZvID0gdXQuZ2V0Q2VsbEluZm8oY2VsbCksDQogICAgICAgICAgICAgICAgcHJlQ2VsbCA9IHV0LmdldEhTaWRlQ2VsbChjZWxsKSwNCiAgICAgICAgICAgICAgICBuZXh0Q2VsbCA9IHV0LmdldEhTaWRlQ2VsbChjZWxsLCB0cnVlKTsNCiAgICAgICAgICAgIGlmICh1dGlscy5pc0VtcHR5T2JqZWN0KHJhbmdlKSkgew0KICAgICAgICAgICAgICAgIHV0LmRlbGV0ZUNvbChjZWxsSW5mby5jb2xJbmRleCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSByYW5nZS5iZWdpbkNvbEluZGV4OyBpIDwgcmFuZ2UuZW5kQ29sSW5kZXggKyAxOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgdXQuZGVsZXRlQ29sKHJhbmdlLmJlZ2luQ29sSW5kZXgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZhciB0YWJsZSA9IHV0LnRhYmxlLA0KICAgICAgICAgICAgICAgIHJuZyA9IHRoaXMuc2VsZWN0aW9uLmdldFJhbmdlKCk7DQoNCiAgICAgICAgICAgIGlmICghdGFibGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RkJykubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgdmFyIG5leHRTaWJsaW5nID0gdGFibGUubmV4dFNpYmxpbmc7DQogICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHRhYmxlKTsNCiAgICAgICAgICAgICAgICBpZiAobmV4dFNpYmxpbmcpIHsNCiAgICAgICAgICAgICAgICAgICAgcm5nLnNldFN0YXJ0KG5leHRTaWJsaW5nLCAwKS5zZXRDdXJzb3IoZmFsc2UsIHRydWUpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgaWYgKGRvbVV0aWxzLmluRG9jKGNlbGwsIHRoaXMuZG9jdW1lbnQpKSB7DQogICAgICAgICAgICAgICAgICAgIHJuZy5zZXRTdGFydChjZWxsLCAwKS5zZXRDdXJzb3IoZmFsc2UsIHRydWUpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChuZXh0Q2VsbCAmJiBkb21VdGlscy5pbkRvYyhuZXh0Q2VsbCwgdGhpcy5kb2N1bWVudCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJuZy5zZWxlY3ROb2RlQ29udGVudHMobmV4dENlbGwpLnNldEN1cnNvcihmYWxzZSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJlQ2VsbCAmJiBkb21VdGlscy5pbkRvYyhwcmVDZWxsLCB0aGlzLmRvY3VtZW50KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJuZy5zZWxlY3ROb2RlQ29udGVudHMocHJlQ2VsbCkuc2V0Q3Vyc29yKHRydWUsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfTsNCiAgICBVRS5jb21tYW5kc1sic3BsaXR0b2NlbGxzIl0gPSB7DQogICAgICAgIHF1ZXJ5Q29tbWFuZFN0YXRlOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgdGFibGVJdGVtcyA9IGdldFRhYmxlSXRlbXNCeVJhbmdlKHRoaXMpLA0KICAgICAgICAgICAgICAgIGNlbGwgPSB0YWJsZUl0ZW1zLmNlbGw7DQogICAgICAgICAgICBpZiAoIWNlbGwpIHJldHVybiAtMTsNCiAgICAgICAgICAgIHZhciB1dCA9IGdldFVFVGFibGUodGFibGVJdGVtcy50YWJsZSk7DQogICAgICAgICAgICBpZiAodXQuc2VsZWN0ZWRUZHMubGVuZ3RoID4gMCkgcmV0dXJuIC0xOw0KICAgICAgICAgICAgcmV0dXJuIGNlbGwgJiYgKGNlbGwuY29sU3BhbiA+IDEgfHwgY2VsbC5yb3dTcGFuID4gMSkgPyAwIDogLTE7DQogICAgICAgIH0sDQogICAgICAgIGV4ZWNDb21tYW5kOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgcm5nID0gdGhpcy5zZWxlY3Rpb24uZ2V0UmFuZ2UoKSwNCiAgICAgICAgICAgICAgICBiayA9IHJuZy5jcmVhdGVCb29rbWFyayh0cnVlKTsNCiAgICAgICAgICAgIHZhciBjZWxsID0gZ2V0VGFibGVJdGVtc0J5UmFuZ2UodGhpcykuY2VsbCwNCiAgICAgICAgICAgICAgICB1dCA9IGdldFVFVGFibGUoY2VsbCk7DQogICAgICAgICAgICB1dC5zcGxpdFRvQ2VsbHMoY2VsbCk7DQogICAgICAgICAgICBybmcubW92ZVRvQm9va21hcmsoYmspLnNlbGVjdCgpOw0KICAgICAgICB9DQogICAgfTsNCiAgICBVRS5jb21tYW5kc1sic3BsaXR0b3Jvd3MiXSA9IHsNCiAgICAgICAgcXVlcnlDb21tYW5kU3RhdGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciB0YWJsZUl0ZW1zID0gZ2V0VGFibGVJdGVtc0J5UmFuZ2UodGhpcyksDQogICAgICAgICAgICAgICAgY2VsbCA9IHRhYmxlSXRlbXMuY2VsbDsNCiAgICAgICAgICAgIGlmICghY2VsbCkgcmV0dXJuIC0xOw0KICAgICAgICAgICAgdmFyIHV0ID0gZ2V0VUVUYWJsZSh0YWJsZUl0ZW1zLnRhYmxlKTsNCiAgICAgICAgICAgIGlmICh1dC5zZWxlY3RlZFRkcy5sZW5ndGggPiAwKSByZXR1cm4gLTE7DQogICAgICAgICAgICByZXR1cm4gY2VsbCAmJiBjZWxsLnJvd1NwYW4gPiAxID8gMCA6IC0xOw0KICAgICAgICB9LA0KICAgICAgICBleGVjQ29tbWFuZDogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIHJuZyA9IHRoaXMuc2VsZWN0aW9uLmdldFJhbmdlKCksDQogICAgICAgICAgICAgICAgYmsgPSBybmcuY3JlYXRlQm9va21hcmsodHJ1ZSk7DQogICAgICAgICAgICB2YXIgY2VsbCA9IGdldFRhYmxlSXRlbXNCeVJhbmdlKHRoaXMpLmNlbGwsDQogICAgICAgICAgICAgICAgdXQgPSBnZXRVRVRhYmxlKGNlbGwpOw0KICAgICAgICAgICAgdXQuc3BsaXRUb1Jvd3MoY2VsbCk7DQogICAgICAgICAgICBybmcubW92ZVRvQm9va21hcmsoYmspLnNlbGVjdCgpOw0KICAgICAgICB9DQogICAgfTsNCiAgICBVRS5jb21tYW5kc1sic3BsaXR0b2NvbHMiXSA9IHsNCiAgICAgICAgcXVlcnlDb21tYW5kU3RhdGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciB0YWJsZUl0ZW1zID0gZ2V0VGFibGVJdGVtc0J5UmFuZ2UodGhpcyksDQogICAgICAgICAgICAgICAgY2VsbCA9IHRhYmxlSXRlbXMuY2VsbDsNCiAgICAgICAgICAgIGlmICghY2VsbCkgcmV0dXJuIC0xOw0KICAgICAgICAgICAgdmFyIHV0ID0gZ2V0VUVUYWJsZSh0YWJsZUl0ZW1zLnRhYmxlKTsNCiAgICAgICAgICAgIGlmICh1dC5zZWxlY3RlZFRkcy5sZW5ndGggPiAwKSByZXR1cm4gLTE7DQogICAgICAgICAgICByZXR1cm4gY2VsbCAmJiBjZWxsLmNvbFNwYW4gPiAxID8gMCA6IC0xOw0KICAgICAgICB9LA0KICAgICAgICBleGVjQ29tbWFuZDogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIHJuZyA9IHRoaXMuc2VsZWN0aW9uLmdldFJhbmdlKCksDQogICAgICAgICAgICAgICAgYmsgPSBybmcuY3JlYXRlQm9va21hcmsodHJ1ZSk7DQogICAgICAgICAgICB2YXIgY2VsbCA9IGdldFRhYmxlSXRlbXNCeVJhbmdlKHRoaXMpLmNlbGwsDQogICAgICAgICAgICAgICAgdXQgPSBnZXRVRVRhYmxlKGNlbGwpOw0KICAgICAgICAgICAgdXQuc3BsaXRUb0NvbHMoY2VsbCk7DQogICAgICAgICAgICBybmcubW92ZVRvQm9va21hcmsoYmspLnNlbGVjdCgpOw0KDQogICAgICAgIH0NCiAgICB9Ow0KDQogICAgVUUuY29tbWFuZHNbImFkYXB0Ynl0ZXh0Il0gPQ0KICAgICAgICBVRS5jb21tYW5kc1siYWRhcHRieXdpbmRvdyJdID0gew0KICAgICAgICAgICAgcXVlcnlDb21tYW5kU3RhdGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0VGFibGVJdGVtc0J5UmFuZ2UodGhpcykudGFibGUgPyAwIDogLTENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBleGVjQ29tbWFuZDogZnVuY3Rpb24gKGNtZCkgew0KICAgICAgICAgICAgICAgIHZhciB0YWJsZUl0ZW1zID0gZ2V0VGFibGVJdGVtc0J5UmFuZ2UodGhpcyksDQogICAgICAgICAgICAgICAgICAgIHRhYmxlID0gdGFibGVJdGVtcy50YWJsZTsNCiAgICAgICAgICAgICAgICBpZiAodGFibGUpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGNtZCA9PSAnYWRhcHRieXdpbmRvdycpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc2V0VGRXaWR0aCh0YWJsZSwgdGhpcyk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2VsbHMgPSBkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZSh0YWJsZSwgInRkIHRoIik7DQogICAgICAgICAgICAgICAgICAgICAgICB1dGlscy5lYWNoKGNlbGxzLCBmdW5jdGlvbiAoY2VsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbGwucmVtb3ZlQXR0cmlidXRlKCJ3aWR0aCIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0YWJsZS5yZW1vdmVBdHRyaWJ1dGUoIndpZHRoIik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH07DQoNCiAgICAvL+W5s+Wdh+WIhumFjeWQhOWIlw0KICAgIFVFLmNvbW1hbmRzWydhdmVyYWdlZGlzdHJpYnV0ZWNvbCddID0gew0KICAgICAgICBxdWVyeUNvbW1hbmRTdGF0ZTogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIHV0ID0gZ2V0VUVUYWJsZUJ5U2VsZWN0ZWQodGhpcyk7DQogICAgICAgICAgICBpZiAoIXV0KSByZXR1cm4gLTE7DQogICAgICAgICAgICByZXR1cm4gdXQuaXNGdWxsUm93KCkgfHwgdXQuaXNGdWxsQ29sKCkgPyAwIDogLTE7DQogICAgICAgIH0sDQogICAgICAgIGV4ZWNDb21tYW5kOiBmdW5jdGlvbiAoY21kKSB7DQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzLA0KICAgICAgICAgICAgICAgIHV0ID0gZ2V0VUVUYWJsZUJ5U2VsZWN0ZWQobWUpOw0KDQogICAgICAgICAgICBmdW5jdGlvbiBnZXRBdmVyYWdlV2lkdGgoKSB7DQogICAgICAgICAgICAgICAgdmFyIHRiID0gdXQudGFibGUsDQogICAgICAgICAgICAgICAgICAgIGF2ZXJhZ2VXaWR0aCwgc3VtV2lkdGggPSAwLCBjb2xzTnVtID0gMCwNCiAgICAgICAgICAgICAgICAgICAgdGJBdHRyID0gZ2V0RGVmYXVsdFZhbHVlKG1lLCB0Yik7DQoNCiAgICAgICAgICAgICAgICBpZiAodXQuaXNGdWxsUm93KCkpIHsNCiAgICAgICAgICAgICAgICAgICAgc3VtV2lkdGggPSB0Yi5vZmZzZXRXaWR0aDsNCiAgICAgICAgICAgICAgICAgICAgY29sc051bSA9IHV0LmNvbHNOdW07DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGJlZ2luID0gdXQuY2VsbHNSYW5nZS5iZWdpbkNvbEluZGV4LA0KICAgICAgICAgICAgICAgICAgICAgICAgZW5kID0gdXQuY2VsbHNSYW5nZS5lbmRDb2xJbmRleCwNCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGU7DQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSBiZWdpbjsgaSA8PSBlbmQ7KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBub2RlID0gdXQuc2VsZWN0ZWRUZHNbaV07DQogICAgICAgICAgICAgICAgICAgICAgICBzdW1XaWR0aCArPSBub2RlLm9mZnNldFdpZHRoOw0KICAgICAgICAgICAgICAgICAgICAgICAgaSArPSBub2RlLmNvbFNwYW47DQogICAgICAgICAgICAgICAgICAgICAgICBjb2xzTnVtICs9IDE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYXZlcmFnZVdpZHRoID0gTWF0aC5jZWlsKHN1bVdpZHRoIC8gY29sc051bSkgLSB0YkF0dHIudGRCb3JkZXIgKiAyIC0gdGJBdHRyLnRkUGFkZGluZyAqIDI7DQogICAgICAgICAgICAgICAgcmV0dXJuIGF2ZXJhZ2VXaWR0aDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgZnVuY3Rpb24gc2V0QXZlcmFnZVdpZHRoKGF2ZXJhZ2VXaWR0aCkgew0KICAgICAgICAgICAgICAgIHV0aWxzLmVhY2goZG9tVXRpbHMuZ2V0RWxlbWVudHNCeVRhZ05hbWUodXQudGFibGUsICJ0aCIpLCBmdW5jdGlvbiAobm9kZSkgew0KICAgICAgICAgICAgICAgICAgICBub2RlLnNldEF0dHJpYnV0ZSgid2lkdGgiLCAiIik7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgdmFyIGNlbGxzID0gdXQuaXNGdWxsUm93KCkgPyBkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZSh1dC50YWJsZSwgInRkIikgOiB1dC5zZWxlY3RlZFRkczsNCg0KICAgICAgICAgICAgICAgIHV0aWxzLmVhY2goY2VsbHMsIGZ1bmN0aW9uIChub2RlKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmNvbFNwYW4gPT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoIndpZHRoIiwgYXZlcmFnZVdpZHRoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAodXQgJiYgdXQuc2VsZWN0ZWRUZHMubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgc2V0QXZlcmFnZVdpZHRoKGdldEF2ZXJhZ2VXaWR0aCgpKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH07DQogICAgLy/lubPlnYfliIbphY3lkITooYwNCiAgICBVRS5jb21tYW5kc1snYXZlcmFnZWRpc3RyaWJ1dGVyb3cnXSA9IHsNCiAgICAgICAgcXVlcnlDb21tYW5kU3RhdGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciB1dCA9IGdldFVFVGFibGVCeVNlbGVjdGVkKHRoaXMpOw0KICAgICAgICAgICAgaWYgKCF1dCkgcmV0dXJuIC0xOw0KICAgICAgICAgICAgaWYgKHV0LnNlbGVjdGVkVGRzICYmIC90aC9pZy50ZXN0KHV0LnNlbGVjdGVkVGRzWzBdLnRhZ05hbWUpKSByZXR1cm4gLTE7DQogICAgICAgICAgICByZXR1cm4gdXQuaXNGdWxsUm93KCkgfHwgdXQuaXNGdWxsQ29sKCkgPyAwIDogLTE7DQogICAgICAgIH0sDQogICAgICAgIGV4ZWNDb21tYW5kOiBmdW5jdGlvbiAoY21kKSB7DQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzLA0KICAgICAgICAgICAgICAgIHV0ID0gZ2V0VUVUYWJsZUJ5U2VsZWN0ZWQobWUpOw0KDQogICAgICAgICAgICBmdW5jdGlvbiBnZXRBdmVyYWdlSGVpZ2h0KCkgew0KICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlSGVpZ2h0LCByb3dOdW0sIHN1bUhlaWdodCA9IDAsDQogICAgICAgICAgICAgICAgICAgIHRiID0gdXQudGFibGUsDQogICAgICAgICAgICAgICAgICAgIHRiQXR0ciA9IGdldERlZmF1bHRWYWx1ZShtZSwgdGIpLA0KICAgICAgICAgICAgICAgICAgICB0ZHBhZGRpbmcgPSBwYXJzZUludChkb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKHRiLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0ZCcpWzBdLCAicGFkZGluZy10b3AiKSk7DQoNCiAgICAgICAgICAgICAgICBpZiAodXQuaXNGdWxsQ29sKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGNhcHRpb25BcnIgPSBkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZSh0YiwgImNhcHRpb24iKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoQXJyID0gZG9tVXRpbHMuZ2V0RWxlbWVudHNCeVRhZ05hbWUodGIsICJ0aCIpLA0KICAgICAgICAgICAgICAgICAgICAgICAgY2FwdGlvbkhlaWdodCwgdGhIZWlnaHQ7DQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKGNhcHRpb25BcnIubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY2FwdGlvbkhlaWdodCA9IGNhcHRpb25BcnJbMF0ub2Zmc2V0SGVpZ2h0Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmICh0aEFyci5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aEhlaWdodCA9IHRoQXJyWzBdLm9mZnNldEhlaWdodDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIHN1bUhlaWdodCA9IHRiLm9mZnNldEhlaWdodCAtIChjYXB0aW9uSGVpZ2h0IHx8IDApIC0gKHRoSGVpZ2h0IHx8IDApOw0KICAgICAgICAgICAgICAgICAgICByb3dOdW0gPSB0aEFyci5sZW5ndGggPT0gMCA/IHV0LnJvd3NOdW0gOiAodXQucm93c051bSAtIDEpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBiZWdpbiA9IHV0LmNlbGxzUmFuZ2UuYmVnaW5Sb3dJbmRleCwNCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZCA9IHV0LmNlbGxzUmFuZ2UuZW5kUm93SW5kZXgsDQogICAgICAgICAgICAgICAgICAgICAgICBjb3VudCA9IDAsDQogICAgICAgICAgICAgICAgICAgICAgICB0cnMgPSBkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZSh0YiwgInRyIik7DQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSBiZWdpbjsgaSA8PSBlbmQ7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgc3VtSGVpZ2h0ICs9IHRyc1tpXS5vZmZzZXRIZWlnaHQ7DQogICAgICAgICAgICAgICAgICAgICAgICBjb3VudCArPSAxOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJvd051bSA9IGNvdW50Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAvL2llOOS4i+aYr+a3t+adguaooeW8jw0KICAgICAgICAgICAgICAgIGlmIChicm93c2VyLmllICYmIGJyb3dzZXIudmVyc2lvbiA8IDkpIHsNCiAgICAgICAgICAgICAgICAgICAgYXZlcmFnZUhlaWdodCA9IE1hdGguY2VpbChzdW1IZWlnaHQgLyByb3dOdW0pOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGF2ZXJhZ2VIZWlnaHQgPSBNYXRoLmNlaWwoc3VtSGVpZ2h0IC8gcm93TnVtKSAtIHRiQXR0ci50ZEJvcmRlciAqIDIgLSB0ZHBhZGRpbmcgKiAyOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICByZXR1cm4gYXZlcmFnZUhlaWdodDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgZnVuY3Rpb24gc2V0QXZlcmFnZUhlaWdodChhdmVyYWdlSGVpZ2h0KSB7DQogICAgICAgICAgICAgICAgdmFyIGNlbGxzID0gdXQuaXNGdWxsQ29sKCkgPyBkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZSh1dC50YWJsZSwgInRkIikgOiB1dC5zZWxlY3RlZFRkczsNCiAgICAgICAgICAgICAgICB1dGlscy5lYWNoKGNlbGxzLCBmdW5jdGlvbiAobm9kZSkgew0KICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5yb3dTcGFuID09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCJoZWlnaHQiLCBhdmVyYWdlSGVpZ2h0KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAodXQgJiYgdXQuc2VsZWN0ZWRUZHMubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgc2V0QXZlcmFnZUhlaWdodChnZXRBdmVyYWdlSGVpZ2h0KCkpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfTsNCg0KICAgIC8v5Y2V5YWD5qC85a+56b2Q5pa55byPDQogICAgVUUuY29tbWFuZHNbJ2NlbGxhbGlnbm1lbnQnXSA9IHsNCiAgICAgICAgcXVlcnlDb21tYW5kU3RhdGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHJldHVybiBnZXRUYWJsZUl0ZW1zQnlSYW5nZSh0aGlzKS50YWJsZSA/IDAgOiAtMQ0KICAgICAgICB9LA0KICAgICAgICBleGVjQ29tbWFuZDogZnVuY3Rpb24gKGNtZCwgZGF0YSkgew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpcywNCiAgICAgICAgICAgICAgICB1dCA9IGdldFVFVGFibGVCeVNlbGVjdGVkKG1lKTsNCg0KICAgICAgICAgICAgaWYgKCF1dCkgew0KICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IG1lLnNlbGVjdGlvbi5nZXRTdGFydCgpLA0KICAgICAgICAgICAgICAgICAgICBjZWxsID0gc3RhcnQgJiYgZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShzdGFydCwgWyJ0ZCIsICJ0aCIsICJjYXB0aW9uIl0sIHRydWUpOw0KICAgICAgICAgICAgICAgIGlmICghL2NhcHRpb24vaWcudGVzdChjZWxsLnRhZ05hbWUpKSB7DQogICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnNldEF0dHJpYnV0ZXMoY2VsbCwgZGF0YSk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgY2VsbC5zdHlsZS50ZXh0QWxpZ24gPSBkYXRhLmFsaWduOw0KICAgICAgICAgICAgICAgICAgICBjZWxsLnN0eWxlLnZlcnRpY2FsQWxpZ24gPSBkYXRhLnZBbGlnbjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgbWUuc2VsZWN0aW9uLmdldFJhbmdlKCkuc2V0Q3Vyc29yKHRydWUpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB1dGlscy5lYWNoKHV0LnNlbGVjdGVkVGRzLCBmdW5jdGlvbiAoY2VsbCkgew0KICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5zZXRBdHRyaWJ1dGVzKGNlbGwsIGRhdGEpOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICAvKioNCiAgICAgICAgICog5p+l6K+i5b2T5YmN54K55Ye755qE5Y2V5YWD5qC855qE5a+56b2Q54q25oCB77yMIOWmguaenOW9k+WJjeW3sue7j+mAieaLqeS6huWkmuS4quWNleWFg+agvO+8jCDliJnkvJrov5Tlm57miYDmnInljZXlhYPmoLznu4/ov4fnu5/kuIDljY/osIPov4flkI7nmoTnirbmgIENCiAgICAgICAgICogQHNlZSBVRS5VRVRhYmxlLmdldFRhYmxlQ2VsbEFsaWduU3RhdGUNCiAgICAgICAgICovDQogICAgICAgIHF1ZXJ5Q29tbWFuZFZhbHVlOiBmdW5jdGlvbiAoY21kKSB7DQoNCiAgICAgICAgICAgIHZhciBhY3RpdmVNZW51Q2VsbCA9IGdldFRhYmxlSXRlbXNCeVJhbmdlKCB0aGlzKS5jZWxsOw0KDQogICAgICAgICAgICBpZiggIWFjdGl2ZU1lbnVDZWxsICkgew0KICAgICAgICAgICAgICAgIGFjdGl2ZU1lbnVDZWxsID0gZ2V0U2VsZWN0ZWRBcnIodGhpcylbMF07DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICghYWN0aXZlTWVudUNlbGwpIHsNCg0KICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KDQogICAgICAgICAgICB9IGVsc2Ugew0KDQogICAgICAgICAgICAgICAgLy/ojrflj5blkIzml7bpgInkuK3nmoTlhbbku5bljZXlhYPmoLwNCiAgICAgICAgICAgICAgICB2YXIgY2VsbHMgPSBVRS5VRVRhYmxlLmdldFVFVGFibGUoYWN0aXZlTWVudUNlbGwpLnNlbGVjdGVkVGRzOw0KDQogICAgICAgICAgICAgICAgIWNlbGxzLmxlbmd0aCAmJiAoIGNlbGxzID0gYWN0aXZlTWVudUNlbGwgKTsNCg0KICAgICAgICAgICAgICAgIHJldHVybiBVRS5VRVRhYmxlLmdldFRhYmxlQ2VsbEFsaWduU3RhdGUoY2VsbHMpOw0KDQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KICAgIH07DQogICAgLy/ooajmoLzlr7npvZDmlrnlvI8NCiAgICBVRS5jb21tYW5kc1sndGFibGVhbGlnbm1lbnQnXSA9IHsNCiAgICAgICAgcXVlcnlDb21tYW5kU3RhdGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIGlmIChicm93c2VyLmllICYmIGJyb3dzZXIudmVyc2lvbiA8IDgpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gLTE7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gZ2V0VGFibGVJdGVtc0J5UmFuZ2UodGhpcykudGFibGUgPyAwIDogLTENCiAgICAgICAgfSwNCiAgICAgICAgZXhlY0NvbW1hbmQ6IGZ1bmN0aW9uIChjbWQsIHZhbHVlKSB7DQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzLA0KICAgICAgICAgICAgICAgIHN0YXJ0ID0gbWUuc2VsZWN0aW9uLmdldFN0YXJ0KCksDQogICAgICAgICAgICAgICAgdGFibGUgPSBzdGFydCAmJiBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKHN0YXJ0LCBbInRhYmxlIl0sIHRydWUpOw0KDQogICAgICAgICAgICBpZiAodGFibGUpIHsNCiAgICAgICAgICAgICAgICB0YWJsZS5zZXRBdHRyaWJ1dGUoImFsaWduIix2YWx1ZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9Ow0KDQogICAgLy/ooajmoLzlsZ7mgKcNCiAgICBVRS5jb21tYW5kc1snZWRpdHRhYmxlJ10gPSB7DQogICAgICAgIHF1ZXJ5Q29tbWFuZFN0YXRlOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICByZXR1cm4gZ2V0VGFibGVJdGVtc0J5UmFuZ2UodGhpcykudGFibGUgPyAwIDogLTENCiAgICAgICAgfSwNCiAgICAgICAgZXhlY0NvbW1hbmQ6IGZ1bmN0aW9uIChjbWQsIGNvbG9yKSB7DQogICAgICAgICAgICB2YXIgcm5nID0gdGhpcy5zZWxlY3Rpb24uZ2V0UmFuZ2UoKSwNCiAgICAgICAgICAgICAgICB0YWJsZSA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUocm5nLnN0YXJ0Q29udGFpbmVyLCAndGFibGUnKTsNCiAgICAgICAgICAgIGlmICh0YWJsZSkgew0KICAgICAgICAgICAgICAgIHZhciBhcnIgPSBkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZSh0YWJsZSwgInRkIikuY29uY2F0KA0KICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZSh0YWJsZSwgInRoIiksDQogICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLmdldEVsZW1lbnRzQnlUYWdOYW1lKHRhYmxlLCAiY2FwdGlvbiIpDQogICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICB1dGlscy5lYWNoKGFyciwgZnVuY3Rpb24gKG5vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgbm9kZS5zdHlsZS5ib3JkZXJDb2xvciA9IGNvbG9yOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfTsNCiAgICAvL+WNleWFg+agvOWxnuaApw0KICAgIFVFLmNvbW1hbmRzWydlZGl0dGQnXSA9IHsNCiAgICAgICAgcXVlcnlDb21tYW5kU3RhdGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHJldHVybiBnZXRUYWJsZUl0ZW1zQnlSYW5nZSh0aGlzKS50YWJsZSA/IDAgOiAtMQ0KICAgICAgICB9LA0KICAgICAgICBleGVjQ29tbWFuZDogZnVuY3Rpb24gKGNtZCwgYmtDb2xvcikgew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpcywNCiAgICAgICAgICAgICAgICB1dCA9IGdldFVFVGFibGVCeVNlbGVjdGVkKG1lKTsNCg0KICAgICAgICAgICAgaWYgKCF1dCkgew0KICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IG1lLnNlbGVjdGlvbi5nZXRTdGFydCgpLA0KICAgICAgICAgICAgICAgICAgICBjZWxsID0gc3RhcnQgJiYgZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShzdGFydCwgWyJ0ZCIsICJ0aCIsICJjYXB0aW9uIl0sIHRydWUpOw0KICAgICAgICAgICAgICAgIGlmIChjZWxsKSB7DQogICAgICAgICAgICAgICAgICAgIGNlbGwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gYmtDb2xvcjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHV0aWxzLmVhY2godXQuc2VsZWN0ZWRUZHMsIGZ1bmN0aW9uIChjZWxsKSB7DQogICAgICAgICAgICAgICAgICAgIGNlbGwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gYmtDb2xvcjsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH07DQogICAgVUUuY29tbWFuZHNbJ3NvcnR0YWJsZSddID0gew0KICAgICAgICBxdWVyeUNvbW1hbmRTdGF0ZTogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpcywNCiAgICAgICAgICAgICAgICB0YWJsZUl0ZW1zID0gZ2V0VGFibGVJdGVtc0J5UmFuZ2UobWUpOw0KICAgICAgICAgICAgaWYgKCF0YWJsZUl0ZW1zLmNlbGwpIHJldHVybiAtMTsNCiAgICAgICAgICAgIHZhciB0YWJsZSA9IHRhYmxlSXRlbXMudGFibGUsDQogICAgICAgICAgICAgICAgY2VsbHMgPSB0YWJsZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgidGQiKTsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjZWxsOyBjZWxsID0gY2VsbHNbaSsrXTspIHsNCiAgICAgICAgICAgICAgICBpZiAoY2VsbC5yb3dTcGFuICE9IDEgfHwgY2VsbC5jb2xTcGFuICE9IDEpIHJldHVybiAtMTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICB9LA0KICAgICAgICBleGVjQ29tbWFuZDogZnVuY3Rpb24gKGNtZCwgZm4pIHsNCiAgICAgICAgICAgIHZhciBtZSA9IHRoaXMsDQogICAgICAgICAgICAgICAgcmFuZ2UgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKSwNCiAgICAgICAgICAgICAgICBiayA9IHJhbmdlLmNyZWF0ZUJvb2ttYXJrKHRydWUpLA0KICAgICAgICAgICAgICAgIHRhYmxlSXRlbXMgPSBnZXRUYWJsZUl0ZW1zQnlSYW5nZShtZSksDQogICAgICAgICAgICAgICAgY2VsbCA9IHRhYmxlSXRlbXMuY2VsbCwNCiAgICAgICAgICAgICAgICB1dCA9IGdldFVFVGFibGUodGFibGVJdGVtcy50YWJsZSksDQogICAgICAgICAgICAgICAgY2VsbEluZm8gPSB1dC5nZXRDZWxsSW5mbyhjZWxsKTsNCiAgICAgICAgICAgIHV0LnNvcnRUYWJsZShjZWxsSW5mby5jZWxsSW5kZXgsIGZuKTsNCiAgICAgICAgICAgIHJhbmdlLm1vdmVUb0Jvb2ttYXJrKGJrKS5zZWxlY3QoKTsNCiAgICAgICAgfQ0KICAgIH07DQoNCiAgICBVRS5jb21tYW5kc1siZW5hYmxlc29ydCJdID0gVUUuY29tbWFuZHNbImRpc2FibGVzb3J0Il0gPSB7DQogICAgICAgIHF1ZXJ5Q29tbWFuZFN0YXRlOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICByZXR1cm4gZ2V0VGFibGVJdGVtc0J5UmFuZ2UodGhpcykudGFibGUgPyAwIDogLTE7DQogICAgICAgIH0sDQogICAgICAgIGV4ZWNDb21tYW5kOiBmdW5jdGlvbiAoY21kKSB7DQogICAgICAgICAgICB2YXIgdGFibGUgPSBnZXRUYWJsZUl0ZW1zQnlSYW5nZSh0aGlzKS50YWJsZTsNCiAgICAgICAgICAgIHRhYmxlLnNldEF0dHJpYnV0ZSgiZGF0YS1zb3J0IiwgY21kID09ICJlbmFibGVzb3J0IiA/ICJzb3J0RW5hYmxlZCIgOiAic29ydERpc2FibGVkIik7DQogICAgICAgIH0NCiAgICB9Ow0KICAgIFVFLmNvbW1hbmRzWyJzZXR0YWJsZWJhY2tncm91bmQiXSA9IHsNCiAgICAgICAgcXVlcnlDb21tYW5kU3RhdGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHJldHVybiBnZXRTZWxlY3RlZEFycih0aGlzKS5sZW5ndGggPiAxID8gMCA6IC0xOw0KICAgICAgICB9LA0KICAgICAgICBleGVjQ29tbWFuZDogZnVuY3Rpb24gKGNtZCwgdmFsdWUpIHsNCiAgICAgICAgICAgIHZhciB0YWJsZSwgY2VsbHMsIHV0Ow0KICAgICAgICAgICAgY2VsbHMgPSBnZXRTZWxlY3RlZEFycih0aGlzKTsNCiAgICAgICAgICAgIHV0ID0gZ2V0VUVUYWJsZShjZWxsc1swXSk7DQogICAgICAgICAgICB1dC5zZXRCYWNrZ3JvdW5kKGNlbGxzLCB2YWx1ZSk7DQogICAgICAgIH0NCiAgICB9Ow0KDQogICAgVUUuY29tbWFuZHNbImNsZWFydGFibGViYWNrZ3JvdW5kIl0gPSB7DQogICAgICAgIHF1ZXJ5Q29tbWFuZFN0YXRlOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgY2VsbHMgPSBnZXRTZWxlY3RlZEFycih0aGlzKTsNCiAgICAgICAgICAgIGlmICghY2VsbHMubGVuZ3RoKXJldHVybiAtMTsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjZWxsOyBjZWxsID0gY2VsbHNbaSsrXTspIHsNCiAgICAgICAgICAgICAgICBpZiAoY2VsbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgIT09ICIiKSByZXR1cm4gMDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgfSwNCiAgICAgICAgZXhlY0NvbW1hbmQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBjZWxscyA9IGdldFNlbGVjdGVkQXJyKHRoaXMpLA0KICAgICAgICAgICAgICAgIHV0ID0gZ2V0VUVUYWJsZShjZWxsc1swXSk7DQogICAgICAgICAgICB1dC5yZW1vdmVCYWNrZ3JvdW5kKGNlbGxzKTsNCiAgICAgICAgfQ0KICAgIH07DQoNCiAgICBVRS5jb21tYW5kc1siaW50ZXJsYWNldGFibGUiXSA9IFVFLmNvbW1hbmRzWyJ1bmludGVybGFjZXRhYmxlIl0gPSB7DQogICAgICAgIHF1ZXJ5Q29tbWFuZFN0YXRlOiBmdW5jdGlvbiAoY21kKSB7DQogICAgICAgICAgICB2YXIgdGFibGUgPSBnZXRUYWJsZUl0ZW1zQnlSYW5nZSh0aGlzKS50YWJsZTsNCiAgICAgICAgICAgIGlmICghdGFibGUpIHJldHVybiAtMTsNCiAgICAgICAgICAgIHZhciBpbnRlcmxhY2VkID0gdGFibGUuZ2V0QXR0cmlidXRlKCJpbnRlcmxhY2VkIik7DQogICAgICAgICAgICBpZiAoY21kID09ICJpbnRlcmxhY2V0YWJsZSIpIHsNCiAgICAgICAgICAgICAgICAvL1RPRE8g5b6F5a6aDQogICAgICAgICAgICAgICAgLy/mmK/lkKbpnIDopoHlvoXlrprvvIzlpoLmnpzorr7nva7vvIzliJnlkb3ku6Tlj6rog73ljZXmrKHmiafooYzmiJDlip/vvIzkvYblj43lsITlhbflpId0b2dnbGXmlYjmnpzvvJvlkKbliJnlj6/ku6Xopobnm5bliY3mrKHlkb3ku6TvvIzkvYblj43lsITlsIbkuI3lrZjlnKh0b2dnbGXmlYjmnpwNCiAgICAgICAgICAgICAgICByZXR1cm4gKGludGVybGFjZWQgPT09ICJlbmFibGVkIikgPyAtMSA6IDA7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHJldHVybiAoIWludGVybGFjZWQgfHwgaW50ZXJsYWNlZCA9PT0gImRpc2FibGVkIikgPyAtMSA6IDA7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGV4ZWNDb21tYW5kOiBmdW5jdGlvbiAoY21kLCBjbGFzc0xpc3QpIHsNCiAgICAgICAgICAgIHZhciB0YWJsZSA9IGdldFRhYmxlSXRlbXNCeVJhbmdlKHRoaXMpLnRhYmxlOw0KICAgICAgICAgICAgaWYgKGNtZCA9PSAiaW50ZXJsYWNldGFibGUiKSB7DQogICAgICAgICAgICAgICAgdGFibGUuc2V0QXR0cmlidXRlKCJpbnRlcmxhY2VkIiwgImVuYWJsZWQiKTsNCiAgICAgICAgICAgICAgICB0aGlzLmZpcmVFdmVudCgiaW50ZXJsYWNldGFibGUiLCB0YWJsZSwgY2xhc3NMaXN0KTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGFibGUuc2V0QXR0cmlidXRlKCJpbnRlcmxhY2VkIiwgImRpc2FibGVkIik7DQogICAgICAgICAgICAgICAgdGhpcy5maXJlRXZlbnQoInVuaW50ZXJsYWNldGFibGUiLCB0YWJsZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9Ow0KDQogICAgZnVuY3Rpb24gcmVzZXRUZFdpZHRoKHRhYmxlLCBlZGl0b3IpIHsNCiAgICAgICAgdmFyIHRkcyA9IHRhYmxlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0ZCIpOw0KICAgICAgICB1dGlscy5lYWNoKHRkcywgZnVuY3Rpb24gKHRkKSB7DQogICAgICAgICAgICB0ZC5yZW1vdmVBdHRyaWJ1dGUoIndpZHRoIik7DQogICAgICAgIH0pOw0KICAgICAgICB0YWJsZS5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgZ2V0VGFibGVXaWR0aChlZGl0b3IsIHRydWUsIGdldERlZmF1bHRWYWx1ZShlZGl0b3IsIHRhYmxlKSkpOw0KICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHV0aWxzLmVhY2godGRzLCBmdW5jdGlvbiAodGQpIHsNCiAgICAgICAgICAgICAgICAodGQuY29sU3BhbiA9PSAxKSAmJiB0ZC5zZXRBdHRyaWJ1dGUoIndpZHRoIiwgdGQub2Zmc2V0V2lkdGggKyAiIik7DQogICAgICAgICAgICB9KQ0KICAgICAgICB9LCAwKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBnZXRUYWJsZVdpZHRoKGVkaXRvciwgbmVlZElFSGFjaywgZGVmYXVsdFZhbHVlKSB7DQogICAgICAgIHZhciBib2R5ID0gZWRpdG9yLmJvZHk7DQogICAgICAgIHJldHVybiBib2R5Lm9mZnNldFdpZHRoIC0gKG5lZWRJRUhhY2sgPyBwYXJzZUludChkb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKGJvZHksICdtYXJnaW4tbGVmdCcpLCAxMCkgKiAyIDogMCkgLSBkZWZhdWx0VmFsdWUudGFibGVCb3JkZXIgKiAyIC0gKGVkaXRvci5vcHRpb25zLm9mZnNldFdpZHRoIHx8IDApOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGdldFNlbGVjdGVkQXJyKGVkaXRvcikgew0KICAgICAgICB2YXIgY2VsbCA9IGdldFRhYmxlSXRlbXNCeVJhbmdlKGVkaXRvcikuY2VsbDsNCiAgICAgICAgaWYgKGNlbGwpIHsNCiAgICAgICAgICAgIHZhciB1dCA9IGdldFVFVGFibGUoY2VsbCk7DQogICAgICAgICAgICByZXR1cm4gdXQuc2VsZWN0ZWRUZHMubGVuZ3RoID8gdXQuc2VsZWN0ZWRUZHMgOiBbY2VsbF07DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gW107DQogICAgICAgIH0NCiAgICB9DQp9KSgpOwovKioNCiAqIENyZWF0ZWQgd2l0aCBKZXRCcmFpbnMgUGhwU3Rvcm0uDQogKiBVc2VyOiB0YW9xaWxpDQogKiBEYXRlOiAxMi0xMC0xMg0KICogVGltZTog5LiK5Y2IMTA6MDUNCiAqIFRvIGNoYW5nZSB0aGlzIHRlbXBsYXRlIHVzZSBGaWxlIHwgU2V0dGluZ3MgfCBGaWxlIFRlbXBsYXRlcy4NCiAqLw0KVUUucGx1Z2luc1sndGFibGUnXSA9IGZ1bmN0aW9uICgpIHsNCiAgICB2YXIgbWUgPSB0aGlzLA0KICAgICAgICB0YWJUaW1lciA9IG51bGwsDQogICAgICAgIC8v5ouW5Yqo6K6h5pe25ZmoDQogICAgICAgIHRhYmxlRHJhZ1RpbWVyID0gbnVsbCwNCiAgICAgICAgLy/lj4zlh7vorqHml7blmagNCiAgICAgICAgdGFibGVSZXNpemVUaW1lciA9IG51bGwsDQogICAgICAgIC8v5Y2V5YWD5qC85pyA5bCP5a695bqmDQogICAgICAgIGNlbGxNaW5XaWR0aCA9IDUsDQogICAgICAgIGlzSW5SZXNpemVCdWZmZXIgPSBmYWxzZSwNCiAgICAgICAgLy/ljZXlhYPmoLzovrnmoYblpKflsI8NCiAgICAgICAgY2VsbEJvcmRlcldpZHRoID0gNSwNCiAgICAgICAgLy/pvKDmoIflgY/np7vot53nprsNCiAgICAgICAgb2Zmc2V0T2ZUYWJsZUNlbGwgPSAxMCwNCiAgICAgICAgLy/orrDlvZXlnKjmnInpmZDml7bpl7TlhoXnmoTngrnlh7vnirbmgIHvvIwg5YWx5pyJM+S4quWPluWAvO+8jCAwLCAxLCAy44CCIDDku6PooajmnKrliJ3lp4vljJbvvIwgMeS7o+ihqOWNleWHu+S6hjHmrKHvvIwy5Luj6KGoMuasoQ0KICAgICAgICBzaW5nbGVDbGlja1N0YXRlID0gMCwNCiAgICAgICAgdXNlckFjdGlvblN0YXR1cyA9IG51bGwsDQogICAgICAgIC8v5Y+M5Ye75YWB6K6455qE5pe26Ze06IyD5Zu0DQogICAgICAgIGRibGNsaWNrVGltZSA9IDM2MCwNCiAgICAgICAgVVQgPSBVRS5VRVRhYmxlLA0KICAgICAgICBnZXRVRVRhYmxlID0gZnVuY3Rpb24gKHRkT3JUYWJsZSkgew0KICAgICAgICAgICAgcmV0dXJuIFVULmdldFVFVGFibGUodGRPclRhYmxlKTsNCiAgICAgICAgfSwNCiAgICAgICAgZ2V0VUVUYWJsZUJ5U2VsZWN0ZWQgPSBmdW5jdGlvbiAoZWRpdG9yKSB7DQogICAgICAgICAgICByZXR1cm4gVVQuZ2V0VUVUYWJsZUJ5U2VsZWN0ZWQoZWRpdG9yKTsNCiAgICAgICAgfSwNCiAgICAgICAgZ2V0RGVmYXVsdFZhbHVlID0gZnVuY3Rpb24gKGVkaXRvciwgdGFibGUpIHsNCiAgICAgICAgICAgIHJldHVybiBVVC5nZXREZWZhdWx0VmFsdWUoZWRpdG9yLCB0YWJsZSk7DQogICAgICAgIH0sDQogICAgICAgIHJlbW92ZVNlbGVjdGVkQ2xhc3MgPSBmdW5jdGlvbiAoY2VsbHMpIHsNCiAgICAgICAgICAgIHJldHVybiBVVC5yZW1vdmVTZWxlY3RlZENsYXNzKGNlbGxzKTsNCiAgICAgICAgfTsNCg0KICAgIGZ1bmN0aW9uIHNob3dFcnJvcihlKSB7DQovLyAgICAgICAgdGhyb3cgZTsNCiAgICB9DQogICAgbWUucmVhZHkoZnVuY3Rpb24oKXsNCiAgICAgICAgdmFyIG1lID0gdGhpczsNCiAgICAgICAgdmFyIG9yZ0dldFRleHQgPSBtZS5zZWxlY3Rpb24uZ2V0VGV4dDsNCiAgICAgICAgbWUuc2VsZWN0aW9uLmdldFRleHQgPSBmdW5jdGlvbigpew0KICAgICAgICAgICAgdmFyIHRhYmxlID0gZ2V0VUVUYWJsZUJ5U2VsZWN0ZWQobWUpOw0KICAgICAgICAgICAgaWYodGFibGUpew0KICAgICAgICAgICAgICAgIHZhciBzdHIgPSAnJzsNCiAgICAgICAgICAgICAgICB1dGlscy5lYWNoKHRhYmxlLnNlbGVjdGVkVGRzLGZ1bmN0aW9uKHRkKXsNCiAgICAgICAgICAgICAgICAgICAgc3RyICs9IHRkW2Jyb3dzZXIuaWU/J2lubmVyVGV4dCc6J3RleHRDb250ZW50J107DQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICByZXR1cm4gc3RyOw0KICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgcmV0dXJuIG9yZ0dldFRleHQuY2FsbChtZS5zZWxlY3Rpb24pDQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KICAgIH0pDQoNCiAgICAvL+WkhOeQhuaLluWKqOWPiuahhumAieebuOWFs+aWueazlQ0KICAgIHZhciBzdGFydFRkID0gbnVsbCwgLy/pvKDmoIfmjInkuIvml7bnmoTplJrngrl0ZA0KICAgICAgICBjdXJyZW50VGQgPSBudWxsLCAvL+W9k+WJjem8oOagh+e7j+i/h+aXtueahHRkDQogICAgICAgIG9uRHJhZyA9ICIiLCAvL+aMh+ekuuW9k+WJjeaLluWKqOeKtuaAge+8jOWFtuWAvOWPr+S4uiIiLCJoIiwidiIgLOWIhuWIq+ihqOekuuacquaLluWKqOeKtuaAge+8jOaoquWQkeaLluWKqOeKtuaAge+8jOe6teWQkeaLluWKqOeKtuaAge+8jOeUqOS6jum8oOagh+enu+WKqOi/h+eoi+S4reeahOWIpOaWrQ0KICAgICAgICBvbkJvcmRlciA9IGZhbHNlLCAvL+ajgOa1i+m8oOagh+aMieS4i+aXtuaYr+WQpuWkhOWcqOWNleWFg+agvOi+uee8mOS9jee9rg0KICAgICAgICBkcmFnQnV0dG9uID0gbnVsbCwNCiAgICAgICAgZHJhZ092ZXIgPSBmYWxzZSwNCiAgICAgICAgZHJhZ0xpbmUgPSBudWxsLCAvL+aooeaLn+eahOaLluWKqOe6vw0KICAgICAgICBkcmFnVGQgPSBudWxsOyAgICAvL+WPkeeUn+aLluWKqOeahOebruagh3RkDQoNCiAgICB2YXIgbW91c2Vkb3duID0gZmFsc2UsDQogICAgLy90b2RvIOWIpOaWrea3t+S5seaooeW8jw0KICAgICAgICBuZWVkSUVIYWNrID0gdHJ1ZTsNCg0KICAgIG1lLnNldE9wdCh7DQogICAgICAgICdtYXhDb2xOdW0nOjIwLA0KICAgICAgICAnbWF4Um93TnVtJzoxMDAsDQogICAgICAgICdkZWZhdWx0Q29scyc6NSwNCiAgICAgICAgJ2RlZmF1bHRSb3dzJzo1LA0KICAgICAgICAndGR2YWxpZ24nOid0b3AnLA0KICAgICAgICAnY3Vyc29ycGF0aCc6bWUub3B0aW9ucy5VRURJVE9SX0hPTUVfVVJMICsgInRoZW1lcy9kZWZhdWx0L2ltYWdlcy9jdXJzb3JfIiwNCiAgICAgICAgJ3RhYmxlRHJhZ2FibGUnOmZhbHNlLA0KICAgICAgICAnY2xhc3NMaXN0JzpbInVlLXRhYmxlLWludGVybGFjZS1jb2xvci1zaW5nbGUiLCJ1ZS10YWJsZS1pbnRlcmxhY2UtY29sb3ItZG91YmxlIl0NCiAgICB9KTsNCiAgICBtZS5nZXRVRVRhYmxlID0gZ2V0VUVUYWJsZTsNCiAgICB2YXIgY29tbWFuZHMgPSB7DQogICAgICAgICdkZWxldGV0YWJsZSc6MSwNCiAgICAgICAgJ2luc2VydHRhYmxlJzoxLA0KICAgICAgICAnY2VsbHZhbGlnbic6MSwNCiAgICAgICAgJ2luc2VydGNhcHRpb24nOjEsDQogICAgICAgICdkZWxldGVjYXB0aW9uJzoxLA0KICAgICAgICAnaW5zZXJ0dGl0bGUnOjEsDQogICAgICAgICdkZWxldGV0aXRsZSc6MSwNCiAgICAgICAgIm1lcmdlcmlnaHQiOjEsDQogICAgICAgICJtZXJnZWRvd24iOjEsDQogICAgICAgICJtZXJnZWNlbGxzIjoxLA0KICAgICAgICAiaW5zZXJ0cm93IjoxLA0KICAgICAgICAiaW5zZXJ0cm93bmV4dCI6MSwNCiAgICAgICAgImRlbGV0ZXJvdyI6MSwNCiAgICAgICAgImluc2VydGNvbCI6MSwNCiAgICAgICAgImluc2VydGNvbG5leHQiOjEsDQogICAgICAgICJkZWxldGVjb2wiOjEsDQogICAgICAgICJzcGxpdHRvY2VsbHMiOjEsDQogICAgICAgICJzcGxpdHRvcm93cyI6MSwNCiAgICAgICAgInNwbGl0dG9jb2xzIjoxLA0KICAgICAgICAiYWRhcHRieXRleHQiOjEsDQogICAgICAgICJhZGFwdGJ5d2luZG93IjoxLA0KICAgICAgICAiYWRhcHRieWN1c3RvbWVyIjoxLA0KICAgICAgICAiaW5zZXJ0cGFyYWdyYXBoIjoxLA0KICAgICAgICAiaW5zZXJ0cGFyYWdyYXBoYmVmb3JldGFibGUiOjEsDQogICAgICAgICJhdmVyYWdlZGlzdHJpYnV0ZWNvbCI6MSwNCiAgICAgICAgImF2ZXJhZ2VkaXN0cmlidXRlcm93IjoxDQogICAgfTsNCiAgICBtZS5yZWFkeShmdW5jdGlvbiAoKSB7DQogICAgICAgIHV0aWxzLmNzc1J1bGUoJ3RhYmxlJywNCiAgICAgICAgICAgIC8v6YCJ5Lit55qEdGTkuIrnmoTmoLflvI8NCiAgICAgICAgICAgICcuc2VsZWN0VGRDbGFzc3tiYWNrZ3JvdW5kLWNvbG9yOiNlZGY1ZmEgIWltcG9ydGFudH0nICsNCiAgICAgICAgICAgICAgICAndGFibGUubm9Cb3JkZXJUYWJsZSB0ZCx0YWJsZS5ub0JvcmRlclRhYmxlIHRoLHRhYmxlLm5vQm9yZGVyVGFibGUgY2FwdGlvbntib3JkZXI6MXB4IGRhc2hlZCAjZGRkICFpbXBvcnRhbnR9JyArDQogICAgICAgICAgICAgICAgLy/mj5LlhaXnmoTooajmoLznmoTpu5jorqTmoLflvI8NCiAgICAgICAgICAgICAgICAndGFibGV7bWFyZ2luLWJvdHRvbToxMHB4O2JvcmRlci1jb2xsYXBzZTpjb2xsYXBzZTtkaXNwbGF5OnRhYmxlO30nICsNCiAgICAgICAgICAgICAgICAndGQsdGh7cGFkZGluZzogNXB4IDEwcHg7Ym9yZGVyOiAxcHggc29saWQgI0RERDt9JyArDQogICAgICAgICAgICAgICAgJ2NhcHRpb257Ym9yZGVyOjFweCBkYXNoZWQgI0RERDtib3JkZXItYm90dG9tOjA7cGFkZGluZzozcHg7dGV4dC1hbGlnbjpjZW50ZXI7fScgKw0KICAgICAgICAgICAgICAgICd0aHtib3JkZXItdG9wOjJweCBzb2xpZCAjQkJCO2JhY2tncm91bmQ6I0Y3RjdGNzt9JyArDQogICAgICAgICAgICAgICAgJy51ZS10YWJsZS1pbnRlcmxhY2UtY29sb3Itc2luZ2xleyBiYWNrZ3JvdW5kLWNvbG9yOiAjZmNmY2ZjOyB9IC51ZS10YWJsZS1pbnRlcmxhY2UtY29sb3ItZG91YmxleyBiYWNrZ3JvdW5kLWNvbG9yOiAjZjdmYWZmOyB9JyArDQogICAgICAgICAgICAgICAgJ3RkIHB7bWFyZ2luOjA7cGFkZGluZzowO30nLCBtZS5kb2N1bWVudCk7DQoNCiAgICAgICAgdmFyIHRhYmxlQ29weUxpc3QsIGlzRnVsbENvbCwgaXNGdWxsUm93Ow0KICAgICAgICAvL+azqOWGjGRlbC9iYWNrc3BhY2Xkuovku7YNCiAgICAgICAgbWUuYWRkTGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbiAoY21kLCBldnQpIHsNCiAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7DQogICAgICAgICAgICB2YXIga2V5Q29kZSA9IGV2dC5rZXlDb2RlIHx8IGV2dC53aGljaDsNCg0KICAgICAgICAgICAgaWYgKGtleUNvZGUgPT0gOCkgew0KDQogICAgICAgICAgICAgICAgdmFyIHV0ID0gZ2V0VUVUYWJsZUJ5U2VsZWN0ZWQobWUpOw0KICAgICAgICAgICAgICAgIGlmICh1dCAmJiB1dC5zZWxlY3RlZFRkcy5sZW5ndGgpIHsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAodXQuaXNGdWxsQ29sKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lLmV4ZWNDb21tYW5kKCdkZWxldGVjb2wnKQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHV0LmlzRnVsbFJvdygpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBtZS5leGVjQ29tbWFuZCgnZGVsZXRlcm93JykNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnZGVsY2VsbHMnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5wcmV2ZW50RGVmYXVsdChldnQpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHZhciBjYXB0aW9uID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShtZS5zZWxlY3Rpb24uZ2V0U3RhcnQoKSwgJ2NhcHRpb24nLCB0cnVlKSwNCiAgICAgICAgICAgICAgICAgICAgcmFuZ2UgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKTsNCiAgICAgICAgICAgICAgICBpZiAocmFuZ2UuY29sbGFwc2VkICYmIGNhcHRpb24gJiYgaXNFbXB0eUJsb2NrKGNhcHRpb24pKSB7DQogICAgICAgICAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnc2F2ZVNjZW5lJyk7DQogICAgICAgICAgICAgICAgICAgIHZhciB0YWJsZSA9IGNhcHRpb24ucGFyZW50Tm9kZTsNCiAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKGNhcHRpb24pOw0KICAgICAgICAgICAgICAgICAgICBpZiAodGFibGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KHRhYmxlLnJvd3NbMF0uY2VsbHNbMF0sIDApLnNldEN1cnNvcihmYWxzZSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCdzYXZlU2NlbmUnKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKGtleUNvZGUgPT0gNDYpIHsNCg0KICAgICAgICAgICAgICAgIHV0ID0gZ2V0VUVUYWJsZUJ5U2VsZWN0ZWQobWUpOw0KICAgICAgICAgICAgICAgIGlmICh1dCkgew0KICAgICAgICAgICAgICAgICAgICBtZS5maXJlRXZlbnQoJ3NhdmVTY2VuZScpOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgY2k7IGNpID0gdXQuc2VsZWN0ZWRUZHNbaSsrXTspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLmZpbGxOb2RlKG1lLmRvY3VtZW50LCBjaSkNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBtZS5maXJlRXZlbnQoJ3NhdmVTY2VuZScpOw0KICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5wcmV2ZW50RGVmYXVsdChldnQpOw0KDQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoa2V5Q29kZSA9PSAxMykgew0KDQogICAgICAgICAgICAgICAgdmFyIHJuZyA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpLA0KICAgICAgICAgICAgICAgICAgICBjYXB0aW9uID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShybmcuc3RhcnRDb250YWluZXIsICdjYXB0aW9uJywgdHJ1ZSk7DQogICAgICAgICAgICAgICAgaWYgKGNhcHRpb24pIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShjYXB0aW9uLCAndGFibGUnKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCFybmcuY29sbGFwc2VkKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHJuZy5kZWxldGVDb250ZW50cygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCdzYXZlU2NlbmUnKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYXB0aW9uKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcm5nLnNldFN0YXJ0KHRhYmxlLnJvd3NbMF0uY2VsbHNbMF0sIDApLnNldEN1cnNvcihmYWxzZSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucHJldmVudERlZmF1bHQoZXZ0KTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAocm5nLmNvbGxhcHNlZCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGUgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKHJuZy5zdGFydENvbnRhaW5lciwgJ3RhYmxlJyk7DQogICAgICAgICAgICAgICAgICAgIGlmICh0YWJsZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNlbGwgPSB0YWJsZS5yb3dzWzBdLmNlbGxzWzBdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShtZS5zZWxlY3Rpb24uZ2V0U3RhcnQoKSwgWyd0ZCcsICd0aCddLCB0cnVlKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVOb2RlID0gdGFibGUucHJldmlvdXNTaWJsaW5nOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNlbGwgPT09IHN0YXJ0ICYmICghcHJlTm9kZSB8fCBwcmVOb2RlLm5vZGVUeXBlID09IDEgJiYgcHJlTm9kZS50YWdOYW1lID09ICdUQUJMRScgKSAmJiBkb21VdGlscy5pc1N0YXJ0SW5ibG9jayhybmcpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpcnN0ID0gZG9tVXRpbHMuZmluZFBhcmVudChtZS5zZWxlY3Rpb24uZ2V0U3RhcnQoKSwgZnVuY3Rpb24obil7cmV0dXJuIGRvbVV0aWxzLmlzQmxvY2tFbG0obil9LCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihmaXJzdCAmJiAoIC90KGh8ZCkvaS50ZXN0KGZpcnN0LnRhZ05hbWUpIHx8IGZpcnN0ID09PSAgc3RhcnQuZmlyc3RDaGlsZCApKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUuZXhlY0NvbW1hbmQoJ2luc2VydHBhcmFncmFwaGJlZm9yZXRhYmxlJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnByZXZlbnREZWZhdWx0KGV2dCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICgoZXZ0LmN0cmxLZXkgfHwgZXZ0Lm1ldGFLZXkpICYmIGV2dC5rZXlDb2RlID09ICc2NycpIHsNCiAgICAgICAgICAgICAgICB0YWJsZUNvcHlMaXN0ID0gbnVsbDsNCiAgICAgICAgICAgICAgICB2YXIgdXQgPSBnZXRVRVRhYmxlQnlTZWxlY3RlZChtZSk7DQogICAgICAgICAgICAgICAgaWYgKHV0KSB7DQogICAgICAgICAgICAgICAgICAgIHZhciB0ZHMgPSB1dC5zZWxlY3RlZFRkczsNCiAgICAgICAgICAgICAgICAgICAgaXNGdWxsQ29sID0gdXQuaXNGdWxsQ29sKCk7DQogICAgICAgICAgICAgICAgICAgIGlzRnVsbFJvdyA9IHV0LmlzRnVsbFJvdygpOw0KICAgICAgICAgICAgICAgICAgICB0YWJsZUNvcHlMaXN0ID0gWw0KICAgICAgICAgICAgICAgICAgICAgICAgW3V0LmNsb25lQ2VsbCh0ZHNbMF0sbnVsbCx0cnVlKV0NCiAgICAgICAgICAgICAgICAgICAgXTsNCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDEsIGNpOyBjaSA9IHRkc1tpXTsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2kucGFyZW50Tm9kZSAhPT0gdGRzW2kgLSAxXS5wYXJlbnROb2RlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDb3B5TGlzdC5wdXNoKFt1dC5jbG9uZUNlbGwoY2ksbnVsbCx0cnVlKV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUNvcHlMaXN0W3RhYmxlQ29weUxpc3QubGVuZ3RoIC0gMV0ucHVzaCh1dC5jbG9uZUNlbGwoY2ksbnVsbCx0cnVlKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICAgIG1lLmFkZExpc3RlbmVyKCJ0YWJsZWhhc2RlbGV0ZWQiLGZ1bmN0aW9uKCl7DQogICAgICAgICAgICB0b2dnbGVEcmFnZ2FibGVTdGF0ZSh0aGlzLCBmYWxzZSwgIiIsIG51bGwpOw0KICAgICAgICAgICAgaWYgKGRyYWdCdXR0b24pZG9tVXRpbHMucmVtb3ZlKGRyYWdCdXR0b24pOw0KICAgICAgICB9KTsNCg0KICAgICAgICBtZS5hZGRMaXN0ZW5lcignYmVmb3JlcGFzdGUnLCBmdW5jdGlvbiAoY21kLCBodG1sKSB7DQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzOw0KICAgICAgICAgICAgdmFyIHJuZyA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpOw0KICAgICAgICAgICAgaWYgKGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUocm5nLnN0YXJ0Q29udGFpbmVyLCAnY2FwdGlvbicsIHRydWUpKSB7DQogICAgICAgICAgICAgICAgdmFyIGRpdiA9IG1lLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOw0KICAgICAgICAgICAgICAgIGRpdi5pbm5lckhUTUwgPSBodG1sLmh0bWw7DQogICAgICAgICAgICAgICAgaHRtbC5odG1sID0gZGl2W2Jyb3dzZXIuaWUgPyAnaW5uZXJUZXh0JyA6ICd0ZXh0Q29udGVudCddOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZhciB0YWJsZSA9IGdldFVFVGFibGVCeVNlbGVjdGVkKG1lKTsNCiAgICAgICAgICAgIGlmICh0YWJsZUNvcHlMaXN0KSB7DQogICAgICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCdzYXZlU2NlbmUnKTsNCiAgICAgICAgICAgICAgICB2YXIgcm5nID0gbWUuc2VsZWN0aW9uLmdldFJhbmdlKCk7DQogICAgICAgICAgICAgICAgdmFyIHRkID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShybmcuc3RhcnRDb250YWluZXIsIFsndGQnLCAndGgnXSwgdHJ1ZSksIHRtcE5vZGUsIHByZU5vZGU7DQogICAgICAgICAgICAgICAgaWYgKHRkKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciB1dCA9IGdldFVFVGFibGUodGQpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoaXNGdWxsUm93KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm93SW5kZXggPSB1dC5nZXRDZWxsSW5mbyh0ZCkucm93SW5kZXg7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGQudGFnTmFtZSA9PSAnVEgnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93SW5kZXgrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjaTsgY2kgPSB0YWJsZUNvcHlMaXN0W2krK107KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRyID0gdXQuaW5zZXJ0Um93KHJvd0luZGV4KyssICJ0ZCIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwLCBjajsgY2ogPSBjaVtqXTsgaisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjZWxsID0gdHIuY2VsbHNbal07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY2VsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2VsbCA9IHRyLmluc2VydENlbGwoaikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZWxsLmlubmVySFRNTCA9IGNqLmlubmVySFRNTDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2ouZ2V0QXR0cmlidXRlKCd3aWR0aCcpICYmIGNlbGwuc2V0QXR0cmlidXRlKCd3aWR0aCcsIGNqLmdldEF0dHJpYnV0ZSgnd2lkdGgnKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNqLmdldEF0dHJpYnV0ZSgndkFsaWduJykgJiYgY2VsbC5zZXRBdHRyaWJ1dGUoJ3ZBbGlnbicsIGNqLmdldEF0dHJpYnV0ZSgndkFsaWduJykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjai5nZXRBdHRyaWJ1dGUoJ2FsaWduJykgJiYgY2VsbC5zZXRBdHRyaWJ1dGUoJ2FsaWduJywgY2ouZ2V0QXR0cmlidXRlKCdhbGlnbicpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2ouc3R5bGUuY3NzVGV4dCAmJiAoY2VsbC5zdHlsZS5jc3NUZXh0ID0gY2ouc3R5bGUuY3NzVGV4dCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDAsIGNqOyBjaiA9IHRyLmNlbGxzW2pdOyBqKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjaVtqXSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjai5pbm5lckhUTUwgPSBjaVtqXS5pbm5lckhUTUw7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNpW2pdLmdldEF0dHJpYnV0ZSgnd2lkdGgnKSAmJiBjai5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgY2lbal0uZ2V0QXR0cmlidXRlKCd3aWR0aCcpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2lbal0uZ2V0QXR0cmlidXRlKCd2QWxpZ24nKSAmJiBjai5zZXRBdHRyaWJ1dGUoJ3ZBbGlnbicsIGNpW2pdLmdldEF0dHJpYnV0ZSgndkFsaWduJykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaVtqXS5nZXRBdHRyaWJ1dGUoJ2FsaWduJykgJiYgY2ouc2V0QXR0cmlidXRlKCdhbGlnbicsIGNpW2pdLmdldEF0dHJpYnV0ZSgnYWxpZ24nKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNpW2pdLnN0eWxlLmNzc1RleHQgJiYgKGNqLnN0eWxlLmNzc1RleHQgPSBjaVtqXS5zdHlsZS5jc3NUZXh0KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0Z1bGxDb2wpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZWxsSW5mbyA9IHV0LmdldENlbGxJbmZvKHRkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWF4Q29sTnVtID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgY2kgPSB0YWJsZUNvcHlMaXN0WzBdLCBjajsgY2ogPSBjaVtqKytdOykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhDb2xOdW0gKz0gY2ouY29sU3BhbiB8fCAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZS5fX2hhc0VudGVyRXhlY0NvbW1hbmQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBtYXhDb2xOdW07IGkrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZS5leGVjQ29tbWFuZCgnaW5zZXJ0Y29sJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lLl9faGFzRW50ZXJFeGVjQ29tbWFuZCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRkID0gdXQudGFibGUucm93c1swXS5jZWxsc1tjZWxsSW5mby5jZWxsSW5kZXhdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZC50YWdOYW1lID09ICdUSCcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGQgPSB1dC50YWJsZS5yb3dzWzFdLmNlbGxzW2NlbGxJbmZvLmNlbGxJbmRleF07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNpOyBjaSA9IHRhYmxlQ29weUxpc3RbaSsrXTspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBOb2RlID0gdGQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDAsIGNqOyBjaiA9IGNpW2orK107KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGQuaW5uZXJIVE1MID0gY2ouaW5uZXJIVE1MOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy90b2RvIOWumuWItuWkhOeQhg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2ouZ2V0QXR0cmlidXRlKCd3aWR0aCcpICYmIHRkLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCBjai5nZXRBdHRyaWJ1dGUoJ3dpZHRoJykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2ouZ2V0QXR0cmlidXRlKCd2QWxpZ24nKSAmJiB0ZC5zZXRBdHRyaWJ1dGUoJ3ZBbGlnbicsIGNqLmdldEF0dHJpYnV0ZSgndkFsaWduJykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2ouZ2V0QXR0cmlidXRlKCdhbGlnbicpICYmIHRkLnNldEF0dHJpYnV0ZSgnYWxpZ24nLCBjai5nZXRBdHRyaWJ1dGUoJ2FsaWduJykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2ouc3R5bGUuY3NzVGV4dCAmJiAodGQuc3R5bGUuY3NzVGV4dCA9IGNqLnN0eWxlLmNzc1RleHQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlTm9kZSA9IHRkOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGQgPSB0ZC5uZXh0U2libGluZzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjbG9uZVRkID0gY2ouY2xvbmVOb2RlKHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlQXR0cmlidXRlcyhjbG9uZVRkLCBbJ2NsYXNzJywgJ3Jvd1NwYW4nLCAnY29sU3BhbiddKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlTm9kZS5wYXJlbnROb2RlLmFwcGVuZENoaWxkKGNsb25lVGQpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGQgPSB1dC5nZXROZXh0Q2VsbCh0bXBOb2RlLCB0cnVlLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRhYmxlQ29weUxpc3RbaV0pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNlbGxJbmZvID0gdXQuZ2V0Q2VsbEluZm8odG1wTm9kZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0LnRhYmxlLmluc2VydFJvdyh1dC50YWJsZS5yb3dzLmxlbmd0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0LnVwZGF0ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZCA9IHV0LmdldFZTaWRlQ2VsbCh0bXBOb2RlLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdXQudXBkYXRlKCk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgdGFibGUgPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0YWJsZScpOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgY2k7IGNpID0gdGFibGVDb3B5TGlzdFtpKytdOykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRyID0gdGFibGUuaW5zZXJ0Um93KHRhYmxlLnJvd3MubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwLCBjajsgY2ogPSBjaVtqKytdOykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb25lVGQgPSBVVC5jbG9uZUNlbGwoY2osbnVsbCx0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmVBdHRyaWJ1dGVzKGNsb25lVGQsIFsnY2xhc3MnXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHIuYXBwZW5kQ2hpbGQoY2xvbmVUZCkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqID09IDIgJiYgY2xvbmVUZC5yb3dTcGFuID4gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb25lVGQucm93U3BhbiA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICB2YXIgZGVmYXVsdFZhbHVlID0gZ2V0RGVmYXVsdFZhbHVlKG1lKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoID0gbWUuYm9keS5vZmZzZXRXaWR0aCAtDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKG5lZWRJRUhhY2sgPyBwYXJzZUludChkb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKG1lLmJvZHksICdtYXJnaW4tbGVmdCcpLCAxMCkgKiAyIDogMCkgLSBkZWZhdWx0VmFsdWUudGFibGVCb3JkZXIgKiAyIC0gKG1lLm9wdGlvbnMub2Zmc2V0V2lkdGggfHwgMCk7DQogICAgICAgICAgICAgICAgICAgIG1lLmV4ZWNDb21tYW5kKCdpbnNlcnRIVE1MJywgJzx0YWJsZSAgJyArDQogICAgICAgICAgICAgICAgICAgICAgICAoIGlzRnVsbENvbCAmJiBpc0Z1bGxSb3cgPyAnd2lkdGg9IicgKyB3aWR0aCArICciJyA6ICcnKSArDQogICAgICAgICAgICAgICAgICAgICAgICAnPicgKyB0YWJsZS5pbm5lckhUTUwucmVwbGFjZSgvPlxzKjwvZywgJz48JykucmVwbGFjZSgvXGJ0aFxiL2dpLCAidGQiKSArICc8L3RhYmxlPicpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnY29udGVudGNoYW5nZScpOw0KICAgICAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnc2F2ZVNjZW5lJyk7DQogICAgICAgICAgICAgICAgaHRtbC5odG1sID0gJyc7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHZhciBkaXYgPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSwgdGFibGVzOw0KICAgICAgICAgICAgICAgIGRpdi5pbm5lckhUTUwgPSBodG1sLmh0bWw7DQogICAgICAgICAgICAgICAgdGFibGVzID0gZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0YWJsZSIpOw0KICAgICAgICAgICAgICAgIGlmIChkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKG1lLnNlbGVjdGlvbi5nZXRTdGFydCgpLCAndGFibGUnKSkgew0KICAgICAgICAgICAgICAgICAgICB1dGlscy5lYWNoKHRhYmxlcywgZnVuY3Rpb24gKHQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZSh0KQ0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUobWUuc2VsZWN0aW9uLmdldFN0YXJ0KCksICdjYXB0aW9uJywgdHJ1ZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5pbm5lckhUTUwgPSBkaXZbYnJvd3Nlci5pZSA/ICdpbm5lclRleHQnIDogJ3RleHRDb250ZW50J107DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICB1dGlscy5lYWNoKHRhYmxlcywgZnVuY3Rpb24gKHRhYmxlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVTdHlsZVNpemUodGFibGUsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlQXR0cmlidXRlcyh0YWJsZSwgWydzdHlsZScsICdib3JkZXInXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB1dGlscy5lYWNoKGRvbVV0aWxzLmdldEVsZW1lbnRzQnlUYWdOYW1lKHRhYmxlLCAidGQiKSwgZnVuY3Rpb24gKHRkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzRW1wdHlCbG9jayh0ZCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMuZmlsbE5vZGUobWUuZG9jdW1lbnQsIHRkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlU3R5bGVTaXplKHRkLCB0cnVlKTsNCi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZUF0dHJpYnV0ZXModGQsIFsnc3R5bGUnXSkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaHRtbC5odG1sID0gZGl2LmlubmVySFRNTDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQoNCiAgICAgICAgbWUuYWRkTGlzdGVuZXIoJ2FmdGVycGFzdGUnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB1dGlscy5lYWNoKGRvbVV0aWxzLmdldEVsZW1lbnRzQnlUYWdOYW1lKG1lLmJvZHksICJ0YWJsZSIpLCBmdW5jdGlvbiAodGFibGUpIHsNCiAgICAgICAgICAgICAgICBpZiAodGFibGUub2Zmc2V0V2lkdGggPiBtZS5ib2R5Lm9mZnNldFdpZHRoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBkZWZhdWx0VmFsdWUgPSBnZXREZWZhdWx0VmFsdWUobWUsIHRhYmxlKTsNCiAgICAgICAgICAgICAgICAgICAgdGFibGUuc3R5bGUud2lkdGggPSBtZS5ib2R5Lm9mZnNldFdpZHRoIC0gKG5lZWRJRUhhY2sgPyBwYXJzZUludChkb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKG1lLmJvZHksICdtYXJnaW4tbGVmdCcpLCAxMCkgKiAyIDogMCkgLSBkZWZhdWx0VmFsdWUudGFibGVCb3JkZXIgKiAyIC0gKG1lLm9wdGlvbnMub2Zmc2V0V2lkdGggfHwgMCkgKyAncHgnDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgfSk7DQogICAgICAgIG1lLmFkZExpc3RlbmVyKCdibHVyJywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdGFibGVDb3B5TGlzdCA9IG51bGw7DQogICAgICAgIH0pOw0KICAgICAgICB2YXIgdGltZXI7DQogICAgICAgIG1lLmFkZExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTsNCiAgICAgICAgICAgIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgdmFyIHJuZyA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpLA0KICAgICAgICAgICAgICAgICAgICBjZWxsID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShybmcuc3RhcnRDb250YWluZXIsIFsndGgnLCAndGQnXSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgaWYgKGNlbGwpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlID0gY2VsbC5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHRhYmxlLm9mZnNldFdpZHRoID4gdGFibGUuZ2V0QXR0cmlidXRlKCJ3aWR0aCIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjZWxsLnN0eWxlLndvcmRCcmVhayA9ICJicmVhay1hbGwiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB9LCAxMDApOw0KICAgICAgICB9KTsNCiAgICAgICAgbWUuYWRkTGlzdGVuZXIoInNlbGVjdGlvbmNoYW5nZSIsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHRvZ2dsZURyYWdnYWJsZVN0YXRlKG1lLCBmYWxzZSwgIiIsIG51bGwpOw0KICAgICAgICB9KTsNCg0KDQogICAgICAgIC8v5YaF5a655Y+Y5YyW5pe26Kem5Y+R57Si5byV5pu05pawDQogICAgICAgIC8vdG9kbyDlj6/lkKbogIPomZHmoIforrDmo4DmtYvvvIzlpoLmnpzkuI3mtonlj4rooajmoLznmoTlj5jljJblsLHkuI3ov5vooYzntKLlvJXph43lu7rlkozmm7TmlrANCiAgICAgICAgbWUuYWRkTGlzdGVuZXIoImNvbnRlbnRjaGFuZ2UiLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzOw0KICAgICAgICAgICAgLy/lsL3lj6/og73mjpLpmaTkuIDkupvkuI3pnIDopoHmm7TmlrDnmoTnirblhrUNCiAgICAgICAgICAgIGhpZGVEcmFnTGluZShtZSk7DQogICAgICAgICAgICBpZiAoZ2V0VUVUYWJsZUJ5U2VsZWN0ZWQobWUpKXJldHVybjsNCiAgICAgICAgICAgIHZhciBybmcgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKTsNCiAgICAgICAgICAgIHZhciBzdGFydCA9IHJuZy5zdGFydENvbnRhaW5lcjsNCiAgICAgICAgICAgIHN0YXJ0ID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShzdGFydCwgWyd0ZCcsICd0aCddLCB0cnVlKTsNCiAgICAgICAgICAgIHV0aWxzLmVhY2goZG9tVXRpbHMuZ2V0RWxlbWVudHNCeVRhZ05hbWUobWUuZG9jdW1lbnQsICd0YWJsZScpLCBmdW5jdGlvbiAodGFibGUpIHsNCiAgICAgICAgICAgICAgICBpZiAobWUuZmlyZUV2ZW50KCJleGNsdWRldGFibGUiLCB0YWJsZSkgPT09IHRydWUpIHJldHVybjsNCiAgICAgICAgICAgICAgICB0YWJsZS51ZVRhYmxlID0gbmV3IFVUKHRhYmxlKTsNCiAgICAgICAgICAgICAgICB1dGlscy5lYWNoKGRvbVV0aWxzLmdldEVsZW1lbnRzQnlUYWdOYW1lKG1lLmRvY3VtZW50LCAndGQnKSwgZnVuY3Rpb24gKHRkKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKGRvbVV0aWxzLmlzRW1wdHlCbG9jayh0ZCkgJiYgdGQgIT09IHN0YXJ0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5maWxsTm9kZShtZS5kb2N1bWVudCwgdGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJyb3dzZXIuaWUgJiYgYnJvd3Nlci52ZXJzaW9uID09IDYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZC5pbm5lckhUTUwgPSAnJm5ic3A7Jw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgdXRpbHMuZWFjaChkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZShtZS5kb2N1bWVudCwgJ3RoJyksIGZ1bmN0aW9uICh0aCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoZG9tVXRpbHMuaXNFbXB0eUJsb2NrKHRoKSAmJiB0aCAhPT0gc3RhcnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLmZpbGxOb2RlKG1lLmRvY3VtZW50LCB0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYnJvd3Nlci5pZSAmJiBicm93c2VyLnZlcnNpb24gPT0gNikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoLmlubmVySFRNTCA9ICcmbmJzcDsnDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB0YWJsZS5vbm1vdXNlb3ZlciA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCd0YWJsZW1vdXNlb3ZlcicsIHRhYmxlKTsNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIHRhYmxlLm9ubW91c2Vtb3ZlID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICBtZS5maXJlRXZlbnQoJ3RhYmxlbW91c2Vtb3ZlJywgdGFibGUpOw0KICAgICAgICAgICAgICAgICAgICBtZS5vcHRpb25zLnRhYmxlRHJhZ2FibGUgJiYgdG9nZ2xlRHJhZ0J1dHRvbih0cnVlLCB0aGlzLCBtZSk7DQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICB0YWJsZS5vbm1vdXNlb3V0ID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICBtZS5maXJlRXZlbnQoJ3RhYmxlbW91c2VvdXQnLCB0YWJsZSk7DQogICAgICAgICAgICAgICAgICAgIHRvZ2dsZURyYWdnYWJsZVN0YXRlKG1lLCBmYWxzZSwgIiIsIG51bGwpOw0KICAgICAgICAgICAgICAgICAgICBoaWRlRHJhZ0xpbmUobWUpOw0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgdGFibGUub25jbGljayA9IGZ1bmN0aW9uIChldnQpIHsNCiAgICAgICAgICAgICAgICAgICAgZXZ0ID0gbWUud2luZG93LmV2ZW50IHx8IGV2dDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGdldFBhcmVudFRkT3JUaChldnQudGFyZ2V0IHx8IGV2dC5zcmNFbGVtZW50KTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCF0YXJnZXQpcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB2YXIgdXQgPSBnZXRVRVRhYmxlKHRhcmdldCksDQogICAgICAgICAgICAgICAgICAgICAgICB0YWJsZSA9IHV0LnRhYmxlLA0KICAgICAgICAgICAgICAgICAgICAgICAgY2VsbEluZm8gPSB1dC5nZXRDZWxsSW5mbyh0YXJnZXQpLA0KICAgICAgICAgICAgICAgICAgICAgICAgY2VsbHNSYW5nZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHJuZyA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpOw0KLy8gICAgICAgICAgICAgICAgICAgIGlmICgidG9wTGVmdCIgPT0gaW5Qb3NpdGlvbih0YWJsZSwgbW91c2VDb29yZHMoZXZ0KSkpIHsNCi8vICAgICAgICAgICAgICAgICAgICAgICAgY2VsbHNSYW5nZSA9IHV0LmdldENlbGxzUmFuZ2UodXQudGFibGUucm93c1swXS5jZWxsc1swXSwgdXQuZ2V0TGFzdENlbGwoKSk7DQovLyAgICAgICAgICAgICAgICAgICAgICAgIHV0LnNldFNlbGVjdGVkKGNlbGxzUmFuZ2UpOw0KLy8gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQovLyAgICAgICAgICAgICAgICAgICAgfQ0KLy8gICAgICAgICAgICAgICAgICAgIGlmICgiYm90dG9tUmlnaHQiID09IGluUG9zaXRpb24odGFibGUsIG1vdXNlQ29vcmRzKGV2dCkpKSB7DQovLw0KLy8gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQovLyAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoaW5UYWJsZVNpZGUodGFibGUsIHRhcmdldCwgZXZ0LCB0cnVlKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVuZFRkQ29sID0gdXQuZ2V0Q2VsbCh1dC5pbmRleFRhYmxlW3V0LnJvd3NOdW0gLSAxXVtjZWxsSW5mby5jb2xJbmRleF0ucm93SW5kZXgsIHV0LmluZGV4VGFibGVbdXQucm93c051bSAtIDFdW2NlbGxJbmZvLmNvbEluZGV4XS5jZWxsSW5kZXgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2dC5zaGlmdEtleSAmJiB1dC5zZWxlY3RlZFRkcy5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodXQuc2VsZWN0ZWRUZHNbMF0gIT09IGVuZFRkQ29sKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbGxzUmFuZ2UgPSB1dC5nZXRDZWxsc1JhbmdlKHV0LnNlbGVjdGVkVGRzWzBdLCBlbmRUZENvbCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0LnNldFNlbGVjdGVkKGNlbGxzUmFuZ2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJuZyAmJiBybmcuc2VsZWN0Tm9kZUNvbnRlbnRzKGVuZFRkQ29sKS5zZWxlY3QoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXQgIT09IGVuZFRkQ29sKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbGxzUmFuZ2UgPSB1dC5nZXRDZWxsc1JhbmdlKHRhcmdldCwgZW5kVGRDb2wpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dC5zZXRTZWxlY3RlZChjZWxsc1JhbmdlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBybmcgJiYgcm5nLnNlbGVjdE5vZGVDb250ZW50cyhlbmRUZENvbCkuc2VsZWN0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmIChpblRhYmxlU2lkZSh0YWJsZSwgdGFyZ2V0LCBldnQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW5kVGRSb3cgPSB1dC5nZXRDZWxsKHV0LmluZGV4VGFibGVbY2VsbEluZm8ucm93SW5kZXhdW3V0LmNvbHNOdW0gLSAxXS5yb3dJbmRleCwgdXQuaW5kZXhUYWJsZVtjZWxsSW5mby5yb3dJbmRleF1bdXQuY29sc051bSAtIDFdLmNlbGxJbmRleCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZ0LnNoaWZ0S2V5ICYmIHV0LnNlbGVjdGVkVGRzLmxlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1dC5zZWxlY3RlZFRkc1swXSAhPT0gZW5kVGRSb3cpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2VsbHNSYW5nZSA9IHV0LmdldENlbGxzUmFuZ2UodXQuc2VsZWN0ZWRUZHNbMF0sIGVuZFRkUm93KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXQuc2V0U2VsZWN0ZWQoY2VsbHNSYW5nZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm5nICYmIHJuZy5zZWxlY3ROb2RlQ29udGVudHMoZW5kVGRSb3cpLnNlbGVjdCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldCAhPT0gZW5kVGRSb3cpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2VsbHNSYW5nZSA9IHV0LmdldENlbGxzUmFuZ2UodGFyZ2V0LCBlbmRUZFJvdyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0LnNldFNlbGVjdGVkKGNlbGxzUmFuZ2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJuZyAmJiBybmcuc2VsZWN0Tm9kZUNvbnRlbnRzKGVuZFRkUm93KS5zZWxlY3QoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIHN3aXRjaEJvcmRlckNvbG9yKG1lLCB0cnVlKTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgZG9tVXRpbHMub24obWUuZG9jdW1lbnQsICJtb3VzZW1vdmUiLCBtb3VzZU1vdmVFdmVudCk7DQoNCiAgICAgICAgZG9tVXRpbHMub24obWUuZG9jdW1lbnQsICJtb3VzZW91dCIsIGZ1bmN0aW9uIChldnQpIHsNCiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBldnQudGFyZ2V0IHx8IGV2dC5zcmNFbGVtZW50Ow0KICAgICAgICAgICAgaWYgKHRhcmdldC50YWdOYW1lID09ICJUQUJMRSIpIHsNCiAgICAgICAgICAgICAgICB0b2dnbGVEcmFnZ2FibGVTdGF0ZShtZSwgZmFsc2UsICIiLCBudWxsKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICAgIC8qKg0KICAgICAgICAgKiDooajmoLzpmpTooYzlj5joibINCiAgICAgICAgICovDQogICAgICAgIG1lLmFkZExpc3RlbmVyKCJpbnRlcmxhY2V0YWJsZSIsZnVuY3Rpb24odHlwZSx0YWJsZSxjbGFzc0xpc3Qpew0KICAgICAgICAgICAgaWYoIXRhYmxlKSByZXR1cm47DQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzLA0KICAgICAgICAgICAgICAgIHJvd3MgPSB0YWJsZS5yb3dzLA0KICAgICAgICAgICAgICAgIGxlbiA9IHJvd3MubGVuZ3RoLA0KICAgICAgICAgICAgICAgIGdldENsYXNzID0gZnVuY3Rpb24obGlzdCxpbmRleCxyZXBlYXQpew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGlzdFtpbmRleF0gPyBsaXN0W2luZGV4XSA6IHJlcGVhdCA/IGxpc3RbaW5kZXggJSBsaXN0Lmxlbmd0aF06ICIiOw0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICBmb3IodmFyIGkgPSAwO2k8bGVuO2krKyl7DQogICAgICAgICAgICAgICAgcm93c1tpXS5jbGFzc05hbWUgPSBnZXRDbGFzcyggY2xhc3NMaXN0fHwgbWUub3B0aW9ucy5jbGFzc0xpc3QsaSx0cnVlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICAgIG1lLmFkZExpc3RlbmVyKCJ1bmludGVybGFjZXRhYmxlIixmdW5jdGlvbih0eXBlLHRhYmxlKXsNCiAgICAgICAgICAgIGlmKCF0YWJsZSkgcmV0dXJuOw0KICAgICAgICAgICAgdmFyIG1lID0gdGhpcywNCiAgICAgICAgICAgICAgICByb3dzID0gdGFibGUucm93cywNCiAgICAgICAgICAgICAgICBjbGFzc0xpc3QgPSBtZS5vcHRpb25zLmNsYXNzTGlzdCwNCiAgICAgICAgICAgICAgICBsZW4gPSByb3dzLmxlbmd0aDsNCiAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7aTxsZW47aSsrKXsNCiAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmVDbGFzc2VzKCByb3dzW2ldLCBjbGFzc0xpc3QgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQoNCiAgICAgICAgbWUuYWRkTGlzdGVuZXIoIm1vdXNlZG93biIsIG1vdXNlRG93bkV2ZW50KTsNCiAgICAgICAgbWUuYWRkTGlzdGVuZXIoIm1vdXNldXAiLCBtb3VzZVVwRXZlbnQpOw0KICAgICAgICAvL+aLluWKqOeahOaXtuWAmeS4jeWHuuWPkW1vdXNldXANCiAgICAgICAgZG9tVXRpbHMub24oIG1lLmJvZHksICdkcmFnc3RhcnQnLCBmdW5jdGlvbiggZXZ0ICl7DQogICAgICAgICAgICBtb3VzZVVwRXZlbnQuY2FsbCggbWUsICdkcmFnc3RhcnQnLCBldnQgKTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgdmFyIGN1cnJlbnRSb3dJbmRleCA9IDA7DQogICAgICAgIG1lLmFkZExpc3RlbmVyKCJtb3VzZWRvd24iLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBjdXJyZW50Um93SW5kZXggPSAwOw0KICAgICAgICB9KTsNCiAgICAgICAgbWUuYWRkTGlzdGVuZXIoJ3RhYmtleWRvd24nLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgcmFuZ2UgPSB0aGlzLnNlbGVjdGlvbi5nZXRSYW5nZSgpLA0KICAgICAgICAgICAgICAgIGNvbW1vbiA9IHJhbmdlLmdldENvbW1vbkFuY2VzdG9yKHRydWUsIHRydWUpLA0KICAgICAgICAgICAgICAgIHRhYmxlID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShjb21tb24sICd0YWJsZScpOw0KICAgICAgICAgICAgaWYgKHRhYmxlKSB7DQogICAgICAgICAgICAgICAgaWYgKGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUoY29tbW9uLCAnY2FwdGlvbicsIHRydWUpKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBjZWxsID0gZG9tVXRpbHMuZ2V0RWxlbWVudHNCeVRhZ05hbWUodGFibGUsICd0aCB0ZCcpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoY2VsbCAmJiBjZWxsLmxlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQoY2VsbFswXSwgMCkuc2V0Q3Vyc29yKGZhbHNlLCB0cnVlKQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGNlbGwgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKGNvbW1vbiwgWyd0ZCcsICd0aCddLCB0cnVlKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHVhID0gZ2V0VUVUYWJsZShjZWxsKTsNCiAgICAgICAgICAgICAgICAgICAgY3VycmVudFJvd0luZGV4ID0gY2VsbC5yb3dTcGFuID4gMSA/IGN1cnJlbnRSb3dJbmRleCA6IHVhLmdldENlbGxJbmZvKGNlbGwpLnJvd0luZGV4Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgbmV4dENlbGwgPSB1YS5nZXRUYWJOZXh0Q2VsbChjZWxsLCBjdXJyZW50Um93SW5kZXgpOw0KICAgICAgICAgICAgICAgICAgICBpZiAobmV4dENlbGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0VtcHR5QmxvY2sobmV4dENlbGwpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQobmV4dENlbGwsIDApLnNldEN1cnNvcihmYWxzZSwgdHJ1ZSkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2VsZWN0Tm9kZUNvbnRlbnRzKG5leHRDZWxsKS5zZWxlY3QoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCdzYXZlU2NlbmUnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lLl9faGFzRW50ZXJFeGVjQ29tbWFuZCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmV4ZWNDb21tYW5kKCdpbnNlcnRyb3duZXh0Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICBtZS5fX2hhc0VudGVyRXhlY0NvbW1hbmQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlID0gdGhpcy5zZWxlY3Rpb24uZ2V0UmFuZ2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KHRhYmxlLnJvd3NbdGFibGUucm93cy5sZW5ndGggLSAxXS5jZWxsc1swXSwgMCkuc2V0Q3Vyc29yKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBtZS5maXJlRXZlbnQoJ3NhdmVTY2VuZScpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0pOw0KICAgICAgICBicm93c2VyLmllICYmIG1lLmFkZExpc3RlbmVyKCdzZWxlY3Rpb25jaGFuZ2UnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB0b2dnbGVEcmFnZ2FibGVTdGF0ZSh0aGlzLCBmYWxzZSwgIiIsIG51bGwpOw0KICAgICAgICB9KTsNCiAgICAgICAgbWUuYWRkTGlzdGVuZXIoImtleWRvd24iLCBmdW5jdGlvbiAodHlwZSwgZXZ0KSB7DQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzOw0KICAgICAgICAgICAgLy/lpITnkIblnKjooajmoLznmoTmnIDlkI7kuIDkuKrovpPlhaV0YWLkuqfnlJ/mlrDnmoTooajmoLwNCiAgICAgICAgICAgIHZhciBrZXlDb2RlID0gZXZ0LmtleUNvZGUgfHwgZXZ0LndoaWNoOw0KICAgICAgICAgICAgaWYgKGtleUNvZGUgPT0gOCB8fCBrZXlDb2RlID09IDQ2KSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdmFyIG5vdEN0cmxLZXkgPSAhZXZ0LmN0cmxLZXkgJiYgIWV2dC5tZXRhS2V5ICYmICFldnQuc2hpZnRLZXkgJiYgIWV2dC5hbHRLZXk7DQogICAgICAgICAgICBub3RDdHJsS2V5ICYmIHJlbW92ZVNlbGVjdGVkQ2xhc3MoZG9tVXRpbHMuZ2V0RWxlbWVudHNCeVRhZ05hbWUobWUuYm9keSwgInRkIikpOw0KICAgICAgICAgICAgdmFyIHV0ID0gZ2V0VUVUYWJsZUJ5U2VsZWN0ZWQobWUpOw0KICAgICAgICAgICAgaWYgKCF1dCkgcmV0dXJuOw0KICAgICAgICAgICAgbm90Q3RybEtleSAmJiB1dC5jbGVhclNlbGVjdGVkKCk7DQogICAgICAgIH0pOw0KDQogICAgICAgIG1lLmFkZExpc3RlbmVyKCJiZWZvcmVnZXRjb250ZW50IiwgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgc3dpdGNoQm9yZGVyQ29sb3IodGhpcywgZmFsc2UpOw0KICAgICAgICAgICAgYnJvd3Nlci5pZSAmJiB1dGlscy5lYWNoKHRoaXMuZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2NhcHRpb24nKSwgZnVuY3Rpb24gKGNpKSB7DQogICAgICAgICAgICAgICAgaWYgKGRvbVV0aWxzLmlzRW1wdHlOb2RlKGNpKSkgew0KICAgICAgICAgICAgICAgICAgICBjaS5pbm5lckhUTUwgPSAnJm5ic3A7Jw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9KTsNCiAgICAgICAgbWUuYWRkTGlzdGVuZXIoImFmdGVyZ2V0Y29udGVudCIsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHN3aXRjaEJvcmRlckNvbG9yKHRoaXMsIHRydWUpOw0KICAgICAgICB9KTsNCiAgICAgICAgbWUuYWRkTGlzdGVuZXIoImdldEFsbEh0bWwiLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICByZW1vdmVTZWxlY3RlZENsYXNzKG1lLmRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0ZCIpKTsNCiAgICAgICAgfSk7DQogICAgICAgIC8v5L+u5q2j5YWo5bGP54q25oCB5LiL5o+S5YWl55qE6KGo5qC85a695bqm5Zyo6Z2e5YWo5bGP54q25oCB5LiL5pKR5byA57yW6L6R5Zmo55qE5oOF5Ya1DQogICAgICAgIG1lLmFkZExpc3RlbmVyKCJmdWxsc2NyZWVuY2hhbmdlZCIsIGZ1bmN0aW9uICh0eXBlLCBmdWxsc2NyZWVuKSB7DQogICAgICAgICAgICBpZiAoIWZ1bGxzY3JlZW4pIHsNCiAgICAgICAgICAgICAgICB2YXIgcmF0aW8gPSB0aGlzLmJvZHkub2Zmc2V0V2lkdGggLyBkb2N1bWVudC5ib2R5Lm9mZnNldFdpZHRoLA0KICAgICAgICAgICAgICAgICAgICB0YWJsZXMgPSBkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZSh0aGlzLmJvZHksICJ0YWJsZSIpOw0KICAgICAgICAgICAgICAgIHV0aWxzLmVhY2godGFibGVzLCBmdW5jdGlvbiAodGFibGUpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHRhYmxlLm9mZnNldFdpZHRoIDwgbWUuYm9keS5vZmZzZXRXaWR0aCkgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB2YXIgdGRzID0gZG9tVXRpbHMuZ2V0RWxlbWVudHNCeVRhZ05hbWUodGFibGUsICJ0ZCIpLA0KICAgICAgICAgICAgICAgICAgICAgICAgYmFja1dpZHRocyA9IFtdOw0KICAgICAgICAgICAgICAgICAgICB1dGlscy5lYWNoKHRkcywgZnVuY3Rpb24gKHRkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiYWNrV2lkdGhzLnB1c2godGQub2Zmc2V0V2lkdGgpOw0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIHRkOyB0ZCA9IHRkc1tpXTsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0ZC5zZXRBdHRyaWJ1dGUoIndpZHRoIiwgTWF0aC5mbG9vcihiYWNrV2lkdGhzW2ldICogcmF0aW8pKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0YWJsZS5zZXRBdHRyaWJ1dGUoIndpZHRoIiwgTWF0aC5mbG9vcihnZXRUYWJsZVdpZHRoKG1lLCBuZWVkSUVIYWNrLCBnZXREZWZhdWx0VmFsdWUobWUpKSkpDQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KDQogICAgICAgIC8v6YeN5YaZZXhlY0NvbW1hbmTlkb3ku6TvvIznlKjkuo7lpITnkIbmoYbpgInml7bnmoTlpITnkIYNCiAgICAgICAgdmFyIG9sZEV4ZWNDb21tYW5kID0gbWUuZXhlY0NvbW1hbmQ7DQogICAgICAgIG1lLmV4ZWNDb21tYW5kID0gZnVuY3Rpb24gKGNtZCwgZGF0YXRhdCkgew0KDQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzLA0KICAgICAgICAgICAgICAgIGFyZ3MgPSBhcmd1bWVudHM7DQoNCiAgICAgICAgICAgIGNtZCA9IGNtZC50b0xvd2VyQ2FzZSgpOw0KICAgICAgICAgICAgdmFyIHV0ID0gZ2V0VUVUYWJsZUJ5U2VsZWN0ZWQobWUpLCB0ZHMsDQogICAgICAgICAgICAgICAgcmFuZ2UgPSBuZXcgZG9tLlJhbmdlKG1lLmRvY3VtZW50KSwNCiAgICAgICAgICAgICAgICBjbWRGdW4gPSBtZS5jb21tYW5kc1tjbWRdIHx8IFVFLmNvbW1hbmRzW2NtZF0sDQogICAgICAgICAgICAgICAgcmVzdWx0Ow0KICAgICAgICAgICAgaWYgKCFjbWRGdW4pIHJldHVybjsNCiAgICAgICAgICAgIGlmICh1dCAmJiAhY29tbWFuZHNbY21kXSAmJiAhY21kRnVuLm5vdE5lZWRVbmRvICYmICFtZS5fX2hhc0VudGVyRXhlY0NvbW1hbmQpIHsNCiAgICAgICAgICAgICAgICBtZS5fX2hhc0VudGVyRXhlY0NvbW1hbmQgPSB0cnVlOw0KICAgICAgICAgICAgICAgIG1lLmZpcmVFdmVudCgiYmVmb3JlZXhlY2NvbW1hbmQiLCBjbWQpOw0KICAgICAgICAgICAgICAgIHRkcyA9IHV0LnNlbGVjdGVkVGRzOw0KICAgICAgICAgICAgICAgIHZhciBsYXN0U3RhdGUgPSAtMiwgbGFzdFZhbHVlID0gLTIsIHZhbHVlLCBzdGF0ZTsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgdGQ7IHRkID0gdGRzW2ldOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGlzRW1wdHlCbG9jayh0ZCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KHRkLCAwKS5zZXRDdXJzb3IoZmFsc2UsIHRydWUpDQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZWxlY3ROb2RlKHRkKS5zZWxlY3QodHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSBtZS5xdWVyeUNvbW1hbmRTdGF0ZShjbWQpOw0KICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IG1lLnF1ZXJ5Q29tbWFuZFZhbHVlKGNtZCk7DQogICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZSAhPSAtMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxhc3RTdGF0ZSAhPT0gc3RhdGUgfHwgbGFzdFZhbHVlICE9PSB2YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lLl9pZ25vcmVDb250ZW50Q2hhbmdlID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBvbGRFeGVjQ29tbWFuZC5hcHBseShtZSwgYXJndW1lbnRzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZS5faWdub3JlQ29udGVudENoYW5nZSA9IGZhbHNlOw0KDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBsYXN0U3RhdGUgPSBtZS5xdWVyeUNvbW1hbmRTdGF0ZShjbWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFZhbHVlID0gbWUucXVlcnlDb21tYW5kVmFsdWUoY21kKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb21VdGlscy5pc0VtcHR5QmxvY2sodGQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMuZmlsbE5vZGUobWUuZG9jdW1lbnQsIHRkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KHRkc1swXSwgMCkuc2hyaW5rQm91bmRhcnkodHJ1ZSkuc2V0Q3Vyc29yKGZhbHNlLCB0cnVlKTsNCiAgICAgICAgICAgICAgICBtZS5maXJlRXZlbnQoJ2NvbnRlbnRjaGFuZ2UnKTsNCiAgICAgICAgICAgICAgICBtZS5maXJlRXZlbnQoImFmdGVyZXhlY2NvbW1hbmQiLCBjbWQpOw0KICAgICAgICAgICAgICAgIG1lLl9faGFzRW50ZXJFeGVjQ29tbWFuZCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgIG1lLl9zZWxlY3Rpb25DaGFuZ2UoKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmVzdWx0ID0gb2xkRXhlY0NvbW1hbmQuYXBwbHkobWUsIGFyZ3VtZW50cyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gcmVzdWx0Ow0KICAgICAgICB9Ow0KDQoNCiAgICB9KTsNCiAgICAvKioNCiAgICAgKiDliKDpmaRvYmrnmoTlrr3pq5hzdHlsZe+8jOaUueaIkOWxnuaAp+WuvemrmA0KICAgICAqIEBwYXJhbSBvYmoNCiAgICAgKiBAcGFyYW0gcmVwbGFjZVRvUHJvcGVydHkNCiAgICAgKi8NCiAgICBmdW5jdGlvbiByZW1vdmVTdHlsZVNpemUob2JqLCByZXBsYWNlVG9Qcm9wZXJ0eSkgew0KICAgICAgICByZW1vdmVTdHlsZShvYmosICJ3aWR0aCIsIHRydWUpOw0KICAgICAgICByZW1vdmVTdHlsZShvYmosICJoZWlnaHQiLCB0cnVlKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiByZW1vdmVTdHlsZShvYmosIHN0eWxlTmFtZSwgcmVwbGFjZVRvUHJvcGVydHkpIHsNCiAgICAgICAgaWYgKG9iai5zdHlsZVtzdHlsZU5hbWVdKSB7DQogICAgICAgICAgICByZXBsYWNlVG9Qcm9wZXJ0eSAmJiBvYmouc2V0QXR0cmlidXRlKHN0eWxlTmFtZSwgcGFyc2VJbnQob2JqLnN0eWxlW3N0eWxlTmFtZV0sIDEwKSk7DQogICAgICAgICAgICBvYmouc3R5bGVbc3R5bGVOYW1lXSA9ICIiOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZ2V0UGFyZW50VGRPclRoKGVsZSkgew0KICAgICAgICBpZiAoZWxlLnRhZ05hbWUgPT0gIlREIiB8fCBlbGUudGFnTmFtZSA9PSAiVEgiKSByZXR1cm4gZWxlOw0KICAgICAgICB2YXIgdGQ7DQogICAgICAgIGlmICh0ZCA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUoZWxlLCAidGQiLCB0cnVlKSB8fCBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKGVsZSwgInRoIiwgdHJ1ZSkpIHJldHVybiB0ZDsNCiAgICAgICAgcmV0dXJuIG51bGw7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gaXNFbXB0eUJsb2NrKG5vZGUpIHsNCiAgICAgICAgdmFyIHJlZyA9IG5ldyBSZWdFeHAoZG9tVXRpbHMuZmlsbENoYXIsICdnJyk7DQogICAgICAgIGlmIChub2RlW2Jyb3dzZXIuaWUgPyAnaW5uZXJUZXh0JyA6ICd0ZXh0Q29udGVudCddLnJlcGxhY2UoL15ccyokLywgJycpLnJlcGxhY2UocmVnLCAnJykubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgIH0NCiAgICAgICAgZm9yICh2YXIgbiBpbiBkdGQuJGlzTm90RW1wdHkpIHsNCiAgICAgICAgICAgIGlmIChub2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKG4pLmxlbmd0aCkgew0KICAgICAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiAxOw0KICAgIH0NCg0KDQogICAgZnVuY3Rpb24gbW91c2VDb29yZHMoZXZ0KSB7DQogICAgICAgIGlmIChldnQucGFnZVggfHwgZXZ0LnBhZ2VZKSB7DQogICAgICAgICAgICByZXR1cm4geyB4OmV2dC5wYWdlWCwgeTpldnQucGFnZVkgfTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgeDpldnQuY2xpZW50WCArIG1lLmRvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdCAtIG1lLmRvY3VtZW50LmJvZHkuY2xpZW50TGVmdCwNCiAgICAgICAgICAgIHk6ZXZ0LmNsaWVudFkgKyBtZS5kb2N1bWVudC5ib2R5LnNjcm9sbFRvcCAtIG1lLmRvY3VtZW50LmJvZHkuY2xpZW50VG9wDQogICAgICAgIH07DQogICAgfQ0KDQogICAgZnVuY3Rpb24gbW91c2VNb3ZlRXZlbnQoZXZ0KSB7DQoNCiAgICAgICAgaWYoIGlzRWRpdG9yRGlzYWJsZWQoKSApIHsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgIHRyeSB7DQoNCiAgICAgICAgICAgIC8v5pmu6YCa54q25oCB5LiL6byg5qCH56e75YqoDQogICAgICAgICAgICB2YXIgdGFyZ2V0ID0gZ2V0UGFyZW50VGRPclRoKGV2dC50YXJnZXQgfHwgZXZ0LnNyY0VsZW1lbnQpLA0KICAgICAgICAgICAgICAgIHBvczsNCg0KICAgICAgICAgICAgLy/ljLrliIbnlKjmiLfnmoTooYzkuLrmmK/mi5bliqjov5jmmK/lj4zlh7sNCiAgICAgICAgICAgIGlmKCBpc0luUmVzaXplQnVmZmVyICApIHsNCg0KICAgICAgICAgICAgICAgIG1lLmJvZHkuc3R5bGUud2Via2l0VXNlclNlbGVjdCA9ICdub25lJzsNCg0KICAgICAgICAgICAgICAgIGlmKCBNYXRoLmFicyggdXNlckFjdGlvblN0YXR1cy54IC0gZXZ0LmNsaWVudFggKSA+IG9mZnNldE9mVGFibGVDZWxsIHx8IE1hdGguYWJzKCB1c2VyQWN0aW9uU3RhdHVzLnkgLSBldnQuY2xpZW50WSApID4gb2Zmc2V0T2ZUYWJsZUNlbGwgKSB7DQogICAgICAgICAgICAgICAgICAgIGNsZWFyVGFibGVEcmFnVGltZXIoKTsNCiAgICAgICAgICAgICAgICAgICAgaXNJblJlc2l6ZUJ1ZmZlciA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICBzaW5nbGVDbGlja1N0YXRlID0gMDsNCiAgICAgICAgICAgICAgICAgICAgLy9kcmFnIGFjdGlvbg0KICAgICAgICAgICAgICAgICAgICB0YWJsZUJvcmRlckRyYWcoZXZ0KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8v5L+u5pS55Y2V5YWD5qC85aSn5bCP5pe255qE6byg5qCH56e75YqoDQogICAgICAgICAgICBpZiAob25EcmFnICYmIGRyYWdUZCkgew0KICAgICAgICAgICAgICAgIHNpbmdsZUNsaWNrU3RhdGUgPSAwOw0KICAgICAgICAgICAgICAgIG1lLmJvZHkuc3R5bGUud2Via2l0VXNlclNlbGVjdCA9ICdub25lJzsNCiAgICAgICAgICAgICAgICBtZS5zZWxlY3Rpb24uZ2V0TmF0aXZlKClbYnJvd3Nlci5pZSA/ICdlbXB0eScgOiAncmVtb3ZlQWxsUmFuZ2VzJ10oKTsNCiAgICAgICAgICAgICAgICBwb3MgPSBtb3VzZUNvb3JkcyhldnQpOw0KICAgICAgICAgICAgICAgIHRvZ2dsZURyYWdnYWJsZVN0YXRlKG1lLCB0cnVlLCBvbkRyYWcsIHBvcywgdGFyZ2V0KTsNCiAgICAgICAgICAgICAgICBpZiAob25EcmFnID09ICJoIikgew0KICAgICAgICAgICAgICAgICAgICBkcmFnTGluZS5zdHlsZS5sZWZ0ID0gZ2V0UGVybWlzc2lvblgoZHJhZ1RkLCBldnQpICsgInB4IjsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG9uRHJhZyA9PSAidiIpIHsNCiAgICAgICAgICAgICAgICAgICAgZHJhZ0xpbmUuc3R5bGUudG9wID0gZ2V0UGVybWlzc2lvblkoZHJhZ1RkLCBldnQpICsgInB4IjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy/lvZPpvKDmoIflpITkuo50YWJsZeS4iuaXtu+8jOS/ruaUueenu+WKqOi/h+eoi+S4reeahOWFieagh+eKtuaAgQ0KICAgICAgICAgICAgaWYgKHRhcmdldCkgew0KICAgICAgICAgICAgICAgIC8v6ZKI5a+55L2/55SodGFibGXkvZzkuLrlrrnlmajnmoTnu4Tku7bkuI3op6blj5Hmi5bmi73mlYjmnpwNCiAgICAgICAgICAgICAgICBpZiAobWUuZmlyZUV2ZW50KCdleGNsdWRldGFibGUnLCB0YXJnZXQpID09PSB0cnVlKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgcG9zID0gbW91c2VDb29yZHMoZXZ0KTsNCiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBnZXRSZWxhdGlvbih0YXJnZXQsIHBvcyksDQogICAgICAgICAgICAgICAgICAgIHRhYmxlID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZSh0YXJnZXQsICJ0YWJsZSIsIHRydWUpOw0KDQogICAgICAgICAgICAgICAgaWYgKGluVGFibGVTaWRlKHRhYmxlLCB0YXJnZXQsIGV2dCwgdHJ1ZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKG1lLmZpcmVFdmVudCgiZXhjbHVkZXRhYmxlIiwgdGFibGUpID09PSB0cnVlKSByZXR1cm47DQogICAgICAgICAgICAgICAgICAgIG1lLmJvZHkuc3R5bGUuY3Vyc29yID0gInVybCgiICsgbWUub3B0aW9ucy5jdXJzb3JwYXRoICsgImgucG5nKSxwb2ludGVyIjsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluVGFibGVTaWRlKHRhYmxlLCB0YXJnZXQsIGV2dCkpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKG1lLmZpcmVFdmVudCgiZXhjbHVkZXRhYmxlIiwgdGFibGUpID09PSB0cnVlKSByZXR1cm47DQogICAgICAgICAgICAgICAgICAgIG1lLmJvZHkuc3R5bGUuY3Vyc29yID0gInVybCgiICsgbWUub3B0aW9ucy5jdXJzb3JwYXRoICsgInYucG5nKSxwb2ludGVyIjsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBtZS5ib2R5LnN0eWxlLmN1cnNvciA9ICJ0ZXh0IjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckNlbGwgPSB0YXJnZXQ7DQogICAgICAgICAgICAgICAgICAgIGlmICgvXGQvLnRlc3Qoc3RhdGUpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHN0YXRlLnJlcGxhY2UoL1xkLywgJycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gZ2V0VUVUYWJsZSh0YXJnZXQpLmdldFByZXZpZXdDZWxsKHRhcmdldCwgc3RhdGUgPT0gInYiKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAvL+S9jeS6juesrOS4gOihjOeahOmhtumDqOaIluiAheesrOS4gOWIl+eahOW3pui+ueaXtuS4jeWPr+aLluWKqA0KICAgICAgICAgICAgICAgICAgICB0b2dnbGVEcmFnZ2FibGVTdGF0ZShtZSwgdGFyZ2V0ID8gISFzdGF0ZSA6IGZhbHNlLCB0YXJnZXQgPyBzdGF0ZSA6ICcnLCBwb3MsIHRhcmdldCk7DQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRvZ2dsZURyYWdCdXR0b24oZmFsc2UsIHRhYmxlLCBtZSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgc2hvd0Vycm9yKGUpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgdmFyIGRyYWdCdXR0b25UaW1lcjsNCg0KICAgIGZ1bmN0aW9uIHRvZ2dsZURyYWdCdXR0b24oc2hvdywgdGFibGUsIGVkaXRvcikgew0KICAgICAgICBpZiAoIXNob3cpIHsNCiAgICAgICAgICAgIGlmIChkcmFnT3ZlcilyZXR1cm47DQogICAgICAgICAgICBkcmFnQnV0dG9uVGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAhZHJhZ092ZXIgJiYgZHJhZ0J1dHRvbiAmJiBkcmFnQnV0dG9uLnBhcmVudE5vZGUgJiYgZHJhZ0J1dHRvbi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGRyYWdCdXR0b24pOw0KICAgICAgICAgICAgfSwgMjAwMCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBjcmVhdGVEcmFnQnV0dG9uKHRhYmxlLCBlZGl0b3IpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gY3JlYXRlRHJhZ0J1dHRvbih0YWJsZSwgZWRpdG9yKSB7DQogICAgICAgIHZhciBwb3MgPSBkb21VdGlscy5nZXRYWSh0YWJsZSksDQogICAgICAgICAgICBkb2MgPSB0YWJsZS5vd25lckRvY3VtZW50Ow0KICAgICAgICBpZiAoZHJhZ0J1dHRvbiAmJiBkcmFnQnV0dG9uLnBhcmVudE5vZGUpcmV0dXJuIGRyYWdCdXR0b247DQogICAgICAgIGRyYWdCdXR0b24gPSBkb2MuY3JlYXRlRWxlbWVudCgiZGl2Iik7DQogICAgICAgIGRyYWdCdXR0b24uY29udGVudEVkaXRhYmxlID0gZmFsc2U7DQogICAgICAgIGRyYWdCdXR0b24uaW5uZXJIVE1MID0gIiI7DQogICAgICAgIGRyYWdCdXR0b24uc3R5bGUuY3NzVGV4dCA9ICJ3aWR0aDoxNXB4O2hlaWdodDoxNXB4O2JhY2tncm91bmQtaW1hZ2U6dXJsKCIgKyBlZGl0b3Iub3B0aW9ucy5VRURJVE9SX0hPTUVfVVJMICsgImRpYWxvZ3MvdGFibGUvZHJhZ2ljb24ucG5nKTtwb3NpdGlvbjogYWJzb2x1dGU7Y3Vyc29yOm1vdmU7dG9wOiIgKyAocG9zLnkgLSAxNSkgKyAicHg7bGVmdDoiICsgKHBvcy54KSArICJweDsiOw0KICAgICAgICBkb21VdGlscy51blNlbGVjdGFibGUoZHJhZ0J1dHRvbik7DQogICAgICAgIGRyYWdCdXR0b24ub25tb3VzZW92ZXIgPSBmdW5jdGlvbiAoZXZ0KSB7DQogICAgICAgICAgICBkcmFnT3ZlciA9IHRydWU7DQogICAgICAgIH07DQogICAgICAgIGRyYWdCdXR0b24ub25tb3VzZW91dCA9IGZ1bmN0aW9uIChldnQpIHsNCiAgICAgICAgICAgIGRyYWdPdmVyID0gZmFsc2U7DQogICAgICAgIH07DQogICAgICAgIGRvbVV0aWxzLm9uKGRyYWdCdXR0b24sICdjbGljaycsIGZ1bmN0aW9uICh0eXBlLCBldnQpIHsNCiAgICAgICAgICAgIGRvQ2xpY2soZXZ0LCB0aGlzKTsNCiAgICAgICAgfSk7DQogICAgICAgIGRvbVV0aWxzLm9uKGRyYWdCdXR0b24sICdkYmxjbGljaycsIGZ1bmN0aW9uICh0eXBlLCBldnQpIHsNCiAgICAgICAgICAgIGRvRGJsQ2xpY2soZXZ0KTsNCiAgICAgICAgfSk7DQogICAgICAgIGRvbVV0aWxzLm9uKGRyYWdCdXR0b24sICdkcmFnc3RhcnQnLCBmdW5jdGlvbiAodHlwZSwgZXZ0KSB7DQogICAgICAgICAgICBkb21VdGlscy5wcmV2ZW50RGVmYXVsdChldnQpOw0KICAgICAgICB9KTsNCiAgICAgICAgdmFyIHRpbWVyOw0KDQogICAgICAgIGZ1bmN0aW9uIGRvQ2xpY2soZXZ0LCBidXR0b24pIHsNCiAgICAgICAgICAgIC8vIOmDqOWIhua1j+iniOWZqOS4i+mcgOimgea4heeQhg0KICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTsNCiAgICAgICAgICAgIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgZWRpdG9yLmZpcmVFdmVudCgidGFibGVDbGlja2VkIiwgdGFibGUsIGJ1dHRvbik7DQogICAgICAgICAgICB9LCAzMDApOw0KICAgICAgICB9DQoNCiAgICAgICAgZnVuY3Rpb24gZG9EYmxDbGljayhldnQpIHsNCiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7DQogICAgICAgICAgICB2YXIgdXQgPSBnZXRVRVRhYmxlKHRhYmxlKSwNCiAgICAgICAgICAgICAgICBzdGFydCA9IHRhYmxlLnJvd3NbMF0uY2VsbHNbMF0sDQogICAgICAgICAgICAgICAgZW5kID0gdXQuZ2V0TGFzdENlbGwoKSwNCiAgICAgICAgICAgICAgICByYW5nZSA9IHV0LmdldENlbGxzUmFuZ2Uoc3RhcnQsIGVuZCk7DQogICAgICAgICAgICBlZGl0b3Iuc2VsZWN0aW9uLmdldFJhbmdlKCkuc2V0U3RhcnQoc3RhcnQsIDApLnNldEN1cnNvcihmYWxzZSwgdHJ1ZSk7DQogICAgICAgICAgICB1dC5zZXRTZWxlY3RlZChyYW5nZSk7DQogICAgICAgIH0NCg0KICAgICAgICBkb2MuYm9keS5hcHBlbmRDaGlsZChkcmFnQnV0dG9uKTsNCiAgICB9DQoNCg0KLy8gICAgZnVuY3Rpb24gaW5Qb3NpdGlvbih0YWJsZSwgcG9zKSB7DQovLyAgICAgICAgdmFyIHRhYmxlUG9zID0gZG9tVXRpbHMuZ2V0WFkodGFibGUpLA0KLy8gICAgICAgICAgICB3aWR0aCA9IHRhYmxlLm9mZnNldFdpZHRoLA0KLy8gICAgICAgICAgICBoZWlnaHQgPSB0YWJsZS5vZmZzZXRIZWlnaHQ7DQovLyAgICAgICAgaWYgKHBvcy54IC0gdGFibGVQb3MueCA8IDUgJiYgcG9zLnkgLSB0YWJsZVBvcy55IDwgNSkgew0KLy8gICAgICAgICAgICByZXR1cm4gInRvcExlZnQiOw0KLy8gICAgICAgIH0gZWxzZSBpZiAodGFibGVQb3MueCArIHdpZHRoIC0gcG9zLnggPCA1ICYmIHRhYmxlUG9zLnkgKyBoZWlnaHQgLSBwb3MueSA8IDUpIHsNCi8vICAgICAgICAgICAgcmV0dXJuICJib3R0b21SaWdodCI7DQovLyAgICAgICAgfQ0KLy8gICAgfQ0KDQogICAgZnVuY3Rpb24gaW5UYWJsZVNpZGUodGFibGUsIGNlbGwsIGV2dCwgdG9wKSB7DQogICAgICAgIHZhciBwb3MgPSBtb3VzZUNvb3JkcyhldnQpLA0KICAgICAgICAgICAgc3RhdGUgPSBnZXRSZWxhdGlvbihjZWxsLCBwb3MpOw0KDQogICAgICAgIGlmICh0b3ApIHsNCiAgICAgICAgICAgIHZhciBjYXB0aW9uID0gdGFibGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImNhcHRpb24iKVswXSwNCiAgICAgICAgICAgICAgICBjYXBIZWlnaHQgPSBjYXB0aW9uID8gY2FwdGlvbi5vZmZzZXRIZWlnaHQgOiAwOw0KICAgICAgICAgICAgcmV0dXJuIChzdGF0ZSA9PSAidjEiKSAmJiAoKHBvcy55IC0gZG9tVXRpbHMuZ2V0WFkodGFibGUpLnkgLSBjYXBIZWlnaHQpIDwgOCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gKHN0YXRlID09ICJoMSIpICYmICgocG9zLnggLSBkb21VdGlscy5nZXRYWSh0YWJsZSkueCkgPCA4KTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPluaLluWKqOaXtuWFgeiuuOeahFjovbTlnZDmoIcNCiAgICAgKiBAcGFyYW0gZHJhZ1RkDQogICAgICogQHBhcmFtIGV2dA0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGdldFBlcm1pc3Npb25YKGRyYWdUZCwgZXZ0KSB7DQogICAgICAgIHZhciB1dCA9IGdldFVFVGFibGUoZHJhZ1RkKTsNCiAgICAgICAgaWYgKHV0KSB7DQogICAgICAgICAgICB2YXIgcHJlVGQgPSB1dC5nZXRTYW1lRW5kUG9zQ2VsbHMoZHJhZ1RkLCAieCIpWzBdLA0KICAgICAgICAgICAgICAgIG5leHRUZCA9IHV0LmdldFNhbWVTdGFydFBvc1hDZWxscyhkcmFnVGQpWzBdLA0KICAgICAgICAgICAgICAgIG1vdXNlWCA9IG1vdXNlQ29vcmRzKGV2dCkueCwNCiAgICAgICAgICAgICAgICBsZWZ0ID0gKHByZVRkID8gZG9tVXRpbHMuZ2V0WFkocHJlVGQpLnggOiBkb21VdGlscy5nZXRYWSh1dC50YWJsZSkueCkgKyAyMCAsDQogICAgICAgICAgICAgICAgcmlnaHQgPSBuZXh0VGQgPyBkb21VdGlscy5nZXRYWShuZXh0VGQpLnggKyBuZXh0VGQub2Zmc2V0V2lkdGggLSAyMCA6IChtZS5ib2R5Lm9mZnNldFdpZHRoICsgNSB8fCBwYXJzZUludChkb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKG1lLmJvZHksICJ3aWR0aCIpLCAxMCkpOw0KDQogICAgICAgICAgICBsZWZ0ICs9IGNlbGxNaW5XaWR0aDsNCiAgICAgICAgICAgIHJpZ2h0IC09IGNlbGxNaW5XaWR0aDsNCg0KICAgICAgICAgICAgcmV0dXJuIG1vdXNlWCA8IGxlZnQgPyBsZWZ0IDogbW91c2VYID4gcmlnaHQgPyByaWdodCA6IG1vdXNlWDsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPluaLluWKqOaXtuWFgeiuuOeahFnovbTlnZDmoIcNCiAgICAgKi8NCiAgICBmdW5jdGlvbiBnZXRQZXJtaXNzaW9uWShkcmFnVGQsIGV2dCkgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgdmFyIHRvcCA9IGRvbVV0aWxzLmdldFhZKGRyYWdUZCkueSwNCiAgICAgICAgICAgICAgICBtb3VzZVBvc1kgPSBtb3VzZUNvb3JkcyhldnQpLnk7DQogICAgICAgICAgICByZXR1cm4gbW91c2VQb3NZIDwgdG9wID8gdG9wIDogbW91c2VQb3NZOw0KICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICBzaG93RXJyb3IoZSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDnp7vliqjnirbmgIHliIfmjaINCiAgICAgKi8NCiAgICBmdW5jdGlvbiB0b2dnbGVEcmFnZ2FibGVTdGF0ZShlZGl0b3IsIGRyYWdnYWJsZSwgZGlyLCBtb3VzZVBvcywgY2VsbCkgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgZWRpdG9yLmJvZHkuc3R5bGUuY3Vyc29yID0gZGlyID09ICJoIiA/ICJjb2wtcmVzaXplIiA6IGRpciA9PSAidiIgPyAicm93LXJlc2l6ZSIgOiAidGV4dCI7DQogICAgICAgICAgICBpZiAoYnJvd3Nlci5pZSkgew0KICAgICAgICAgICAgICAgIGlmIChkaXIgJiYgIW1vdXNlZG93biAmJiAhZ2V0VUVUYWJsZUJ5U2VsZWN0ZWQoZWRpdG9yKSkgew0KICAgICAgICAgICAgICAgICAgICBnZXREcmFnTGluZShlZGl0b3IsIGVkaXRvci5kb2N1bWVudCk7DQogICAgICAgICAgICAgICAgICAgIHNob3dEcmFnTGluZUF0KGRpciwgY2VsbCk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgaGlkZURyYWdMaW5lKGVkaXRvcikNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBvbkJvcmRlciA9IGRyYWdnYWJsZTsNCiAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgc2hvd0Vycm9yKGUpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+W5LiOVUVUYWJsZeebuOWFs+eahHJlc2l6ZSBsaW5lDQogICAgICogQHBhcmFtIHVldGFibGUgVUVUYWJsZeWvueixoQ0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGdldFJlc2l6ZUxpbmVCeVVFVGFibGUoKSB7DQoNCiAgICAgICAgdmFyIGxpbmVJZCA9ICdfVUVUYWJsZVJlc2l6ZUxpbmUnLA0KICAgICAgICAgICAgbGluZSA9IHRoaXMuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIGxpbmVJZCApOw0KDQogICAgICAgIGlmKCAhbGluZSApIHsNCiAgICAgICAgICAgIGxpbmUgPSB0aGlzLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOw0KICAgICAgICAgICAgbGluZS5pZCA9IGxpbmVJZDsNCiAgICAgICAgICAgIGxpbmUuY29udG5ldEVkaXRhYmxlID0gZmFsc2U7DQogICAgICAgICAgICBsaW5lLnNldEF0dHJpYnV0ZSgidW5zZWxlY3RhYmxlIiwgIm9uIik7DQoNCiAgICAgICAgICAgIHZhciBzdHlsZXMgPSB7DQogICAgICAgICAgICAgICAgd2lkdGg6IDIqY2VsbEJvcmRlcldpZHRoICsgMSArICdweCcsDQogICAgICAgICAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsDQogICAgICAgICAgICAgICAgJ3otaW5kZXgnOiAxMDAwMDAsDQogICAgICAgICAgICAgICAgY3Vyc29yOiAnY29sLXJlc2l6ZScsDQogICAgICAgICAgICAgICAgYmFja2dyb3VuZDogJ3JlZCcsDQogICAgICAgICAgICAgICAgZGlzcGxheTogJ25vbmUnDQogICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICAvL+WIh+aNoueKtuaAgQ0KICAgICAgICAgICAgbGluZS5vbm1vdXNlb3V0ID0gZnVuY3Rpb24oKXsNCiAgICAgICAgICAgICAgICB0aGlzLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICB1dGlscy5leHRlbmQoIGxpbmUuc3R5bGUsIHN0eWxlcyApOw0KDQogICAgICAgICAgICB0aGlzLmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoIGxpbmUgKTsNCg0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGxpbmU7DQoNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmm7TmlrByZXNpemUtbGluZQ0KICAgICAqLw0KICAgIGZ1bmN0aW9uIHVwZGF0ZVJlc2l6ZUxpbmUoIGNlbGwsIHVldGFibGUgKSB7DQoNCiAgICAgICAgdmFyIGxpbmUgPSBnZXRSZXNpemVMaW5lQnlVRVRhYmxlLmNhbGwoIHRoaXMgKSwNCiAgICAgICAgICAgIHRhYmxlID0gdWV0YWJsZS50YWJsZSwNCiAgICAgICAgICAgIHN0eWxlcyA9IHsNCiAgICAgICAgICAgICAgICB0b3A6IGRvbVV0aWxzLmdldFhZKCB0YWJsZSApLnkgKyAncHgnLA0KICAgICAgICAgICAgICAgIGxlZnQ6IGRvbVV0aWxzLmdldFhZKCBjZWxsKS54ICsgY2VsbC5vZmZzZXRXaWR0aCAtIGNlbGxCb3JkZXJXaWR0aCArICdweCcsDQogICAgICAgICAgICAgICAgZGlzcGxheTogJ2Jsb2NrJywNCiAgICAgICAgICAgICAgICBoZWlnaHQ6IHRhYmxlLm9mZnNldEhlaWdodCArICdweCcNCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgdXRpbHMuZXh0ZW5kKCBsaW5lLnN0eWxlLCBzdHlsZXMgKTsNCg0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOaYvuekunJlc2l6ZS1saW5lDQogICAgICovDQogICAgZnVuY3Rpb24gc2hvd1Jlc2l6ZUxpbmUoIGNlbGwgKSB7DQoNCiAgICAgICAgdmFyIHVldGFibGUgPSBnZXRVRVRhYmxlKCBjZWxsICk7DQoNCiAgICAgICAgdXBkYXRlUmVzaXplTGluZS5jYWxsKCB0aGlzLCBjZWxsLCB1ZXRhYmxlICk7DQoNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5bpvKDmoIfkuI7lvZPliY3ljZXlhYPmoLznmoTnm7jlr7nkvY3nva4NCiAgICAgKiBAcGFyYW0gZWxlDQogICAgICogQHBhcmFtIG1vdXNlUG9zDQogICAgICovDQogICAgZnVuY3Rpb24gZ2V0UmVsYXRpb24oZWxlLCBtb3VzZVBvcykgew0KICAgICAgICB2YXIgZWxlUG9zID0gZG9tVXRpbHMuZ2V0WFkoZWxlKTsNCg0KICAgICAgICBpZiggIWVsZVBvcyApIHsNCiAgICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChlbGVQb3MueCArIGVsZS5vZmZzZXRXaWR0aCAtIG1vdXNlUG9zLnggPCBjZWxsQm9yZGVyV2lkdGgpIHsNCiAgICAgICAgICAgIHJldHVybiAiaCI7DQogICAgICAgIH0NCiAgICAgICAgaWYgKG1vdXNlUG9zLnggLSBlbGVQb3MueCA8IGNlbGxCb3JkZXJXaWR0aCkgew0KICAgICAgICAgICAgcmV0dXJuICdoMScNCiAgICAgICAgfQ0KICAgICAgICBpZiAoZWxlUG9zLnkgKyBlbGUub2Zmc2V0SGVpZ2h0IC0gbW91c2VQb3MueSA8IGNlbGxCb3JkZXJXaWR0aCkgew0KICAgICAgICAgICAgcmV0dXJuICJ2IjsNCiAgICAgICAgfQ0KICAgICAgICBpZiAobW91c2VQb3MueSAtIGVsZVBvcy55IDwgY2VsbEJvcmRlcldpZHRoKSB7DQogICAgICAgICAgICByZXR1cm4gJ3YxJw0KICAgICAgICB9DQogICAgICAgIHJldHVybiAnJzsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBtb3VzZURvd25FdmVudCh0eXBlLCBldnQpIHsNCg0KICAgICAgICBpZiggaXNFZGl0b3JEaXNhYmxlZCgpICkgew0KICAgICAgICAgICAgcmV0dXJuIDsNCiAgICAgICAgfQ0KDQogICAgICAgIHVzZXJBY3Rpb25TdGF0dXMgPSB7DQogICAgICAgICAgICB4OiBldnQuY2xpZW50WCwNCiAgICAgICAgICAgIHk6IGV2dC5jbGllbnRZDQogICAgICAgIH07DQoNCiAgICAgICAgLy/lj7PplK7oj5zljZXljZXni6zlpITnkIYNCiAgICAgICAgaWYgKGV2dC5idXR0b24gPT0gMikgew0KICAgICAgICAgICAgdmFyIHV0ID0gZ2V0VUVUYWJsZUJ5U2VsZWN0ZWQobWUpLA0KICAgICAgICAgICAgICAgIGZsYWcgPSBmYWxzZTsNCg0KICAgICAgICAgICAgaWYgKHV0KSB7DQogICAgICAgICAgICAgICAgdmFyIHRkID0gZ2V0VGFyZ2V0VGQobWUsIGV2dCk7DQogICAgICAgICAgICAgICAgdXRpbHMuZWFjaCh1dC5zZWxlY3RlZFRkcywgZnVuY3Rpb24gKHRpKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICh0aSA9PT0gdGQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZsYWcgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgaWYgKCFmbGFnKSB7DQogICAgICAgICAgICAgICAgICAgIHJlbW92ZVNlbGVjdGVkQ2xhc3MoZG9tVXRpbHMuZ2V0RWxlbWVudHNCeVRhZ05hbWUobWUuYm9keSwgInRoIHRkIikpOw0KICAgICAgICAgICAgICAgICAgICB1dC5jbGVhclNlbGVjdGVkKCkNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICB0ZCA9IHV0LnNlbGVjdGVkVGRzWzBdOw0KICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpLnNldFN0YXJ0KHRkLCAwKS5zZXRDdXJzb3IoZmFsc2UsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICB9LCAwKTsNCg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRhYmxlQ2xpY2tIYW5kZXIoIGV2dCApOw0KICAgICAgICB9DQoNCiAgICB9DQoNCiAgICAvL+a4hemZpOihqOagvOeahOiuoeaXtuWZqA0KICAgIGZ1bmN0aW9uIGNsZWFyVGFibGVUaW1lcigpIHsNCiAgICAgICAgdGFiVGltZXIgJiYgY2xlYXJUaW1lb3V0KCB0YWJUaW1lciApOw0KICAgICAgICB0YWJUaW1lciA9IG51bGw7DQogICAgfQ0KDQogICAgLy/lj4zlh7vmlLbnvKkNCiAgICBmdW5jdGlvbiB0YWJsZURiY2xpY2tIYW5kbGVyKGV2dCkgew0KICAgICAgICBzaW5nbGVDbGlja1N0YXRlID0gMDsNCiAgICAgICAgZXZ0ID0gZXZ0IHx8IG1lLndpbmRvdy5ldmVudDsNCiAgICAgICAgdmFyIHRhcmdldCA9IGdldFBhcmVudFRkT3JUaChldnQudGFyZ2V0IHx8IGV2dC5zcmNFbGVtZW50KTsNCiAgICAgICAgaWYgKHRhcmdldCkgew0KICAgICAgICAgICAgdmFyIGg7DQogICAgICAgICAgICBpZiAoaCA9IGdldFJlbGF0aW9uKHRhcmdldCwgbW91c2VDb29yZHMoZXZ0KSkpIHsNCg0KICAgICAgICAgICAgICAgIGhpZGVEcmFnTGluZSggbWUgKTsNCg0KICAgICAgICAgICAgICAgIGlmIChoID09ICdoMScpIHsNCiAgICAgICAgICAgICAgICAgICAgaCA9ICdoJzsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGluVGFibGVTaWRlKGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUodGFyZ2V0LCAidGFibGUiKSwgdGFyZ2V0LCBldnQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBtZS5leGVjQ29tbWFuZCgnYWRhcHRieXdpbmRvdycpOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gZ2V0VUVUYWJsZSh0YXJnZXQpLmdldFByZXZpZXdDZWxsKHRhcmdldCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJuZyA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJuZy5zZWxlY3ROb2RlQ29udGVudHModGFyZ2V0KS5zZXRDdXJzb3IodHJ1ZSwgdHJ1ZSkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoaCA9PSAnaCcpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHV0ID0gZ2V0VUVUYWJsZSh0YXJnZXQpLA0KICAgICAgICAgICAgICAgICAgICAgICAgdGFibGUgPSB1dC50YWJsZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGNlbGxzID0gZ2V0Q2VsbHNCeU1vdmVCb3JkZXIoIHRhcmdldCwgdGFibGUsIHRydWUgKTsNCg0KICAgICAgICAgICAgICAgICAgICBjZWxscyA9IGV4dHJhY3RBcnJheSggY2VsbHMsICdsZWZ0JyApOw0KDQogICAgICAgICAgICAgICAgICAgIHV0LndpZHRoID0gdXQub2Zmc2V0V2lkdGg7DQoNCiAgICAgICAgICAgICAgICAgICAgdmFyIG9sZFdpZHRoID0gW10sDQogICAgICAgICAgICAgICAgICAgICAgICBuZXdXaWR0aCA9IFtdOw0KDQogICAgICAgICAgICAgICAgICAgIHV0aWxzLmVhY2goIGNlbGxzLCBmdW5jdGlvbiggY2VsbCApew0KDQogICAgICAgICAgICAgICAgICAgICAgICBvbGRXaWR0aC5wdXNoKCBjZWxsLm9mZnNldFdpZHRoICk7DQoNCiAgICAgICAgICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAgICAgICAgIHV0aWxzLmVhY2goIGNlbGxzLCBmdW5jdGlvbiggY2VsbCApew0KDQogICAgICAgICAgICAgICAgICAgICAgICBjZWxsLnJlbW92ZUF0dHJpYnV0ZSgid2lkdGgiKTsNCg0KICAgICAgICAgICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoIGZ1bmN0aW9uKCl7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8v5piv5ZCm5YWB6K645pS55Y+YDQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hhbmdlYWJsZSA9IHRydWU7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHV0aWxzLmVhY2goIGNlbGxzLCBmdW5jdGlvbiggY2VsbCwgaW5kZXggKXsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IGNlbGwub2Zmc2V0V2lkdGg7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiggd2lkdGggPiBvbGRXaWR0aFtpbmRleF0gKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZWFibGUgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1dpZHRoLnB1c2goIHdpZHRoICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNoYW5nZSA9IGNoYW5nZWFibGUgPyBuZXdXaWR0aCA6IG9sZFdpZHRoOw0KDQogICAgICAgICAgICAgICAgICAgICAgICB1dGlscy5lYWNoKCBjZWxscywgZnVuY3Rpb24oIGNlbGwsIGluZGV4ICl7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZWxsLndpZHRoID0gY2hhbmdlW2luZGV4XSAtIGdldFRhYmNlbGxTcGFjZSgpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICB9ICk7DQoNCg0KICAgICAgICAgICAgICAgICAgICB9LCAwICk7DQoNCi8vICAgICAgICAgICAgICAgICAgICBtaW5XaWR0aCAtPSBjZWxsTWluV2lkdGg7DQovLw0KLy8gICAgICAgICAgICAgICAgICAgIHRhYmxlLnJlbW92ZUF0dHJpYnV0ZSgid2lkdGgiKTsNCi8vICAgICAgICAgICAgICAgICAgICB1dGlscy5lYWNoKGNlbGxzLCBmdW5jdGlvbiAoY2VsbCkgew0KLy8gICAgICAgICAgICAgICAgICAgICAgICBjZWxsLnN0eWxlLndpZHRoID0gIiI7DQovLyAgICAgICAgICAgICAgICAgICAgICAgIGNlbGwud2lkdGggLT0gbWluV2lkdGg7DQovLyAgICAgICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbiB0YWJsZUNsaWNrSGFuZGVyKCBldnQgKSB7DQoNCiAgICAgICAgcmVtb3ZlU2VsZWN0ZWRDbGFzcyhkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZShtZS5ib2R5LCAidGQgdGgiKSk7DQogICAgICAgIC8vdHJhY2U6MzExMw0KICAgICAgICAvL+mAieS4reWNleWFg+agvO+8jOeCueWHu3RhYmxl5aSW6YOo77yM5LiN5Lya5riF5o6JdGFibGXkuIrmjILnmoR1ZVRhYmxlLOS8muW8lei1t2dldFVFVGFibGVCeVNlbGVjdGVk5pa55rOV6L+U5Zue5YC8DQogICAgICAgIHV0aWxzLmVhY2gobWUuZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RhYmxlJyksIGZ1bmN0aW9uICh0KSB7DQogICAgICAgICAgICB0LnVlVGFibGUgPSBudWxsOw0KICAgICAgICB9KTsNCiAgICAgICAgc3RhcnRUZCA9IGdldFRhcmdldFRkKG1lLCBldnQpOw0KICAgICAgICBpZiggIXN0YXJ0VGQgKSByZXR1cm47DQogICAgICAgIHZhciB0YWJsZSA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUoc3RhcnRUZCwgInRhYmxlIiwgdHJ1ZSk7DQogICAgICAgIHV0ID0gZ2V0VUVUYWJsZSh0YWJsZSk7DQogICAgICAgIHV0ICYmIHV0LmNsZWFyU2VsZWN0ZWQoKTsNCg0KICAgICAgICAvL+WIpOaWreW9k+WJjem8oOagh+eKtuaAgQ0KICAgICAgICBpZiAoIW9uQm9yZGVyKSB7DQogICAgICAgICAgICBtZS5kb2N1bWVudC5ib2R5LnN0eWxlLndlYmtpdFVzZXJTZWxlY3QgPSAnJzsNCiAgICAgICAgICAgIG1vdXNlZG93biA9IHRydWU7DQogICAgICAgICAgICBtZS5hZGRMaXN0ZW5lcignbW91c2VvdmVyJywgbW91c2VPdmVyRXZlbnQpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy/ovrnmoYbkuIrnmoTliqjkvZzlpITnkIYNCiAgICAgICAgICAgIGJvcmRlckFjdGlvbkhhbmRsZXIoIGV2dCApOw0KICAgICAgICB9DQoNCg0KICAgIH0NCg0KICAgIC8v5aSE55CG6KGo5qC86L655qGG5LiK55qE5Yqo5L2cLCDov5nph4zlgZrlu7bml7blpITnkIbvvIzpgb/lhY3kuKTnp43liqjkvZzkupLnm7jlvbHlk40NCiAgICBmdW5jdGlvbiBib3JkZXJBY3Rpb25IYW5kbGVyKCBldnQgKSB7DQoNCiAgICAgICAgaWYgKCBicm93c2VyLmllICkgew0KICAgICAgICAgICAgZXZ0ID0gcmVjb25zdHJ1Y3QoZXZ0ICk7DQogICAgICAgIH0NCg0KICAgICAgICBjbGVhclRhYmxlRHJhZ1RpbWVyKCk7DQoNCiAgICAgICAgLy/mmK/lkKbmraPlnKjnrYnlvoVyZXNpemXnmoTnvJPlhrLkuK0NCiAgICAgICAgaXNJblJlc2l6ZUJ1ZmZlciA9IHRydWU7DQoNCiAgICAgICAgdGFibGVEcmFnVGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7DQogICAgICAgICAgICB0YWJsZUJvcmRlckRyYWcoIGV2dCApOw0KICAgICAgICB9LCBkYmxjbGlja1RpbWUpOw0KDQogICAgfQ0KDQogICAgZnVuY3Rpb24gZXh0cmFjdEFycmF5KCBvcmlnaW5BcnIsIGtleSApIHsNCg0KICAgICAgICB2YXIgcmVzdWx0ID0gW10sDQogICAgICAgICAgICB0bXAgPSBudWxsOw0KDQogICAgICAgIGZvciggdmFyIGkgPSAwLCBsZW4gPSBvcmlnaW5BcnIubGVuZ3RoOyBpPGxlbjsgaSsrICkgew0KDQogICAgICAgICAgICB0bXAgPSBvcmlnaW5BcnJbIGkgXVsga2V5IF07DQoNCiAgICAgICAgICAgIGlmKCB0bXAgKSB7DQogICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goIHRtcCApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gcmVzdWx0Ow0KDQogICAgfQ0KDQogICAgZnVuY3Rpb24gY2xlYXJUYWJsZURyYWdUaW1lcigpIHsNCiAgICAgICAgdGFibGVEcmFnVGltZXIgJiYgY2xlYXJUaW1lb3V0KHRhYmxlRHJhZ1RpbWVyKTsNCiAgICAgICAgdGFibGVEcmFnVGltZXIgPSBudWxsOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHJlY29uc3RydWN0KCBvYmogKSB7DQoNCiAgICAgICAgdmFyIGF0dHJzID0gWydwYWdlWCcsICdwYWdlWScsICdjbGllbnRYJywgJ2NsaWVudFknLCAnc3JjRWxlbWVudCcsICd0YXJnZXQnXSwNCiAgICAgICAgICAgIG5ld09iaiA9IHt9Ow0KDQogICAgICAgIGlmKCBvYmogKSB7DQoNCiAgICAgICAgICAgIGZvciggdmFyIGkgPSAwLCBrZXksIHZhbDsga2V5ID0gYXR0cnNbaV07IGkrKyApIHsNCiAgICAgICAgICAgICAgICB2YWw9b2JqWyBrZXkgXTsNCiAgICAgICAgICAgICAgICB2YWwgJiYgKG5ld09ialsga2V5IF0gPSB2YWwpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gbmV3T2JqOw0KDQogICAgfQ0KDQogICAgLy/ovrnmoYbmi5bliqgNCiAgICBmdW5jdGlvbiB0YWJsZUJvcmRlckRyYWcoIGV2dCApIHsNCg0KICAgICAgICBpc0luUmVzaXplQnVmZmVyID0gZmFsc2U7DQoNCiAgICAgICAgaWYoICFzdGFydFRkICkgcmV0dXJuOw0KICAgICAgICB2YXIgc3RhdGUgPSBNYXRoLmFicyggdXNlckFjdGlvblN0YXR1cy54IC0gZXZ0LmNsaWVudFggKSA+PSBNYXRoLmFicyggdXNlckFjdGlvblN0YXR1cy55IC0gZXZ0LmNsaWVudFkgKSA/ICdoJyA6ICd2JzsNCi8vICAgICAgICB2YXIgc3RhdGUgPSBnZXRSZWxhdGlvbihzdGFydFRkLCBtb3VzZUNvb3JkcyhldnQpKTsNCiAgICAgICAgaWYgKC9cZC8udGVzdChzdGF0ZSkpIHsNCiAgICAgICAgICAgIHN0YXRlID0gc3RhdGUucmVwbGFjZSgvXGQvLCAnJyk7DQogICAgICAgICAgICBzdGFydFRkID0gZ2V0VUVUYWJsZShzdGFydFRkKS5nZXRQcmV2aWV3Q2VsbChzdGFydFRkLCBzdGF0ZSA9PSAndicpOw0KICAgICAgICB9DQogICAgICAgIGhpZGVEcmFnTGluZShtZSk7DQogICAgICAgIGdldERyYWdMaW5lKG1lLCBtZS5kb2N1bWVudCk7DQogICAgICAgIG1lLmZpcmVFdmVudCgnc2F2ZVNjZW5lJyk7DQogICAgICAgIHNob3dEcmFnTGluZUF0KHN0YXRlLCBzdGFydFRkKTsNCiAgICAgICAgbW91c2Vkb3duID0gdHJ1ZTsNCiAgICAgICAgLy/mi5bliqjlvIDlp4sNCiAgICAgICAgb25EcmFnID0gc3RhdGU7DQogICAgICAgIGRyYWdUZCA9IHN0YXJ0VGQ7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gbW91c2VVcEV2ZW50KHR5cGUsIGV2dCkgew0KDQogICAgICAgIGlmKCBpc0VkaXRvckRpc2FibGVkKCkgKSB7DQogICAgICAgICAgICByZXR1cm4gOw0KICAgICAgICB9DQoNCiAgICAgICAgY2xlYXJUYWJsZURyYWdUaW1lcigpOw0KDQogICAgICAgIGlzSW5SZXNpemVCdWZmZXIgPSBmYWxzZTsNCg0KICAgICAgICBpZiggb25Cb3JkZXIgKSB7DQogICAgICAgICAgICBzaW5nbGVDbGlja1N0YXRlID0gKytzaW5nbGVDbGlja1N0YXRlICUgMzsNCg0KICAgICAgICAgICAgdXNlckFjdGlvblN0YXR1cyA9IHsNCiAgICAgICAgICAgICAgICB4OiBldnQuY2xpZW50WCwNCiAgICAgICAgICAgICAgICB5OiBldnQuY2xpZW50WQ0KICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgdGFibGVSZXNpemVUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXsNCiAgICAgICAgICAgICAgICBzaW5nbGVDbGlja1N0YXRlID4gMCAmJiBzaW5nbGVDbGlja1N0YXRlLS07DQogICAgICAgICAgICB9LCBkYmxjbGlja1RpbWUgKTsNCg0KICAgICAgICAgICAgaWYoIHNpbmdsZUNsaWNrU3RhdGUgPT09IDIgKSB7DQoNCiAgICAgICAgICAgICAgICBzaW5nbGVDbGlja1N0YXRlID0gMDsNCiAgICAgICAgICAgICAgICB0YWJsZURiY2xpY2tIYW5kbGVyKGV2dCk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KDQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChldnQuYnV0dG9uID09IDIpcmV0dXJuOw0KICAgICAgICB2YXIgbWUgPSB0aGlzOw0KICAgICAgICAvL+a4hemZpOihqOagvOS4iuWOn+eUn+i3qOmAiemXrumimA0KICAgICAgICB2YXIgcmFuZ2UgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKSwNCiAgICAgICAgICAgIHN0YXJ0ID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShyYW5nZS5zdGFydENvbnRhaW5lciwgJ3RhYmxlJywgdHJ1ZSksDQogICAgICAgICAgICBlbmQgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKHJhbmdlLmVuZENvbnRhaW5lciwgJ3RhYmxlJywgdHJ1ZSk7DQoNCiAgICAgICAgaWYgKHN0YXJ0IHx8IGVuZCkgew0KICAgICAgICAgICAgaWYgKHN0YXJ0ID09PSBlbmQpIHsNCiAgICAgICAgICAgICAgICBzdGFydCA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUocmFuZ2Uuc3RhcnRDb250YWluZXIsIFsndGQnLCAndGgnLCAnY2FwdGlvbiddLCB0cnVlKTsNCiAgICAgICAgICAgICAgICBlbmQgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKHJhbmdlLmVuZENvbnRhaW5lciwgWyd0ZCcsICd0aCcsICdjYXB0aW9uJ10sIHRydWUpOw0KICAgICAgICAgICAgICAgIGlmIChzdGFydCAhPT0gZW5kKSB7DQogICAgICAgICAgICAgICAgICAgIG1lLnNlbGVjdGlvbi5jbGVhclJhbmdlKCkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIG1lLnNlbGVjdGlvbi5jbGVhclJhbmdlKCkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBtb3VzZWRvd24gPSBmYWxzZTsNCiAgICAgICAgbWUuZG9jdW1lbnQuYm9keS5zdHlsZS53ZWJraXRVc2VyU2VsZWN0ID0gJyc7DQogICAgICAgIC8v5ouW5ou954q25oCB5LiL55qEbW91c2VVUA0KICAgICAgICBpZiAoIG9uRHJhZyAmJiBkcmFnVGQgKSB7DQoNCiAgICAgICAgICAgIG1lLnNlbGVjdGlvbi5nZXROYXRpdmUoKVticm93c2VyLmllID8gJ2VtcHR5JyA6ICdyZW1vdmVBbGxSYW5nZXMnXSgpOw0KDQogICAgICAgICAgICBzaW5nbGVDbGlja1N0YXRlID0gMDsNCiAgICAgICAgICAgIGRyYWdMaW5lID0gbWUuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VlX3RhYmxlRHJhZ0xpbmUnKTsNCg0KICAgICAgICAgICAgdmFyIGRyYWdUZFBvcyA9IGRvbVV0aWxzLmdldFhZKGRyYWdUZCksDQogICAgICAgICAgICAgICAgZHJhZ0xpbmVQb3MgPSBkb21VdGlscy5nZXRYWShkcmFnTGluZSk7DQoNCiAgICAgICAgICAgIHN3aXRjaCAob25EcmFnKSB7DQogICAgICAgICAgICAgICAgY2FzZSAiaCI6DQogICAgICAgICAgICAgICAgICAgIGNoYW5nZUNvbFdpZHRoKGRyYWdUZCwgZHJhZ0xpbmVQb3MueCAtIGRyYWdUZFBvcy54KTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAidiI6DQogICAgICAgICAgICAgICAgICAgIGNoYW5nZVJvd0hlaWdodChkcmFnVGQsIGRyYWdMaW5lUG9zLnkgLSBkcmFnVGRQb3MueSAtIGRyYWdUZC5vZmZzZXRIZWlnaHQpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgb25EcmFnID0gIiI7DQogICAgICAgICAgICBkcmFnVGQgPSBudWxsOw0KDQogICAgICAgICAgICBoaWRlRHJhZ0xpbmUobWUpOw0KICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCdzYXZlU2NlbmUnKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICAvL+ato+W4uOeKtuaAgeS4i+eahG1vdXNldXANCiAgICAgICAgaWYgKCFzdGFydFRkKSB7DQogICAgICAgICAgICB2YXIgdGFyZ2V0ID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShldnQudGFyZ2V0IHx8IGV2dC5zcmNFbGVtZW50LCAidGQiLCB0cnVlKTsNCiAgICAgICAgICAgIGlmICghdGFyZ2V0KSB0YXJnZXQgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKGV2dC50YXJnZXQgfHwgZXZ0LnNyY0VsZW1lbnQsICJ0aCIsIHRydWUpOw0KICAgICAgICAgICAgaWYgKHRhcmdldCAmJiAodGFyZ2V0LnRhZ05hbWUgPT0gIlREIiB8fCB0YXJnZXQudGFnTmFtZSA9PSAiVEgiKSkgew0KICAgICAgICAgICAgICAgIGlmIChtZS5maXJlRXZlbnQoImV4Y2x1ZGV0YWJsZSIsIHRhcmdldCkgPT09IHRydWUpIHJldHVybjsNCiAgICAgICAgICAgICAgICByYW5nZSA9IG5ldyBkb20uUmFuZ2UobWUuZG9jdW1lbnQpOw0KICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KHRhcmdldCwgMCkuc2V0Q3Vyc29yKGZhbHNlLCB0cnVlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHZhciB1dCA9IGdldFVFVGFibGUoc3RhcnRUZCksDQogICAgICAgICAgICAgICAgY2VsbCA9IHV0ID8gdXQuc2VsZWN0ZWRUZHNbMF0gOiBudWxsOw0KICAgICAgICAgICAgaWYgKGNlbGwpIHsNCiAgICAgICAgICAgICAgICByYW5nZSA9IG5ldyBkb20uUmFuZ2UobWUuZG9jdW1lbnQpOw0KICAgICAgICAgICAgICAgIGlmIChkb21VdGlscy5pc0VtcHR5QmxvY2soY2VsbCkpIHsNCiAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQoY2VsbCwgMCkuc2V0Q3Vyc29yKGZhbHNlLCB0cnVlKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICByYW5nZS5zZWxlY3ROb2RlQ29udGVudHMoY2VsbCkuc2hyaW5rQm91bmRhcnkoKS5zZXRDdXJzb3IoZmFsc2UsIHRydWUpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmFuZ2UgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKS5zaHJpbmtCb3VuZGFyeSgpOw0KICAgICAgICAgICAgICAgIGlmICghcmFuZ2UuY29sbGFwc2VkKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUocmFuZ2Uuc3RhcnRDb250YWluZXIsIFsndGQnLCAndGgnXSwgdHJ1ZSksDQogICAgICAgICAgICAgICAgICAgICAgICBlbmQgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKHJhbmdlLmVuZENvbnRhaW5lciwgWyd0ZCcsICd0aCddLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgLy/lnKh0YWJsZemHjOi+ueeahOS4jeiDvea4hemZpA0KICAgICAgICAgICAgICAgICAgICBpZiAoc3RhcnQgJiYgIWVuZCB8fCAhc3RhcnQgJiYgZW5kIHx8IHN0YXJ0ICYmIGVuZCAmJiBzdGFydCAhPT0gZW5kKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRDdXJzb3IoZmFsc2UsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgc3RhcnRUZCA9IG51bGw7DQogICAgICAgICAgICBtZS5yZW1vdmVMaXN0ZW5lcignbW91c2VvdmVyJywgbW91c2VPdmVyRXZlbnQpOw0KICAgICAgICB9DQogICAgICAgIG1lLl9zZWxlY3Rpb25DaGFuZ2UoMjUwLCBldnQpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIG1vdXNlT3ZlckV2ZW50KHR5cGUsIGV2dCkgew0KDQogICAgICAgIGlmKCBpc0VkaXRvckRpc2FibGVkKCkgKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICB2YXIgbWUgPSB0aGlzLA0KICAgICAgICAgICAgdGFyID0gZXZ0LnRhcmdldCB8fCBldnQuc3JjRWxlbWVudDsNCiAgICAgICAgY3VycmVudFRkID0gZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZSh0YXIsICJ0ZCIsIHRydWUpIHx8IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUodGFyLCAidGgiLCB0cnVlKTsNCiAgICAgICAgLy/pnIDopoHliKTmlq3kuKTkuKpUROaYr+WQpuS9jeS6juWQjOS4gOS4quihqOagvOWGhQ0KICAgICAgICBpZiAoc3RhcnRUZCAmJiBjdXJyZW50VGQgJiYNCiAgICAgICAgICAgICgoc3RhcnRUZC50YWdOYW1lID09ICJURCIgJiYgY3VycmVudFRkLnRhZ05hbWUgPT0gIlREIikgfHwgKHN0YXJ0VGQudGFnTmFtZSA9PSAiVEgiICYmIGN1cnJlbnRUZC50YWdOYW1lID09ICJUSCIpKSAmJg0KICAgICAgICAgICAgZG9tVXRpbHMuZmluZFBhcmVudEJ5VGFnTmFtZShzdGFydFRkLCAndGFibGUnKSA9PSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKGN1cnJlbnRUZCwgJ3RhYmxlJykpIHsNCiAgICAgICAgICAgIHZhciB1dCA9IGdldFVFVGFibGUoY3VycmVudFRkKTsNCiAgICAgICAgICAgIGlmIChzdGFydFRkICE9IGN1cnJlbnRUZCkgew0KICAgICAgICAgICAgICAgIG1lLmRvY3VtZW50LmJvZHkuc3R5bGUud2Via2l0VXNlclNlbGVjdCA9ICdub25lJzsNCiAgICAgICAgICAgICAgICBtZS5zZWxlY3Rpb24uZ2V0TmF0aXZlKClbYnJvd3Nlci5pZSA/ICdlbXB0eScgOiAncmVtb3ZlQWxsUmFuZ2VzJ10oKTsNCiAgICAgICAgICAgICAgICB2YXIgcmFuZ2UgPSB1dC5nZXRDZWxsc1JhbmdlKHN0YXJ0VGQsIGN1cnJlbnRUZCk7DQogICAgICAgICAgICAgICAgdXQuc2V0U2VsZWN0ZWQocmFuZ2UpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBtZS5kb2N1bWVudC5ib2R5LnN0eWxlLndlYmtpdFVzZXJTZWxlY3QgPSAnJzsNCiAgICAgICAgICAgICAgICB1dC5jbGVhclNlbGVjdGVkKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KICAgICAgICBldnQucHJldmVudERlZmF1bHQgPyBldnQucHJldmVudERlZmF1bHQoKSA6IChldnQucmV0dXJuVmFsdWUgPSBmYWxzZSk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2V0Q2VsbEhlaWdodChjZWxsLCBoZWlnaHQsIGJhY2tIZWlnaHQpIHsNCiAgICAgICAgdmFyIGxpbmVIaWdodCA9IHBhcnNlSW50KGRvbVV0aWxzLmdldENvbXB1dGVkU3R5bGUoY2VsbCwgImxpbmUtaGVpZ2h0IiksIDEwKSwNCiAgICAgICAgICAgIHRtcEhlaWdodCA9IGJhY2tIZWlnaHQgKyBoZWlnaHQ7DQogICAgICAgIGhlaWdodCA9IHRtcEhlaWdodCA8IGxpbmVIaWdodCA/IGxpbmVIaWdodCA6IHRtcEhlaWdodDsNCiAgICAgICAgaWYgKGNlbGwuc3R5bGUuaGVpZ2h0KSBjZWxsLnN0eWxlLmhlaWdodCA9ICIiOw0KICAgICAgICBjZWxsLnJvd1NwYW4gPT0gMSA/IGNlbGwuc2V0QXR0cmlidXRlKCJoZWlnaHQiLCBoZWlnaHQpIDogKGNlbGwucmVtb3ZlQXR0cmlidXRlICYmIGNlbGwucmVtb3ZlQXR0cmlidXRlKCJoZWlnaHQiKSk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZ2V0V2lkdGgoY2VsbCkgew0KICAgICAgICBpZiAoIWNlbGwpcmV0dXJuIDA7DQogICAgICAgIHJldHVybiBwYXJzZUludChkb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKGNlbGwsICJ3aWR0aCIpLCAxMCk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gY2hhbmdlQ29sV2lkdGgoY2VsbCwgY2hhbmdlVmFsdWUpIHsNCg0KICAgICAgICB2YXIgdXQgPSBnZXRVRVRhYmxlKGNlbGwpOw0KICAgICAgICBpZiAodXQpIHsNCg0KICAgICAgICAgICAgLy/moLnmja7lvZPliY3np7vliqjnmoTovrnmoYbojrflj5bnm7jlhbPnmoTljZXlhYPmoLwNCiAgICAgICAgICAgIHZhciB0YWJsZSA9IHV0LnRhYmxlLA0KICAgICAgICAgICAgICAgIGNlbGxzID0gZ2V0Q2VsbHNCeU1vdmVCb3JkZXIoIGNlbGwsIHRhYmxlICk7DQoNCiAgICAgICAgICAgIHRhYmxlLnN0eWxlLndpZHRoID0gIiI7DQogICAgICAgICAgICB0YWJsZS5yZW1vdmVBdHRyaWJ1dGUoIndpZHRoIik7DQoNCiAgICAgICAgICAgIC8v5L+u5q2j5pS55Y+Y6YePDQogICAgICAgICAgICBjaGFuZ2VWYWx1ZSA9IGNvcnJlY3RDaGFuZ2VWYWx1ZSggY2hhbmdlVmFsdWUsIGNlbGwsIGNlbGxzICk7DQoNCiAgICAgICAgICAgIGlmIChjZWxsLm5leHRTaWJsaW5nKSB7DQoNCiAgICAgICAgICAgICAgICB2YXIgaT0wOw0KDQogICAgICAgICAgICAgICAgdXRpbHMuZWFjaCggY2VsbHMsIGZ1bmN0aW9uKCBjZWxsR3JvdXAgKXsNCg0KICAgICAgICAgICAgICAgICAgICBjZWxsR3JvdXAubGVmdC53aWR0aCA9ICgrY2VsbEdyb3VwLmxlZnQud2lkdGgpK2NoYW5nZVZhbHVlOw0KICAgICAgICAgICAgICAgICAgICBjZWxsR3JvdXAucmlnaHQgJiYgKCBjZWxsR3JvdXAucmlnaHQud2lkdGggPSAoK2NlbGxHcm91cC5yaWdodC53aWR0aCktY2hhbmdlVmFsdWUgKTsNCg0KICAgICAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgIHV0aWxzLmVhY2goIGNlbGxzLCBmdW5jdGlvbiggY2VsbEdyb3VwICl7DQogICAgICAgICAgICAgICAgICAgIGNlbGxHcm91cC5sZWZ0LndpZHRoIC09IC1jaGFuZ2VWYWx1ZTsNCiAgICAgICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgfQ0KDQogICAgZnVuY3Rpb24gaXNFZGl0b3JEaXNhYmxlZCgpIHsNCiAgICAgICAgcmV0dXJuIG1lLmJvZHkuY29udGVudEVkaXRhYmxlID09PSAiZmFsc2UiOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGNoYW5nZVJvd0hlaWdodCh0ZCwgY2hhbmdlVmFsdWUpIHsNCiAgICAgICAgaWYgKE1hdGguYWJzKGNoYW5nZVZhbHVlKSA8IDEwKSByZXR1cm47DQogICAgICAgIHZhciB1dCA9IGdldFVFVGFibGUodGQpOw0KICAgICAgICBpZiAodXQpIHsNCiAgICAgICAgICAgIHZhciBjZWxscyA9IHV0LmdldFNhbWVFbmRQb3NDZWxscyh0ZCwgInkiKSwNCiAgICAgICAgICAgIC8v5aSH5Lu96ZyA6KaB6L+e5bim5Y+Y5YyW55qEdGTnmoTljp/lp4vpq5jluqbvvIzlkKbliJnlkI7mnJ/ml6Dms5Xojrflj5bmraPnoa7nmoTlgLwNCiAgICAgICAgICAgICAgICBiYWNrSGVpZ2h0ID0gY2VsbHNbMF0gPyBjZWxsc1swXS5vZmZzZXRIZWlnaHQgOiAwOw0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNlbGw7IGNlbGwgPSBjZWxsc1tpKytdOykgew0KICAgICAgICAgICAgICAgIHNldENlbGxIZWlnaHQoY2VsbCwgY2hhbmdlVmFsdWUsIGJhY2tIZWlnaHQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5bosIPmlbTljZXlhYPmoLzlpKflsI/nmoTnm7jlhbPljZXlhYPmoLwNCiAgICAgKiBAaXNDb250YWluTWVyZ2VDZWxsIOi/lOWbnueahOe7k+aenOS4reaYr+WQpuWMheWQq+WPkeeUn+WQiOW5tuWQjueahOWNleWFg+agvA0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGdldENlbGxzQnlNb3ZlQm9yZGVyKCBjZWxsLCB0YWJsZSwgaXNDb250YWluTWVyZ2VDZWxsICkgew0KDQogICAgICAgIGlmKCAhdGFibGUgKSB7DQogICAgICAgICAgICB0YWJsZSA9IGRvbVV0aWxzLmZpbmRQYXJlbnRCeVRhZ05hbWUoIGNlbGwsICd0YWJsZScgKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmKCAhdGFibGUgKSB7DQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgfQ0KDQogICAgICAgIC8v6I635Y+W5Yiw6K+l5Y2V5YWD5qC85omA5Zyo6KGM55qE5bqP5YiX5Y+3DQogICAgICAgIHZhciBpbmRleCA9IGRvbVV0aWxzLmdldE5vZGVJbmRleCggY2VsbCApLA0KICAgICAgICAgICAgdGVtcCA9IGNlbGwsDQogICAgICAgICAgICByb3dzID0gdGFibGUucm93cywNCiAgICAgICAgICAgIGNvbEluZGV4ID0gMDsNCg0KICAgICAgICB3aGlsZSggdGVtcCApIHsNCiAgICAgICAgICAgIC8v6I635Y+W5Yiw5b2T5YmN5Y2V5YWD5qC85Zyo5pyq5Y+R55Sf5Y2V5YWD5qC85ZCI5bm25pe255qE5bqP5YiXDQogICAgICAgICAgICBpZiggdGVtcC5ub2RlVHlwZSA9PT0gMSApIHsNCiAgICAgICAgICAgICAgICBjb2xJbmRleCArPSAodGVtcC5jb2xTcGFuIHx8IDEpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGVtcCA9IHRlbXAucHJldmlvdXNTaWJsaW5nOw0KICAgICAgICB9DQoNCiAgICAgICAgdGVtcCA9IG51bGw7DQoNCiAgICAgICAgLy/orrDlvZXmg7PlhbPnmoTljZXlhYPmoLwNCiAgICAgICAgdmFyIGJvcmRlckNlbGxzID0gW107DQoNCiAgICAgICAgdXRpbHMuZWFjaChyb3dzLCBmdW5jdGlvbiggdGFiUm93ICl7DQoNCiAgICAgICAgICAgIHZhciBjZWxscyA9IHRhYlJvdy5jZWxscywNCiAgICAgICAgICAgICAgICBjdXJySW5kZXggPSAwOw0KDQogICAgICAgICAgICB1dGlscy5lYWNoKCBjZWxscywgZnVuY3Rpb24oIHRhYkNlbGwgKXsNCg0KICAgICAgICAgICAgICAgIGN1cnJJbmRleCArPSAodGFiQ2VsbC5jb2xTcGFuIHx8IDEpOw0KDQogICAgICAgICAgICAgICAgaWYoIGN1cnJJbmRleCA9PT0gY29sSW5kZXggKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgYm9yZGVyQ2VsbHMucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiB0YWJDZWxsLA0KICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQ6IHRhYkNlbGwubmV4dFNpYmxpbmcgfHwgbnVsbA0KICAgICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQoNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYoIGN1cnJJbmRleCA+IGNvbEluZGV4ICkgew0KDQogICAgICAgICAgICAgICAgICAgIGlmKCBpc0NvbnRhaW5NZXJnZUNlbGwgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBib3JkZXJDZWxscy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiB0YWJDZWxsDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgIH0pOw0KDQogICAgICAgIHJldHVybiBib3JkZXJDZWxsczsNCg0KICAgIH0NCg0KDQogICAgLyoqDQogICAgICog6YCa6L+H57uZ5a6a55qE5Y2V5YWD5qC86ZuG5ZCI6I635Y+W5pyA5bCP55qE5Y2V5YWD5qC8d2lkdGgNCiAgICAgKi8NCiAgICBmdW5jdGlvbiBnZXRNaW5XaWR0aEJ5VGFibGVDZWxscyggY2VsbHMgKSB7DQoNCiAgICAgICAgdmFyIG1pbldpZHRoID0gTnVtYmVyLk1BWF9WQUxVRTsNCg0KICAgICAgICBmb3IoIHZhciBpID0gMCwgY3VyQ2VsbDsgY3VyQ2VsbCA9IGNlbGxzWyBpIF0gOyBpKysgKSB7DQoNCiAgICAgICAgICAgIG1pbldpZHRoID0gTWF0aC5taW4oIG1pbldpZHRoLCBjdXJDZWxsLndpZHRoIHx8IGdldFRhYmxlQ2VsbFdpZHRoKCBjdXJDZWxsICkgKTsNCg0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIG1pbldpZHRoOw0KDQogICAgfQ0KDQogICAgZnVuY3Rpb24gY29ycmVjdENoYW5nZVZhbHVlKCBjaGFuZ2VWYWx1ZSwgcmVsYXRlZENlbGwsIGNlbGxzICkgew0KDQogICAgICAgIC8v5Li65Y2V5YWD5qC855qEcGFhZGluZ+mihOeVmeepuumXtA0KICAgICAgICBjaGFuZ2VWYWx1ZSAtPSBnZXRUYWJjZWxsU3BhY2UoKTsNCg0KICAgICAgICBpZiggY2hhbmdlVmFsdWUgPCAwICkgew0KICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgIH0NCg0KICAgICAgICBjaGFuZ2VWYWx1ZSAtPSBnZXRUYWJsZUNlbGxXaWR0aCggcmVsYXRlZENlbGwgKTsNCg0KICAgICAgICAvL+ehruWumuaWueWQkQ0KICAgICAgICB2YXIgZGlyZWN0aW9uID0gY2hhbmdlVmFsdWUgPCAwID8gJ2xlZnQnOidyaWdodCc7DQoNCiAgICAgICAgY2hhbmdlVmFsdWUgPSBNYXRoLmFicyhjaGFuZ2VWYWx1ZSk7DQoNCiAgICAgICAgLy/lj6rlhbPlv4PpnZ7mnIDlkI7kuIDkuKrljZXlhYPmoLzlsLHlj6/ku6UNCiAgICAgICAgdXRpbHMuZWFjaCggY2VsbHMsIGZ1bmN0aW9uKCBjZWxsR3JvdXAgKXsNCg0KICAgICAgICAgICAgdmFyIGN1ckNlbGwgPSBjZWxsR3JvdXBbZGlyZWN0aW9uXTsNCg0KICAgICAgICAgICAgLy/kuLrljZXlhYPmoLzkv53nlZnmnIDlsI/nqbrpl7QNCiAgICAgICAgICAgIGlmKCBjdXJDZWxsICkgew0KICAgICAgICAgICAgICAgIGNoYW5nZVZhbHVlID0gTWF0aC5taW4oIGNoYW5nZVZhbHVlLCBnZXRUYWJsZUNlbGxXaWR0aCggY3VyQ2VsbCApLWNlbGxNaW5XaWR0aCApOw0KICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgfSApOw0KDQoNCiAgICAgICAgLy/kv67mraPotornlYwNCiAgICAgICAgY2hhbmdlVmFsdWUgPSBjaGFuZ2VWYWx1ZSA8IDAgPyAwIDogY2hhbmdlVmFsdWU7DQoNCiAgICAgICAgcmV0dXJuIGRpcmVjdGlvbiA9PT0gJ2xlZnQnID8gLWNoYW5nZVZhbHVlIDogY2hhbmdlVmFsdWU7DQoNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBnZXRUYWJsZUNlbGxXaWR0aCggY2VsbCApIHsNCg0KICAgICAgICB2YXIgd2lkdGggPSAwLA0KICAgICAgICAgICAgLy/lgY/np7vnuqDmraPph48NCiAgICAgICAgICAgIG9mZnNldCA9IDAsDQogICAgICAgICAgICB3aWR0aCA9IGNlbGwub2Zmc2V0V2lkdGggLSBnZXRUYWJjZWxsU3BhY2UoKTsNCg0KICAgICAgICAvL+acgOWQjuS4gOS4quiKgueCuee6oOato+S4gOS4iw0KICAgICAgICBpZiggIWNlbGwubmV4dFNpYmxpbmcgKSB7DQoNCiAgICAgICAgICAgIHdpZHRoIC09IGdldFRhYmxlQ2VsbE9mZnNldCggY2VsbCApOw0KDQogICAgICAgIH0NCg0KICAgICAgICB3aWR0aCA9IHdpZHRoIDwgMCA/IDAgOiB3aWR0aDsNCg0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgY2VsbC53aWR0aCA9IHdpZHRoOw0KICAgICAgICB9IGNhdGNoKGUpIHsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB3aWR0aDsNCg0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPluWNleWFg+agvOaJgOWcqOihqOagvOeahOacgOacq+WNleWFg+agvOeahOWBj+enu+mHjw0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGdldFRhYmxlQ2VsbE9mZnNldCggY2VsbCApIHsNCg0KICAgICAgICB0YWIgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKCBjZWxsLCAidGFibGUiLCBmYWxzZSk7DQoNCiAgICAgICAgaWYoIHRhYi5vZmZzZXRWYWwgPT09IHVuZGVmaW5lZCApIHsNCg0KICAgICAgICAgICAgdmFyIHByZXYgPSBjZWxsLnByZXZpb3VzU2libGluZzsNCg0KICAgICAgICAgICAgaWYoIHByZXYgKSB7DQoNCiAgICAgICAgICAgICAgICAvL+acgOWQjuS4gOS4quWNleWFg+agvOWSjOWJjeS4gOS4quWNleWFg+agvOeahHdpZHRoIGRpZmbnu5Pmnpwg5aaC5p6c5oGw5aW95Li65LiA5LiqYm9yZGVyIHdpZHRo77yMIOWImeadoeS7tuaIkOeriw0KICAgICAgICAgICAgICAgIHRhYi5vZmZzZXRWYWwgPSBjZWxsLm9mZnNldFdpZHRoIC0gcHJldi5vZmZzZXRXaWR0aCA9PT0gVVQuYm9yZGVyV2lkdGggPyBVVC5ib3JkZXJXaWR0aCA6IDA7DQoNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGFiLm9mZnNldFZhbCA9IDA7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0YWIub2Zmc2V0VmFsOw0KDQogICAgfQ0KDQogICAgZnVuY3Rpb24gZ2V0VGFiY2VsbFNwYWNlKCkgew0KDQogICAgICAgIGlmKCBVVC50YWJjZWxsU3BhY2UgPT09IHVuZGVmaW5lZCApIHsNCg0KICAgICAgICAgICAgdmFyIGNlbGwgPSBudWxsLA0KICAgICAgICAgICAgICAgIHRhYiA9IG1lLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRhYmxlIiksDQogICAgICAgICAgICAgICAgdGJvZHkgPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0Ym9keSIpLA0KICAgICAgICAgICAgICAgIHRyb3cgPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ciIpLA0KICAgICAgICAgICAgICAgIHRhYmNlbGwgPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ZCIpLA0KICAgICAgICAgICAgICAgIG1pcnJvciA9IG51bGw7DQoNCiAgICAgICAgICAgIHRhYmNlbGwuc3R5bGUuY3NzVGV4dCA9ICdib3JkZXI6IDA7JzsNCiAgICAgICAgICAgIHRhYmNlbGwud2lkdGggPSAxOw0KDQogICAgICAgICAgICB0cm93LmFwcGVuZENoaWxkKCB0YWJjZWxsICk7DQogICAgICAgICAgICB0cm93LmFwcGVuZENoaWxkKCBtaXJyb3IgPSB0YWJjZWxsLmNsb25lTm9kZSggZmFsc2UgKSApOw0KDQogICAgICAgICAgICB0Ym9keS5hcHBlbmRDaGlsZCggdHJvdyApOw0KDQogICAgICAgICAgICB0YWIuYXBwZW5kQ2hpbGQoIHRib2R5ICk7DQoNCiAgICAgICAgICAgIHRhYi5zdHlsZS5jc3NUZXh0ID0gInZpc2liaWxpdHk6IGhpZGRlbjsiOw0KDQogICAgICAgICAgICBtZS5ib2R5LmFwcGVuZENoaWxkKCB0YWIgKTsNCg0KICAgICAgICAgICAgVVQucGFkZGluZ1NwYWNlID0gdGFiY2VsbC5vZmZzZXRXaWR0aCAtIDE7DQoNCiAgICAgICAgICAgIHZhciB0bXBUYWJXaWR0aCA9IHRhYi5vZmZzZXRXaWR0aDsNCg0KICAgICAgICAgICAgdGFiY2VsbC5zdHlsZS5jc3NUZXh0ID0gJyc7DQogICAgICAgICAgICBtaXJyb3Iuc3R5bGUuY3NzVGV4dCA9ICcnOw0KDQogICAgICAgICAgICBVVC5ib3JkZXJXaWR0aCA9ICggdGFiLm9mZnNldFdpZHRoIC0gdG1wVGFiV2lkdGggKSAvIDM7DQoNCiAgICAgICAgICAgIFVULnRhYmNlbGxTcGFjZSA9IFVULnBhZGRpbmdTcGFjZSArIFVULmJvcmRlcldpZHRoOw0KDQogICAgICAgICAgICBtZS5ib2R5LnJlbW92ZUNoaWxkKCB0YWIgKTsNCg0KICAgICAgICB9DQoNCiAgICAgICAgZ2V0VGFiY2VsbFNwYWNlID0gZnVuY3Rpb24oKXsgcmV0dXJuIFVULnRhYmNlbGxTcGFjZTsgfTsNCg0KICAgICAgICByZXR1cm4gVVQudGFiY2VsbFNwYWNlOw0KDQogICAgfQ0KDQogICAgZnVuY3Rpb24gZ2V0RHJhZ0xpbmUoZWRpdG9yLCBkb2MpIHsNCiAgICAgICAgaWYgKG1vdXNlZG93bilyZXR1cm47DQogICAgICAgIGRyYWdMaW5lID0gZWRpdG9yLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOw0KICAgICAgICBkb21VdGlscy5zZXRBdHRyaWJ1dGVzKGRyYWdMaW5lLCB7DQogICAgICAgICAgICBpZDoidWVfdGFibGVEcmFnTGluZSIsDQogICAgICAgICAgICB1bnNlbGVjdGFibGU6J29uJywNCiAgICAgICAgICAgIGNvbnRlbnRlZGl0YWJsZTpmYWxzZSwNCiAgICAgICAgICAgICdvbnJlc2l6ZXN0YXJ0JzoncmV0dXJuIGZhbHNlJywNCiAgICAgICAgICAgICdvbmRyYWdzdGFydCc6J3JldHVybiBmYWxzZScsDQogICAgICAgICAgICAnb25zZWxlY3RzdGFydCc6J3JldHVybiBmYWxzZScsDQogICAgICAgICAgICBzdHlsZToiYmFja2dyb3VuZC1jb2xvcjpibHVlO3Bvc2l0aW9uOmFic29sdXRlO3BhZGRpbmc6MDttYXJnaW46MDtiYWNrZ3JvdW5kLWltYWdlOm5vbmU7Ym9yZGVyOjBweCBub25lO29wYWNpdHk6MDtmaWx0ZXI6YWxwaGEob3BhY2l0eT0wKSINCiAgICAgICAgfSk7DQogICAgICAgIGVkaXRvci5ib2R5LmFwcGVuZENoaWxkKGRyYWdMaW5lKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBoaWRlRHJhZ0xpbmUoZWRpdG9yKSB7DQogICAgICAgIGlmIChtb3VzZWRvd24pcmV0dXJuOw0KICAgICAgICB2YXIgbGluZTsNCiAgICAgICAgd2hpbGUgKGxpbmUgPSBlZGl0b3IuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VlX3RhYmxlRHJhZ0xpbmUnKSkgew0KICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKGxpbmUpDQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDkvp3mja5zdGF0Ze+8iHZ8aO+8ieWcqGNlbGzkvY3nva7mmL7npLrmqKrnur8NCiAgICAgKiBAcGFyYW0gc3RhdGUNCiAgICAgKiBAcGFyYW0gY2VsbA0KICAgICAqLw0KICAgIGZ1bmN0aW9uIHNob3dEcmFnTGluZUF0KHN0YXRlLCBjZWxsKSB7DQogICAgICAgIGlmICghY2VsbCkgcmV0dXJuOw0KICAgICAgICB2YXIgdGFibGUgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKGNlbGwsICJ0YWJsZSIpLA0KICAgICAgICAgICAgY2FwdGlvbiA9IHRhYmxlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdjYXB0aW9uJyksDQogICAgICAgICAgICB3aWR0aCA9IHRhYmxlLm9mZnNldFdpZHRoLA0KICAgICAgICAgICAgaGVpZ2h0ID0gdGFibGUub2Zmc2V0SGVpZ2h0IC0gKGNhcHRpb24ubGVuZ3RoID4gMCA/IGNhcHRpb25bMF0ub2Zmc2V0SGVpZ2h0IDogMCksDQogICAgICAgICAgICB0YWJsZVBvcyA9IGRvbVV0aWxzLmdldFhZKHRhYmxlKSwNCiAgICAgICAgICAgIGNlbGxQb3MgPSBkb21VdGlscy5nZXRYWShjZWxsKSwgY3NzOw0KICAgICAgICBzd2l0Y2ggKHN0YXRlKSB7DQogICAgICAgICAgICBjYXNlICJoIjoNCiAgICAgICAgICAgICAgICBjc3MgPSAnaGVpZ2h0OicgKyBoZWlnaHQgKyAncHg7dG9wOicgKyAodGFibGVQb3MueSArIChjYXB0aW9uLmxlbmd0aCA+IDAgPyBjYXB0aW9uWzBdLm9mZnNldEhlaWdodCA6IDApKSArICdweDtsZWZ0OicgKyAoY2VsbFBvcy54ICsgY2VsbC5vZmZzZXRXaWR0aCk7DQogICAgICAgICAgICAgICAgZHJhZ0xpbmUuc3R5bGUuY3NzVGV4dCA9IGNzcyArICdweDtwb3NpdGlvbjogYWJzb2x1dGU7ZGlzcGxheTpibG9jaztiYWNrZ3JvdW5kLWNvbG9yOmJsdWU7d2lkdGg6MXB4O2JvcmRlcjowOyBjb2xvcjpibHVlO29wYWNpdHk6LjM7ZmlsdGVyOmFscGhhKG9wYWNpdHk9MzApJzsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgInYiOg0KICAgICAgICAgICAgICAgIGNzcyA9ICd3aWR0aDonICsgd2lkdGggKyAncHg7bGVmdDonICsgdGFibGVQb3MueCArICdweDt0b3A6JyArIChjZWxsUG9zLnkgKyBjZWxsLm9mZnNldEhlaWdodCApOw0KICAgICAgICAgICAgICAgIC8v5b+F6aG75Yqg5LiKYm9yZGVyOjDlkoxjb2xvcjpibHVl77yM5ZCm5YiZ5L2O54mIaWXkuI3mlK/mjIHog4zmma/oibLmmL7npLoNCiAgICAgICAgICAgICAgICBkcmFnTGluZS5zdHlsZS5jc3NUZXh0ID0gY3NzICsgJ3B4O292ZXJmbG93OmhpZGRlbjtwb3NpdGlvbjogYWJzb2x1dGU7ZGlzcGxheTpibG9jaztiYWNrZ3JvdW5kLWNvbG9yOmJsdWU7aGVpZ2h0OjFweDtib3JkZXI6MDtjb2xvcjpibHVlO29wYWNpdHk6LjI7ZmlsdGVyOmFscGhhKG9wYWNpdHk9MjApJzsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDlvZPooajmoLzovrnmoYbpopzoibLkuLrnmb3oibLml7borr7nva7kuLromZrnur8sdHJ1ZeS4uua3u+WKoOiZmue6vw0KICAgICAqIEBwYXJhbSBlZGl0b3INCiAgICAgKiBAcGFyYW0gZmxhZw0KICAgICAqLw0KICAgIGZ1bmN0aW9uIHN3aXRjaEJvcmRlckNvbG9yKGVkaXRvciwgZmxhZykgew0KICAgICAgICB2YXIgdGFibGVBcnIgPSBkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZShlZGl0b3IuYm9keSwgInRhYmxlIiksIGNvbG9yOw0KICAgICAgICBmb3IgKHZhciBpID0gMCwgbm9kZTsgbm9kZSA9IHRhYmxlQXJyW2krK107KSB7DQogICAgICAgICAgICB2YXIgdGQgPSBkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZShub2RlLCAidGQiKTsNCiAgICAgICAgICAgIGlmICh0ZFswXSkgew0KICAgICAgICAgICAgICAgIGlmIChmbGFnKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbG9yID0gKHRkWzBdLnN0eWxlLmJvcmRlckNvbG9yKS5yZXBsYWNlKC9ccy9nLCAiIik7DQogICAgICAgICAgICAgICAgICAgIGlmICgvKCNmZmZmZmYpfChyZ2JcKDI1NSxmNTUsMjU1XCkpL2lnLnRlc3QoY29sb3IpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMuYWRkQ2xhc3Mobm9kZSwgIm5vQm9yZGVyVGFibGUiKQ0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZUNsYXNzZXMobm9kZSwgIm5vQm9yZGVyVGFibGUiKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZ2V0VGFibGVXaWR0aChlZGl0b3IsIG5lZWRJRUhhY2ssIGRlZmF1bHRWYWx1ZSkgew0KICAgICAgICB2YXIgYm9keSA9IGVkaXRvci5ib2R5Ow0KICAgICAgICByZXR1cm4gYm9keS5vZmZzZXRXaWR0aCAtIChuZWVkSUVIYWNrID8gcGFyc2VJbnQoZG9tVXRpbHMuZ2V0Q29tcHV0ZWRTdHlsZShib2R5LCAnbWFyZ2luLWxlZnQnKSwgMTApICogMiA6IDApIC0gZGVmYXVsdFZhbHVlLnRhYmxlQm9yZGVyICogMiAtIChlZGl0b3Iub3B0aW9ucy5vZmZzZXRXaWR0aCB8fCAwKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5blvZPliY3mi5bliqjnmoTljZXlhYPmoLwNCiAgICAgKi8NCiAgICBmdW5jdGlvbiBnZXRUYXJnZXRUZChlZGl0b3IsIGV2dCkgew0KDQogICAgICAgIHZhciB0YXJnZXQgPSBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKGV2dC50YXJnZXQgfHwgZXZ0LnNyY0VsZW1lbnQsIFsidGQiLCAidGgiXSwgdHJ1ZSksDQogICAgICAgICAgICBkaXIgPSBudWxsOw0KDQogICAgICAgIGlmKCAhdGFyZ2V0ICkgew0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIH0NCg0KICAgICAgICBkaXIgPSBnZXRSZWxhdGlvbiggdGFyZ2V0LCBtb3VzZUNvb3JkcyggZXZ0ICkgKTsNCg0KICAgICAgICAvL+WmguaenOacieWJjeS4gOS4quiKgueCue+8jCDpnIDopoHlgZrkuIDkuKrkv67mraPvvIwg5ZCm5YiZ5Y+v6IO95Lya5b6X5Yiw5LiA5Liq6ZSZ6K+v55qEdGQNCg0KICAgICAgICBpZiggIXRhcmdldCApIHsNCiAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYoIGRpciA9PT0gJ2gxJyAmJiB0YXJnZXQucHJldmlvdXNTaWJsaW5nICkgew0KDQogICAgICAgICAgICB2YXIgcG9zaXRpb24gPSBkb21VdGlscy5nZXRYWSggdGFyZ2V0KSwNCiAgICAgICAgICAgICAgICBjZWxsV2lkdGggPSB0YXJnZXQub2Zmc2V0V2lkdGg7DQoNCiAgICAgICAgICAgIGlmKCBNYXRoLmFicyggcG9zaXRpb24ueCArIGNlbGxXaWR0aCAtIGV2dC5jbGllbnRYICkgPiBjZWxsV2lkdGggLyAzICkgew0KICAgICAgICAgICAgICAgIHRhcmdldCA9IHRhcmdldC5wcmV2aW91c1NpYmxpbmc7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfSBlbHNlIGlmKCBkaXIgPT09ICd2MScgJiYgdGFyZ2V0LnBhcmVudE5vZGUucHJldmlvdXNTaWJsaW5nICkgew0KDQogICAgICAgICAgICB2YXIgcG9zaXRpb24gPSBkb21VdGlscy5nZXRYWSggdGFyZ2V0KSwNCiAgICAgICAgICAgICAgICBjZWxsSGVpZ2h0ID0gdGFyZ2V0Lm9mZnNldEhlaWdodDsNCg0KICAgICAgICAgICAgaWYoIE1hdGguYWJzKCBwb3NpdGlvbi55ICsgY2VsbEhlaWdodCAtIGV2dC5jbGllbnRZICkgPiBjZWxsSGVpZ2h0IC8gMyApIHsNCiAgICAgICAgICAgICAgICB0YXJnZXQgPSB0YXJnZXQucGFyZW50Tm9kZS5wcmV2aW91c1NpYmxpbmcuZmlyc3RDaGlsZDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9DQoNCg0KICAgICAgICAvL+aOkumZpOS6humdnnRk5YaF6YOo5Lul5Y+K55So5LqO5Luj56CB6auY5Lqu6YOo5YiG55qEdGQNCiAgICAgICAgcmV0dXJuIHRhcmdldCAmJiAhKGVkaXRvci5maXJlRXZlbnQoImV4Y2x1ZGV0YWJsZSIsIHRhcmdldCkgPT09IHRydWUpID8gdGFyZ2V0IDogbnVsbDsNCiAgICB9DQoNCn07DQoKLy8vaW1wb3J0IGNvcmUNCi8vL2NvbW1hbmRzIOWPs+mUruiPnOWNlQ0KLy8vY29tbWFuZHNOYW1lICBDb250ZXh0TWVudQ0KLy8vY29tbWFuZHNUaXRsZSAg5Y+z6ZSu6I+c5Y2VDQovKioNCiAqIOWPs+mUruiPnOWNlQ0KICogQGZ1bmN0aW9uDQogKiBAbmFtZSBiYWlkdS5lZGl0b3IucGx1Z2lucy5jb250ZXh0bWVudQ0KICogQGF1dGhvciB6aGFueWkNCiAqLw0KDQpVRS5wbHVnaW5zWydjb250ZXh0bWVudSddID0gZnVuY3Rpb24gKCkgew0KICAgIHZhciBtZSA9IHRoaXMsDQogICAgICAgICAgICBsYW5nID0gbWUuZ2V0TGFuZyggImNvbnRleHRNZW51IiApLA0KICAgICAgICAgICAgbWVudSwNCiAgICAgICAgICAgIGl0ZW1zID0gbWUub3B0aW9ucy5jb250ZXh0TWVudSB8fCBbDQogICAgICAgICAgICAgICAge2xhYmVsOmxhbmdbJ3NlbGVjdGFsbCddLCBjbWROYW1lOidzZWxlY3RhbGwnfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGxhYmVsOmxhbmcuZGVsZXRlY29kZSwNCiAgICAgICAgICAgICAgICAgICAgY21kTmFtZTonaGlnaGxpZ2h0Y29kZScsDQogICAgICAgICAgICAgICAgICAgIGljb246J2RlbGV0ZWhpZ2hsaWdodGNvZGUnDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGxhYmVsOmxhbmcuY2xlYXJkb2MsDQogICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6J2NsZWFyZG9jJywNCiAgICAgICAgICAgICAgICAgICAgZXhlYzpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGNvbmZpcm0oIGxhbmcuY29uZmlybWNsZWFyICkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5leGVjQ29tbWFuZCggJ2NsZWFyZG9jJyApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAnLScsDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBsYWJlbDpsYW5nLnVubGluaywNCiAgICAgICAgICAgICAgICAgICAgY21kTmFtZTondW5saW5rJw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgJy0nLA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgZ3JvdXA6bGFuZy5wYXJhZ3JhcGgsDQogICAgICAgICAgICAgICAgICAgIGljb246J2p1c3RpZnlqdXN0aWZ5JywNCiAgICAgICAgICAgICAgICAgICAgc3ViTWVudTpbDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6bGFuZy5qdXN0aWZ5bGVmdCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWROYW1lOidqdXN0aWZ5JywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTonbGVmdCcNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6bGFuZy5qdXN0aWZ5cmlnaHQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kTmFtZTonanVzdGlmeScsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6J3JpZ2h0Jw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDpsYW5nLmp1c3RpZnljZW50ZXIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kTmFtZTonanVzdGlmeScsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6J2NlbnRlcicNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6bGFuZy5qdXN0aWZ5anVzdGlmeSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWROYW1lOidqdXN0aWZ5JywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTonanVzdGlmeScNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgJy0nLA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgZ3JvdXA6bGFuZy50YWJsZSwNCiAgICAgICAgICAgICAgICAgICAgaWNvbjondGFibGUnLA0KICAgICAgICAgICAgICAgICAgICBzdWJNZW51OlsNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDpsYW5nLmluc2VydHRhYmxlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6J2luc2VydHRhYmxlJw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDpsYW5nLmRlbGV0ZXRhYmxlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6J2RlbGV0ZXRhYmxlJw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgICctJywNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDpsYW5nLmRlbGV0ZXJvdywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWROYW1lOidkZWxldGVyb3cnDQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOmxhbmcuZGVsZXRlY29sLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6J2RlbGV0ZWNvbCcNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6bGFuZy5pbnNlcnRjb2wsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kTmFtZTonaW5zZXJ0Y29sJw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDpsYW5nLmluc2VydGNvbG5leHQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kTmFtZTonaW5zZXJ0Y29sbmV4dCcNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6bGFuZy5pbnNlcnRyb3csDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kTmFtZTonaW5zZXJ0cm93Jw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDpsYW5nLmluc2VydHJvd25leHQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kTmFtZTonaW5zZXJ0cm93bmV4dCcNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICAnLScsDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6bGFuZy5pbnNlcnRjYXB0aW9uLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6J2luc2VydGNhcHRpb24nDQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOmxhbmcuZGVsZXRlY2FwdGlvbiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWROYW1lOidkZWxldGVjYXB0aW9uJw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDpsYW5nLmluc2VydHRpdGxlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6J2luc2VydHRpdGxlJw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDpsYW5nLmRlbGV0ZXRpdGxlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6J2RlbGV0ZXRpdGxlJw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgICctJywNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDpsYW5nLm1lcmdlY2VsbHMsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kTmFtZTonbWVyZ2VjZWxscycNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6bGFuZy5tZXJnZXJpZ2h0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6J21lcmdlcmlnaHQnDQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOmxhbmcubWVyZ2Vkb3duLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6J21lcmdlZG93bicNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICAnLScsDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6bGFuZy5zcGxpdHRvcm93cywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWROYW1lOidzcGxpdHRvcm93cycNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6bGFuZy5zcGxpdHRvY29scywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWROYW1lOidzcGxpdHRvY29scycNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6bGFuZy5zcGxpdHRvY2VsbHMsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kTmFtZTonc3BsaXR0b2NlbGxzJw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgICctJywNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDpsYW5nLmF2ZXJhZ2VEaXNlUm93LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6J2F2ZXJhZ2VkaXN0cmlidXRlcm93Jw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDpsYW5nLmF2ZXJhZ2VEaXNDb2wsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kTmFtZTonYXZlcmFnZWRpc3RyaWJ1dGVjb2wnDQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgJy0nLA0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOmxhbmcuZWRpdHRkLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6J2VkaXR0ZCcsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhlYzpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggVUUudWlbJ2VkaXR0ZCddICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFVFLnVpWydlZGl0dGQnXSggdGhpcyApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0RGlhbG9nKCdlZGl0dGQnKS5vcGVuKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDpsYW5nLmVkaXR0YWJsZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWROYW1lOidlZGl0dGFibGUnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4ZWM6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIFVFLnVpWydlZGl0dGFibGUnXSApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBVRS51aVsnZWRpdHRhYmxlJ10oIHRoaXMgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldERpYWxvZygnZWRpdHRhYmxlJykub3BlbigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBncm91cDpsYW5nLnRhYmxlc29ydCwNCiAgICAgICAgICAgICAgICAgICAgaWNvbjondGFibGVzb3J0JywNCiAgICAgICAgICAgICAgICAgICAgc3ViTWVudTpbDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6bGFuZy5yZXZlcnNlY3VycmVudCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWROYW1lOidzb3J0dGFibGUnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOjENCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6bGFuZy5vcmRlcmJ5YXNjLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6J3NvcnR0YWJsZScNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6bGFuZy5yZXZlcnNlYnlhc2MsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kTmFtZTonc29ydHRhYmxlJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGVjOmZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXhlY0NvbW1hbmQoInNvcnR0YWJsZSIsZnVuY3Rpb24odGQxLHRkMil7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUxID0gdGQxLmlubmVySFRNTCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTIgPSB0ZDIuaW5uZXJIVE1MOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlMi5sb2NhbGVDb21wYXJlKHZhbHVlMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6bGFuZy5vcmRlcmJ5bnVtLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6J3NvcnR0YWJsZScsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhlYzpmdW5jdGlvbigpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmV4ZWNDb21tYW5kKCJzb3J0dGFibGUiLGZ1bmN0aW9uKHRkMSx0ZDIpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlMSA9IHRkMVticm93c2VyLmllID8gJ2lubmVyVGV4dCc6J3RleHRDb250ZW50J10ubWF0Y2goL1xkKy8pLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlMiA9IHRkMlticm93c2VyLmllID8gJ2lubmVyVGV4dCc6J3RleHRDb250ZW50J10ubWF0Y2goL1xkKy8pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodmFsdWUxKSB2YWx1ZTEgPSArdmFsdWUxWzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodmFsdWUyKSB2YWx1ZTIgPSArdmFsdWUyWzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICh2YWx1ZTF8fDApIC0gKHZhbHVlMnx8MCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6bGFuZy5yZXZlcnNlYnludW0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kTmFtZTonc29ydHRhYmxlJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGVjOmZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXhlY0NvbW1hbmQoInNvcnR0YWJsZSIsZnVuY3Rpb24odGQxLHRkMil7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUxID0gdGQxW2Jyb3dzZXIuaWUgPyAnaW5uZXJUZXh0JzondGV4dENvbnRlbnQnXS5tYXRjaCgvXGQrLyksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUyID0gdGQyW2Jyb3dzZXIuaWUgPyAnaW5uZXJUZXh0JzondGV4dENvbnRlbnQnXS5tYXRjaCgvXGQrLyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih2YWx1ZTEpIHZhbHVlMSA9ICt2YWx1ZTFbMF07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih2YWx1ZTIpIHZhbHVlMiA9ICt2YWx1ZTJbMF07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHZhbHVlMnx8MCkgLSAodmFsdWUxfHwwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBdDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGdyb3VwOmxhbmcuYm9yZGVyYmssDQogICAgICAgICAgICAgICAgICAgIGljb246J2JvcmRlckJhY2snLA0KICAgICAgICAgICAgICAgICAgICBzdWJNZW51OlsNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDpsYW5nLnNldGNvbG9yLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6ImludGVybGFjZXRhYmxlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGVjOmZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXhlY0NvbW1hbmQoImludGVybGFjZXRhYmxlIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDpsYW5nLnVuc2V0Y29sb3IsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kTmFtZToidW5pbnRlcmxhY2V0YWJsZSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhlYzpmdW5jdGlvbigpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmV4ZWNDb21tYW5kKCJ1bmludGVybGFjZXRhYmxlIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDpsYW5nLnNldGJhY2tncm91bmQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kTmFtZToic2V0dGFibGViYWNrZ3JvdW5kIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGVjOmZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXhlY0NvbW1hbmQoInNldHRhYmxlYmFja2dyb3VuZCIse3JlcGVhdDp0cnVlLGNvbG9yTGlzdDpbIiNiYmIiLCIjY2NjIl19KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOmxhbmcudW5zZXRiYWNrZ3JvdW5kLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6ImNsZWFydGFibGViYWNrZ3JvdW5kIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGVjOmZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXhlY0NvbW1hbmQoImNsZWFydGFibGViYWNrZ3JvdW5kIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDpsYW5nLnJlZGFuZGJsdWUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kTmFtZToic2V0dGFibGViYWNrZ3JvdW5kIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGVjOmZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXhlY0NvbW1hbmQoInNldHRhYmxlYmFja2dyb3VuZCIse3JlcGVhdDp0cnVlLGNvbG9yTGlzdDpbInJlZCIsImJsdWUiXX0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6bGFuZy50aHJlZWNvbG9yZ3JhZGllbnQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kTmFtZToic2V0dGFibGViYWNrZ3JvdW5kIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGVjOmZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXhlY0NvbW1hbmQoInNldHRhYmxlYmFja2dyb3VuZCIse3JlcGVhdDp0cnVlLGNvbG9yTGlzdDpbIiNhYWEiLCIjYmJiIiwiI2NjYyJdfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBdDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGdyb3VwOmxhbmcuYWxpZ250ZCwNCiAgICAgICAgICAgICAgICAgICAgaWNvbjonYWxpZ250ZCcsDQogICAgICAgICAgICAgICAgICAgIHN1Yk1lbnU6Ww0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6J2NlbGxhbGlnbm1lbnQnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOnthbGlnbjonbGVmdCcsdkFsaWduOid0b3AnfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWROYW1lOidjZWxsYWxpZ25tZW50JywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTp7YWxpZ246J2NlbnRlcicsdkFsaWduOid0b3AnfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWROYW1lOidjZWxsYWxpZ25tZW50JywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTp7YWxpZ246J3JpZ2h0Jyx2QWxpZ246J3RvcCd9DQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6J2NlbGxhbGlnbm1lbnQnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOnthbGlnbjonbGVmdCcsdkFsaWduOidtaWRkbGUnfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWROYW1lOidjZWxsYWxpZ25tZW50JywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTp7YWxpZ246J2NlbnRlcicsdkFsaWduOidtaWRkbGUnfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWROYW1lOidjZWxsYWxpZ25tZW50JywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTp7YWxpZ246J3JpZ2h0Jyx2QWxpZ246J21pZGRsZSd9DQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6J2NlbGxhbGlnbm1lbnQnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOnthbGlnbjonbGVmdCcsdkFsaWduOidib3R0b20nfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWROYW1lOidjZWxsYWxpZ25tZW50JywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTp7YWxpZ246J2NlbnRlcicsdkFsaWduOidib3R0b20nfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWROYW1lOidjZWxsYWxpZ25tZW50JywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTp7YWxpZ246J3JpZ2h0Jyx2QWxpZ246J2JvdHRvbSd9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIF0NCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgZ3JvdXA6bGFuZy5hbGlnbnRhYmxlLA0KICAgICAgICAgICAgICAgICAgICBpY29uOidhbGlnbnRhYmxlJywNCiAgICAgICAgICAgICAgICAgICAgc3ViTWVudTpbDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kTmFtZTondGFibGVhbGlnbm1lbnQnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2xlZnQnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOmxhbmcudGFibGVsZWZ0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiJsZWZ0Ig0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWROYW1lOid0YWJsZWFsaWdubWVudCcsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnY2VudGVyJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDpsYW5nLnRhYmxlY2VudGVyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiJjZW50ZXIiDQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6J3RhYmxlYWxpZ25tZW50JywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdyaWdodCcsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6bGFuZy50YWJsZXJpZ2h0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiJyaWdodCINCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgJy0nLA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgbGFiZWw6bGFuZy5pbnNlcnRwYXJhZ3JhcGhiZWZvcmUsDQogICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6J2luc2VydHBhcmFncmFwaCcsDQogICAgICAgICAgICAgICAgICAgIHZhbHVlOnRydWUNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgbGFiZWw6bGFuZy5pbnNlcnRwYXJhZ3JhcGhhZnRlciwNCiAgICAgICAgICAgICAgICAgICAgY21kTmFtZTonaW5zZXJ0cGFyYWdyYXBoJw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBsYWJlbDpsYW5nWydjb3B5J10sDQogICAgICAgICAgICAgICAgICAgIGNtZE5hbWU6J2NvcHknLA0KICAgICAgICAgICAgICAgICAgICBleGVjOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCBsYW5nLmNvcHltc2cgKTsNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgcXVlcnk6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgbGFiZWw6bGFuZ1sncGFzdGUnXSwNCiAgICAgICAgICAgICAgICAgICAgY21kTmFtZToncGFzdGUnLA0KICAgICAgICAgICAgICAgICAgICBleGVjOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCBsYW5nLnBhc3RlbXNnICk7DQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIHF1ZXJ5OmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSx7DQogICAgICAgICAgICAgICAgICAgIGxhYmVsOmxhbmdbJ2hpZ2hsaWdodGNvZGUnXSwNCiAgICAgICAgICAgICAgICAgICAgY21kTmFtZTonaGlnaGxpZ2h0Y29kZScsDQogICAgICAgICAgICAgICAgICAgIGV4ZWM6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBVRS51aVsnaGlnaGxpZ2h0Y29kZSddICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBVRS51aVsnaGlnaGxpZ2h0Y29kZSddKCB0aGlzICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVpLl9kaWFsb2dzWydoaWdobGlnaHRjb2RlRGlhbG9nJ10ub3BlbigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgXTsNCiAgICBpZiAoICFpdGVtcy5sZW5ndGggKSB7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgdmFyIHVpVXRpbHMgPSBVRS51aS51aVV0aWxzOw0KDQogICAgbWUuYWRkTGlzdGVuZXIoICdjb250ZXh0bWVudScsIGZ1bmN0aW9uICggdHlwZSwgZXZ0ICkgew0KDQogICAgICAgIHZhciBvZmZzZXQgPSB1aVV0aWxzLmdldFZpZXdwb3J0T2Zmc2V0QnlFdmVudCggZXZ0ICk7DQogICAgICAgIG1lLmZpcmVFdmVudCggJ2JlZm9yZXNlbGVjdGlvbmNoYW5nZScgKTsNCiAgICAgICAgaWYgKCBtZW51ICkgew0KICAgICAgICAgICAgbWVudS5kZXN0cm95KCk7DQogICAgICAgIH0NCiAgICAgICAgZm9yICggdmFyIGkgPSAwLCB0aSwgY29udGV4dEl0ZW1zID0gW107IHRpID0gaXRlbXNbaV07IGkrKyApIHsNCiAgICAgICAgICAgIHZhciBsYXN0Ow0KICAgICAgICAgICAgKGZ1bmN0aW9uICggaXRlbSApIHsNCiAgICAgICAgICAgICAgICBpZiAoIGl0ZW0gPT0gJy0nICkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIChsYXN0ID0gY29udGV4dEl0ZW1zW2NvbnRleHRJdGVtcy5sZW5ndGggLSAxIF0gKSAmJiBsYXN0ICE9PSAnLScgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0SXRlbXMucHVzaCggJy0nICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCBpdGVtLmhhc093blByb3BlcnR5KCAiZ3JvdXAiICkgKSB7DQogICAgICAgICAgICAgICAgICAgIGZvciAoIHZhciBqID0gMCwgY2osIHN1Yk1lbnUgPSBbXTsgY2ogPSBpdGVtLnN1Yk1lbnVbal07IGorKyApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIChmdW5jdGlvbiAoIHN1Ykl0ZW0gKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBzdWJJdGVtID09ICctJyApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAobGFzdCA9IHN1Yk1lbnVbc3ViTWVudS5sZW5ndGggLSAxIF0gKSAmJiBsYXN0ICE9PSAnLScgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJNZW51LnB1c2goICctJyApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Yk1lbnUuc3BsaWNlKHN1Yk1lbnUubGVuZ3RoLTEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAobWUuY29tbWFuZHNbc3ViSXRlbS5jbWROYW1lXSB8fCBVRS5jb21tYW5kc1tzdWJJdGVtLmNtZE5hbWVdIHx8IHN1Ykl0ZW0ucXVlcnkpICYmDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHN1Ykl0ZW0ucXVlcnkgPyBzdWJJdGVtLnF1ZXJ5KCkgOiBtZS5xdWVyeUNvbW1hbmRTdGF0ZSggc3ViSXRlbS5jbWROYW1lICkpID4gLTEgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJNZW51LnB1c2goIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbGFiZWwnOnN1Ykl0ZW0ubGFiZWwgfHwgbWUuZ2V0TGFuZyggImNvbnRleHRNZW51LiIgKyBzdWJJdGVtLmNtZE5hbWUgKyAoc3ViSXRlbS52YWx1ZSB8fCAnJykgKXx8IiIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NsYXNzTmFtZSc6J2VkdWktZm9yLScgK3N1Ykl0ZW0uY21kTmFtZSArICggc3ViSXRlbS5jbGFzc05hbWUgPyAoICcgZWR1aS1mb3ItJyArIHN1Ykl0ZW0uY21kTmFtZSArICctJyArIHN1Ykl0ZW0uY2xhc3NOYW1lICkgOiAnJyApLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uY2xpY2s6c3ViSXRlbS5leGVjID8gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViSXRlbS5leGVjLmNhbGwoIG1lICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSA6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUuZXhlY0NvbW1hbmQoIHN1Ykl0ZW0uY21kTmFtZSwgc3ViSXRlbS52YWx1ZSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0pKCBjaiApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmICggc3ViTWVudS5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXRMYWJlbCgpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoaXRlbS5pY29uKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAidGFibGUiOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1lLmdldExhbmcoICJjb250ZXh0TWVudS50YWJsZSIgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAianVzdGlmeWp1c3RpZnkiOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1lLmdldExhbmcoICJjb250ZXh0TWVudS5wYXJhZ3JhcGgiICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImFsaWdudGQiOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1lLmdldExhbmcoImNvbnRleHRNZW51LmFsaWdudGQiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiYWxpZ250YWJsZSI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWUuZ2V0TGFuZygiY29udGV4dE1lbnUuYWxpZ250YWJsZSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJ0YWJsZXNvcnQiOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxhbmcudGFibGVzb3J0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJib3JkZXJCYWNrIjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsYW5nLmJvcmRlcmJrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0IDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0SXRlbXMucHVzaCggew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdG9kbyDkv67mraPmiJDoh6rliqjojrflj5bmlrnlvI8NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbGFiZWwnOmdldExhYmVsKCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOidlZHVpLWZvci0nICsgaXRlbS5pY29uLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzdWJNZW51Jzp7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zOnN1Yk1lbnUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvcjptZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgLy/mnInlj6/og71jb21tbWFuZOayoeacieWKoOi9veWPs+mUruS4jeiDveWHuuadpe+8jOaIluiAheayoeaciWNvbW1hbmTkuZ/mg7Pog73lsZXnpLrlh7rmnaXmt7vliqBxdWVyeeaWueazlQ0KICAgICAgICAgICAgICAgICAgICBpZiAoIChtZS5jb21tYW5kc1tpdGVtLmNtZE5hbWVdIHx8IFVFLmNvbW1hbmRzW2l0ZW0uY21kTmFtZV0gfHwgaXRlbS5xdWVyeSkgJiYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoaXRlbS5xdWVyeSA/IGl0ZW0ucXVlcnkuY2FsbChtZSkgOiBtZS5xdWVyeUNvbW1hbmRTdGF0ZSggaXRlbS5jbWROYW1lICkpID4gLTEgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvL2hpZ2hsaWdodCB0b2RvDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGl0ZW0uY21kTmFtZSA9PSAnaGlnaGxpZ2h0Y29kZScgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobWUucXVlcnlDb21tYW5kU3RhdGUoIGl0ZW0uY21kTmFtZSApID09IDEgJiYgaXRlbS5pY29uICE9ICdkZWxldGVoaWdobGlnaHRjb2RlJyl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobWUucXVlcnlDb21tYW5kU3RhdGUoIGl0ZW0uY21kTmFtZSApICE9IDEgJiYgaXRlbS5pY29uID09ICdkZWxldGVoaWdobGlnaHRjb2RlJyl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0SXRlbXMucHVzaCggew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICdsYWJlbCc6aXRlbS5sYWJlbCB8fCBtZS5nZXRMYW5nKCAiY29udGV4dE1lbnUuIiArIGl0ZW0uY21kTmFtZSApLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTonZWR1aS1mb3ItJyArIChpdGVtLmljb24gPyBpdGVtLmljb24gOiBpdGVtLmNtZE5hbWUgKyAoaXRlbS52YWx1ZSB8fCAnJykpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uY2xpY2s6aXRlbS5leGVjID8gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmV4ZWMuY2FsbCggbWUgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IDogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZS5leGVjQ29tbWFuZCggaXRlbS5jbWROYW1lLCBpdGVtLnZhbHVlICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0pKCB0aSApOw0KICAgICAgICB9DQogICAgICAgIGlmICggY29udGV4dEl0ZW1zW2NvbnRleHRJdGVtcy5sZW5ndGggLSAxXSA9PSAnLScgKSB7DQogICAgICAgICAgICBjb250ZXh0SXRlbXMucG9wKCk7DQogICAgICAgIH0NCg0KICAgICAgICBtZW51ID0gbmV3IFVFLnVpLk1lbnUoIHsNCiAgICAgICAgICAgIGl0ZW1zOmNvbnRleHRJdGVtcywNCiAgICAgICAgICAgIGNsYXNzTmFtZToiZWR1aS1jb250ZXh0bWVudSIsDQogICAgICAgICAgICBlZGl0b3I6bWUNCiAgICAgICAgfSApOw0KICAgICAgICBtZW51LnJlbmRlcigpOw0KICAgICAgICBtZW51LnNob3dBdCggb2Zmc2V0ICk7DQoNCiAgICAgICAgbWUuZmlyZUV2ZW50KCJhZnRlcnNob3djb250ZXh0bWVudSIsbWVudSk7DQoNCiAgICAgICAgZG9tVXRpbHMucHJldmVudERlZmF1bHQoIGV2dCApOw0KICAgICAgICBpZiAoIGJyb3dzZXIuaWUgKSB7DQogICAgICAgICAgICB2YXIgaWVSYW5nZTsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgaWVSYW5nZSA9IG1lLnNlbGVjdGlvbi5nZXROYXRpdmUoKS5jcmVhdGVSYW5nZSgpOw0KICAgICAgICAgICAgfSBjYXRjaCAoIGUgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCBpZVJhbmdlLml0ZW0gKSB7DQogICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gbmV3IGRvbS5SYW5nZSggbWUuZG9jdW1lbnQgKTsNCiAgICAgICAgICAgICAgICByYW5nZS5zZWxlY3ROb2RlKCBpZVJhbmdlLml0ZW0oIDAgKSApLnNlbGVjdCggdHJ1ZSwgdHJ1ZSApOw0KDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9ICk7DQp9Ow0KDQoNCgovLy9pbXBvcnQgY29yZQovLy9jb21tYW5kcyAgICAgICDlvLnlh7roj5zljZUKLy8gY29tbWFuZHNOYW1lICBwb3B1cG1lbnUKLy8vY29tbWFuZHNUaXRsZSAg5by55Ye66I+c5Y2VCi8qKgogKiDlvLnlh7roj5zljZUKICogQGZ1bmN0aW9uCiAqIEBuYW1lIGJhaWR1LmVkaXRvci5wbHVnaW5zLnBvcHVwbWVudQogKiBAYXV0aG9yIHh1aGVuZwogKi8KClVFLnBsdWdpbnNbJ3Nob3J0Y3V0bWVudSddID0gZnVuY3Rpb24gKCkgewogICAgdmFyIG1lID0gdGhpcywKICAgICAgICBtZW51LAogICAgICAgIGl0ZW1zID0gbWUub3B0aW9ucy5zaG9ydGN1dE1lbnUgfHwgW107CgogICAgaWYgKCFpdGVtcy5sZW5ndGgpIHsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgbWUuYWRkTGlzdGVuZXIgKCdjb250ZXh0bWVudSBtb3VzZXVwJyAsIGZ1bmN0aW9uICh0eXBlICwgZSkgewogICAgICAgIHZhciBtZSA9IHRoaXMsCiAgICAgICAgICAgIGN1c3RvbUV2dCA9IHsKICAgICAgICAgICAgICAgIHR5cGUgOiB0eXBlICwKICAgICAgICAgICAgICAgIHRhcmdldCA6IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudCAsCiAgICAgICAgICAgICAgICBzY3JlZW5YIDogZS5zY3JlZW5YICwKICAgICAgICAgICAgICAgIHNjcmVlblkgOiBlLnNjcmVlblkgLAogICAgICAgICAgICAgICAgY2xpZW50WCA6IGUuY2xpZW50WCAsCiAgICAgICAgICAgICAgICBjbGllbnRZIDogZS5jbGllbnRZCiAgICAgICAgICAgIH07CgogICAgICAgIHNldFRpbWVvdXQgKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIHJuZyA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSAoKTsKICAgICAgICAgICAgaWYgKHJuZy5jb2xsYXBzZWQgPT09IGZhbHNlIHx8IHR5cGUgPT0gImNvbnRleHRtZW51IikgewoKICAgICAgICAgICAgICAgIGlmICghbWVudSkgewogICAgICAgICAgICAgICAgICAgIG1lbnUgPSBuZXcgYmFpZHUuZWRpdG9yLnVpLlNob3J0Q3V0TWVudSAoewogICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3IgOiBtZSAsCiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zIDogaXRlbXMgLAogICAgICAgICAgICAgICAgICAgICAgICB0aGVtZSA6IG1lLm9wdGlvbnMudGhlbWUgLAogICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWUgOiAnZWR1aS1zaG9ydGN1dG1lbnUnCiAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgIG1lbnUucmVuZGVyICgpOwogICAgICAgICAgICAgICAgICAgIG1lLmZpcmVFdmVudCAoImFmdGVycmVuZGVyc2hvcnRjdXRtZW51IiAsIG1lbnUpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIG1lbnUuc2hvdyAoY3VzdG9tRXZ0ICwgISFVRS5wbHVnaW5zWydjb250ZXh0bWVudSddKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBpZiAodHlwZSA9PSAnY29udGV4dG1lbnUnKSB7CiAgICAgICAgICAgIGRvbVV0aWxzLnByZXZlbnREZWZhdWx0IChlKTsKICAgICAgICAgICAgaWYgKGJyb3dzZXIuaWUpIHsKICAgICAgICAgICAgICAgIHZhciBpZVJhbmdlOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBpZVJhbmdlID0gbWUuc2VsZWN0aW9uLmdldE5hdGl2ZSAoKS5jcmVhdGVSYW5nZSAoKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoaWVSYW5nZS5pdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gbmV3IGRvbS5SYW5nZSAobWUuZG9jdW1lbnQpOwogICAgICAgICAgICAgICAgICAgIHJhbmdlLnNlbGVjdE5vZGUgKGllUmFuZ2UuaXRlbSAoMCkpLnNlbGVjdCAodHJ1ZSAsIHRydWUpOwoKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHR5cGUgPT0gImtleWRvd24iKSB7CiAgICAgICAgICAgIG1lbnUgJiYgIW1lbnUuaXNIaWRkZW4gJiYgbWVudS5oaWRlICgpOwogICAgICAgIH0KICAgIH0pOwoKICAgIG1lLmFkZExpc3RlbmVyICgna2V5ZG93bicgLCBmdW5jdGlvbiAodHlwZSkgewogICAgICAgIGlmICh0eXBlID09ICJrZXlkb3duIikgewogICAgICAgICAgICBtZW51ICYmICFtZW51LmlzSGlkZGVuICYmIG1lbnUuaGlkZSAoKTsKICAgICAgICB9CgogICAgfSk7Cgp9OwoKCgovLy9pbXBvcnQgY29yZQ0KLy8vY29tbWFuZHMg5Yqg57KXLOaWnOS9kyzkuIrmoIcs5LiL5qCHDQovLy9jb21tYW5kc05hbWUgIEJvbGQsSXRhbGljLFN1YnNjcmlwdCxTdXBlcnNjcmlwdA0KLy8vY29tbWFuZHNUaXRsZSAg5Yqg57KXLOWKoOaWnCzkuIvmoIcs5LiK5qCHDQovKioNCiAqIGIgdSBp562J5Z+656GA5Yqf6IO95a6e546wDQogKiBAZnVuY3Rpb24NCiAqIEBuYW1lIGJhaWR1LmVkaXRvci5leGVjQ29tbWFuZHMNCiAqIEBwYXJhbSAgICB7U3RyaW5nfSAgICBjbWROYW1lICAgIGJvbGTliqDnspfjgIJpdGFsaWPmlpzkvZPjgIJzdWJzY3JpcHTkuIrmoIfjgIJzdXBlcnNjcmlwdOS4i+agh+OAgg0KKi8NClVFLnBsdWdpbnNbJ2Jhc2VzdHlsZSddID0gZnVuY3Rpb24oKXsNCg0KICAgIHZhciBiYXNlc3R5bGVzID0gew0KICAgICAgICAgICAgJ2JvbGQnOlsnc3Ryb25nJywnYiddLA0KICAgICAgICAgICAgJ2l0YWxpYyc6WydlbScsJ2knXSwNCiAgICAgICAgICAgICdzdWJzY3JpcHQnOlsnc3ViJ10sDQogICAgICAgICAgICAnc3VwZXJzY3JpcHQnOlsnc3VwJ10NCiAgICAgICAgfSwNCiAgICAgICAgZ2V0T2JqID0gZnVuY3Rpb24oZWRpdG9yLHRhZ05hbWVzKXsNCiAgICAgICAgICAgIHJldHVybiBkb21VdGlscy5maWx0ZXJOb2RlTGlzdChlZGl0b3Iuc2VsZWN0aW9uLmdldFN0YXJ0RWxlbWVudFBhdGgoKSx0YWdOYW1lcyk7DQogICAgICAgIH0sDQogICAgICAgIG1lID0gdGhpczsNCiAgICAvL+a3u+WKoOW/q+aNt+mUrg0KICAgIG1lLmFkZHNob3J0Y3V0a2V5KHsNCiAgICAgICAgIkJvbGQiIDogImN0cmwrNjYiLC8vXkINCiAgICAgICAgIkl0YWxpYyIgOiAiY3RybCs3MyIsIC8vXkkNCiAgICAgICAgIlVuZGVybGluZSIgOiAiY3RybCs4NSIvL15VDQogICAgfSk7DQogICAgbWUuYWRkSW5wdXRSdWxlKGZ1bmN0aW9uKHJvb3Qpew0KICAgICAgICB1dGlscy5lYWNoKHJvb3QuZ2V0Tm9kZXNCeVRhZ05hbWUoJ2IgaScpLGZ1bmN0aW9uKG5vZGUpew0KICAgICAgICAgICAgc3dpdGNoIChub2RlLnRhZ05hbWUpew0KICAgICAgICAgICAgICAgIGNhc2UgJ2InOg0KICAgICAgICAgICAgICAgICAgICBub2RlLnRhZ05hbWUgPSAnc3Ryb25nJzsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAnaSc6DQogICAgICAgICAgICAgICAgICAgIG5vZGUudGFnTmFtZSA9ICdlbSc7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0pOw0KICAgIGZvciAoIHZhciBzdHlsZSBpbiBiYXNlc3R5bGVzICkgew0KICAgICAgICAoZnVuY3Rpb24oIGNtZCwgdGFnTmFtZXMgKSB7DQogICAgICAgICAgICBtZS5jb21tYW5kc1tjbWRdID0gew0KICAgICAgICAgICAgICAgIGV4ZWNDb21tYW5kIDogZnVuY3Rpb24oIGNtZE5hbWUgKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpLG9iaiA9IGdldE9iaih0aGlzLHRhZ05hbWVzKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCByYW5nZS5jb2xsYXBzZWQgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIG9iaiApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG1wVGV4dCA9ICBtZS5kb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2UuaW5zZXJ0Tm9kZSggdG1wVGV4dCApLnJlbW92ZUlubGluZVN0eWxlKCB0YWdOYW1lcyApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0QmVmb3JlKHRtcFRleHQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZSh0bXBUZXh0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRtcE5vZGUgPSByYW5nZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCB0YWdOYW1lc1swXSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGNtZE5hbWUgPT0gJ3N1cGVyc2NyaXB0JyB8fCBjbWROYW1lID09ICdzdWJzY3JpcHQnKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wVGV4dCA9IG1lLmRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCcnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2UuaW5zZXJ0Tm9kZSh0bXBUZXh0KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUlubGluZVN0eWxlKFsnc3ViJywnc3VwJ10pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0U3RhcnRCZWZvcmUodG1wVGV4dCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb2xsYXBzZSh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2UuaW5zZXJ0Tm9kZSggdG1wTm9kZSApLnNldFN0YXJ0KCB0bXBOb2RlLCAwICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5jb2xsYXBzZSggdHJ1ZSApOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoY21kTmFtZSA9PSAnc3VwZXJzY3JpcHQnIHx8IGNtZE5hbWUgPT0gJ3N1YnNjcmlwdCcpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFvYmogfHwgb2JqLnRhZ05hbWUudG9Mb3dlckNhc2UoKSAhPSBjbWROYW1lKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2UucmVtb3ZlSW5saW5lU3R5bGUoWydzdWInLCdzdXAnXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgb2JqID8gcmFuZ2UucmVtb3ZlSW5saW5lU3R5bGUoIHRhZ05hbWVzICkgOiByYW5nZS5hcHBseUlubGluZVN0eWxlKCB0YWdOYW1lc1swXSApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJhbmdlLnNlbGVjdCgpOw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgcXVlcnlDb21tYW5kU3RhdGUgOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0T2JqKHRoaXMsdGFnTmFtZXMpID8gMSA6IDA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfTsNCiAgICAgICAgfSkoIHN0eWxlLCBiYXNlc3R5bGVzW3N0eWxlXSApOw0KICAgIH0NCn07DQoNCgovLy9pbXBvcnQgY29yZQ0KLy8vY29tbWFuZHMg6YCJ5Yy66Lev5b6EDQovLy9jb21tYW5kc05hbWUgIEVsZW1lbnRQYXRoLGVsZW1lbnRQYXRoRW5hYmxlZA0KLy8vY29tbWFuZHNUaXRsZSAg6YCJ5Yy66Lev5b6EDQovKioNCiAqIOmAieWMuui3r+W+hA0KICogQGZ1bmN0aW9uDQogKiBAbmFtZSBiYWlkdS5lZGl0b3IuZXhlY0NvbW1hbmQNCiAqIEBwYXJhbSB7U3RyaW5nfSAgICAgY21kTmFtZSAgICAgZWxlbWVudHBhdGjpgInljLrot6/lvoQNCiAqLw0KVUUucGx1Z2luc1snZWxlbWVudHBhdGgnXSA9IGZ1bmN0aW9uKCl7DQogICAgdmFyIGN1cnJlbnRMZXZlbCwNCiAgICAgICAgdGFnTmFtZXMsDQogICAgICAgIG1lID0gdGhpczsNCiAgICBtZS5zZXRPcHQoJ2VsZW1lbnRQYXRoRW5hYmxlZCcsdHJ1ZSk7DQogICAgaWYoIW1lLm9wdGlvbnMuZWxlbWVudFBhdGhFbmFibGVkKXsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICBtZS5jb21tYW5kc1snZWxlbWVudHBhdGgnXSA9IHsNCiAgICAgICAgZXhlY0NvbW1hbmQgOiBmdW5jdGlvbiggY21kTmFtZSwgbGV2ZWwgKSB7DQogICAgICAgICAgICB2YXIgc3RhcnQgPSB0YWdOYW1lc1tsZXZlbF0sDQogICAgICAgICAgICAgICAgcmFuZ2UgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKTsNCiAgICAgICAgICAgIGN1cnJlbnRMZXZlbCA9IGxldmVsKjE7DQogICAgICAgICAgICByYW5nZS5zZWxlY3ROb2RlKHN0YXJ0KS5zZWxlY3QoKTsNCiAgICAgICAgfSwNCiAgICAgICAgcXVlcnlDb21tYW5kVmFsdWUgOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIC8v5Lqn55Sf5LiA5Liq5Ymv5pys77yM5LiN6IO95L+u5pS55Y6f5p2l55qEc3RhcnRFbGVtZW50UGF0aDsNCiAgICAgICAgICAgIHZhciBwYXJlbnRzID0gW10uY29uY2F0KHRoaXMuc2VsZWN0aW9uLmdldFN0YXJ0RWxlbWVudFBhdGgoKSkucmV2ZXJzZSgpLA0KICAgICAgICAgICAgICAgIG5hbWVzID0gW107DQogICAgICAgICAgICB0YWdOYW1lcyA9IHBhcmVudHM7DQogICAgICAgICAgICBmb3IodmFyIGk9MCxjaTtjaT1wYXJlbnRzW2ldO2krKyl7DQogICAgICAgICAgICAgICAgaWYoY2kubm9kZVR5cGUgPT0gMykgew0KICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBjaS50YWdOYW1lLnRvTG93ZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgaWYobmFtZSA9PSAnaW1nJyAmJiBjaS5nZXRBdHRyaWJ1dGUoJ2FuY2hvcm5hbWUnKSl7DQogICAgICAgICAgICAgICAgICAgIG5hbWUgPSAnYW5jaG9yJzsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgbmFtZXNbaV0gPSBuYW1lOw0KICAgICAgICAgICAgICAgIGlmKGN1cnJlbnRMZXZlbCA9PSBpKXsNCiAgICAgICAgICAgICAgICAgICBjdXJyZW50TGV2ZWwgPSAtMTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIG5hbWVzOw0KICAgICAgICB9DQogICAgfTsNCn07DQoNCgovLy9pbXBvcnQgY29yZQovLy9pbXBvcnQgcGx1Z2luc1xyZW1vdmVmb3JtYXQuanMKLy8vY29tbWFuZHMg5qC85byP5Yi3Ci8vL2NvbW1hbmRzTmFtZSAgRm9ybWF0TWF0Y2gKLy8vY29tbWFuZHNUaXRsZSAg5qC85byP5Yi3Ci8qKgogKiDmoLzlvI/liLfvvIzlj6rmoLzlvI9pbmxpbmXnmoQKICogQGZ1bmN0aW9uCiAqIEBuYW1lIGJhaWR1LmVkaXRvci5leGVjQ29tbWFuZAogKiBAcGFyYW0ge1N0cmluZ30gICAgIGNtZE5hbWUgICAgZm9ybWF0bWF0Y2jmiafooYzmoLzlvI/liLcKICovClVFLnBsdWdpbnNbJ2Zvcm1hdG1hdGNoJ10gPSBmdW5jdGlvbigpewoKICAgIHZhciBtZSA9IHRoaXMsCiAgICAgICAgbGlzdCA9IFtdLGltZywKICAgICAgICBmbGFnID0gMDsKCiAgICAgbWUuYWRkTGlzdGVuZXIoJ3Jlc2V0JyxmdW5jdGlvbigpewogICAgICAgICBsaXN0ID0gW107CiAgICAgICAgIGZsYWcgPSAwOwogICAgIH0pOwoKICAgIGZ1bmN0aW9uIGFkZExpc3QodHlwZSxldnQpewogICAgICAgIAogICAgICAgIGlmKGJyb3dzZXIud2Via2l0KXsKICAgICAgICAgICAgdmFyIHRhcmdldCA9IGV2dC50YXJnZXQudGFnTmFtZSA9PSAnSU1HJyA/IGV2dC50YXJnZXQgOiBudWxsOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gYWRkRm9ybWF0KHJhbmdlKXsKCiAgICAgICAgICAgIGlmKHRleHQpewogICAgICAgICAgICAgICAgcmFuZ2Uuc2VsZWN0Tm9kZSh0ZXh0KTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gcmFuZ2UuYXBwbHlJbmxpbmVTdHlsZShsaXN0W2xpc3QubGVuZ3RoLTFdLnRhZ05hbWUsbnVsbCxsaXN0KTsKCiAgICAgICAgfQoKICAgICAgICBtZS51bmRvTWFuZ2VyICYmIG1lLnVuZG9NYW5nZXIuc2F2ZSgpOwoKICAgICAgICB2YXIgcmFuZ2UgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKSwKICAgICAgICAgICAgaW1nVCA9IHRhcmdldCB8fCByYW5nZS5nZXRDbG9zZWROb2RlKCk7CiAgICAgICAgaWYoaW1nICYmIGltZ1QgJiYgaW1nVC50YWdOYW1lID09ICdJTUcnKXsKICAgICAgICAgICAgLy90cmFjZTo5NjQKCiAgICAgICAgICAgIGltZ1Quc3R5bGUuY3NzVGV4dCArPSAnO2Zsb2F0OicgKyAoaW1nLnN0eWxlLmNzc0Zsb2F0IHx8IGltZy5zdHlsZS5zdHlsZUZsb2F0IHx8J25vbmUnKSArICc7ZGlzcGxheTonICsgKGltZy5zdHlsZS5kaXNwbGF5fHwnaW5saW5lJyk7CgogICAgICAgICAgICBpbWcgPSBudWxsOwogICAgICAgIH1lbHNlewogICAgICAgICAgICBpZighaW1nKXsKICAgICAgICAgICAgICAgIHZhciBjb2xsYXBzZWQgPSByYW5nZS5jb2xsYXBzZWQ7CiAgICAgICAgICAgICAgICBpZihjb2xsYXBzZWQpewogICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gbWUuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJ21hdGNoJyk7CiAgICAgICAgICAgICAgICAgICAgcmFuZ2UuaW5zZXJ0Tm9kZSh0ZXh0KS5zZWxlY3QoKTsKCgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbWUuX19oYXNFbnRlckV4ZWNDb21tYW5kID0gdHJ1ZTsKICAgICAgICAgICAgICAgIC8v5LiN6IO95oqKYmxvY2vkuIrnmoTlsZ7mgKflubLmjokKICAgICAgICAgICAgICAgIC8vdHJhY2U6MTU1MwogICAgICAgICAgICAgICAgdmFyIHJlbW92ZUZvcm1hdEF0dHJpYnV0ZXMgPSBtZS5vcHRpb25zLnJlbW92ZUZvcm1hdEF0dHJpYnV0ZXM7CiAgICAgICAgICAgICAgICBtZS5vcHRpb25zLnJlbW92ZUZvcm1hdEF0dHJpYnV0ZXMgPSAnJzsKICAgICAgICAgICAgICAgIG1lLmV4ZWNDb21tYW5kKCdyZW1vdmVmb3JtYXQnKTsKICAgICAgICAgICAgICAgIG1lLm9wdGlvbnMucmVtb3ZlRm9ybWF0QXR0cmlidXRlcyA9IHJlbW92ZUZvcm1hdEF0dHJpYnV0ZXM7CiAgICAgICAgICAgICAgICBtZS5fX2hhc0VudGVyRXhlY0NvbW1hbmQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIC8vdHJhY2U6OTY5CiAgICAgICAgICAgICAgICByYW5nZSA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpOwogICAgICAgICAgICAgICAgaWYobGlzdC5sZW5ndGgpewogICAgICAgICAgICAgICAgICAgIGFkZEZvcm1hdChyYW5nZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZih0ZXh0KXsKICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydEJlZm9yZSh0ZXh0KS5jb2xsYXBzZSh0cnVlKTsKCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByYW5nZS5zZWxlY3QoKTsKICAgICAgICAgICAgICAgIHRleHQgJiYgZG9tVXRpbHMucmVtb3ZlKHRleHQpOwogICAgICAgICAgICB9CgogICAgICAgIH0KCgoKCiAgICAgICAgbWUudW5kb01hbmdlciAmJiBtZS51bmRvTWFuZ2VyLnNhdmUoKTsKICAgICAgICBtZS5yZW1vdmVMaXN0ZW5lcignbW91c2V1cCcsYWRkTGlzdCk7CiAgICAgICAgZmxhZyA9IDA7CiAgICB9CgogICAgbWUuY29tbWFuZHNbJ2Zvcm1hdG1hdGNoJ10gPSB7CiAgICAgICAgZXhlY0NvbW1hbmQgOiBmdW5jdGlvbiggY21kTmFtZSApIHsKICAgICAgICAgIAogICAgICAgICAgICBpZihmbGFnKXsKICAgICAgICAgICAgICAgIGZsYWcgPSAwOwogICAgICAgICAgICAgICAgbGlzdCA9IFtdOwogICAgICAgICAgICAgICAgIG1lLnJlbW92ZUxpc3RlbmVyKCdtb3VzZXVwJyxhZGRMaXN0KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKCiAgICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciByYW5nZSA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpOwogICAgICAgICAgICBpbWcgPSByYW5nZS5nZXRDbG9zZWROb2RlKCk7CiAgICAgICAgICAgIGlmKCFpbWcgfHwgaW1nLnRhZ05hbWUgIT0gJ0lNRycpewogICAgICAgICAgICAgICByYW5nZS5jb2xsYXBzZSh0cnVlKS5zaHJpbmtCb3VuZGFyeSgpOwogICAgICAgICAgICAgICB2YXIgc3RhcnQgPSByYW5nZS5zdGFydENvbnRhaW5lcjsKICAgICAgICAgICAgICAgbGlzdCA9IGRvbVV0aWxzLmZpbmRQYXJlbnRzKHN0YXJ0LHRydWUsZnVuY3Rpb24obm9kZSl7CiAgICAgICAgICAgICAgICAgICByZXR1cm4gIWRvbVV0aWxzLmlzQmxvY2tFbG0obm9kZSkgJiYgbm9kZS5ub2RlVHlwZSA9PSAxOwogICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgLy9h5LiN6IO95Yqg5YWl5qC85byP5Yi3LCDlubbkuJTlhYvpmoboioLngrkKICAgICAgICAgICAgICAgZm9yKHZhciBpPTAsY2k7Y2k9bGlzdFtpXTtpKyspewogICAgICAgICAgICAgICAgICAgaWYoY2kudGFnTmFtZSA9PSAnQScpewogICAgICAgICAgICAgICAgICAgICAgIGxpc3Quc3BsaWNlKGksMSk7CiAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG1lLmFkZExpc3RlbmVyKCdtb3VzZXVwJyxhZGRMaXN0KTsKICAgICAgICAgICAgZmxhZyA9IDE7CgoKICAgICAgICB9LAogICAgICAgIHF1ZXJ5Q29tbWFuZFN0YXRlIDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHJldHVybiBmbGFnOwogICAgICAgIH0sCiAgICAgICAgbm90TmVlZFVuZG8gOiAxCiAgICB9Owp9OwoKCi8vL2ltcG9ydCBjb3JlDQovLy9jb21tYW5kcyDmn6Xmib7mm7/mjaINCi8vL2NvbW1hbmRzTmFtZSAgU2VhcmNoUmVwbGFjZQ0KLy8vY29tbWFuZHNUaXRsZSAg5p+l6K+i5pu/5o2iDQovLy9jb21tYW5kc0RpYWxvZyAgZGlhbG9nc1xzZWFyY2hyZXBsYWNlDQovKioNCiAqIEBkZXNjcmlwdGlvbiDmn6Xmib7mm7/mjaINCiAqIEBhdXRob3IgemhhbnlpDQogKi8NClVFLnBsdWdpbnNbJ3NlYXJjaHJlcGxhY2UnXSA9IGZ1bmN0aW9uKCl7DQoNCiAgICB2YXIgY3VycmVudFJhbmdlLA0KICAgICAgICBmaXJzdCwNCiAgICAgICAgbWUgPSB0aGlzOw0KICAgIG1lLmFkZExpc3RlbmVyKCdyZXNldCcsZnVuY3Rpb24oKXsNCiAgICAgICAgY3VycmVudFJhbmdlID0gbnVsbDsNCiAgICAgICAgZmlyc3QgPSBudWxsOw0KICAgIH0pOw0KICAgIG1lLmNvbW1hbmRzWydzZWFyY2hyZXBsYWNlJ10gPSB7DQogICAgICAgIGV4ZWNDb21tYW5kIDogZnVuY3Rpb24oY21kTmFtZSxvcHQpew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpcywNCiAgICAgICAgICAgICAgICBzZWwgPSBtZS5zZWxlY3Rpb24sDQogICAgICAgICAgICAgICAgcmFuZ2UsDQogICAgICAgICAgICAgICAgbmF0aXZlUmFuZ2UsDQogICAgICAgICAgICAgICAgbnVtID0gMCwNCiAgICAgICAgICAgICAgICBvcHQgPSB1dGlscy5leHRlbmQob3B0LHsNCiAgICAgICAgICAgICAgICAgICAgYWxsIDogZmFsc2UsDQogICAgICAgICAgICAgICAgICAgIGNhc2VzZW5zaXRpdmUgOiBmYWxzZSwNCiAgICAgICAgICAgICAgICAgICAgZGlyIDogMQ0KICAgICAgICAgICAgICAgIH0sdHJ1ZSk7DQogICAgICAgICAgICB2YXIgc2VhcmNoU3RyID0gb3B0LnNlYXJjaFN0cjsNCiAgICAgICAgICAgIGlmKGJyb3dzZXIuaWUpew0KICAgICAgICAgICAgICAgIG1lLmZvY3VzKCk7DQogICAgICAgICAgICAgICAgd2hpbGUoMSl7DQogICAgICAgICAgICAgICAgICAgIHZhciB0bXBSYW5nZTsNCg0KICAgICAgICAgICAgICAgICAgICBuYXRpdmVSYW5nZSA9IG1lLmRvY3VtZW50LnNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpOw0KICAgICAgICAgICAgICAgICAgICB0bXBSYW5nZSA9IG5hdGl2ZVJhbmdlLmR1cGxpY2F0ZSgpOw0KICAgICAgICAgICAgICAgICAgICB0bXBSYW5nZS5tb3ZlVG9FbGVtZW50VGV4dChtZS5kb2N1bWVudC5ib2R5KTsNCiAgICAgICAgICAgICAgICAgICAgaWYob3B0LmFsbCl7DQogICAgICAgICAgICAgICAgICAgICAgICBmaXJzdCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBvcHQuZGlyID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGN1cnJlbnRSYW5nZSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wUmFuZ2Uuc2V0RW5kUG9pbnQob3B0LmRpciA9PSAtMSA/ICdFbmRUb1N0YXJ0JyA6ICdTdGFydFRvRW5kJyxjdXJyZW50UmFuZ2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wUmFuZ2UubW92ZVRvRWxlbWVudFRleHQobWUuZG9jdW1lbnQuYm9keSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICB0bXBSYW5nZS5zZXRFbmRQb2ludChvcHQuZGlyID09IC0xID8gJ0VuZFRvU3RhcnQnIDogJ1N0YXJ0VG9FbmQnLG5hdGl2ZVJhbmdlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKG9wdC5oYXNPd25Qcm9wZXJ0eSgicmVwbGFjZVN0ciIpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBSYW5nZS5zZXRFbmRQb2ludChvcHQuZGlyID09IC0xID8gJ1N0YXJ0VG9FbmQnIDogJ0VuZFRvU3RhcnQnLG5hdGl2ZVJhbmdlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBuYXRpdmVSYW5nZSA9IHRtcFJhbmdlLmR1cGxpY2F0ZSgpOw0KDQogICAgICAgICAgICAgICAgICAgIGlmKC9eXC9bXi9dK1wvXHcqJC8udGVzdChvcHQuc2VhcmNoU3RyKSl7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RyID0gdG1wUmFuZ2UudGV4dCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWcgPSBuZXcgUmVnRXhwKG9wdC5zZWFyY2hTdHIucmVwbGFjZSgvXlwvfFwvXHcqJC9nLCcnKSwnZycgKyAob3B0LmNhc2VzZW5zaXRpdmUgPyAnJzonaScpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYXRjaCA9IHN0ci5tYXRjaChyZWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYobWF0Y2ggJiYgbWF0Y2gubGVuZ3RoKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hTdHIgPSBvcHQuZGlyIDwgMCA/IG1hdGNoW21hdGNoLmxlbmd0aCAtMV0gOiBtYXRjaFswXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRSYW5nZSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZighdG1wUmFuZ2UuZmluZFRleHQoc2VhcmNoU3RyLG9wdC5kaXIsb3B0LmNhc2VzZW5zaXRpdmUgPyA0IDogMCkpew0KICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFJhbmdlID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRtcFJhbmdlID0gbWUuZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0bXBSYW5nZS5zY3JvbGxJbnRvVmlldygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFJhbmdlID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudW07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdG1wUmFuZ2Uuc2VsZWN0KCk7DQogICAgICAgICAgICAgICAgICAgIC8v5pu/5o2iDQogICAgICAgICAgICAgICAgICAgIGlmKG9wdC5oYXNPd25Qcm9wZXJ0eSgicmVwbGFjZVN0ciIpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlID0gc2VsLmdldFJhbmdlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5kZWxldGVDb250ZW50cygpLmluc2VydE5vZGUocmFuZ2UuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUob3B0LnJlcGxhY2VTdHIpKS5zZWxlY3QoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRSYW5nZSA9IHNlbC5nZXROYXRpdmUoKS5jcmVhdGVSYW5nZSgpOw0KDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgbnVtKys7DQogICAgICAgICAgICAgICAgICAgIGlmKCFvcHQuYWxsKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfWVsc2V7DQoNCiAgICAgICAgICAgICAgICB2YXIgdyA9IG1lLndpbmRvdyxuYXRpdmVTZWwgPSBzZWwuZ2V0TmF0aXZlKCk7DQogICAgICAgICAgICAgICAgd2hpbGUoMSl7DQogICAgICAgICAgICAgICAgICAgIGlmKG9wdC5hbGwpew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoY3VycmVudFJhbmdlKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UmFuZ2UuY29sbGFwc2UoZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdGl2ZVJhbmdlID0gY3VycmVudFJhbmdlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmF0aXZlUmFuZ2UgID0gbWUuZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYXRpdmVSYW5nZS5zZXRTdGFydChtZS5kb2N1bWVudC5ib2R5LDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdGl2ZVJhbmdlLmNvbGxhcHNlKHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICBuYXRpdmVTZWwucmVtb3ZlQWxsUmFuZ2VzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBuYXRpdmVTZWwuYWRkUmFuZ2UoIG5hdGl2ZVJhbmdlICk7DQogICAgICAgICAgICAgICAgICAgICAgICBmaXJzdCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBvcHQuZGlyID0gMTsNCiAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICAvL3NhZmFyaeW8ueWHuuWxgu+8jOWOn+eUn+W3sue7j+aJvuS4jeWIsHJhbmdl5LqG77yM5omA5Lul6ZyA6KaB5YWI6YCJ5Zue5p2l77yM5YaN5Y+W5Y6f55SfDQogICAgICAgICAgICAgICAgICAgICAgICBpZihicm93c2VyLnNhZmFyaSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUuc2VsZWN0aW9uLmdldFJhbmdlKCkuc2VsZWN0KCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuYXRpdmVTZWwgPSB3LmdldFNlbGVjdGlvbigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoIW5hdGl2ZVNlbC5yYW5nZUNvdW50KXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYXRpdmVSYW5nZSA9IGN1cnJlbnRSYW5nZSB8fCBtZS5fYmFrTmF0aXZlUmFuZ2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYXRpdmVSYW5nZSA9IG5hdGl2ZVNlbC5nZXRSYW5nZUF0KDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICBpZihvcHQuaGFzT3duUHJvcGVydHkoInJlcGxhY2VTdHIiKSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmF0aXZlUmFuZ2UuY29sbGFwc2Uob3B0LmRpciA9PSAxID8gdHJ1ZSA6IGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIC8v5aaC5p6c5piv56ys5LiA5qyh5bm25LiU5rW36YCJ5Lit5LqG5YaF5a656YKj5bCx6KaB5riF6Zmk77yM5Li6ZmluZOWBmuWHhuWkhw0KDQogICAgICAgICAgICAgICAgICAgIGlmKCFmaXJzdCl7DQogICAgICAgICAgICAgICAgICAgICAgICBuYXRpdmVSYW5nZS5jb2xsYXBzZSggb3B0LmRpciA8MCA/IHRydWUgOiBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBuYXRpdmVTZWwucmVtb3ZlQWxsUmFuZ2VzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBuYXRpdmVTZWwuYWRkUmFuZ2UoIG5hdGl2ZVJhbmdlICk7DQogICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgbmF0aXZlU2VsLnJlbW92ZUFsbFJhbmdlcygpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIC8v5piv5q2j5YiZ5p+l5om+DQoNCiAgICAgICAgICAgICAgICAgICAgaWYoL15cL1teL10rXC9cdyokLy50ZXN0KG9wdC5zZWFyY2hTdHIpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0bXBSYW5nZSA9IG5hdGl2ZVJhbmdlLmNsb25lUmFuZ2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8v5ZCR5YmN5p+l5om+DQogICAgICAgICAgICAgICAgICAgICAgICBpZihvcHQuZGlyIDwgMCApew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdGl2ZVJhbmdlLmNvbGxhcHNlKHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdGl2ZVJhbmdlLnNldFN0YXJ0KG1lLmJvZHksMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYXRpdmVSYW5nZS5zZXRFbmQobWUuYm9keSxtZS5ib2R5LmNoaWxkTm9kZXMubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdHIgPSBuYXRpdmVSYW5nZSArICcnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZyA9IG5ldyBSZWdFeHAob3B0LnNlYXJjaFN0ci5yZXBsYWNlKC9eXC98XC9cdyokL2csJycpLCdnJyArIChvcHQuY2FzZXNlbnNpdGl2ZSA/ICcnOidpJykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hdGNoID0gc3RyLm1hdGNoKHJlZyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZihtYXRjaCAmJiBtYXRjaC5sZW5ndGgpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaFN0ciA9IG9wdC5kaXIgPCAwID8gbWF0Y2hbbWF0Y2gubGVuZ3RoIC0xXSA6IG1hdGNoWzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFJhbmdlID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVtOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgbmF0aXZlU2VsLnJlbW92ZUFsbFJhbmdlcygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbmF0aXZlUmFuZ2UgPSB0bXBSYW5nZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG5hdGl2ZVNlbC5hZGRSYW5nZShuYXRpdmVSYW5nZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYoIXcuZmluZChzZWFyY2hTdHIsb3B0LmNhc2VzZW5zaXRpdmUsb3B0LmRpciA8IDAgPyB0cnVlIDogZmFsc2UpICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFJhbmdlID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIG5hdGl2ZVNlbC5yZW1vdmVBbGxSYW5nZXMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudW07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZmlyc3QgPSAwOw0KICAgICAgICAgICAgICAgICAgICByYW5nZSA9IHcuZ2V0U2VsZWN0aW9uKCkuZ2V0UmFuZ2VBdCgwKTsNCiAgICAgICAgICAgICAgICAgICAgaWYoIXJhbmdlLmNvbGxhcHNlZCl7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKG9wdC5oYXNPd25Qcm9wZXJ0eSgicmVwbGFjZVN0ciIpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5kZWxldGVDb250ZW50cygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gdy5kb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShvcHQucmVwbGFjZVN0cik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2UuaW5zZXJ0Tm9kZSh0ZXh0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZWxlY3ROb2RlKHRleHQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdGl2ZVNlbC5hZGRSYW5nZShyYW5nZSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRSYW5nZSA9IHJhbmdlLmNsb25lUmFuZ2UoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBudW0rKzsNCiAgICAgICAgICAgICAgICAgICAgaWYoIW9wdC5hbGwpew0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQogICAgfTsNCg0KfTsKLy8vaW1wb3J0IGNvcmUNCi8vL2NvbW1hbmRzIOiHquWumuS5ieagt+W8jw0KLy8vY29tbWFuZHNOYW1lICBDdXN0b21TdHlsZQ0KLy8vY29tbWFuZHNUaXRsZSAg6Ieq5a6a5LmJ5qC35byPDQpVRS5wbHVnaW5zWydjdXN0b21zdHlsZSddID0gZnVuY3Rpb24oKSB7DQogICAgdmFyIG1lID0gdGhpczsNCiAgICBtZS5zZXRPcHQoeyAnY3VzdG9tc3R5bGUnOlsNCiAgICAgICAge3RhZzonaDEnLG5hbWU6J3RjJywgc3R5bGU6J2ZvbnQtc2l6ZTozMnB4O2ZvbnQtd2VpZ2h0OmJvbGQ7Ym9yZGVyLWJvdHRvbTojY2NjIDJweCBzb2xpZDtwYWRkaW5nOjAgNHB4IDAgMDt0ZXh0LWFsaWduOmNlbnRlcjttYXJnaW46MCAwIDIwcHggMDsnfSwNCiAgICAgICAge3RhZzonaDEnLG5hbWU6J3RsJywgc3R5bGU6J2ZvbnQtc2l6ZTozMnB4O2ZvbnQtd2VpZ2h0OmJvbGQ7Ym9yZGVyLWJvdHRvbTojY2NjIDJweCBzb2xpZDtwYWRkaW5nOjAgNHB4IDAgMDt0ZXh0LWFsaWduOmxlZnQ7bWFyZ2luOjAgMCAxMHB4IDA7J30sDQogICAgICAgIHt0YWc6J3NwYW4nLG5hbWU6J2ltJywgc3R5bGU6J2ZvbnQtc2l6ZToxNnB4O2ZvbnQtc3R5bGU6aXRhbGljO2ZvbnQtd2VpZ2h0OmJvbGQ7bGluZS1oZWlnaHQ6MThweDsnfSwNCiAgICAgICAge3RhZzonc3BhbicsbmFtZTonaGknLCBzdHlsZTonZm9udC1zaXplOjE2cHg7Zm9udC1zdHlsZTppdGFsaWM7Zm9udC13ZWlnaHQ6Ym9sZDtjb2xvcjpyZ2IoNTEsIDE1MywgMjA0KTtsaW5lLWhlaWdodDoxOHB4Oyd9DQogICAgXX0pOw0KICAgIG1lLmNvbW1hbmRzWydjdXN0b21zdHlsZSddID0gew0KICAgICAgICBleGVjQ29tbWFuZCA6IGZ1bmN0aW9uKGNtZE5hbWUsIG9iaikgew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpcywNCiAgICAgICAgICAgICAgICAgICAgdGFnTmFtZSA9IG9iai50YWcsDQogICAgICAgICAgICAgICAgICAgIG5vZGUgPSBkb21VdGlscy5maW5kUGFyZW50KG1lLnNlbGVjdGlvbi5nZXRTdGFydCgpLCBmdW5jdGlvbihub2RlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbm9kZS5nZXRBdHRyaWJ1dGUoJ2xhYmVsJyk7DQogICAgICAgICAgICAgICAgICAgIH0sIHRydWUpLA0KICAgICAgICAgICAgICAgICAgICByYW5nZSxiayx0bXBPYmogPSB7fTsNCiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gb2JqKSB7DQogICAgICAgICAgICAgICBpZihvYmpbcF0hPT11bmRlZmluZWQpDQogICAgICAgICAgICAgICAgICAgIHRtcE9ialtwXSA9IG9ialtwXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGRlbGV0ZSB0bXBPYmoudGFnOw0KICAgICAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS5nZXRBdHRyaWJ1dGUoJ2xhYmVsJykgPT0gb2JqLmxhYmVsKSB7DQogICAgICAgICAgICAgICAgcmFuZ2UgPSB0aGlzLnNlbGVjdGlvbi5nZXRSYW5nZSgpOw0KICAgICAgICAgICAgICAgIGJrID0gcmFuZ2UuY3JlYXRlQm9va21hcmsoKTsNCiAgICAgICAgICAgICAgICBpZiAocmFuZ2UuY29sbGFwc2VkKSB7DQogICAgICAgICAgICAgICAgICAgIC8vdHJhY2U6MTczMiDliKDmjonoh6rlrprkuYnmoIfnrb7vvIzopoHmnIlw5p2l5Zue5aGr56uZ5L2NDQogICAgICAgICAgICAgICAgICAgIGlmKGR0ZC4kYmxvY2tbbm9kZS50YWdOYW1lXSl7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlsbE5vZGUgPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5tb3ZlQ2hpbGQobm9kZSwgZmlsbE5vZGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShmaWxsTm9kZSwgbm9kZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUobm9kZSk7DQogICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKG5vZGUsdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQoNCiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbW1vbiA9IGRvbVV0aWxzLmdldENvbW1vbkFuY2VzdG9yKGJrLnN0YXJ0LCBiay5lbmQpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzID0gZG9tVXRpbHMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoY29tbW9uLCB0YWdOYW1lKTsNCiAgICAgICAgICAgICAgICAgICAgaWYobmV3IFJlZ0V4cCh0YWdOYW1lLCdpJykudGVzdChjb21tb24udGFnTmFtZSkpew0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXMucHVzaChjb21tb24pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLG5pOyBuaSA9IG5vZGVzW2krK107KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAobmkuZ2V0QXR0cmlidXRlKCdsYWJlbCcpID09IG9iai5sYWJlbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcyA9IGRvbVV0aWxzLmdldFBvc2l0aW9uKG5pLCBiay5zdGFydCkscGUgPSBkb21VdGlscy5nZXRQb3NpdGlvbihuaSwgYmsuZW5kKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHBzICYgZG9tVXRpbHMuUE9TSVRJT05fRk9MTE9XSU5HIHx8IHBzICYgZG9tVXRpbHMuUE9TSVRJT05fQ09OVEFJTlMpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHBlICYgZG9tVXRpbHMuUE9TSVRJT05fUFJFQ0VESU5HIHx8IHBlICYgZG9tVXRpbHMuUE9TSVRJT05fQ09OVEFJTlMpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkdGQuJGJsb2NrW3RhZ05hbWVdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlsbE5vZGUgPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5tb3ZlQ2hpbGQobmksIGZpbGxOb2RlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5pLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGZpbGxOb2RlLCBuaSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUobmksIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIG5vZGUgPSBkb21VdGlscy5maW5kUGFyZW50KGNvbW1vbiwgZnVuY3Rpb24obm9kZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGUuZ2V0QXR0cmlidXRlKCdsYWJlbCcpID09IG9iai5sYWJlbDsNCiAgICAgICAgICAgICAgICAgICAgfSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIGlmIChub2RlKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShub2RlLCB0cnVlKTsNCg0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmFuZ2UubW92ZVRvQm9va21hcmsoYmspLnNlbGVjdCgpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpZiAoZHRkLiRibG9ja1t0YWdOYW1lXSkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmV4ZWNDb21tYW5kKCdwYXJhZ3JhcGgnLCB0YWdOYW1lLCB0bXBPYmosJ2N1c3RvbXN0eWxlJyk7DQogICAgICAgICAgICAgICAgICAgIHJhbmdlID0gbWUuc2VsZWN0aW9uLmdldFJhbmdlKCk7DQogICAgICAgICAgICAgICAgICAgIGlmICghcmFuZ2UuY29sbGFwc2VkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5jb2xsYXBzZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IGRvbVV0aWxzLmZpbmRQYXJlbnQobWUuc2VsZWN0aW9uLmdldFN0YXJ0KCksIGZ1bmN0aW9uKG5vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbm9kZS5nZXRBdHRyaWJ1dGUoJ2xhYmVsJykgPT0gb2JqLmxhYmVsOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcE5vZGUgPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5pbnNlcnRBZnRlcihub2RlLCBwTm9kZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5maWxsTm9kZShtZS5kb2N1bWVudCwgcE5vZGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQocE5vZGUsIDApLnNldEN1cnNvcigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgICAgICByYW5nZSA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpOw0KICAgICAgICAgICAgICAgICAgICBpZiAocmFuZ2UuY29sbGFwc2VkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBub2RlID0gbWUuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWdOYW1lKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnNldEF0dHJpYnV0ZXMobm9kZSwgdG1wT2JqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLmluc2VydE5vZGUobm9kZSkuc2V0U3RhcnQobm9kZSwgMCkuc2V0Q3Vyc29yKCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGJrID0gcmFuZ2UuY3JlYXRlQm9va21hcmsoKTsNCiAgICAgICAgICAgICAgICAgICAgcmFuZ2UuYXBwbHlJbmxpbmVTdHlsZSh0YWdOYW1lLCB0bXBPYmopLm1vdmVUb0Jvb2ttYXJrKGJrKS5zZWxlY3QoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfSwNCiAgICAgICAgcXVlcnlDb21tYW5kVmFsdWUgOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBwYXJlbnQgPSBkb21VdGlscy5maWx0ZXJOb2RlTGlzdCgNCiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvbi5nZXRTdGFydEVsZW1lbnRQYXRoKCksDQogICAgICAgICAgICAgICAgZnVuY3Rpb24obm9kZSl7cmV0dXJuIG5vZGUuZ2V0QXR0cmlidXRlKCdsYWJlbCcpfQ0KICAgICAgICAgICAgKTsNCiAgICAgICAgICAgIHJldHVybiAgcGFyZW50ID8gcGFyZW50LmdldEF0dHJpYnV0ZSgnbGFiZWwnKSA6ICcnOw0KICAgICAgICB9DQogICAgfTsNCiAgICAvL+W9k+WOu+aOiWN1c3RvbXN0eWxl5piv77yM5aaC5p6c5piv5Z2X5YWD57Sg77yM55SocOS7o+abvw0KICAgIG1lLmFkZExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uKHR5cGUsIGV2dCkgew0KICAgICAgICB2YXIga2V5Q29kZSA9IGV2dC5rZXlDb2RlIHx8IGV2dC53aGljaDsNCg0KICAgICAgICBpZiAoa2V5Q29kZSA9PSAzMiB8fCBrZXlDb2RlID09IDEzKSB7DQogICAgICAgICAgICB2YXIgcmFuZ2UgPSBtZS5zZWxlY3Rpb24uZ2V0UmFuZ2UoKTsNCiAgICAgICAgICAgIGlmIChyYW5nZS5jb2xsYXBzZWQpIHsNCiAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IGRvbVV0aWxzLmZpbmRQYXJlbnQobWUuc2VsZWN0aW9uLmdldFN0YXJ0KCksIGZ1bmN0aW9uKG5vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGUuZ2V0QXR0cmlidXRlKCdsYWJlbCcpOw0KICAgICAgICAgICAgICAgIH0sIHRydWUpOw0KICAgICAgICAgICAgICAgIGlmIChub2RlICYmIGR0ZC4kYmxvY2tbbm9kZS50YWdOYW1lXSAmJiBkb21VdGlscy5pc0VtcHR5Tm9kZShub2RlKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSBtZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5pbnNlcnRBZnRlcihub2RlLCBwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLmZpbGxOb2RlKG1lLmRvY3VtZW50LCBwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShub2RlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KHAsIDApLnNldEN1cnNvcigpOw0KDQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9KTsNCn07Ci8vL2ltcG9ydCBjb3JlDQovLy9jb21tYW5kcyDov5znqIvlm77niYfmipPlj5YNCi8vL2NvbW1hbmRzTmFtZSAgY2F0Y2hSZW1vdGVJbWFnZSxjYXRjaHJlbW90ZWltYWdlZW5hYmxlDQovLy9jb21tYW5kc1RpdGxlICDov5znqIvlm77niYfmipPlj5YNCi8qKg0KICog6L+c56iL5Zu+54mH5oqT5Y+WLOW9k+W8gOWQr+acrOaPkuS7tuaXtuaJgOacieS4jeespuWQiOacrOWcsOWfn+WQjeeahOWbvueJh+mDveWwhuiiq+aKk+WPluaIkOS4uuacrOWcsOacjeWKoeWZqOS4iueahOWbvueJhw0KICoNCiAqLw0KVUUucGx1Z2luc1snY2F0Y2hyZW1vdGVpbWFnZSddID0gZnVuY3Rpb24gKCkgew0KICAgIGlmICh0aGlzLm9wdGlvbnMuY2F0Y2hSZW1vdGVJbWFnZUVuYWJsZT09PWZhbHNlKXsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICB2YXIgbWUgPSB0aGlzOw0KICAgIHRoaXMuc2V0T3B0KHsNCiAgICAgICAgbG9jYWxEb21haW46WyIxMjcuMC4wLjEiLCJsb2NhbGhvc3QiLCJpbWcuYmFpZHUuY29tIl0sDQogICAgICAgIHNlcGFyYXRlcjondWVfc2VwYXJhdGVfdWUnLA0KICAgICAgICBjYXRjaEZpZWxkTmFtZToidXBmaWxlIiwNCiAgICAgICAgY2F0Y2hSZW1vdGVJbWFnZUVuYWJsZTp0cnVlDQogICAgfSk7DQogICAgdmFyIGFqYXggPSBVRS5hamF4LA0KICAgICAgICBsb2NhbERvbWFpbiA9IG1lLm9wdGlvbnMubG9jYWxEb21haW4gLA0KICAgICAgICBjYXRjaGVyVXJsID0gbWUub3B0aW9ucy5jYXRjaGVyVXJsLA0KICAgICAgICBzZXBhcmF0ZXIgPSBtZS5vcHRpb25zLnNlcGFyYXRlcjsNCiAgICBmdW5jdGlvbiBjYXRjaHJlbW90ZWltYWdlKGltZ3MsIGNhbGxiYWNrcykgew0KICAgICAgICB2YXIgc3VibWl0U3RyID0gaW1ncy5qb2luKHNlcGFyYXRlcik7DQogICAgICAgIHZhciB0bXBPcHRpb24gPSB7DQogICAgICAgICAgICB0aW1lb3V0OjYwMDAwLCAvL+WNleS9je+8muavq+enku+8jOWbnuiwg+ivt+axgui2heaXtuiuvue9ruOAguebruagh+eUqOaIt+WmguaenOe9kemAn+S4jeaYr+W+iOW/q+eahOivneatpOWkhOW7uuiuruiuvue9ruS4gOS4qui+g+Wkp+eahOaVsOWAvA0KICAgICAgICAgICAgb25zdWNjZXNzOmNhbGxiYWNrc1sic3VjY2VzcyJdLA0KICAgICAgICAgICAgb25lcnJvcjpjYWxsYmFja3NbImVycm9yIl0NCiAgICAgICAgfTsNCiAgICAgICAgdG1wT3B0aW9uW21lLm9wdGlvbnMuY2F0Y2hGaWVsZE5hbWVdID0gc3VibWl0U3RyOw0KICAgICAgICBhamF4LnJlcXVlc3QoY2F0Y2hlclVybCwgdG1wT3B0aW9uKTsNCiAgICB9DQoNCiAgICBtZS5hZGRMaXN0ZW5lcigiYWZ0ZXJwYXN0ZSIsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgbWUuZmlyZUV2ZW50KCJjYXRjaFJlbW90ZUltYWdlIik7DQogICAgfSk7DQoNCiAgICBtZS5hZGRMaXN0ZW5lcigiY2F0Y2hSZW1vdGVJbWFnZSIsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgdmFyIHJlbW90ZUltYWdlcyA9IFtdOw0KICAgICAgICB2YXIgaW1ncyA9IGRvbVV0aWxzLmdldEVsZW1lbnRzQnlUYWdOYW1lKG1lLmRvY3VtZW50LCAiaW1nIik7DQogICAgICAgIHZhciB0ZXN0ID0gZnVuY3Rpb24gKHNyYyx1cmxzKSB7DQogICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgdXJsOyB1cmwgPSB1cmxzW2orK107KSB7DQogICAgICAgICAgICAgICAgaWYgKHNyYy5pbmRleE9mKHVybCkgIT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfTsNCiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNpOyBjaSA9IGltZ3NbaSsrXTspIHsNCiAgICAgICAgICAgIGlmIChjaS5nZXRBdHRyaWJ1dGUoIndvcmRfaW1nIikpew0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdmFyIHNyYyA9IGNpLmdldEF0dHJpYnV0ZSgiX3NyYyIpIHx8IGNpLnNyYyB8fCAiIjsNCiAgICAgICAgICAgIGlmICgvXihodHRwcz98ZnRwKTovaS50ZXN0KHNyYykgJiYgIXRlc3Qoc3JjLGxvY2FsRG9tYWluKSkgew0KICAgICAgICAgICAgICAgIHJlbW90ZUltYWdlcy5wdXNoKHNyYyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYgKHJlbW90ZUltYWdlcy5sZW5ndGgpIHsNCiAgICAgICAgICAgIGNhdGNocmVtb3RlaW1hZ2UocmVtb3RlSW1hZ2VzLCB7DQogICAgICAgICAgICAgICAgLy/miJDlip/mipPlj5YNCiAgICAgICAgICAgICAgICBzdWNjZXNzOmZ1bmN0aW9uICh4aHIpIHsNCiAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmZvID0gZXZhbCgiKCIgKyB4aHIucmVzcG9uc2VUZXh0ICsgIikiKTsNCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHZhciBzcmNVcmxzID0gaW5mby5zcmNVcmwuc3BsaXQoc2VwYXJhdGVyKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHVybHMgPSBpbmZvLnVybC5zcGxpdChzZXBhcmF0ZXIpOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgY2k7IGNpID0gaW1nc1tpKytdOykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNyYyA9IGNpLmdldEF0dHJpYnV0ZSgiX3NyYyIpIHx8IGNpLnNyYyB8fCAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwLCBjajsgY2ogPSBzcmNVcmxzW2orK107KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IHVybHNbaiAtIDFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzcmMgPT0gY2ogJiYgdXJsICE9ICJlcnJvciIpIHsgIC8v5oqT5Y+W5aSx6LSl5pe25LiN5YGa5pu/5o2i5aSE55CGDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5Zyw5Z2A5L+u5q2jDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdTcmMgPSBtZS5vcHRpb25zLmNhdGNoZXJQYXRoICsgdXJsOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5zZXRBdHRyaWJ1dGVzKGNpLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic3JjIjpuZXdTcmMsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiX3NyYyI6bmV3U3JjDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgbWUuZmlyZUV2ZW50KCdjYXRjaHJlbW90ZXN1Y2Nlc3MnKQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgLy/lm57osIPlpLHotKXvvIzmnKzmrKHor7fmsYLotoXml7YNCiAgICAgICAgICAgICAgICBlcnJvcjpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgIG1lLmZpcmVFdmVudCgiY2F0Y2hyZW1vdGVlcnJvciIpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQoNCiAgICB9KTsNCn07Ci8vL2ltcG9ydCBjb3JlDQovLy9pbXBvcnQgcGx1Z2luc1xpbnNlcnRodG1sLmpzDQovLy9pbXBvcnQgcGx1Z2luc1xpbWFnZS5qcw0KLy8vY29tbWFuZHNOYW1lICBzbmFwc2NyZWVuDQovLy9jb21tYW5kc1RpdGxlICDmiKrlsY8NCi8qKg0KICog5oiq5bGP5o+S5Lu2DQogKi8NClVFLnBsdWdpbnNbJ3NuYXBzY3JlZW4nXSA9IGZ1bmN0aW9uKCl7DQogICAgdmFyIG1lID0gdGhpcywNCiAgICAgICAgZG9jLA0KICAgICAgICBzbmFwcGx1Z2luOw0KDQogICAgbWUuc2V0T3B0KHsNCiAgICAgICAgc25hcHNjcmVlblNlcnZlclBvcnQ6IGxvY2F0aW9uLnBvcnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+Wxj+W5leaIquWbvueahHNlcnZlcuerr+err+WPow0KICAgICAgICAsc25hcHNjcmVlbkltZ0FsaWduOiAnJyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/miKrlm77nmoTlm77niYfpu5jorqTnmoTmjpLniYjmlrnlvI8NCiAgICAgICAgLHNuYXBzY3JlZW5Ib3N0OiBsb2NhdGlvbi5ob3N0bmFtZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5bGP5bmV5oiq5Zu+55qEc2VydmVy56uv5paH5Lu25omA5Zyo55qE572R56uZ5Zyw5Z2A5oiW6ICFaXDvvIzor7fkuI3opoHliqBodHRwOi8vDQoNCiAgICB9KTsNCiAgICBtZS5jb21tYW5kc1snc25hcHNjcmVlbiddID0gew0KICAgICAgICBleGVjQ29tbWFuZDogZnVuY3Rpb24oKXsNCiAgICAgICAgICAgIHZhciBtZSA9IHRoaXMsbGFuZyA9IG1lLmdldExhbmcoInNuYXBTY3JlZW5fcGx1Z2luIik7DQogICAgICAgICAgICBpZighc25hcHBsdWdpbil7DQogICAgICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9IG1lLmNvbnRhaW5lcjsNCiAgICAgICAgICAgICAgICBkb2MgPSBjb250YWluZXIub3duZXJEb2N1bWVudCB8fCBjb250YWluZXIuZG9jdW1lbnQ7DQogICAgICAgICAgICAgICAgc25hcHBsdWdpbiA9IGRvYy5jcmVhdGVFbGVtZW50KCJvYmplY3QiKTsNCiAgICAgICAgICAgICAgICB0cnl7c25hcHBsdWdpbi50eXBlID0gImFwcGxpY2F0aW9uL3gtcGx1Z2luYmFpZHVzbmFwIjt9Y2F0Y2goZSl7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgc25hcHBsdWdpbi5zdHlsZS5jc3NUZXh0ID0gInBvc2l0aW9uOmFic29sdXRlO2xlZnQ6LTk5OTlweDsiOw0KICAgICAgICAgICAgICAgIHNuYXBwbHVnaW4uc2V0QXR0cmlidXRlKCJ3aWR0aCIsIjAiKTsNCiAgICAgICAgICAgICAgICBzbmFwcGx1Z2luLnNldEF0dHJpYnV0ZSgiaGVpZ2h0IiwiMCIpOw0KICAgICAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChzbmFwcGx1Z2luKTsNCiAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgIHZhciBlZGl0b3JPcHRpb25zID0gbWUub3B0aW9uczsNCg0KICAgICAgICAgICAgdmFyIG9uU3VjY2VzcyA9IGZ1bmN0aW9uKHJzKXsNCiAgICAgICAgICAgICAgICB0cnl7DQogICAgICAgICAgICAgICAgICAgIHJzID0gZXZhbCgiKCIrIHJzICsiKSIpOw0KICAgICAgICAgICAgICAgIH1jYXRjaChlKXsNCiAgICAgICAgICAgICAgICAgICAgYWxlcnQobGFuZy5jYWxsQmFja0Vycm9yTXNnKTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmKHJzLnN0YXRlICE9ICdTVUNDRVNTJyl7DQogICAgICAgICAgICAgICAgICAgIGFsZXJ0KHJzLnN0YXRlKTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBtZS5leGVjQ29tbWFuZCgnaW5zZXJ0aW1hZ2UnLCB7DQogICAgICAgICAgICAgICAgICAgIHNyYzogZWRpdG9yT3B0aW9ucy5zbmFwc2NyZWVuUGF0aCArIHJzLnVybCwNCiAgICAgICAgICAgICAgICAgICAgZmxvYXRTdHlsZTogZWRpdG9yT3B0aW9ucy5zbmFwc2NyZWVuSW1nQWxpZ24sDQogICAgICAgICAgICAgICAgICAgIF9zcmM6ZWRpdG9yT3B0aW9ucy5zbmFwc2NyZWVuUGF0aCArIHJzLnVybA0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIHZhciBvblN0YXJ0VXBsb2FkID0gZnVuY3Rpb24oKXsNCiAgICAgICAgICAgICAgICAvL+W8gOWni+aIquWbvuS4iuS8oA0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIHZhciBvbkVycm9yID0gZnVuY3Rpb24oKXsNCiAgICAgICAgICAgICAgICBhbGVydChsYW5nLnVwbG9hZEVycm9yTXNnKTsNCiAgICAgICAgICAgIH07DQogICAgICAgICAgICB0cnl7DQogICAgICAgICAgICAgICAgdmFyIHBvcnQgPSBlZGl0b3JPcHRpb25zLnNuYXBzY3JlZW5TZXJ2ZXJQb3J0ICsgJyc7DQogICAgICAgICAgICAgICAgZWRpdG9yT3B0aW9ucy5zbmFwc2NyZWVuU2VydmVyVXJsID0gZWRpdG9yT3B0aW9ucy5zbmFwc2NyZWVuU2VydmVyVXJsLnNwbGl0KCBlZGl0b3JPcHRpb25zLnNuYXBzY3JlZW5Ib3N0ICk7DQogICAgICAgICAgICAgICAgZWRpdG9yT3B0aW9ucy5zbmFwc2NyZWVuU2VydmVyVXJsID0gZWRpdG9yT3B0aW9ucy5zbmFwc2NyZWVuU2VydmVyVXJsWzFdIHx8IGVkaXRvck9wdGlvbnMuc25hcHNjcmVlblNlcnZlclVybFswXTsNCiAgICAgICAgICAgICAgICBpZiggZWRpdG9yT3B0aW9ucy5zbmFwc2NyZWVuU2VydmVyVXJsLmluZGV4T2YoIjoiK3BvcnQpID09PSAwICkgew0KICAgICAgICAgICAgICAgICAgICBlZGl0b3JPcHRpb25zLnNuYXBzY3JlZW5TZXJ2ZXJVcmwgPSBlZGl0b3JPcHRpb25zLnNuYXBzY3JlZW5TZXJ2ZXJVcmwuc3Vic3RyaW5nKCBwb3J0Lmxlbmd0aCsxICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHZhciByZXQgPXNuYXBwbHVnaW4uc2F2ZVNuYXBzaG90KGVkaXRvck9wdGlvbnMuc25hcHNjcmVlbkhvc3QsIGVkaXRvck9wdGlvbnMuc25hcHNjcmVlblNlcnZlclVybCwgcG9ydCk7DQogICAgICAgICAgICAgICAgb25TdWNjZXNzKHJldCk7DQogICAgICAgICAgICB9Y2F0Y2goZSl7DQogICAgICAgICAgICAgICAgbWUudWkuX2RpYWxvZ3NbJ3NuYXBzY3JlZW5EaWFsb2cnXS5vcGVuKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9Ow0KfQ0KDQoKLy8vaW1wb3J0IGNvcmUNCi8vL2ltcG9ydCBwbHVnaW5zL2luc2VydGh0bWwuanMNCi8vL2NvbW1hbmRzIOmfs+S5kA0KLy8vY29tbWFuZHNOYW1lIE11c2ljDQovLy9jb21tYW5kc1RpdGxlICDmj5LlhaXpn7PkuZANCi8vL2NvbW1hbmRzRGlhbG9nICBkaWFsb2dzXG11c2ljDQpVRS5wbHVnaW5zWydtdXNpYyddID0gZnVuY3Rpb24gKCkgew0KICAgIHZhciBtZSA9IHRoaXMsDQogICAgICAgIGRpdjsNCg0KICAgIC8qKg0KICAgICAqIOWIm+W7uuaPkuWFpemfs+S5kOWtl+espueqnA0KICAgICAqIEBwYXJhbSB1cmwg6Z+z5LmQ5Zyw5Z2ADQogICAgICogQHBhcmFtIHdpZHRoIOmfs+S5kOWuveW6pg0KICAgICAqIEBwYXJhbSBoZWlnaHQg6Z+z5LmQ6auY5bqmDQogICAgICogQHBhcmFtIGFsaWduIOmYtOmbqOWvuem9kA0KICAgICAqIEBwYXJhbSB0b0VtYmVkIOaYr+WQpuS7pWZsYXNo5Luj5pu/5pi+56S6DQogICAgICogQHBhcmFtIGFkZFBhcmFncmFwaCAg5piv5ZCm6ZyA6KaB5re75YqgUOagh+etvg0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGNyZWF0SW5zZXJ0U3RyKHVybCx3aWR0aCxoZWlnaHQsYWxpZ24sdG9FbWJlZCxhZGRQYXJhZ3JhcGgpew0KICAgICAgICByZXR1cm4gICF0b0VtYmVkID8NCiAgICAgICAgICAgIChhZGRQYXJhZ3JhcGg/ICgnPHAgJysgKGFsaWduICE9Im5vbmUiID8gKCBhbGlnbiA9PSAiY2VudGVyIj8gJyBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7IiAnOicgc3R5bGU9ImZsb2F0OiInKyBhbGlnbiApIDogJycpICsgJz4nKTogJycpICsNCiAgICAgICAgICAgICAgICAnPGltZyBhbGlnbj0iJythbGlnbisnIiB3aWR0aD0iJysgd2lkdGggKyciIGhlaWdodD0iJyArIGhlaWdodCArICciIF91cmw9IicrdXJsKyciIGNsYXNzPSJlZHVpLWZha2VkLW11c2ljIicgKw0KICAgICAgICAgICAgICAgICcgc3JjPSInK21lLm9wdGlvbnMubGFuZ1BhdGgrbWUub3B0aW9ucy5sYW5nKycvaW1hZ2VzL211c2ljLnBuZyIgLz4nICsNCiAgICAgICAgICAgICAgICAoYWRkUGFyYWdyYXBoPyc8L3A+JzonJykNCiAgICAgICAgICAgIDoNCiAgICAgICAgICAgICc8ZW1iZWQgdHlwZT0iYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2giIGNsYXNzPSJlZHVpLWZha2VkLW11c2ljIiBwbHVnaW5zcGFnZT0iaHR0cDovL3d3dy5tYWNyb21lZGlhLmNvbS9nby9nZXRmbGFzaHBsYXllciInICsNCiAgICAgICAgICAgICAgICAnIHNyYz0iJyArIHVybCArICciIHdpZHRoPSInICsgd2lkdGggICsgJyIgaGVpZ2h0PSInICsgaGVpZ2h0ICArICciIGFsaWduPSInICsgYWxpZ24gKyAnIicgKw0KICAgICAgICAgICAgICAgICggYWxpZ24gIT0ibm9uZSIgPyAnIHN0eWxlPSAiJysgKCBhbGlnbiA9PSAiY2VudGVyIj8gImRpc3BsYXk6YmxvY2s7IjoiIGZsb2F0OiAiKyBhbGlnbiApICArICciJyA6JycgKSArDQogICAgICAgICAgICAgICAgJyB3bW9kZT0idHJhbnNwYXJlbnQiIHBsYXk9InRydWUiIGxvb3A9ImZhbHNlIiBtZW51PSJmYWxzZSIgYWxsb3dzY3JpcHRhY2Nlc3M9Im5ldmVyIiBhbGxvd2Z1bGxzY3JlZW49InRydWUiID4nOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHN3aXRjaEltZ0FuZEVtYmVkKGltZzJlbWJlZCkgew0KICAgICAgICB2YXIgdG1wZGl2LA0KICAgICAgICAgICAgbm9kZXMgPSBkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZShtZS5kb2N1bWVudCwgIWltZzJlbWJlZCA/ICJlbWJlZCIgOiAiaW1nIik7DQogICAgICAgIGZvciAodmFyIGkgPSAwLCBub2RlOyBub2RlID0gbm9kZXNbaSsrXTspIHsNCiAgICAgICAgICAgIGlmIChub2RlLmNsYXNzTmFtZSAhPSAiZWR1aS1mYWtlZC1tdXNpYyIpIHsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRtcGRpdiA9IG1lLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOw0KICAgICAgICAgICAgLy/lhYjnnItmbG9hdOWcqOeci2FsaWduLOa1ruWKqOacieeahOaYr+aXtuWAmeaYr+WcqGZsb2F05LiK5a6a5LmJ55qEDQogICAgICAgICAgICB2YXIgYWxpZ24gPSBkb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKG5vZGUsJ2Zsb2F0Jyk7DQogICAgICAgICAgICBhbGlnbiA9IGFsaWduID09ICdub25lJyA/IChub2RlLmdldEF0dHJpYnV0ZSgnYWxpZ24nKSB8fCAnJykgOiBhbGlnbjsNCiAgICAgICAgICAgIHRtcGRpdi5pbm5lckhUTUwgPSBjcmVhdEluc2VydFN0cihpbWcyZW1iZWQgPyBub2RlLmdldEF0dHJpYnV0ZSgiX3VybCIpIDogbm9kZS5nZXRBdHRyaWJ1dGUoInNyYyIpLCBub2RlLndpZHRoLCBub2RlLmhlaWdodCwgYWxpZ24sIGltZzJlbWJlZCk7DQogICAgICAgICAgICBub2RlLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKHRtcGRpdi5maXJzdENoaWxkLCBub2RlKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIG1lLmFkZExpc3RlbmVyKCJiZWZvcmVnZXRjb250ZW50IiwgZnVuY3Rpb24gKCkgew0KICAgICAgICBzd2l0Y2hJbWdBbmRFbWJlZCh0cnVlKTsNCiAgICB9KTsNCiAgICBtZS5hZGRMaXN0ZW5lcignYWZ0ZXJzZXRjb250ZW50JywgZnVuY3Rpb24gKCkgew0KICAgICAgICBzd2l0Y2hJbWdBbmRFbWJlZChmYWxzZSk7DQogICAgfSk7DQogICAgbWUuYWRkTGlzdGVuZXIoJ2FmdGVyZ2V0Y29udGVudCcsIGZ1bmN0aW9uIChjbWROYW1lKSB7DQogICAgICAgIGlmIChjbWROYW1lID09ICdhZnRlcmdldGNvbnRlbnQnICYmIG1lLnF1ZXJ5Q29tbWFuZFN0YXRlKCdzb3VyY2UnKSkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICAgIHN3aXRjaEltZ0FuZEVtYmVkKGZhbHNlKTsNCiAgICB9KTsNCg0KICAgIG1lLmNvbW1hbmRzWyJtdXNpYyJdID0gew0KICAgICAgICBleGVjQ29tbWFuZDpmdW5jdGlvbiAoY21kLCBtdXNpY09iaikgew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpcywNCiAgICAgICAgICAgICAgICBzdHIgPSBjcmVhdEluc2VydFN0cihtdXNpY09iai51cmwsIG11c2ljT2JqLndpZHRoIHx8IDQwMCwgbXVzaWNPYmouaGVpZ2h0IHx8IDk1LCAibm9uZSIsIGZhbHNlLCB0cnVlKTsNCiAgICAgICAgICAgIG1lLmV4ZWNDb21tYW5kKCJpbnNlcnRodG1sIixzdHIpOw0KICAgICAgICB9LA0KICAgICAgICBxdWVyeUNvbW1hbmRTdGF0ZTpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzLA0KICAgICAgICAgICAgICAgIGltZyA9IG1lLnNlbGVjdGlvbi5nZXRSYW5nZSgpLmdldENsb3NlZE5vZGUoKSwNCiAgICAgICAgICAgICAgICBmbGFnID0gaW1nICYmIChpbWcuY2xhc3NOYW1lID09ICJlZHVpLWZha2VkLW11c2ljIik7DQogICAgICAgICAgICByZXR1cm4gZmxhZyA/IDEgOiAwOw0KICAgICAgICB9DQogICAgfTsNCn07CnZhciBiYWlkdSA9IGJhaWR1IHx8IHt9Ow0KYmFpZHUuZWRpdG9yID0gYmFpZHUuZWRpdG9yIHx8IHt9Ow0KYmFpZHUuZWRpdG9yLnVpID0ge307CihmdW5jdGlvbiAoKXsNCiAgICB2YXIgYnJvd3NlciA9IGJhaWR1LmVkaXRvci5icm93c2VyLA0KICAgICAgICBkb21VdGlscyA9IGJhaWR1LmVkaXRvci5kb20uZG9tVXRpbHM7DQoNCiAgICB2YXIgbWFnaWMgPSAnJEVESVRPUlVJJzsNCiAgICB2YXIgcm9vdCA9IHdpbmRvd1ttYWdpY10gPSB7fTsNCiAgICB2YXIgdWlkTWFnaWMgPSAnSUQnICsgbWFnaWM7DQogICAgdmFyIHVpZENvdW50ID0gMDsNCg0KICAgIHZhciB1aVV0aWxzID0gYmFpZHUuZWRpdG9yLnVpLnVpVXRpbHMgPSB7DQogICAgICAgIHVpZDogZnVuY3Rpb24gKG9iail7DQogICAgICAgICAgICByZXR1cm4gKG9iaiA/IG9ialt1aWRNYWdpY10gfHwgKG9ialt1aWRNYWdpY10gPSArKyB1aWRDb3VudCkgOiArKyB1aWRDb3VudCk7DQogICAgICAgIH0sDQogICAgICAgIGhvb2s6IGZ1bmN0aW9uICggZm4sIGNhbGxiYWNrICkgew0KICAgICAgICAgICAgdmFyIGRnOw0KICAgICAgICAgICAgaWYgKGZuICYmIGZuLl9jYWxsYmFja3MpIHsNCiAgICAgICAgICAgICAgICBkZyA9IGZuOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBkZyA9IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgICAgICAgICB2YXIgcTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGZuKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBxID0gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB2YXIgY2FsbGJhY2tzID0gZGcuX2NhbGxiYWNrczsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGsgPSBjYWxsYmFja3MubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICB3aGlsZSAoayAtLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBjYWxsYmFja3Nba10uYXBwbHkodGhpcywgYXJndW1lbnRzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxID0gcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gcTsNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIGRnLl9jYWxsYmFja3MgPSBbXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGRnLl9jYWxsYmFja3MucHVzaChjYWxsYmFjayk7DQogICAgICAgICAgICByZXR1cm4gZGc7DQogICAgICAgIH0sDQogICAgICAgIGNyZWF0ZUVsZW1lbnRCeUh0bWw6IGZ1bmN0aW9uIChodG1sKXsNCiAgICAgICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgICAgICAgICAgZWwuaW5uZXJIVE1MID0gaHRtbDsNCiAgICAgICAgICAgIGVsID0gZWwuZmlyc3RDaGlsZDsNCiAgICAgICAgICAgIGVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWwpOw0KICAgICAgICAgICAgcmV0dXJuIGVsOw0KICAgICAgICB9LA0KICAgICAgICBnZXRWaWV3cG9ydEVsZW1lbnQ6IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgcmV0dXJuIChicm93c2VyLmllICYmIGJyb3dzZXIucXVpcmtzKSA/DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keSA6IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsNCiAgICAgICAgfSwNCiAgICAgICAgZ2V0Q2xpZW50UmVjdDogZnVuY3Rpb24gKGVsZW1lbnQpew0KICAgICAgICAgICAgdmFyIGJjcjsNCiAgICAgICAgICAgIC8vdHJhY2UgIElFNuS4i+WcqOaOp+WItue8lui+keWZqOaYvumakOaXtuWPr+iDveS8muaKpemUme+8jGNhdGNo5LiA5LiLDQogICAgICAgICAgICB0cnl7DQogICAgICAgICAgICAgICAgYmNyID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICAgICAgICAgIH1jYXRjaChlKXsNCiAgICAgICAgICAgICAgICBiY3I9e2xlZnQ6MCx0b3A6MCxoZWlnaHQ6MCx3aWR0aDowfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdmFyIHJlY3QgPSB7DQogICAgICAgICAgICAgICAgbGVmdDogTWF0aC5yb3VuZChiY3IubGVmdCksDQogICAgICAgICAgICAgICAgdG9wOiBNYXRoLnJvdW5kKGJjci50b3ApLA0KICAgICAgICAgICAgICAgIGhlaWdodDogTWF0aC5yb3VuZChiY3IuYm90dG9tIC0gYmNyLnRvcCksDQogICAgICAgICAgICAgICAgd2lkdGg6IE1hdGgucm91bmQoYmNyLnJpZ2h0IC0gYmNyLmxlZnQpDQogICAgICAgICAgICB9Ow0KICAgICAgICAgICAgdmFyIGRvYzsNCiAgICAgICAgICAgIHdoaWxlICgoZG9jID0gZWxlbWVudC5vd25lckRvY3VtZW50KSAhPT0gZG9jdW1lbnQgJiYNCiAgICAgICAgICAgICAgICAoZWxlbWVudCA9IGRvbVV0aWxzLmdldFdpbmRvdyhkb2MpLmZyYW1lRWxlbWVudCkpIHsNCiAgICAgICAgICAgICAgICBiY3IgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgICAgICAgICAgICAgIHJlY3QubGVmdCArPSBiY3IubGVmdDsNCiAgICAgICAgICAgICAgICByZWN0LnRvcCArPSBiY3IudG9wOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmVjdC5ib3R0b20gPSByZWN0LnRvcCArIHJlY3QuaGVpZ2h0Ow0KICAgICAgICAgICAgcmVjdC5yaWdodCA9IHJlY3QubGVmdCArIHJlY3Qud2lkdGg7DQogICAgICAgICAgICByZXR1cm4gcmVjdDsNCiAgICAgICAgfSwNCiAgICAgICAgZ2V0Vmlld3BvcnRSZWN0OiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIHZhciB2aWV3cG9ydEVsID0gdWlVdGlscy5nZXRWaWV3cG9ydEVsZW1lbnQoKTsNCiAgICAgICAgICAgIHZhciB3aWR0aCA9ICh3aW5kb3cuaW5uZXJXaWR0aCB8fCB2aWV3cG9ydEVsLmNsaWVudFdpZHRoKSB8IDA7DQogICAgICAgICAgICB2YXIgaGVpZ2h0ID0gKHdpbmRvdy5pbm5lckhlaWdodCB8fHZpZXdwb3J0RWwuY2xpZW50SGVpZ2h0KSB8IDA7DQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgIGxlZnQ6IDAsDQogICAgICAgICAgICAgICAgdG9wOiAwLA0KICAgICAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0LA0KICAgICAgICAgICAgICAgIHdpZHRoOiB3aWR0aCwNCiAgICAgICAgICAgICAgICBib3R0b206IGhlaWdodCwNCiAgICAgICAgICAgICAgICByaWdodDogd2lkdGgNCiAgICAgICAgICAgIH07DQogICAgICAgIH0sDQogICAgICAgIHNldFZpZXdwb3J0T2Zmc2V0OiBmdW5jdGlvbiAoZWxlbWVudCwgb2Zmc2V0KXsNCiAgICAgICAgICAgIHZhciByZWN0Ow0KICAgICAgICAgICAgdmFyIGZpeGVkTGF5ZXIgPSB1aVV0aWxzLmdldEZpeGVkTGF5ZXIoKTsNCiAgICAgICAgICAgIGlmIChlbGVtZW50LnBhcmVudE5vZGUgPT09IGZpeGVkTGF5ZXIpIHsNCiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmxlZnQgPSBvZmZzZXQubGVmdCArICdweCc7DQogICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS50b3AgPSBvZmZzZXQudG9wICsgJ3B4JzsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgZG9tVXRpbHMuc2V0Vmlld3BvcnRPZmZzZXQoZWxlbWVudCwgb2Zmc2V0KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgZ2V0RXZlbnRPZmZzZXQ6IGZ1bmN0aW9uIChldnQpew0KICAgICAgICAgICAgdmFyIGVsID0gZXZ0LnRhcmdldCB8fCBldnQuc3JjRWxlbWVudDsNCiAgICAgICAgICAgIHZhciByZWN0ID0gdWlVdGlscy5nZXRDbGllbnRSZWN0KGVsKTsNCiAgICAgICAgICAgIHZhciBvZmZzZXQgPSB1aVV0aWxzLmdldFZpZXdwb3J0T2Zmc2V0QnlFdmVudChldnQpOw0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICBsZWZ0OiBvZmZzZXQubGVmdCAtIHJlY3QubGVmdCwNCiAgICAgICAgICAgICAgICB0b3A6IG9mZnNldC50b3AgLSByZWN0LnRvcA0KICAgICAgICAgICAgfTsNCiAgICAgICAgfSwNCiAgICAgICAgZ2V0Vmlld3BvcnRPZmZzZXRCeUV2ZW50OiBmdW5jdGlvbiAoZXZ0KXsNCiAgICAgICAgICAgIHZhciBlbCA9IGV2dC50YXJnZXQgfHwgZXZ0LnNyY0VsZW1lbnQ7DQogICAgICAgICAgICB2YXIgZnJhbWVFbCA9IGRvbVV0aWxzLmdldFdpbmRvdyhlbCkuZnJhbWVFbGVtZW50Ow0KICAgICAgICAgICAgdmFyIG9mZnNldCA9IHsNCiAgICAgICAgICAgICAgICBsZWZ0OiBldnQuY2xpZW50WCwNCiAgICAgICAgICAgICAgICB0b3A6IGV2dC5jbGllbnRZDQogICAgICAgICAgICB9Ow0KICAgICAgICAgICAgaWYgKGZyYW1lRWwgJiYgZWwub3duZXJEb2N1bWVudCAhPT0gZG9jdW1lbnQpIHsNCiAgICAgICAgICAgICAgICB2YXIgcmVjdCA9IHVpVXRpbHMuZ2V0Q2xpZW50UmVjdChmcmFtZUVsKTsNCiAgICAgICAgICAgICAgICBvZmZzZXQubGVmdCArPSByZWN0LmxlZnQ7DQogICAgICAgICAgICAgICAgb2Zmc2V0LnRvcCArPSByZWN0LnRvcDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBvZmZzZXQ7DQogICAgICAgIH0sDQogICAgICAgIHNldEdsb2JhbDogZnVuY3Rpb24gKGlkLCBvYmopew0KICAgICAgICAgICAgcm9vdFtpZF0gPSBvYmo7DQogICAgICAgICAgICByZXR1cm4gbWFnaWMgKyAnWyInICsgaWQgICsgJyJdJzsNCiAgICAgICAgfSwNCiAgICAgICAgdW5zZXRHbG9iYWw6IGZ1bmN0aW9uIChpZCl7DQogICAgICAgICAgICBkZWxldGUgcm9vdFtpZF07DQogICAgICAgIH0sDQogICAgICAgIGNvcHlBdHRyaWJ1dGVzOiBmdW5jdGlvbiAodGd0LCBzcmMpew0KICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZXMgPSBzcmMuYXR0cmlidXRlczsNCiAgICAgICAgICAgIHZhciBrID0gYXR0cmlidXRlcy5sZW5ndGg7DQogICAgICAgICAgICB3aGlsZSAoayAtLSkgew0KICAgICAgICAgICAgICAgIHZhciBhdHRyTm9kZSA9IGF0dHJpYnV0ZXNba107DQogICAgICAgICAgICAgICAgaWYgKCBhdHRyTm9kZS5ub2RlTmFtZSAhPSAnc3R5bGUnICYmIGF0dHJOb2RlLm5vZGVOYW1lICE9ICdjbGFzcycgJiYgKCFicm93c2VyLmllIHx8IGF0dHJOb2RlLnNwZWNpZmllZCkgKSB7DQogICAgICAgICAgICAgICAgICAgIHRndC5zZXRBdHRyaWJ1dGUoYXR0ck5vZGUubm9kZU5hbWUsIGF0dHJOb2RlLm5vZGVWYWx1ZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKHNyYy5jbGFzc05hbWUpIHsNCiAgICAgICAgICAgICAgICBkb21VdGlscy5hZGRDbGFzcyh0Z3Qsc3JjLmNsYXNzTmFtZSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoc3JjLnN0eWxlLmNzc1RleHQpIHsNCiAgICAgICAgICAgICAgICB0Z3Quc3R5bGUuY3NzVGV4dCArPSAnOycgKyBzcmMuc3R5bGUuY3NzVGV4dDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgcmVtb3ZlU3R5bGU6IGZ1bmN0aW9uIChlbCwgc3R5bGVOYW1lKXsNCiAgICAgICAgICAgIGlmIChlbC5zdHlsZS5yZW1vdmVQcm9wZXJ0eSkgew0KICAgICAgICAgICAgICAgIGVsLnN0eWxlLnJlbW92ZVByb3BlcnR5KHN0eWxlTmFtZSk7DQogICAgICAgICAgICB9IGVsc2UgaWYgKGVsLnN0eWxlLnJlbW92ZUF0dHJpYnV0ZSkgew0KICAgICAgICAgICAgICAgIGVsLnN0eWxlLnJlbW92ZUF0dHJpYnV0ZShzdHlsZU5hbWUpOw0KICAgICAgICAgICAgfSBlbHNlIHRocm93ICcnOw0KICAgICAgICB9LA0KICAgICAgICBjb250YWluczogZnVuY3Rpb24gKGVsQSwgZWxCKXsNCiAgICAgICAgICAgIHJldHVybiBlbEEgJiYgZWxCICYmIChlbEEgPT09IGVsQiA/IGZhbHNlIDogKA0KICAgICAgICAgICAgICAgIGVsQS5jb250YWlucyA/IGVsQS5jb250YWlucyhlbEIpIDoNCiAgICAgICAgICAgICAgICAgICAgZWxBLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGVsQikgJiAxNg0KICAgICAgICAgICAgICAgICkpOw0KICAgICAgICB9LA0KICAgICAgICBzdGFydERyYWc6IGZ1bmN0aW9uIChldnQsIGNhbGxiYWNrcyxkb2Mpew0KICAgICAgICAgICAgdmFyIGRvYyA9IGRvYyB8fCBkb2N1bWVudDsNCiAgICAgICAgICAgIHZhciBzdGFydFggPSBldnQuY2xpZW50WDsNCiAgICAgICAgICAgIHZhciBzdGFydFkgPSBldnQuY2xpZW50WTsNCiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZU1vdXNlTW92ZShldnQpew0KICAgICAgICAgICAgICAgIHZhciB4ID0gZXZ0LmNsaWVudFggLSBzdGFydFg7DQogICAgICAgICAgICAgICAgdmFyIHkgPSBldnQuY2xpZW50WSAtIHN0YXJ0WTsNCiAgICAgICAgICAgICAgICBjYWxsYmFja3Mub25kcmFnbW92ZSh4LCB5LGV2dCk7DQogICAgICAgICAgICAgICAgaWYgKGV2dC5zdG9wUHJvcGFnYXRpb24pIHsNCiAgICAgICAgICAgICAgICAgICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGV2dC5jYW5jZWxCdWJibGUgPSB0cnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChkb2MuYWRkRXZlbnRMaXN0ZW5lcikgew0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZU1vdXNlVXAoZXZ0KXsNCiAgICAgICAgICAgICAgICAgICAgZG9jLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIGhhbmRsZU1vdXNlTW92ZSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIGRvYy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgaGFuZGxlTW91c2VVcCwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgaGFuZGxlTW91c2VVcCwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrcy5vbmRyYWdzdG9wKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGRvYy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBoYW5kbGVNb3VzZU1vdmUsIHRydWUpOw0KICAgICAgICAgICAgICAgIGRvYy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgaGFuZGxlTW91c2VVcCwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBoYW5kbGVNb3VzZVVwLCB0cnVlKTsNCg0KICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB2YXIgZWxtID0gZXZ0LnNyY0VsZW1lbnQ7DQogICAgICAgICAgICAgICAgZWxtLnNldENhcHR1cmUoKTsNCiAgICAgICAgICAgICAgICBmdW5jdGlvbiByZWxlYXNlQ2FwdHJ1ZSgpew0KICAgICAgICAgICAgICAgICAgICBlbG0ucmVsZWFzZUNhcHR1cmUoKTsNCiAgICAgICAgICAgICAgICAgICAgZWxtLmRldGFjaEV2ZW50KCdvbm1vdXNlbW92ZScsIGhhbmRsZU1vdXNlTW92ZSk7DQogICAgICAgICAgICAgICAgICAgIGVsbS5kZXRhY2hFdmVudCgnb25tb3VzZXVwJywgcmVsZWFzZUNhcHRydWUpOw0KICAgICAgICAgICAgICAgICAgICBlbG0uZGV0YWNoRXZlbnQoJ29ubG9zZWNhcHRydWUnLCByZWxlYXNlQ2FwdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrcy5vbmRyYWdzdG9wKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsbS5hdHRhY2hFdmVudCgnb25tb3VzZW1vdmUnLCBoYW5kbGVNb3VzZU1vdmUpOw0KICAgICAgICAgICAgICAgIGVsbS5hdHRhY2hFdmVudCgnb25tb3VzZXVwJywgcmVsZWFzZUNhcHRydWUpOw0KICAgICAgICAgICAgICAgIGVsbS5hdHRhY2hFdmVudCgnb25sb3NlY2FwdHJ1ZScsIHJlbGVhc2VDYXB0cnVlKTsNCiAgICAgICAgICAgICAgICBldnQucmV0dXJuVmFsdWUgPSBmYWxzZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGNhbGxiYWNrcy5vbmRyYWdzdGFydCgpOw0KICAgICAgICB9LA0KICAgICAgICBnZXRGaXhlZExheWVyOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIHZhciBsYXllciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZHVpX2ZpeGVkbGF5ZXInKTsNCiAgICAgICAgICAgIGlmIChsYXllciA9PSBudWxsKSB7DQogICAgICAgICAgICAgICAgbGF5ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICAgICAgICAgICAgICBsYXllci5pZCA9ICdlZHVpX2ZpeGVkbGF5ZXInOw0KICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGF5ZXIpOw0KICAgICAgICAgICAgICAgIGlmIChicm93c2VyLmllICYmIGJyb3dzZXIudmVyc2lvbiA8PSA4KSB7DQogICAgICAgICAgICAgICAgICAgIGxheWVyLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJzsNCiAgICAgICAgICAgICAgICAgICAgYmluZEZpeGVkTGF5ZXIoKTsNCiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCh1cGRhdGVGaXhlZE9mZnNldCk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgbGF5ZXIuc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBsYXllci5zdHlsZS5sZWZ0ID0gJzAnOw0KICAgICAgICAgICAgICAgIGxheWVyLnN0eWxlLnRvcCA9ICcwJzsNCiAgICAgICAgICAgICAgICBsYXllci5zdHlsZS53aWR0aCA9ICcwJzsNCiAgICAgICAgICAgICAgICBsYXllci5zdHlsZS5oZWlnaHQgPSAnMCc7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gbGF5ZXI7DQogICAgICAgIH0sDQogICAgICAgIG1ha2VVbnNlbGVjdGFibGU6IGZ1bmN0aW9uIChlbGVtZW50KXsNCiAgICAgICAgICAgIGlmIChicm93c2VyLm9wZXJhIHx8IChicm93c2VyLmllICYmIGJyb3dzZXIudmVyc2lvbiA8IDkpKSB7DQogICAgICAgICAgICAgICAgZWxlbWVudC51bnNlbGVjdGFibGUgPSAnb24nOw0KICAgICAgICAgICAgICAgIGlmIChlbGVtZW50Lmhhc0NoaWxkTm9kZXMoKSkgew0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpPTA7IGk8ZWxlbWVudC5jaGlsZE5vZGVzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5jaGlsZE5vZGVzW2ldLm5vZGVUeXBlID09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aVV0aWxzLm1ha2VVbnNlbGVjdGFibGUoZWxlbWVudC5jaGlsZE5vZGVzW2ldKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuc3R5bGUuTW96VXNlclNlbGVjdCAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuTW96VXNlclNlbGVjdCA9ICdub25lJzsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVsZW1lbnQuc3R5bGUuV2Via2l0VXNlclNlbGVjdCAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuV2Via2l0VXNlclNlbGVjdCA9ICdub25lJzsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVsZW1lbnQuc3R5bGUuS2h0bWxVc2VyU2VsZWN0ICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5LaHRtbFVzZXJTZWxlY3QgPSAnbm9uZSc7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfTsNCiAgICBmdW5jdGlvbiB1cGRhdGVGaXhlZE9mZnNldCgpew0KICAgICAgICB2YXIgbGF5ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWR1aV9maXhlZGxheWVyJyk7DQogICAgICAgIHVpVXRpbHMuc2V0Vmlld3BvcnRPZmZzZXQobGF5ZXIsIHsNCiAgICAgICAgICAgIGxlZnQ6IDAsDQogICAgICAgICAgICB0b3A6IDANCiAgICAgICAgfSk7DQovLyAgICAgICAgbGF5ZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCi8vICAgICAgICBsYXllci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCg0KICAgICAgICAvLyN0cmFjZTogMTM1NA0KLy8gICAgICAgIHNldFRpbWVvdXQodXBkYXRlRml4ZWRPZmZzZXQpOw0KICAgIH0NCiAgICBmdW5jdGlvbiBiaW5kRml4ZWRMYXllcihhZGpPZmZzZXQpew0KICAgICAgICBkb21VdGlscy5vbih3aW5kb3csICdzY3JvbGwnLCB1cGRhdGVGaXhlZE9mZnNldCk7DQogICAgICAgIGRvbVV0aWxzLm9uKHdpbmRvdywgJ3Jlc2l6ZScsIGJhaWR1LmVkaXRvci51dGlscy5kZWZlcih1cGRhdGVGaXhlZE9mZnNldCwgMCwgdHJ1ZSkpOw0KICAgIH0NCn0pKCk7DQoKKGZ1bmN0aW9uICgpIHsNCiAgICB2YXIgdXRpbHMgPSBiYWlkdS5lZGl0b3IudXRpbHMsDQogICAgICAgIHVpVXRpbHMgPSBiYWlkdS5lZGl0b3IudWkudWlVdGlscywNCiAgICAgICAgRXZlbnRCYXNlID0gYmFpZHUuZWRpdG9yLkV2ZW50QmFzZSwNCiAgICAgICAgVUlCYXNlID0gYmFpZHUuZWRpdG9yLnVpLlVJQmFzZSA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgfTsNCg0KICAgIFVJQmFzZS5wcm90b3R5cGUgPSB7DQogICAgICAgIGNsYXNzTmFtZTonJywNCiAgICAgICAgdWlOYW1lOicnLA0KICAgICAgICBpbml0T3B0aW9uczpmdW5jdGlvbiAob3B0aW9ucykgew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpczsNCiAgICAgICAgICAgIGZvciAodmFyIGsgaW4gb3B0aW9ucykgew0KICAgICAgICAgICAgICAgIG1lW2tdID0gb3B0aW9uc1trXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuaWQgPSB0aGlzLmlkIHx8ICdlZHVpJyArIHVpVXRpbHMudWlkKCk7DQogICAgICAgIH0sDQogICAgICAgIGluaXRVSUJhc2U6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdGhpcy5fZ2xvYmFsS2V5ID0gdXRpbHMudW5odG1sKHVpVXRpbHMuc2V0R2xvYmFsKHRoaXMuaWQsIHRoaXMpKTsNCiAgICAgICAgfSwNCiAgICAgICAgcmVuZGVyOmZ1bmN0aW9uIChob2xkZXIpIHsNCiAgICAgICAgICAgIHZhciBodG1sID0gdGhpcy5yZW5kZXJIdG1sKCk7DQogICAgICAgICAgICB2YXIgZWwgPSB1aVV0aWxzLmNyZWF0ZUVsZW1lbnRCeUh0bWwoaHRtbCk7DQoNCiAgICAgICAgICAgIC8vYnkgeHVoZW5nIOe7meavj+S4qm5vZGXmt7vliqBjbGFzcw0KICAgICAgICAgICAgdmFyIGxpc3QgPSBkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZShlbCwgIioiKTsNCiAgICAgICAgICAgIHZhciB0aGVtZSA9ICJlZHVpLSIgKyAodGhpcy50aGVtZSB8fCB0aGlzLmVkaXRvci5vcHRpb25zLnRoZW1lKTsNCiAgICAgICAgICAgIHZhciBsYXllciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZHVpX2ZpeGVkbGF5ZXInKTsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBub2RlOyBub2RlID0gbGlzdFtpKytdOykgew0KICAgICAgICAgICAgICAgIGRvbVV0aWxzLmFkZENsYXNzKG5vZGUsIHRoZW1lKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGRvbVV0aWxzLmFkZENsYXNzKGVsLCB0aGVtZSk7DQogICAgICAgICAgICBpZihsYXllcil7DQogICAgICAgICAgICAgICAgbGF5ZXIuY2xhc3NOYW1lPSIiOw0KICAgICAgICAgICAgICAgIGRvbVV0aWxzLmFkZENsYXNzKGxheWVyLHRoZW1lKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdmFyIHNlYXRFbCA9IHRoaXMuZ2V0RG9tKCk7DQogICAgICAgICAgICBpZiAoc2VhdEVsICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICBzZWF0RWwucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQoZWwsIHNlYXRFbCk7DQogICAgICAgICAgICAgICAgdWlVdGlscy5jb3B5QXR0cmlidXRlcyhlbCwgc2VhdEVsKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBob2xkZXIgPT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgICAgICAgICAgaG9sZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaG9sZGVyKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaG9sZGVyID0gaG9sZGVyIHx8IHVpVXRpbHMuZ2V0Rml4ZWRMYXllcigpOw0KICAgICAgICAgICAgICAgIGRvbVV0aWxzLmFkZENsYXNzKGhvbGRlciwgdGhlbWUpOw0KICAgICAgICAgICAgICAgIGhvbGRlci5hcHBlbmRDaGlsZChlbCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLnBvc3RSZW5kZXIoKTsNCiAgICAgICAgfSwNCiAgICAgICAgZ2V0RG9tOmZ1bmN0aW9uIChuYW1lKSB7DQogICAgICAgICAgICBpZiAoIW5hbWUpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5pZCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmlkICsgJ18nICsgbmFtZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIHBvc3RSZW5kZXI6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdGhpcy5maXJlRXZlbnQoJ3Bvc3RyZW5kZXInKTsNCiAgICAgICAgfSwNCiAgICAgICAgZ2V0SHRtbFRwbDpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICByZXR1cm4gJyc7DQogICAgICAgIH0sDQogICAgICAgIGZvcm1hdEh0bWw6ZnVuY3Rpb24gKHRwbCkgew0KICAgICAgICAgICAgdmFyIHByZWZpeCA9ICdlZHVpLScgKyB0aGlzLnVpTmFtZTsNCiAgICAgICAgICAgIHJldHVybiAodHBsDQogICAgICAgICAgICAgICAgLnJlcGxhY2UoLyMjL2csIHRoaXMuaWQpDQogICAgICAgICAgICAgICAgLnJlcGxhY2UoLyUlLS9nLCB0aGlzLnVpTmFtZSA/IHByZWZpeCArICctJyA6ICcnKQ0KICAgICAgICAgICAgICAgIC5yZXBsYWNlKC8lJS9nLCAodGhpcy51aU5hbWUgPyBwcmVmaXggOiAnJykgKyAnICcgKyB0aGlzLmNsYXNzTmFtZSkNCiAgICAgICAgICAgICAgICAucmVwbGFjZSgvXCRcJC9nLCB0aGlzLl9nbG9iYWxLZXkpKTsNCiAgICAgICAgfSwNCiAgICAgICAgcmVuZGVySHRtbDpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXRIdG1sKHRoaXMuZ2V0SHRtbFRwbCgpKTsNCiAgICAgICAgfSwNCiAgICAgICAgZGlzcG9zZTpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgYm94ID0gdGhpcy5nZXREb20oKTsNCiAgICAgICAgICAgIGlmIChib3gpIGJhaWR1LmVkaXRvci5kb20uZG9tVXRpbHMucmVtb3ZlKGJveCk7DQogICAgICAgICAgICB1aVV0aWxzLnVuc2V0R2xvYmFsKHRoaXMuaWQpOw0KICAgICAgICB9DQogICAgfTsNCiAgICB1dGlscy5pbmhlcml0cyhVSUJhc2UsIEV2ZW50QmFzZSk7DQp9KSgpOw0KCihmdW5jdGlvbiAoKXsNCiAgICB2YXIgdXRpbHMgPSBiYWlkdS5lZGl0b3IudXRpbHMsDQogICAgICAgIFVJQmFzZSA9IGJhaWR1LmVkaXRvci51aS5VSUJhc2UsDQogICAgICAgIFNlcGFyYXRvciA9IGJhaWR1LmVkaXRvci51aS5TZXBhcmF0b3IgPSBmdW5jdGlvbiAob3B0aW9ucyl7DQogICAgICAgICAgICB0aGlzLmluaXRPcHRpb25zKG9wdGlvbnMpOw0KICAgICAgICAgICAgdGhpcy5pbml0U2VwYXJhdG9yKCk7DQogICAgICAgIH07DQogICAgU2VwYXJhdG9yLnByb3RvdHlwZSA9IHsNCiAgICAgICAgdWlOYW1lOiAnc2VwYXJhdG9yJywNCiAgICAgICAgaW5pdFNlcGFyYXRvcjogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICB0aGlzLmluaXRVSUJhc2UoKTsNCiAgICAgICAgfSwNCiAgICAgICAgZ2V0SHRtbFRwbDogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICByZXR1cm4gJzxkaXYgaWQ9IiMjIiBjbGFzcz0iZWR1aS1ib3ggJSUiPjwvZGl2Pic7DQogICAgICAgIH0NCiAgICB9Ow0KICAgIHV0aWxzLmluaGVyaXRzKFNlcGFyYXRvciwgVUlCYXNlKTsNCg0KfSkoKTsNCgovLy9pbXBvcnQgY29yZQ0KLy8vaW1wb3J0IHVpY29yZQ0KKGZ1bmN0aW9uICgpew0KICAgIHZhciB1dGlscyA9IGJhaWR1LmVkaXRvci51dGlscywNCiAgICAgICAgZG9tVXRpbHMgPSBiYWlkdS5lZGl0b3IuZG9tLmRvbVV0aWxzLA0KICAgICAgICBVSUJhc2UgPSBiYWlkdS5lZGl0b3IudWkuVUlCYXNlLA0KICAgICAgICB1aVV0aWxzID0gYmFpZHUuZWRpdG9yLnVpLnVpVXRpbHM7DQogICAgDQogICAgdmFyIE1hc2sgPSBiYWlkdS5lZGl0b3IudWkuTWFzayA9IGZ1bmN0aW9uIChvcHRpb25zKXsNCiAgICAgICAgdGhpcy5pbml0T3B0aW9ucyhvcHRpb25zKTsNCiAgICAgICAgdGhpcy5pbml0VUlCYXNlKCk7DQogICAgfTsNCiAgICBNYXNrLnByb3RvdHlwZSA9IHsNCiAgICAgICAgZ2V0SHRtbFRwbDogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICByZXR1cm4gJzxkaXYgaWQ9IiMjIiBjbGFzcz0iZWR1aS1tYXNrICUlIiBvbm1vdXNlZG93bj0icmV0dXJuICQkLl9vbk1vdXNlRG93bihldmVudCwgdGhpcyk7Ij48L2Rpdj4nOw0KICAgICAgICB9LA0KICAgICAgICBwb3N0UmVuZGVyOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7DQogICAgICAgICAgICBkb21VdGlscy5vbih3aW5kb3csICdyZXNpemUnLCBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgICAgICAgICBpZiAoIW1lLmlzSGlkZGVuKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lLl9maWxsKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9LA0KICAgICAgICBzaG93OiBmdW5jdGlvbiAoekluZGV4KXsNCiAgICAgICAgICAgIHRoaXMuX2ZpbGwoKTsNCiAgICAgICAgICAgIHRoaXMuZ2V0RG9tKCkuc3R5bGUuZGlzcGxheSA9ICcnOw0KICAgICAgICAgICAgdGhpcy5nZXREb20oKS5zdHlsZS56SW5kZXggPSB6SW5kZXg7DQogICAgICAgIH0sDQogICAgICAgIGhpZGU6IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgdGhpcy5nZXREb20oKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgdGhpcy5nZXREb20oKS5zdHlsZS56SW5kZXggPSAnJzsNCiAgICAgICAgfSwNCiAgICAgICAgaXNIaWRkZW46IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RG9tKCkuc3R5bGUuZGlzcGxheSA9PSAnbm9uZSc7DQogICAgICAgIH0sDQogICAgICAgIF9vbk1vdXNlRG93bjogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0sDQogICAgICAgIF9maWxsOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIHZhciBlbCA9IHRoaXMuZ2V0RG9tKCk7DQogICAgICAgICAgICB2YXIgdnBSZWN0ID0gdWlVdGlscy5nZXRWaWV3cG9ydFJlY3QoKTsNCiAgICAgICAgICAgIGVsLnN0eWxlLndpZHRoID0gdnBSZWN0LndpZHRoICsgJ3B4JzsNCiAgICAgICAgICAgIGVsLnN0eWxlLmhlaWdodCA9IHZwUmVjdC5oZWlnaHQgKyAncHgnOw0KICAgICAgICB9DQogICAgfTsNCiAgICB1dGlscy5pbmhlcml0cyhNYXNrLCBVSUJhc2UpOw0KfSkoKTsNCgovLy9pbXBvcnQgY29yZQ0KLy8vaW1wb3J0IHVpY29yZQ0KKGZ1bmN0aW9uICgpIHsNCiAgICB2YXIgdXRpbHMgPSBiYWlkdS5lZGl0b3IudXRpbHMsDQogICAgICAgIHVpVXRpbHMgPSBiYWlkdS5lZGl0b3IudWkudWlVdGlscywNCiAgICAgICAgZG9tVXRpbHMgPSBiYWlkdS5lZGl0b3IuZG9tLmRvbVV0aWxzLA0KICAgICAgICBVSUJhc2UgPSBiYWlkdS5lZGl0b3IudWkuVUlCYXNlLA0KICAgICAgICBQb3B1cCA9IGJhaWR1LmVkaXRvci51aS5Qb3B1cCA9IGZ1bmN0aW9uIChvcHRpb25zKXsNCiAgICAgICAgICAgIHRoaXMuaW5pdE9wdGlvbnMob3B0aW9ucyk7DQogICAgICAgICAgICB0aGlzLmluaXRQb3B1cCgpOw0KICAgICAgICB9Ow0KDQogICAgdmFyIGFsbFBvcHVwcyA9IFtdOw0KICAgIGZ1bmN0aW9uIGNsb3NlQWxsUG9wdXAoIGV2dCxlbCApew0KICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBhbGxQb3B1cHMubGVuZ3RoOyBpKysgKSB7DQogICAgICAgICAgICB2YXIgcG9wID0gYWxsUG9wdXBzW2ldOw0KICAgICAgICAgICAgaWYgKCFwb3AuaXNIaWRkZW4oKSkgew0KICAgICAgICAgICAgICAgIGlmIChwb3AucXVlcnlBdXRvSGlkZShlbCkgIT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgICAgIGlmKGV2dCYmL3Njcm9sbC9pZy50ZXN0KGV2dC50eXBlKSYmcG9wLmNsYXNzTmFtZT09ImVkdWktd29yZHBhc3RlcG9wIikgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgIHBvcC5oaWRlKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYoYWxsUG9wdXBzLmxlbmd0aCkNCiAgICAgICAgICAgIHBvcC5lZGl0b3IuZmlyZUV2ZW50KCJhZnRlcmhpZGVwb3AiKTsNCiAgICB9DQoNCiAgICBQb3B1cC5wb3N0SGlkZSA9IGNsb3NlQWxsUG9wdXA7DQoNCiAgICB2YXIgQU5DSE9SX0NMQVNTRVMgPSBbJ2VkdWktYW5jaG9yLXRvcGxlZnQnLCdlZHVpLWFuY2hvci10b3ByaWdodCcsDQogICAgICAgICdlZHVpLWFuY2hvci1ib3R0b21sZWZ0JywnZWR1aS1hbmNob3ItYm90dG9tcmlnaHQnXTsNCiAgICBQb3B1cC5wcm90b3R5cGUgPSB7DQogICAgICAgIFNIQURPV19SQURJVVM6IDUsDQogICAgICAgIGNvbnRlbnQ6IG51bGwsDQogICAgICAgIF9oaWRkZW46IGZhbHNlLA0KICAgICAgICBhdXRvUmVuZGVyOiB0cnVlLA0KICAgICAgICBjYW5TaWRlTGVmdDogdHJ1ZSwNCiAgICAgICAgY2FuU2lkZVVwOiB0cnVlLA0KICAgICAgICBpbml0UG9wdXA6IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgdGhpcy5pbml0VUlCYXNlKCk7DQogICAgICAgICAgICBhbGxQb3B1cHMucHVzaCggdGhpcyApOw0KICAgICAgICB9LA0KICAgICAgICBnZXRIdG1sVHBsOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIHJldHVybiAnPGRpdiBpZD0iIyMiIGNsYXNzPSJlZHVpLXBvcHVwICUlIiBvbm1vdXNlZG93bj0icmV0dXJuIGZhbHNlOyI+JyArDQogICAgICAgICAgICAgICAgJyA8ZGl2IGlkPSIjI19ib2R5IiBjbGFzcz0iZWR1aS1wb3B1cC1ib2R5Ij4nICsNCiAgICAgICAgICAgICAgICAnIDxpZnJhbWUgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO3otaW5kZXg6LTE7bGVmdDowO3RvcDowO2JhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50OyIgZnJhbWVib3JkZXI9IjAiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIHNyYz0iamF2YXNjcmlwdDoiPjwvaWZyYW1lPicgKw0KICAgICAgICAgICAgICAgICcgPGRpdiBjbGFzcz0iZWR1aS1zaGFkb3ciPjwvZGl2PicgKw0KICAgICAgICAgICAgICAgICcgPGRpdiBpZD0iIyNfY29udGVudCIgY2xhc3M9ImVkdWktcG9wdXAtY29udGVudCI+JyArDQogICAgICAgICAgICAgICAgdGhpcy5nZXRDb250ZW50SHRtbFRwbCgpICsNCiAgICAgICAgICAgICAgICAnICA8L2Rpdj4nICsNCiAgICAgICAgICAgICAgICAnIDwvZGl2PicgKw0KICAgICAgICAgICAgICAgICc8L2Rpdj4nOw0KICAgICAgICB9LA0KICAgICAgICBnZXRDb250ZW50SHRtbFRwbDogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICBpZih0aGlzLmNvbnRlbnQpew0KICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy5jb250ZW50ID09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnQ7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnQucmVuZGVySHRtbCgpOw0KICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgcmV0dXJuICcnDQogICAgICAgICAgICB9DQoNCiAgICAgICAgfSwNCiAgICAgICAgX1VJQmFzZV9wb3N0UmVuZGVyOiBVSUJhc2UucHJvdG90eXBlLnBvc3RSZW5kZXIsDQogICAgICAgIHBvc3RSZW5kZXI6IGZ1bmN0aW9uICgpew0KDQoNCiAgICAgICAgICAgIGlmICh0aGlzLmNvbnRlbnQgaW5zdGFuY2VvZiBVSUJhc2UpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmNvbnRlbnQucG9zdFJlbmRlcigpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvL+aNleiOt+m8oOagh+a7mui9rg0KICAgICAgICAgICAgaWYoIHRoaXMuY2FwdHVyZVdoZWVsICYmICF0aGlzLmNhcHR1cmVkICkgew0KDQogICAgICAgICAgICAgICAgdGhpcy5jYXB0dXJlZCA9IHRydWU7DQoNCiAgICAgICAgICAgICAgICB2YXIgd2luSGVpZ2h0ID0gKCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IHx8IGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0ICkgIC0gODAsDQogICAgICAgICAgICAgICAgICAgIF9oZWlnaHQgPSB0aGlzLmdldERvbSgpLm9mZnNldEhlaWdodCwNCiAgICAgICAgICAgICAgICAgICAgX3RvcCA9IGRvbVV0aWxzLmdldFhZKCB0aGlzLmNvbWJveC5nZXREb20oKSApLnksDQogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSB0aGlzLmdldERvbSgnY29udGVudCcpLA0KICAgICAgICAgICAgICAgICAgICBtZSA9IHRoaXM7DQoNCiAgICAgICAgICAgICAgICB3aGlsZSggX3RvcCArIF9oZWlnaHQgPiB3aW5IZWlnaHQgKSB7DQogICAgICAgICAgICAgICAgICAgIF9oZWlnaHQgLT0gMzA7DQogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuc3R5bGUuaGVpZ2h0ID0gX2hlaWdodCArICdweCc7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLy/pmLvmraLlnKhjb21ib3jkuIrnmoTpvKDmoIfmu5rova7kuovku7YsIOmYsuatoueUqOaIt+eahOato+W4uOaTjeS9nOiiq+ivr+inow0KICAgICAgICAgICAgICAgIGlmKCB3aW5kb3cuWE1MSHR0cFJlcXVlc3QgKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMub24oIGNvbnRlbnQsICggJ29ubW91c2V3aGVlbCcgaW4gZG9jdW1lbnQuYm9keSApID8gJ21vdXNld2hlZWwnIDonRE9NTW91c2VTY3JvbGwnICwgZnVuY3Rpb24oZSl7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGUucHJldmVudERlZmF1bHQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucmV0dXJuVmFsdWUgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoIGUud2hlZWxEZWx0YSApIHsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuc2Nyb2xsVG9wIC09ICggZS53aGVlbERlbHRhIC8gMTIwICkqNjA7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LnNjcm9sbFRvcCAtPSAoIGUuZGV0YWlsIC8gLTMgKSo2MDsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgICAgICAvL2llNg0KICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5vbiggdGhpcy5nZXREb20oKSwgJ21vdXNld2hlZWwnICwgZnVuY3Rpb24oZSl7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGUucmV0dXJuVmFsdWUgPSBmYWxzZTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuZ2V0RG9tKCdjb250ZW50Jykuc2Nyb2xsVG9wIC09ICggZS53aGVlbERlbHRhIC8gMTIwICkqNjA7DQoNCiAgICAgICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuZmlyZUV2ZW50KCdwb3N0UmVuZGVyQWZ0ZXInKTsNCiAgICAgICAgICAgIHRoaXMuaGlkZSh0cnVlKTsNCiAgICAgICAgICAgIHRoaXMuX1VJQmFzZV9wb3N0UmVuZGVyKCk7DQogICAgICAgIH0sDQogICAgICAgIF9kb0F1dG9SZW5kZXI6IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgaWYgKCF0aGlzLmdldERvbSgpICYmIHRoaXMuYXV0b1JlbmRlcikgew0KICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIG1lc3VyZVNpemU6IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgdmFyIGJveCA9IHRoaXMuZ2V0RG9tKCdjb250ZW50Jyk7DQogICAgICAgICAgICByZXR1cm4gdWlVdGlscy5nZXRDbGllbnRSZWN0KGJveCk7DQogICAgICAgIH0sDQogICAgICAgIGZpdFNpemU6IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgaWYoIHRoaXMuY2FwdHVyZVdoZWVsICYmIHRoaXMuc2l6ZWQgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX19zaXplOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5zaXplZCA9IHRydWU7DQogICAgICAgICAgICB2YXIgcG9wQm9keUVsID0gdGhpcy5nZXREb20oJ2JvZHknKTsNCiAgICAgICAgICAgIHBvcEJvZHlFbC5zdHlsZS53aWR0aCA9ICcnOw0KICAgICAgICAgICAgcG9wQm9keUVsLnN0eWxlLmhlaWdodCA9ICcnOw0KICAgICAgICAgICAgdmFyIHNpemUgPSB0aGlzLm1lc3VyZVNpemUoKTsNCiAgICAgICAgICAgIGlmKCB0aGlzLmNhcHR1cmVXaGVlbCApIHsNCiAgICAgICAgICAgICAgICBwb3BCb2R5RWwuc3R5bGUud2lkdGggPSAgLSgtMjAgLXNpemUud2lkdGgpICsgJ3B4JzsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcG9wQm9keUVsLnN0eWxlLndpZHRoID0gIHNpemUud2lkdGggKyAncHgnOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcG9wQm9keUVsLnN0eWxlLmhlaWdodCA9IHNpemUuaGVpZ2h0ICsgJ3B4JzsNCiAgICAgICAgICAgIHRoaXMuX19zaXplID0gc2l6ZTsNCiAgICAgICAgICAgIHRoaXMuY2FwdHVyZVdoZWVsICYmICh0aGlzLmdldERvbSgnY29udGVudCcpLnN0eWxlLm92ZXJmbG93ID0gJ2F1dG8nKTsNCiAgICAgICAgICAgIHJldHVybiBzaXplOw0KICAgICAgICB9LA0KICAgICAgICBzaG93QW5jaG9yOiBmdW5jdGlvbiAoIGVsZW1lbnQsIGhveiApew0KICAgICAgICAgICAgdGhpcy5zaG93QW5jaG9yUmVjdCggdWlVdGlscy5nZXRDbGllbnRSZWN0KCBlbGVtZW50ICksIGhveiApOw0KICAgICAgICB9LA0KICAgICAgICBzaG93QW5jaG9yUmVjdDogZnVuY3Rpb24gKCByZWN0LCBob3osIGFkaiApew0KICAgICAgICAgICAgdGhpcy5fZG9BdXRvUmVuZGVyKCk7DQogICAgICAgICAgICB2YXIgdnBSZWN0ID0gdWlVdGlscy5nZXRWaWV3cG9ydFJlY3QoKTsNCiAgICAgICAgICAgIHRoaXMuX3Nob3coKTsNCiAgICAgICAgICAgIHZhciBwb3BTaXplID0gdGhpcy5maXRTaXplKCk7DQoNCiAgICAgICAgICAgIHZhciBzaWRlTGVmdCwgc2lkZVVwLCBsZWZ0LCB0b3A7DQogICAgICAgICAgICBpZiAoaG96KSB7DQogICAgICAgICAgICAgICAgc2lkZUxlZnQgPSB0aGlzLmNhblNpZGVMZWZ0ICYmIChyZWN0LnJpZ2h0ICsgcG9wU2l6ZS53aWR0aCA+IHZwUmVjdC5yaWdodCAmJiByZWN0LmxlZnQgPiBwb3BTaXplLndpZHRoKTsNCiAgICAgICAgICAgICAgICBzaWRlVXAgPSB0aGlzLmNhblNpZGVVcCAmJiAocmVjdC50b3AgKyBwb3BTaXplLmhlaWdodCA+IHZwUmVjdC5ib3R0b20gJiYgcmVjdC5ib3R0b20gPiBwb3BTaXplLmhlaWdodCk7DQogICAgICAgICAgICAgICAgbGVmdCA9IChzaWRlTGVmdCA/IHJlY3QubGVmdCAtIHBvcFNpemUud2lkdGggOiByZWN0LnJpZ2h0KTsNCiAgICAgICAgICAgICAgICB0b3AgPSAoc2lkZVVwID8gcmVjdC5ib3R0b20gLSBwb3BTaXplLmhlaWdodCA6IHJlY3QudG9wKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgc2lkZUxlZnQgPSB0aGlzLmNhblNpZGVMZWZ0ICYmIChyZWN0LnJpZ2h0ICsgcG9wU2l6ZS53aWR0aCA+IHZwUmVjdC5yaWdodCAmJiByZWN0LmxlZnQgPiBwb3BTaXplLndpZHRoKTsNCiAgICAgICAgICAgICAgICBzaWRlVXAgPSB0aGlzLmNhblNpZGVVcCAmJiAocmVjdC50b3AgKyBwb3BTaXplLmhlaWdodCA+IHZwUmVjdC5ib3R0b20gJiYgcmVjdC5ib3R0b20gPiBwb3BTaXplLmhlaWdodCk7DQogICAgICAgICAgICAgICAgbGVmdCA9IChzaWRlTGVmdCA/IHJlY3QucmlnaHQgLSBwb3BTaXplLndpZHRoIDogcmVjdC5sZWZ0KTsNCiAgICAgICAgICAgICAgICB0b3AgPSAoc2lkZVVwID8gcmVjdC50b3AgLSBwb3BTaXplLmhlaWdodCA6IHJlY3QuYm90dG9tKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdmFyIHBvcEVsID0gdGhpcy5nZXREb20oKTsNCiAgICAgICAgICAgIHVpVXRpbHMuc2V0Vmlld3BvcnRPZmZzZXQocG9wRWwsIHsNCiAgICAgICAgICAgICAgICBsZWZ0OiBsZWZ0LA0KICAgICAgICAgICAgICAgIHRvcDogdG9wDQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZUNsYXNzZXMocG9wRWwsIEFOQ0hPUl9DTEFTU0VTKTsNCiAgICAgICAgICAgIHBvcEVsLmNsYXNzTmFtZSArPSAnICcgKyBBTkNIT1JfQ0xBU1NFU1soc2lkZVVwID8gMSA6IDApICogMiArIChzaWRlTGVmdCA/IDEgOiAwKV07DQogICAgICAgICAgICBpZih0aGlzLmVkaXRvcil7DQogICAgICAgICAgICAgICAgcG9wRWwuc3R5bGUuekluZGV4ID0gdGhpcy5lZGl0b3IuY29udGFpbmVyLnN0eWxlLnpJbmRleCAqIDEgKyAxMDsNCiAgICAgICAgICAgICAgICBiYWlkdS5lZGl0b3IudWkudWlVdGlscy5nZXRGaXhlZExheWVyKCkuc3R5bGUuekluZGV4ID0gcG9wRWwuc3R5bGUuekluZGV4IC0gMTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9LA0KICAgICAgICBzaG93QXQ6IGZ1bmN0aW9uIChvZmZzZXQpIHsNCiAgICAgICAgICAgIHZhciBsZWZ0ID0gb2Zmc2V0LmxlZnQ7DQogICAgICAgICAgICB2YXIgdG9wID0gb2Zmc2V0LnRvcDsNCiAgICAgICAgICAgIHZhciByZWN0ID0gew0KICAgICAgICAgICAgICAgIGxlZnQ6IGxlZnQsDQogICAgICAgICAgICAgICAgdG9wOiB0b3AsDQogICAgICAgICAgICAgICAgcmlnaHQ6IGxlZnQsDQogICAgICAgICAgICAgICAgYm90dG9tOiB0b3AsDQogICAgICAgICAgICAgICAgaGVpZ2h0OiAwLA0KICAgICAgICAgICAgICAgIHdpZHRoOiAwDQogICAgICAgICAgICB9Ow0KICAgICAgICAgICAgdGhpcy5zaG93QW5jaG9yUmVjdChyZWN0LCBmYWxzZSwgdHJ1ZSk7DQogICAgICAgIH0sDQogICAgICAgIF9zaG93OiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIGlmICh0aGlzLl9oaWRkZW4pIHsNCiAgICAgICAgICAgICAgICB2YXIgYm94ID0gdGhpcy5nZXREb20oKTsNCiAgICAgICAgICAgICAgICBib3guc3R5bGUuZGlzcGxheSA9ICcnOw0KICAgICAgICAgICAgICAgIHRoaXMuX2hpZGRlbiA9IGZhbHNlOw0KLy8gICAgICAgICAgICAgICAgaWYgKGJveC5zZXRBY3RpdmUpIHsNCi8vICAgICAgICAgICAgICAgICAgICBib3guc2V0QWN0aXZlKCk7DQovLyAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5maXJlRXZlbnQoJ3Nob3cnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgaXNIaWRkZW46IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2hpZGRlbjsNCiAgICAgICAgfSwNCiAgICAgICAgc2hvdzogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICB0aGlzLl9kb0F1dG9SZW5kZXIoKTsNCiAgICAgICAgICAgIHRoaXMuX3Nob3coKTsNCiAgICAgICAgfSwNCiAgICAgICAgaGlkZTogZnVuY3Rpb24gKG5vdE5vZml0eSl7DQogICAgICAgICAgICBpZiAoIXRoaXMuX2hpZGRlbiAmJiB0aGlzLmdldERvbSgpKSB7DQogICAgICAgICAgICAgICAgdGhpcy5nZXREb20oKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICAgIHRoaXMuX2hpZGRlbiA9IHRydWU7DQogICAgICAgICAgICAgICAgaWYgKCFub3ROb2ZpdHkpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5maXJlRXZlbnQoJ2hpZGUnKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIHF1ZXJ5QXV0b0hpZGU6IGZ1bmN0aW9uIChlbCl7DQogICAgICAgICAgICByZXR1cm4gIWVsIHx8ICF1aVV0aWxzLmNvbnRhaW5zKHRoaXMuZ2V0RG9tKCksIGVsKTsNCiAgICAgICAgfQ0KICAgIH07DQogICAgdXRpbHMuaW5oZXJpdHMoUG9wdXAsIFVJQmFzZSk7DQogICAgDQogICAgZG9tVXRpbHMub24oIGRvY3VtZW50LCAnbW91c2Vkb3duJywgZnVuY3Rpb24gKCBldnQgKSB7DQogICAgICAgIHZhciBlbCA9IGV2dC50YXJnZXQgfHwgZXZ0LnNyY0VsZW1lbnQ7DQogICAgICAgIGNsb3NlQWxsUG9wdXAoIGV2dCxlbCApOw0KICAgIH0gKTsNCiAgICBkb21VdGlscy5vbiggd2luZG93LCAnc2Nyb2xsJywgZnVuY3Rpb24gKGV2dCxlbCkgew0KICAgICAgICBjbG9zZUFsbFBvcHVwKCBldnQsZWwgKTsNCiAgICB9ICk7DQoNCn0pKCk7DQoKLy8vaW1wb3J0IGNvcmUNCi8vL2ltcG9ydCB1aWNvcmUNCihmdW5jdGlvbiAoKXsNCiAgICB2YXIgdXRpbHMgPSBiYWlkdS5lZGl0b3IudXRpbHMsDQogICAgICAgIFVJQmFzZSA9IGJhaWR1LmVkaXRvci51aS5VSUJhc2UsDQogICAgICAgIENvbG9yUGlja2VyID0gYmFpZHUuZWRpdG9yLnVpLkNvbG9yUGlja2VyID0gZnVuY3Rpb24gKG9wdGlvbnMpew0KICAgICAgICAgICAgdGhpcy5pbml0T3B0aW9ucyhvcHRpb25zKTsNCiAgICAgICAgICAgIHRoaXMubm9Db2xvclRleHQgPSB0aGlzLm5vQ29sb3JUZXh0IHx8IHRoaXMuZWRpdG9yLmdldExhbmcoImNsZWFyQ29sb3IiKTsNCiAgICAgICAgICAgIHRoaXMuaW5pdFVJQmFzZSgpOw0KICAgICAgICB9Ow0KDQogICAgQ29sb3JQaWNrZXIucHJvdG90eXBlID0gew0KICAgICAgICBnZXRIdG1sVHBsOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIHJldHVybiBnZW5Db2xvclBpY2tlcih0aGlzLm5vQ29sb3JUZXh0LHRoaXMuZWRpdG9yKTsNCiAgICAgICAgfSwNCiAgICAgICAgX29uVGFibGVDbGljazogZnVuY3Rpb24gKGV2dCl7DQogICAgICAgICAgICB2YXIgdGd0ID0gZXZ0LnRhcmdldCB8fCBldnQuc3JjRWxlbWVudDsNCiAgICAgICAgICAgIHZhciBjb2xvciA9IHRndC5nZXRBdHRyaWJ1dGUoJ2RhdGEtY29sb3InKTsNCiAgICAgICAgICAgIGlmIChjb2xvcikgew0KICAgICAgICAgICAgICAgIHRoaXMuZmlyZUV2ZW50KCdwaWNrY29sb3InLCBjb2xvcik7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIF9vblRhYmxlT3ZlcjogZnVuY3Rpb24gKGV2dCl7DQogICAgICAgICAgICB2YXIgdGd0ID0gZXZ0LnRhcmdldCB8fCBldnQuc3JjRWxlbWVudDsNCiAgICAgICAgICAgIHZhciBjb2xvciA9IHRndC5nZXRBdHRyaWJ1dGUoJ2RhdGEtY29sb3InKTsNCiAgICAgICAgICAgIGlmIChjb2xvcikgew0KICAgICAgICAgICAgICAgIHRoaXMuZ2V0RG9tKCdwcmV2aWV3Jykuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gY29sb3I7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIF9vblRhYmxlT3V0OiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIHRoaXMuZ2V0RG9tKCdwcmV2aWV3Jykuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyc7DQogICAgICAgIH0sDQogICAgICAgIF9vblBpY2tOb0NvbG9yOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIHRoaXMuZmlyZUV2ZW50KCdwaWNrbm9jb2xvcicpOw0KICAgICAgICB9DQogICAgfTsNCiAgICB1dGlscy5pbmhlcml0cyhDb2xvclBpY2tlciwgVUlCYXNlKTsNCg0KICAgIHZhciBDT0xPUlMgPSAoDQogICAgICAgICdmZmZmZmYsMDAwMDAwLGVlZWNlMSwxZjQ5N2QsNGY4MWJkLGMwNTA0ZCw5YmJiNTksODA2NGEyLDRiYWNjNixmNzk2NDYsJyArDQogICAgICAgICAgICAnZjJmMmYyLDdmN2Y3ZixkZGQ5YzMsYzZkOWYwLGRiZTVmMSxmMmRjZGIsZWJmMWRkLGU1ZTBlYyxkYmVlZjMsZmRlYWRhLCcgKw0KICAgICAgICAgICAgJ2Q4ZDhkOCw1OTU5NTksYzRiZDk3LDhkYjNlMixiOGNjZTQsZTViOWI3LGQ3ZTNiYyxjY2MxZDksYjdkZGU4LGZiZDViNSwnICsNCiAgICAgICAgICAgICdiZmJmYmYsM2YzZjNmLDkzODk1Myw1NDhkZDQsOTViM2Q3LGQ5OTY5NCxjM2Q2OWIsYjJhMmM3LDkyY2RkYyxmYWMwOGYsJyArDQogICAgICAgICAgICAnYTVhNWE1LDI2MjYyNiw0OTQ0MjksMTczNjVkLDM2NjA5Miw5NTM3MzQsNzY5MjNjLDVmNDk3YSwzMTg1OWIsZTM2YzA5LCcgKw0KICAgICAgICAgICAgJzdmN2Y3ZiwwYzBjMGMsMWQxYjEwLDBmMjQzZSwyNDQwNjEsNjMyNDIzLDRmNjEyOCwzZjMxNTEsMjA1ODY3LDk3NDgwNiwnICsNCiAgICAgICAgICAgICdjMDAwMDAsZmYwMDAwLGZmYzAwMCxmZmZmMDAsOTJkMDUwLDAwYjA1MCwwMGIwZjAsMDA3MGMwLDAwMjA2MCw3MDMwYTAsJykuc3BsaXQoJywnKTsNCg0KICAgIGZ1bmN0aW9uIGdlbkNvbG9yUGlja2VyKG5vQ29sb3JUZXh0LGVkaXRvcil7DQogICAgICAgIHZhciBodG1sID0gJzxkaXYgaWQ9IiMjIiBjbGFzcz0iZWR1aS1jb2xvcnBpY2tlciAlJSI+JyArDQogICAgICAgICAgICAnPGRpdiBjbGFzcz0iZWR1aS1jb2xvcnBpY2tlci10b3BiYXIgZWR1aS1jbGVhcmZpeCI+JyArDQogICAgICAgICAgICAnPGRpdiB1bnNlbGVjdGFibGU9Im9uIiBpZD0iIyNfcHJldmlldyIgY2xhc3M9ImVkdWktY29sb3JwaWNrZXItcHJldmlldyI+PC9kaXY+JyArDQogICAgICAgICAgICAnPGRpdiB1bnNlbGVjdGFibGU9Im9uIiBjbGFzcz0iZWR1aS1jb2xvcnBpY2tlci1ub2NvbG9yIiBvbmNsaWNrPSIkJC5fb25QaWNrTm9Db2xvcihldmVudCwgdGhpcyk7Ij4nKyBub0NvbG9yVGV4dCArJzwvZGl2PicgKw0KICAgICAgICAgICAgJzwvZGl2PicgKw0KICAgICAgICAgICAgJzx0YWJsZSAgY2xhc3M9ImVkdWktYm94IiBzdHlsZT0iYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsiIG9ubW91c2VvdmVyPSIkJC5fb25UYWJsZU92ZXIoZXZlbnQsIHRoaXMpOyIgb25tb3VzZW91dD0iJCQuX29uVGFibGVPdXQoZXZlbnQsIHRoaXMpOyIgb25jbGljaz0icmV0dXJuICQkLl9vblRhYmxlQ2xpY2soZXZlbnQsIHRoaXMpOyIgY2VsbHNwYWNpbmc9IjAiIGNlbGxwYWRkaW5nPSIwIj4nICsNCiAgICAgICAgICAgICc8dHIgc3R5bGU9ImJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZGRkO2ZvbnQtc2l6ZTogMTNweDtsaW5lLWhlaWdodDogMjVweDtjb2xvcjojMzlDO3BhZGRpbmctdG9wOiAycHgiPjx0ZCBjb2xzcGFuPSIxMCI+JytlZGl0b3IuZ2V0TGFuZygidGhlbWVDb2xvciIpKyc8L3RkPiA8L3RyPicrDQogICAgICAgICAgICAnPHRyIGNsYXNzPSJlZHVpLWNvbG9ycGlja2VyLXRhYmxlZmlyc3Ryb3ciID4nOw0KICAgICAgICBmb3IgKHZhciBpPTA7IGk8Q09MT1JTLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICBpZiAoaSAmJiBpJTEwID09PSAwKSB7DQogICAgICAgICAgICAgICAgaHRtbCArPSAnPC90cj4nKyhpPT02MD8nPHRyIHN0eWxlPSJib3JkZXItYm90dG9tOiAxcHggc29saWQgI2RkZDtmb250LXNpemU6IDEzcHg7bGluZS1oZWlnaHQ6IDI1cHg7Y29sb3I6IzM5QzsiPjx0ZCBjb2xzcGFuPSIxMCI+JytlZGl0b3IuZ2V0TGFuZygic3RhbmRhcmRDb2xvciIpKyc8L3RkPjwvdHI+JzonJykrJzx0cicrKGk9PTYwPycgY2xhc3M9ImVkdWktY29sb3JwaWNrZXItdGFibGVmaXJzdHJvdyInOicnKSsnPic7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBodG1sICs9IGk8NzAgPyAnPHRkIHN0eWxlPSJwYWRkaW5nOiAwIDJweDsiPjxhIGhpZGVmb2N1cyB0aXRsZT0iJytDT0xPUlNbaV0rJyIgb25jbGljaz0icmV0dXJuIGZhbHNlOyIgaHJlZj0iamF2YXNjcmlwdDoiIHVuc2VsZWN0YWJsZT0ib24iIGNsYXNzPSJlZHVpLWJveCBlZHVpLWNvbG9ycGlja2VyLWNvbG9yY2VsbCInICsNCiAgICAgICAgICAgICAgICAnIGRhdGEtY29sb3I9IiMnKyBDT0xPUlNbaV0gKyciJysNCiAgICAgICAgICAgICAgICAnIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiMnKyBDT0xPUlNbaV0gKyc7Ym9yZGVyOnNvbGlkICNjY2M7JysNCiAgICAgICAgICAgICAgICAoaTwxMCB8fCBpPj02MD8nYm9yZGVyLXdpZHRoOjFweDsnOg0KICAgICAgICAgICAgICAgICAgICBpPj0xMCYmaTwyMD8nYm9yZGVyLXdpZHRoOjFweCAxcHggMCAxcHg7JzoNCg0KICAgICAgICAgICAgICAgICAgICAgICAgJ2JvcmRlci13aWR0aDowIDFweCAwIDFweDsnKSsNCiAgICAgICAgICAgICAgICAnIicgKw0KICAgICAgICAgICAgICAgICc+PC9hPjwvdGQ+JzonJzsNCiAgICAgICAgfQ0KICAgICAgICBodG1sICs9ICc8L3RyPjwvdGFibGU+PC9kaXY+JzsNCiAgICAgICAgcmV0dXJuIGh0bWw7DQogICAgfQ0KfSkoKTsNCgovLy9pbXBvcnQgY29yZQ0KLy8vaW1wb3J0IHVpY29yZQ0KKGZ1bmN0aW9uICgpew0KICAgIHZhciB1dGlscyA9IGJhaWR1LmVkaXRvci51dGlscywNCiAgICAgICAgdWlVdGlscyA9IGJhaWR1LmVkaXRvci51aS51aVV0aWxzLA0KICAgICAgICBVSUJhc2UgPSBiYWlkdS5lZGl0b3IudWkuVUlCYXNlOw0KICAgIA0KICAgIHZhciBUYWJsZVBpY2tlciA9IGJhaWR1LmVkaXRvci51aS5UYWJsZVBpY2tlciA9IGZ1bmN0aW9uIChvcHRpb25zKXsNCiAgICAgICAgdGhpcy5pbml0T3B0aW9ucyhvcHRpb25zKTsNCiAgICAgICAgdGhpcy5pbml0VGFibGVQaWNrZXIoKTsNCiAgICB9Ow0KICAgIFRhYmxlUGlja2VyLnByb3RvdHlwZSA9IHsNCiAgICAgICAgZGVmYXVsdE51bVJvd3M6IDEwLA0KICAgICAgICBkZWZhdWx0TnVtQ29sczogMTAsDQogICAgICAgIG1heE51bVJvd3M6IDIwLA0KICAgICAgICBtYXhOdW1Db2xzOiAyMCwNCiAgICAgICAgbnVtUm93czogMTAsDQogICAgICAgIG51bUNvbHM6IDEwLA0KICAgICAgICBsZW5ndGhPZkNlbGxTaWRlOiAyMiwNCiAgICAgICAgaW5pdFRhYmxlUGlja2VyOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIHRoaXMuaW5pdFVJQmFzZSgpOw0KICAgICAgICB9LA0KICAgICAgICBnZXRIdG1sVHBsOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7DQogICAgICAgICAgICByZXR1cm4gJzxkaXYgaWQ9IiMjIiBjbGFzcz0iZWR1aS10YWJsZXBpY2tlciAlJSI+JyArDQogICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJlZHVpLXRhYmxlcGlja2VyLWJvZHkiPicgKw0KICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImVkdWktaW5mb2FyZWEiPicgKw0KICAgICAgICAgICAgICAgICAgICc8c3BhbiBpZD0iIyNfbGFiZWwiIGNsYXNzPSJlZHVpLWxhYmVsIj48L3NwYW4+JyArDQogICAgICAgICAgICAgICAgICAnPC9kaXY+JyArDQogICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0iZWR1aS1waWNrYXJlYSInICsNCiAgICAgICAgICAgICAgICAgICAnIG9ubW91c2Vtb3ZlPSIkJC5fb25Nb3VzZU1vdmUoZXZlbnQsIHRoaXMpOyInICsNCiAgICAgICAgICAgICAgICAgICAnIG9ubW91c2VvdmVyPSIkJC5fb25Nb3VzZU92ZXIoZXZlbnQsIHRoaXMpOyInICsNCiAgICAgICAgICAgICAgICAgICAnIG9ubW91c2VvdXQ9IiQkLl9vbk1vdXNlT3V0KGV2ZW50LCB0aGlzKTsiJyArDQogICAgICAgICAgICAgICAgICAgJyBvbmNsaWNrPSIkJC5fb25DbGljayhldmVudCwgdGhpcyk7IicgKw0KICAgICAgICAgICAgICAgICAgJz4nICsNCiAgICAgICAgICAgICAgICAgICAgJzxkaXYgaWQ9IiMjX292ZXJsYXkiIGNsYXNzPSJlZHVpLW92ZXJsYXkiPjwvZGl2PicgKw0KICAgICAgICAgICAgICAgICAgJzwvZGl2PicgKw0KICAgICAgICAgICAgICAgICAnPC9kaXY+JyArDQogICAgICAgICAgICAgICAgJzwvZGl2Pic7DQogICAgICAgIH0sDQogICAgICAgIF9VSUJhc2VfcmVuZGVyOiBVSUJhc2UucHJvdG90eXBlLnJlbmRlciwNCiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoaG9sZGVyKXsNCiAgICAgICAgICAgIHRoaXMuX1VJQmFzZV9yZW5kZXIoaG9sZGVyKTsNCiAgICAgICAgICAgIHRoaXMuZ2V0RG9tKCdsYWJlbCcpLmlubmVySFRNTCA9ICcwJyt0aGlzLmVkaXRvci5nZXRMYW5nKCJ0X3JvdyIpKycgeCAwJyt0aGlzLmVkaXRvci5nZXRMYW5nKCJ0X2NvbCIpOw0KICAgICAgICB9LA0KICAgICAgICBfdHJhY2s6IGZ1bmN0aW9uIChudW1Db2xzLCBudW1Sb3dzKXsNCiAgICAgICAgICAgIHZhciBzdHlsZSA9IHRoaXMuZ2V0RG9tKCdvdmVybGF5Jykuc3R5bGU7DQogICAgICAgICAgICB2YXIgc2lkZUxlbiA9IHRoaXMubGVuZ3RoT2ZDZWxsU2lkZTsNCiAgICAgICAgICAgIHN0eWxlLndpZHRoID0gbnVtQ29scyAqIHNpZGVMZW4gKyAncHgnOw0KICAgICAgICAgICAgc3R5bGUuaGVpZ2h0ID0gbnVtUm93cyAqIHNpZGVMZW4gKyAncHgnOw0KICAgICAgICAgICAgdmFyIGxhYmVsID0gdGhpcy5nZXREb20oJ2xhYmVsJyk7DQogICAgICAgICAgICBsYWJlbC5pbm5lckhUTUwgPSBudW1Db2xzICt0aGlzLmVkaXRvci5nZXRMYW5nKCJ0X2NvbCIpKycgeCAnICsgbnVtUm93cyArIHRoaXMuZWRpdG9yLmdldExhbmcoInRfcm93Iik7DQogICAgICAgICAgICB0aGlzLm51bUNvbHMgPSBudW1Db2xzOw0KICAgICAgICAgICAgdGhpcy5udW1Sb3dzID0gbnVtUm93czsNCiAgICAgICAgfSwNCiAgICAgICAgX29uTW91c2VPdmVyOiBmdW5jdGlvbiAoZXZ0LCBlbCl7DQogICAgICAgICAgICB2YXIgcmVsID0gZXZ0LnJlbGF0ZWRUYXJnZXQgfHwgZXZ0LmZyb21FbGVtZW50Ow0KICAgICAgICAgICAgaWYgKCF1aVV0aWxzLmNvbnRhaW5zKGVsLCByZWwpICYmIGVsICE9PSByZWwpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmdldERvbSgnbGFiZWwnKS5pbm5lckhUTUwgPSAnMCcrdGhpcy5lZGl0b3IuZ2V0TGFuZygidF9jb2wiKSsnIHggMCcrdGhpcy5lZGl0b3IuZ2V0TGFuZygidF9yb3ciKTsNCiAgICAgICAgICAgICAgICB0aGlzLmdldERvbSgnb3ZlcmxheScpLnN0eWxlLnZpc2liaWxpdHkgPSAnJzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgX29uTW91c2VPdXQ6IGZ1bmN0aW9uIChldnQsIGVsKXsNCiAgICAgICAgICAgIHZhciByZWwgPSBldnQucmVsYXRlZFRhcmdldCB8fCBldnQudG9FbGVtZW50Ow0KICAgICAgICAgICAgaWYgKCF1aVV0aWxzLmNvbnRhaW5zKGVsLCByZWwpICYmIGVsICE9PSByZWwpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmdldERvbSgnbGFiZWwnKS5pbm5lckhUTUwgPSAnMCcrdGhpcy5lZGl0b3IuZ2V0TGFuZygidF9jb2wiKSsnIHggMCcrdGhpcy5lZGl0b3IuZ2V0TGFuZygidF9yb3ciKTsNCiAgICAgICAgICAgICAgICB0aGlzLmdldERvbSgnb3ZlcmxheScpLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgX29uTW91c2VNb3ZlOiBmdW5jdGlvbiAoZXZ0LCBlbCl7DQogICAgICAgICAgICB2YXIgc3R5bGUgPSB0aGlzLmdldERvbSgnb3ZlcmxheScpLnN0eWxlOw0KICAgICAgICAgICAgdmFyIG9mZnNldCA9IHVpVXRpbHMuZ2V0RXZlbnRPZmZzZXQoZXZ0KTsNCiAgICAgICAgICAgIHZhciBzaWRlTGVuID0gdGhpcy5sZW5ndGhPZkNlbGxTaWRlOw0KICAgICAgICAgICAgdmFyIG51bUNvbHMgPSBNYXRoLmNlaWwob2Zmc2V0LmxlZnQgLyBzaWRlTGVuKTsNCiAgICAgICAgICAgIHZhciBudW1Sb3dzID0gTWF0aC5jZWlsKG9mZnNldC50b3AgLyBzaWRlTGVuKTsNCiAgICAgICAgICAgIHRoaXMuX3RyYWNrKG51bUNvbHMsIG51bVJvd3MpOw0KICAgICAgICB9LA0KICAgICAgICBfb25DbGljazogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICB0aGlzLmZpcmVFdmVudCgncGlja3RhYmxlJywgdGhpcy5udW1Db2xzLCB0aGlzLm51bVJvd3MpOw0KICAgICAgICB9DQogICAgfTsNCiAgICB1dGlscy5pbmhlcml0cyhUYWJsZVBpY2tlciwgVUlCYXNlKTsNCn0pKCk7DQoKKGZ1bmN0aW9uICgpew0KICAgIHZhciBicm93c2VyID0gYmFpZHUuZWRpdG9yLmJyb3dzZXIsDQogICAgICAgIGRvbVV0aWxzID0gYmFpZHUuZWRpdG9yLmRvbS5kb21VdGlscywNCiAgICAgICAgdWlVdGlscyA9IGJhaWR1LmVkaXRvci51aS51aVV0aWxzOw0KICAgIA0KICAgIHZhciBUUExfU1RBVEVGVUwgPSAnb25tb3VzZWRvd249IiQkLlN0YXRlZnVsX29uTW91c2VEb3duKGV2ZW50LCB0aGlzKTsiJyArDQogICAgICAgICcgb25tb3VzZXVwPSIkJC5TdGF0ZWZ1bF9vbk1vdXNlVXAoZXZlbnQsIHRoaXMpOyInICsNCiAgICAgICAgKCBicm93c2VyLmllID8gKA0KICAgICAgICAnIG9ubW91c2VlbnRlcj0iJCQuU3RhdGVmdWxfb25Nb3VzZUVudGVyKGV2ZW50LCB0aGlzKTsiJyArDQogICAgICAgICcgb25tb3VzZWxlYXZlPSIkJC5TdGF0ZWZ1bF9vbk1vdXNlTGVhdmUoZXZlbnQsIHRoaXMpOyInICkNCiAgICAgICAgOiAoDQogICAgICAgICcgb25tb3VzZW92ZXI9IiQkLlN0YXRlZnVsX29uTW91c2VPdmVyKGV2ZW50LCB0aGlzKTsiJyArDQogICAgICAgICcgb25tb3VzZW91dD0iJCQuU3RhdGVmdWxfb25Nb3VzZU91dChldmVudCwgdGhpcyk7IicgKSk7DQogICAgDQogICAgYmFpZHUuZWRpdG9yLnVpLlN0YXRlZnVsID0gew0KICAgICAgICBhbHdhbHlzSG92ZXJhYmxlOiBmYWxzZSwNCiAgICAgICAgdGFyZ2V0Om51bGwsLy/nm67moIflhYPntKDlkox0aGlz5oyH5ZCRZG9t5LiN5LiA5qC3DQogICAgICAgIFN0YXRlZnVsX2luaXQ6IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgdGhpcy5fU3RhdGVmdWxfZEdldEh0bWxUcGwgPSB0aGlzLmdldEh0bWxUcGw7DQogICAgICAgICAgICB0aGlzLmdldEh0bWxUcGwgPSB0aGlzLlN0YXRlZnVsX2dldEh0bWxUcGw7DQogICAgICAgIH0sDQogICAgICAgIFN0YXRlZnVsX2dldEh0bWxUcGw6IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgdmFyIHRwbCA9IHRoaXMuX1N0YXRlZnVsX2RHZXRIdG1sVHBsKCk7DQogICAgICAgICAgICAvLyDkvb/nlKhmdW5jdGlvbumBv+WFjSTovazkuYkNCiAgICAgICAgICAgIHJldHVybiB0cGwucmVwbGFjZSgvc3RhdGVmdWwvZywgZnVuY3Rpb24gKCl7IHJldHVybiBUUExfU1RBVEVGVUw7IH0pOw0KICAgICAgICB9LA0KICAgICAgICBTdGF0ZWZ1bF9vbk1vdXNlRW50ZXI6IGZ1bmN0aW9uIChldnQsIGVsKXsNCiAgICAgICAgICAgIHRoaXMudGFyZ2V0PWVsOw0KICAgICAgICAgICAgaWYgKCF0aGlzLmlzRGlzYWJsZWQoKSB8fCB0aGlzLmFsd2FseXNIb3ZlcmFibGUpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmFkZFN0YXRlKCdob3ZlcicpOw0KICAgICAgICAgICAgICAgIHRoaXMuZmlyZUV2ZW50KCdvdmVyJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIFN0YXRlZnVsX29uTW91c2VMZWF2ZTogZnVuY3Rpb24gKGV2dCwgZWwpew0KICAgICAgICAgICAgaWYgKCF0aGlzLmlzRGlzYWJsZWQoKSB8fCB0aGlzLmFsd2FseXNIb3ZlcmFibGUpIHsNCiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVN0YXRlKCdob3ZlcicpOw0KICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlU3RhdGUoJ2FjdGl2ZScpOw0KICAgICAgICAgICAgICAgIHRoaXMuZmlyZUV2ZW50KCdvdXQnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgU3RhdGVmdWxfb25Nb3VzZU92ZXI6IGZ1bmN0aW9uIChldnQsIGVsKXsNCiAgICAgICAgICAgIHZhciByZWwgPSBldnQucmVsYXRlZFRhcmdldDsNCiAgICAgICAgICAgIGlmICghdWlVdGlscy5jb250YWlucyhlbCwgcmVsKSAmJiBlbCAhPT0gcmVsKSB7DQogICAgICAgICAgICAgICAgdGhpcy5TdGF0ZWZ1bF9vbk1vdXNlRW50ZXIoZXZ0LCBlbCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIFN0YXRlZnVsX29uTW91c2VPdXQ6IGZ1bmN0aW9uIChldnQsIGVsKXsNCiAgICAgICAgICAgIHZhciByZWwgPSBldnQucmVsYXRlZFRhcmdldDsNCiAgICAgICAgICAgIGlmICghdWlVdGlscy5jb250YWlucyhlbCwgcmVsKSAmJiBlbCAhPT0gcmVsKSB7DQogICAgICAgICAgICAgICAgdGhpcy5TdGF0ZWZ1bF9vbk1vdXNlTGVhdmUoZXZ0LCBlbCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIFN0YXRlZnVsX29uTW91c2VEb3duOiBmdW5jdGlvbiAoZXZ0LCBlbCl7DQogICAgICAgICAgICBpZiAoIXRoaXMuaXNEaXNhYmxlZCgpKSB7DQogICAgICAgICAgICAgICAgdGhpcy5hZGRTdGF0ZSgnYWN0aXZlJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIFN0YXRlZnVsX29uTW91c2VVcDogZnVuY3Rpb24gKGV2dCwgZWwpew0KICAgICAgICAgICAgaWYgKCF0aGlzLmlzRGlzYWJsZWQoKSkgew0KICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlU3RhdGUoJ2FjdGl2ZScpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBTdGF0ZWZ1bF9wb3N0UmVuZGVyOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIGlmICh0aGlzLmRpc2FibGVkICYmICF0aGlzLmhhc1N0YXRlKCdkaXNhYmxlZCcpKSB7DQogICAgICAgICAgICAgICAgdGhpcy5hZGRTdGF0ZSgnZGlzYWJsZWQnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgaGFzU3RhdGU6IGZ1bmN0aW9uIChzdGF0ZSl7DQogICAgICAgICAgICByZXR1cm4gZG9tVXRpbHMuaGFzQ2xhc3ModGhpcy5nZXRTdGF0ZURvbSgpLCAnZWR1aS1zdGF0ZS0nICsgc3RhdGUpOw0KICAgICAgICB9LA0KICAgICAgICBhZGRTdGF0ZTogZnVuY3Rpb24gKHN0YXRlKXsNCiAgICAgICAgICAgIGlmICghdGhpcy5oYXNTdGF0ZShzdGF0ZSkpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmdldFN0YXRlRG9tKCkuY2xhc3NOYW1lICs9ICcgZWR1aS1zdGF0ZS0nICsgc3RhdGU7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIHJlbW92ZVN0YXRlOiBmdW5jdGlvbiAoc3RhdGUpew0KICAgICAgICAgICAgaWYgKHRoaXMuaGFzU3RhdGUoc3RhdGUpKSB7DQogICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlQ2xhc3Nlcyh0aGlzLmdldFN0YXRlRG9tKCksIFsnZWR1aS1zdGF0ZS0nICsgc3RhdGVdKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgZ2V0U3RhdGVEb206IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RG9tKCdzdGF0ZScpOw0KICAgICAgICB9LA0KICAgICAgICBpc0NoZWNrZWQ6IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFzU3RhdGUoJ2NoZWNrZWQnKTsNCiAgICAgICAgfSwNCiAgICAgICAgc2V0Q2hlY2tlZDogZnVuY3Rpb24gKGNoZWNrZWQpew0KICAgICAgICAgICAgaWYgKCF0aGlzLmlzRGlzYWJsZWQoKSAmJiBjaGVja2VkKSB7DQogICAgICAgICAgICAgICAgdGhpcy5hZGRTdGF0ZSgnY2hlY2tlZCcpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVN0YXRlKCdjaGVja2VkJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGlzRGlzYWJsZWQ6IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFzU3RhdGUoJ2Rpc2FibGVkJyk7DQogICAgICAgIH0sDQogICAgICAgIHNldERpc2FibGVkOiBmdW5jdGlvbiAoZGlzYWJsZWQpew0KICAgICAgICAgICAgaWYgKGRpc2FibGVkKSB7DQogICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTdGF0ZSgnaG92ZXInKTsNCiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVN0YXRlKCdjaGVja2VkJyk7DQogICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTdGF0ZSgnYWN0aXZlJyk7DQogICAgICAgICAgICAgICAgdGhpcy5hZGRTdGF0ZSgnZGlzYWJsZWQnKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTdGF0ZSgnZGlzYWJsZWQnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH07DQp9KSgpOw0KCi8vL2ltcG9ydCBjb3JlDQovLy9pbXBvcnQgdWljb3JlDQovLy9pbXBvcnQgdWkvc3RhdGVmdWwuanMNCihmdW5jdGlvbiAoKXsNCiAgICB2YXIgdXRpbHMgPSBiYWlkdS5lZGl0b3IudXRpbHMsDQogICAgICAgIFVJQmFzZSA9IGJhaWR1LmVkaXRvci51aS5VSUJhc2UsDQogICAgICAgIFN0YXRlZnVsID0gYmFpZHUuZWRpdG9yLnVpLlN0YXRlZnVsLA0KICAgICAgICBCdXR0b24gPSBiYWlkdS5lZGl0b3IudWkuQnV0dG9uID0gZnVuY3Rpb24gKG9wdGlvbnMpew0KICAgICAgICAgICAgdGhpcy5pbml0T3B0aW9ucyhvcHRpb25zKTsNCiAgICAgICAgICAgIHRoaXMuaW5pdEJ1dHRvbigpOw0KICAgICAgICB9Ow0KICAgIEJ1dHRvbi5wcm90b3R5cGUgPSB7DQogICAgICAgIHVpTmFtZTogJ2J1dHRvbicsDQogICAgICAgIGxhYmVsOiAnJywNCiAgICAgICAgdGl0bGU6ICcnLA0KICAgICAgICBzaG93SWNvbjogdHJ1ZSwNCiAgICAgICAgc2hvd1RleHQ6IHRydWUsDQogICAgICAgIGluaXRCdXR0b246IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgdGhpcy5pbml0VUlCYXNlKCk7DQogICAgICAgICAgICB0aGlzLlN0YXRlZnVsX2luaXQoKTsNCiAgICAgICAgfSwNCiAgICAgICAgZ2V0SHRtbFRwbDogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICByZXR1cm4gJzxkaXYgaWQ9IiMjIiBjbGFzcz0iZWR1aS1ib3ggJSUiPicgKw0KICAgICAgICAgICAgICAgICc8ZGl2IGlkPSIjI19zdGF0ZSIgc3RhdGVmdWw+JyArDQogICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSIlJS13cmFwIj48ZGl2IGlkPSIjI19ib2R5IiB1bnNlbGVjdGFibGU9Im9uIiAnICsgKHRoaXMudGl0bGUgPyAndGl0bGU9IicgKyB0aGlzLnRpdGxlICsgJyInIDogJycpICsNCiAgICAgICAgICAgICAgICAgJyBjbGFzcz0iJSUtYm9keSIgb25tb3VzZWRvd249InJldHVybiBmYWxzZTsiIG9uY2xpY2s9InJldHVybiAkJC5fb25DbGljaygpOyI+JyArDQogICAgICAgICAgICAgICAgICAodGhpcy5zaG93SWNvbiA/ICc8ZGl2IGNsYXNzPSJlZHVpLWJveCBlZHVpLWljb24iPjwvZGl2PicgOiAnJykgKw0KICAgICAgICAgICAgICAgICAgKHRoaXMuc2hvd1RleHQgPyAnPGRpdiBjbGFzcz0iZWR1aS1ib3ggZWR1aS1sYWJlbCI+JyArIHRoaXMubGFiZWwgKyAnPC9kaXY+JyA6ICcnKSArDQogICAgICAgICAgICAgICAgICc8L2Rpdj4nICsNCiAgICAgICAgICAgICAgICAnPC9kaXY+JyArDQogICAgICAgICAgICAgICAgJzwvZGl2PjwvZGl2Pic7DQogICAgICAgIH0sDQogICAgICAgIHBvc3RSZW5kZXI6IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgdGhpcy5TdGF0ZWZ1bF9wb3N0UmVuZGVyKCk7DQogICAgICAgICAgICB0aGlzLnNldERpc2FibGVkKHRoaXMuZGlzYWJsZWQpDQogICAgICAgIH0sDQogICAgICAgIF9vbkNsaWNrOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIGlmICghdGhpcy5pc0Rpc2FibGVkKCkpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmZpcmVFdmVudCgnY2xpY2snKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH07DQogICAgdXRpbHMuaW5oZXJpdHMoQnV0dG9uLCBVSUJhc2UpOw0KICAgIHV0aWxzLmV4dGVuZChCdXR0b24ucHJvdG90eXBlLCBTdGF0ZWZ1bCk7DQoNCn0pKCk7DQoKLy8vaW1wb3J0IGNvcmUNCi8vL2ltcG9ydCB1aWNvcmUNCi8vL2ltcG9ydCB1aS9zdGF0ZWZ1bC5qcw0KKGZ1bmN0aW9uICgpew0KICAgIHZhciB1dGlscyA9IGJhaWR1LmVkaXRvci51dGlscywNCiAgICAgICAgdWlVdGlscyA9IGJhaWR1LmVkaXRvci51aS51aVV0aWxzLA0KICAgICAgICBkb21VdGlscyA9IGJhaWR1LmVkaXRvci5kb20uZG9tVXRpbHMsDQogICAgICAgIFVJQmFzZSA9IGJhaWR1LmVkaXRvci51aS5VSUJhc2UsDQogICAgICAgIFN0YXRlZnVsID0gYmFpZHUuZWRpdG9yLnVpLlN0YXRlZnVsLA0KICAgICAgICBTcGxpdEJ1dHRvbiA9IGJhaWR1LmVkaXRvci51aS5TcGxpdEJ1dHRvbiA9IGZ1bmN0aW9uIChvcHRpb25zKXsNCiAgICAgICAgICAgIHRoaXMuaW5pdE9wdGlvbnMob3B0aW9ucyk7DQogICAgICAgICAgICB0aGlzLmluaXRTcGxpdEJ1dHRvbigpOw0KICAgICAgICB9Ow0KICAgIFNwbGl0QnV0dG9uLnByb3RvdHlwZSA9IHsNCiAgICAgICAgcG9wdXA6IG51bGwsDQogICAgICAgIHVpTmFtZTogJ3NwbGl0YnV0dG9uJywNCiAgICAgICAgdGl0bGU6ICcnLA0KICAgICAgICBpbml0U3BsaXRCdXR0b246IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgdGhpcy5pbml0VUlCYXNlKCk7DQogICAgICAgICAgICB0aGlzLlN0YXRlZnVsX2luaXQoKTsNCiAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7DQogICAgICAgICAgICBpZiAodGhpcy5wb3B1cCAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgdmFyIHBvcHVwID0gdGhpcy5wb3B1cDsNCiAgICAgICAgICAgICAgICB0aGlzLnBvcHVwID0gbnVsbDsNCiAgICAgICAgICAgICAgICB0aGlzLnNldFBvcHVwKHBvcHVwKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgX1VJQmFzZV9wb3N0UmVuZGVyOiBVSUJhc2UucHJvdG90eXBlLnBvc3RSZW5kZXIsDQogICAgICAgIHBvc3RSZW5kZXI6IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgdGhpcy5TdGF0ZWZ1bF9wb3N0UmVuZGVyKCk7DQogICAgICAgICAgICB0aGlzLl9VSUJhc2VfcG9zdFJlbmRlcigpOw0KICAgICAgICB9LA0KICAgICAgICBzZXRQb3B1cDogZnVuY3Rpb24gKHBvcHVwKXsNCiAgICAgICAgICAgIGlmICh0aGlzLnBvcHVwID09PSBwb3B1cCkgcmV0dXJuOw0KICAgICAgICAgICAgaWYgKHRoaXMucG9wdXAgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIHRoaXMucG9wdXAuZGlzcG9zZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcG9wdXAuYWRkTGlzdGVuZXIoJ3Nob3cnLCB1dGlscy5iaW5kKHRoaXMuX29uUG9wdXBTaG93LCB0aGlzKSk7DQogICAgICAgICAgICBwb3B1cC5hZGRMaXN0ZW5lcignaGlkZScsIHV0aWxzLmJpbmQodGhpcy5fb25Qb3B1cEhpZGUsIHRoaXMpKTsNCiAgICAgICAgICAgIHBvcHVwLmFkZExpc3RlbmVyKCdwb3N0cmVuZGVyJywgdXRpbHMuYmluZChmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgICAgICBwb3B1cC5nZXREb20oJ2JvZHknKS5hcHBlbmRDaGlsZCgNCiAgICAgICAgICAgICAgICAgICAgdWlVdGlscy5jcmVhdGVFbGVtZW50QnlIdG1sKCc8ZGl2IGlkPSInICsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9wdXAuaWQgKyAnX2JvcmRlcmVyYXNlciIgY2xhc3M9ImVkdWktYm9yZGVyZXJhc2VyIGVkdWktYmFja2dyb3VuZCIgc3R5bGU9IndpZHRoOicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgKHVpVXRpbHMuZ2V0Q2xpZW50UmVjdCh0aGlzLmdldERvbSgpKS53aWR0aCArIDIwKSArICdweCI+PC9kaXY+JykNCiAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICBwb3B1cC5nZXREb20oKS5jbGFzc05hbWUgKz0gJyAnICsgdGhpcy5jbGFzc05hbWU7DQogICAgICAgICAgICB9LCB0aGlzKSk7DQogICAgICAgICAgICB0aGlzLnBvcHVwID0gcG9wdXA7DQogICAgICAgIH0sDQogICAgICAgIF9vblBvcHVwU2hvdzogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICB0aGlzLmFkZFN0YXRlKCdvcGVuZWQnKTsNCiAgICAgICAgfSwNCiAgICAgICAgX29uUG9wdXBIaWRlOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIHRoaXMucmVtb3ZlU3RhdGUoJ29wZW5lZCcpOw0KICAgICAgICB9LA0KICAgICAgICBnZXRIdG1sVHBsOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIHJldHVybiAnPGRpdiBpZD0iIyMiIGNsYXNzPSJlZHVpLWJveCAlJSI+JyArDQogICAgICAgICAgICAgICAgJzxkaXYgJysgKHRoaXMudGl0bGUgPyAndGl0bGU9IicgKyB0aGlzLnRpdGxlICsgJyInIDogJycpICsnIGlkPSIjI19zdGF0ZSIgc3RhdGVmdWw+PGRpdiBjbGFzcz0iJSUtYm9keSI+JyArDQogICAgICAgICAgICAgICAgJzxkaXYgaWQ9IiMjX2J1dHRvbl9ib2R5IiBjbGFzcz0iZWR1aS1ib3ggZWR1aS1idXR0b24tYm9keSIgb25jbGljaz0iJCQuX29uQnV0dG9uQ2xpY2soZXZlbnQsIHRoaXMpOyI+JyArDQogICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImVkdWktYm94IGVkdWktaWNvbiI+PC9kaXY+JyArDQogICAgICAgICAgICAgICAgJzwvZGl2PicgKw0KICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJlZHVpLWJveCBlZHVpLXNwbGl0Ym9yZGVyIj48L2Rpdj4nICsNCiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0iZWR1aS1ib3ggZWR1aS1hcnJvdyIgb25jbGljaz0iJCQuX29uQXJyb3dDbGljaygpOyI+PC9kaXY+JyArDQogICAgICAgICAgICAgICAgJzwvZGl2PjwvZGl2PjwvZGl2Pic7DQogICAgICAgIH0sDQogICAgICAgIHNob3dQb3B1cDogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICAvLyDlvZNwb3B1cOW+gOS4iuW8ueWHuueahOaXtuWAme+8jOWBmueJueauiuWkhOeQhg0KICAgICAgICAgICAgdmFyIHJlY3QgPSB1aVV0aWxzLmdldENsaWVudFJlY3QodGhpcy5nZXREb20oKSk7DQogICAgICAgICAgICByZWN0LnRvcCAtPSB0aGlzLnBvcHVwLlNIQURPV19SQURJVVM7DQogICAgICAgICAgICByZWN0LmhlaWdodCArPSB0aGlzLnBvcHVwLlNIQURPV19SQURJVVM7DQogICAgICAgICAgICB0aGlzLnBvcHVwLnNob3dBbmNob3JSZWN0KHJlY3QpOw0KICAgICAgICB9LA0KICAgICAgICBfb25BcnJvd0NsaWNrOiBmdW5jdGlvbiAoZXZlbnQsIGVsKXsNCiAgICAgICAgICAgIGlmICghdGhpcy5pc0Rpc2FibGVkKCkpIHsNCiAgICAgICAgICAgICAgICB0aGlzLnNob3dQb3B1cCgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBfb25CdXR0b25DbGljazogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICBpZiAoIXRoaXMuaXNEaXNhYmxlZCgpKSB7DQogICAgICAgICAgICAgICAgdGhpcy5maXJlRXZlbnQoJ2J1dHRvbmNsaWNrJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9Ow0KICAgIHV0aWxzLmluaGVyaXRzKFNwbGl0QnV0dG9uLCBVSUJhc2UpOw0KICAgIHV0aWxzLmV4dGVuZChTcGxpdEJ1dHRvbi5wcm90b3R5cGUsIFN0YXRlZnVsLCB0cnVlKTsNCg0KfSkoKTsNCgovLy9pbXBvcnQgY29yZQ0KLy8vaW1wb3J0IHVpY29yZQ0KLy8vaW1wb3J0IHVpL2NvbG9ycGlja2VyLmpzDQovLy9pbXBvcnQgdWkvcG9wdXAuanMNCi8vL2ltcG9ydCB1aS9zcGxpdGJ1dHRvbi5qcw0KKGZ1bmN0aW9uICgpew0KICAgIHZhciB1dGlscyA9IGJhaWR1LmVkaXRvci51dGlscywNCiAgICAgICAgdWlVdGlscyA9IGJhaWR1LmVkaXRvci51aS51aVV0aWxzLA0KICAgICAgICBDb2xvclBpY2tlciA9IGJhaWR1LmVkaXRvci51aS5Db2xvclBpY2tlciwNCiAgICAgICAgUG9wdXAgPSBiYWlkdS5lZGl0b3IudWkuUG9wdXAsDQogICAgICAgIFNwbGl0QnV0dG9uID0gYmFpZHUuZWRpdG9yLnVpLlNwbGl0QnV0dG9uLA0KICAgICAgICBDb2xvckJ1dHRvbiA9IGJhaWR1LmVkaXRvci51aS5Db2xvckJ1dHRvbiA9IGZ1bmN0aW9uIChvcHRpb25zKXsNCiAgICAgICAgICAgIHRoaXMuaW5pdE9wdGlvbnMob3B0aW9ucyk7DQogICAgICAgICAgICB0aGlzLmluaXRDb2xvckJ1dHRvbigpOw0KICAgICAgICB9Ow0KICAgIENvbG9yQnV0dG9uLnByb3RvdHlwZSA9IHsNCiAgICAgICAgaW5pdENvbG9yQnV0dG9uOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7DQogICAgICAgICAgICB0aGlzLnBvcHVwID0gbmV3IFBvcHVwKHsNCiAgICAgICAgICAgICAgICBjb250ZW50OiBuZXcgQ29sb3JQaWNrZXIoew0KICAgICAgICAgICAgICAgICAgICBub0NvbG9yVGV4dDogbWUuZWRpdG9yLmdldExhbmcoImNsZWFyQ29sb3IiKSwNCiAgICAgICAgICAgICAgICAgICAgZWRpdG9yOm1lLmVkaXRvciwNCiAgICAgICAgICAgICAgICAgICAgb25waWNrY29sb3I6IGZ1bmN0aW9uICh0LCBjb2xvcil7DQogICAgICAgICAgICAgICAgICAgICAgICBtZS5fb25QaWNrQ29sb3IoY29sb3IpOw0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICBvbnBpY2tub2NvbG9yOiBmdW5jdGlvbiAodCwgY29sb3Ipew0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuX29uUGlja05vQ29sb3IoY29sb3IpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSksDQogICAgICAgICAgICAgICAgZWRpdG9yOm1lLmVkaXRvcg0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB0aGlzLmluaXRTcGxpdEJ1dHRvbigpOw0KICAgICAgICB9LA0KICAgICAgICBfU3BsaXRCdXR0b25fcG9zdFJlbmRlcjogU3BsaXRCdXR0b24ucHJvdG90eXBlLnBvc3RSZW5kZXIsDQogICAgICAgIHBvc3RSZW5kZXI6IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgdGhpcy5fU3BsaXRCdXR0b25fcG9zdFJlbmRlcigpOw0KICAgICAgICAgICAgdGhpcy5nZXREb20oJ2J1dHRvbl9ib2R5JykuYXBwZW5kQ2hpbGQoDQogICAgICAgICAgICAgICAgdWlVdGlscy5jcmVhdGVFbGVtZW50QnlIdG1sKCc8ZGl2IGlkPSInICsgdGhpcy5pZCArICdfY29sb3JsdW1wIiBjbGFzcz0iZWR1aS1jb2xvcmx1bXAiPjwvZGl2PicpDQogICAgICAgICAgICApOw0KICAgICAgICAgICAgdGhpcy5nZXREb20oKS5jbGFzc05hbWUgKz0gJyBlZHVpLWNvbG9yYnV0dG9uJzsNCiAgICAgICAgfSwNCiAgICAgICAgc2V0Q29sb3I6IGZ1bmN0aW9uIChjb2xvcil7DQogICAgICAgICAgICB0aGlzLmdldERvbSgnY29sb3JsdW1wJykuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gY29sb3I7DQogICAgICAgICAgICB0aGlzLmNvbG9yID0gY29sb3I7DQogICAgICAgIH0sDQogICAgICAgIF9vblBpY2tDb2xvcjogZnVuY3Rpb24gKGNvbG9yKXsNCiAgICAgICAgICAgIGlmICh0aGlzLmZpcmVFdmVudCgncGlja2NvbG9yJywgY29sb3IpICE9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgIHRoaXMuc2V0Q29sb3IoY29sb3IpOw0KICAgICAgICAgICAgICAgIHRoaXMucG9wdXAuaGlkZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBfb25QaWNrTm9Db2xvcjogZnVuY3Rpb24gKGNvbG9yKXsNCiAgICAgICAgICAgIGlmICh0aGlzLmZpcmVFdmVudCgncGlja25vY29sb3InKSAhPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICB0aGlzLnBvcHVwLmhpZGUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH07DQogICAgdXRpbHMuaW5oZXJpdHMoQ29sb3JCdXR0b24sIFNwbGl0QnV0dG9uKTsNCg0KfSkoKTsNCgovLy9pbXBvcnQgY29yZQ0KLy8vaW1wb3J0IHVpY29yZQ0KLy8vaW1wb3J0IHVpL3BvcHVwLmpzDQovLy9pbXBvcnQgdWkvdGFibGVwaWNrZXIuanMNCi8vL2ltcG9ydCB1aS9zcGxpdGJ1dHRvbi5qcw0KKGZ1bmN0aW9uICgpew0KICAgIHZhciB1dGlscyA9IGJhaWR1LmVkaXRvci51dGlscywNCiAgICAgICAgUG9wdXAgPSBiYWlkdS5lZGl0b3IudWkuUG9wdXAsDQogICAgICAgIFRhYmxlUGlja2VyID0gYmFpZHUuZWRpdG9yLnVpLlRhYmxlUGlja2VyLA0KICAgICAgICBTcGxpdEJ1dHRvbiA9IGJhaWR1LmVkaXRvci51aS5TcGxpdEJ1dHRvbiwNCiAgICAgICAgVGFibGVCdXR0b24gPSBiYWlkdS5lZGl0b3IudWkuVGFibGVCdXR0b24gPSBmdW5jdGlvbiAob3B0aW9ucyl7DQogICAgICAgICAgICB0aGlzLmluaXRPcHRpb25zKG9wdGlvbnMpOw0KICAgICAgICAgICAgdGhpcy5pbml0VGFibGVCdXR0b24oKTsNCiAgICAgICAgfTsNCiAgICBUYWJsZUJ1dHRvbi5wcm90b3R5cGUgPSB7DQogICAgICAgIGluaXRUYWJsZUJ1dHRvbjogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzOw0KICAgICAgICAgICAgdGhpcy5wb3B1cCA9IG5ldyBQb3B1cCh7DQogICAgICAgICAgICAgICAgY29udGVudDogbmV3IFRhYmxlUGlja2VyKHsNCiAgICAgICAgICAgICAgICAgICAgZWRpdG9yOm1lLmVkaXRvciwNCiAgICAgICAgICAgICAgICAgICAgb25waWNrdGFibGU6IGZ1bmN0aW9uICh0LCBudW1Db2xzLCBudW1Sb3dzKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lLl9vblBpY2tUYWJsZShudW1Db2xzLCBudW1Sb3dzKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pLA0KICAgICAgICAgICAgICAgICdlZGl0b3InOm1lLmVkaXRvcg0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB0aGlzLmluaXRTcGxpdEJ1dHRvbigpOw0KICAgICAgICB9LA0KICAgICAgICBfb25QaWNrVGFibGU6IGZ1bmN0aW9uIChudW1Db2xzLCBudW1Sb3dzKXsNCiAgICAgICAgICAgIGlmICh0aGlzLmZpcmVFdmVudCgncGlja3RhYmxlJywgbnVtQ29scywgbnVtUm93cykgIT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgdGhpcy5wb3B1cC5oaWRlKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9Ow0KICAgIHV0aWxzLmluaGVyaXRzKFRhYmxlQnV0dG9uLCBTcGxpdEJ1dHRvbik7DQoNCn0pKCk7DQoKLy8vaW1wb3J0IGNvcmUNCi8vL2ltcG9ydCB1aWNvcmUNCihmdW5jdGlvbiAoKSB7DQogICAgdmFyIHV0aWxzID0gYmFpZHUuZWRpdG9yLnV0aWxzLA0KICAgICAgICBVSUJhc2UgPSBiYWlkdS5lZGl0b3IudWkuVUlCYXNlOw0KDQogICAgdmFyIEF1dG9UeXBlU2V0UGlja2VyID0gYmFpZHUuZWRpdG9yLnVpLkF1dG9UeXBlU2V0UGlja2VyID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsNCiAgICAgICAgdGhpcy5pbml0T3B0aW9ucyhvcHRpb25zKTsNCiAgICAgICAgdGhpcy5pbml0QXV0b1R5cGVTZXRQaWNrZXIoKTsNCiAgICB9Ow0KICAgIEF1dG9UeXBlU2V0UGlja2VyLnByb3RvdHlwZSA9IHsNCiAgICAgICAgaW5pdEF1dG9UeXBlU2V0UGlja2VyOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHRoaXMuaW5pdFVJQmFzZSgpOw0KICAgICAgICB9LA0KICAgICAgICBnZXRIdG1sVHBsOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBtZSA9IHRoaXMuZWRpdG9yLA0KICAgICAgICAgICAgICAgIG9wdCA9IG1lLm9wdGlvbnMuYXV0b3R5cGVzZXQsDQogICAgICAgICAgICAgICAgbGFuZyA9IG1lLmdldExhbmcoImF1dG9UeXBlU2V0Iik7DQoNCiAgICAgICAgICAgIHZhciB0ZXh0QWxpZ25JbnB1dE5hbWUgPSAndGV4dEFsaWduVmFsdWUnICsgbWUudWlkLA0KICAgICAgICAgICAgICAgIGltYWdlQmxvY2tJbnB1dE5hbWUgPSAnaW1hZ2VCbG9ja0xpbmVWYWx1ZScgKyBtZS51aWQ7DQoNCiAgICAgICAgICAgIHJldHVybiAnPGRpdiBpZD0iIyMiIGNsYXNzPSJlZHVpLWF1dG90eXBlc2V0cGlja2VyICUlIj4nICsNCiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0iZWR1aS1hdXRvdHlwZXNldHBpY2tlci1ib2R5Ij4nICsNCiAgICAgICAgICAgICAgICAnPHRhYmxlID4nICsNCiAgICAgICAgICAgICAgICAnPHRyPjx0ZCBub3dyYXAgY29sc3Bhbj0iMiI+PGlucHV0IHR5cGU9ImNoZWNrYm94IiBuYW1lPSJtZXJnZUVtcHR5bGluZSIgJyArIChvcHRbIm1lcmdlRW1wdHlsaW5lIl0gPyAiY2hlY2tlZCIgOiAiIiApICsgJz4nICsgbGFuZy5tZXJnZUxpbmUgKyAnPC90ZD48dGQgY29sc3Bhbj0iMiI+PGlucHV0IHR5cGU9ImNoZWNrYm94IiBuYW1lPSJyZW1vdmVFbXB0eWxpbmUiICcgKyAob3B0WyJyZW1vdmVFbXB0eWxpbmUiXSA/ICJjaGVja2VkIiA6ICIiICkgKyAnPicgKyBsYW5nLmRlbExpbmUgKyAnPC90ZD48L3RyPicgKw0KICAgICAgICAgICAgICAgICc8dHI+PHRkIG5vd3JhcCBjb2xzcGFuPSIyIj48aW5wdXQgdHlwZT0iY2hlY2tib3giIG5hbWU9InJlbW92ZUNsYXNzIiAnICsgKG9wdFsicmVtb3ZlQ2xhc3MiXSA/ICJjaGVja2VkIiA6ICIiICkgKyAnPicgKyBsYW5nLnJlbW92ZUZvcm1hdCArICc8L3RkPjx0ZCBjb2xzcGFuPSIyIj48aW5wdXQgdHlwZT0iY2hlY2tib3giIG5hbWU9ImluZGVudCIgJyArIChvcHRbImluZGVudCJdID8gImNoZWNrZWQiIDogIiIgKSArICc+JyArIGxhbmcuaW5kZW50ICsgJzwvdGQ+PC90cj4nICsNCiAgICAgICAgICAgICAgICAnPHRyPjx0ZCBub3dyYXAgY29sc3Bhbj0iMiI+PGlucHV0IHR5cGU9ImNoZWNrYm94IiBuYW1lPSJ0ZXh0QWxpZ24iICcgKyAob3B0WyJ0ZXh0QWxpZ24iXSA/ICJjaGVja2VkIiA6ICIiICkgKyAnPicgKyBsYW5nLmFsaWdubWVudCArICc8L3RkPjx0ZCBjb2xzcGFuPSIyIiBpZD0iJyArIHRleHRBbGlnbklucHV0TmFtZSArICciPjxpbnB1dCB0eXBlPSJyYWRpbyIgbmFtZT0iJysgdGV4dEFsaWduSW5wdXROYW1lICsnIiB2YWx1ZT0ibGVmdCIgJyArICgob3B0WyJ0ZXh0QWxpZ24iXSAmJiBvcHRbInRleHRBbGlnbiJdID09ICJsZWZ0IikgPyAiY2hlY2tlZCIgOiAiIikgKyAnPicgKyBtZS5nZXRMYW5nKCJqdXN0aWZ5bGVmdCIpICsgJzxpbnB1dCB0eXBlPSJyYWRpbyIgbmFtZT0iJysgdGV4dEFsaWduSW5wdXROYW1lICsnIiB2YWx1ZT0iY2VudGVyIiAnICsgKChvcHRbInRleHRBbGlnbiJdICYmIG9wdFsidGV4dEFsaWduIl0gPT0gImNlbnRlciIpID8gImNoZWNrZWQiIDogIiIpICsgJz4nICsgbWUuZ2V0TGFuZygianVzdGlmeWNlbnRlciIpICsgJzxpbnB1dCB0eXBlPSJyYWRpbyIgbmFtZT0iJysgdGV4dEFsaWduSW5wdXROYW1lICsnIiB2YWx1ZT0icmlnaHQiICcgKyAoKG9wdFsidGV4dEFsaWduIl0gJiYgb3B0WyJ0ZXh0QWxpZ24iXSA9PSAicmlnaHQiKSA/ICJjaGVja2VkIiA6ICIiKSArICc+JyArIG1lLmdldExhbmcoImp1c3RpZnlyaWdodCIpICsgJyA8L3RyPicgKw0KICAgICAgICAgICAgICAgICc8dHI+PHRkIG5vd3JhcCBjb2xzcGFuPSIyIj48aW5wdXQgdHlwZT0iY2hlY2tib3giIG5hbWU9ImltYWdlQmxvY2tMaW5lIiAnICsgKG9wdFsiaW1hZ2VCbG9ja0xpbmUiXSA/ICJjaGVja2VkIiA6ICIiICkgKyAnPicgKyBsYW5nLmltYWdlRmxvYXQgKyAnPC90ZD4nICsNCiAgICAgICAgICAgICAgICAnPHRkIG5vd3JhcCBjb2xzcGFuPSIyIiBpZD0iJysgaW1hZ2VCbG9ja0lucHV0TmFtZSArJyI+JyArDQogICAgICAgICAgICAgICAgJzxpbnB1dCB0eXBlPSJyYWRpbyIgbmFtZT0iJysgaW1hZ2VCbG9ja0lucHV0TmFtZSArJyIgdmFsdWU9Im5vbmUiICcgKyAoKG9wdFsiaW1hZ2VCbG9ja0xpbmUiXSAmJiBvcHRbImltYWdlQmxvY2tMaW5lIl0gPT0gIm5vbmUiKSA/ICJjaGVja2VkIiA6ICIiKSArICc+JyArIG1lLmdldExhbmcoImRlZmF1bHQiKSArDQogICAgICAgICAgICAgICAgJzxpbnB1dCB0eXBlPSJyYWRpbyIgbmFtZT0iJysgaW1hZ2VCbG9ja0lucHV0TmFtZSArJyIgdmFsdWU9ImxlZnQiICcgKyAoKG9wdFsiaW1hZ2VCbG9ja0xpbmUiXSAmJiBvcHRbImltYWdlQmxvY2tMaW5lIl0gPT0gImxlZnQiKSA/ICJjaGVja2VkIiA6ICIiKSArICc+JyArIG1lLmdldExhbmcoImp1c3RpZnlsZWZ0IikgKw0KICAgICAgICAgICAgICAgICc8aW5wdXQgdHlwZT0icmFkaW8iIG5hbWU9IicrIGltYWdlQmxvY2tJbnB1dE5hbWUgKyciIHZhbHVlPSJjZW50ZXIiICcgKyAoKG9wdFsiaW1hZ2VCbG9ja0xpbmUiXSAmJiBvcHRbImltYWdlQmxvY2tMaW5lIl0gPT0gImNlbnRlciIpID8gImNoZWNrZWQiIDogIiIpICsgJz4nICsgbWUuZ2V0TGFuZygianVzdGlmeWNlbnRlciIpICsNCiAgICAgICAgICAgICAgICAnPGlucHV0IHR5cGU9InJhZGlvIiBuYW1lPSInKyBpbWFnZUJsb2NrSW5wdXROYW1lICsnIiB2YWx1ZT0icmlnaHQiICcgKyAoKG9wdFsiaW1hZ2VCbG9ja0xpbmUiXSAmJiBvcHRbImltYWdlQmxvY2tMaW5lIl0gPT0gInJpZ2h0IikgPyAiY2hlY2tlZCIgOiAiIikgKyAnPicgKyBtZS5nZXRMYW5nKCJqdXN0aWZ5cmlnaHQiKSArICc8L3RyPicgKw0KDQogICAgICAgICAgICAgICAgJzx0cj48dGQgbm93cmFwIGNvbHNwYW49IjIiPjxpbnB1dCB0eXBlPSJjaGVja2JveCIgbmFtZT0iY2xlYXJGb250U2l6ZSIgJyArIChvcHRbImNsZWFyRm9udFNpemUiXSA/ICJjaGVja2VkIiA6ICIiICkgKyAnPicgKyBsYW5nLnJlbW92ZUZvbnRzaXplICsgJzwvdGQ+PHRkIGNvbHNwYW49IjIiPjxpbnB1dCB0eXBlPSJjaGVja2JveCIgbmFtZT0iY2xlYXJGb250RmFtaWx5IiAnICsgKG9wdFsiY2xlYXJGb250RmFtaWx5Il0gPyAiY2hlY2tlZCIgOiAiIiApICsgJz4nICsgbGFuZy5yZW1vdmVGb250RmFtaWx5ICsgJzwvdGQ+PC90cj4nICsNCiAgICAgICAgICAgICAgICAnPHRyPjx0ZCBub3dyYXAgY29sc3Bhbj0iNCI+PGlucHV0IHR5cGU9ImNoZWNrYm94IiBuYW1lPSJyZW1vdmVFbXB0eU5vZGUiICcgKyAob3B0WyJyZW1vdmVFbXB0eU5vZGUiXSA/ICJjaGVja2VkIiA6ICIiICkgKyAnPicgKyBsYW5nLnJlbW92ZUh0bWwgKyAnPC90ZD48L3RyPicgKw0KICAgICAgICAgICAgICAgICc8dHI+PHRkIG5vd3JhcCBjb2xzcGFuPSI0Ij48aW5wdXQgdHlwZT0iY2hlY2tib3giIG5hbWU9InBhc3RlRmlsdGVyIiAnICsgKG9wdFsicGFzdGVGaWx0ZXIiXSA/ICJjaGVja2VkIiA6ICIiICkgKyAnPicgKyBsYW5nLnBhc3RlRmlsdGVyICsgJzwvdGQ+PC90cj4nICsNCiAgICAgICAgICAgICAgICAnPHRyPjx0ZCBub3dyYXAgY29sc3Bhbj0iNCIgYWxpZ249InJpZ2h0Ij48YnV0dG9uID4nICsgbGFuZy5ydW4gKyAnPC9idXR0b24+PC90ZD48L3RyPicgKw0KICAgICAgICAgICAgICAgICc8L3RhYmxlPicgKw0KICAgICAgICAgICAgICAgICc8L2Rpdj4nICsNCiAgICAgICAgICAgICAgICAnPC9kaXY+JzsNCg0KDQogICAgICAgIH0sDQogICAgICAgIF9VSUJhc2VfcmVuZGVyOlVJQmFzZS5wcm90b3R5cGUucmVuZGVyDQogICAgfTsNCiAgICB1dGlscy5pbmhlcml0cyhBdXRvVHlwZVNldFBpY2tlciwgVUlCYXNlKTsNCn0pKCk7DQoKLy8vaW1wb3J0IGNvcmUNCi8vL2ltcG9ydCB1aWNvcmUNCi8vL2ltcG9ydCB1aS9wb3B1cC5qcw0KLy8vaW1wb3J0IHVpL2F1dG90eXBlc2V0cGlja2VyLmpzDQovLy9pbXBvcnQgdWkvc3BsaXRidXR0b24uanMNCihmdW5jdGlvbiAoKXsNCiAgICB2YXIgdXRpbHMgPSBiYWlkdS5lZGl0b3IudXRpbHMsDQogICAgICAgIFBvcHVwID0gYmFpZHUuZWRpdG9yLnVpLlBvcHVwLA0KICAgICAgICBBdXRvVHlwZVNldFBpY2tlciA9IGJhaWR1LmVkaXRvci51aS5BdXRvVHlwZVNldFBpY2tlciwNCiAgICAgICAgU3BsaXRCdXR0b24gPSBiYWlkdS5lZGl0b3IudWkuU3BsaXRCdXR0b24sDQogICAgICAgIEF1dG9UeXBlU2V0QnV0dG9uID0gYmFpZHUuZWRpdG9yLnVpLkF1dG9UeXBlU2V0QnV0dG9uID0gZnVuY3Rpb24gKG9wdGlvbnMpew0KICAgICAgICAgICAgdGhpcy5pbml0T3B0aW9ucyhvcHRpb25zKTsNCiAgICAgICAgICAgIHRoaXMuaW5pdEF1dG9UeXBlU2V0QnV0dG9uKCk7DQogICAgICAgIH07DQogICAgZnVuY3Rpb24gZ2V0UGFyYShtZSl7DQogICAgICAgIHZhciBvcHQgPSBtZS5lZGl0b3Iub3B0aW9ucy5hdXRvdHlwZXNldCwNCiAgICAgICAgICAgIGNvbnQgPSBtZS5nZXREb20oKSwNCiAgICAgICAgICAgIGVkaXRvcklkID0gbWUuZWRpdG9yLnVpZCwNCiAgICAgICAgICAgIGlucHV0VHlwZSA9IG51bGwsDQogICAgICAgICAgICBhdHRyTmFtZSA9IG51bGwsDQogICAgICAgICAgICBpcHRzID0gZG9tVXRpbHMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoY29udCwiaW5wdXQiKTsNCiAgICAgICAgZm9yKHZhciBpPWlwdHMubGVuZ3RoLTEsaXB0O2lwdD1pcHRzW2ktLV07KXsNCg0KICAgICAgICAgICAgaW5wdXRUeXBlID0gaXB0LmdldEF0dHJpYnV0ZSgidHlwZSIpOw0KDQogICAgICAgICAgICBpZihpbnB1dFR5cGU9PSJjaGVja2JveCIpew0KICAgICAgICAgICAgICAgIGF0dHJOYW1lID0gaXB0LmdldEF0dHJpYnV0ZSgibmFtZSIpOw0KICAgICAgICAgICAgICAgIG9wdFthdHRyTmFtZV0gJiYgZGVsZXRlIG9wdFthdHRyTmFtZV07DQogICAgICAgICAgICAgICAgaWYoaXB0LmNoZWNrZWQpew0KICAgICAgICAgICAgICAgICAgICB2YXIgYXR0clZhbHVlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIGF0dHJOYW1lKyJWYWx1ZSIgKyBlZGl0b3JJZCApOw0KICAgICAgICAgICAgICAgICAgICBpZihhdHRyVmFsdWUpew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoL2lucHV0L2lnLnRlc3QoYXR0clZhbHVlLnRhZ05hbWUpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRbYXR0ck5hbWVdID0gYXR0clZhbHVlLnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlwdENoaWxkcyA9IGF0dHJWYWx1ZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaW5wdXQiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGo9aXB0Q2hpbGRzLmxlbmd0aC0xLGlwdGNoaWxkO2lwdGNoaWxkPWlwdENoaWxkc1tqLS1dOyl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGlwdGNoaWxkLmNoZWNrZWQpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0W2F0dHJOYW1lXSA9IGlwdGNoaWxkLnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgb3B0W2F0dHJOYW1lXSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgdmFyIHNlbGVjdHMgPSBkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZShjb250LCJzZWxlY3QiKTsNCiAgICAgICAgZm9yKHZhciBpPTAsc2k7c2k9c2VsZWN0c1tpKytdOyl7DQogICAgICAgICAgICB2YXIgYXR0ciA9IHNpLmdldEF0dHJpYnV0ZSgnbmFtZScpOw0KICAgICAgICAgICAgb3B0W2F0dHJdID0gb3B0W2F0dHJdID8gc2kudmFsdWUgOiAnJzsNCiAgICAgICAgfQ0KDQogICAgICAgIG1lLmVkaXRvci5vcHRpb25zLmF1dG90eXBlc2V0ID0gb3B0Ow0KICAgIH0NCiAgICBBdXRvVHlwZVNldEJ1dHRvbi5wcm90b3R5cGUgPSB7DQogICAgICAgIGluaXRBdXRvVHlwZVNldEJ1dHRvbjogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzOw0KICAgICAgICAgICAgdGhpcy5wb3B1cCA9IG5ldyBQb3B1cCh7DQogICAgICAgICAgICAgICAgLy/kvKDlhaXphY3nva7lj4LmlbANCiAgICAgICAgICAgICAgICBjb250ZW50OiBuZXcgQXV0b1R5cGVTZXRQaWNrZXIoe2VkaXRvcjptZS5lZGl0b3J9KSwNCiAgICAgICAgICAgICAgICAnZWRpdG9yJzptZS5lZGl0b3IsDQogICAgICAgICAgICAgICAgaGlkZSA6IGZ1bmN0aW9uKCl7DQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9oaWRkZW4gJiYgdGhpcy5nZXREb20oKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZ2V0UGFyYSh0aGlzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0RG9tKCkuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2hpZGRlbiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmVFdmVudCgnaGlkZScpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB2YXIgZmxhZyA9IDA7DQogICAgICAgICAgICB0aGlzLnBvcHVwLmFkZExpc3RlbmVyKCdwb3N0UmVuZGVyQWZ0ZXInLGZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgICAgdmFyIHBvcHVwVUkgPSB0aGlzOw0KICAgICAgICAgICAgICAgIGlmKGZsYWcpcmV0dXJuOw0KICAgICAgICAgICAgICAgIHZhciBjb250ID0gdGhpcy5nZXREb20oKSwNCiAgICAgICAgICAgICAgICAgICAgYnRuID0gY29udC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYnV0dG9uJylbMF07DQoNCiAgICAgICAgICAgICAgICBidG4ub25jbGljayA9IGZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgICAgICAgIGdldFBhcmEocG9wdXBVSSk7DQogICAgICAgICAgICAgICAgICAgIG1lLmVkaXRvci5leGVjQ29tbWFuZCgnYXV0b3R5cGVzZXQnKTsNCiAgICAgICAgICAgICAgICAgICAgcG9wdXBVSS5oaWRlKCkNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIGZsYWcgPSAxOw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB0aGlzLmluaXRTcGxpdEJ1dHRvbigpOw0KICAgICAgICB9DQogICAgfTsNCiAgICB1dGlscy5pbmhlcml0cyhBdXRvVHlwZVNldEJ1dHRvbiwgU3BsaXRCdXR0b24pOw0KDQp9KSgpOw0KCi8vL2ltcG9ydCBjb3JlCi8vL2ltcG9ydCB1aWNvcmUKKGZ1bmN0aW9uICgpIHsKICAgIHZhciB1dGlscyA9IGJhaWR1LmVkaXRvci51dGlscywKICAgICAgICBQb3B1cCA9IGJhaWR1LmVkaXRvci51aS5Qb3B1cCwKICAgICAgICBTdGF0ZWZ1bCA9IGJhaWR1LmVkaXRvci51aS5TdGF0ZWZ1bCwKICAgICAgICBVSUJhc2UgPSBiYWlkdS5lZGl0b3IudWkuVUlCYXNlOwoKICAgIC8qKgogICAgICog6K+l5Y+C5pWw5bCG5paw5aKe5LiA5Liq5Y+C5pWw77yaIHNlbGVjdGVk77yMIOWPguaVsOexu+Wei+S4uuS4gOS4qk9iamVjdO+8jCDlvaLlpoJ7ICdhbGlnbic6ICdjZW50ZXInLCAndmFsaWduJzogJ3RvcCcgfe+8jCDooajnpLrljZXlhYPmoLznmoTliJ3lp4sKICAgICAqIOWvuem9kOeKtuaAgeS4uu+8miDnq5bnm7TlsYXkuIrvvIzmsLTlubPlsYXkuK07IOWFtuS4rSBhbGlnbueahOWPluWAvOS4uu+8midjZW50ZXInLCAnbGVmdCcsICdyaWdodCc7IHZhbGlnbueahOWPluWAvOS4ujogJ3RvcCcsICdtaWRkbGUnLCAnYm90dG9tJwogICAgICogQHVwZGF0ZSAyMDEzLzQvMiBoYW5jb25nMDNAYmFpZHUuY29tCiAgICAgKi8KICAgIHZhciBDZWxsQWxpZ25QaWNrZXIgPSBiYWlkdS5lZGl0b3IudWkuQ2VsbEFsaWduUGlja2VyID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsKICAgICAgICB0aGlzLmluaXRPcHRpb25zKG9wdGlvbnMpOwogICAgICAgIHRoaXMuaW5pdFNlbGVjdGVkKCk7CiAgICAgICAgdGhpcy5pbml0Q2VsbEFsaWduUGlja2VyKCk7CiAgICB9OwogICAgQ2VsbEFsaWduUGlja2VyLnByb3RvdHlwZSA9IHsKICAgICAgICAvL+WIneWni+WMlumAieS4reeKtuaAge+8jCDor6Xmlrnms5XlsIbmoLnmja7kvKDpgJLov5vmnaXnmoTlj4LmlbDojrflj5bliLDlupTor6XpgInkuK3nmoTlr7npvZDmlrnlvI/lm77moIfnmoTntKLlvJUKICAgICAgICBpbml0U2VsZWN0ZWQ6IGZ1bmN0aW9uKCl7CgogICAgICAgICAgICB2YXIgc3RhdHVzID0gewoKICAgICAgICAgICAgICAgIHZhbGlnbjogewogICAgICAgICAgICAgICAgICAgIHRvcDogMCwKICAgICAgICAgICAgICAgICAgICBtaWRkbGU6IDEsCiAgICAgICAgICAgICAgICAgICAgYm90dG9tOiAyCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgYWxpZ246IHsKICAgICAgICAgICAgICAgICAgICBsZWZ0OiAwLAogICAgICAgICAgICAgICAgICAgIGNlbnRlcjogMSwKICAgICAgICAgICAgICAgICAgICByaWdodDogMgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGNvdW50OiAzCgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHJlc3VsdCA9IC0xOwoKICAgICAgICAgICAgaWYoIHRoaXMuc2VsZWN0ZWQgKSB7CiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSBzdGF0dXMudmFsaWduWyB0aGlzLnNlbGVjdGVkLnZhbGlnbiBdICogc3RhdHVzLmNvdW50ICsgc3RhdHVzLmFsaWduWyB0aGlzLnNlbGVjdGVkLmFsaWduIF07CiAgICAgICAgICAgIH0KCiAgICAgICAgfSwKICAgICAgICBpbml0Q2VsbEFsaWduUGlja2VyOmZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdGhpcy5pbml0VUlCYXNlKCk7CiAgICAgICAgICAgIHRoaXMuU3RhdGVmdWxfaW5pdCgpOwogICAgICAgIH0sCiAgICAgICAgZ2V0SHRtbFRwbDpmdW5jdGlvbiAoKSB7CgogICAgICAgICAgICB2YXIgYWxpZ25UeXBlID0gWyAnbGVmdCcsICdjZW50ZXInLCAncmlnaHQnIF0sCiAgICAgICAgICAgICAgICBDT1VOVCA9IDksCiAgICAgICAgICAgICAgICB0ZW1wQ2xhc3NOYW1lID0gbnVsbCwKICAgICAgICAgICAgICAgIHRlbXBJbmRleCA9IC0xLAogICAgICAgICAgICAgICAgdG1wbCA9IFtdOwoKCiAgICAgICAgICAgIGZvciggdmFyIGk9IDA7IGk8Q09VTlQ7IGkrKyApIHsKCiAgICAgICAgICAgICAgICB0ZW1wQ2xhc3NOYW1lID0gdGhpcy5zZWxlY3RlZEluZGV4ID09PSBpID8gJyBjbGFzcz0iZWR1aS1jZWxsYWxpZ24tc2VsZWN0ZWQiICcgOiAnJzsKICAgICAgICAgICAgICAgIHRlbXBJbmRleCA9IGkgJSAzOwoKICAgICAgICAgICAgICAgIHRlbXBJbmRleCA9PT0gMCAmJiB0bXBsLnB1c2goJzx0cj4nKTsKCiAgICAgICAgICAgICAgICB0bXBsLnB1c2goICc8dGQgaW5kZXg9IicrIGkgKyciICcgKyB0ZW1wQ2xhc3NOYW1lICsgJyBzdGF0ZWZ1bD48ZGl2IGNsYXNzPSJlZHVpLWljb24gZWR1aS0nKyBhbGlnblR5cGVbIHRlbXBJbmRleCBdICsnIj48L2Rpdj48L3RkPicgKTsKCiAgICAgICAgICAgICAgICB0ZW1wSW5kZXggPT09IDIgJiYgdG1wbC5wdXNoKCc8L3RyPicpOwoKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuICc8ZGl2IGlkPSIjIyIgY2xhc3M9ImVkdWktY2VsbGFsaWducGlja2VyICUlIj4nICsKICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJlZHVpLWNlbGxhbGlnbnBpY2tlci1ib2R5Ij4nICsKICAgICAgICAgICAgICAgICc8dGFibGUgb25jbGljaz0iJCQuX29uQ2xpY2soZXZlbnQpOyI+JyArCiAgICAgICAgICAgICAgICB0bXBsLmpvaW4oJycpICsKICAgICAgICAgICAgICAgICc8L3RhYmxlPicgKwogICAgICAgICAgICAgICAgJzwvZGl2PicgKwogICAgICAgICAgICAgICAgJzwvZGl2Pic7CiAgICAgICAgfSwKICAgICAgICBnZXRTdGF0ZURvbTogZnVuY3Rpb24gKCl7CiAgICAgICAgICAgIHJldHVybiB0aGlzLnRhcmdldDsKICAgICAgICB9LAogICAgICAgIF9vbkNsaWNrOiBmdW5jdGlvbiAoZXZ0KXsKICAgICAgICAgICAgdmFyIHRhcmdldD0gZXZ0LnRhcmdldCB8fCBldnQuc3JjRWxlbWVudDsKICAgICAgICAgICAgaWYoL2ljb24vLnRlc3QodGFyZ2V0LmNsYXNzTmFtZSkpewogICAgICAgICAgICAgICAgdGhpcy5pdGVtc1t0YXJnZXQucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoImluZGV4IildLm9uY2xpY2soKTsKICAgICAgICAgICAgICAgIFBvcHVwLnBvc3RIaWRlKGV2dCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIF9VSUJhc2VfcmVuZGVyOlVJQmFzZS5wcm90b3R5cGUucmVuZGVyCiAgICB9OwogICAgdXRpbHMuaW5oZXJpdHMoQ2VsbEFsaWduUGlja2VyLCBVSUJhc2UpOwogICAgdXRpbHMuZXh0ZW5kKENlbGxBbGlnblBpY2tlci5wcm90b3R5cGUsIFN0YXRlZnVsLHRydWUpOwp9KSgpOwoKCgoKLy8vaW1wb3J0IGNvcmUKLy8vaW1wb3J0IHVpY29yZQooZnVuY3Rpb24gKCkgewogICAgdmFyIHV0aWxzID0gYmFpZHUuZWRpdG9yLnV0aWxzLAogICAgICAgIFN0YXRlZnVsID0gYmFpZHUuZWRpdG9yLnVpLlN0YXRlZnVsLAogICAgICAgIHVpVXRpbHMgPSBiYWlkdS5lZGl0b3IudWkudWlVdGlscywKICAgICAgICBVSUJhc2UgPSBiYWlkdS5lZGl0b3IudWkuVUlCYXNlOwoKICAgIHZhciBQYXN0ZVBpY2tlciA9IGJhaWR1LmVkaXRvci51aS5QYXN0ZVBpY2tlciA9IGZ1bmN0aW9uIChvcHRpb25zKSB7CiAgICAgICAgdGhpcy5pbml0T3B0aW9ucyhvcHRpb25zKTsKICAgICAgICB0aGlzLmluaXRQYXN0ZVBpY2tlcigpOwogICAgfTsKICAgIFBhc3RlUGlja2VyLnByb3RvdHlwZSA9IHsKICAgICAgICBpbml0UGFzdGVQaWNrZXI6ZnVuY3Rpb24gKCkgewogICAgICAgICAgICB0aGlzLmluaXRVSUJhc2UoKTsKICAgICAgICAgICAgdGhpcy5TdGF0ZWZ1bF9pbml0KCk7CiAgICAgICAgfSwKICAgICAgICBnZXRIdG1sVHBsOmZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuICc8ZGl2IGNsYXNzPSJlZHVpLXBhc3RlaWNvbiIgb25jbGljaz0iJCQuX29uQ2xpY2sodGhpcykiPjwvZGl2PicgKwogICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImVkdWktcGFzdGVjb250YWluZXIiPicgKwogICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImVkdWktdGl0bGUiPicgKyB0aGlzLmVkaXRvci5nZXRMYW5nKCJwYXN0ZU9wdCIpICsgJzwvZGl2PicgKwogICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImVkdWktYnV0dG9uIj4nICsKICAgICAgICAgICAgICAgICc8ZGl2IHRpdGxlPSInICsgdGhpcy5lZGl0b3IuZ2V0TGFuZygicGFzdGVTb3VyY2VGb3JtYXQiKSArICciIG9uY2xpY2s9IiQkLmZvcm1hdChmYWxzZSkiIHN0YXRlZnVsPicgKwogICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImVkdWktcmljaHR4dGljb24iPjwvZGl2PjwvZGl2PicgKwogICAgICAgICAgICAgICAgJzxkaXYgdGl0bGU9IicgKyB0aGlzLmVkaXRvci5nZXRMYW5nKCJ0YWdGb3JtYXQiKSArICciIG9uY2xpY2s9IiQkLmZvcm1hdCgyKSIgc3RhdGVmdWw+JyArCiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0iZWR1aS10YWdpY29uIj48L2Rpdj48L2Rpdj4nICsKICAgICAgICAgICAgICAgICc8ZGl2IHRpdGxlPSInICsgdGhpcy5lZGl0b3IuZ2V0TGFuZygicGFzdGVUZXh0Rm9ybWF0IikgKyAnIiBvbmNsaWNrPSIkJC5mb3JtYXQodHJ1ZSkiIHN0YXRlZnVsPicgKwogICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImVkdWktcGxhaW50eHRpY29uIj48L2Rpdj48L2Rpdj4nICsKICAgICAgICAgICAgICAgICc8L2Rpdj4nICsKICAgICAgICAgICAgICAgICc8L2Rpdj4nICsKICAgICAgICAgICAgICAgICc8L2Rpdj4nCiAgICAgICAgfSwKICAgICAgICBnZXRTdGF0ZURvbTpmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLnRhcmdldDsKICAgICAgICB9LAogICAgICAgIGZvcm1hdDpmdW5jdGlvbiAocGFyYW0pIHsKICAgICAgICAgICAgdGhpcy5lZGl0b3IudWkuX2lzVHJhbnNmZXIgPSB0cnVlOwogICAgICAgICAgICB0aGlzLmVkaXRvci5maXJlRXZlbnQoJ3Bhc3RlVHJhbnNmZXInLCBwYXJhbSk7CiAgICAgICAgfSwKICAgICAgICBfb25DbGljazpmdW5jdGlvbiAoY3VyKSB7CiAgICAgICAgICAgIHZhciBub2RlID0gZG9tVXRpbHMuZ2V0TmV4dERvbU5vZGUoY3VyKSwKICAgICAgICAgICAgICAgIHNjcmVlbkh0ID0gdWlVdGlscy5nZXRWaWV3cG9ydFJlY3QoKS5oZWlnaHQsCiAgICAgICAgICAgICAgICBzdWJQb3AgPSB1aVV0aWxzLmdldENsaWVudFJlY3Qobm9kZSk7CgogICAgICAgICAgICBpZiAoKHN1YlBvcC50b3AgKyBzdWJQb3AuaGVpZ2h0KSA+IHNjcmVlbkh0KQogICAgICAgICAgICAgICAgbm9kZS5zdHlsZS50b3AgPSAoLXN1YlBvcC5oZWlnaHQgLSBjdXIub2Zmc2V0SGVpZ2h0KSArICJweCI7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIG5vZGUuc3R5bGUudG9wID0gIiI7CgogICAgICAgICAgICBpZiAoL2hpZGRlbi9pZy50ZXN0KGRvbVV0aWxzLmdldENvbXB1dGVkU3R5bGUobm9kZSwgInZpc2liaWxpdHkiKSkpIHsKICAgICAgICAgICAgICAgIG5vZGUuc3R5bGUudmlzaWJpbGl0eSA9ICJ2aXNpYmxlIjsKICAgICAgICAgICAgICAgIGRvbVV0aWxzLmFkZENsYXNzKGN1ciwgImVkdWktc3RhdGUtb3BlbmVkIik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBub2RlLnN0eWxlLnZpc2liaWxpdHkgPSAiaGlkZGVuIjsKICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZUNsYXNzZXMoY3VyLCAiZWR1aS1zdGF0ZS1vcGVuZWQiKQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBfVUlCYXNlX3JlbmRlcjpVSUJhc2UucHJvdG90eXBlLnJlbmRlcgogICAgfTsKICAgIHV0aWxzLmluaGVyaXRzKFBhc3RlUGlja2VyLCBVSUJhc2UpOwogICAgdXRpbHMuZXh0ZW5kKFBhc3RlUGlja2VyLnByb3RvdHlwZSwgU3RhdGVmdWwsIHRydWUpOwp9KSgpOwoKCgoKCihmdW5jdGlvbiAoKXsNCiAgICB2YXIgdXRpbHMgPSBiYWlkdS5lZGl0b3IudXRpbHMsDQogICAgICAgIHVpVXRpbHMgPSBiYWlkdS5lZGl0b3IudWkudWlVdGlscywNCiAgICAgICAgVUlCYXNlID0gYmFpZHUuZWRpdG9yLnVpLlVJQmFzZSwNCiAgICAgICAgVG9vbGJhciA9IGJhaWR1LmVkaXRvci51aS5Ub29sYmFyID0gZnVuY3Rpb24gKG9wdGlvbnMpew0KICAgICAgICAgICAgdGhpcy5pbml0T3B0aW9ucyhvcHRpb25zKTsNCiAgICAgICAgICAgIHRoaXMuaW5pdFRvb2xiYXIoKTsNCiAgICAgICAgfTsNCiAgICBUb29sYmFyLnByb3RvdHlwZSA9IHsNCiAgICAgICAgaXRlbXM6IG51bGwsDQogICAgICAgIGluaXRUb29sYmFyOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIHRoaXMuaXRlbXMgPSB0aGlzLml0ZW1zIHx8IFtdOw0KICAgICAgICAgICAgdGhpcy5pbml0VUlCYXNlKCk7DQogICAgICAgIH0sDQogICAgICAgIGFkZDogZnVuY3Rpb24gKGl0ZW0pew0KICAgICAgICAgICAgdGhpcy5pdGVtcy5wdXNoKGl0ZW0pOw0KICAgICAgICB9LA0KICAgICAgICBnZXRIdG1sVHBsOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIHZhciBidWZmID0gW107DQogICAgICAgICAgICBmb3IgKHZhciBpPTA7IGk8dGhpcy5pdGVtcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgIGJ1ZmZbaV0gPSB0aGlzLml0ZW1zW2ldLnJlbmRlckh0bWwoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiAnPGRpdiBpZD0iIyMiIGNsYXNzPSJlZHVpLXRvb2xiYXIgJSUiIG9uc2VsZWN0c3RhcnQ9InJldHVybiBmYWxzZTsiIG9ubW91c2Vkb3duPSJyZXR1cm4gJCQuX29uTW91c2VEb3duKGV2ZW50LCB0aGlzKTsiPicgKw0KICAgICAgICAgICAgICAgIGJ1ZmYuam9pbignJykgKw0KICAgICAgICAgICAgICAgICc8L2Rpdj4nDQogICAgICAgIH0sDQogICAgICAgIHBvc3RSZW5kZXI6IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgdmFyIGJveCA9IHRoaXMuZ2V0RG9tKCk7DQogICAgICAgICAgICBmb3IgKHZhciBpPTA7IGk8dGhpcy5pdGVtcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgIHRoaXMuaXRlbXNbaV0ucG9zdFJlbmRlcigpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdWlVdGlscy5tYWtlVW5zZWxlY3RhYmxlKGJveCk7DQogICAgICAgIH0sDQogICAgICAgIF9vbk1vdXNlRG93bjogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICB9Ow0KICAgIHV0aWxzLmluaGVyaXRzKFRvb2xiYXIsIFVJQmFzZSk7DQoNCn0pKCk7DQoKLy8vaW1wb3J0IGNvcmUNCi8vL2ltcG9ydCB1aWNvcmUNCi8vL2ltcG9ydCB1aVxwb3B1cC5qcw0KLy8vaW1wb3J0IHVpXHN0YXRlZnVsLmpzDQooZnVuY3Rpb24gKCkgew0KICAgIHZhciB1dGlscyA9IGJhaWR1LmVkaXRvci51dGlscywNCiAgICAgICAgZG9tVXRpbHMgPSBiYWlkdS5lZGl0b3IuZG9tLmRvbVV0aWxzLA0KICAgICAgICB1aVV0aWxzID0gYmFpZHUuZWRpdG9yLnVpLnVpVXRpbHMsDQogICAgICAgIFVJQmFzZSA9IGJhaWR1LmVkaXRvci51aS5VSUJhc2UsDQogICAgICAgIFBvcHVwID0gYmFpZHUuZWRpdG9yLnVpLlBvcHVwLA0KICAgICAgICBTdGF0ZWZ1bCA9IGJhaWR1LmVkaXRvci51aS5TdGF0ZWZ1bCwNCiAgICAgICAgQ2VsbEFsaWduUGlja2VyID0gYmFpZHUuZWRpdG9yLnVpLkNlbGxBbGlnblBpY2tlciwNCg0KICAgICAgICBNZW51ID0gYmFpZHUuZWRpdG9yLnVpLk1lbnUgPSBmdW5jdGlvbiAob3B0aW9ucykgew0KICAgICAgICAgICAgdGhpcy5pbml0T3B0aW9ucyhvcHRpb25zKTsNCiAgICAgICAgICAgIHRoaXMuaW5pdE1lbnUoKTsNCiAgICAgICAgfTsNCg0KICAgIHZhciBtZW51U2VwYXJhdG9yID0gew0KICAgICAgICByZW5kZXJIdG1sOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHJldHVybiAnPGRpdiBjbGFzcz0iZWR1aS1tZW51aXRlbSBlZHVpLW1lbnVzZXBhcmF0b3IiPjxkaXYgY2xhc3M9ImVkdWktbWVudXNlcGFyYXRvci1pbm5lciI+PC9kaXY+PC9kaXY+JzsNCiAgICAgICAgfSwNCiAgICAgICAgcG9zdFJlbmRlcjpmdW5jdGlvbiAoKSB7DQogICAgICAgIH0sDQogICAgICAgIHF1ZXJ5QXV0b0hpZGU6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICB9Ow0KICAgIE1lbnUucHJvdG90eXBlID0gew0KICAgICAgICBpdGVtczpudWxsLA0KICAgICAgICB1aU5hbWU6J21lbnUnLA0KICAgICAgICBpbml0TWVudTpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB0aGlzLml0ZW1zID0gdGhpcy5pdGVtcyB8fCBbXTsNCiAgICAgICAgICAgIHRoaXMuaW5pdFBvcHVwKCk7DQogICAgICAgICAgICB0aGlzLmluaXRJdGVtcygpOw0KICAgICAgICB9LA0KICAgICAgICBpbml0SXRlbXM6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLml0ZW1zLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSB0aGlzLml0ZW1zW2ldOw0KICAgICAgICAgICAgICAgIGlmIChpdGVtID09ICctJykgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLml0ZW1zW2ldID0gdGhpcy5nZXRTZXBhcmF0b3IoKTsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCEoaXRlbSBpbnN0YW5jZW9mIE1lbnVJdGVtKSkgew0KICAgICAgICAgICAgICAgICAgICBpdGVtLmVkaXRvciA9IHRoaXMuZWRpdG9yOw0KICAgICAgICAgICAgICAgICAgICBpdGVtLnRoZW1lID0gdGhpcy5lZGl0b3Iub3B0aW9ucy50aGVtZTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtc1tpXSA9IHRoaXMuY3JlYXRlSXRlbShpdGVtKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGdldFNlcGFyYXRvcjpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICByZXR1cm4gbWVudVNlcGFyYXRvcjsNCiAgICAgICAgfSwNCiAgICAgICAgY3JlYXRlSXRlbTpmdW5jdGlvbiAoaXRlbSkgew0KICAgICAgICAgICAgLy/mlrDlop7kuIDkuKrlj4LmlbBtZW51LCDor6Xlj4LmlbDlrZjlgqjkuoZtZW51SXRlbeaJgOWvueW6lOeahG1lbnXlvJXnlKgNCiAgICAgICAgICAgIGl0ZW0ubWVudSA9IHRoaXM7DQogICAgICAgICAgICByZXR1cm4gbmV3IE1lbnVJdGVtKGl0ZW0pOw0KICAgICAgICB9LA0KICAgICAgICBfUG9wdXBfZ2V0Q29udGVudEh0bWxUcGw6UG9wdXAucHJvdG90eXBlLmdldENvbnRlbnRIdG1sVHBsLA0KICAgICAgICBnZXRDb250ZW50SHRtbFRwbDpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBpZiAodGhpcy5pdGVtcy5sZW5ndGggPT0gMCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9Qb3B1cF9nZXRDb250ZW50SHRtbFRwbCgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdmFyIGJ1ZmYgPSBbXTsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5pdGVtcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgIHZhciBpdGVtID0gdGhpcy5pdGVtc1tpXTsNCiAgICAgICAgICAgICAgICBidWZmW2ldID0gaXRlbS5yZW5kZXJIdG1sKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gKCc8ZGl2IGNsYXNzPSIlJS1ib2R5Ij4nICsgYnVmZi5qb2luKCcnKSArICc8L2Rpdj4nKTsNCiAgICAgICAgfSwNCiAgICAgICAgX1BvcHVwX3Bvc3RSZW5kZXI6UG9wdXAucHJvdG90eXBlLnBvc3RSZW5kZXIsDQogICAgICAgIHBvc3RSZW5kZXI6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpczsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5pdGVtcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgIHZhciBpdGVtID0gdGhpcy5pdGVtc1tpXTsNCiAgICAgICAgICAgICAgICBpdGVtLm93bmVyTWVudSA9IHRoaXM7DQogICAgICAgICAgICAgICAgaXRlbS5wb3N0UmVuZGVyKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBkb21VdGlscy5vbih0aGlzLmdldERvbSgpLCAnbW91c2VvdmVyJywgZnVuY3Rpb24gKGV2dCkgew0KICAgICAgICAgICAgICAgIGV2dCA9IGV2dCB8fCBldmVudDsNCiAgICAgICAgICAgICAgICB2YXIgcmVsID0gZXZ0LnJlbGF0ZWRUYXJnZXQgfHwgZXZ0LmZyb21FbGVtZW50Ow0KICAgICAgICAgICAgICAgIHZhciBlbCA9IG1lLmdldERvbSgpOw0KICAgICAgICAgICAgICAgIGlmICghdWlVdGlscy5jb250YWlucyhlbCwgcmVsKSAmJiBlbCAhPT0gcmVsKSB7DQogICAgICAgICAgICAgICAgICAgIG1lLmZpcmVFdmVudCgnb3ZlcicpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgdGhpcy5fUG9wdXBfcG9zdFJlbmRlcigpOw0KICAgICAgICB9LA0KICAgICAgICBxdWVyeUF1dG9IaWRlOmZ1bmN0aW9uIChlbCkgew0KICAgICAgICAgICAgaWYgKGVsKSB7DQogICAgICAgICAgICAgICAgaWYgKHVpVXRpbHMuY29udGFpbnModGhpcy5nZXREb20oKSwgZWwpKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLml0ZW1zLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBpdGVtID0gdGhpcy5pdGVtc1tpXTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0ucXVlcnlBdXRvSGlkZShlbCkgPT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGNsZWFySXRlbXM6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLml0ZW1zLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSB0aGlzLml0ZW1zW2ldOw0KICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChpdGVtLl9zaG93aW5nVGltZXIpOw0KICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChpdGVtLl9jbG9zaW5nVGltZXIpOw0KICAgICAgICAgICAgICAgIGlmIChpdGVtLnN1Yk1lbnUpIHsNCiAgICAgICAgICAgICAgICAgICAgaXRlbS5zdWJNZW51LmRlc3Ryb3koKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLml0ZW1zID0gW107DQogICAgICAgIH0sDQogICAgICAgIGRlc3Ryb3k6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgaWYgKHRoaXMuZ2V0RG9tKCkpIHsNCiAgICAgICAgICAgICAgICBkb21VdGlscy5yZW1vdmUodGhpcy5nZXREb20oKSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLmNsZWFySXRlbXMoKTsNCiAgICAgICAgfSwNCiAgICAgICAgZGlzcG9zZTpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB0aGlzLmRlc3Ryb3koKTsNCiAgICAgICAgfQ0KICAgIH07DQogICAgdXRpbHMuaW5oZXJpdHMoTWVudSwgUG9wdXApOw0KDQogICAgLyoqDQogICAgICogQHVwZGF0ZSAyMDEzLzA0LzAzIGhhbmNvbmcwMyDmlrDlop7kuIDkuKrlj4LmlbBtZW51LCDor6Xlj4LmlbDlrZjlgqjkuoZtZW51SXRlbeaJgOWvueW6lOeahG1lbnXlvJXnlKgNCiAgICAgKiBAdHlwZSB7RnVuY3Rpb259DQogICAgICovDQogICAgdmFyIE1lbnVJdGVtID0gYmFpZHUuZWRpdG9yLnVpLk1lbnVJdGVtID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsNCiAgICAgICAgdGhpcy5pbml0T3B0aW9ucyhvcHRpb25zKTsNCiAgICAgICAgdGhpcy5pbml0VUlCYXNlKCk7DQogICAgICAgIHRoaXMuU3RhdGVmdWxfaW5pdCgpOw0KICAgICAgICBpZiAodGhpcy5zdWJNZW51ICYmICEodGhpcy5zdWJNZW51IGluc3RhbmNlb2YgTWVudSkpIHsNCiAgICAgICAgICAgIGlmIChvcHRpb25zLmNsYXNzTmFtZSAmJiBvcHRpb25zLmNsYXNzTmFtZS5pbmRleE9mKCJhbGlnbnRkIikgIT0gLTEpIHsNCiAgICAgICAgICAgICAgICB2YXIgbWUgPSB0aGlzOw0KDQogICAgICAgICAgICAgICAgLy/ojrflj5bljZXlhYPmoLzlr7npvZDliJ3lp4vnirbmgIENCiAgICAgICAgICAgICAgICB0aGlzLnN1Yk1lbnUuc2VsZWN0ZWQgPSB0aGlzLmVkaXRvci5xdWVyeUNvbW1hbmRWYWx1ZSggJ2NlbGxhbGlnbm1lbnQnICk7DQoNCiAgICAgICAgICAgICAgICB0aGlzLnN1Yk1lbnUgPSBuZXcgUG9wdXAoew0KICAgICAgICAgICAgICAgICAgICBjb250ZW50Om5ldyBDZWxsQWxpZ25QaWNrZXIodGhpcy5zdWJNZW51KSwNCiAgICAgICAgICAgICAgICAgICAgcGFyZW50TWVudTptZSwNCiAgICAgICAgICAgICAgICAgICAgZWRpdG9yOm1lLmVkaXRvciwNCiAgICAgICAgICAgICAgICAgICAgZGVzdHJveTpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXREb20oKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZSh0aGlzLmdldERvbSgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIHRoaXMuc3ViTWVudS5hZGRMaXN0ZW5lcigicG9zdFJlbmRlckFmdGVyIiwgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5vbih0aGlzLmdldERvbSgpLCAibW91c2VvdmVyIiwgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuYWRkU3RhdGUoJ29wZW5lZCcpOw0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGhpcy5zdWJNZW51ID0gbmV3IE1lbnUodGhpcy5zdWJNZW51KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH07DQogICAgTWVudUl0ZW0ucHJvdG90eXBlID0gew0KICAgICAgICBsYWJlbDonJywNCiAgICAgICAgc3ViTWVudTpudWxsLA0KICAgICAgICBvd25lck1lbnU6bnVsbCwNCiAgICAgICAgdWlOYW1lOidtZW51aXRlbScsDQogICAgICAgIGFsd2FseXNIb3ZlcmFibGU6dHJ1ZSwNCiAgICAgICAgZ2V0SHRtbFRwbDpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICByZXR1cm4gJzxkaXYgaWQ9IiMjIiBjbGFzcz0iJSUiIHN0YXRlZnVsIG9uY2xpY2s9IiQkLl9vbkNsaWNrKGV2ZW50LCB0aGlzKTsiPicgKw0KICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSIlJS1ib2R5Ij4nICsNCiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlckxhYmVsSHRtbCgpICsNCiAgICAgICAgICAgICAgICAnPC9kaXY+JyArDQogICAgICAgICAgICAgICAgJzwvZGl2Pic7DQogICAgICAgIH0sDQogICAgICAgIHBvc3RSZW5kZXI6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpczsNCiAgICAgICAgICAgIHRoaXMuYWRkTGlzdGVuZXIoJ292ZXInLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgbWUub3duZXJNZW51LmZpcmVFdmVudCgnc3VibWVudW92ZXInLCBtZSk7DQogICAgICAgICAgICAgICAgaWYgKG1lLnN1Yk1lbnUpIHsNCiAgICAgICAgICAgICAgICAgICAgbWUuZGVsYXlTaG93U3ViTWVudSgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgaWYgKHRoaXMuc3ViTWVudSkgew0KICAgICAgICAgICAgICAgIHRoaXMuZ2V0RG9tKCkuY2xhc3NOYW1lICs9ICcgZWR1aS1oYXNzdWJtZW51JzsNCiAgICAgICAgICAgICAgICB0aGlzLnN1Yk1lbnUucmVuZGVyKCk7DQogICAgICAgICAgICAgICAgdGhpcy5hZGRMaXN0ZW5lcignb3V0JywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICBtZS5kZWxheUhpZGVTdWJNZW51KCk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgdGhpcy5zdWJNZW51LmFkZExpc3RlbmVyKCdvdmVyJywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQobWUuX2Nsb3NpbmdUaW1lcik7DQogICAgICAgICAgICAgICAgICAgIG1lLl9jbG9zaW5nVGltZXIgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICBtZS5hZGRTdGF0ZSgnb3BlbmVkJyk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgdGhpcy5vd25lck1lbnUuYWRkTGlzdGVuZXIoJ2hpZGUnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgIG1lLmhpZGVTdWJNZW51KCk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgdGhpcy5vd25lck1lbnUuYWRkTGlzdGVuZXIoJ3N1Ym1lbnVvdmVyJywgZnVuY3Rpb24gKHQsIHN1Yk1lbnUpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHN1Yk1lbnUgIT09IG1lKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBtZS5kZWxheUhpZGVTdWJNZW51KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB0aGlzLnN1Yk1lbnUuX2Jha1F1ZXJ5QXV0b0hpZGUgPSB0aGlzLnN1Yk1lbnUucXVlcnlBdXRvSGlkZTsNCiAgICAgICAgICAgICAgICB0aGlzLnN1Yk1lbnUucXVlcnlBdXRvSGlkZSA9IGZ1bmN0aW9uIChlbCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoZWwgJiYgdWlVdGlscy5jb250YWlucyhtZS5nZXREb20oKSwgZWwpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Jha1F1ZXJ5QXV0b0hpZGUoZWwpOw0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLmdldERvbSgpLnN0eWxlLnRhYkluZGV4ID0gJy0xJzsNCiAgICAgICAgICAgIHVpVXRpbHMubWFrZVVuc2VsZWN0YWJsZSh0aGlzLmdldERvbSgpKTsNCiAgICAgICAgICAgIHRoaXMuU3RhdGVmdWxfcG9zdFJlbmRlcigpOw0KICAgICAgICB9LA0KICAgICAgICBkZWxheVNob3dTdWJNZW51OmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7DQogICAgICAgICAgICBpZiAoIW1lLmlzRGlzYWJsZWQoKSkgew0KICAgICAgICAgICAgICAgIG1lLmFkZFN0YXRlKCdvcGVuZWQnKTsNCiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQobWUuX3Nob3dpbmdUaW1lcik7DQogICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KG1lLl9jbG9zaW5nVGltZXIpOw0KICAgICAgICAgICAgICAgIG1lLl9jbG9zaW5nVGltZXIgPSBudWxsOw0KICAgICAgICAgICAgICAgIG1lLl9zaG93aW5nVGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgbWUuc2hvd1N1Yk1lbnUoKTsNCiAgICAgICAgICAgICAgICB9LCAyNTApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBkZWxheUhpZGVTdWJNZW51OmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7DQogICAgICAgICAgICBpZiAoIW1lLmlzRGlzYWJsZWQoKSkgew0KICAgICAgICAgICAgICAgIG1lLnJlbW92ZVN0YXRlKCdvcGVuZWQnKTsNCiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQobWUuX3Nob3dpbmdUaW1lcik7DQogICAgICAgICAgICAgICAgaWYgKCFtZS5fY2xvc2luZ1RpbWVyKSB7DQogICAgICAgICAgICAgICAgICAgIG1lLl9jbG9zaW5nVGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbWUuaGFzU3RhdGUoJ29wZW5lZCcpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUuaGlkZVN1Yk1lbnUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIG1lLl9jbG9zaW5nVGltZXIgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB9LCA0MDApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgcmVuZGVyTGFiZWxIdG1sOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHJldHVybiAnPGRpdiBjbGFzcz0iZWR1aS1hcnJvdyI+PC9kaXY+JyArDQogICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImVkdWktYm94IGVkdWktaWNvbiI+PC9kaXY+JyArDQogICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImVkdWktYm94IGVkdWktbGFiZWwgJSUtbGFiZWwiPicgKyAodGhpcy5sYWJlbCB8fCAnJykgKyAnPC9kaXY+JzsNCiAgICAgICAgfSwNCiAgICAgICAgZ2V0U3RhdGVEb206ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RG9tKCk7DQogICAgICAgIH0sDQogICAgICAgIHF1ZXJ5QXV0b0hpZGU6ZnVuY3Rpb24gKGVsKSB7DQogICAgICAgICAgICBpZiAodGhpcy5zdWJNZW51ICYmIHRoaXMuaGFzU3RhdGUoJ29wZW5lZCcpKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3ViTWVudS5xdWVyeUF1dG9IaWRlKGVsKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgX29uQ2xpY2s6ZnVuY3Rpb24gKGV2ZW50LCB0aGlzXykgew0KICAgICAgICAgICAgaWYgKHRoaXMuaGFzU3RhdGUoJ2Rpc2FibGVkJykpIHJldHVybjsNCiAgICAgICAgICAgIGlmICh0aGlzLmZpcmVFdmVudCgnY2xpY2snLCBldmVudCwgdGhpc18pICE9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgIGlmICh0aGlzLnN1Yk1lbnUpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93U3ViTWVudSgpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIFBvcHVwLnBvc3RIaWRlKGV2ZW50KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIHNob3dTdWJNZW51OmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciByZWN0ID0gdWlVdGlscy5nZXRDbGllbnRSZWN0KHRoaXMuZ2V0RG9tKCkpOw0KICAgICAgICAgICAgcmVjdC5yaWdodCAtPSA1Ow0KICAgICAgICAgICAgcmVjdC5sZWZ0ICs9IDI7DQogICAgICAgICAgICByZWN0LndpZHRoIC09IDc7DQogICAgICAgICAgICByZWN0LnRvcCAtPSA0Ow0KICAgICAgICAgICAgcmVjdC5ib3R0b20gKz0gNDsNCiAgICAgICAgICAgIHJlY3QuaGVpZ2h0ICs9IDg7DQogICAgICAgICAgICB0aGlzLnN1Yk1lbnUuc2hvd0FuY2hvclJlY3QocmVjdCwgdHJ1ZSwgdHJ1ZSk7DQogICAgICAgIH0sDQogICAgICAgIGhpZGVTdWJNZW51OmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHRoaXMuc3ViTWVudS5oaWRlKCk7DQogICAgICAgIH0NCiAgICB9Ow0KICAgIHV0aWxzLmluaGVyaXRzKE1lbnVJdGVtLCBVSUJhc2UpOw0KICAgIHV0aWxzLmV4dGVuZChNZW51SXRlbS5wcm90b3R5cGUsIFN0YXRlZnVsLCB0cnVlKTsNCn0pKCk7DQoKLy8vaW1wb3J0IGNvcmUNCi8vL2ltcG9ydCB1aWNvcmUNCi8vL2ltcG9ydCB1aS9tZW51LmpzDQovLy9pbXBvcnQgdWkvc3BsaXRidXR0b24uanMNCihmdW5jdGlvbiAoKXsNCiAgICAvLyB0b2RvOiBtZW515ZKMaXRlbeaPkOaIkOmAmueUqGxpc3QNCiAgICB2YXIgdXRpbHMgPSBiYWlkdS5lZGl0b3IudXRpbHMsDQogICAgICAgIHVpVXRpbHMgPSBiYWlkdS5lZGl0b3IudWkudWlVdGlscywNCiAgICAgICAgTWVudSA9IGJhaWR1LmVkaXRvci51aS5NZW51LA0KICAgICAgICBTcGxpdEJ1dHRvbiA9IGJhaWR1LmVkaXRvci51aS5TcGxpdEJ1dHRvbiwNCiAgICAgICAgQ29tYm94ID0gYmFpZHUuZWRpdG9yLnVpLkNvbWJveCA9IGZ1bmN0aW9uIChvcHRpb25zKXsNCiAgICAgICAgICAgIHRoaXMuaW5pdE9wdGlvbnMob3B0aW9ucyk7DQogICAgICAgICAgICB0aGlzLmluaXRDb21ib3goKTsNCiAgICAgICAgfTsNCiAgICBDb21ib3gucHJvdG90eXBlID0gew0KICAgICAgICB1aU5hbWU6ICdjb21ib3gnLA0KICAgICAgICBpbml0Q29tYm94OiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7DQogICAgICAgICAgICB0aGlzLml0ZW1zID0gdGhpcy5pdGVtcyB8fCBbXTsNCiAgICAgICAgICAgIGZvciAodmFyIGk9MDsgaTx0aGlzLml0ZW1zLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSB0aGlzLml0ZW1zW2ldOw0KICAgICAgICAgICAgICAgIGl0ZW0udWlOYW1lID0gJ2xpc3RpdGVtJzsNCiAgICAgICAgICAgICAgICBpdGVtLmluZGV4ID0gaTsNCiAgICAgICAgICAgICAgICBpdGVtLm9uY2xpY2sgPSBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgICAgICAgICAgbWUuc2VsZWN0QnlJbmRleCh0aGlzLmluZGV4KTsNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5wb3B1cCA9IG5ldyBNZW51KHsNCiAgICAgICAgICAgICAgICBpdGVtczogdGhpcy5pdGVtcywNCiAgICAgICAgICAgICAgICB1aU5hbWU6ICdsaXN0JywNCiAgICAgICAgICAgICAgICBlZGl0b3I6dGhpcy5lZGl0b3IsDQogICAgICAgICAgICAgICAgY2FwdHVyZVdoZWVsOiB0cnVlLA0KICAgICAgICAgICAgICAgIGNvbWJveDogdGhpcw0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIHRoaXMuaW5pdFNwbGl0QnV0dG9uKCk7DQogICAgICAgIH0sDQogICAgICAgIF9TcGxpdEJ1dHRvbl9wb3N0UmVuZGVyOiBTcGxpdEJ1dHRvbi5wcm90b3R5cGUucG9zdFJlbmRlciwNCiAgICAgICAgcG9zdFJlbmRlcjogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICB0aGlzLl9TcGxpdEJ1dHRvbl9wb3N0UmVuZGVyKCk7DQogICAgICAgICAgICB0aGlzLnNldExhYmVsKHRoaXMubGFiZWwgfHwgJycpOw0KICAgICAgICAgICAgdGhpcy5zZXRWYWx1ZSh0aGlzLmluaXRWYWx1ZSB8fCAnJyk7DQogICAgICAgIH0sDQogICAgICAgIHNob3dQb3B1cDogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICB2YXIgcmVjdCA9IHVpVXRpbHMuZ2V0Q2xpZW50UmVjdCh0aGlzLmdldERvbSgpKTsNCiAgICAgICAgICAgIHJlY3QudG9wICs9IDE7DQogICAgICAgICAgICByZWN0LmJvdHRvbSAtPSAxOw0KICAgICAgICAgICAgcmVjdC5oZWlnaHQgLT0gMjsNCiAgICAgICAgICAgIHRoaXMucG9wdXAuc2hvd0FuY2hvclJlY3QocmVjdCk7DQogICAgICAgIH0sDQogICAgICAgIGdldFZhbHVlOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLnZhbHVlOw0KICAgICAgICB9LA0KICAgICAgICBzZXRWYWx1ZTogZnVuY3Rpb24gKHZhbHVlKXsNCiAgICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMuaW5kZXhCeVZhbHVlKHZhbHVlKTsNCiAgICAgICAgICAgIGlmIChpbmRleCAhPSAtMSkgew0KICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IGluZGV4Ow0KICAgICAgICAgICAgICAgIHRoaXMuc2V0TGFiZWwodGhpcy5pdGVtc1tpbmRleF0ubGFiZWwpOw0KICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLml0ZW1zW2luZGV4XS52YWx1ZTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gLTE7DQogICAgICAgICAgICAgICAgdGhpcy5zZXRMYWJlbCh0aGlzLmdldExhYmVsRm9yVW5rbm93VmFsdWUodmFsdWUpKTsNCiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIHNldExhYmVsOiBmdW5jdGlvbiAobGFiZWwpew0KICAgICAgICAgICAgdGhpcy5nZXREb20oJ2J1dHRvbl9ib2R5JykuaW5uZXJIVE1MID0gbGFiZWw7DQogICAgICAgICAgICB0aGlzLmxhYmVsID0gbGFiZWw7DQogICAgICAgIH0sDQogICAgICAgIGdldExhYmVsRm9yVW5rbm93VmFsdWU6IGZ1bmN0aW9uICh2YWx1ZSl7DQogICAgICAgICAgICByZXR1cm4gdmFsdWU7DQogICAgICAgIH0sDQogICAgICAgIGluZGV4QnlWYWx1ZTogZnVuY3Rpb24gKHZhbHVlKXsNCiAgICAgICAgICAgIGZvciAodmFyIGk9MDsgaTx0aGlzLml0ZW1zLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgaWYgKHZhbHVlID09IHRoaXMuaXRlbXNbaV0udmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgICB9LA0KICAgICAgICBnZXRJdGVtOiBmdW5jdGlvbiAoaW5kZXgpew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXRlbXNbaW5kZXhdOw0KICAgICAgICB9LA0KICAgICAgICBzZWxlY3RCeUluZGV4OiBmdW5jdGlvbiAoaW5kZXgpew0KICAgICAgICAgICAgaWYgKGluZGV4IDwgdGhpcy5pdGVtcy5sZW5ndGggJiYgdGhpcy5maXJlRXZlbnQoJ3NlbGVjdCcsIGluZGV4KSAhPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSBpbmRleDsNCiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5pdGVtc1tpbmRleF0udmFsdWU7DQogICAgICAgICAgICAgICAgdGhpcy5zZXRMYWJlbCh0aGlzLml0ZW1zW2luZGV4XS5sYWJlbCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9Ow0KICAgIHV0aWxzLmluaGVyaXRzKENvbWJveCwgU3BsaXRCdXR0b24pOw0KfSkoKTsNCgovLy9pbXBvcnQgY29yZQ0KLy8vaW1wb3J0IHVpY29yZQ0KLy8vaW1wb3J0IHVpL21hc2suanMNCi8vL2ltcG9ydCB1aS9idXR0b24uanMNCihmdW5jdGlvbiAoKXsNCiAgICB2YXIgdXRpbHMgPSBiYWlkdS5lZGl0b3IudXRpbHMsDQogICAgICAgIGRvbVV0aWxzID0gYmFpZHUuZWRpdG9yLmRvbS5kb21VdGlscywNCiAgICAgICAgdWlVdGlscyA9IGJhaWR1LmVkaXRvci51aS51aVV0aWxzLA0KICAgICAgICBNYXNrID0gYmFpZHUuZWRpdG9yLnVpLk1hc2ssDQogICAgICAgIFVJQmFzZSA9IGJhaWR1LmVkaXRvci51aS5VSUJhc2UsDQogICAgICAgIEJ1dHRvbiA9IGJhaWR1LmVkaXRvci51aS5CdXR0b24sDQogICAgICAgIERpYWxvZyA9IGJhaWR1LmVkaXRvci51aS5EaWFsb2cgPSBmdW5jdGlvbiAob3B0aW9ucyl7DQogICAgICAgICAgICB0aGlzLmluaXRPcHRpb25zKHV0aWxzLmV4dGVuZCh7DQogICAgICAgICAgICAgICAgYXV0b1Jlc2V0OiB0cnVlLA0KICAgICAgICAgICAgICAgIGRyYWdnYWJsZTogdHJ1ZSwNCiAgICAgICAgICAgICAgICBvbm9rOiBmdW5jdGlvbiAoKXt9LA0KICAgICAgICAgICAgICAgIG9uY2FuY2VsOiBmdW5jdGlvbiAoKXt9LA0KICAgICAgICAgICAgICAgIG9uY2xvc2U6IGZ1bmN0aW9uICh0LCBvayl7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBvayA/IHRoaXMub25vaygpIDogdGhpcy5vbmNhbmNlbCgpOw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgLy/mmK/lkKbmjqfliLZkaWFsb2fkuK3nmoRzY3JvbGzkuovku7bvvIwg6buY6K6k5Li65LiN6Zi75q2iDQogICAgICAgICAgICAgICAgaG9sZFNjcm9sbDogZmFsc2UNCiAgICAgICAgICAgIH0sb3B0aW9ucykpOw0KICAgICAgICAgICAgdGhpcy5pbml0RGlhbG9nKCk7DQogICAgICAgIH07DQogICAgdmFyIG1vZGFsTWFzazsNCiAgICB2YXIgZHJhZ01hc2s7DQogICAgRGlhbG9nLnByb3RvdHlwZSA9IHsNCiAgICAgICAgZHJhZ2dhYmxlOiBmYWxzZSwNCiAgICAgICAgdWlOYW1lOiAnZGlhbG9nJywNCiAgICAgICAgaW5pdERpYWxvZzogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzLA0KICAgICAgICAgICAgICAgIHRoZW1lPXRoaXMuZWRpdG9yLm9wdGlvbnMudGhlbWU7DQogICAgICAgICAgICB0aGlzLmluaXRVSUJhc2UoKTsNCiAgICAgICAgICAgIHRoaXMubW9kYWxNYXNrID0gKG1vZGFsTWFzayB8fCAobW9kYWxNYXNrID0gbmV3IE1hc2soew0KICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2VkdWktZGlhbG9nLW1vZGFsbWFzaycsDQogICAgICAgICAgICAgICAgdGhlbWU6dGhlbWUNCiAgICAgICAgICAgIH0pKSk7DQogICAgICAgICAgICB0aGlzLmRyYWdNYXNrID0gKGRyYWdNYXNrIHx8IChkcmFnTWFzayA9IG5ldyBNYXNrKHsNCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdlZHVpLWRpYWxvZy1kcmFnbWFzaycsDQogICAgICAgICAgICAgICAgdGhlbWU6dGhlbWUNCiAgICAgICAgICAgIH0pKSk7DQogICAgICAgICAgICB0aGlzLmNsb3NlQnV0dG9uID0gbmV3IEJ1dHRvbih7DQogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZWR1aS1kaWFsb2ctY2xvc2VidXR0b24nLA0KICAgICAgICAgICAgICAgIHRpdGxlOiBtZS5jbG9zZURpYWxvZywNCiAgICAgICAgICAgICAgICB0aGVtZTp0aGVtZSwNCiAgICAgICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgICAgICAgICAgbWUuY2xvc2UoZmFsc2UpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgaWYgKHRoaXMuYnV0dG9ucykgew0KICAgICAgICAgICAgICAgIGZvciAodmFyIGk9MDsgaTx0aGlzLmJ1dHRvbnMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5idXR0b25zW2ldIGluc3RhbmNlb2YgQnV0dG9uKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idXR0b25zW2ldID0gbmV3IEJ1dHRvbih0aGlzLmJ1dHRvbnNbaV0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBmaXRTaXplOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIHZhciBwb3BCb2R5RWwgPSB0aGlzLmdldERvbSgnYm9keScpOw0KLy8gICAgICAgICAgICBpZiAoIShiYWlkdS5lZGl0b3IuYnJvd3Nlci5pZSAmJiBiYWlkdS5lZGl0b3IuYnJvd3Nlci52ZXJzaW9uID09IDcpKSB7DQovLyAgICAgICAgICAgICAgICB1aVV0aWxzLnJlbW92ZVN0eWxlKHBvcEJvZHlFbCwgJ3dpZHRoJyk7DQovLyAgICAgICAgICAgICAgICB1aVV0aWxzLnJlbW92ZVN0eWxlKHBvcEJvZHlFbCwgJ2hlaWdodCcpOw0KLy8gICAgICAgICAgICB9DQogICAgICAgICAgICB2YXIgc2l6ZSA9IHRoaXMubWVzdXJlU2l6ZSgpOw0KICAgICAgICAgICAgcG9wQm9keUVsLnN0eWxlLndpZHRoID0gc2l6ZS53aWR0aCArICdweCc7DQogICAgICAgICAgICBwb3BCb2R5RWwuc3R5bGUuaGVpZ2h0ID0gc2l6ZS5oZWlnaHQgKyAncHgnOw0KICAgICAgICAgICAgcmV0dXJuIHNpemU7DQogICAgICAgIH0sDQogICAgICAgIHNhZmVTZXRPZmZzZXQ6IGZ1bmN0aW9uIChvZmZzZXQpew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpczsNCiAgICAgICAgICAgIHZhciBlbCA9IG1lLmdldERvbSgpOw0KICAgICAgICAgICAgdmFyIHZwUmVjdCA9IHVpVXRpbHMuZ2V0Vmlld3BvcnRSZWN0KCk7DQogICAgICAgICAgICB2YXIgcmVjdCA9IHVpVXRpbHMuZ2V0Q2xpZW50UmVjdChlbCk7DQogICAgICAgICAgICB2YXIgbGVmdCA9IG9mZnNldC5sZWZ0Ow0KICAgICAgICAgICAgaWYgKGxlZnQgKyByZWN0LndpZHRoID4gdnBSZWN0LnJpZ2h0KSB7DQogICAgICAgICAgICAgICAgbGVmdCA9IHZwUmVjdC5yaWdodCAtIHJlY3Qud2lkdGg7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB2YXIgdG9wID0gb2Zmc2V0LnRvcDsNCiAgICAgICAgICAgIGlmICh0b3AgKyByZWN0LmhlaWdodCA+IHZwUmVjdC5ib3R0b20pIHsNCiAgICAgICAgICAgICAgICB0b3AgPSB2cFJlY3QuYm90dG9tIC0gcmVjdC5oZWlnaHQ7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbC5zdHlsZS5sZWZ0ID0gTWF0aC5tYXgobGVmdCwgMCkgKyAncHgnOw0KICAgICAgICAgICAgZWwuc3R5bGUudG9wID0gTWF0aC5tYXgodG9wLCAwKSArICdweCc7DQogICAgICAgIH0sDQogICAgICAgIHNob3dBdENlbnRlcjogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICB0aGlzLmdldERvbSgpLnN0eWxlLmRpc3BsYXkgPSAnJzsNCiAgICAgICAgICAgIHZhciB2cFJlY3QgPSB1aVV0aWxzLmdldFZpZXdwb3J0UmVjdCgpOw0KICAgICAgICAgICAgdmFyIHBvcFNpemUgPSB0aGlzLmZpdFNpemUoKTsNCiAgICAgICAgICAgIHZhciB0aXRsZUhlaWdodCA9IHRoaXMuZ2V0RG9tKCd0aXRsZWJhcicpLm9mZnNldEhlaWdodCB8IDA7DQogICAgICAgICAgICB2YXIgbGVmdCA9IHZwUmVjdC53aWR0aCAvIDIgLSBwb3BTaXplLndpZHRoIC8gMjsNCiAgICAgICAgICAgIHZhciB0b3AgPSB2cFJlY3QuaGVpZ2h0IC8gMiAtIChwb3BTaXplLmhlaWdodCAtIHRpdGxlSGVpZ2h0KSAvIDIgLSB0aXRsZUhlaWdodDsNCiAgICAgICAgICAgIHZhciBwb3BFbCA9IHRoaXMuZ2V0RG9tKCk7DQogICAgICAgICAgICB0aGlzLnNhZmVTZXRPZmZzZXQoew0KICAgICAgICAgICAgICAgIGxlZnQ6IE1hdGgubWF4KGxlZnQgfCAwLCAwKSwNCiAgICAgICAgICAgICAgICB0b3A6IE1hdGgubWF4KHRvcCB8IDAsIDApDQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIGlmICghZG9tVXRpbHMuaGFzQ2xhc3MocG9wRWwsICdlZHVpLXN0YXRlLWNlbnRlcmVkJykpIHsNCiAgICAgICAgICAgICAgICBwb3BFbC5jbGFzc05hbWUgKz0gJyBlZHVpLXN0YXRlLWNlbnRlcmVkJzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuX3Nob3coKTsNCiAgICAgICAgfSwNCiAgICAgICAgZ2V0Q29udGVudEh0bWw6IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgdmFyIGNvbnRlbnRIdG1sID0gJyc7DQogICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuY29udGVudCA9PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgICAgIGNvbnRlbnRIdG1sID0gdGhpcy5jb250ZW50Ow0KICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmlmcmFtZVVybCkgew0KICAgICAgICAgICAgICAgIGNvbnRlbnRIdG1sID0gJzxzcGFuIGlkPSInKyB0aGlzLmlkICsnX2NvbnRtYXNrIiBjbGFzcz0iZGlhbG9nY29udG1hc2siPjwvc3Bhbj48aWZyYW1lIGlkPSInKyB0aGlzLmlkICsNCiAgICAgICAgICAgICAgICAgICAgJ19pZnJhbWUiIGNsYXNzPSIlJS1pZnJhbWUiIGhlaWdodD0iMTAwJSIgd2lkdGg9IjEwMCUiIGZyYW1lYm9yZGVyPSIwIiBzcmM9IicrIHRoaXMuaWZyYW1lVXJsICsnIj48L2lmcmFtZT4nOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnRIdG1sOw0KICAgICAgICB9LA0KICAgICAgICBnZXRIdG1sVHBsOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIHZhciBmb290SHRtbCA9ICcnOw0KDQogICAgICAgICAgICBpZiAodGhpcy5idXR0b25zKSB7DQogICAgICAgICAgICAgICAgdmFyIGJ1ZmYgPSBbXTsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBpPTA7IGk8dGhpcy5idXR0b25zLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgIGJ1ZmZbaV0gPSB0aGlzLmJ1dHRvbnNbaV0ucmVuZGVySHRtbCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmb290SHRtbCA9ICc8ZGl2IGNsYXNzPSIlJS1mb290Ij4nICsNCiAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGlkPSIjI19idXR0b25zIiBjbGFzcz0iJSUtYnV0dG9ucyI+JyArIGJ1ZmYuam9pbignJykgKyAnPC9kaXY+JyArDQogICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJzxkaXYgaWQ9IiMjIiBjbGFzcz0iJSUiPjxkaXYgY2xhc3M9IiUlLXdyYXAiPjxkaXYgaWQ9IiMjX2JvZHkiIGNsYXNzPSIlJS1ib2R5Ij4nICsNCiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0iJSUtc2hhZG93Ij48L2Rpdj4nICsNCiAgICAgICAgICAgICAgICAnPGRpdiBpZD0iIyNfdGl0bGViYXIiIGNsYXNzPSIlJS10aXRsZWJhciI+JyArDQogICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9IiUlLWRyYWdoYW5kbGUiIG9ubW91c2Vkb3duPSIkJC5fb25UaXRsZWJhck1vdXNlRG93bihldmVudCwgdGhpcyk7Ij4nICsNCiAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPSIlJS1jYXB0aW9uIj4nICsgKHRoaXMudGl0bGUgfHwgJycpICsgJzwvc3Bhbj4nICsNCiAgICAgICAgICAgICAgICAnPC9kaXY+JyArDQogICAgICAgICAgICAgICAgdGhpcy5jbG9zZUJ1dHRvbi5yZW5kZXJIdG1sKCkgKw0KICAgICAgICAgICAgICAgICc8L2Rpdj4nICsNCiAgICAgICAgICAgICAgICAnPGRpdiBpZD0iIyNfY29udGVudCIgY2xhc3M9IiUlLWNvbnRlbnQiPicrICggdGhpcy5hdXRvUmVzZXQgPyAnJyA6IHRoaXMuZ2V0Q29udGVudEh0bWwoKSkgKyc8L2Rpdj4nICsNCiAgICAgICAgICAgICAgICBmb290SHRtbCArDQogICAgICAgICAgICAgICAgJzwvZGl2PjwvZGl2PjwvZGl2Pic7DQogICAgICAgIH0sDQogICAgICAgIHBvc3RSZW5kZXI6IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgLy8gdG9kbzog5L+d5oyB5bGF5LitL+iusOS9j+S4iuasoeWFs+mXreS9jee9rumAiemhuQ0KICAgICAgICAgICAgaWYgKCF0aGlzLm1vZGFsTWFzay5nZXREb20oKSkgew0KICAgICAgICAgICAgICAgIHRoaXMubW9kYWxNYXNrLnJlbmRlcigpOw0KICAgICAgICAgICAgICAgIHRoaXMubW9kYWxNYXNrLmhpZGUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICghdGhpcy5kcmFnTWFzay5nZXREb20oKSkgew0KICAgICAgICAgICAgICAgIHRoaXMuZHJhZ01hc2sucmVuZGVyKCk7DQogICAgICAgICAgICAgICAgdGhpcy5kcmFnTWFzay5oaWRlKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzOw0KICAgICAgICAgICAgdGhpcy5hZGRMaXN0ZW5lcignc2hvdycsIGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgICAgIG1lLm1vZGFsTWFzay5zaG93KHRoaXMuZ2V0RG9tKCkuc3R5bGUuekluZGV4IC0gMik7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIHRoaXMuYWRkTGlzdGVuZXIoJ2hpZGUnLCBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgICAgICBtZS5tb2RhbE1hc2suaGlkZSgpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICBpZiAodGhpcy5idXR0b25zKSB7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgaT0wOyBpPHRoaXMuYnV0dG9ucy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmJ1dHRvbnNbaV0ucG9zdFJlbmRlcigpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGRvbVV0aWxzLm9uKHdpbmRvdywgJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCl7DQogICAgICAgICAgICAgICAgICAgIGlmICghbWUuaXNIaWRkZW4oKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuc2FmZVNldE9mZnNldCh1aVV0aWxzLmdldENsaWVudFJlY3QobWUuZ2V0RG9tKCkpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIC8vaG9sZOS9j3Njcm9sbOS6i+S7tu+8jOmYsuatomRpYWxvZ+eahOa7muWKqOW9seWTjemhtemdog0KICAgICAgICAgICAgaWYoIHRoaXMuaG9sZFNjcm9sbCApIHsNCg0KICAgICAgICAgICAgICAgIGlmKCAhbWUuaWZyYW1lVXJsICkgew0KICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5vbiggZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIG1lLmlkICsgIl9pZnJhbWUiKSwgIWJyb3dzZXIuZ2Vja28gPyAibW91c2V3aGVlbCIgOiAiRE9NTW91c2VTY3JvbGwiLCBmdW5jdGlvbihlKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnByZXZlbnREZWZhdWx0KGUpOw0KICAgICAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgbWUuYWRkTGlzdGVuZXIoJ2RpYWxvZ2FmdGVycmVzZXQnLCBmdW5jdGlvbigpew0KICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWZyYW1lV2luZG93ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIG1lLmlkICsgIl9pZnJhbWUiKS5jb250ZW50V2luZG93Ow0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIGJyb3dzZXIuaWUgKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRpbWVyID0gd2luZG93LnNldEludGVydmFsKGZ1bmN0aW9uKCl7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBpZnJhbWVXaW5kb3cuZG9jdW1lbnQgJiYgaWZyYW1lV2luZG93LmRvY3VtZW50LmJvZHkgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwoIHRpbWVyICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZXIgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLm9uKCBpZnJhbWVXaW5kb3cuZG9jdW1lbnQuYm9keSwgIWJyb3dzZXIuZ2Vja28gPyAibW91c2V3aGVlbCIgOiAiRE9NTW91c2VTY3JvbGwiLCBmdW5jdGlvbihlKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucHJldmVudERlZmF1bHQoZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy5vbiggaWZyYW1lV2luZG93LCAhYnJvd3Nlci5nZWNrbyA/ICJtb3VzZXdoZWVsIiA6ICJET01Nb3VzZVNjcm9sbCIsIGZ1bmN0aW9uKGUpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucHJldmVudERlZmF1bHQoZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEpOw0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuX2hpZGUoKTsNCiAgICAgICAgfSwNCiAgICAgICAgbWVzdXJlU2l6ZTogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICB2YXIgYm9keSA9IHRoaXMuZ2V0RG9tKCdib2R5Jyk7DQogICAgICAgICAgICB2YXIgd2lkdGggPSB1aVV0aWxzLmdldENsaWVudFJlY3QodGhpcy5nZXREb20oJ2NvbnRlbnQnKSkud2lkdGg7DQogICAgICAgICAgICB2YXIgZGlhbG9nQm9keVN0eWxlID0gYm9keS5zdHlsZTsNCiAgICAgICAgICAgIGRpYWxvZ0JvZHlTdHlsZS53aWR0aCA9IHdpZHRoOw0KICAgICAgICAgICAgcmV0dXJuIHVpVXRpbHMuZ2V0Q2xpZW50UmVjdChib2R5KTsNCiAgICAgICAgfSwNCiAgICAgICAgX29uVGl0bGViYXJNb3VzZURvd246IGZ1bmN0aW9uIChldnQsIGVsKXsNCiAgICAgICAgICAgIGlmICh0aGlzLmRyYWdnYWJsZSkgew0KICAgICAgICAgICAgICAgIHZhciByZWN0Ow0KICAgICAgICAgICAgICAgIHZhciB2cFJlY3QgPSB1aVV0aWxzLmdldFZpZXdwb3J0UmVjdCgpOw0KICAgICAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7DQogICAgICAgICAgICAgICAgdWlVdGlscy5zdGFydERyYWcoZXZ0LCB7DQogICAgICAgICAgICAgICAgICAgIG9uZHJhZ3N0YXJ0OiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlY3QgPSB1aVV0aWxzLmdldENsaWVudFJlY3QobWUuZ2V0RG9tKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuZ2V0RG9tKCdjb250bWFzaycpLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7DQogICAgICAgICAgICAgICAgICAgICAgICBtZS5kcmFnTWFzay5zaG93KG1lLmdldERvbSgpLnN0eWxlLnpJbmRleCAtIDEpOw0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICBvbmRyYWdtb3ZlOiBmdW5jdGlvbiAoeCwgeSl7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGVmdCA9IHJlY3QubGVmdCArIHg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9wID0gcmVjdC50b3AgKyB5Ow0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuc2FmZVNldE9mZnNldCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogbGVmdCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6IHRvcA0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIG9uZHJhZ3N0b3A6IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuZ2V0RG9tKCdjb250bWFzaycpLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZUNsYXNzZXMobWUuZ2V0RG9tKCksIFsnZWR1aS1zdGF0ZS1jZW50ZXJlZCddKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lLmRyYWdNYXNrLmhpZGUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICByZXNldDogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICB0aGlzLmdldERvbSgnY29udGVudCcpLmlubmVySFRNTCA9IHRoaXMuZ2V0Q29udGVudEh0bWwoKTsNCiAgICAgICAgICAgIHRoaXMuZmlyZUV2ZW50KCdkaWFsb2dhZnRlcnJlc2V0Jyk7DQogICAgICAgIH0sDQogICAgICAgIF9zaG93OiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIGlmICh0aGlzLl9oaWRkZW4pIHsNCiAgICAgICAgICAgICAgICB0aGlzLmdldERvbSgpLnN0eWxlLmRpc3BsYXkgPSAnJzsNCg0KICAgICAgICAgICAgICAgIC8v6KaB6auY6L+H57yW6L6R5Zmo55qEemluZHhlDQogICAgICAgICAgICAgICAgdGhpcy5lZGl0b3IuY29udGFpbmVyLnN0eWxlLnpJbmRleCAmJiAodGhpcy5nZXREb20oKS5zdHlsZS56SW5kZXggPSB0aGlzLmVkaXRvci5jb250YWluZXIuc3R5bGUuekluZGV4ICogMSArIDEwKTsNCiAgICAgICAgICAgICAgICB0aGlzLl9oaWRkZW4gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICB0aGlzLmZpcmVFdmVudCgnc2hvdycpOw0KICAgICAgICAgICAgICAgIGJhaWR1LmVkaXRvci51aS51aVV0aWxzLmdldEZpeGVkTGF5ZXIoKS5zdHlsZS56SW5kZXggPSB0aGlzLmdldERvbSgpLnN0eWxlLnpJbmRleCAtIDQ7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGlzSGlkZGVuOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLl9oaWRkZW47DQogICAgICAgIH0sDQogICAgICAgIF9oaWRlOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIGlmICghdGhpcy5faGlkZGVuKSB7DQogICAgICAgICAgICAgICAgdGhpcy5nZXREb20oKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICAgIHRoaXMuZ2V0RG9tKCkuc3R5bGUuekluZGV4ID0gJyc7DQogICAgICAgICAgICAgICAgdGhpcy5faGlkZGVuID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICB0aGlzLmZpcmVFdmVudCgnaGlkZScpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBvcGVuOiBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgIGlmICh0aGlzLmF1dG9SZXNldCkgew0KICAgICAgICAgICAgICAgIC8v5pyJ5Y+v6IO96L+Y5rKh5pyJ5riy5p+TDQogICAgICAgICAgICAgICAgdHJ5ew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2V0KCk7DQogICAgICAgICAgICAgICAgfWNhdGNoKGUpew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcigpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9wZW4oKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuc2hvd0F0Q2VudGVyKCk7DQogICAgICAgICAgICBpZiAodGhpcy5pZnJhbWVVcmwpIHsNCiAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmdldERvbSgnaWZyYW1lJykuZm9jdXMoKTsNCiAgICAgICAgICAgICAgICB9IGNhdGNoKGV4KXt9DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIF9vbkNsb3NlQnV0dG9uQ2xpY2s6IGZ1bmN0aW9uIChldnQsIGVsKXsNCiAgICAgICAgICAgIHRoaXMuY2xvc2UoZmFsc2UpOw0KICAgICAgICB9LA0KICAgICAgICBjbG9zZTogZnVuY3Rpb24gKG9rKXsNCiAgICAgICAgICAgIGlmICh0aGlzLmZpcmVFdmVudCgnY2xvc2UnLCBvaykgIT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgdGhpcy5faGlkZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfTsNCiAgICB1dGlscy5pbmhlcml0cyhEaWFsb2csIFVJQmFzZSk7DQp9KSgpOw0KCi8vL2ltcG9ydCBjb3JlDQovLy9pbXBvcnQgdWljb3JlDQovLy9pbXBvcnQgdWkvbWVudS5qcw0KLy8vaW1wb3J0IHVpL3NwbGl0YnV0dG9uLmpzDQooZnVuY3Rpb24gKCl7DQogICAgdmFyIHV0aWxzID0gYmFpZHUuZWRpdG9yLnV0aWxzLA0KICAgICAgICBNZW51ID0gYmFpZHUuZWRpdG9yLnVpLk1lbnUsDQogICAgICAgIFNwbGl0QnV0dG9uID0gYmFpZHUuZWRpdG9yLnVpLlNwbGl0QnV0dG9uLA0KICAgICAgICBNZW51QnV0dG9uID0gYmFpZHUuZWRpdG9yLnVpLk1lbnVCdXR0b24gPSBmdW5jdGlvbiAob3B0aW9ucyl7DQogICAgICAgICAgICB0aGlzLmluaXRPcHRpb25zKG9wdGlvbnMpOw0KICAgICAgICAgICAgdGhpcy5pbml0TWVudUJ1dHRvbigpOw0KICAgICAgICB9Ow0KICAgIE1lbnVCdXR0b24ucHJvdG90eXBlID0gew0KICAgICAgICBpbml0TWVudUJ1dHRvbjogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzOw0KICAgICAgICAgICAgdGhpcy51aU5hbWUgPSAibWVudWJ1dHRvbiI7DQogICAgICAgICAgICB0aGlzLnBvcHVwID0gbmV3IE1lbnUoew0KICAgICAgICAgICAgICAgIGl0ZW1zOiBtZS5pdGVtcywNCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IG1lLmNsYXNzTmFtZSwNCiAgICAgICAgICAgICAgICBlZGl0b3I6bWUuZWRpdG9yDQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIHRoaXMucG9wdXAuYWRkTGlzdGVuZXIoJ3Nob3cnLCBmdW5jdGlvbiAoKXsNCiAgICAgICAgICAgICAgICB2YXIgbGlzdCA9IHRoaXM7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgaT0wOyBpPGxpc3QuaXRlbXMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgbGlzdC5pdGVtc1tpXS5yZW1vdmVTdGF0ZSgnY2hlY2tlZCcpOw0KICAgICAgICAgICAgICAgICAgICBpZiAobGlzdC5pdGVtc1tpXS52YWx1ZSA9PSBtZS5fdmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QuaXRlbXNbaV0uYWRkU3RhdGUoJ2NoZWNrZWQnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSBtZS5fdmFsdWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIHRoaXMuaW5pdFNwbGl0QnV0dG9uKCk7DQogICAgICAgIH0sDQogICAgICAgIHNldFZhbHVlIDogZnVuY3Rpb24odmFsdWUpew0KICAgICAgICAgICAgdGhpcy5fdmFsdWUgPSB2YWx1ZTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICB9Ow0KICAgIHV0aWxzLmluaGVyaXRzKE1lbnVCdXR0b24sIFNwbGl0QnV0dG9uKTsNCn0pKCk7Ci8vdWnot5/nvJbovpHlmajnmoTpgILphY3lsaQNCi8v6YKj5Liq5oyJ6ZKu5by55Ye65pivZGlhbG9n77yM5piv5LiL5ouJ562Q562J6YO95piv5Zyo6L+Z5LiqanPkuK3phY3nva4NCi8v6Ieq5bex5YaZ55qEdWnkuZ/opoHlnKjov5nph4zphY3nva7vvIzmlL7liLBiYWlkdS5lZGl0b3IudWnkuIvovrnvvIzlvZPnvJbovpHlmajlrp7kvovljJbnmoTml7blgJnkvJrmoLnmja51ZWRpdG9yLmNvbmZpZ+S4reeahHRvb2xiYXJz5om+5Yiw55u45bqU55qE6L+b6KGM5a6e5L6L5YyWDQooZnVuY3Rpb24gKCkgew0KICAgIHZhciB1dGlscyA9IGJhaWR1LmVkaXRvci51dGlsczsNCiAgICB2YXIgZWRpdG9ydWkgPSBiYWlkdS5lZGl0b3IudWk7DQogICAgdmFyIF9EaWFsb2cgPSBlZGl0b3J1aS5EaWFsb2c7DQogICAgZWRpdG9ydWkuYnV0dG9ucyA9IHt9Ow0KDQogICAgZWRpdG9ydWkuRGlhbG9nID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsNCiAgICAgICAgdmFyIGRpYWxvZyA9IG5ldyBfRGlhbG9nKG9wdGlvbnMpOw0KICAgICAgICBkaWFsb2cuYWRkTGlzdGVuZXIoJ2hpZGUnLCBmdW5jdGlvbiAoKSB7DQoNCiAgICAgICAgICAgIGlmIChkaWFsb2cuZWRpdG9yKSB7DQogICAgICAgICAgICAgICAgdmFyIGVkaXRvciA9IGRpYWxvZy5lZGl0b3I7DQogICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGJyb3dzZXIuZ2Vja28pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB5ID0gZWRpdG9yLndpbmRvdy5zY3JvbGxZLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHggPSBlZGl0b3Iud2luZG93LnNjcm9sbFg7DQogICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3IuYm9keS5mb2N1cygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLndpbmRvdy5zY3JvbGxUbyh4LCB5KTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5mb2N1cygpOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGV4KSB7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIGRpYWxvZzsNCiAgICB9Ow0KDQogICAgdmFyIGlmcmFtZVVybE1hcCA9IHsNCiAgICAgICAgJ2FuY2hvcic6J34vZGlhbG9ncy9hbmNob3IvYW5jaG9yLmFzcCcsDQogICAgICAgICdpbnNlcnRpbWFnZSc6J34vZGlhbG9ncy9pbWFnZS9pbWFnZS5hc3AnLA0KICAgICAgICAnbGluayc6J34vZGlhbG9ncy9saW5rL2xpbmsuYXNwJywNCiAgICAgICAgJ3NwZWNoYXJzJzonfi9kaWFsb2dzL3NwZWNoYXJzL3NwZWNoYXJzLmFzcCcsDQogICAgICAgICdzZWFyY2hyZXBsYWNlJzonfi9kaWFsb2dzL3NlYXJjaHJlcGxhY2Uvc2VhcmNocmVwbGFjZS5hc3AnLA0KICAgICAgICAnbWFwJzonfi9kaWFsb2dzL21hcC9tYXAuYXNwJywNCiAgICAgICAgJ2dtYXAnOid+L2RpYWxvZ3MvZ21hcC9nbWFwLmFzcCcsDQogICAgICAgICdpbnNlcnR2aWRlbyc6J34vZGlhbG9ncy92aWRlby92aWRlby5hc3AnLA0KICAgICAgICAnaGVscCc6J34vZGlhbG9ncy9oZWxwL2hlbHAuYXNwJywNCiAgICAgICAvLydoaWdobGlnaHRjb2RlJzonfi9kaWFsb2dzL2hpZ2hsaWdodGNvZGUvaGlnaGxpZ2h0Y29kZS5hc3AnLA0KICAgICAgICAnZW1vdGlvbic6J34vZGlhbG9ncy9lbW90aW9uL2Vtb3Rpb24uYXNwJywNCiAgICAgICAgJ3dvcmRpbWFnZSc6J34vZGlhbG9ncy93b3JkaW1hZ2Uvd29yZGltYWdlLmFzcCcsDQogICAgICAgICdhdHRhY2htZW50Jzonfi9kaWFsb2dzL2F0dGFjaG1lbnQvYXR0YWNobWVudC5hc3AnLA0KICAgICAgICAnaW5zZXJ0ZnJhbWUnOid+L2RpYWxvZ3MvaW5zZXJ0ZnJhbWUvaW5zZXJ0ZnJhbWUuYXNwJywNCiAgICAgICAgJ2VkaXR0aXAnOid+L2RpYWxvZ3MvdGFibGUvZWRpdHRpcC5hc3AnLA0KICAgICAgICAnZWRpdHRhYmxlJzonfi9kaWFsb2dzL3RhYmxlL2VkaXR0YWJsZS5hc3AnLA0KICAgICAgICAnZWRpdHRkJzonfi9kaWFsb2dzL3RhYmxlL2VkaXR0ZC5hc3AnLA0KICAgICAgICAnd2ViYXBwJzonfi9kaWFsb2dzL3dlYmFwcC93ZWJhcHAuYXNwJywNCiAgICAgICAgJ3NuYXBzY3JlZW4nOid+L2RpYWxvZ3Mvc25hcHNjcmVlbi9zbmFwc2NyZWVuLmFzcCcsDQogICAgICAgICdzY3Jhd2wnOid+L2RpYWxvZ3Mvc2NyYXdsL3NjcmF3bC5hc3AnLA0KICAgICAgICAnbXVzaWMnOid+L2RpYWxvZ3MvbXVzaWMvbXVzaWMuYXNwJywNCiAgICAgICAgJ3RlbXBsYXRlJzonfi9kaWFsb2dzL3RlbXBsYXRlL3RlbXBsYXRlLmFzcCcsDQogICAgICAgICdiYWNrZ3JvdW5kJzonfi9kaWFsb2dzL2JhY2tncm91bmQvYmFja2dyb3VuZC5hc3AnDQogICAgfTsNCiAgICAvL+S4uuW3peWFt+agj+a3u+WKoOaMiemSru+8jOS7peS4i+mDveaYr+e7n+S4gOeahOaMiemSruinpuWPkeWRveS7pO+8jOaJgOS7peWGmeWcqOS4gOi1tw0KICAgIHZhciBidG5DbWRzID0gWyd1bmRvJywgJ3JlZG8nLCAnZm9ybWF0bWF0Y2gnLA0KICAgICAgICAnYm9sZCcsICdpdGFsaWMnLCAndW5kZXJsaW5lJywgJ2ZvbnRib3JkZXInLCAndG91cHBlcmNhc2UnLCAndG9sb3dlcmNhc2UnLA0KICAgICAgICAnc3RyaWtldGhyb3VnaCcsICdzdWJzY3JpcHQnLCAnc3VwZXJzY3JpcHQnLCAnc291cmNlJywgJ2luZGVudCcsICdvdXRkZW50JywNCiAgICAgICAgJ2Jsb2NrcXVvdGUnLCAncGFzdGVwbGFpbicsICdwYWdlYnJlYWsnLA0KICAgICAgICAnc2VsZWN0YWxsJywgJ3ByaW50JywgJ3ByZXZpZXcnLCAnaG9yaXpvbnRhbCcsICdyZW1vdmVmb3JtYXQnLCAndGltZScsICdkYXRlJywgJ3VubGluaycsDQogICAgICAgICdpbnNlcnRwYXJhZ3JhcGhiZWZvcmV0YWJsZScsICdpbnNlcnRyb3cnLCAnaW5zZXJ0Y29sJywgJ21lcmdlcmlnaHQnLCAnbWVyZ2Vkb3duJywgJ2RlbGV0ZXJvdycsDQogICAgICAgICdkZWxldGVjb2wnLCAnc3BsaXR0b3Jvd3MnLCAnc3BsaXR0b2NvbHMnLCAnc3BsaXR0b2NlbGxzJywgJ21lcmdlY2VsbHMnLCAnZGVsZXRldGFibGUnXTsNCg0KICAgIGZvciAodmFyIGkgPSAwLCBjaTsgY2kgPSBidG5DbWRzW2krK107KSB7DQogICAgICAgIGNpID0gY2kudG9Mb3dlckNhc2UoKTsNCiAgICAgICAgZWRpdG9ydWlbY2ldID0gZnVuY3Rpb24gKGNtZCkgew0KICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChlZGl0b3IpIHsNCiAgICAgICAgICAgICAgICB2YXIgdWkgPSBuZXcgZWRpdG9ydWkuQnV0dG9uKHsNCiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOidlZHVpLWZvci0nICsgY21kLA0KICAgICAgICAgICAgICAgICAgICB0aXRsZTplZGl0b3Iub3B0aW9ucy5sYWJlbE1hcFtjbWRdIHx8IGVkaXRvci5nZXRMYW5nKCJsYWJlbE1hcC4iICsgY21kKSB8fCAnJywNCiAgICAgICAgICAgICAgICAgICAgb25jbGljazpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3IuZXhlY0NvbW1hbmQoY21kKTsNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgdGhlbWU6ZWRpdG9yLm9wdGlvbnMudGhlbWUsDQogICAgICAgICAgICAgICAgICAgIHNob3dUZXh0OmZhbHNlDQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgZWRpdG9ydWkuYnV0dG9uc1tjbWRdID0gdWk7DQogICAgICAgICAgICAgICAgZWRpdG9yLmFkZExpc3RlbmVyKCdzZWxlY3Rpb25jaGFuZ2UnLCBmdW5jdGlvbiAodHlwZSwgY2F1c2VCeVVpLCB1aVJlYWR5KSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGVkaXRvci5xdWVyeUNvbW1hbmRTdGF0ZShjbWQpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUgPT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldERpc2FibGVkKHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0Q2hlY2tlZChmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXVpUmVhZHkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXREaXNhYmxlZChmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0Q2hlY2tlZChzdGF0ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICByZXR1cm4gdWk7DQogICAgICAgICAgICB9Ow0KICAgICAgICB9KGNpKTsNCiAgICB9DQoNCiAgICAvL+a4hemZpOaWh+ahow0KICAgIGVkaXRvcnVpLmNsZWFyZG9jID0gZnVuY3Rpb24gKGVkaXRvcikgew0KICAgICAgICB2YXIgdWkgPSBuZXcgZWRpdG9ydWkuQnV0dG9uKHsNCiAgICAgICAgICAgIGNsYXNzTmFtZTonZWR1aS1mb3ItY2xlYXJkb2MnLA0KICAgICAgICAgICAgdGl0bGU6ZWRpdG9yLm9wdGlvbnMubGFiZWxNYXAuY2xlYXJkb2MgfHwgZWRpdG9yLmdldExhbmcoImxhYmVsTWFwLmNsZWFyZG9jIikgfHwgJycsDQogICAgICAgICAgICB0aGVtZTplZGl0b3Iub3B0aW9ucy50aGVtZSwNCiAgICAgICAgICAgIG9uY2xpY2s6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIGlmIChjb25maXJtKGVkaXRvci5nZXRMYW5nKCJjb25maXJtQ2xlYXIiKSkpIHsNCiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmV4ZWNDb21tYW5kKCdjbGVhcmRvYycpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICAgIGVkaXRvcnVpLmJ1dHRvbnNbImNsZWFyZG9jIl0gPSB1aTsNCiAgICAgICAgZWRpdG9yLmFkZExpc3RlbmVyKCdzZWxlY3Rpb25jaGFuZ2UnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB1aS5zZXREaXNhYmxlZChlZGl0b3IucXVlcnlDb21tYW5kU3RhdGUoJ2NsZWFyZG9jJykgPT0gLTEpOw0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIHVpOw0KICAgIH07DQoNCiAgICAvL+aOkueJiO+8jOWbvueJh+aOkueJiO+8jOaWh+Wtl+aWueWQkQ0KICAgIHZhciB0eXBlc2V0ID0gew0KICAgICAgICAnanVzdGlmeSc6WydsZWZ0JywgJ3JpZ2h0JywgJ2NlbnRlcicsICdqdXN0aWZ5J10sDQogICAgICAgICdpbWFnZWZsb2F0JzpbJ25vbmUnLCAnbGVmdCcsICdjZW50ZXInLCAncmlnaHQnXSwNCiAgICAgICAgJ2RpcmVjdGlvbmFsaXR5JzpbJ2x0cicsICdydGwnXQ0KICAgIH07DQoNCiAgICBmb3IgKHZhciBwIGluIHR5cGVzZXQpIHsNCg0KICAgICAgICAoZnVuY3Rpb24gKGNtZCwgdmFsKSB7DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgY2k7IGNpID0gdmFsW2krK107KSB7DQogICAgICAgICAgICAgICAgKGZ1bmN0aW9uIChjbWQyKSB7DQogICAgICAgICAgICAgICAgICAgIGVkaXRvcnVpW2NtZC5yZXBsYWNlKCdmbG9hdCcsICcnKSArIGNtZDJdID0gZnVuY3Rpb24gKGVkaXRvcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVpID0gbmV3IGVkaXRvcnVpLkJ1dHRvbih7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOidlZHVpLWZvci0nICsgY21kLnJlcGxhY2UoJ2Zsb2F0JywgJycpICsgY21kMiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTplZGl0b3Iub3B0aW9ucy5sYWJlbE1hcFtjbWQucmVwbGFjZSgnZmxvYXQnLCAnJykgKyBjbWQyXSB8fCBlZGl0b3IuZ2V0TGFuZygibGFiZWxNYXAuIiArIGNtZC5yZXBsYWNlKCdmbG9hdCcsICcnKSArIGNtZDIpIHx8ICcnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW1lOmVkaXRvci5vcHRpb25zLnRoZW1lLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uY2xpY2s6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3IuZXhlY0NvbW1hbmQoY21kLCBjbWQyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvcnVpLmJ1dHRvbnNbY21kXSA9IHVpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmFkZExpc3RlbmVyKCdzZWxlY3Rpb25jaGFuZ2UnLCBmdW5jdGlvbiAodHlwZSwgY2F1c2VCeVVpLCB1aVJlYWR5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0RGlzYWJsZWQoZWRpdG9yLnF1ZXJ5Q29tbWFuZFN0YXRlKGNtZCkgPT0gLTEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldENoZWNrZWQoZWRpdG9yLnF1ZXJ5Q29tbWFuZFZhbHVlKGNtZCkgPT0gY21kMiAmJiAhdWlSZWFkeSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1aTsNCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICB9KShjaSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSkocCwgdHlwZXNldFtwXSkNCiAgICB9DQoNCiAgICAvL+Wtl+S9k+minOiJsuWSjOiDjOaZr+minOiJsg0KICAgIGZvciAodmFyIGkgPSAwLCBjaTsgY2kgPSBbJ2JhY2tjb2xvcicsICdmb3JlY29sb3InXVtpKytdOykgew0KICAgICAgICBlZGl0b3J1aVtjaV0gPSBmdW5jdGlvbiAoY21kKSB7DQogICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGVkaXRvcikgew0KICAgICAgICAgICAgICAgIHZhciB1aSA9IG5ldyBlZGl0b3J1aS5Db2xvckJ1dHRvbih7DQogICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTonZWR1aS1mb3ItJyArIGNtZCwNCiAgICAgICAgICAgICAgICAgICAgY29sb3I6J2RlZmF1bHQnLA0KICAgICAgICAgICAgICAgICAgICB0aXRsZTplZGl0b3Iub3B0aW9ucy5sYWJlbE1hcFtjbWRdIHx8IGVkaXRvci5nZXRMYW5nKCJsYWJlbE1hcC4iICsgY21kKSB8fCAnJywNCiAgICAgICAgICAgICAgICAgICAgZWRpdG9yOmVkaXRvciwNCiAgICAgICAgICAgICAgICAgICAgb25waWNrY29sb3I6ZnVuY3Rpb24gKHQsIGNvbG9yKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3IuZXhlY0NvbW1hbmQoY21kLCBjb2xvcik7DQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIG9ucGlja25vY29sb3I6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmV4ZWNDb21tYW5kKGNtZCwgJ2RlZmF1bHQnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0Q29sb3IoJ3RyYW5zcGFyZW50Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbG9yID0gJ2RlZmF1bHQnOw0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICBvbmJ1dHRvbmNsaWNrOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5leGVjQ29tbWFuZChjbWQsIHRoaXMuY29sb3IpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgZWRpdG9ydWkuYnV0dG9uc1tjbWRdID0gdWk7DQogICAgICAgICAgICAgICAgZWRpdG9yLmFkZExpc3RlbmVyKCdzZWxlY3Rpb25jaGFuZ2UnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgIHVpLnNldERpc2FibGVkKGVkaXRvci5xdWVyeUNvbW1hbmRTdGF0ZShjbWQpID09IC0xKTsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICByZXR1cm4gdWk7DQogICAgICAgICAgICB9Ow0KICAgICAgICB9KGNpKTsNCiAgICB9DQoNCg0KICAgIHZhciBkaWFsb2dCdG5zID0gew0KICAgICAgICBub09rOlsnc2VhcmNocmVwbGFjZScsICdoZWxwJywgJ3NwZWNoYXJzJywgJ3dlYmFwcCddLA0KICAgICAgICBvazpbJ2F0dGFjaG1lbnQnLCAnYW5jaG9yJywgJ2xpbmsnLCAnaW5zZXJ0aW1hZ2UnLCAnbWFwJywgJ2dtYXAnLCAnaW5zZXJ0ZnJhbWUnLCAnd29yZGltYWdlJywNCiAgICAgICAgICAgICdpbnNlcnR2aWRlbycsICdpbnNlcnRmcmFtZScsICdlZGl0dGlwJywgJ2VkaXR0YWJsZScsICdlZGl0dGQnLCAnc2NyYXdsJywgJ3RlbXBsYXRlJywgJ211c2ljJywgJ2JhY2tncm91bmQnXQ0KDQogICAgfTsNCg0KICAgIGZvciAodmFyIHAgaW4gZGlhbG9nQnRucykgew0KICAgICAgICAoZnVuY3Rpb24gKHR5cGUsIHZhbHMpIHsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjaTsgY2kgPSB2YWxzW2krK107KSB7DQogICAgICAgICAgICAgICAgLy90b2RvIG9wZXJh5LiL5a2Y5Zyo6Zeu6aKYDQogICAgICAgICAgICAgICAgaWYgKGJyb3dzZXIub3BlcmEgJiYgY2kgPT09ICJzZWFyY2hyZXBsYWNlIikgew0KICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgKGZ1bmN0aW9uIChjbWQpIHsNCiAgICAgICAgICAgICAgICAgICAgZWRpdG9ydWlbY21kXSA9IGZ1bmN0aW9uIChlZGl0b3IsIGlmcmFtZVVybCwgdGl0bGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmcmFtZVVybCA9IGlmcmFtZVVybCB8fCAoZWRpdG9yLm9wdGlvbnMuaWZyYW1lVXJsTWFwIHx8IHt9KVtjbWRdIHx8IGlmcmFtZVVybE1hcFtjbWRdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGUgPSBlZGl0b3Iub3B0aW9ucy5sYWJlbE1hcFtjbWRdIHx8IGVkaXRvci5nZXRMYW5nKCJsYWJlbE1hcC4iICsgY21kKSB8fCAnJzsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpYWxvZzsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8v5rKh5pyJaWZyYW1lVXJs5LiN5Yib5bu6ZGlhbG9nDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWZyYW1lVXJsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlhbG9nID0gbmV3IGVkaXRvcnVpLkRpYWxvZyh1dGlscy5leHRlbmQoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZnJhbWVVcmw6ZWRpdG9yLnVpLm1hcFVybChpZnJhbWVVcmwpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3I6ZWRpdG9yLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6J2VkdWktZm9yLScgKyBjbWQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOnRpdGxlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2xkU2Nyb2xsOiBjbWQgPT09ICdpbnNlcnRpbWFnZScsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlRGlhbG9nOmVkaXRvci5nZXRMYW5nKCJjbG9zZURpYWxvZyIpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgdHlwZSA9PSAnb2snID8gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b25zOlsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6J2VkdWktb2tidXR0b24nLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOmVkaXRvci5nZXRMYW5nKCJvayIpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvcjplZGl0b3IsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25jbGljazpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpYWxvZy5jbG9zZSh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTonZWR1aS1jYW5jZWxidXR0b24nLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOmVkaXRvci5nZXRMYW5nKCJjYW5jZWwiKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3I6ZWRpdG9yLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uY2xpY2s6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWFsb2cuY2xvc2UoZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gOiB7fSkpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnVpLl9kaWFsb2dzW2NtZCArICJEaWFsb2ciXSA9IGRpYWxvZzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVpID0gbmV3IGVkaXRvcnVpLkJ1dHRvbih7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOidlZHVpLWZvci0nICsgY21kLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOnRpdGxlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uY2xpY2s6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGlhbG9nKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGNtZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIndvcmRpbWFnZSI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5leGVjQ29tbWFuZCgid29yZGltYWdlIiwgIndvcmRfaW1nIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlZGl0b3Iud29yZF9pbWcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpYWxvZy5yZW5kZXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpYWxvZy5vcGVuKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAic2NyYXdsIjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVkaXRvci5xdWVyeUNvbW1hbmRTdGF0ZSgic2NyYXdsIikgIT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpYWxvZy5yZW5kZXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpYWxvZy5vcGVuKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWFsb2cucmVuZGVyKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpYWxvZy5vcGVuKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW1lOmVkaXRvci5vcHRpb25zLnRoZW1lLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkOmNtZCA9PSAnc2NyYXdsJyAmJiBlZGl0b3IucXVlcnlDb21tYW5kU3RhdGUoInNjcmF3bCIpID09IC0xDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvcnVpLmJ1dHRvbnNbY21kXSA9IHVpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmFkZExpc3RlbmVyKCdzZWxlY3Rpb25jaGFuZ2UnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/lj6rlrZjlnKjkuo7lj7PplK7oj5zljZXogIzml6Dlt6XlhbfmoI/mjInpkq7nmoR1aeS4jemcgOimgeajgOa1i+eKtuaAgQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1bk5lZWRDaGVja1N0YXRlID0geydlZGl0dGFibGUnOjF9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjbWQgaW4gdW5OZWVkQ2hlY2tTdGF0ZSlyZXR1cm47DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBlZGl0b3IucXVlcnlDb21tYW5kU3RhdGUoY21kKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodWkuZ2V0RG9tKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0RGlzYWJsZWQoc3RhdGUgPT0gLTEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXRDaGVja2VkKHN0YXRlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdWk7DQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgfSkoY2kudG9Mb3dlckNhc2UoKSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSkocCwgZGlhbG9nQnRuc1twXSkNCiAgICB9DQoNCiAgICBlZGl0b3J1aS5zbmFwc2NyZWVuID0gZnVuY3Rpb24gKGVkaXRvciwgaWZyYW1lVXJsLCB0aXRsZSkgew0KICAgICAgICB0aXRsZSA9IGVkaXRvci5vcHRpb25zLmxhYmVsTWFwWydzbmFwc2NyZWVuJ10gfHwgZWRpdG9yLmdldExhbmcoImxhYmVsTWFwLnNuYXBzY3JlZW4iKSB8fCAnJzsNCiAgICAgICAgdmFyIHVpID0gbmV3IGVkaXRvcnVpLkJ1dHRvbih7DQogICAgICAgICAgICBjbGFzc05hbWU6J2VkdWktZm9yLXNuYXBzY3JlZW4nLA0KICAgICAgICAgICAgdGl0bGU6dGl0bGUsDQogICAgICAgICAgICBvbmNsaWNrOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICBlZGl0b3IuZXhlY0NvbW1hbmQoInNuYXBzY3JlZW4iKTsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB0aGVtZTplZGl0b3Iub3B0aW9ucy50aGVtZQ0KDQogICAgICAgIH0pOw0KICAgICAgICBlZGl0b3J1aS5idXR0b25zWydzbmFwc2NyZWVuJ10gPSB1aTsNCiAgICAgICAgaWZyYW1lVXJsID0gaWZyYW1lVXJsIHx8IChlZGl0b3Iub3B0aW9ucy5pZnJhbWVVcmxNYXAgfHwge30pWyJzbmFwc2NyZWVuIl0gfHwgaWZyYW1lVXJsTWFwWyJzbmFwc2NyZWVuIl07DQogICAgICAgIGlmIChpZnJhbWVVcmwpIHsNCiAgICAgICAgICAgIHZhciBkaWFsb2cgPSBuZXcgZWRpdG9ydWkuRGlhbG9nKHsNCiAgICAgICAgICAgICAgICBpZnJhbWVVcmw6ZWRpdG9yLnVpLm1hcFVybChpZnJhbWVVcmwpLA0KICAgICAgICAgICAgICAgIGVkaXRvcjplZGl0b3IsDQogICAgICAgICAgICAgICAgY2xhc3NOYW1lOidlZHVpLWZvci1zbmFwc2NyZWVuJywNCiAgICAgICAgICAgICAgICB0aXRsZTp0aXRsZSwNCiAgICAgICAgICAgICAgICBidXR0b25zOlsNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOidlZHVpLW9rYnV0dG9uJywNCiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOmVkaXRvci5nZXRMYW5nKCJvayIpLA0KICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yOmVkaXRvciwNCiAgICAgICAgICAgICAgICAgICAgICAgIG9uY2xpY2s6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpYWxvZy5jbG9zZSh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOidlZHVpLWNhbmNlbGJ1dHRvbicsDQogICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDplZGl0b3IuZ2V0TGFuZygiY2FuY2VsIiksDQogICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3I6ZWRpdG9yLA0KICAgICAgICAgICAgICAgICAgICAgICAgb25jbGljazpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlhbG9nLmNsb3NlKGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIF0NCg0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICBkaWFsb2cucmVuZGVyKCk7DQogICAgICAgICAgICBlZGl0b3IudWkuX2RpYWxvZ3NbInNuYXBzY3JlZW5EaWFsb2ciXSA9IGRpYWxvZzsNCiAgICAgICAgfQ0KICAgICAgICBlZGl0b3IuYWRkTGlzdGVuZXIoJ3NlbGVjdGlvbmNoYW5nZScsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHVpLnNldERpc2FibGVkKGVkaXRvci5xdWVyeUNvbW1hbmRTdGF0ZSgnc25hcHNjcmVlbicpID09IC0xKTsNCiAgICAgICAgfSk7DQogICAgICAgIHJldHVybiB1aTsNCiAgICB9Ow0KDQogICAgZWRpdG9ydWkuaW5zZXJ0Y29kZSA9IGZ1bmN0aW9uIChlZGl0b3IsIGxpc3QsIHRpdGxlKSB7DQogICAgICAgIGxpc3QgPSBlZGl0b3Iub3B0aW9uc1snaW5zZXJ0Y29kZSddIHx8IFtdOw0KICAgICAgICB0aXRsZSA9IGVkaXRvci5vcHRpb25zLmxhYmVsTWFwWydpbnNlcnRjb2RlJ10gfHwgZWRpdG9yLmdldExhbmcoImxhYmVsTWFwLmluc2VydGNvZGUiKSB8fCAnJzsNCiAgICAgICAvLyBpZiAoIWxpc3QubGVuZ3RoKSByZXR1cm47DQogICAgICAgIHZhciBpdGVtcyA9IFtdOw0KICAgICAgICB1dGlscy5lYWNoKGxpc3QsZnVuY3Rpb24oa2V5LHZhbCl7DQogICAgICAgICAgICBpdGVtcy5wdXNoKHsNCiAgICAgICAgICAgICAgICBsYWJlbDprZXksDQogICAgICAgICAgICAgICAgdmFsdWU6dmFsLA0KICAgICAgICAgICAgICAgIHRoZW1lOmVkaXRvci5vcHRpb25zLnRoZW1lLA0KICAgICAgICAgICAgICAgIHJlbmRlckxhYmVsSHRtbDpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAnPGRpdiBjbGFzcz0iZWR1aS1sYWJlbCAlJS1sYWJlbCIgPicgKyAodGhpcy5sYWJlbCB8fCAnJykgKyAnPC9kaXY+JzsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgdmFyIHVpID0gbmV3IGVkaXRvcnVpLkNvbWJveCh7DQogICAgICAgICAgICBlZGl0b3I6ZWRpdG9yLA0KICAgICAgICAgICAgaXRlbXM6aXRlbXMsDQogICAgICAgICAgICBvbnNlbGVjdDpmdW5jdGlvbiAodCwgaW5kZXgpIHsNCiAgICAgICAgICAgICAgICBlZGl0b3IuZXhlY0NvbW1hbmQoJ2luc2VydGNvZGUnLCB0aGlzLml0ZW1zW2luZGV4XS52YWx1ZSk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgb25idXR0b25jbGljazpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgdGhpcy5zaG93UG9wdXAoKTsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB0aXRsZTp0aXRsZSwNCiAgICAgICAgICAgIGluaXRWYWx1ZTp0aXRsZSwNCiAgICAgICAgICAgIGNsYXNzTmFtZTonZWR1aS1mb3ItaW5zZXJ0Y29kZScsDQogICAgICAgICAgICBpbmRleEJ5VmFsdWU6ZnVuY3Rpb24gKHZhbHVlKSB7DQogICAgICAgICAgICAgICAgaWYgKHZhbHVlKSB7DQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjaTsgY2kgPSB0aGlzLml0ZW1zW2ldOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaS52YWx1ZS5pbmRleE9mKHZhbHVlKSAhPSAtMSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICAgIGVkaXRvcnVpLmJ1dHRvbnNbJ2luc2VydGNvZGUnXSA9IHVpOw0KICAgICAgICBlZGl0b3IuYWRkTGlzdGVuZXIoJ3NlbGVjdGlvbmNoYW5nZScsIGZ1bmN0aW9uICh0eXBlLCBjYXVzZUJ5VWksIHVpUmVhZHkpIHsNCiAgICAgICAgICAgIGlmICghdWlSZWFkeSkgew0KICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGVkaXRvci5xdWVyeUNvbW1hbmRTdGF0ZSgnaW5zZXJ0Y29kZScpOw0KICAgICAgICAgICAgICAgIGlmIChzdGF0ZSA9PSAtMSkgew0KICAgICAgICAgICAgICAgICAgICB1aS5zZXREaXNhYmxlZCh0cnVlKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICB1aS5zZXREaXNhYmxlZChmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGVkaXRvci5xdWVyeUNvbW1hbmRWYWx1ZSgnaW5zZXJ0Y29kZScpOw0KICAgICAgICAgICAgICAgICAgICBpZighdmFsdWUpew0KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0VmFsdWUodGl0bGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIC8vdHJhY2U6MTg3MSBpZeS4i+S7jua6kOeggeaooeW8j+WIh+aNouWbnuadpeaXtu+8jOWtl+S9k+S8muW4puWNleW8leWPt++8jOiAjOS4lOS8muaciemAl+WPtw0KICAgICAgICAgICAgICAgICAgICB2YWx1ZSAmJiAodmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC9bJyJdL2csICcnKS5zcGxpdCgnLCcpWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0VmFsdWUodmFsdWUpOw0KDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0pOw0KICAgICAgICByZXR1cm4gdWk7DQogICAgfTsNCiAgICBlZGl0b3J1aS5mb250ZmFtaWx5ID0gZnVuY3Rpb24gKGVkaXRvciwgbGlzdCwgdGl0bGUpIHsNCg0KICAgICAgICBsaXN0ID0gZWRpdG9yLm9wdGlvbnNbJ2ZvbnRmYW1pbHknXSB8fCBbXTsNCiAgICAgICAgdGl0bGUgPSBlZGl0b3Iub3B0aW9ucy5sYWJlbE1hcFsnZm9udGZhbWlseSddIHx8IGVkaXRvci5nZXRMYW5nKCJsYWJlbE1hcC5mb250ZmFtaWx5IikgfHwgJyc7DQogICAgICAgIGlmICghbGlzdC5sZW5ndGgpIHJldHVybjsNCiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNpLCBpdGVtcyA9IFtdOyBjaSA9IGxpc3RbaV07IGkrKykgew0KICAgICAgICAgICAgdmFyIGxhbmdMYWJlbCA9IGVkaXRvci5nZXRMYW5nKCdmb250ZmFtaWx5JylbY2kubmFtZV0gfHwgIiI7DQogICAgICAgICAgICAoZnVuY3Rpb24gKGtleSwgdmFsKSB7DQogICAgICAgICAgICAgICAgaXRlbXMucHVzaCh7DQogICAgICAgICAgICAgICAgICAgIGxhYmVsOmtleSwNCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6dmFsLA0KICAgICAgICAgICAgICAgICAgICB0aGVtZTplZGl0b3Iub3B0aW9ucy50aGVtZSwNCiAgICAgICAgICAgICAgICAgICAgcmVuZGVyTGFiZWxIdG1sOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnPGRpdiBjbGFzcz0iZWR1aS1sYWJlbCAlJS1sYWJlbCIgc3R5bGU9ImZvbnQtZmFtaWx5OicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0aWxzLnVuaHRtbCh0aGlzLnZhbHVlKSArICciPicgKyAodGhpcy5sYWJlbCB8fCAnJykgKyAnPC9kaXY+JzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfSkoY2kubGFiZWwgfHwgbGFuZ0xhYmVsLCBjaS52YWwpDQogICAgICAgIH0NCiAgICAgICAgdmFyIHVpID0gbmV3IGVkaXRvcnVpLkNvbWJveCh7DQogICAgICAgICAgICBlZGl0b3I6ZWRpdG9yLA0KICAgICAgICAgICAgaXRlbXM6aXRlbXMsDQogICAgICAgICAgICBvbnNlbGVjdDpmdW5jdGlvbiAodCwgaW5kZXgpIHsNCiAgICAgICAgICAgICAgICBlZGl0b3IuZXhlY0NvbW1hbmQoJ0ZvbnRGYW1pbHknLCB0aGlzLml0ZW1zW2luZGV4XS52YWx1ZSk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgb25idXR0b25jbGljazpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgdGhpcy5zaG93UG9wdXAoKTsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB0aXRsZTp0aXRsZSwNCiAgICAgICAgICAgIGluaXRWYWx1ZTp0aXRsZSwNCiAgICAgICAgICAgIGNsYXNzTmFtZTonZWR1aS1mb3ItZm9udGZhbWlseScsDQogICAgICAgICAgICBpbmRleEJ5VmFsdWU6ZnVuY3Rpb24gKHZhbHVlKSB7DQogICAgICAgICAgICAgICAgaWYgKHZhbHVlKSB7DQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjaTsgY2kgPSB0aGlzLml0ZW1zW2ldOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaS52YWx1ZS5pbmRleE9mKHZhbHVlKSAhPSAtMSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICAgIGVkaXRvcnVpLmJ1dHRvbnNbJ2ZvbnRmYW1pbHknXSA9IHVpOw0KICAgICAgICBlZGl0b3IuYWRkTGlzdGVuZXIoJ3NlbGVjdGlvbmNoYW5nZScsIGZ1bmN0aW9uICh0eXBlLCBjYXVzZUJ5VWksIHVpUmVhZHkpIHsNCiAgICAgICAgICAgIGlmICghdWlSZWFkeSkgew0KICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IGVkaXRvci5xdWVyeUNvbW1hbmRTdGF0ZSgnRm9udEZhbWlseScpOw0KICAgICAgICAgICAgICAgIGlmIChzdGF0ZSA9PSAtMSkgew0KICAgICAgICAgICAgICAgICAgICB1aS5zZXREaXNhYmxlZCh0cnVlKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICB1aS5zZXREaXNhYmxlZChmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGVkaXRvci5xdWVyeUNvbW1hbmRWYWx1ZSgnRm9udEZhbWlseScpOw0KICAgICAgICAgICAgICAgICAgICAvL3RyYWNlOjE4NzEgaWXkuIvku47mupDnoIHmqKHlvI/liIfmjaLlm57mnaXml7bvvIzlrZfkvZPkvJrluKbljZXlvJXlj7fvvIzogIzkuJTkvJrmnInpgJflj7cNCiAgICAgICAgICAgICAgICAgICAgdmFsdWUgJiYgKHZhbHVlID0gdmFsdWUucmVwbGFjZSgvWyciXS9nLCAnJykuc3BsaXQoJywnKVswXSk7DQogICAgICAgICAgICAgICAgICAgIHVpLnNldFZhbHVlKHZhbHVlKTsNCg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIHVpOw0KICAgIH07DQoNCiAgICBlZGl0b3J1aS5mb250c2l6ZSA9IGZ1bmN0aW9uIChlZGl0b3IsIGxpc3QsIHRpdGxlKSB7DQogICAgICAgIHRpdGxlID0gZWRpdG9yLm9wdGlvbnMubGFiZWxNYXBbJ2ZvbnRzaXplJ10gfHwgZWRpdG9yLmdldExhbmcoImxhYmVsTWFwLmZvbnRzaXplIikgfHwgJyc7DQogICAgICAgIGxpc3QgPSBsaXN0IHx8IGVkaXRvci5vcHRpb25zWydmb250c2l6ZSddIHx8IFtdOw0KICAgICAgICBpZiAoIWxpc3QubGVuZ3RoKSByZXR1cm47DQogICAgICAgIHZhciBpdGVtcyA9IFtdOw0KICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIHZhciBzaXplID0gbGlzdFtpXSArICdweCc7DQogICAgICAgICAgICBpdGVtcy5wdXNoKHsNCiAgICAgICAgICAgICAgICBsYWJlbDpzaXplLA0KICAgICAgICAgICAgICAgIHZhbHVlOnNpemUsDQogICAgICAgICAgICAgICAgdGhlbWU6ZWRpdG9yLm9wdGlvbnMudGhlbWUsDQogICAgICAgICAgICAgICAgcmVuZGVyTGFiZWxIdG1sOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8ZGl2IGNsYXNzPSJlZHVpLWxhYmVsICUlLWxhYmVsIiBzdHlsZT0ibGluZS1oZWlnaHQ6MTtmb250LXNpemU6JyArDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlICsgJyI+JyArICh0aGlzLmxhYmVsIHx8ICcnKSArICc8L2Rpdj4nOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIHZhciB1aSA9IG5ldyBlZGl0b3J1aS5Db21ib3goew0KICAgICAgICAgICAgZWRpdG9yOmVkaXRvciwNCiAgICAgICAgICAgIGl0ZW1zOml0ZW1zLA0KICAgICAgICAgICAgdGl0bGU6dGl0bGUsDQogICAgICAgICAgICBpbml0VmFsdWU6dGl0bGUsDQogICAgICAgICAgICBvbnNlbGVjdDpmdW5jdGlvbiAodCwgaW5kZXgpIHsNCiAgICAgICAgICAgICAgICBlZGl0b3IuZXhlY0NvbW1hbmQoJ0ZvbnRTaXplJywgdGhpcy5pdGVtc1tpbmRleF0udmFsdWUpOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIG9uYnV0dG9uY2xpY2s6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIHRoaXMuc2hvd1BvcHVwKCk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgY2xhc3NOYW1lOidlZHVpLWZvci1mb250c2l6ZScNCiAgICAgICAgfSk7DQogICAgICAgIGVkaXRvcnVpLmJ1dHRvbnNbJ2ZvbnRzaXplJ10gPSB1aTsNCiAgICAgICAgZWRpdG9yLmFkZExpc3RlbmVyKCdzZWxlY3Rpb25jaGFuZ2UnLCBmdW5jdGlvbiAodHlwZSwgY2F1c2VCeVVpLCB1aVJlYWR5KSB7DQogICAgICAgICAgICBpZiAoIXVpUmVhZHkpIHsNCiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBlZGl0b3IucXVlcnlDb21tYW5kU3RhdGUoJ0ZvbnRTaXplJyk7DQogICAgICAgICAgICAgICAgaWYgKHN0YXRlID09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgIHVpLnNldERpc2FibGVkKHRydWUpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHVpLnNldERpc2FibGVkKGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0VmFsdWUoZWRpdG9yLnF1ZXJ5Q29tbWFuZFZhbHVlKCdGb250U2l6ZScpKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfSk7DQogICAgICAgIHJldHVybiB1aTsNCiAgICB9Ow0KDQogICAgZWRpdG9ydWkucGFyYWdyYXBoID0gZnVuY3Rpb24gKGVkaXRvciwgbGlzdCwgdGl0bGUpIHsNCiAgICAgICAgdGl0bGUgPSBlZGl0b3Iub3B0aW9ucy5sYWJlbE1hcFsncGFyYWdyYXBoJ10gfHwgZWRpdG9yLmdldExhbmcoImxhYmVsTWFwLnBhcmFncmFwaCIpIHx8ICcnOw0KICAgICAgICBsaXN0ID0gZWRpdG9yLm9wdGlvbnNbJ3BhcmFncmFwaCddIHx8IFtdOw0KICAgICAgICBpZiAodXRpbHMuaXNFbXB0eU9iamVjdChsaXN0KSkgcmV0dXJuOw0KICAgICAgICB2YXIgaXRlbXMgPSBbXTsNCiAgICAgICAgZm9yICh2YXIgaSBpbiBsaXN0KSB7DQogICAgICAgICAgICBpdGVtcy5wdXNoKHsNCiAgICAgICAgICAgICAgICB2YWx1ZTppLA0KICAgICAgICAgICAgICAgIGxhYmVsOmxpc3RbaV0gfHwgZWRpdG9yLmdldExhbmcoInBhcmFncmFwaCIpW2ldLA0KICAgICAgICAgICAgICAgIHRoZW1lOmVkaXRvci5vcHRpb25zLnRoZW1lLA0KICAgICAgICAgICAgICAgIHJlbmRlckxhYmVsSHRtbDpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAnPGRpdiBjbGFzcz0iZWR1aS1sYWJlbCAlJS1sYWJlbCI+PHNwYW4gY2xhc3M9ImVkdWktZm9yLScgKyB0aGlzLnZhbHVlICsgJyI+JyArICh0aGlzLmxhYmVsIHx8ICcnKSArICc8L3NwYW4+PC9kaXY+JzsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KQ0KICAgICAgICB9DQogICAgICAgIHZhciB1aSA9IG5ldyBlZGl0b3J1aS5Db21ib3goew0KICAgICAgICAgICAgZWRpdG9yOmVkaXRvciwNCiAgICAgICAgICAgIGl0ZW1zOml0ZW1zLA0KICAgICAgICAgICAgdGl0bGU6dGl0bGUsDQogICAgICAgICAgICBpbml0VmFsdWU6dGl0bGUsDQogICAgICAgICAgICBjbGFzc05hbWU6J2VkdWktZm9yLXBhcmFncmFwaCcsDQogICAgICAgICAgICBvbnNlbGVjdDpmdW5jdGlvbiAodCwgaW5kZXgpIHsNCiAgICAgICAgICAgICAgICBlZGl0b3IuZXhlY0NvbW1hbmQoJ1BhcmFncmFwaCcsIHRoaXMuaXRlbXNbaW5kZXhdLnZhbHVlKTsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBvbmJ1dHRvbmNsaWNrOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICB0aGlzLnNob3dQb3B1cCgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgICAgZWRpdG9ydWkuYnV0dG9uc1sncGFyYWdyYXBoJ10gPSB1aTsNCiAgICAgICAgZWRpdG9yLmFkZExpc3RlbmVyKCdzZWxlY3Rpb25jaGFuZ2UnLCBmdW5jdGlvbiAodHlwZSwgY2F1c2VCeVVpLCB1aVJlYWR5KSB7DQogICAgICAgICAgICBpZiAoIXVpUmVhZHkpIHsNCiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBlZGl0b3IucXVlcnlDb21tYW5kU3RhdGUoJ1BhcmFncmFwaCcpOw0KICAgICAgICAgICAgICAgIGlmIChzdGF0ZSA9PSAtMSkgew0KICAgICAgICAgICAgICAgICAgICB1aS5zZXREaXNhYmxlZCh0cnVlKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICB1aS5zZXREaXNhYmxlZChmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGVkaXRvci5xdWVyeUNvbW1hbmRWYWx1ZSgnUGFyYWdyYXBoJyk7DQogICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IHVpLmluZGV4QnlWYWx1ZSh2YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCAhPSAtMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0VmFsdWUodmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0VmFsdWUodWkuaW5pdFZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIHVpOw0KICAgIH07DQoNCg0KICAgIC8v6Ieq5a6a5LmJ5qCH6aKYDQogICAgZWRpdG9ydWkuY3VzdG9tc3R5bGUgPSBmdW5jdGlvbiAoZWRpdG9yKSB7DQogICAgICAgIHZhciBsaXN0ID0gZWRpdG9yLm9wdGlvbnNbJ2N1c3RvbXN0eWxlJ10gfHwgW10sDQogICAgICAgICAgICB0aXRsZSA9IGVkaXRvci5vcHRpb25zLmxhYmVsTWFwWydjdXN0b21zdHlsZSddIHx8IGVkaXRvci5nZXRMYW5nKCJsYWJlbE1hcC5jdXN0b21zdHlsZSIpIHx8ICcnOw0KICAgICAgICBpZiAoIWxpc3QubGVuZ3RoKXJldHVybjsNCiAgICAgICAgdmFyIGxhbmdDcyA9IGVkaXRvci5nZXRMYW5nKCdjdXN0b21zdHlsZScpOw0KICAgICAgICBmb3IgKHZhciBpID0gMCwgaXRlbXMgPSBbXSwgdDsgdCA9IGxpc3RbaSsrXTspIHsNCiAgICAgICAgICAgIChmdW5jdGlvbiAodCkgew0KICAgICAgICAgICAgICAgIHZhciBjayA9IHt9Ow0KICAgICAgICAgICAgICAgIGNrLmxhYmVsID0gdC5sYWJlbCA/IHQubGFiZWwgOiBsYW5nQ3NbdC5uYW1lXTsNCiAgICAgICAgICAgICAgICBjay5zdHlsZSA9IHQuc3R5bGU7DQogICAgICAgICAgICAgICAgY2suY2xhc3NOYW1lID0gdC5jbGFzc05hbWU7DQogICAgICAgICAgICAgICAgY2sudGFnID0gdC50YWc7DQogICAgICAgICAgICAgICAgaXRlbXMucHVzaCh7DQogICAgICAgICAgICAgICAgICAgIGxhYmVsOmNrLmxhYmVsLA0KICAgICAgICAgICAgICAgICAgICB2YWx1ZTpjaywNCiAgICAgICAgICAgICAgICAgICAgdGhlbWU6ZWRpdG9yLm9wdGlvbnMudGhlbWUsDQogICAgICAgICAgICAgICAgICAgIHJlbmRlckxhYmVsSHRtbDpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzxkaXYgY2xhc3M9ImVkdWktbGFiZWwgJSUtbGFiZWwiPicgKyAnPCcgKyBjay50YWcgKyAnICcgKyAoY2suY2xhc3NOYW1lID8gJyBjbGFzcz0iJyArIGNrLmNsYXNzTmFtZSArICciJyA6ICIiKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgKGNrLnN0eWxlID8gJyBzdHlsZT0iJyArIGNrLnN0eWxlICsgJyInIDogIiIpICsgJz4nICsgY2subGFiZWwgKyAiPFwvIiArIGNrLnRhZyArICI+Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgJzwvZGl2Pic7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0pKHQpOw0KICAgICAgICB9DQoNCiAgICAgICAgdmFyIHVpID0gbmV3IGVkaXRvcnVpLkNvbWJveCh7DQogICAgICAgICAgICBlZGl0b3I6ZWRpdG9yLA0KICAgICAgICAgICAgaXRlbXM6aXRlbXMsDQogICAgICAgICAgICB0aXRsZTp0aXRsZSwNCiAgICAgICAgICAgIGluaXRWYWx1ZTp0aXRsZSwNCiAgICAgICAgICAgIGNsYXNzTmFtZTonZWR1aS1mb3ItY3VzdG9tc3R5bGUnLA0KICAgICAgICAgICAgb25zZWxlY3Q6ZnVuY3Rpb24gKHQsIGluZGV4KSB7DQogICAgICAgICAgICAgICAgZWRpdG9yLmV4ZWNDb21tYW5kKCdjdXN0b21zdHlsZScsIHRoaXMuaXRlbXNbaW5kZXhdLnZhbHVlKTsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBvbmJ1dHRvbmNsaWNrOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICB0aGlzLnNob3dQb3B1cCgpOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGluZGV4QnlWYWx1ZTpmdW5jdGlvbiAodmFsdWUpIHsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgdGk7IHRpID0gdGhpcy5pdGVtc1tpKytdOykgew0KICAgICAgICAgICAgICAgICAgICBpZiAodGkubGFiZWwgPT0gdmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpIC0gMQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICAgIGVkaXRvcnVpLmJ1dHRvbnNbJ2N1c3RvbXN0eWxlJ10gPSB1aTsNCiAgICAgICAgZWRpdG9yLmFkZExpc3RlbmVyKCdzZWxlY3Rpb25jaGFuZ2UnLCBmdW5jdGlvbiAodHlwZSwgY2F1c2VCeVVpLCB1aVJlYWR5KSB7DQogICAgICAgICAgICBpZiAoIXVpUmVhZHkpIHsNCiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBlZGl0b3IucXVlcnlDb21tYW5kU3RhdGUoJ2N1c3RvbXN0eWxlJyk7DQogICAgICAgICAgICAgICAgaWYgKHN0YXRlID09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgIHVpLnNldERpc2FibGVkKHRydWUpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHVpLnNldERpc2FibGVkKGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZWRpdG9yLnF1ZXJ5Q29tbWFuZFZhbHVlKCdjdXN0b21zdHlsZScpOw0KICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSB1aS5pbmRleEJ5VmFsdWUodmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggIT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldFZhbHVlKHZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldFZhbHVlKHVpLmluaXRWYWx1ZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfSk7DQogICAgICAgIHJldHVybiB1aTsNCiAgICB9Ow0KICAgIGVkaXRvcnVpLmluc2VydHRhYmxlID0gZnVuY3Rpb24gKGVkaXRvciwgaWZyYW1lVXJsLCB0aXRsZSkgew0KICAgICAgICB0aXRsZSA9IGVkaXRvci5vcHRpb25zLmxhYmVsTWFwWydpbnNlcnR0YWJsZSddIHx8IGVkaXRvci5nZXRMYW5nKCJsYWJlbE1hcC5pbnNlcnR0YWJsZSIpIHx8ICcnOw0KICAgICAgICB2YXIgdWkgPSBuZXcgZWRpdG9ydWkuVGFibGVCdXR0b24oew0KICAgICAgICAgICAgZWRpdG9yOmVkaXRvciwNCiAgICAgICAgICAgIHRpdGxlOnRpdGxlLA0KICAgICAgICAgICAgY2xhc3NOYW1lOidlZHVpLWZvci1pbnNlcnR0YWJsZScsDQogICAgICAgICAgICBvbnBpY2t0YWJsZTpmdW5jdGlvbiAodCwgbnVtQ29scywgbnVtUm93cykgew0KICAgICAgICAgICAgICAgIGVkaXRvci5leGVjQ29tbWFuZCgnSW5zZXJ0VGFibGUnLCB7bnVtUm93czpudW1Sb3dzLCBudW1Db2xzOm51bUNvbHMsIGJvcmRlcjoxfSk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgb25idXR0b25jbGljazpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgdGhpcy5zaG93UG9wdXAoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICAgIGVkaXRvcnVpLmJ1dHRvbnNbJ2luc2VydHRhYmxlJ10gPSB1aTsNCiAgICAgICAgZWRpdG9yLmFkZExpc3RlbmVyKCdzZWxlY3Rpb25jaGFuZ2UnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB1aS5zZXREaXNhYmxlZChlZGl0b3IucXVlcnlDb21tYW5kU3RhdGUoJ2luc2VydHRhYmxlJykgPT0gLTEpOw0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIHVpOw0KICAgIH07DQoNCiAgICBlZGl0b3J1aS5saW5laGVpZ2h0ID0gZnVuY3Rpb24gKGVkaXRvcikgew0KICAgICAgICB2YXIgdmFsID0gZWRpdG9yLm9wdGlvbnMubGluZWhlaWdodCB8fCBbXTsNCiAgICAgICAgaWYgKCF2YWwubGVuZ3RoKXJldHVybjsNCiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNpLCBpdGVtcyA9IFtdOyBjaSA9IHZhbFtpKytdOykgew0KICAgICAgICAgICAgaXRlbXMucHVzaCh7DQogICAgICAgICAgICAgICAgLy90b2RvOuWGmeatu+S6hg0KICAgICAgICAgICAgICAgIGxhYmVsOmNpLA0KICAgICAgICAgICAgICAgIHZhbHVlOmNpLA0KICAgICAgICAgICAgICAgIHRoZW1lOmVkaXRvci5vcHRpb25zLnRoZW1lLA0KICAgICAgICAgICAgICAgIG9uY2xpY2s6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICBlZGl0b3IuZXhlY0NvbW1hbmQoImxpbmVoZWlnaHQiLCB0aGlzLnZhbHVlKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KQ0KICAgICAgICB9DQogICAgICAgIHZhciB1aSA9IG5ldyBlZGl0b3J1aS5NZW51QnV0dG9uKHsNCiAgICAgICAgICAgIGVkaXRvcjplZGl0b3IsDQogICAgICAgICAgICBjbGFzc05hbWU6J2VkdWktZm9yLWxpbmVoZWlnaHQnLA0KICAgICAgICAgICAgdGl0bGU6ZWRpdG9yLm9wdGlvbnMubGFiZWxNYXBbJ2xpbmVoZWlnaHQnXSB8fCBlZGl0b3IuZ2V0TGFuZygibGFiZWxNYXAubGluZWhlaWdodCIpIHx8ICcnLA0KICAgICAgICAgICAgaXRlbXM6aXRlbXMsDQogICAgICAgICAgICBvbmJ1dHRvbmNsaWNrOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBlZGl0b3IucXVlcnlDb21tYW5kVmFsdWUoJ0xpbmVIZWlnaHQnKSB8fCB0aGlzLnZhbHVlOw0KICAgICAgICAgICAgICAgIGVkaXRvci5leGVjQ29tbWFuZCgiTGluZUhlaWdodCIsIHZhbHVlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICAgIGVkaXRvcnVpLmJ1dHRvbnNbJ2xpbmVoZWlnaHQnXSA9IHVpOw0KICAgICAgICBlZGl0b3IuYWRkTGlzdGVuZXIoJ3NlbGVjdGlvbmNoYW5nZScsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBzdGF0ZSA9IGVkaXRvci5xdWVyeUNvbW1hbmRTdGF0ZSgnTGluZUhlaWdodCcpOw0KICAgICAgICAgICAgaWYgKHN0YXRlID09IC0xKSB7DQogICAgICAgICAgICAgICAgdWkuc2V0RGlzYWJsZWQodHJ1ZSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHVpLnNldERpc2FibGVkKGZhbHNlKTsNCiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBlZGl0b3IucXVlcnlDb21tYW5kVmFsdWUoJ0xpbmVIZWlnaHQnKTsNCiAgICAgICAgICAgICAgICB2YWx1ZSAmJiB1aS5zZXRWYWx1ZSgodmFsdWUgKyAnJykucmVwbGFjZSgvY20vLCAnJykpOw0KICAgICAgICAgICAgICAgIHVpLnNldENoZWNrZWQoc3RhdGUpDQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgICAgICByZXR1cm4gdWk7DQogICAgfTsNCg0KICAgIHZhciByb3dzcGFjaW5ncyA9IFsndG9wJywgJ2JvdHRvbSddOw0KICAgIGZvciAodmFyIHIgPSAwLCByaTsgcmkgPSByb3dzcGFjaW5nc1tyKytdOykgew0KICAgICAgICAoZnVuY3Rpb24gKGNtZCkgew0KICAgICAgICAgICAgZWRpdG9ydWlbJ3Jvd3NwYWNpbmcnICsgY21kXSA9IGZ1bmN0aW9uIChlZGl0b3IpIHsNCiAgICAgICAgICAgICAgICB2YXIgdmFsID0gZWRpdG9yLm9wdGlvbnNbJ3Jvd3NwYWNpbmcnICsgY21kXSB8fCBbXTsNCiAgICAgICAgICAgICAgICBpZiAoIXZhbC5sZW5ndGgpIHJldHVybiBudWxsOw0KICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjaSwgaXRlbXMgPSBbXTsgY2kgPSB2YWxbaSsrXTspIHsNCiAgICAgICAgICAgICAgICAgICAgaXRlbXMucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDpjaSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOmNpLA0KICAgICAgICAgICAgICAgICAgICAgICAgdGhlbWU6ZWRpdG9yLm9wdGlvbnMudGhlbWUsDQogICAgICAgICAgICAgICAgICAgICAgICBvbmNsaWNrOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3IuZXhlY0NvbW1hbmQoInJvd3NwYWNpbmciLCB0aGlzLnZhbHVlLCBjbWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB2YXIgdWkgPSBuZXcgZWRpdG9ydWkuTWVudUJ1dHRvbih7DQogICAgICAgICAgICAgICAgICAgIGVkaXRvcjplZGl0b3IsDQogICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTonZWR1aS1mb3Itcm93c3BhY2luZycgKyBjbWQsDQogICAgICAgICAgICAgICAgICAgIHRpdGxlOmVkaXRvci5vcHRpb25zLmxhYmVsTWFwWydyb3dzcGFjaW5nJyArIGNtZF0gfHwgZWRpdG9yLmdldExhbmcoImxhYmVsTWFwLnJvd3NwYWNpbmciICsgY21kKSB8fCAnJywNCiAgICAgICAgICAgICAgICAgICAgaXRlbXM6aXRlbXMsDQogICAgICAgICAgICAgICAgICAgIG9uYnV0dG9uY2xpY2s6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZWRpdG9yLnF1ZXJ5Q29tbWFuZFZhbHVlKCdyb3dzcGFjaW5nJywgY21kKSB8fCB0aGlzLnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmV4ZWNDb21tYW5kKCJyb3dzcGFjaW5nIiwgdmFsdWUsIGNtZCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBlZGl0b3J1aS5idXR0b25zW2NtZF0gPSB1aTsNCiAgICAgICAgICAgICAgICBlZGl0b3IuYWRkTGlzdGVuZXIoJ3NlbGVjdGlvbmNoYW5nZScsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gZWRpdG9yLnF1ZXJ5Q29tbWFuZFN0YXRlKCdyb3dzcGFjaW5nJywgY21kKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlID09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXREaXNhYmxlZCh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldERpc2FibGVkKGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGVkaXRvci5xdWVyeUNvbW1hbmRWYWx1ZSgncm93c3BhY2luZycsIGNtZCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSAmJiB1aS5zZXRWYWx1ZSgodmFsdWUgKyAnJykucmVwbGFjZSgvJS8sICcnKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXRDaGVja2VkKHN0YXRlKQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgcmV0dXJuIHVpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KShyaSkNCiAgICB9DQogICAgLy/mnInluo/vvIzml6Dluo/liJfooagNCiAgICB2YXIgbGlzdHMgPSBbJ2luc2VydG9yZGVyZWRsaXN0JywgJ2luc2VydHVub3JkZXJlZGxpc3QnXTsNCiAgICBmb3IgKHZhciBsID0gMCwgY2w7IGNsID0gbGlzdHNbbCsrXTspIHsNCiAgICAgICAgKGZ1bmN0aW9uIChjbWQpIHsNCiAgICAgICAgICAgIGVkaXRvcnVpW2NtZF0gPSBmdW5jdGlvbiAoZWRpdG9yKSB7DQogICAgICAgICAgICAgICAgdmFyIHZhbHMgPSBlZGl0b3Iub3B0aW9uc1tjbWRdLA0KICAgICAgICAgICAgICAgICAgICBfb25NZW51Q2xpY2sgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3IuZXhlY0NvbW1hbmQoY21kLCB0aGlzLnZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgfSwgaXRlbXMgPSBbXTsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIHZhbHMpIHsNCiAgICAgICAgICAgICAgICAgICAgaXRlbXMucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDp2YWxzW2ldIHx8IGVkaXRvci5nZXRMYW5nKClbY21kXVtpXSB8fCAiIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOmksDQogICAgICAgICAgICAgICAgICAgICAgICB0aGVtZTplZGl0b3Iub3B0aW9ucy50aGVtZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIG9uY2xpY2s6X29uTWVudUNsaWNrDQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHZhciB1aSA9IG5ldyBlZGl0b3J1aS5NZW51QnV0dG9uKHsNCiAgICAgICAgICAgICAgICAgICAgZWRpdG9yOmVkaXRvciwNCiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOidlZHVpLWZvci0nICsgY21kLA0KICAgICAgICAgICAgICAgICAgICB0aXRsZTplZGl0b3IuZ2V0TGFuZygibGFiZWxNYXAuIiArIGNtZCkgfHwgJycsDQogICAgICAgICAgICAgICAgICAgICdpdGVtcyc6aXRlbXMsDQogICAgICAgICAgICAgICAgICAgIG9uYnV0dG9uY2xpY2s6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZWRpdG9yLnF1ZXJ5Q29tbWFuZFZhbHVlKGNtZCkgfHwgdGhpcy52YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5leGVjQ29tbWFuZChjbWQsIHZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIGVkaXRvcnVpLmJ1dHRvbnNbY21kXSA9IHVpOw0KICAgICAgICAgICAgICAgIGVkaXRvci5hZGRMaXN0ZW5lcignc2VsZWN0aW9uY2hhbmdlJywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBlZGl0b3IucXVlcnlDb21tYW5kU3RhdGUoY21kKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlID09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXREaXNhYmxlZCh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldERpc2FibGVkKGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGVkaXRvci5xdWVyeUNvbW1hbmRWYWx1ZShjbWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0VmFsdWUodmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0Q2hlY2tlZChzdGF0ZSkNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIHJldHVybiB1aTsNCiAgICAgICAgICAgIH07DQogICAgICAgIH0pKGNsKQ0KICAgIH0NCg0KICAgIGVkaXRvcnVpLmZ1bGxzY3JlZW4gPSBmdW5jdGlvbiAoZWRpdG9yLCB0aXRsZSkgew0KICAgICAgICB0aXRsZSA9IGVkaXRvci5vcHRpb25zLmxhYmVsTWFwWydmdWxsc2NyZWVuJ10gfHwgZWRpdG9yLmdldExhbmcoImxhYmVsTWFwLmZ1bGxzY3JlZW4iKSB8fCAnJzsNCiAgICAgICAgdmFyIHVpID0gbmV3IGVkaXRvcnVpLkJ1dHRvbih7DQogICAgICAgICAgICBjbGFzc05hbWU6J2VkdWktZm9yLWZ1bGxzY3JlZW4nLA0KICAgICAgICAgICAgdGl0bGU6dGl0bGUsDQogICAgICAgICAgICB0aGVtZTplZGl0b3Iub3B0aW9ucy50aGVtZSwNCiAgICAgICAgICAgIG9uY2xpY2s6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIGlmIChlZGl0b3IudWkpIHsNCiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnVpLnNldEZ1bGxTY3JlZW4oIWVkaXRvci51aS5pc0Z1bGxTY3JlZW4oKSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRoaXMuc2V0Q2hlY2tlZChlZGl0b3IudWkuaXNGdWxsU2NyZWVuKCkpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgICAgZWRpdG9ydWkuYnV0dG9uc1snZnVsbHNjcmVlbiddID0gdWk7DQogICAgICAgIGVkaXRvci5hZGRMaXN0ZW5lcignc2VsZWN0aW9uY2hhbmdlJywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIHN0YXRlID0gZWRpdG9yLnF1ZXJ5Q29tbWFuZFN0YXRlKCdmdWxsc2NyZWVuJyk7DQogICAgICAgICAgICB1aS5zZXREaXNhYmxlZChzdGF0ZSA9PSAtMSk7DQogICAgICAgICAgICB1aS5zZXRDaGVja2VkKGVkaXRvci51aS5pc0Z1bGxTY3JlZW4oKSk7DQogICAgICAgIH0pOw0KICAgICAgICByZXR1cm4gdWk7DQogICAgfTsNCg0KICAgIC8vIOihqOaDhQ0KICAgIGVkaXRvcnVpWyJlbW90aW9uIl0gPSBmdW5jdGlvbiAoZWRpdG9yLCBpZnJhbWVVcmwpIHsNCiAgICAgICAgdmFyIGNtZCA9ICJlbW90aW9uIjsNCiAgICAgICAgdmFyIHVpID0gbmV3IGVkaXRvcnVpLk11bHRpTWVudVBvcCh7DQogICAgICAgICAgICB0aXRsZTplZGl0b3Iub3B0aW9ucy5sYWJlbE1hcFtjbWRdIHx8IGVkaXRvci5nZXRMYW5nKCJsYWJlbE1hcC4iICsgY21kICsgIiIpIHx8ICcnLA0KICAgICAgICAgICAgZWRpdG9yOmVkaXRvciwNCiAgICAgICAgICAgIGNsYXNzTmFtZTonZWR1aS1mb3ItJyArIGNtZCwNCiAgICAgICAgICAgIGlmcmFtZVVybDplZGl0b3IudWkubWFwVXJsKGlmcmFtZVVybCB8fCAoZWRpdG9yLm9wdGlvbnMuaWZyYW1lVXJsTWFwIHx8IHt9KVtjbWRdIHx8IGlmcmFtZVVybE1hcFtjbWRdKQ0KICAgICAgICB9KTsNCiAgICAgICAgZWRpdG9ydWkuYnV0dG9uc1tjbWRdID0gdWk7DQoNCiAgICAgICAgZWRpdG9yLmFkZExpc3RlbmVyKCdzZWxlY3Rpb25jaGFuZ2UnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB1aS5zZXREaXNhYmxlZChlZGl0b3IucXVlcnlDb21tYW5kU3RhdGUoY21kKSA9PSAtMSkNCiAgICAgICAgfSk7DQogICAgICAgIHJldHVybiB1aTsNCiAgICB9Ow0KDQogICAgZWRpdG9ydWkuYXV0b3R5cGVzZXQgPSBmdW5jdGlvbiAoZWRpdG9yKSB7DQogICAgICAgIHZhciB1aSA9IG5ldyBlZGl0b3J1aS5BdXRvVHlwZVNldEJ1dHRvbih7DQogICAgICAgICAgICBlZGl0b3I6ZWRpdG9yLA0KICAgICAgICAgICAgdGl0bGU6ZWRpdG9yLm9wdGlvbnMubGFiZWxNYXBbJ2F1dG90eXBlc2V0J10gfHwgZWRpdG9yLmdldExhbmcoImxhYmVsTWFwLmF1dG90eXBlc2V0IikgfHwgJycsDQogICAgICAgICAgICBjbGFzc05hbWU6J2VkdWktZm9yLWF1dG90eXBlc2V0JywNCiAgICAgICAgICAgIG9uYnV0dG9uY2xpY2s6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIGVkaXRvci5leGVjQ29tbWFuZCgnYXV0b3R5cGVzZXQnKQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgICAgZWRpdG9ydWkuYnV0dG9uc1snYXV0b3R5cGVzZXQnXSA9IHVpOw0KICAgICAgICBlZGl0b3IuYWRkTGlzdGVuZXIoJ3NlbGVjdGlvbmNoYW5nZScsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHVpLnNldERpc2FibGVkKGVkaXRvci5xdWVyeUNvbW1hbmRTdGF0ZSgnYXV0b3R5cGVzZXQnKSA9PSAtMSk7DQogICAgICAgIH0pOw0KICAgICAgICByZXR1cm4gdWk7DQogICAgfTsNCg0KfSkoKTsNCgovLy9pbXBvcnQgY29yZQ0KLy8vY29tbWFuZHMg5YWo5bGPDQovLy9jb21tYW5kc05hbWUgRnVsbFNjcmVlbg0KLy8vY29tbWFuZHNUaXRsZSAg5YWo5bGPDQooZnVuY3Rpb24gKCkgew0KICAgIHZhciB1dGlscyA9IGJhaWR1LmVkaXRvci51dGlscywNCiAgICAgICAgdWlVdGlscyA9IGJhaWR1LmVkaXRvci51aS51aVV0aWxzLA0KICAgICAgICBVSUJhc2UgPSBiYWlkdS5lZGl0b3IudWkuVUlCYXNlLA0KICAgICAgICBkb21VdGlscyA9IGJhaWR1LmVkaXRvci5kb20uZG9tVXRpbHM7DQogICAgdmFyIG5vZGVTdGFjayA9IFtdOw0KDQogICAgZnVuY3Rpb24gRWRpdG9yVUkob3B0aW9ucykgew0KICAgICAgICB0aGlzLmluaXRPcHRpb25zKG9wdGlvbnMpOw0KICAgICAgICB0aGlzLmluaXRFZGl0b3JVSSgpOw0KICAgIH0NCg0KICAgIEVkaXRvclVJLnByb3RvdHlwZSA9IHsNCiAgICAgICAgdWlOYW1lOidlZGl0b3InLA0KICAgICAgICBpbml0RWRpdG9yVUk6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdGhpcy5lZGl0b3IudWkgPSB0aGlzOw0KICAgICAgICAgICAgdGhpcy5fZGlhbG9ncyA9IHt9Ow0KICAgICAgICAgICAgdGhpcy5pbml0VUlCYXNlKCk7DQogICAgICAgICAgICB0aGlzLl9pbml0VG9vbGJhcnMoKTsNCiAgICAgICAgICAgIHZhciBlZGl0b3IgPSB0aGlzLmVkaXRvciwNCiAgICAgICAgICAgICAgICBtZSA9IHRoaXM7DQoNCiAgICAgICAgICAgIGVkaXRvci5hZGRMaXN0ZW5lcigncmVhZHknLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgLy/mj5DkvptnZXREaWFsb2fmlrnms5UNCiAgICAgICAgICAgICAgICBlZGl0b3IuZ2V0RGlhbG9nID0gZnVuY3Rpb24gKG5hbWUpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVkaXRvci51aS5fZGlhbG9nc1tuYW1lICsgIkRpYWxvZyJdOw0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgZG9tVXRpbHMub24oZWRpdG9yLndpbmRvdywgJ3Njcm9sbCcsIGZ1bmN0aW9uIChldnQpIHsNCiAgICAgICAgICAgICAgICAgICAgYmFpZHUuZWRpdG9yLnVpLlBvcHVwLnBvc3RIaWRlKGV2dCk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgLy/mj5DkvpvnvJbovpHlmajlrp7ml7blrr3pq5go5YWo5bGP5pe25a696auY5LiN5Y+Y5YyWKQ0KICAgICAgICAgICAgICAgIGVkaXRvci51aS5fYWN0dWFsRnJhbWVXaWR0aCA9IGVkaXRvci5vcHRpb25zLmluaXRpYWxGcmFtZVdpZHRoOw0KDQogICAgICAgICAgICAgICAgLy9kaXNwbGF5IGJvdHRvbS1iYXIgbGFiZWwgYmFzZWQgb24gY29uZmlnDQogICAgICAgICAgICAgICAgaWYgKGVkaXRvci5vcHRpb25zLmVsZW1lbnRQYXRoRW5hYmxlZCkgew0KICAgICAgICAgICAgICAgICAgICBlZGl0b3IudWkuZ2V0RG9tKCdlbGVtZW50cGF0aCcpLmlubmVySFRNTCA9ICc8ZGl2IGNsYXNzPSJlZHVpLWVkaXRvci1icmVhZGNydW1iIj4nICsgZWRpdG9yLmdldExhbmcoImVsZW1lbnRQYXRoVGlwIikgKyAnOjwvZGl2Pic7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChlZGl0b3Iub3B0aW9ucy53b3JkQ291bnQpIHsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gY291bnRGbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNldENvdW50KGVkaXRvcixtZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBkb21VdGlscy51bihlZGl0b3IuZG9jdW1lbnQsICJjbGljayIsIGFyZ3VtZW50cy5jYWxsZWUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLm9uKGVkaXRvci5kb2N1bWVudCwgImNsaWNrIiwgY291bnRGbik7DQogICAgICAgICAgICAgICAgICAgIGVkaXRvci51aS5nZXREb20oJ3dvcmRjb3VudCcpLmlubmVySFRNTCA9IGVkaXRvci5nZXRMYW5nKCJ3b3JkQ291bnRUaXAiKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWRpdG9yLnVpLl9zY2FsZSgpOw0KICAgICAgICAgICAgICAgIGlmIChlZGl0b3Iub3B0aW9ucy5zY2FsZUVuYWJsZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGVkaXRvci5hdXRvSGVpZ2h0RW5hYmxlZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmRpc2FibGVBdXRvSGVpZ2h0KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgbWUuZW5hYmxlU2NhbGUoKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBtZS5kaXNhYmxlU2NhbGUoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKCFlZGl0b3Iub3B0aW9ucy5lbGVtZW50UGF0aEVuYWJsZWQgJiYgIWVkaXRvci5vcHRpb25zLndvcmRDb3VudCAmJiAhZWRpdG9yLm9wdGlvbnMuc2NhbGVFbmFibGVkKSB7DQogICAgICAgICAgICAgICAgICAgIGVkaXRvci51aS5nZXREb20oJ2VsZW1lbnRwYXRoJykuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnVpLmdldERvbSgnd29yZGNvdW50Jykuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnVpLmdldERvbSgnc2NhbGUnKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICghZWRpdG9yLnNlbGVjdGlvbi5pc0ZvY3VzKCkpcmV0dXJuOw0KICAgICAgICAgICAgICAgIGVkaXRvci5maXJlRXZlbnQoJ3NlbGVjdGlvbmNoYW5nZScsIGZhbHNlLCB0cnVlKTsNCg0KDQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgZWRpdG9yLmFkZExpc3RlbmVyKCdtb3VzZWRvd24nLCBmdW5jdGlvbiAodCwgZXZ0KSB7DQogICAgICAgICAgICAgICAgdmFyIGVsID0gZXZ0LnRhcmdldCB8fCBldnQuc3JjRWxlbWVudDsNCiAgICAgICAgICAgICAgICBiYWlkdS5lZGl0b3IudWkuUG9wdXAucG9zdEhpZGUoZXZ0LCBlbCk7DQogICAgICAgICAgICAgICAgYmFpZHUuZWRpdG9yLnVpLlNob3J0Q3V0TWVudS5wb3N0SGlkZShldnQpOw0KDQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIGVkaXRvci5hZGRMaXN0ZW5lcigiZGVsY2VsbHMiLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgaWYgKFVFLnVpWydlZGl0dGlwJ10pIHsNCiAgICAgICAgICAgICAgICAgICAgbmV3IFVFLnVpWydlZGl0dGlwJ10oZWRpdG9yKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWRpdG9yLmdldERpYWxvZygnZWRpdHRpcCcpLm9wZW4oKTsNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICB2YXIgcGFzdGVQb3AsIGlzUGFzdGUgPSBmYWxzZSwgdGltZXI7DQogICAgICAgICAgICBlZGl0b3IuYWRkTGlzdGVuZXIoImFmdGVycGFzdGUiLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgaWYoZWRpdG9yLnF1ZXJ5Q29tbWFuZFN0YXRlKCdwYXN0ZXBsYWluJykpDQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICBpZihiYWlkdS5lZGl0b3IudWkuUGFzdGVQaWNrZXIpew0KICAgICAgICAgICAgICAgICAgICBwYXN0ZVBvcCA9IG5ldyBiYWlkdS5lZGl0b3IudWkuUG9wdXAoew0KICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDpuZXcgYmFpZHUuZWRpdG9yLnVpLlBhc3RlUGlja2VyKHtlZGl0b3I6ZWRpdG9yfSksDQogICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3I6ZWRpdG9yLA0KICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOidlZHVpLXdvcmRwYXN0ZXBvcCcNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIHBhc3RlUG9wLnJlbmRlcigpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpc1Bhc3RlID0gdHJ1ZTsNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBlZGl0b3IuYWRkTGlzdGVuZXIoImFmdGVyaW5zZXJ0aHRtbCIsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZXIpOw0KICAgICAgICAgICAgICAgIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChwYXN0ZVBvcCAmJiAoaXNQYXN0ZSB8fCBlZGl0b3IudWkuX2lzVHJhbnNmZXIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZihwYXN0ZVBvcC5pc0hpZGRlbigpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3BhbiA9IGRvbVV0aWxzLmNyZWF0ZUVsZW1lbnQoZWRpdG9yLmRvY3VtZW50LCAnc3BhbicsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzdHlsZSc6ImxpbmUtaGVpZ2h0OjBweDsiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2lubmVySFRNTCc6J1x1ZmVmZicNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlID0gZWRpdG9yLnNlbGVjdGlvbi5nZXRSYW5nZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLmluc2VydE5vZGUoc3Bhbik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRtcD0gZ2V0RG9tTm9kZShzcGFuLCAnZmlyc3RDaGlsZCcsICdwcmV2aW91c1NpYmxpbmcnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXN0ZVBvcC5zaG93QW5jaG9yKHRtcC5ub2RlVHlwZSA9PSAzID8gdG1wLnBhcmVudE5vZGUgOiB0bXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLnJlbW92ZShzcGFuKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzdGVQb3Auc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGVkaXRvci51aS5faXNUcmFuc2ZlcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlzUGFzdGUgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sIDIwMCkNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgZWRpdG9yLmFkZExpc3RlbmVyKCdjb250ZXh0bWVudScsIGZ1bmN0aW9uICh0LCBldnQpIHsNCiAgICAgICAgICAgICAgICBiYWlkdS5lZGl0b3IudWkuUG9wdXAucG9zdEhpZGUoZXZ0KTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgZWRpdG9yLmFkZExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24gKHQsIGV2dCkgew0KICAgICAgICAgICAgICAgIGlmIChwYXN0ZVBvcCkgICAgcGFzdGVQb3AuZGlzcG9zZShldnQpOw0KICAgICAgICAgICAgICAgIHZhciBrZXlDb2RlID0gZXZ0LmtleUNvZGUgfHwgZXZ0LndoaWNoOw0KICAgICAgICAgICAgICAgIGlmKGV2dC5hbHRLZXkmJmtleUNvZGU9PTkwKXsNCiAgICAgICAgICAgICAgICAgICAgVUUudWkuYnV0dG9uc1snZnVsbHNjcmVlbiddLm9uY2xpY2soKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIGVkaXRvci5hZGRMaXN0ZW5lcignd29yZGNvdW50JywgZnVuY3Rpb24gKHR5cGUpIHsNCiAgICAgICAgICAgICAgICBzZXRDb3VudCh0aGlzLG1lKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgZnVuY3Rpb24gc2V0Q291bnQoZWRpdG9yLHVpKSB7DQogICAgICAgICAgICAgICAgZWRpdG9yLnNldE9wdCh7DQogICAgICAgICAgICAgICAgICAgIHdvcmRDb3VudDp0cnVlLA0KICAgICAgICAgICAgICAgICAgICBtYXhpbXVtV29yZHM6MTAwMDAsDQogICAgICAgICAgICAgICAgICAgIHdvcmRDb3VudE1zZzplZGl0b3Iub3B0aW9ucy53b3JkQ291bnRNc2cgfHwgZWRpdG9yLmdldExhbmcoIndvcmRDb3VudE1zZyIpLA0KICAgICAgICAgICAgICAgICAgICB3b3JkT3ZlckZsb3dNc2c6ZWRpdG9yLm9wdGlvbnMud29yZE92ZXJGbG93TXNnIHx8IGVkaXRvci5nZXRMYW5nKCJ3b3JkT3ZlckZsb3dNc2ciKQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIHZhciBvcHQgPSBlZGl0b3Iub3B0aW9ucywNCiAgICAgICAgICAgICAgICAgICAgbWF4ID0gb3B0Lm1heGltdW1Xb3JkcywNCiAgICAgICAgICAgICAgICAgICAgbXNnID0gb3B0LndvcmRDb3VudE1zZyAsDQogICAgICAgICAgICAgICAgICAgIGVyck1zZyA9IG9wdC53b3JkT3ZlckZsb3dNc2csDQogICAgICAgICAgICAgICAgICAgIGNvdW50RG9tID0gdWkuZ2V0RG9tKCd3b3JkY291bnQnKTsNCiAgICAgICAgICAgICAgICBpZiAoIW9wdC53b3JkQ291bnQpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB2YXIgY291bnQgPSBlZGl0b3IuZ2V0Q29udGVudExlbmd0aCh0cnVlKTsNCiAgICAgICAgICAgICAgICBpZiAoY291bnQgPiBtYXgpIHsNCiAgICAgICAgICAgICAgICAgICAgY291bnREb20uaW5uZXJIVE1MID0gZXJyTXNnOw0KICAgICAgICAgICAgICAgICAgICBlZGl0b3IuZmlyZUV2ZW50KCJ3b3JkY291bnRvdmVyZmxvdyIpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGNvdW50RG9tLmlubmVySFRNTCA9IG1zZy5yZXBsYWNlKCJ7I2xlYXZlfSIsIG1heCAtIGNvdW50KS5yZXBsYWNlKCJ7I2NvdW50fSIsIGNvdW50KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGVkaXRvci5hZGRMaXN0ZW5lcignc2VsZWN0aW9uY2hhbmdlJywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIGlmIChlZGl0b3Iub3B0aW9ucy5lbGVtZW50UGF0aEVuYWJsZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgbWVbKGVkaXRvci5xdWVyeUNvbW1hbmRTdGF0ZSgnZWxlbWVudHBhdGgnKSA9PSAtMSA/ICdkaXMnIDogJ2VuJykgKyAnYWJsZUVsZW1lbnRQYXRoJ10oKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoZWRpdG9yLm9wdGlvbnMuc2NhbGVFbmFibGVkKSB7DQogICAgICAgICAgICAgICAgICAgIG1lWyhlZGl0b3IucXVlcnlDb21tYW5kU3RhdGUoJ3NjYWxlJykgPT0gLTEgPyAnZGlzJyA6ICdlbicpICsgJ2FibGVTY2FsZSddKCk7DQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIHZhciBwb3B1cCA9IG5ldyBiYWlkdS5lZGl0b3IudWkuUG9wdXAoew0KICAgICAgICAgICAgICAgIGVkaXRvcjplZGl0b3IsDQogICAgICAgICAgICAgICAgY29udGVudDonJywNCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6J2VkdWktYnViYmxlJywNCiAgICAgICAgICAgICAgICBfb25FZGl0QnV0dG9uQ2xpY2s6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmhpZGUoKTsNCiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnVpLl9kaWFsb2dzLmxpbmtEaWFsb2cub3BlbigpOw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgX29uSW1nRWRpdEJ1dHRvbkNsaWNrOmZ1bmN0aW9uIChuYW1lKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaGlkZSgpOw0KICAgICAgICAgICAgICAgICAgICBlZGl0b3IudWkuX2RpYWxvZ3NbbmFtZV0gJiYgZWRpdG9yLnVpLl9kaWFsb2dzW25hbWVdLm9wZW4oKTsNCg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgX29uSW1nU2V0RmxvYXQ6ZnVuY3Rpb24gKHZhbHVlKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaGlkZSgpOw0KICAgICAgICAgICAgICAgICAgICBlZGl0b3IuZXhlY0NvbW1hbmQoImltYWdlZmxvYXQiLCB2YWx1ZSk7DQoNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIF9zZXRJZnJhbWVBbGlnbjpmdW5jdGlvbiAodmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGZyYW1lID0gcG9wdXAuYW5jaG9yRWw7DQogICAgICAgICAgICAgICAgICAgIHZhciBuZXdGcmFtZSA9IGZyYW1lLmNsb25lTm9kZSh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh2YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAtMjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdGcmFtZS5zZXRBdHRyaWJ1dGUoImFsaWduIiwgIiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAtMToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdGcmFtZS5zZXRBdHRyaWJ1dGUoImFsaWduIiwgImxlZnQiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdGcmFtZS5zZXRBdHRyaWJ1dGUoImFsaWduIiwgInJpZ2h0Iik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnJhbWUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobmV3RnJhbWUsIGZyYW1lKTsNCiAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKGZyYW1lKTsNCiAgICAgICAgICAgICAgICAgICAgcG9wdXAuYW5jaG9yRWwgPSBuZXdGcmFtZTsNCiAgICAgICAgICAgICAgICAgICAgcG9wdXAuc2hvd0FuY2hvcihwb3B1cC5hbmNob3JFbCk7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBfdXBkYXRlSWZyYW1lOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLl9pZnJhbWUgPSBwb3B1cC5hbmNob3JFbDsNCiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnVpLl9kaWFsb2dzLmluc2VydGZyYW1lRGlhbG9nLm9wZW4oKTsNCiAgICAgICAgICAgICAgICAgICAgcG9wdXAuaGlkZSgpOw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgX29uUmVtb3ZlQnV0dG9uQ2xpY2s6ZnVuY3Rpb24gKGNtZE5hbWUpIHsNCiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmV4ZWNDb21tYW5kKGNtZE5hbWUpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmhpZGUoKTsNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHF1ZXJ5QXV0b0hpZGU6ZnVuY3Rpb24gKGVsKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChlbCAmJiBlbC5vd25lckRvY3VtZW50ID09IGVkaXRvci5kb2N1bWVudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PSAnaW1nJyB8fCBkb21VdGlscy5maW5kUGFyZW50QnlUYWdOYW1lKGVsLCAnYScsIHRydWUpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsICE9PSBwb3B1cC5hbmNob3JFbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gYmFpZHUuZWRpdG9yLnVpLlBvcHVwLnByb3RvdHlwZS5xdWVyeUF1dG9IaWRlLmNhbGwodGhpcywgZWwpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgcG9wdXAucmVuZGVyKCk7DQogICAgICAgICAgICBpZiAoZWRpdG9yLm9wdGlvbnMuaW1hZ2VQb3B1cCkgew0KICAgICAgICAgICAgICAgIGVkaXRvci5hZGRMaXN0ZW5lcignbW91c2VvdmVyJywgZnVuY3Rpb24gKHQsIGV2dCkgew0KICAgICAgICAgICAgICAgICAgICBldnQgPSBldnQgfHwgd2luZG93LmV2ZW50Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgZWwgPSBldnQudGFyZ2V0IHx8IGV2dC5zcmNFbGVtZW50Ow0KICAgICAgICAgICAgICAgICAgICBpZiAoZWRpdG9yLnVpLl9kaWFsb2dzLmluc2VydGZyYW1lRGlhbG9nICYmIC9pZnJhbWUvaWcudGVzdChlbC50YWdOYW1lKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWwgPSBwb3B1cC5mb3JtYXRIdG1sKA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8bm9icj4nICsgZWRpdG9yLmdldExhbmcoInByb3BlcnR5IikgKyAnOiA8c3BhbiBvbmNsaWNrPSQkLl9zZXRJZnJhbWVBbGlnbigtMikgY2xhc3M9ImVkdWktY2xpY2thYmxlIj4nICsgZWRpdG9yLmdldExhbmcoImRlZmF1bHQiKSArICc8L3NwYW4+Jm5ic3A7Jm5ic3A7PHNwYW4gb25jbGljaz0kJC5fc2V0SWZyYW1lQWxpZ24oLTEpIGNsYXNzPSJlZHVpLWNsaWNrYWJsZSI+JyArIGVkaXRvci5nZXRMYW5nKCJqdXN0aWZ5bGVmdCIpICsgJzwvc3Bhbj4mbmJzcDsmbmJzcDs8c3BhbiBvbmNsaWNrPSQkLl9zZXRJZnJhbWVBbGlnbigxKSBjbGFzcz0iZWR1aS1jbGlja2FibGUiPicgKyBlZGl0b3IuZ2V0TGFuZygianVzdGlmeXJpZ2h0IikgKyAnPC9zcGFuPiZuYnNwOyZuYnNwOycgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIDxzcGFuIG9uY2xpY2s9IiQkLl91cGRhdGVJZnJhbWUoIHRoaXMpOyIgY2xhc3M9ImVkdWktY2xpY2thYmxlIj4nICsgZWRpdG9yLmdldExhbmcoIm1vZGlmeSIpICsgJzwvc3Bhbj48L25vYnI+Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaHRtbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcHVwLmdldERvbSgnY29udGVudCcpLmlubmVySFRNTCA9IGh0bWw7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXAuYW5jaG9yRWwgPSBlbDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3B1cC5zaG93QW5jaG9yKHBvcHVwLmFuY2hvckVsKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXAuaGlkZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgZWRpdG9yLmFkZExpc3RlbmVyKCdzZWxlY3Rpb25jaGFuZ2UnLCBmdW5jdGlvbiAodCwgY2F1c2VCeVVpKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICghY2F1c2VCeVVpKSByZXR1cm47DQogICAgICAgICAgICAgICAgICAgIHZhciBodG1sID0gJycsIHN0ciA9ICIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgaW1nID0gZWRpdG9yLnNlbGVjdGlvbi5nZXRSYW5nZSgpLmdldENsb3NlZE5vZGUoKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGRpYWxvZ3MgPSBlZGl0b3IudWkuX2RpYWxvZ3M7DQogICAgICAgICAgICAgICAgICAgIGlmIChpbWcgJiYgaW1nLnRhZ05hbWUgPT0gJ0lNRycpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaWFsb2dOYW1lID0gJ2luc2VydGltYWdlRGlhbG9nJzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbWcuY2xhc3NOYW1lLmluZGV4T2YoImVkdWktZmFrZWQtdmlkZW8iKSAhPSAtMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpYWxvZ05hbWUgPSAiaW5zZXJ0dmlkZW9EaWFsb2ciDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW1nLmNsYXNzTmFtZS5pbmRleE9mKCJlZHVpLWZha2VkLXdlYmFwcCIpICE9IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlhbG9nTmFtZSA9ICJ3ZWJhcHBEaWFsb2ciDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW1nLnNyYy5pbmRleE9mKCJodHRwOi8vYXBpLm1hcC5iYWlkdS5jb20iKSAhPSAtMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpYWxvZ05hbWUgPSAibWFwRGlhbG9nIg0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGltZy5jbGFzc05hbWUuaW5kZXhPZigiZWR1aS1mYWtlZC1tdXNpYyIpICE9IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlhbG9nTmFtZSA9ICJtdXNpY0RpYWxvZyINCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbWcuc3JjLmluZGV4T2YoImh0dHA6Ly9tYXBzLmdvb2dsZS5jb20vbWFwcy9hcGkvc3RhdGljbWFwIikgIT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWFsb2dOYW1lID0gImdtYXBEaWFsb2ciDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW1nLmdldEF0dHJpYnV0ZSgiYW5jaG9ybmFtZSIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlhbG9nTmFtZSA9ICJhbmNob3JEaWFsb2ciOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgPSBwb3B1cC5mb3JtYXRIdG1sKA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPG5vYnI+JyArIGVkaXRvci5nZXRMYW5nKCJwcm9wZXJ0eSIpICsgJzogPHNwYW4gb25jbGljaz0kJC5fb25JbWdFZGl0QnV0dG9uQ2xpY2soImFuY2hvckRpYWxvZyIpIGNsYXNzPSJlZHVpLWNsaWNrYWJsZSI+JyArIGVkaXRvci5nZXRMYW5nKCJtb2RpZnkiKSArICc8L3NwYW4+Jm5ic3A7Jm5ic3A7JyArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4gb25jbGljaz0kJC5fb25SZW1vdmVCdXR0b25DbGljayhcJ2FuY2hvclwnKSBjbGFzcz0iZWR1aS1jbGlja2FibGUiPicgKyBlZGl0b3IuZ2V0TGFuZygiZGVsZXRlIikgKyAnPC9zcGFuPjwvbm9icj4nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbWcuZ2V0QXR0cmlidXRlKCJ3b3JkX2ltZyIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy90b2RvIOaUvuWIsGRpYWxvZ+WOu+WBmuafpeivog0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci53b3JkX2ltZyA9IFtpbWcuZ2V0QXR0cmlidXRlKCJ3b3JkX2ltZyIpXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWFsb2dOYW1lID0gIndvcmRpbWFnZURpYWxvZyINCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZGlhbG9nc1tkaWFsb2dOYW1lXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciA9ICc8bm9icj4nICsgZWRpdG9yLmdldExhbmcoInByb3BlcnR5IikgKyAnOiAnKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8c3BhbiBvbmNsaWNrPSQkLl9vbkltZ1NldEZsb2F0KCJub25lIikgY2xhc3M9ImVkdWktY2xpY2thYmxlIj4nICsgZWRpdG9yLmdldExhbmcoImRlZmF1bHQiKSArICc8L3NwYW4+Jm5ic3A7Jm5ic3A7JyArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuIG9uY2xpY2s9JCQuX29uSW1nU2V0RmxvYXQoImxlZnQiKSBjbGFzcz0iZWR1aS1jbGlja2FibGUiPicgKyBlZGl0b3IuZ2V0TGFuZygianVzdGlmeWxlZnQiKSArICc8L3NwYW4+Jm5ic3A7Jm5ic3A7JyArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuIG9uY2xpY2s9JCQuX29uSW1nU2V0RmxvYXQoInJpZ2h0IikgY2xhc3M9ImVkdWktY2xpY2thYmxlIj4nICsgZWRpdG9yLmdldExhbmcoImp1c3RpZnlyaWdodCIpICsgJzwvc3Bhbj4mbmJzcDsmbmJzcDsnICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4gb25jbGljaz0kJC5fb25JbWdTZXRGbG9hdCgiY2VudGVyIikgY2xhc3M9ImVkdWktY2xpY2thYmxlIj4nICsgZWRpdG9yLmdldExhbmcoImp1c3RpZnljZW50ZXIiKSArICc8L3NwYW4+Jm5ic3A7Jm5ic3A7JysNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4gb25jbGljaz0iJCQuX29uSW1nRWRpdEJ1dHRvbkNsaWNrKFwnJyArIGRpYWxvZ05hbWUgKyAnXCcpOyIgY2xhc3M9ImVkdWktY2xpY2thYmxlIj4nICsgZWRpdG9yLmdldExhbmcoIm1vZGlmeSIpICsgJzwvc3Bhbj48L25vYnI+JzsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgIWh0bWwgJiYgKGh0bWwgPSBwb3B1cC5mb3JtYXRIdG1sKHN0cikpDQoNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoZWRpdG9yLnVpLl9kaWFsb2dzLmxpbmtEaWFsb2cpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsaW5rID0gZWRpdG9yLnF1ZXJ5Q29tbWFuZFZhbHVlKCdsaW5rJyk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXJsOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmsgJiYgKHVybCA9IChsaW5rLmdldEF0dHJpYnV0ZSgnX2hyZWYnKSB8fCBsaW5rLmdldEF0dHJpYnV0ZSgnaHJlZicsIDIpKSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHh0ID0gdXJsOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1cmwubGVuZ3RoID4gMzApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHh0ID0gdXJsLnN1YnN0cmluZygwLCAyMCkgKyAiLi4uIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGh0bWwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSAnPGRpdiBzdHlsZT0iaGVpZ2h0OjVweDsiPjwvZGl2PicNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSBwb3B1cC5mb3JtYXRIdG1sKA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPG5vYnI+JyArIGVkaXRvci5nZXRMYW5nKCJhbnRob3JNc2ciKSArICc6IDxhIHRhcmdldD0iX2JsYW5rIiBocmVmPSInICsgdXJsICsgJyIgdGl0bGU9IicgKyB1cmwgKyAnIiA+JyArIHR4dCArICc8L2E+JyArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIDxzcGFuIGNsYXNzPSJlZHVpLWNsaWNrYWJsZSIgb25jbGljaz0iJCQuX29uRWRpdEJ1dHRvbkNsaWNrKCk7Ij4nICsgZWRpdG9yLmdldExhbmcoIm1vZGlmeSIpICsgJzwvc3Bhbj4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgPHNwYW4gY2xhc3M9ImVkdWktY2xpY2thYmxlIiBvbmNsaWNrPSIkJC5fb25SZW1vdmVCdXR0b25DbGljayhcJ3VubGlua1wnKTsiPiAnICsgZWRpdG9yLmdldExhbmcoImNsZWFyIikgKyAnPC9zcGFuPjwvbm9icj4nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3B1cC5zaG93QW5jaG9yKGxpbmspOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKGh0bWwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBvcHVwLmdldERvbSgnY29udGVudCcpLmlubmVySFRNTCA9IGh0bWw7DQogICAgICAgICAgICAgICAgICAgICAgICBwb3B1cC5hbmNob3JFbCA9IGltZyB8fCBsaW5rOw0KICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXAuc2hvd0FuY2hvcihwb3B1cC5hbmNob3JFbCk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwb3B1cC5oaWRlKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9LA0KICAgICAgICBfaW5pdFRvb2xiYXJzOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBlZGl0b3IgPSB0aGlzLmVkaXRvcjsNCiAgICAgICAgICAgIHZhciB0b29sYmFycyA9IHRoaXMudG9vbGJhcnMgfHwgW107DQogICAgICAgICAgICB2YXIgdG9vbGJhclVpcyA9IFtdOw0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b29sYmFycy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgIHZhciB0b29sYmFyID0gdG9vbGJhcnNbaV07DQogICAgICAgICAgICAgICAgdmFyIHRvb2xiYXJVaSA9IG5ldyBiYWlkdS5lZGl0b3IudWkuVG9vbGJhcih7dGhlbWU6ZWRpdG9yLm9wdGlvbnMudGhlbWV9KTsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRvb2xiYXIubGVuZ3RoOyBqKyspIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHRvb2xiYXJJdGVtID0gdG9vbGJhcltqXTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHRvb2xiYXJJdGVtVWkgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRvb2xiYXJJdGVtID09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0b29sYmFySXRlbSA9IHRvb2xiYXJJdGVtLnRvTG93ZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9vbGJhckl0ZW0gPT0gJ3wnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGJhckl0ZW0gPSAnU2VwYXJhdG9yJzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRvb2xiYXJJdGVtID09ICd8fCcpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xiYXJJdGVtID0gJ0JyZWFrbGluZSc7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmFpZHUuZWRpdG9yLnVpW3Rvb2xiYXJJdGVtXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xiYXJJdGVtVWkgPSBuZXcgYmFpZHUuZWRpdG9yLnVpW3Rvb2xiYXJJdGVtXShlZGl0b3IpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAvL2Z1bGxzY3JlZW7ov5nph4zljZXni6zlpITnkIbkuIDkuIvvvIzmlL7liLDpppbooYzljrsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b29sYmFySXRlbSA9PSAnZnVsbHNjcmVlbicpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9vbGJhclVpcyAmJiB0b29sYmFyVWlzWzBdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xiYXJVaXNbMF0uaXRlbXMuc3BsaWNlKDAsIDAsIHRvb2xiYXJJdGVtVWkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xiYXJJdGVtVWkgJiYgdG9vbGJhclVpLml0ZW1zLnNwbGljZSgwLCAwLCB0b29sYmFySXRlbVVpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCg0KDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0b29sYmFySXRlbVVpID0gdG9vbGJhckl0ZW07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKHRvb2xiYXJJdGVtVWkgJiYgdG9vbGJhckl0ZW1VaS5pZCkgew0KDQogICAgICAgICAgICAgICAgICAgICAgICB0b29sYmFyVWkuYWRkKHRvb2xiYXJJdGVtVWkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRvb2xiYXJVaXNbaV0gPSB0b29sYmFyVWk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLnRvb2xiYXJzID0gdG9vbGJhclVpczsNCiAgICAgICAgfSwNCiAgICAgICAgZ2V0SHRtbFRwbDpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICByZXR1cm4gJzxkaXYgaWQ9IiMjIiBjbGFzcz0iJSUiPicgKw0KICAgICAgICAgICAgICAgICc8ZGl2IGlkPSIjI190b29sYmFyYm94IiBjbGFzcz0iJSUtdG9vbGJhcmJveCI+JyArDQogICAgICAgICAgICAgICAgKHRoaXMudG9vbGJhcnMubGVuZ3RoID8NCiAgICAgICAgICAgICAgICAgICAgJzxkaXYgaWQ9IiMjX3Rvb2xiYXJib3hvdXRlciIgY2xhc3M9IiUlLXRvb2xiYXJib3hvdXRlciI+PGRpdiBjbGFzcz0iJSUtdG9vbGJhcmJveGlubmVyIj4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyVG9vbGJhckJveEh0bWwoKSArDQogICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+PC9kaXY+JyA6ICcnKSArDQogICAgICAgICAgICAgICAgJzxkaXYgaWQ9IiMjX3Rvb2xiYXJtc2ciIGNsYXNzPSIlJS10b29sYmFybXNnIiBzdHlsZT0iZGlzcGxheTpub25lOyI+JyArDQogICAgICAgICAgICAgICAgJzxkaXYgaWQgPSAiIyNfdXBsb2FkX2RpYWxvZyIgY2xhc3M9IiUlLXRvb2xiYXJtc2ctdXBsb2FkIiBvbmNsaWNrPSIkJC5zaG93V29yZEltYWdlRGlhbG9nKCk7Ij4nICsgdGhpcy5lZGl0b3IuZ2V0TGFuZygiY2xpY2tUb1VwbG9hZCIpICsgJzwvZGl2PicgKw0KICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSIlJS10b29sYmFybXNnLWNsb3NlIiBvbmNsaWNrPSIkJC5oaWRlVG9vbGJhck1zZygpOyI+eDwvZGl2PicgKw0KICAgICAgICAgICAgICAgICc8ZGl2IGlkPSIjI190b29sYmFybXNnX2xhYmVsIiBjbGFzcz0iJSUtdG9vbGJhcm1zZy1sYWJlbCI+PC9kaXY+JyArDQogICAgICAgICAgICAgICAgJzxkaXYgc3R5bGU9ImhlaWdodDowO292ZXJmbG93OmhpZGRlbjtjbGVhcjpib3RoOyI+PC9kaXY+JyArDQogICAgICAgICAgICAgICAgJzwvZGl2PicgKw0KICAgICAgICAgICAgICAgICc8L2Rpdj4nICsNCiAgICAgICAgICAgICAgICAnPGRpdiBpZD0iIyNfaWZyYW1laG9sZGVyIiBjbGFzcz0iJSUtaWZyYW1laG9sZGVyIj48L2Rpdj4nICsNCiAgICAgICAgICAgICAgICAvL21vZGlmeSB3ZGNvdW50IGJ5IG1hdGFvDQogICAgICAgICAgICAgICAgJzxkaXYgaWQ9IiMjX2JvdHRvbWJhciIgY2xhc3M9IiUlLWJvdHRvbUNvbnRhaW5lciI+PHRhYmxlPjx0cj4nICsNCiAgICAgICAgICAgICAgICAnPHRkIGlkPSIjI19lbGVtZW50cGF0aCIgY2xhc3M9IiUlLWJvdHRvbWJhciI+PC90ZD4nICsNCiAgICAgICAgICAgICAgICAnPHRkIGlkPSIjI193b3JkY291bnQiIGNsYXNzPSIlJS13b3JkY291bnQiPjwvdGQ+JyArDQogICAgICAgICAgICAgICAgJzx0ZCBpZD0iIyNfc2NhbGUiIGNsYXNzPSIlJS1zY2FsZSI+PGRpdiBjbGFzcz0iJSUtaWNvbiI+PC9kaXY+PC90ZD4nICsNCiAgICAgICAgICAgICAgICAnPC90cj48L3RhYmxlPjwvZGl2PicgKw0KICAgICAgICAgICAgICAgICc8ZGl2IGlkPSIjI19zY2FsZWxheWVyIj48L2Rpdj4nICsNCiAgICAgICAgICAgICAgICAnPC9kaXY+JzsNCiAgICAgICAgfSwNCiAgICAgICAgc2hvd1dvcmRJbWFnZURpYWxvZzpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB0aGlzLmVkaXRvci5leGVjQ29tbWFuZCgid29yZGltYWdlIiwgIndvcmRfaW1nIik7DQogICAgICAgICAgICB0aGlzLl9kaWFsb2dzWyd3b3JkaW1hZ2VEaWFsb2cnXS5vcGVuKCk7DQogICAgICAgIH0sDQogICAgICAgIHJlbmRlclRvb2xiYXJCb3hIdG1sOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBidWZmID0gW107DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMudG9vbGJhcnMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICBidWZmLnB1c2godGhpcy50b29sYmFyc1tpXS5yZW5kZXJIdG1sKCkpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGJ1ZmYuam9pbignJyk7DQogICAgICAgIH0sDQogICAgICAgIHNldEZ1bGxTY3JlZW46ZnVuY3Rpb24gKGZ1bGxzY3JlZW4pIHsNCg0KICAgICAgICAgICAgdmFyIGVkaXRvciA9IHRoaXMuZWRpdG9yLA0KICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IGVkaXRvci5jb250YWluZXIucGFyZW50Tm9kZS5wYXJlbnROb2RlOw0KICAgICAgICAgICAgaWYgKHRoaXMuX2Z1bGxzY3JlZW4gIT0gZnVsbHNjcmVlbikgew0KICAgICAgICAgICAgICAgIHRoaXMuX2Z1bGxzY3JlZW4gPSBmdWxsc2NyZWVuOw0KICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLmZpcmVFdmVudCgnYmVmb3JlZnVsbHNjcmVlbmNoYW5nZScsIGZ1bGxzY3JlZW4pOw0KICAgICAgICAgICAgICAgIGlmIChiYWlkdS5lZGl0b3IuYnJvd3Nlci5nZWNrbykgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYmsgPSBlZGl0b3Iuc2VsZWN0aW9uLmdldFJhbmdlKCkuY3JlYXRlQm9va21hcmsoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKGZ1bGxzY3JlZW4pIHsNCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGNvbnRhaW5lci50YWdOYW1lICE9ICJCT0RZIikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvc2l0aW9uID0gYmFpZHUuZWRpdG9yLmRvbS5kb21VdGlscy5nZXRDb21wdXRlZFN0eWxlKGNvbnRhaW5lciwgInBvc2l0aW9uIik7DQogICAgICAgICAgICAgICAgICAgICAgICBub2RlU3RhY2sucHVzaChwb3NpdGlvbik7DQogICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuc3R5bGUucG9zaXRpb24gPSAic3RhdGljIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IGNvbnRhaW5lci5wYXJlbnROb2RlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2Jha0h0bWxPdmVyZmxvdyA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5vdmVyZmxvdzsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYmFrQm9keU92ZXJmbG93ID0gZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdzsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYmFrQXV0b0hlaWdodCA9IHRoaXMuZWRpdG9yLmF1dG9IZWlnaHRFbmFibGVkOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9iYWtTY3JvbGxUb3AgPSBNYXRoLm1heChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wLCBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCk7DQoNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYmFrRWRpdG9yQ29udGFuaW5lcldpZHRoID0gZWRpdG9yLmlmcmFtZS5wYXJlbnROb2RlLm9mZnNldFdpZHRoOw0KICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fYmFrQXV0b0hlaWdodCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy/lvZPlhajlsY/ml7bkuI3og73miafooYzoh6rliqjplb/pq5gNCiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5hdXRvSGVpZ2h0RW5hYmxlZCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lZGl0b3IuZGlzYWJsZUF1dG9IZWlnaHQoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nOw0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2Jha0Nzc1RleHQgPSB0aGlzLmdldERvbSgpLnN0eWxlLmNzc1RleHQ7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuX2Jha0Nzc1RleHQxID0gdGhpcy5nZXREb20oJ2lmcmFtZWhvbGRlcicpLnN0eWxlLmNzc1RleHQ7DQogICAgICAgICAgICAgICAgICAgIGVkaXRvci5pZnJhbWUucGFyZW50Tm9kZS5zdHlsZS53aWR0aCA9ICcnOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVGdWxsU2NyZWVuKCk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGNvbnRhaW5lci50YWdOYW1lICE9ICJCT0RZIikgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLnN0eWxlLnBvc2l0aW9uID0gbm9kZVN0YWNrLnNoaWZ0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIgPSBjb250YWluZXIucGFyZW50Tm9kZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmdldERvbSgpLnN0eWxlLmNzc1RleHQgPSB0aGlzLl9iYWtDc3NUZXh0Ow0KICAgICAgICAgICAgICAgICAgICB0aGlzLmdldERvbSgnaWZyYW1laG9sZGVyJykuc3R5bGUuY3NzVGV4dCA9IHRoaXMuX2Jha0Nzc1RleHQxOw0KICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fYmFrQXV0b0hlaWdodCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmF1dG9IZWlnaHRFbmFibGVkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLmVuYWJsZUF1dG9IZWlnaHQoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5vdmVyZmxvdyA9IHRoaXMuX2Jha0h0bWxPdmVyZmxvdzsNCiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IHRoaXMuX2Jha0JvZHlPdmVyZmxvdzsNCiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmlmcmFtZS5wYXJlbnROb2RlLnN0eWxlLndpZHRoID0gdGhpcy5fYmFrRWRpdG9yQ29udGFuaW5lcldpZHRoICsgJ3B4JzsNCiAgICAgICAgICAgICAgICAgICAgd2luZG93LnNjcm9sbFRvKDAsIHRoaXMuX2Jha1Njcm9sbFRvcCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChicm93c2VyLmdlY2tvICYmIGVkaXRvci5ib2R5LmNvbnRlbnRFZGl0YWJsZSA9PT0gJ3RydWUnKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7DQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaW5wdXQpOw0KICAgICAgICAgICAgICAgICAgICBlZGl0b3IuYm9keS5jb250ZW50RWRpdGFibGUgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5mb2N1cygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmJvZHkuY29udGVudEVkaXRhYmxlID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3IuZmlyZUV2ZW50KCdmdWxsc2NyZWVuY2hhbmdlZCcsIGZ1bGxzY3JlZW4pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5zZWxlY3Rpb24uZ2V0UmFuZ2UoKS5tb3ZlVG9Cb29rbWFyayhiaykuc2VsZWN0KHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhaWR1LmVkaXRvci5kb20uZG9tVXRpbHMucmVtb3ZlKGlucHV0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdWxsc2NyZWVuICYmIHdpbmRvdy5zY3JvbGwoMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9LCAwKQ0KICAgICAgICAgICAgICAgICAgICB9LCAwKQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmKGVkaXRvci5ib2R5LmNvbnRlbnRFZGl0YWJsZSA9PT0gJ3RydWUnKXsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lZGl0b3IuZmlyZUV2ZW50KCdmdWxsc2NyZWVuY2hhbmdlZCcsIGZ1bGxzY3JlZW4pOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXJMYXlvdXQoKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgX3VwZGF0ZUZ1bGxTY3JlZW46ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgaWYgKHRoaXMuX2Z1bGxzY3JlZW4pIHsNCiAgICAgICAgICAgICAgICB2YXIgdnBSZWN0ID0gdWlVdGlscy5nZXRWaWV3cG9ydFJlY3QoKTsNCiAgICAgICAgICAgICAgICB0aGlzLmdldERvbSgpLnN0eWxlLmNzc1RleHQgPSAnYm9yZGVyOjA7cG9zaXRpb246YWJzb2x1dGU7bGVmdDowO3RvcDonICsgKHRoaXMuZWRpdG9yLm9wdGlvbnMudG9wT2Zmc2V0IHx8IDApICsgJ3B4O3dpZHRoOicgKyB2cFJlY3Qud2lkdGggKyAncHg7aGVpZ2h0OicgKyB2cFJlY3QuaGVpZ2h0ICsgJ3B4O3otaW5kZXg6JyArICh0aGlzLmdldERvbSgpLnN0eWxlLnpJbmRleCAqIDEgKyAxMDApOw0KICAgICAgICAgICAgICAgIHVpVXRpbHMuc2V0Vmlld3BvcnRPZmZzZXQodGhpcy5nZXREb20oKSwgeyBsZWZ0OjAsIHRvcDp0aGlzLmVkaXRvci5vcHRpb25zLnRvcE9mZnNldCB8fCAwIH0pOw0KICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLnNldEhlaWdodCh2cFJlY3QuaGVpZ2h0IC0gdGhpcy5nZXREb20oJ3Rvb2xiYXJib3gnKS5vZmZzZXRIZWlnaHQgLSB0aGlzLmdldERvbSgnYm90dG9tYmFyJykub2Zmc2V0SGVpZ2h0IC0gKHRoaXMuZWRpdG9yLm9wdGlvbnMudG9wT2Zmc2V0IHx8IDApKTsNCiAgICAgICAgICAgICAgICAvL+S4jeaJi+WKqOiwg+S4gOS4i++8jOS8muWvvOiHtOWFqOWxj+WkseaViA0KICAgICAgICAgICAgICAgIGlmKGJyb3dzZXIuZ2Vja28pew0KICAgICAgICAgICAgICAgICAgICB0cnl7DQogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cub25yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfWNhdGNoKGUpew0KDQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgX3VwZGF0ZUVsZW1lbnRQYXRoOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBib3R0b20gPSB0aGlzLmdldERvbSgnZWxlbWVudHBhdGgnKSwgbGlzdDsNCiAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnRQYXRoRW5hYmxlZCAmJiAobGlzdCA9IHRoaXMuZWRpdG9yLnF1ZXJ5Q29tbWFuZFZhbHVlKCdlbGVtZW50cGF0aCcpKSkgew0KDQogICAgICAgICAgICAgICAgdmFyIGJ1ZmYgPSBbXTsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgY2k7IGNpID0gbGlzdFtpXTsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgIGJ1ZmZbaV0gPSB0aGlzLmZvcm1hdEh0bWwoJzxzcGFuIHVuc2VsZWN0YWJsZT0ib24iIG9uY2xpY2s9IiQkLmVkaXRvci5leGVjQ29tbWFuZCgmcXVvdDtlbGVtZW50cGF0aCZxdW90OywgJnF1b3Q7JyArIGkgKyAnJnF1b3Q7KTsiPicgKyBjaSArICc8L3NwYW4+Jyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGJvdHRvbS5pbm5lckhUTUwgPSAnPGRpdiBjbGFzcz0iZWR1aS1lZGl0b3ItYnJlYWRjcnVtYiIgb25tb3VzZWRvd249InJldHVybiBmYWxzZTsiPicgKyB0aGlzLmVkaXRvci5nZXRMYW5nKCJlbGVtZW50UGF0aFRpcCIpICsgJzogJyArIGJ1ZmYuam9pbignICZndDsgJykgKyAnPC9kaXY+JzsNCg0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBib3R0b20uc3R5bGUuZGlzcGxheSA9ICdub25lJw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBkaXNhYmxlRWxlbWVudFBhdGg6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIGJvdHRvbSA9IHRoaXMuZ2V0RG9tKCdlbGVtZW50cGF0aCcpOw0KICAgICAgICAgICAgYm90dG9tLmlubmVySFRNTCA9ICcnOw0KICAgICAgICAgICAgYm90dG9tLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICB0aGlzLmVsZW1lbnRQYXRoRW5hYmxlZCA9IGZhbHNlOw0KDQogICAgICAgIH0sDQogICAgICAgIGVuYWJsZUVsZW1lbnRQYXRoOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBib3R0b20gPSB0aGlzLmdldERvbSgnZWxlbWVudHBhdGgnKTsNCiAgICAgICAgICAgIGJvdHRvbS5zdHlsZS5kaXNwbGF5ID0gJyc7DQogICAgICAgICAgICB0aGlzLmVsZW1lbnRQYXRoRW5hYmxlZCA9IHRydWU7DQogICAgICAgICAgICB0aGlzLl91cGRhdGVFbGVtZW50UGF0aCgpOw0KICAgICAgICB9LA0KICAgICAgICBfc2NhbGU6ZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIGRvYyA9IGRvY3VtZW50LA0KICAgICAgICAgICAgICAgIGVkaXRvciA9IHRoaXMuZWRpdG9yLA0KICAgICAgICAgICAgICAgIGVkaXRvckhvbGRlciA9IGVkaXRvci5jb250YWluZXIsDQogICAgICAgICAgICAgICAgZWRpdG9yRG9jdW1lbnQgPSBlZGl0b3IuZG9jdW1lbnQsDQogICAgICAgICAgICAgICAgdG9vbGJhckJveCA9IHRoaXMuZ2V0RG9tKCJ0b29sYmFyYm94IiksDQogICAgICAgICAgICAgICAgYm90dG9tYmFyID0gdGhpcy5nZXREb20oImJvdHRvbWJhciIpLA0KICAgICAgICAgICAgICAgIHNjYWxlID0gdGhpcy5nZXREb20oInNjYWxlIiksDQogICAgICAgICAgICAgICAgc2NhbGVsYXllciA9IHRoaXMuZ2V0RG9tKCJzY2FsZWxheWVyIik7DQoNCiAgICAgICAgICAgIHZhciBpc01vdXNlTW92ZSA9IGZhbHNlLA0KICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gbnVsbCwNCiAgICAgICAgICAgICAgICBtaW5FZGl0b3JIZWlnaHQgPSAwLA0KICAgICAgICAgICAgICAgIG1pbkVkaXRvcldpZHRoID0gZWRpdG9yLm9wdGlvbnMubWluRnJhbWVXaWR0aCwNCiAgICAgICAgICAgICAgICBwYWdlWCA9IDAsDQogICAgICAgICAgICAgICAgcGFnZVkgPSAwLA0KICAgICAgICAgICAgICAgIHNjYWxlV2lkdGggPSAwLA0KICAgICAgICAgICAgICAgIHNjYWxlSGVpZ2h0ID0gMDsNCg0KICAgICAgICAgICAgZnVuY3Rpb24gZG93bigpIHsNCiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IGRvbVV0aWxzLmdldFhZKGVkaXRvckhvbGRlcik7DQoNCiAgICAgICAgICAgICAgICBpZiAoIW1pbkVkaXRvckhlaWdodCkgew0KICAgICAgICAgICAgICAgICAgICBtaW5FZGl0b3JIZWlnaHQgPSBlZGl0b3Iub3B0aW9ucy5taW5GcmFtZUhlaWdodCArIHRvb2xiYXJCb3gub2Zmc2V0SGVpZ2h0ICsgYm90dG9tYmFyLm9mZnNldEhlaWdodDsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBzY2FsZWxheWVyLnN0eWxlLmNzc1RleHQgPSAicG9zaXRpb246YWJzb2x1dGU7bGVmdDowO2Rpc3BsYXk6O3RvcDowO2JhY2tncm91bmQtY29sb3I6IzQxQUJGRjtvcGFjaXR5OjAuNDtmaWx0ZXI6IEFscGhhKG9wYWNpdHk9NDApO3dpZHRoOiIgKyBlZGl0b3JIb2xkZXIub2Zmc2V0V2lkdGggKyAicHg7aGVpZ2h0OiINCiAgICAgICAgICAgICAgICAgICAgKyBlZGl0b3JIb2xkZXIub2Zmc2V0SGVpZ2h0ICsgInB4O3otaW5kZXg6IiArIChlZGl0b3Iub3B0aW9ucy56SW5kZXggKyAxKTsNCg0KICAgICAgICAgICAgICAgIGRvbVV0aWxzLm9uKGRvYywgIm1vdXNlbW92ZSIsIG1vdmUpOw0KICAgICAgICAgICAgICAgIGRvbVV0aWxzLm9uKGVkaXRvckRvY3VtZW50LCAibW91c2V1cCIsIHVwKTsNCiAgICAgICAgICAgICAgICBkb21VdGlscy5vbihkb2MsICJtb3VzZXVwIiwgdXApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzOw0KICAgICAgICAgICAgLy9ieSB4dWhlbmcg5YWo5bGP5pe25YWz5o6J57yp5pS+DQogICAgICAgICAgICB0aGlzLmVkaXRvci5hZGRMaXN0ZW5lcignZnVsbHNjcmVlbmNoYW5nZWQnLCBmdW5jdGlvbiAoZSwgZnVsbFNjcmVlbikgew0KICAgICAgICAgICAgICAgIGlmIChmdWxsU2NyZWVuKSB7DQogICAgICAgICAgICAgICAgICAgIG1lLmRpc2FibGVTY2FsZSgpOw0KDQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKG1lLmVkaXRvci5vcHRpb25zLnNjYWxlRW5hYmxlZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuZW5hYmxlU2NhbGUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0bXBOb2RlID0gbWUuZWRpdG9yLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lLmVkaXRvci5ib2R5LmFwcGVuZENoaWxkKHRtcE5vZGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbWUuZWRpdG9yLmJvZHkuc3R5bGUuaGVpZ2h0ID0gTWF0aC5tYXgoZG9tVXRpbHMuZ2V0WFkodG1wTm9kZSkueSwgbWUuZWRpdG9yLmlmcmFtZS5vZmZzZXRIZWlnaHQgLSAyMCkgKyAncHgnOw0KICAgICAgICAgICAgICAgICAgICAgICAgZG9tVXRpbHMucmVtb3ZlKHRtcE5vZGUpDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIGZ1bmN0aW9uIG1vdmUoZXZlbnQpIHsNCiAgICAgICAgICAgICAgICBjbGVhclNlbGVjdGlvbigpOw0KICAgICAgICAgICAgICAgIHZhciBlID0gZXZlbnQgfHwgd2luZG93LmV2ZW50Ow0KICAgICAgICAgICAgICAgIHBhZ2VYID0gZS5wYWdlWCB8fCAoZG9jLmRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0ICsgZS5jbGllbnRYKTsNCiAgICAgICAgICAgICAgICBwYWdlWSA9IGUucGFnZVkgfHwgKGRvYy5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wICsgZS5jbGllbnRZKTsNCiAgICAgICAgICAgICAgICBzY2FsZVdpZHRoID0gcGFnZVggLSBwb3NpdGlvbi54Ow0KICAgICAgICAgICAgICAgIHNjYWxlSGVpZ2h0ID0gcGFnZVkgLSBwb3NpdGlvbi55Ow0KDQogICAgICAgICAgICAgICAgaWYgKHNjYWxlV2lkdGggPj0gbWluRWRpdG9yV2lkdGgpIHsNCiAgICAgICAgICAgICAgICAgICAgaXNNb3VzZU1vdmUgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICBzY2FsZWxheWVyLnN0eWxlLndpZHRoID0gc2NhbGVXaWR0aCArICdweCc7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChzY2FsZUhlaWdodCA+PSBtaW5FZGl0b3JIZWlnaHQpIHsNCiAgICAgICAgICAgICAgICAgICAgaXNNb3VzZU1vdmUgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICBzY2FsZWxheWVyLnN0eWxlLmhlaWdodCA9IHNjYWxlSGVpZ2h0ICsgInB4IjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGZ1bmN0aW9uIHVwKCkgew0KICAgICAgICAgICAgICAgIGlmIChpc01vdXNlTW92ZSkgew0KICAgICAgICAgICAgICAgICAgICBpc01vdXNlTW92ZSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICBlZGl0b3IudWkuX2FjdHVhbEZyYW1lV2lkdGggPSBzY2FsZWxheWVyLm9mZnNldFdpZHRoIC0gMjsNCiAgICAgICAgICAgICAgICAgICAgZWRpdG9ySG9sZGVyLnN0eWxlLndpZHRoID0gZWRpdG9yLnVpLl9hY3R1YWxGcmFtZVdpZHRoICsgJ3B4JzsNCg0KICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0SGVpZ2h0KHNjYWxlbGF5ZXIub2Zmc2V0SGVpZ2h0IC0gYm90dG9tYmFyLm9mZnNldEhlaWdodCAtIHRvb2xiYXJCb3gub2Zmc2V0SGVpZ2h0IC0gMik7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChzY2FsZWxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgIHNjYWxlbGF5ZXIuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgY2xlYXJTZWxlY3Rpb24oKTsNCiAgICAgICAgICAgICAgICBkb21VdGlscy51bihkb2MsICJtb3VzZW1vdmUiLCBtb3ZlKTsNCiAgICAgICAgICAgICAgICBkb21VdGlscy51bihlZGl0b3JEb2N1bWVudCwgIm1vdXNldXAiLCB1cCk7DQogICAgICAgICAgICAgICAgZG9tVXRpbHMudW4oZG9jLCAibW91c2V1cCIsIHVwKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgZnVuY3Rpb24gY2xlYXJTZWxlY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgaWYgKGJyb3dzZXIuaWUpDQogICAgICAgICAgICAgICAgICAgIGRvYy5zZWxlY3Rpb24uY2xlYXIoKTsNCiAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5nZXRTZWxlY3Rpb24oKS5yZW1vdmVBbGxSYW5nZXMoKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5lbmFibGVTY2FsZSA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAvL3RyYWNlOjI4NjgNCiAgICAgICAgICAgICAgICBpZiAoZWRpdG9yLnF1ZXJ5Q29tbWFuZFN0YXRlKCJzb3VyY2UiKSA9PSAxKSAgICByZXR1cm47DQogICAgICAgICAgICAgICAgc2NhbGUuc3R5bGUuZGlzcGxheSA9ICIiOw0KICAgICAgICAgICAgICAgIHRoaXMuc2NhbGVFbmFibGVkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICBkb21VdGlscy5vbihzY2FsZSwgIm1vdXNlZG93biIsIGRvd24pOw0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIHRoaXMuZGlzYWJsZVNjYWxlID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIHNjYWxlLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQogICAgICAgICAgICAgICAgdGhpcy5zY2FsZUVuYWJsZWQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICBkb21VdGlscy51bihzY2FsZSwgIm1vdXNlZG93biIsIGRvd24pOw0KICAgICAgICAgICAgfTsNCiAgICAgICAgfSwNCiAgICAgICAgaXNGdWxsU2NyZWVuOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLl9mdWxsc2NyZWVuOw0KICAgICAgICB9LA0KICAgICAgICBwb3N0UmVuZGVyOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIFVJQmFzZS5wcm90b3R5cGUucG9zdFJlbmRlci5jYWxsKHRoaXMpOw0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnRvb2xiYXJzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgdGhpcy50b29sYmFyc1tpXS5wb3N0UmVuZGVyKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB2YXIgbWUgPSB0aGlzOw0KICAgICAgICAgICAgdmFyIHRpbWVySWQsDQogICAgICAgICAgICAgICAgZG9tVXRpbHMgPSBiYWlkdS5lZGl0b3IuZG9tLmRvbVV0aWxzLA0KICAgICAgICAgICAgICAgIHVwZGF0ZUZ1bGxTY3JlZW5UaW1lID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZXJJZCk7DQogICAgICAgICAgICAgICAgICAgIHRpbWVySWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lLl91cGRhdGVGdWxsU2NyZWVuKCk7DQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICBkb21VdGlscy5vbih3aW5kb3csICdyZXNpemUnLCB1cGRhdGVGdWxsU2NyZWVuVGltZSk7DQoNCiAgICAgICAgICAgIG1lLmFkZExpc3RlbmVyKCdkZXN0cm95JywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIGRvbVV0aWxzLnVuKHdpbmRvdywgJ3Jlc2l6ZScsIHVwZGF0ZUZ1bGxTY3JlZW5UaW1lKTsNCiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZXJJZCk7DQogICAgICAgICAgICB9KQ0KICAgICAgICB9LA0KICAgICAgICBzaG93VG9vbGJhck1zZzpmdW5jdGlvbiAobXNnLCBmbGFnKSB7DQogICAgICAgICAgICB0aGlzLmdldERvbSgndG9vbGJhcm1zZ19sYWJlbCcpLmlubmVySFRNTCA9IG1zZzsNCiAgICAgICAgICAgIHRoaXMuZ2V0RG9tKCd0b29sYmFybXNnJykuc3R5bGUuZGlzcGxheSA9ICcnOw0KICAgICAgICAgICAgLy8NCiAgICAgICAgICAgIGlmICghZmxhZykgew0KICAgICAgICAgICAgICAgIHZhciB3ID0gdGhpcy5nZXREb20oJ3VwbG9hZF9kaWFsb2cnKTsNCiAgICAgICAgICAgICAgICB3LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGhpZGVUb29sYmFyTXNnOmZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHRoaXMuZ2V0RG9tKCd0b29sYmFybXNnJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgfSwNCiAgICAgICAgbWFwVXJsOmZ1bmN0aW9uICh1cmwpIHsNCiAgICAgICAgICAgIHJldHVybiB1cmwgPyB1cmwucmVwbGFjZSgnfi8nLCB0aGlzLmVkaXRvci5vcHRpb25zLlVFRElUT1JfSE9NRV9VUkwgfHwgJycpIDogJycNCiAgICAgICAgfSwNCiAgICAgICAgdHJpZ2dlckxheW91dDpmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgZG9tID0gdGhpcy5nZXREb20oKTsNCiAgICAgICAgICAgIGlmIChkb20uc3R5bGUuem9vbSA9PSAnMScpIHsNCiAgICAgICAgICAgICAgICBkb20uc3R5bGUuem9vbSA9ICcxMDAlJzsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgZG9tLnN0eWxlLnpvb20gPSAnMSc7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9Ow0KICAgIHV0aWxzLmluaGVyaXRzKEVkaXRvclVJLCBiYWlkdS5lZGl0b3IudWkuVUlCYXNlKTsNCg0KDQogICAgdmFyIGluc3RhbmNlcyA9IHt9Ow0KDQoNCiAgICBVRS51aS5FZGl0b3IgPSBmdW5jdGlvbiAob3B0aW9ucykgew0KICAgICAgICB2YXIgZWRpdG9yID0gbmV3IFVFLkVkaXRvcihvcHRpb25zKTsNCiAgICAgICAgZWRpdG9yLm9wdGlvbnMuZWRpdG9yID0gZWRpdG9yOw0KICAgICAgICB1dGlscy5sb2FkRmlsZShkb2N1bWVudCwgew0KICAgICAgICAgICAgaHJlZjplZGl0b3Iub3B0aW9ucy50aGVtZVBhdGggKyBlZGl0b3Iub3B0aW9ucy50aGVtZSArICIvY3NzL3VlZGl0b3IuY3NzIiwNCiAgICAgICAgICAgIHRhZzoibGluayIsDQogICAgICAgICAgICB0eXBlOiJ0ZXh0L2NzcyIsDQogICAgICAgICAgICByZWw6InN0eWxlc2hlZXQiDQogICAgICAgIH0pOw0KDQogICAgICAgIHZhciBvbGRSZW5kZXIgPSBlZGl0b3IucmVuZGVyOw0KICAgICAgICBlZGl0b3IucmVuZGVyID0gZnVuY3Rpb24gKGhvbGRlcikgew0KICAgICAgICAgICAgaWYgKGhvbGRlci5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKSB7DQogICAgICAgICAgICAgICAgZWRpdG9yLmtleSA9IGhvbGRlcjsNCiAgICAgICAgICAgICAgICBpbnN0YW5jZXNbaG9sZGVyXSA9IGVkaXRvcjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHV0aWxzLmRvbVJlYWR5KGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICBlZGl0b3IubGFuZ0lzUmVhZHkgPyByZW5kZXJVSSgpIDogZWRpdG9yLmFkZExpc3RlbmVyKCJsYW5nUmVhZHkiLCByZW5kZXJVSSk7DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gcmVuZGVyVUkoKSB7DQogICAgICAgICAgICAgICAgICAgIGVkaXRvci5zZXRPcHQoew0KICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxNYXA6ZWRpdG9yLm9wdGlvbnMubGFiZWxNYXAgfHwgZWRpdG9yLmdldExhbmcoJ2xhYmVsTWFwJykNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIG5ldyBFZGl0b3JVSShlZGl0b3Iub3B0aW9ucyk7DQogICAgICAgICAgICAgICAgICAgIGlmIChob2xkZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChob2xkZXIuY29uc3RydWN0b3IgPT09IFN0cmluZykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGhvbGRlcik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBob2xkZXIgJiYgaG9sZGVyLmdldEF0dHJpYnV0ZSgnbmFtZScpICYmICggZWRpdG9yLm9wdGlvbnMudGV4dGFyZWEgPSBob2xkZXIuZ2V0QXR0cmlidXRlKCduYW1lJykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhvbGRlciAmJiAvc2NyaXB0fHRleHRhcmVhL2lnLnRlc3QoaG9sZGVyLnRhZ05hbWUpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld0RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGRlci5wYXJlbnROb2RlLmluc2VydEJlZm9yZShuZXdEaXYsIGhvbGRlcik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnQgPSBob2xkZXIudmFsdWUgfHwgaG9sZGVyLmlubmVySFRNTDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3Iub3B0aW9ucy5pbml0aWFsQ29udGVudCA9IC9eW1x0XHJcbiBdKiQvLnRlc3QoY29udCkgPyBlZGl0b3Iub3B0aW9ucy5pbml0aWFsQ29udGVudCA6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnQucmVwbGFjZSgvPltcblxyXHRdKyhbIF17NH0pKy9nLCAnPicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvW1xuXHJcdF0rKFsgXXs0fSkrPC9nLCAnPCcpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvPltcblxyXHRdKzwvZywgJz48Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9sZGVyLmNsYXNzTmFtZSAmJiAobmV3RGl2LmNsYXNzTmFtZSA9IGhvbGRlci5jbGFzc05hbWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGRlci5zdHlsZS5jc3NUZXh0ICYmIChuZXdEaXYuc3R5bGUuY3NzVGV4dCA9IGhvbGRlci5zdHlsZS5jc3NUZXh0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoL3RleHRhcmVhL2kudGVzdChob2xkZXIudGFnTmFtZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnRleHRhcmVhID0gaG9sZGVyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3IudGV4dGFyZWEuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGRlci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGhvbGRlcik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGRlci5pZCAmJiAobmV3RGl2LmlkID0gaG9sZGVyLmlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9sZGVyID0gbmV3RGl2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGRlci5pbm5lckhUTUwgPSAnJzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGRvbVV0aWxzLmFkZENsYXNzKGhvbGRlciwgImVkdWktIiArIGVkaXRvci5vcHRpb25zLnRoZW1lKTsNCiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnVpLnJlbmRlcihob2xkZXIpOw0KICAgICAgICAgICAgICAgICAgICB2YXIgb3B0ID0gZWRpdG9yLm9wdGlvbnM7DQogICAgICAgICAgICAgICAgICAgIC8v57uZ5a6e5L6L5re75Yqg5LiA5Liq57yW6L6R5Zmo55qE5a655Zmo5byV55SoDQogICAgICAgICAgICAgICAgICAgIGVkaXRvci5jb250YWluZXIgPSBlZGl0b3IudWkuZ2V0RG9tKCk7DQogICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnRzID0gZG9tVXRpbHMuZmluZFBhcmVudHMoaG9sZGVyLHRydWUpOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZGlzcGxheXMgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpID0gMCAsY2k7Y2k9cGFyZW50c1tpXTtpKyspew0KICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheXNbaV0gPSBjaS5zdHlsZS5kaXNwbGF5Ow0KICAgICAgICAgICAgICAgICAgICAgICAgY2kuc3R5bGUuZGlzcGxheSA9ICdibG9jaycNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAob3B0LmluaXRpYWxGcmFtZVdpZHRoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBvcHQubWluRnJhbWVXaWR0aCA9IG9wdC5pbml0aWFsRnJhbWVXaWR0aDsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9wdC5taW5GcmFtZVdpZHRoID0gb3B0LmluaXRpYWxGcmFtZVdpZHRoID0gaG9sZGVyLm9mZnNldFdpZHRoOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmIChvcHQuaW5pdGlhbEZyYW1lSGVpZ2h0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBvcHQubWluRnJhbWVIZWlnaHQgPSBvcHQuaW5pdGlhbEZyYW1lSGVpZ2h0Ow0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgb3B0LmluaXRpYWxGcmFtZUhlaWdodCA9IG9wdC5taW5GcmFtZUhlaWdodCA9IGhvbGRlci5vZmZzZXRIZWlnaHQ7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpID0gMCAsY2k7Y2k9cGFyZW50c1tpXTtpKyspew0KICAgICAgICAgICAgICAgICAgICAgICAgY2kuc3R5bGUuZGlzcGxheSA9ICBkaXNwbGF5c1tpXQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIC8v57yW6L6R5Zmo5pyA5aSW5a655Zmo6K6+572u5LqG6auY5bqm77yM5Lya5a+86Ie077yM57yW6L6R5Zmo5LiN5Y2g5L2NDQogICAgICAgICAgICAgICAgICAgIC8vdG9kbyDlhYjljrvmjonvvIzmsqHmnInmib7liLDljp/lm6ANCiAgICAgICAgICAgICAgICAgICAgaWYoaG9sZGVyLnN0eWxlLmhlaWdodCl7DQogICAgICAgICAgICAgICAgICAgICAgICBob2xkZXIuc3R5bGUuaGVpZ2h0ID0gJycNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBlZGl0b3IuY29udGFpbmVyLnN0eWxlLndpZHRoID0gb3B0LmluaXRpYWxGcmFtZVdpZHRoICsgKC8lJC8udGVzdChvcHQuaW5pdGlhbEZyYW1lV2lkdGgpID8gJycgOiAncHgnKTsNCiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmNvbnRhaW5lci5zdHlsZS56SW5kZXggPSBvcHQuekluZGV4Ow0KICAgICAgICAgICAgICAgICAgICBvbGRSZW5kZXIuY2FsbChlZGl0b3IsIGVkaXRvci51aS5nZXREb20oJ2lmcmFtZWhvbGRlcicpKTsNCg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pDQogICAgICAgIH07DQogICAgICAgIHJldHVybiBlZGl0b3I7DQogICAgfTsNCg0KDQogICAgLyoqDQogICAgICogQGZpbGUNCiAgICAgKiBAbmFtZSBVRQ0KICAgICAqIEBzaG9ydCBVRQ0KICAgICAqIEBkZXNjIFVFZGl0b3LnmoTpobbpg6jlkb3lkI3nqbrpl7QNCiAgICAgKi8NCiAgICAvKioNCiAgICAgKiBAbmFtZSBnZXRFZGl0b3INCiAgICAgKiBAc2luY2UgMS4yLjQrDQogICAgICogQGdyYW1tYXIgVUUuZ2V0RWRpdG9yKGlkLFtvcHRdKSAgPT4gIEVkaXRvcuWunuS+iw0KICAgICAqIEBkZXNjIOaPkOS+m+S4gOS4quWFqOWxgOeahOaWueazleW+l+WIsOe8lui+keWZqOWunuS+iw0KICAgICAqDQogICAgICogKiAnJ2lkJycgIOaUvue9rue8lui+keWZqOeahOWuueWZqGlkLCDlpoLmnpzlrrnlmajkuIvnmoTnvJbovpHlmajlt7Lnu4/lrZjlnKjvvIzlsLHnm7TmjqXov5Tlm54NCiAgICAgKiAqICcnb3B0Jycg57yW6L6R5Zmo55qE5Y+v6YCJ5Y+C5pWwDQogICAgICogQGV4YW1wbGUNCiAgICAgKiAgVUUuZ2V0RWRpdG9yKCdjb250YWluZXJJZCcse29ucmVhZHk6ZnVuY3Rpb24oKXsvL+WIm+W7uuS4gOS4que8lui+keWZqOWunuS+iw0KICAgICAqICAgICAgdGhpcy5zZXRDb250ZW50KCdoZWxsbycpDQogICAgICogIH19KTsNCiAgICAgKiAgVUUuZ2V0RWRpdG9yKCdjb250YWluZXJJZCcpOyAvL+i/lOWbnuWImuWIm+W7uueahOWunuS+iw0KICAgICAqDQogICAgICovDQogICAgVUUuZ2V0RWRpdG9yID0gZnVuY3Rpb24gKGlkLCBvcHQpIHsNCiAgICAgICAgdmFyIGVkaXRvciA9IGluc3RhbmNlc1tpZF07DQogICAgICAgIGlmICghZWRpdG9yKSB7DQogICAgICAgICAgICBlZGl0b3IgPSBpbnN0YW5jZXNbaWRdID0gbmV3IFVFLnVpLkVkaXRvcihvcHQpOw0KICAgICAgICAgICAgZWRpdG9yLnJlbmRlcihpZCk7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIGVkaXRvcjsNCiAgICB9Ow0KDQoNCiAgICBVRS5kZWxFZGl0b3IgPSBmdW5jdGlvbiAoaWQpIHsNCiAgICAgICAgdmFyIGVkaXRvcjsNCiAgICAgICAgaWYgKGVkaXRvciA9IGluc3RhbmNlc1tpZF0pIHsNCiAgICAgICAgICAgIGVkaXRvci5rZXkgJiYgZWRpdG9yLmRlc3Ryb3koKTsNCiAgICAgICAgICAgIGRlbGV0ZSBpbnN0YW5jZXNbaWRdDQogICAgICAgIH0NCiAgICB9DQp9KSgpOwovLy9pbXBvcnQgY29yZQ0KLy8vaW1wb3J0IHVpY29yZQ0KIC8vL2NvbW1hbmRzIOihqOaDhQ0KKGZ1bmN0aW9uKCl7DQogICAgdmFyIHV0aWxzID0gYmFpZHUuZWRpdG9yLnV0aWxzLA0KICAgICAgICBQb3B1cCA9IGJhaWR1LmVkaXRvci51aS5Qb3B1cCwNCiAgICAgICAgU3BsaXRCdXR0b24gPSBiYWlkdS5lZGl0b3IudWkuU3BsaXRCdXR0b24sDQogICAgICAgIE11bHRpTWVudVBvcCA9IGJhaWR1LmVkaXRvci51aS5NdWx0aU1lbnVQb3AgPSBmdW5jdGlvbihvcHRpb25zKXsNCiAgICAgICAgICAgIHRoaXMuaW5pdE9wdGlvbnMob3B0aW9ucyk7DQogICAgICAgICAgICB0aGlzLmluaXRNdWx0aU1lbnUoKTsNCiAgICAgICAgfTsNCg0KICAgIE11bHRpTWVudVBvcC5wcm90b3R5cGUgPSB7DQogICAgICAgIGluaXRNdWx0aU1lbnU6IGZ1bmN0aW9uICgpew0KICAgICAgICAgICAgdmFyIG1lID0gdGhpczsNCiAgICAgICAgICAgIHRoaXMucG9wdXAgPSBuZXcgUG9wdXAoew0KICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICcnLA0KICAgICAgICAgICAgICAgIGVkaXRvciA6IG1lLmVkaXRvciwNCiAgICAgICAgICAgICAgICBpZnJhbWVfcmVuZGVyZWQ6IGZhbHNlLA0KICAgICAgICAgICAgICAgIG9uc2hvdzogZnVuY3Rpb24gKCl7DQogICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pZnJhbWVfcmVuZGVyZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaWZyYW1lX3JlbmRlcmVkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0RG9tKCdjb250ZW50JykuaW5uZXJIVE1MID0gJzxpZnJhbWUgaWQ9IicrbWUuaWQrJ19pZnJhbWUiIHNyYz0iJysgbWUuaWZyYW1lVXJsICsnIiBmcmFtZWJvcmRlcj0iMCI+PC9pZnJhbWU+JzsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lLmVkaXRvci5jb250YWluZXIuc3R5bGUuekluZGV4ICYmICh0aGlzLmdldERvbSgpLnN0eWxlLnpJbmRleCA9IG1lLmVkaXRvci5jb250YWluZXIuc3R5bGUuekluZGV4ICogMSArIDEpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgLy8gY2FuU2lkZVVwOmZhbHNlLA0KICAgICAgICAgICAgICAgLy8gY2FuU2lkZUxlZnQ6ZmFsc2UNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgdGhpcy5vbmJ1dHRvbmNsaWNrID0gZnVuY3Rpb24oKXsNCiAgICAgICAgICAgICAgICB0aGlzLnNob3dQb3B1cCgpOw0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIHRoaXMuaW5pdFNwbGl0QnV0dG9uKCk7DQogICAgICAgIH0NCg0KICAgIH07DQoNCiAgICB1dGlscy5pbmhlcml0cyhNdWx0aU1lbnVQb3AsIFNwbGl0QnV0dG9uKTsNCn0pKCk7DQoKKGZ1bmN0aW9uICgpIHsKICAgIHZhciBVSSA9IGJhaWR1LmVkaXRvci51aSwKICAgICAgICBVSUJhc2UgPSBVSS5VSUJhc2UsCiAgICAgICAgdWlVdGlscyA9IFVJLnVpVXRpbHMsCiAgICAgICAgdXRpbHMgPSBiYWlkdS5lZGl0b3IudXRpbHMsCiAgICAgICAgZG9tVXRpbHMgPSBiYWlkdS5lZGl0b3IuZG9tLmRvbVV0aWxzOwoKICAgIHZhciBhbGxNZW51cyA9IFtdLC8v5a2Y5YKo5omA5pyJ5b+r5o236I+c5Y2VCiAgICAgICAgdGltZUlELAogICAgICAgIGlzU3ViTWVudVNob3cgPSBmYWxzZTsvL+aYr+WQpuacieWtkHBvcOaYvuekugoKICAgIHZhciBTaG9ydEN1dE1lbnUgPSBVSS5TaG9ydEN1dE1lbnUgPSBmdW5jdGlvbiAob3B0aW9ucykgewogICAgICAgIHRoaXMuaW5pdE9wdGlvbnMgKG9wdGlvbnMpOwogICAgICAgIHRoaXMuaW5pdFNob3J0Q3V0TWVudSAoKTsKICAgIH07CgogICAgU2hvcnRDdXRNZW51LnBvc3RIaWRlID0gaGlkZUFsbE1lbnU7CgogICAgU2hvcnRDdXRNZW51LnByb3RvdHlwZSA9IHsKICAgICAgICBpc0hpZGRlbiA6IHRydWUgLAogICAgICAgIFNQQUNFIDogNSAsCiAgICAgICAgaW5pdFNob3J0Q3V0TWVudSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdGhpcy5pdGVtcyA9IHRoaXMuaXRlbXMgfHwgW107CiAgICAgICAgICAgIHRoaXMuaW5pdFVJQmFzZSAoKTsKICAgICAgICAgICAgdGhpcy5pbml0SXRlbXMgKCk7CiAgICAgICAgICAgIHRoaXMuaW5pdEV2ZW50ICgpOwogICAgICAgICAgICBhbGxNZW51cy5wdXNoICh0aGlzKTsKICAgICAgICB9ICwKICAgICAgICBpbml0RXZlbnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBtZSA9IHRoaXMsCiAgICAgICAgICAgICAgICBkb2MgPSBtZS5lZGl0b3IuZG9jdW1lbnQ7CgogICAgICAgICAgICBkb21VdGlscy5vbiAoZG9jICwgIm1vdXNlbW92ZSIgLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgaWYgKG1lLmlzSGlkZGVuID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgIC8v5pyJcG9w5pi+56S65bCx5LiN6ZqQ6JeP5b+r5o236I+c5Y2VCiAgICAgICAgICAgICAgICAgICAgaWYgKG1lLmdldFN1Yk1lbnVNYXJrICgpIHx8IG1lLmV2ZW50VHlwZSA9PSAiY29udGV4dG1lbnUiKSAgIHJldHVybjsKCgogICAgICAgICAgICAgICAgICAgIHZhciBmbGFnID0gdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgZWwgPSBtZS5nZXREb20gKCksCiAgICAgICAgICAgICAgICAgICAgICAgIHd0ID0gZWwub2Zmc2V0V2lkdGgsCiAgICAgICAgICAgICAgICAgICAgICAgIGh0ID0gZWwub2Zmc2V0SGVpZ2h0LAogICAgICAgICAgICAgICAgICAgICAgICBkaXN0YW5jZVggPSB3dCAvIDIgKyBtZS5TUEFDRSwvL+i3neemu+S4reW/g1jmoIflh4YKICAgICAgICAgICAgICAgICAgICAgICAgZGlzdGFuY2VZID0gaHQgLyAyLC8v6Led56a75Lit5b+DWeagh+WHhgogICAgICAgICAgICAgICAgICAgICAgICB4ID0gTWF0aC5hYnMgKGUuc2NyZWVuWCAtIG1lLmxlZnQpLC8v56a75Lit5b+D6Led56a75qiq5Z2Q5qCHCiAgICAgICAgICAgICAgICAgICAgICAgIHkgPSBNYXRoLmFicyAoZS5zY3JlZW5ZIC0gbWUudG9wKTsvL+emu+S4reW/g+i3neemu+e6teWdkOaghwoKICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQgKHRpbWVJRCk7CiAgICAgICAgICAgICAgICAgICAgdGltZUlEID0gc2V0VGltZW91dCAoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoeSA+IDAgJiYgeSA8IGRpc3RhbmNlWSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUuc2V0T3BhY2l0eSAoZWwgLCAiMSIpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHkgPiBkaXN0YW5jZVkgJiYgeSA8IGRpc3RhbmNlWSArIDcwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZS5zZXRPcGFjaXR5IChlbCAsICIwLjUiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsYWcgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh5ID4gZGlzdGFuY2VZICsgNzAgJiYgeSA8IGRpc3RhbmNlWSArIDE0MCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUuaGlkZSAoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZsYWcgJiYgeCA+IDAgJiYgeCA8IGRpc3RhbmNlWCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUuc2V0T3BhY2l0eSAoZWwgLCAiMSIpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoeCA+IGRpc3RhbmNlWCAmJiB4IDwgZGlzdGFuY2VYICsgNzApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lLnNldE9wYWNpdHkgKGVsICwgIjAuNSIpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoeCA+IGRpc3RhbmNlWCArIDcwICYmIHggPCBkaXN0YW5jZVggKyAxNDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lLmhpZGUgKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvL2llXGZm5LiLIG1vdXNlb3V05LiN5YeGCiAgICAgICAgICAgIGlmIChicm93c2VyLmNocm9tZSkgewogICAgICAgICAgICAgICAgZG9tVXRpbHMub24gKGRvYyAsICJtb3VzZW91dCIgLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICAgIHZhciByZWxhdGVkVGd0ID0gZS5yZWxhdGVkVGFyZ2V0IHx8IGUudG9FbGVtZW50OwoKICAgICAgICAgICAgICAgICAgICBpZiAocmVsYXRlZFRndCA9PSBudWxsIHx8IHJlbGF0ZWRUZ3QudGFnTmFtZSA9PSAiSFRNTCIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbWUuaGlkZSAoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbWUuZWRpdG9yLmFkZExpc3RlbmVyICgiYWZ0ZXJoaWRlcG9wIiAsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIGlmICghbWUuaXNIaWRkZW4pIHsKICAgICAgICAgICAgICAgICAgICBpc1N1Yk1lbnVTaG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgIH0gLAogICAgICAgIGluaXRJdGVtcyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKHV0aWxzLmlzQXJyYXkgKHRoaXMuaXRlbXMpKSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdGhpcy5pdGVtcy5sZW5ndGggOyBpIDwgbGVuIDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSB0aGlzLml0ZW1zW2ldLnRvTG93ZXJDYXNlICgpOwoKICAgICAgICAgICAgICAgICAgICBpZiAoVUlbaXRlbV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtc1tpXSA9IG5ldyBVSVtpdGVtXSAodGhpcy5lZGl0b3IpOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLml0ZW1zW2ldLmNsYXNzTmFtZSArPSAiIGVkdWktc2hvcnRjdXRzdWJtZW51ICI7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSAsCiAgICAgICAgc2V0T3BhY2l0eSA6IGZ1bmN0aW9uIChlbCAsIHZhbHVlKSB7CiAgICAgICAgICAgIGlmIChicm93c2VyLmllICYmIGJyb3dzZXIudmVyc2lvbiA8IDkpIHsKICAgICAgICAgICAgICAgIGVsLnN0eWxlLmZpbHRlciA9ICJhbHBoYShvcGFjaXR5ID0gIiArIHBhcnNlRmxvYXQgKHZhbHVlKSAqIDEwMCArICIpOyIKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGVsLnN0eWxlLm9wYWNpdHkgPSB2YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0gLAogICAgICAgIGdldFN1Yk1lbnVNYXJrIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICBpc1N1Yk1lbnVTaG93ID0gZmFsc2U7CiAgICAgICAgICAgIHZhciBsYXllckVsZSA9IHVpVXRpbHMuZ2V0Rml4ZWRMYXllciAoKTsKICAgICAgICAgICAgdmFyIGxpc3QgPSBkb21VdGlscy5nZXRFbGVtZW50c0J5VGFnTmFtZSAobGF5ZXJFbGUgLCAiZGl2IiAsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZG9tVXRpbHMuaGFzQ2xhc3MgKG5vZGUgLCAiZWR1aS1zaG9ydGN1dHN1Ym1lbnUgZWR1aS1wb3B1cCIpCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG5vZGUgOyBub2RlID0gbGlzdFtpKytdIDspIHsKICAgICAgICAgICAgICAgIGlmIChub2RlLnN0eWxlLmRpc3BsYXkgIT0gIm5vbmUiKSB7CiAgICAgICAgICAgICAgICAgICAgaXNTdWJNZW51U2hvdyA9IHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGlzU3ViTWVudVNob3c7CiAgICAgICAgfSAsCiAgICAgICAgc2hvdyA6IGZ1bmN0aW9uIChlICwgaGFzQ29udGV4dG1lbnUpIHsKICAgICAgICAgICAgdmFyIG1lID0gdGhpcywKICAgICAgICAgICAgICAgIG9mZnNldCA9IHt9LAogICAgICAgICAgICAgICAgZWwgPSB0aGlzLmdldERvbSAoKSwKICAgICAgICAgICAgICAgIGZpeGVkbGF5ZXIgPSB1aVV0aWxzLmdldEZpeGVkTGF5ZXIgKCk7CgogICAgICAgICAgICBmdW5jdGlvbiBzZXRQb3MgKG9mZnNldCkgewogICAgICAgICAgICAgICAgaWYgKG9mZnNldC5sZWZ0IDwgMCkgewogICAgICAgICAgICAgICAgICAgIG9mZnNldC5sZWZ0ID0gMDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChvZmZzZXQudG9wIDwgMCkgewogICAgICAgICAgICAgICAgICAgIG9mZnNldC50b3AgPSAwOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWwuc3R5bGUuY3NzVGV4dCA9ICJwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OiIgKyBvZmZzZXQubGVmdCArICJweDt0b3A6IiArIG9mZnNldC50b3AgKyAicHg7IjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gc2V0UG9zQnlDeHRNZW51IChtZW51KSB7CiAgICAgICAgICAgICAgICBpZiAoIW1lbnUudGFnTmFtZSkgewogICAgICAgICAgICAgICAgICAgIG1lbnUgPSBtZW51LmdldERvbSAoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIG9mZnNldC5sZWZ0ID0gcGFyc2VJbnQgKG1lbnUuc3R5bGUubGVmdCk7CiAgICAgICAgICAgICAgICBvZmZzZXQudG9wID0gcGFyc2VJbnQgKG1lbnUuc3R5bGUudG9wKTsKICAgICAgICAgICAgICAgIG9mZnNldC50b3AgLT0gZWwub2Zmc2V0SGVpZ2h0ICsgMTU7CiAgICAgICAgICAgICAgICBzZXRQb3MgKG9mZnNldCk7CiAgICAgICAgICAgIH0KCgogICAgICAgICAgICBtZS5ldmVudFR5cGUgPSBlLnR5cGU7CiAgICAgICAgICAgIGVsLnN0eWxlLmNzc1RleHQgPSAiZGlzcGxheTpibG9jaztsZWZ0Oi05OTk5cHgiOwoKICAgICAgICAgICAgaWYgKGUudHlwZSA9PSAiY29udGV4dG1lbnUiICYmIGhhc0NvbnRleHRtZW51KSB7CiAgICAgICAgICAgICAgICB2YXIgbWVudSA9IGRvbVV0aWxzLmdldEVsZW1lbnRzQnlUYWdOYW1lIChmaXhlZGxheWVyICwgImRpdiIgLCAiZWR1aS1jb250ZXh0bWVudSIpWzBdOwogICAgICAgICAgICAgICAgaWYgKG1lbnUpIHsKICAgICAgICAgICAgICAgICAgICBzZXRQb3NCeUN4dE1lbnUgKG1lbnUpCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIG1lLmVkaXRvci5hZGRMaXN0ZW5lciAoImFmdGVyc2hvd2NvbnRleHRtZW51IiAsIGZ1bmN0aW9uICh0eXBlICwgbWVudSkgewogICAgICAgICAgICAgICAgICAgICAgICBzZXRQb3NCeUN4dE1lbnUgKG1lbnUpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgb2Zmc2V0ID0gdWlVdGlscy5nZXRWaWV3cG9ydE9mZnNldEJ5RXZlbnQgKGUpOwogICAgICAgICAgICAgICAgb2Zmc2V0LnRvcCAtPSBlbC5vZmZzZXRIZWlnaHQgKyBtZS5TUEFDRTsKICAgICAgICAgICAgICAgIG9mZnNldC5sZWZ0ICs9IG1lLlNQQUNFICsgMjA7CiAgICAgICAgICAgICAgICBzZXRQb3MgKG9mZnNldCk7CiAgICAgICAgICAgICAgICBtZS5zZXRPcGFjaXR5IChlbCAsIDAuMik7CiAgICAgICAgICAgIH0KCgogICAgICAgICAgICBtZS5pc0hpZGRlbiA9IGZhbHNlOwogICAgICAgICAgICBtZS5sZWZ0ID0gZS5zY3JlZW5YICsgZWwub2Zmc2V0V2lkdGggLyAyIC0gbWUuU1BBQ0U7CiAgICAgICAgICAgIG1lLnRvcCA9IGUuc2NyZWVuWSAtIChlbC5vZmZzZXRIZWlnaHQgLyAyKSAtIG1lLlNQQUNFOwoKICAgICAgICAgICAgaWYgKG1lLmVkaXRvcikgewogICAgICAgICAgICAgICAgZWwuc3R5bGUuekluZGV4ID0gbWUuZWRpdG9yLmNvbnRhaW5lci5zdHlsZS56SW5kZXggKiAxICsgMTA7CiAgICAgICAgICAgICAgICBmaXhlZGxheWVyLnN0eWxlLnpJbmRleCA9IGVsLnN0eWxlLnpJbmRleCAtIDE7CiAgICAgICAgICAgIH0KICAgICAgICB9ICwKICAgICAgICBoaWRlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICBpZiAodGhpcy5nZXREb20gKCkpIHsKICAgICAgICAgICAgICAgIHRoaXMuZ2V0RG9tICgpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5pc0hpZGRlbiA9IHRydWU7CiAgICAgICAgfSAsCiAgICAgICAgcG9zdFJlbmRlciA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKHV0aWxzLmlzQXJyYXkgKHRoaXMuaXRlbXMpKSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgaXRlbSA7IGl0ZW0gPSB0aGlzLml0ZW1zW2krK10gOykgewogICAgICAgICAgICAgICAgICAgIGl0ZW0ucG9zdFJlbmRlciAoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0gLAogICAgICAgIGdldEh0bWxUcGwgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBidWZmOwogICAgICAgICAgICBpZiAodXRpbHMuaXNBcnJheSAodGhpcy5pdGVtcykpIHsKICAgICAgICAgICAgICAgIGJ1ZmYgPSBbXTsKICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwIDsgaSA8IHRoaXMuaXRlbXMubGVuZ3RoIDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgYnVmZltpXSA9IHRoaXMuaXRlbXNbaV0ucmVuZGVySHRtbCAoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJ1ZmYgPSBidWZmLmpvaW4gKCIiKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGJ1ZmYgPSB0aGlzLml0ZW1zOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gJzxkaXYgaWQ9IiMjIiBjbGFzcz0iJSUgZWR1aS10b29sYmFyIiBkYXRhLXNyYz0ic2hvcnRjdXRtZW51IiBvbm1vdXNlZG93bj0icmV0dXJuIGZhbHNlOyIgb25zZWxlY3RzdGFydD0icmV0dXJuIGZhbHNlOyIgPicgKwogICAgICAgICAgICAgICAgYnVmZiArCiAgICAgICAgICAgICAgICAnPC9kaXY+JzsKICAgICAgICB9CiAgICB9OwoKICAgIHV0aWxzLmluaGVyaXRzIChTaG9ydEN1dE1lbnUgLCBVSUJhc2UpOwoKICAgIGZ1bmN0aW9uIGhpZGVBbGxNZW51IChlKSB7CiAgICAgICAgdmFyIHRndCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudCwKICAgICAgICAgICAgY3VyID0gZG9tVXRpbHMuZmluZFBhcmVudCAodGd0ICwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBkb21VdGlscy5oYXNDbGFzcyAobm9kZSAsICJlZHVpLXNob3J0Y3V0bWVudSIpIHx8IGRvbVV0aWxzLmhhc0NsYXNzIChub2RlICwgImVkdWktcG9wdXAiKTsKICAgICAgICAgICAgfSAsIHRydWUpOwoKICAgICAgICBpZiAoIWN1cikgewogICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbWVudSA7IG1lbnUgPSBhbGxNZW51c1tpKytdIDspIHsKICAgICAgICAgICAgICAgIG1lbnUuaGlkZSAoKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGRvbVV0aWxzLm9uIChkb2N1bWVudCAsICdtb3VzZWRvd24nICwgZnVuY3Rpb24gKGUpIHsKICAgICAgICBoaWRlQWxsTWVudSAoZSk7CiAgICB9KTsKCiAgICBkb21VdGlscy5vbiAod2luZG93ICwgJ3Njcm9sbCcgLCBmdW5jdGlvbiAoZSkgewogICAgICAgIGhpZGVBbGxNZW51IChlKTsKICAgIH0pOwoKfSkgKCk7CgooZnVuY3Rpb24gKCl7CiAgICB2YXIgdXRpbHMgPSBiYWlkdS5lZGl0b3IudXRpbHMsCiAgICAgICAgVUlCYXNlID0gYmFpZHUuZWRpdG9yLnVpLlVJQmFzZSwKICAgICAgICBCcmVha2xpbmUgPSBiYWlkdS5lZGl0b3IudWkuQnJlYWtsaW5lID0gZnVuY3Rpb24gKG9wdGlvbnMpewogICAgICAgICAgICB0aGlzLmluaXRPcHRpb25zKG9wdGlvbnMpOwogICAgICAgICAgICB0aGlzLmluaXRTZXBhcmF0b3IoKTsKICAgICAgICB9OwogICAgQnJlYWtsaW5lLnByb3RvdHlwZSA9IHsKICAgICAgICB1aU5hbWU6ICdCcmVha2xpbmUnLAogICAgICAgIGluaXRTZXBhcmF0b3I6IGZ1bmN0aW9uICgpewogICAgICAgICAgICB0aGlzLmluaXRVSUJhc2UoKTsKICAgICAgICB9LAogICAgICAgIGdldEh0bWxUcGw6IGZ1bmN0aW9uICgpewogICAgICAgICAgICByZXR1cm4gJzxici8+JzsKICAgICAgICB9CiAgICB9OwogICAgdXRpbHMuaW5oZXJpdHMoQnJlYWtsaW5lLCBVSUJhc2UpOwoKfSkoKTsKfSkoKQ==</file>
	<file name='zb_system\CSS\admin2.css' crc32='DD1FF108'  dt:dt='bin.base64'>77u/QGNoYXJzZXQgInV0Zi04IjsNCi8qICANCuS9nOiAhe+8muaWsOmynOS6ug0K5Zyw5Z2A77yaaHR0cDovL3d3dy5odG1saXQuY29tLmNuDQrpgq7nrrHvvJp1MmxlaUB5YWhvby5jb20uY24NCiAgICAgeGlueHJAbXNuLmNvbQ0KKi8NCmJvZHl7DQptaW4td2lkdGg6OTgwcHg7DQpwYWRkaW5nOjA7DQptYXJnaW46MDsNCmZvbnQtZmFtaWx5OiLlvq7ova/pm4Xpu5EiLCLlrovkvZMiLCBBcmlhbCwgSGVsdmV0aWNhLCBzYW5zLXNlcmlmOw0KY29sb3I6IzMzMzMzMzsNCmZvbnQtc2l6ZTogMTRweDsNCmxpbmUtaGVpZ2h0OiAyMHB4Ow0KYmFja2dyb3VuZDojZmZmZmZmIHVybCguLi9pbWFnZS9hZG1pbi9iZy1sZWZ0LmdpZikgcmVwZWF0LXk7fQ0KKiB7IHBhZGRpbmc6MDsgbWFyZ2luOjA7fQ0KDQpkaXYsIGgxLCBoMiwgaDMsIGg0LCBwLCBmb3JtLCB1bCwgbGFiZWwsIGlucHV0LCB0ZXh0YXJlYSwgc2VsZWN0LCBpbWcsIHNwYW57bWFyZ2luOjA7IHBhZGRpbmc6MDt9DQo8ZW0+PC9lbT5pbnB1dCwgdGV4dGFyZWEsIHNlbGVjdHtmb250LWZhbWlseToi5b6u6L2v6ZuF6buRIiwi5a6L5L2TIiwgQXJpYWwsIEhlbHZldGljYSwgc2Fucy1zZXJpZjt9Ymxle2JvcmRlci1jb2xsYXBzZTpjb2xsYXBzZTt9DQphIHsgdGV4dC1kZWNvcmF0aW9uOiBub25lO2NvbG9yOiAjMzMzMzMzO30NCmE6aG92ZXIgeyBjb2xvcjojZDYwMDAwO30NCi5jbGVhciB7IGNsZWFyOiBib3RoO30NCmltZyB7IGJvcmRlcjogbm9uZTt9DQpoMSwNCmgyLA0KaDMsDQpoNCwNCmg1LA0KaDYgew0KCWRpc3BsYXk6IGJsb2NrOw0KCWZvbnQtd2VpZ2h0OiBib2xkOw0KfQ0KDQpoMSB7DQoJZm9udC1zaXplOiAyZW07DQoJbWFyZ2luOiAuNjdlbSAwOw0KfQ0KDQpoMiB7DQoJZm9udC1zaXplOiAxLjVlbTsNCgltYXJnaW46IC44M2VtIDA7DQp9DQoNCmgzIHsNCglmb250LXNpemU6IDEuMTdlbTsNCgltYXJnaW46IDFlbSAwOw0KfQ0KDQpoNCB7DQoJZm9udC1zaXplOiAxZW07DQoJbWFyZ2luOiAxLjMzZW0gMDsNCn0NCg0KaDUgew0KCWZvbnQtc2l6ZTogMC44M2VtOw0KCW1hcmdpbjogMS42N2VtIDA7DQp9DQoNCmg2IHsNCglmb250LXNpemU6IDAuNjdlbTsNCgltYXJnaW46IDIuMzNlbSAwOw0KfQ0KDQp1bCxvbCxkbCB7cGFkZGluZzowO21hcmdpbjowO30NCmRke3BhZGRpbmc6MDttYXJnaW46MDt9DQp1bCB7bGlzdC1zdHlsZTogbm9uZTt9DQpsaSB7bGlzdC1zdHlsZS10eXBlOiBub25lO30NCm9sIHtsaXN0LXN0eWxlLXR5cGU6IGRlY2ltYWw7bWFyZ2luLWxlZnQ6IDJlbTt9DQoNCmxhYmVsew0KCWN1cnNvcjpwb2ludGVyOw0KfQ0KLyoqLw0KdGFibGUgew0KCWJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7DQoJYm9yZGVyOjFweCBzb2xpZCAjRTFFMUUxOw0KCWJhY2tncm91bmQ6I2ZmZmZmZjsNCglsaW5lLWhlaWdodDoxMjAlOw0KfQ0KdGFibGUgbGFiZWx7DQoJLW1zLXRleHQtc2l6ZS1hZGp1c3Q6IDEwMCU7IC8q55So5LqO6Kej5YazSUUxMCBmb3IgV1A45a2X5L2T6L+H5aSn55qE6Zeu6aKYKi8NCn0NCnRkLHRoew0KCWJvcmRlcjoxcHggc29saWQgI0UxRTFFMTsNCgltYXJnaW46MDsNCglwYWRkaW5nOjNweCA1cHg7DQoJdGV4dC1pbmRlbnQ6MC4yZW07DQoJdmVydGljYWwtYWxpZ246bWlkZGxlOw0KfQ0KdHIgaW1new0KCW1hcmdpbi1ib3R0b206LTRweDsNCn0NCnRyLmNvbG9yMXsNCmJhY2tncm91bmQ6I2VkZWRlZDsNCn0NCnRyLmNvbG9yMnsNCmJhY2tncm91bmQ6I0Y0RjRGNDsNCn0NCnRyLmNvbG9yM3sNCmJhY2tncm91bmQ6I2ZmZmZmZjsNCn0NCnRyLmNvbG9yNHsNCmJhY2tncm91bmQ6I2ZmZmZkZDsNCn0NCg0KDQovKiovDQojbWFpbiB7IHdpZHRoOjEwMCU7fQ0KLyrlkI7lj7Dpobbpg6gqLw0KI2hlYWRlciB7Ym9yZGVyLWJvdHRvbTo1cHggc29saWQgd2hpdGU7fQ0KI2hlYWRlciAudG9wIHsgaGVpZ2h0Ojg1cHg7IHBhZGRpbmc6MDsgYmFja2dyb3VuZDojM2E2ZWE1OyBwb3NpdGlvbjogcmVsYXRpdmU7fQ0KLyoqLw0KLmxvZ28geyB3aWR0aDoxOTBweDsgaGVpZ2h0OjYycHg7IHBhZGRpbmc6MTBweCAwIDAgMDsgbGVmdDoyMHB4O30NCi8qKi8NCi51c2VyIHsgcG9zaXRpb246IGFic29sdXRlOyByaWdodDoxM3B4OyB0b3A6MTBweDsgd2lkdGg6NDAwcHg7IGhlaWdodDo0MHB4OyB0ZXh0LWFsaWduOnJpZ2h0OyBjb2xvcjojZmZmZmZmO30NCi51c2VyICNhdmF0YXIgeyBmbG9hdDpyaWdodDsgd2lkdGg6NDBweDsgaGVpZ2h0OjQwcHg7IG1hcmdpbi1sZWZ0OjEwcHg7bWFyZ2luLXRvcDowcHg7fQ0KLnVzZXJuYW1lIHsgcGFkZGluZzowO2hlaWdodDoyMHB4OyBsaW5lLWhlaWdodDoyMHB4OyBvdmVyZmxvdzpoaWRkZW47fQ0KLnVzZXJidG4geyBwYWRkaW5nOjA7aGVpZ2h0OjIwcHg7bGluZS1oZWlnaHQ6MjBweDt9DQoudXNlcmJ0biBhIHsgcGFkZGluZzowO21hcmdpbi1sZWZ0OjE1cHg7IGNvbG9yOiNmZmZmZmY7aGVpZ2h0OjIwcHg7bGluZS1oZWlnaHQ6MjBweDt2ZXJ0aWNhbC1hbGlnbjp0b3A7fQ0KLnVzZXJidG4gYS5sb2dvdXQgeyBwYWRkaW5nLWxlZnQ6MjBweDtiYWNrZ3JvdW5kOiB1cmwoLi4vaW1hZ2UvY29tbW9uL3R1aWNfMi5wbmcpIG5vLXJlcGVhdCBsZWZ0IGNlbnRlcjt9DQoudXNlcmJ0biAubG9nb3V0OmhvdmVyIHsgcGFkZGluZy1sZWZ0OjIwcHg7Y29sb3I6IzAwMDAwMDsgYmFja2dyb3VuZDogdXJsKC4uL2ltYWdlL2NvbW1vbi90dWljXzEucG5nKSBuby1yZXBlYXQgbGVmdCBjZW50ZXI7fQ0KLnVzZXJidG4gYS5wcm9maWxlIHsgcGFkZGluZy1sZWZ0OjIwcHg7YmFja2dyb3VuZDogdXJsKC4uL2ltYWdlL2NvbW1vbi9ob21lXzIucG5nKSBuby1yZXBlYXQgbGVmdCBjZW50ZXI7fQ0KLnVzZXJidG4gLnByb2ZpbGU6aG92ZXIgeyBwYWRkaW5nLWxlZnQ6MjBweDtjb2xvcjojMDAwMDAwOyBiYWNrZ3JvdW5kOiB1cmwoLi4vaW1hZ2UvY29tbW9uL2hvbWVfMS5wbmcpIG5vLXJlcGVhdCBsZWZ0IGNlbnRlcjt9DQovKiovDQoubWVudSB7IGhlaWdodDozMHB4OyBwb3NpdGlvbjogYWJzb2x1dGU7IHJpZ2h0OjEwcHg7IGJvdHRvbTowcHg7fQ0KLm1lbnUgdWwge2Zsb2F0OnJpZ2h0O21hcmdpbjowO3BhZGRpbmc6MDt9DQoubWVudSB1bCBsaSB7IGZsb2F0OmxlZnQ7bGluZS1oZWlnaHQ6MzBweDsgcGFkZGluZzowO2hlaWdodDozMHB4OyBtYXJnaW46MCAzcHg7IHRleHQtYWxpZ246Y2VudGVyO30NCi5tZW51IHVsIGxpIGEge2Zsb2F0OmxlZnQ7bGluZS1oZWlnaHQ6MzBweDtoZWlnaHQ6MzBweDsgcGFkZGluZzowcHggMTVweDsgY29sb3I6IzMzMzMzMzsgYmFja2dyb3VuZDojZmZmZmZmO30NCi5tZW51IHVsIGxpIGE6aG92ZXIge2Zsb2F0OmxlZnQ7bGluZS1oZWlnaHQ6MzBweDtoZWlnaHQ6MzBweDsgcGFkZGluZzowcHggMTVweDsgY29sb3I6I2ZmZmZmZjsgYmFja2dyb3VuZDogI2IwY2RlZTt9DQoubWVudSB1bCBsaS5vbiB7IGZvbnQtd2VpZ2h0OmJvbGQ7fQ0KDQoNCi8q5bem6L655a+86IiqKi8NCiNtYWluIC5tYWluX2xlZnQgeyBmbG9hdDpsZWZ0OyB3aWR0aDoxNDBweDsgYmFja2dyb3VuZDojZWRlZGVkOyBwYWRkaW5nOjBweDttYXJnaW46MCAwIDAgMDtwb3NpdGlvbjphYnNvbHV0ZTt9DQojbWFpbiAubWFpbl9sZWZ0ICNsZWZ0bWVudSB7fQ0KI21haW4gLm1haW5fbGVmdCAjbGVmdG1lbnUgbGkgeyBmbG9hdDpsZWZ0OyB3aWR0aDoxNDBweDsgaGVpZ2h0OjMycHg7IG1hcmdpbi1ib3R0b206MDtib3JkZXItYm90dG9tOjVweCBzb2xpZCAjZmZmO2N1cnNvcjpwb2ludGVyO30NCiNtYWluIC5tYWluX2xlZnQgI2xlZnRtZW51IGEgeyBmbG9hdDpsZWZ0OyAgd2lkdGg6MTQwcHg7IGhlaWdodDozMnB4OyBsaW5lLWhlaWdodDozNXB4O2N1cnNvcjpwb2ludGVyO30NCiNtYWluIC5tYWluX2xlZnQgI2xlZnRtZW51IGE6aG92ZXIgeyBjb2xvcjojMDAwMDAwOyBiYWNrZ3JvdW5kOiNiMGNkZWU7fQ0KI21haW4gLm1haW5fbGVmdCAjbGVmdG1lbnUgc3BhbiB7ICBmbG9hdDpsZWZ0O3dpZHRoOjkwcHg7IGhlaWdodDozMnB4OyBsaW5lLWhlaWdodDozMnB4OyBwYWRkaW5nLXJpZ2h0OjUwcHg7IHRleHQtYWxpZ246cmlnaHQ7Y3Vyc29yOnBvaW50ZXI7fQ0KDQovKuWvvOiIqumrmOS6riovDQojbWFpbiAubWFpbl9sZWZ0ICNsZWZ0bWVudSAub24gYSwjbWFpbiAubWFpbl9sZWZ0ICNsZWZ0bWVudSAjb24gYTpob3ZlciB7IGNvbG9yOiNmZmZmZmY7IGJhY2tncm91bmQ6IzMzOTljYzt9DQoNCiNtYWluIC5tYWluX2xlZnQgI2xlZnRtZW51IGxpLnN1YiB7DQoJZmxvYXQ6bGVmdDsgd2lkdGg6MTQwcHg7IGhlaWdodDphdXRvOyBtYXJnaW4tYm90dG9tOjA7Ym9yZGVyLWJvdHRvbTo1cHggc29saWQgI2ZmZjtjdXJzb3I6cG9pbnRlcjsNCgliYWNrZ3JvdW5kOndoaXRlOw0KfQ0KI21haW4gLm1haW5fbGVmdCAjbGVmdG1lbnUgbGkuc3ViIHNwYW57DQpoZWlnaHQ6MjVweDsgbGluZS1oZWlnaHQ6MjVweDsNCnRleHQtYWxpZ246bGVmdDsNCndpZHRoOjEwNXB4Ow0KcGFkZGluZy1sZWZ0OjM1cHg7DQpwYWRkaW5nLXJpZ2h0OjBweDsNCmJhY2tncm91bmQ6dXJsKC4uL2ltYWdlL2FkbWluL3BvaW50Z3JheS5naWYpIG5vLXJlcGVhdCAyMHB4IDhweDsNCm92ZXJmbG93OmhpZGRlbjsNCn0NCg0KI21haW4gLm1haW5fbGVmdCAjbGVmdG1lbnUgbGkuc3ViIGF7DQpoZWlnaHQ6MjVweDsgbGluZS1oZWlnaHQ6MjVweDsNCn0NCiNtYWluIC5tYWluX2xlZnQgI2xlZnRtZW51IGxpLnN1YiBhOmhvdmVyew0KYmFja2dyb3VuZDp3aGl0ZTsNCn0NCiNtYWluIC5tYWluX2xlZnQgI2xlZnRtZW51IGxpLnN1YiBzcGFuLm0tbm93ew0KYmFja2dyb3VuZDp1cmwoLi4vaW1hZ2UvYWRtaW4vcG9pbnRibHVlLmdpZikgbm8tcmVwZWF0IDIwcHggOHB4Ow0KZm9udC13ZWlnaHQ6Ym9sZDsNCn0NCg0KLyrlr7zoiKrlm77moIfljLoqLw0KI2xlZnRtZW51IGxpIHNwYW57DQpiYWNrZ3JvdW5kLXJlcGVhdDpuby1yZXBlYXQ7DQpiYWNrZ3JvdW5kLXBvc2l0aW9uOiAxMDBweCA4cHg7DQpiYWNrZ3JvdW5kLWltYWdlOiB1cmwoLi4vaW1hZ2UvY29tbW9uL3dpbmRvd18xLnBuZyk7DQp9DQojbGVmdG1lbnUgbGkub24gc3BhbnsNCmJhY2tncm91bmQtaW1hZ2U6IHVybCguLi9pbWFnZS9jb21tb24vd2luZG93XzIucG5nKTsNCn0NCg0KI2xlZnRtZW51ICNuYXZfYnVpbGQgc3BhbiB7IGJhY2tncm91bmQtaW1hZ2U6IHVybCguLi9pbWFnZS9jb21tb24vcmVidWlsZF8xLnBuZyk7fQ0KI2xlZnRtZW51ICNuYXZfaG9tZSBzcGFuIHsgYmFja2dyb3VuZC1pbWFnZTogdXJsKC4uL2ltYWdlL2NvbW1vbi9ob21lXzEucG5nKTt9DQojbGVmdG1lbnUgI25hdl9uZXcgc3BhbiB7IGJhY2tncm91bmQtaW1hZ2U6IHVybCguLi9pbWFnZS9jb21tb24vbmV3XzEucG5nKTt9DQojbGVmdG1lbnUgI25hdl9hcnRpY2xlIHNwYW4geyBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoLi4vaW1hZ2UvY29tbW9uL2FydGljbGVfMS5wbmcpO30NCiNsZWZ0bWVudSAjbmF2X3BhZ2Ugc3BhbiB7IGJhY2tncm91bmQtaW1hZ2U6IHVybCguLi9pbWFnZS9jb21tb24vcGFnZV8xLnBuZyk7fQ0KI2xlZnRtZW51ICNuYXZfY2F0ZWdvcnkgc3BhbiB7IGJhY2tncm91bmQtaW1hZ2U6IHVybCguLi9pbWFnZS9jb21tb24vY2F0ZWdvcnlfMS5wbmcpO30NCiNsZWZ0bWVudSAjbmF2X3RhZ3Mgc3BhbiB7IGJhY2tncm91bmQtaW1hZ2U6IHVybCguLi9pbWFnZS9jb21tb24vdGFnc18xLnBuZyk7fQ0KI2xlZnRtZW51ICNuYXZfY29tbWVudHMgc3BhbiB7IGJhY2tncm91bmQtaW1hZ2U6IHVybCguLi9pbWFnZS9jb21tb24vY29tbWVudHNfMS5wbmcpO30NCiNsZWZ0bWVudSAjbmF2X3F1b3RlZCBzcGFuIHsgYmFja2dyb3VuZC1pbWFnZTogdXJsKC4uL2ltYWdlL2NvbW1vbi9xdW90ZWRfMS5wbmcpO30NCiNsZWZ0bWVudSAjbmF2X2FjY2Vzc29yaWVzIHNwYW4geyBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoLi4vaW1hZ2UvY29tbW9uL2FjY2Vzc29yaWVzXzEucG5nKTt9DQojbGVmdG1lbnUgI25hdl90aGVtZXMgc3BhbiB7IGJhY2tncm91bmQtaW1hZ2U6IHVybCguLi9pbWFnZS9jb21tb24vdGhlbWVzXzEucG5nKTt9DQojbGVmdG1lbnUgI25hdl9wbHVnaW4gc3BhbiB7IGJhY2tncm91bmQtaW1hZ2U6IHVybCguLi9pbWFnZS9jb21tb24vcGx1Z2luXzEucG5nKTt9DQojbGVmdG1lbnUgI25hdl9mdW5jdGlvbiBzcGFuIHsgYmFja2dyb3VuZC1pbWFnZTogdXJsKC4uL2ltYWdlL2NvbW1vbi9saW5rXzEucG5nKTt9DQojbGVmdG1lbnUgI25hdl91c2VyIHNwYW4geyBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoLi4vaW1hZ2UvY29tbW9uL3VzZXJfMS5wbmcpO30NCg0KLyrpq5jkuq7lr7zoiKrlm77moIfljLoqLw0KI2xlZnRtZW51ICNuYXZfYnVpbGQub24gc3BhbiB7IGJhY2tncm91bmQtaW1hZ2U6IHVybCguLi9pbWFnZS9jb21tb24vcmVidWlsZF8yLnBuZyk7fQ0KI2xlZnRtZW51ICNuYXZfaG9tZS5vbiBzcGFuIHsgYmFja2dyb3VuZC1pbWFnZTogdXJsKC4uL2ltYWdlL2NvbW1vbi9ob21lXzIucG5nKTt9DQojbGVmdG1lbnUgI25hdl9uZXcub24gc3BhbiB7IGJhY2tncm91bmQtaW1hZ2U6IHVybCguLi9pbWFnZS9jb21tb24vbmV3XzIucG5nKTt9DQojbGVmdG1lbnUgI25hdl9hcnRpY2xlLm9uIHNwYW4geyBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoLi4vaW1hZ2UvY29tbW9uL2FydGljbGVfMi5wbmcpO30NCiNsZWZ0bWVudSAjbmF2X3BhZ2Uub24gc3BhbiB7IGJhY2tncm91bmQtaW1hZ2U6IHVybCguLi9pbWFnZS9jb21tb24vcGFnZV8yLnBuZyk7fQ0KI2xlZnRtZW51ICNuYXZfY2F0ZWdvcnkub24gc3BhbiB7IGJhY2tncm91bmQtaW1hZ2U6IHVybCguLi9pbWFnZS9jb21tb24vY2F0ZWdvcnlfMi5wbmcpO30NCiNsZWZ0bWVudSAjbmF2X3RhZ3Mub24gc3BhbiB7IGJhY2tncm91bmQtaW1hZ2U6IHVybCguLi9pbWFnZS9jb21tb24vdGFnc18yLnBuZyk7fQ0KI2xlZnRtZW51ICNuYXZfY29tbWVudHMub24gc3BhbiB7IGJhY2tncm91bmQtaW1hZ2U6IHVybCguLi9pbWFnZS9jb21tb24vY29tbWVudHNfMi5wbmcpO30NCiNsZWZ0bWVudSAjbmF2X3F1b3RlZC5vbiBzcGFuIHsgYmFja2dyb3VuZC1pbWFnZTogdXJsKC4uL2ltYWdlL2NvbW1vbi9xdW90ZWRfMi5wbmcpO30NCiNsZWZ0bWVudSAjbmF2X2FjY2Vzc29yaWVzLm9uIHNwYW4geyBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoLi4vaW1hZ2UvY29tbW9uL2FjY2Vzc29yaWVzXzIucG5nKTt9DQojbGVmdG1lbnUgI25hdl90aGVtZXMub24gc3BhbiB7IGJhY2tncm91bmQtaW1hZ2U6IHVybCguLi9pbWFnZS9jb21tb24vdGhlbWVzXzIucG5nKTt9DQojbGVmdG1lbnUgI25hdl9wbHVnaW4ub24gc3BhbiB7IGJhY2tncm91bmQtaW1hZ2U6IHVybCguLi9pbWFnZS9jb21tb24vcGx1Z2luXzIucG5nKTt9DQojbGVmdG1lbnUgI25hdl9mdW5jdGlvbi5vbiBzcGFuIHsgYmFja2dyb3VuZC1pbWFnZTogdXJsKC4uL2ltYWdlL2NvbW1vbi9saW5rXzIucG5nKTt9DQojbGVmdG1lbnUgI25hdl91c2VyLm9uIHNwYW4geyBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoLi4vaW1hZ2UvY29tbW9uL3VzZXJfMi5wbmcpO30NCg0KDQojbGVmdG1lbnUgbGkgc3BhbnsNCmJhY2tncm91bmQtcmVwZWF0Om5vLXJlcGVhdDsNCmJhY2tncm91bmQtcG9zaXRpb246IDEwMHB4IDhweDsNCn0NCiNsZWZ0bWVudSBsaS5zcGxpdHsNCmhlaWdodDowcHghaW1wb3J0YW50Ow0KYmFja2dyb3VuZDojZmZmOw0KfQ0KI2xlZnRtZW51IGxpLnNwbGl0IGhyew0KZGlzcGxheTpub25lOw0KfQ0KLyrkuLvopoHlhoXlrrnljLoqLw0KI21haW4gLm1haW5fcmlnaHQge3BhZGRpbmctbGVmdDoxNDBweDt9DQojbWFpbiAubWFpbl9yaWdodCAueXVpIHsgZmxvYXQ6bGVmdDt3aWR0aDoxMDAlO30NCiNtYWluIC5tYWluX3JpZ2h0IC5jb250ZW50IHsgcGFkZGluZzowIDEycHg7fQ0KDQoNCi8q5ZCO5Y+w6aaW6aG1Ki8NCiNkaXZNYWluIHtmbG9hdDpsZWZ0O3dpZHRoOjEwMCU7YmFja2dyb3VuZDojZmZmZmZmO3BhZGRpbmc6MHB4O21hcmdpbjowcHg7fQ0KI2Rpdk1haW4gYSwjZGl2TWFpbjIgYXtjb2xvcjojMWQ0YzdkO30NCiNkaXZNYWluIGE6aG92ZXIsI2Rpdk1haW4yICBhOmhvdmVye2NvbG9yOiNkNjAwMDA7fQ0KI2Rpdk1haW4yIHsgcGFkZGluZzowcHg7bWFyZ2luOjBweDt9DQouZGl2SGVhZGVyIHsgaGVpZ2h0OjEuOGVtOyBsaW5lLWhlaWdodDoxLjhlbTsgZm9udC1zaXplOjEuNWVtOyBwYWRkaW5nOjA7IGJhY2tncm91bmQ6I0ZGRjt9DQouZGl2SGVhZGVyMiB7IGhlaWdodDoxLjhlbTsgbGluZS1oZWlnaHQ6MS44ZW07IGZvbnQtc2l6ZToxLjVlbTsgcGFkZGluZzowOyBiYWNrZ3JvdW5kOiNGRkY7Ym9yZGVyLWJvdHRvbTo1cHggc29saWQgI2UwZTBlMDt9DQoNCg0KDQoNCg0KDQovKuihqCAgIOagvCovDQoudGFibGVCb3JkZXIgew0KCWxpbmUtaGVpZ2h0OjEuOGVtOw0KCW1hcmdpbi1ib3R0b206MC44ZW07DQoJbWFyZ2luLXRvcDowLjJlbTsNCgktbXMtdGV4dC1zaXplLWFkanVzdDogMTAwJTsgLyrnlKjkuo7op6PlhrNJRTEwIGZvciBXUDjlrZfkvZPov4flpKfnmoTpl67popgqLw0KfQ0KDQoudGFibGVCb3JkZXIgdGh7DQoJdGV4dC1hbGlnbjpsZWZ0Ow0KfQ0KDQoudGFibGVCb3JkZXItdGhjZW50ZXIgdGh7DQoJdGV4dC1hbGlnbjpjZW50ZXI7DQp9DQoNCi51aS1zb3J0YWJsZSB0ci5jb2xvcjR7DQoJY3Vyc29yOm1vdmU7DQp9DQoNCi5ub3RlaW5mb3sNCglmb250LXdlaWdodDpub3JtYWw7Zm9udC1zaXplOjAuOWVtO2NvbG9yOiM2NjY7Zm9udC1zdHlsZTogaXRhbGljOw0KfQ0KDQovKuihqCAgIOWNlSovDQpmb3JtIHtiYWNrZ3JvdW5kOiNmZmY7Ym9yZGVyOjBweCBzb2xpZCBibGFjaztwYWRkaW5nOjAuMGVtO21hcmdpbjowLjVlbSAwO30NCg0KZm9ybSBwe3BhZGRpbmc6MC41ZW0gMCAgMC41ZW0gMDtsaW5lLWhlaWdodDoxLjVlbTt9DQoNCg0KDQppbnB1dCB7DQoJcGFkZGluZzogMC4yNWVtIDAuMjVlbSAwLjI1ZW0gMC4yNWVtOw0KCWJvcmRlcjogMXB4IGRvdWJsZSAjYWFhYWFhOw0KCWJhY2tncm91bmQtcG9zaXRpb246IGJvdHRvbTsNCgliYWNrZ3JvdW5kOiNmZmY7DQoJZm9udC1zaXplOjFlbTsNCn0NCmlucHV0W3R5cGU9InJhZGlvIl0gew0KCWJvcmRlcjpub25lOw0KCWJhY2tncm91bmQ6bm9uZTsNCn0NCnNlbGVjdHsNCglwYWRkaW5nOiAwLjE1ZW0gMC4yNWVtIDAuMjBlbSAwLjI1ZW07DQoJYm9yZGVyOiAxcHggZG91YmxlICNhYWFhYWE7DQoJYmFja2dyb3VuZC1wb3NpdGlvbjogYm90dG9tOw0KCWJhY2tncm91bmQ6I2ZmZjsNCglmb250LXNpemU6MS4wZW07DQp9DQoNCnRleHRhcmVhew0KCXBhZGRpbmc6IDAuMTVlbSAwLjI1ZW0gMC4yMGVtIDAuMjVlbTsNCglib3JkZXI6IDFweCBkb3VibGUgI2FhYWFhYTsNCgliYWNrZ3JvdW5kLXBvc2l0aW9uOiBib3R0b207DQoJYmFja2dyb3VuZDojZmZmOw0KCWZvbnQtc2l6ZToxZW07DQp9DQoNCmlucHV0LmJ1dHRvbixpbnB1dFt0eXBlPSJzdWJtaXQiXSxpbnB1dFt0eXBlPSJidXR0b24iXSB7IA0KCWNvbG9yOiNmZmZmZmY7IA0KCWZvbnQtc2l6ZToxLjFlbTsgDQoJaGVpZ2h0OjI5cHg7DQoJcGFkZGluZzogMnB4IDE4cHggM3B4IDE4cHg7DQoJbWFyZ2luOjAgMC41ZW07IA0KCWJhY2tncm91bmQ6IzNhNmVhNTsgDQoJYm9yZGVyOjFweCBzb2xpZCAjMzM5OWNjOw0KCWN1cnNvcjogcG9pbnRlcjsNCn0NCmlucHV0LmJ1dHRvbjpob3ZlciB7YmFja2dyb3VuZDogIzMzOTljYzt9DQoNCmlucHV0LmJ1dHRvbjIgeyB3aWR0aDphdXRvO30NCg0KaW5wdXRbZGlzYWJsZWRdLGlucHV0W2Rpc2FibGVkXTpob3ZlcnsNCgliYWNrZ3JvdW5kOiNlZWU7DQoJYm9yZGVyOjFweCBzb2xpZCAjY2NjOw0KfQ0KDQppbnB1dFtyZWFkb25seV0saW5wdXRbcmVhZG9ubHldOmhvdmVyew0KCWJhY2tncm91bmQ6I2VlZTsNCglib3JkZXI6MXB4IHNvbGlkICNjY2M7DQp9DQoNCg0KLyrmj5DnpLpESVYqLw0KZGl2LmhpbnR7DQoJd2lkdGg6MTAwJTsNCgltYXJnaW46MCAwIDAuMmVtIDA7DQp9DQoNCmRpdi5oaW50IHB7DQoJcGFkZGluZzowLjJlbSAwLjVlbSAwLjNlbSAyLjJlbTsNCglsaW5lLWhlaWdodDoxLjVlbTsNCn0NCg0KZGl2LmhpbnQgZm9udHsNCgljb2xvcjpibGFjazsNCn0NCg0KZGl2LmhpbnQgcC5oaW50X2dyZWVuew0KCWJhY2tncm91bmQ6I2Q1ZmZjZSB1cmwoLi4vaW1hZ2UvYWRtaW4vb2sucG5nKSBuby1yZXBlYXQgOHB4IGNlbnRlcjsNCn0NCg0KZGl2LmhpbnQgcC5oaW50X3JlZHsNCgliYWNrZ3JvdW5kOiNmZmNlY2UgdXJsKC4uL2ltYWdlL2FkbWluL2V4Y2xhbWF0aW9uLnBuZykgbm8tcmVwZWF0IDhweCBjZW50ZXI7DQp9DQoNCmRpdi5oaW50IHAuaGludF9ibHVlew0KCWJhY2tncm91bmQ6I2RiZTNmZiB1cmwoLi4vaW1hZ2UvYWRtaW4vaW5mb3JtYXRpb24ucG5nKSBuby1yZXBlYXQgOHB4IGNlbnRlcjsNCn0NCg0KZGl2LmhpbnQgcC5oaW50X3RlYWx7DQoJYmFja2dyb3VuZDojZmZmYmNjIHVybCguLi9pbWFnZS9hZG1pbi9lcnJvci5wbmcpIG5vLXJlcGVhdCA4cHggY2VudGVyOw0KfQ0KDQoNCi8q5ZCO5Y+wKi8NCmZvcm0uc2VhcmNoIHsNCmJhY2tncm91bmQ6I2YwZjBmMDsNCnBhZGRpbmc6MC41ZW07DQotbXMtdGV4dC1zaXplLWFkanVzdDogMTAwJTsgLyrnlKjkuo7op6PlhrNJRTEwIGZvciBXUDjlrZfkvZPov4flpKfnmoTpl67popgqLw0KLyoNCmJhY2tncm91bmQ6I2ZmY2M2NjsNCiovDQp9DQoNCmZvcm0uc2VhcmNoIGlucHV0LmJ1dHRvbnsNCi8qDQpiYWNrZ3JvdW5kOiM3ZTVjMTc7Ym9yZGVyOjFweCBzb2xpZCAjNjQ0NjA5Ow0KKi8NCn0NCg0KaHIge3dpZHRoOjEwMCU7aGVpZ2h0OjFweDtib3JkZXI6bm9uZTtwYWRkaW5nOjA7dmlzaWJpbGl0eTpoaWRkZW47fQ0KDQoNCg0KLyrlkI7lj7DnvJbovpHpobUs5paH56ug57yW6L6R5ZKM6aG16Z2i57yW6L6RKi8NCiNkaXZFZGl0UmlnaHR7DQoJZmxvYXQ6cmlnaHQ7DQoJd2lkdGg6MjIwcHg7DQoJdGV4dC1hbGlnbjpyaWdodDsNCn0NCiNkaXZFZGl0TGVmdHsNCglmbG9hdDpsZWZ0Ow0KCXdpZHRoOjEwMCU7DQoJbWFyZ2luLXJpZ2h0Oi0yMzBweDsNCn0NCg0KI2RpdkVkaXRUaXRsZSwjZGl2Q29udGVudCwjZGl2SW50cm8sI2RpdkVkaXRGb3JtLCNkaXZFZGl0Rm9ybTJ7DQoJcGFkZGluZy1yaWdodDoyMTBweDsNCn0NCiNkaXZJbnRyb3sNCglwYWRkaW5nLWJvdHRvbToyMHB4Ow0KfQ0KI3VsVGFnew0KCW1hcmdpbjowIDNlbTsNCn0NCiNhamF4dGFnc3sNCgliYWNrZ3JvdW5kOiNmOGY4Zjg7DQoJYm94LXNoYWRvdzogMCAwIDEwcHggI2FhYTsNCglwYWRkaW5nOi41ZW07DQp9DQojYWpheHRhZ3MgYXsNCgltYXJnaW4tcmlnaHQ6LjVlbTsNCn0NCiNhamF4dGFncyBhLnNlbGVjdGVkew0KCWNvbG9yOiBibGFjazsNCgliYWNrZ3JvdW5kOiAjRjhGODg5Ow0KfQ0KDQovKuWQjuWPsOS4u+mimOeuoeeQhumhtSovDQpkaXYudGhlbWV7DQoJd2lkdGg6MjA0cHg7DQoJaGVpZ2h0OjMyMHB4Ow0KfQ0KZGl2LnRoZW1lIGltZ3sNCgltYXJnaW4tYm90dG9tOi0zcHg7DQp9DQoNCmRpdi50aGVtZS1ub3d7DQoJZmxvYXQ6bGVmdDsNCgliYWNrZ3JvdW5kOiNiMGNkZWU7DQoJcGFkZGluZzouNmVtIDFlbTsNCgltYXJnaW46MCAxZW0gMWVtIDA7DQp9DQoNCmRpdi50aGVtZS1vdGhlcnsNCglmbG9hdDpsZWZ0Ow0KCWJhY2tncm91bmQ6I2YwZjBmMDsNCglwYWRkaW5nOi42ZW0gMWVtOw0KCW1hcmdpbjowIDFlbSAxZW0gMDsNCn0NCmRpdi50aGVtZS1vdGhlciBhew0KCWN1cnNvcjpwb2ludGVyOw0KfQ0KZGl2LnRoZW1lLW90aGVyIC50aGVtZS1uYW1lIGltZ3tvcGFjaXR5OjAuNTA7fQ0KDQpkaXYudGhlbWUtbm93IC5iZXR0ZXJUaXAgaW1newkNCglib3gtc2hhZG93OiAwIDAgMTBweCAjM2E2ZWE1Ow0KfQ0KZGl2LnRoZW1lLW5vdyAuYmV0dGVyVGlwIGltZyxkaXYudGhlbWUtb3RoZXIgLmJldHRlclRpcCBpbWd7DQoJYm9yZGVyOjJweCBzb2xpZCAjZjZmNmY2Ow0KfQ0KZGl2LnRoZW1lLW90aGVyIC5iZXR0ZXJUaXAgaW1newkNCglib3gtc2hhZG93OiAwIDAgMTBweCAjYWFhOw0KfQ0KZGl2LnRoZW1lLW90aGVyIC5iZXR0ZXJUaXAgaW1nOmhvdmVyew0KCWJvcmRlcjoycHggc29saWQgI2IwY2RlZTsNCglib3gtc2hhZG93OiAwIDAgMTBweCAjMzM5OWNjOw0KfQ0KDQpkaXYudGhlbWUtbm93IGRpdixkaXYudGhlbWUtb3RoZXIgZGl2ew0KCW1heC13aWR0aDoyMjBweDsNCgkvKm92ZXJmbG93OmhpZGRlbjsqLw0KCXBhZGRpbmc6IDAuNWVtIDAgMC41ZW0gMDsNCn0NCg0KDQppbnB1dC50aGVtZS1jb25maWcsaW5wdXQudGhlbWUtYWN0aXZhdGV7DQoJZmxvYXQ6cmlnaHQ7DQoJaGVpZ2h0OjI2cHg7DQoJd2lkdGg6NDZweDsNCgltYXJnaW46MDsNCglwYWRkaW5nOjJweCA1cHggM3B4IDVweDsNCglmb250LXNpemU6MWVtOw0KCW1hcmdpbi10b3A6MnB4Ow0KfQ0KaW5wdXQudGhlbWUtY29uZmlnew0KCW1hcmdpbi10b3A6LTNweDsNCn0NCg0KLmhpZGRlbnsNCglkaXNwbGF5Om5vbmU7DQp9DQoNCnNwYW4uZWRpdGlucHV0bmFtZXsNCnBhZGRpbmc6MCAycHggMCAzcHg7DQpsaW5lLWhlaWdodDoxZW07DQpmb250LXdlaWdodDpib2xkOw0KfQ0KDQoucGFnZWJhciB7DQoJcGFkZGluZzouMjBlbSAwIDFlbSAwOw0KfQ0KDQpzcGFuLnRpdGxlew0KCWZvbnQtd2VpZ2h0OmJvbGQ7DQp9DQpzcGFuLnN0YXJ7DQoJY29sb3I6cmVkOw0KCWZvbnQtc2l6ZTowLjllbTsNCn0NCnNwYW4ubm90ZXsNCglmb250LXNpemU6MC45ZW07DQp9DQoucGFnZWJhciBzcGFuew0KCWNvbG9yOiMzMzM7DQoJZm9udC13ZWlnaHQ6Ym9sZGVyOw0KCXBhZGRpbmc6M3B4IDVweCAycHggNXB4Ow0KCWJvcmRlcjoxcHggc29saWQgIzk5OTsNCgliYWNrZ3JvdW5kOiNhYWE7DQoJbWFyZ2luOjFweDsNCn0NCg0KLnBhZ2ViYXIgYXsNCglib3JkZXI6MXB4IHNvbGlkICM5OTk7DQoJYmFja2dyb3VuZDojZWVlOw0KCXBhZGRpbmc6MnB4Ow0KCXBhZGRpbmc6MnB4IDVweCAycHggNXB4Ow0KCW1hcmdpbjoxcHg7DQp9DQoNCg0KDQovKuato+aWh0RJVuS4i+eahOWvvOiIquadoSovDQouU3ViTWVudXsNCglwYWRkaW5nOjAgMCAwcHggMDsNCgltYXJnaW46MCAwIDVweCAwOw0KCXdpZHRoOjEwMCU7DQoJdGV4dC1hbGlnbjpsZWZ0Ow0KCWZvbnQtc2l6ZToxZW07DQoJaGVpZ2h0OjMwcHg7DQoJbGluZS1oZWlnaHQ6MzBweDsNCglib3JkZXItYm90dG9tOjBweCBzb2xpZCAjMzM5OWNjOw0KCWRpc3BsYXk6bm9uZTsNCn0NCg0KLlN1Yk1lbnUgc3BhbiB7DQoJZmxvYXQ6bGVmdDsNCgltYXJnaW46MCAwIDAgMDsNCgl0ZXh0LWFsaWduOmNlbnRlcjsNCglwYWRkaW5nOjBweCAxMHB4Ow0KCWN1cnNvcjogcG9pbnRlcjsNCgljb2xvcjojMzMzMzMzOw0KfQ0KDQouU3ViTWVudSBzcGFuLm0tbGVmdCwuU3ViTWVudSBzcGFuLm0tcmlnaHR7DQoJZmxvYXQ6bGVmdDsNCn0NCg0KLlN1Yk1lbnUgYTpob3ZlciB7DQoJYmFja2dyb3VuZDojYjBjZGVlOw0KCXRleHQtZGVjb3JhdGlvbiA6IG5vbmU7IA0KCWNvbG9yOmJsYWNrOw0KfQ0KLlN1Yk1lbnUgYXsNCgljb2xvcjpibGFjazsNCgliYWNrZ3JvdW5kOiNlMGUxZTI7IA0KCW1hcmdpbjowIDVweCAwIDA7DQoJZmxvYXQ6bGVmdDsNCn0NCg0KLlN1Yk1lbnUgc3Bhbi5tLW5vd3sNCgliYWNrZ3JvdW5kOiMzMzk5Y2M7DQoJY29sb3I6d2hpdGU7DQp9DQoNCg0KDQovKiDnvZHnq5norr7nva7pobUgKi8NCi5jb250ZW50LWJveCB1bHsNCglwYWRkaW5nOjEwcHggMCAwIDBweDsNCn0NCg0KLmNvbnRlbnQtYm94IGxpew0KCWZsb2F0OmxlZnQ7DQoJcGFkZGluZzowIDAgMCAwOw0KCWhlaWdodDoyZW07DQoJbGluZS1oZWlnaHQ6MmVtOw0KCW1hcmdpbjowOw0KfQ0KDQoNCi5jb250ZW50LWJveCAuY29udGVudC1ib3gtdGFicyBhLmN1cnJlbnR7DQoJYmFja2dyb3VuZDojZWRlZGVkOw0KCXBhZGRpbmc6NXB4IDEwcHg7DQoJbWFyZ2luOjAgOXB4IDAgMDsNCglsaW5lLWhlaWdodDoyZW07DQoJaGVpZ2h0OjJlbTsNCgljb2xvcjpibGFjazsNCglmb250LXdlaWdodDpib2xkZXI7DQp9DQoNCi5jb250ZW50LWJveCAuY29udGVudC1ib3gtdGFicyBhew0KCWJvcmRlcjowcHggc29saWQgIzcxOTBiYTsNCglwYWRkaW5nOjVweCAxMHB4Ow0KCW1hcmdpbjowIDlweCAwIDA7DQoJbGluZS1oZWlnaHQ6MmVtOw0KCWhlaWdodDoyZW07DQp9DQoNCg0KDQoudG90b3JvIHsgcGFkZGluZzoxMHB4O30gDQoudG90b3JvIGRkIHsgbGluZS1oZWlnaHQ6MjhweDsgbWFyZ2luLWJvdHRvbTo1cHg7fQ0KLnRvdG9ybyAudG90b3JvdHh0IHsgZm9udC1zaXplOjEycHg7fQ0KI3RvdG9yb2JveCB0ZXh0YXJlYSB7IGJhY2tncm91bmQ6I2ZmZmZmZjsgcGFkZGluZzoxMHB4IDA7IGJvcmRlcjpub25lO30NCg0KDQoNCg0KLypjaGVja2JveCovDQouaW1nY2hlY2t7DQoJYmFja2dyb3VuZDp1cmwoLi4vSU1BR0UvQURNSU4vY2hlY2tib3gucG5nKSBuby1yZXBlYXQgMCBib3R0b207DQoJd2lkdGg6NDBweDsNCgloZWlnaHQ6MTdweDsNCglkaXNwbGF5OmlubGluZS1ibG9jazsNCi8qCWZsb2F0OmxlZnQ7Ki8NCgljdXJzb3I6IHBvaW50ZXI7DQoJbWFyZ2luLWJvdHRvbTotM3B4Ow0KCW1hcmdpbi1sZWZ0OjVweDsNCn0NCi5pbWdjaGVjay1vbnsNCgliYWNrZ3JvdW5kOnVybCguLi9JTUFHRS9BRE1JTi9jaGVja2JveC5wbmcpIG5vLXJlcGVhdCAwIHRvcDsNCn0NCg0KDQojYmF0Y2ggaWZyYW1le2Zsb2F0OmxlZnQ7bWFyZ2luOjVweCA1cHggMCA4cHg7fQ0KI2JhdGNoIHB7ZmxvYXQ6bGVmdDt9DQojYmF0Y2ggaW1ne2Zsb2F0OmxlZnQ7bWFyZ2luOjdweCA1cHggMCA5cHg7fQ0KI2JhdGNoIGEscC5oaW50IGF7DQoJYmFja2dyb3VuZDp1cmwoLi4vSU1BR0UvQURNSU4vYnVsbGV0X2dvLnBuZykgbm8tcmVwZWF0IDRweCAxcHg7DQoJcGFkZGluZy1sZWZ0OjIwcHg7DQoJZm9udC13ZWlnaHQ6Ym9sZDsNCn0NCg0KDQojYmF0Y2h7DQoJd2lkdGg6MTAwJTsNCgltYXJnaW46MCAwIDVweCAwOw0KCWJhY2tncm91bmQ6I2RiZTNmZjsNCglmbG9hdDpsZWZ0Ow0KCXBhZGRpbmc6MCAwIDAgMDsNCn0NCg0KI2JhdGNoIHB7DQoJcGFkZGluZzowLjNlbSAwLjVlbSAwLjNlbSAwOw0KCWZvbnQtc2l6ZToxLjBlbTsNCn0NCg0KI2RpdkZsb2F0IGlucHV0LmJ1dHRvbnsNCgltYXJnaW46MC4yZW0gMDsNCn0NCg0KLyrmlofnq6DnvJbovpHmj5DkuqTljLrpmo/liqgqLw0KI2RpdkJveCB7IHdpZHRoOjIyMHB4OyBwb3NpdGlvbjpyZWxhdGl2ZTt9DQojZGl2RmxvYXQgeyB3aWR0aDoyMjBweDt9DQouYm94ZmxvYXR7cG9zaXRpb246IGZpeGVkO19wb3NpdGlvbjogYWJzb2x1dGU7dG9wOiAwcHg7ei1pbmRleDogMjk1O30NCg0KYS5idXR0b257DQoJYm9yZGVyLXJhZGl1czoycHg7DQoJcGFkZGluZzoycHggM3B4IDJweCAzcHg7DQoJbGluZS1oZWlnaHQ6IDEuMGVtOw0KCWZvbnQtc2l6ZToxZW07DQp9DQoNCmEuYnV0dG9uOmhvdmVyew0KCWJveC1zaGFkb3c6IDAgMCAxcHggIzAwMDsNCglib3JkZXItcmFkaXVzOjJweDsNCgktbXMtYm9yZGVyLXJhZGl1czoycHg7DQoJcGFkZGluZzoycHggM3B4IDJweCAzcHg7DQp9DQoNCi8q5L6n5qCP566h55CGKi8NCg0KLndpZGdldC1sZWZ0e2Zsb2F0OiBsZWZ0O2NsZWFyOiBsZWZ0O3dpZHRoOiAxMDAlO21hcmdpbi1yaWdodDogLTI5MHB4O292ZXJmbG93OmhpZGRlbjt9DQoud2lkZ2V0LWxpc3R7bWluLXdpZHRoOjUzMHB4O21hcmdpbi1yaWdodDoyOTBweDtib3JkZXI6IDJweCBzb2xpZCAjRUVFO30NCi5zaWRlcmJhci1saXN0e2Zsb2F0OnJpZ2h0O3dpZHRoOjI5MHB4O21hcmdpbi1sZWZ0OjA7fQ0KDQoud2lkZ2V0LWxpc3QtaGVhZGVyLC5zaWRlcmJhci1oZWFkZXIsLnNpZGVyYmFyLW5vdGV7Y2xlYXI6Ym90aDtiYWNrZ3JvdW5kOiNFREVERUQ7cGFkZGluZzo1cHg7Zm9udC1zaXplOiAxLjFlbTtmb250LXdlaWdodDpib2xkO3RleHQtYWxpZ246IGNlbnRlcjttYXJnaW4tYm90dG9tOjNweDt9DQoNCi53aWRnZXR7d2lkdGg6MjUycHg7Ym9yZGVyOjFweCBzb2xpZCAjY2NjO21hcmdpbjozcHggNHB4IDNweCA0cHg7cGFkZGluZzowcHg7ZmxvYXQ6bGVmdDt9DQoud2lkZ2V0IGltZ3ttYXJnaW46M3B4O21hcmdpbi1ib3R0b206IC0zcHg7fQ0KDQoud2lkZ2V0LXRpdGxlIHttYXJnaW46MHB4O3BhZGRpbmc6NnB4O2NvbG9yOiAjMzMzO2N1cnNvcjogbW92ZTt9DQoud2lkZ2V0LXRpdGxlIHNwYW57K2Rpc3BsYXk6aW5saW5lLWJsb2NrO30gDQoud2lkZ2V0X2lzaGlkZGVuX3RydWUgaW1nLm1vcmUtYWN0aW9ue29wYWNpdHk6MC40MDt9DQoud2lkZ2V0LWFjdGlvbntmbG9hdDpyaWdodDsrZmxvYXQ6bm9uZTt9DQoNCi5zaWRlcmJhci1kcm9we2Zsb2F0OiByaWdodDtiYWNrZ3JvdW5kOiNmZWZlZmU7Ym9yZGVyOjJweCBzb2xpZCAjZWVlO21hcmdpbjogMCA1cHggMTBweCAxNXB4O30NCi5zaWRlcmJhci1zb3J0LWxpc3R7ZmxvYXQ6cmlnaHQ7d2lkdGg6MjYycHg7bWluLWhlaWdodDozMHB4O3Bvc2l0aW9uOiByZWxhdGl2ZTt6LWluZGV4OiAwO30NCi5zaWRlcmJhci1oZWFkZXI6aG92ZXIgeyBjdXJzb3I6IHBvaW50ZXI7Y29sb3I6IzAwMDAwMDsgYmFja2dyb3VuZDojYjBjZGVlO30NCi5zaWRlcmJhci1oZWFkZXIgLnVpLWljb257ZmxvYXQ6IHJpZ2h0O30NCg0KLndpZGdldC1saXN0LW5vdGUsLnNpZGVyYmFyLW5vdGV7Y29sb3I6IzY2NjtiYWNrZ3JvdW5kOiNmZmY7bWFyZ2luOjA7cGFkZGluZzowO3RleHQtYWxpZ246IGNlbnRlcjt9DQouc2lkZXJiYXItbm90ZXtwb3NpdGlvbjogYWJzb2x1dGU7ei1pbmRleDogMTt0b3A6IDA7bGVmdDowO21hcmdpbi10b3A6IDNweDt3aWR0aDogMjUycHg7fQ0KLnNpZGVyYmFyLXNvcnQtbGlzdCAud2lkZ2V0e3Bvc2l0aW9uOiByZWxhdGl2ZTt6LWluZGV4OiAyO30NCg0KLndpZGdldF9zb3VyY2Vfc3lzdGVtIC53aWRnZXQtdGl0bGV7YmFja2dyb3VuZDogI2UzZTRlNDt9DQoud2lkZ2V0X3NvdXJjZV91c2VycyAud2lkZ2V0LXRpdGxle2JhY2tncm91bmQ6ICNjNmQ0ZTU7fQ0KLndpZGdldF9zb3VyY2VfdGhlbWUgLndpZGdldC10aXRsZXtiYWNrZ3JvdW5kOiAjZDdlM2JjO30NCi53aWRnZXRfc291cmNlX3BsdWdpbiAud2lkZ2V0LXRpdGxle2JhY2tncm91bmQ6ICNkNGNkZGQ7fQ0KLndpZGdldF9zb3VyY2Vfb3RoZXIgLndpZGdldC10aXRsZXtiYWNrZ3JvdW5kOiAjZGVkOWMwO30NCi8qLmN1c3RvbS1zdGF0ZS1hY3RpdmV7YmFja2dyb3VuZDogI0I1RENGMDt9Ki8NCi5zaWRlcmJhci1saXN0IC5yb2xsIHtkaXNwbGF5Om5vbmU7fQ0KDQoNCi5lZHVpLWRlZmF1bHQgLmVkdWktZWRpdG9yIHsNCgl3aWR0aDoxMDAlIWltcG9ydGFudDsNCn0=</file>
	<file name='zb_system\DEFEND\thanks.html' crc32='8E743E03'  dt:dt='bin.base64'>77u/DQo8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+dmFyIGRhdGE9W3siaWQiOiJ7JVpDX01TRzMwNCV9IiwicGVyc29uIjpbe3VybDoiIixiYnM6OTgyLGlkOiJ6eC5hc2QiLHRpdGxlOiLov5nkuKrlsLHmmK9aLUJsb2fnqIvluo/nmoTkuLvliJssWi1CbG9n55qE54G16a2C5Lq654mpLOS8oOivtOS4reeahOS4jemUiOmSoueMqueMqizku44xLjDkuIDnm7TotbDliLAyLjDml7bku6MsQVNQ54mI5pys55qEWi1CbG9n5bCG5Lya5LiA55u06LWw5LiL5Y6755qELiJ9LHt1cmw6Ind3dy5lc2xveS5jb20iLGJiczowLHRpdGxlOiLlk4jlk4jlkIzlrablkIzmoLfmmK9aLUJsb2fnmoTkvKDlpYfkurrniaks5LuO5ZOI5ZOI5LiK5aSn5a2m5Yiw56CU56m255Sf5q+V5LiaLOS4gOebtOmDveWcqOS4ulotQmxvZ+S7mOWHuixaLUJsb2cgMS445pyJUFPlkoxUU+aPkuS7tuaJjeabtOeyvuW9qSzlnKjlj6/ku6XpooTop4HnmoTlsIbmnaUs5oiR5Lus5L6d54S25Lya5oul5pyJ5ZOI5ZOI5ZCM5a2m55qELOS4jeingeS4jeaVo+WTpi4iLGlkOiJIYXBoaWMifSx7dXJsOiJ3d3cuenN4c29mdC5jb20iLHRpdGxlOiLomb3nhLbov5jmsqHmiJDlubTvvIzpg5HljZrlo6vku47kuIDlh7rlnLrlsLHmmK/kuIDkuKrml6nnhp/lk4Hnp43vvIzlpKnmiY3vvIznnJ/mmK/lpKnmiY3vvIzljYHlhavoiKzmraboibrnsr7pgJrljYHkuIPmoLfjgILlsI/lsI/lubTnuqrvvIzkuI3kvYblrabmoKHph4zmt7fnmoTlpb3vvIzlubTlubTkuLvmjIHmlL7lub/mkq3vvIznvZHnu5zkuIrmm7TmmK/lkIPnmoTlvIDvvIzlhpnnqIvluo/lj5HpgJrlkYrovbvovabnhp/ot6/jgILov5notKfkuI3kvYblpLTohJHngbXmtLvvvIzogIzkuJTnsr7lipvljYHotrPlhYXmspvvvIzlg4/mmK/nu4Pov4fnq6XlrZDlip/vvIzlsIbmnaXnu53lr7nmmK/kuKrlkbzpo47llKTpm6jnmoTop5LoibLllYrvvIEiLGlkOiJaU1giLGJiczowfV19LHsiaWQiOiJ7JVpDX01TRzMwNSV9IiwicGVyc29uIjpbe3VybDoid3d3Lmh0bWxpdC5jb20uY24iLHRpdGxlOiLmlrDpspzkurrnmoTlt6XkvZzlsLHmmK/mr4/lpKnmjqXljZXmjqXljZXlho3mjqXljZUs5YW75a6257OK5Y+jLOWutumHjOeahOmhtuaigeafsSzmnInlhL/mnInlpbPnmoTnlLfkurrkuYvmpbfmqKEuIixiYnM6MCxpZDoi5paw6bKc5Lq6In0se3VybDoiaW1qaWFvLmNvbSIsdGl0bGU6Iue+juS4veWPiOWpiee6pueahOa5mOWmueWtkCzlj6/niLHnmoTlpJbooajkuIvmjqnol4/nnYDlj6Tlhbjnvo7nmoTmsJTotKgsWi1CbG9n5a6Y572R55qE6K6+6K6h6ICFLOeOsOWcqOa3seWcs+WBmuedgOWWnOasoueahOW3peS9nC4iLGlkOiLlqIflqIciLGJiczowfSx7aWQ6IuWQieWFieeJh+e+vSIsdGl0bGU6IuS7luWkqui9u+S6hizlsLHlg4/kuIDniYfnvr3mr5ss6aOO5LiA5ZC55bCx6aOe5LqGLuS4uuS6humBv+WFjeS5semjnizku5bnmoTlhoXlv4PlsLHmuJDmuJDnuqDnu5PotbfmnaXkuoYuIix1cmw6Ind3dy5qZ3B5LmNuIixiYnM6MH1dfSx7ImlkIjoieyVaQ19NU0czMDYlfSIsInBlcnNvbiI6W3t1cmw6IiIsYmJzOjQ0LHRpdGxlOiJaLUJsb2fph4znmoTogIHpu4TniZss55yf5q2j55qE6ICB6buE54mbLOS4jeaEp+aYr+WxnueJm+eahCzmgLvmmK/lnKjpu5jpu5jml6Dpl7vnmoTlpYnnjK7nnYDku5bnmoTkuIDliIcs5ZCD55qE5piv6I2JLOaMpOWHuuadpeeahOaYr+i0tOWtkOWSjOS7o+eggSzorqnmiJHku6zlkJHku5boh7Tmlaws56Wd5pyI5pyo5ZCM5a2m5b+r54K55o+Q5Y2H5LiA5LiL5oqK5aa5562J57qnLOWPjOWuv+WPjOmjnuaKiuWmueW9kiEiLGlkOiLmnIjkuIrkuYvmnKgifSx7dXJsOiJ3d3cud2FzaHVuLmNvbSIsdGl0bGU6IuiogOivreeKgOWIqeeahFdhc2h1buaYr+iuuuWdm+eahOeBtemtgizkuLrkuoZaLUJsb2fnmoTlj5HlsZXlkJDlsL3kuoblkITnp43mp70s57uI5LqO5ZCQ552A5ZCQ552A5ZCQ5LiN5Yqo5LqGLOS9huWlh+i/ueWPkeeUn+S6hizku5bku6XlkI7lho3kuZ/kuI3nlKjlkJDkuoYs5Y+v5Lul5pS55Li65Za35LqGLuelnVdhc2h1buWQjOWtpuiBquaYjuWPr+eIseeahOWls+WEv+WBpeW6t+aIkOmVvyEiLGlkOiJXYXNodW4iLGJiczowfSx7dXJsOiJ3d3cuZWN3b3JrZXIuY29tIix0aXRsZToi5Lyg57ufLOmhvuWutizniLHogIHlqYbmm7TniLHlhL/lrZDnmoTllYbliqHnsr7oi7Es5Yuk5aWL55qESmlt5ZCM5a2m5YOP54mb6Jm75LiA5qC355qE5Y+u552A6YKj5Y+q5oeS54yqLOe7iOS6juaIkOWKn+S6hiwyLjDooqvku5bmi7Hkuoblh7rmnaUs5LuW56uL5Yqf5LqGLOS7lueri+WKn+S6hizku5bkuLpaLUJsb2fnq4vkuobkuIDlpKflip8s5oGt5ZacSmlt5ZCM5a2mISIsaWQ6IuWwj+mjnum+mSIsYmJzOjB9LHt1cmw6ImltemhvdS5jb20iLHRpdGxlOiLnsqXogIHluIjvvIzljZbng6fppbznmoTlpKflj7fnurHluIPnsqXogIHmub/vvIEiLGlkOiLmnKrlr5IiLGJiczowfV19LHsiaWQiOiJ7JVpDX01TRzMwNyV9IixwZXJzb246W3t1cmw6Ind3dy54aDEzMC5jb20iLHRpdGxlOiLmi77lj4HlkIzlrabliJvnq4vkuoZaLUJsb2fnmoTorrrlnZss5LuW5oqKWi1CbG9n5bim5LiK5LqG5byA5pS+55qE6YGT6LevLOi/meWwseaYr1otQmxvZ+iuuuWdm3VpZD0x55qE5Lq654mpIeelneaLvuWPgeWQjOWtpueahOWutuW6ree+jua7oeW5uOemjyzkuovkuJrlhbTml7rlj5Hovr4hISEiLGlkOiLmi77lj4EiLGJiczoxfSx7dXJsOiIiLHRpdGxlOiJNQU/kuLvluK3or7Tov4dDUOaYr+S4quWlveWQjOW/lyEiLGlkOiJDYXB0aWFuIixiYnM6NTI2M30se3VybDoiIix0aXRsZToi5bm06L275pyJ5Li655qE5oqA5pyv6L6+5Lq6LOa0pemXqOWwj+W8uizovazmiJjnp7vliqjlvIDlj5HkuoYuIixpZDoi5piO5pyI5pif5YWJIixiYnM6Nn0se3VybDoid3d3LmRjOS5jbiIsdGl0bGU6IiIsaWQ6IlNpcG8iLGJiczowfSx7dXJsOiJ3d3cud2lsbGlhbWxvbmcuaW5mbyIsdGl0bGU6IiIsaWQ6Ium+meWogeW7iSIsYmJzOjB9LHt1cmw6Ilp4TVlTLkNPTSIsdGl0bGU6IiIsaWQ6Ilp4Lk15cyIsYmJzOjB9LHt1cmw6Ind3dy53aWxmLmNuIix0aXRsZToiIixpZDoi54u855qE5peL5b6LIixiYnM6MH0se3VybDoid3d3Lml6aHUub3JnIix0aXRsZToi5aSn54yqLOWkp+eMqizlpKflpKfnjKoh5Lyg6K+05Lit55qE6YKj5aS05aSn54yqISEhIixpZDoi5aSn54yqIixiYnM6MH0se3VybDoiIix0aXRsZToiIixpZDoi5bu6562R55uS5a2QIixiYnM6ODR9LHt1cmw6Ind3dy5idXNmbHkubmV0Iix0aXRsZToiIixpZDoiQnVzZmx5IixiYnM6MH0se3VybDoid3d3Lmhjb25seS5jb20iLHRpdGxlOiIiLGlkOiLkvZXmsqciLGJiczowfSx7dXJsOiJ4dmRlc2lnbi5jb20iLHRpdGxlOiIiLGlkOiJJdFNlYW4iLGJiczowfSx7dXJsOiJsdXNvbmdzb25nLmNvbSIsdGl0bGU6IiIsaWQ6IuWNouadvuadviIsYmJzOjB9LHt1cmw6IiIsdGl0bGU6IiIsaWQ6IueRnOW7tyIsYmJzOjc1NDg1fSx7dXJsOiJ3d3cuaHVpc2VtLmNvbSIsdGl0bGU6IiIsaWQ6Iua1geW5tCIsYmJzOjB9LHt1cmw6Ind3dy56YmxvZy53cyIsdGl0bGU6IiIsaWQ6IuS/oeW/gyIsYmJzOjB9XX0seyJpZCI6IuebuOWFs+mTvuaOpSIsInBlcnNvbiI6W3t1cmw6Ind3dy5yYWluYm93c29mdC5vcmcvemJsb2ciLHRpdGxlOiIiLGlkOiLnqIvluo/kuIvovb0gIixiYnM6MH0se3VybDoid2lraS5yYWluYm93c29mdC5vcmciLHRpdGxlOiIiLGlkOiJXaWtp5paH5qGjICIsYmJzOjB9LHt1cmw6ImFwcC5yYWluYm93c29mdC5vcmciLHRpdGxlOiIiLGlkOiLlupTnlKjkuK3lv4MgIixiYnM6MH0se3VybDoiYmJzLnJhaW5ib3dzb2Z0Lm9yZyIsdGl0bGU6IiIsaWQ6IlpCbG9nZ2Vy56S+5Yy6ICIsYmJzOjB9LHt1cmw6Ind3dy5kYnNob3N0LmNuIix0aXRsZToiIixpZDoiREJT5Li75py656m66Ze0ICIsYmJzOjB9XX1dO3ZhciBfdGxpc3Q9Jzx0YWJsZSBib3JkZXI9IjAiIGNlbGxzcGFjaW5nPSIwIiBjZWxscGFkZGluZz0iMCIgYWxpZ249ImNlbnRlciIgd2lkdGg9IjEwMCUiIGNsYXNzPSJ0YWJsZUJvcmRlciIgaWQ9InRoYW5rc2xpc3QiPjx0aGVhZD48dHI+PHRoIGhlaWdodD0iMzIiIGNvbHNwYW49IjIiPiZuYnNwO3slWkNfTVNHMzAzJX08L3RoPjwvdHI+PC90aGVhZD48dGJvZHk+Jztmb3IodmFyIGk9MDtpPGRhdGEubGVuZ3RoO2krKyl7X3RsaXN0Kz0iPHRyPjx0ZCB3aWR0aD0nOCUnPiIrZGF0YVtpXS5pZCsiPC90ZD48dGQ+Ijtmb3IodmFyIGw9MDtsPGRhdGFbaV0ucGVyc29uLmxlbmd0aDtsKyspe190bGlzdCs9IjxhIHRhcmdldD0nX2JsYW5rJyBocmVmPSciKyhkYXRhW2ldLnBlcnNvbltsXS51cmw9PSIiPyJodHRwOi8vYmJzLnJhaW5ib3dzb2Z0Lm9yZy9ob21lLnBocD9tb2Q9c3BhY2UmdWlkPSIrZGF0YVtpXS5wZXJzb25bbF0uYmJzKyImZG89cHJvZmlsZSI6Imh0dHA6Ly8iK2RhdGFbaV0ucGVyc29uW2xdLnVybCsiLyIpKyInIHRpdGxlPSciK2RhdGFbaV0ucGVyc29uW2xdLnRpdGxlO190bGlzdCs9Iic+IitkYXRhW2ldLnBlcnNvbltsXS5pZCsiPC9hPiZuYnNwOyJ9X3RsaXN0Kz0oaT09ZGF0YS5sZW5ndGgtMT8ieyVaQ19NU0czMDglfSI6IiIpKyI8L3RkPjwvdHI+In1fdGxpc3QrPSI8L3Rib2R5Pjx0Zm9vdD48L3Rmb290PjwvdGFibGU+Ijtkb2N1bWVudC53cml0ZShfdGxpc3QpOzwvc2NyaXB0Pg==</file>
	<file name='zb_system\FUNCTION\c_admin_js_add.asp' crc32='DE7CEF41'  dt:dt='bin.base64'>77u/PCVAIENPREVQQUdFPTY1MDAxICU+DQo8JQ0KJy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCicvLyAgICAgICAgICAgICAgWi1CbG9nDQonLy8g5L2cICAgIOiAhTogICAg5pyx54WKKHp4LmFzZCkNCicvLyDniYjmnYPmiYDmnIk6ICAgIFJhaW5ib3dTb2Z0IFN0dWRpbw0KJy8vIOaKgOacr+aUr+aMgTogICAgcmFpbmJvd3NvZnRAMTYzLmNvbQ0KJy8vIOeoi+W6j+WQjeensDogICAgDQonLy8g56iL5bqP54mI5pysOiAgICANCicvLyDljZXlhYPlkI3np7A6ICAgIGNfYWRtaW5fanMuYXNwDQonLy8g5byA5aeL5pe26Ze0OiAgICANCicvLyDmnIDlkI7kv67mlLk6ICAgIA0KJy8vIOWkhyAgICDms6g6ICAgIA0KJy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCiU+DQo8JSBPcHRpb24gRXhwbGljaXQgJT4NCjwlIE9uIEVycm9yIFJlc3VtZSBOZXh0ICU+DQo8JSBSZXNwb25zZS5DaGFyc2V0PSJVVEYtOCIgJT4NCjwlIFJlc3BvbnNlLkJ1ZmZlcj1UcnVlICU+DQo8JSBSZXNwb25zZS5Db250ZW50VHlwZT0iYXBwbGljYXRpb24veC1qYXZhc2NyaXB0IiAlPg0KPCEtLSAjaW5jbHVkZSBmaWxlPSIuLi8uLi96Yl91c2Vycy9jX29wdGlvbi5hc3AiIC0tPg0KPCEtLSAjaW5jbHVkZSBmaWxlPSIuLi9mdW5jdGlvbi9jX2Z1bmN0aW9uLmFzcCIgLS0+DQo8IS0tICNpbmNsdWRlIGZpbGU9Ii4uL2Z1bmN0aW9uL2Nfc3lzdGVtX2xpYi5hc3AiIC0tPg0KPCEtLSAjaW5jbHVkZSBmaWxlPSIuLi9mdW5jdGlvbi9jX3N5c3RlbV9iYXNlLmFzcCIgLS0+DQo8IS0tICNpbmNsdWRlIGZpbGU9Ii4uL2Z1bmN0aW9uL2Nfc3lzdGVtX3BsdWdpbi5hc3AiIC0tPg0KPCEtLSAjaW5jbHVkZSBmaWxlPSIuLi8uLi96Yl91c2Vycy9wbHVnaW4vcF9jb25maWcuYXNwIiAtLT4NCg0KPCUgUmVzcG9uc2UuQ2xlYXIgJT4NCnZhciBibG9naG9zdD0iPCU9QmxvZ0hvc3QlPiI7DQp2YXIgY29va2llc3BhdGg9IjwlPUNvb2tpZXNQYXRoKCklPiI7DQp2YXIgc3RyMDA9IjwlPUJsb2dIb3N0JT4iOw0KDQoNCg0KLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCi8vIOebrueahO+8miAgICDlhajpgIkNCi8vIOi+k+WFpe+8miAgICDml6ANCi8vIOi/lOWbnu+8miAgICDml6ANCi8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpmdW5jdGlvbiBCYXRjaFNlbGVjdEFsbCgpIHsNCgl2YXIgYXJ5Q2hlY2tzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImlucHV0Iik7DQoNCglmb3IgKHZhciBpID0gMDsgaSA8IGFyeUNoZWNrcy5sZW5ndGg7IGkrKyl7DQoJCWlmKChhcnlDaGVja3NbaV0udHlwZT09ImNoZWNrYm94IikmJihhcnlDaGVja3NbaV0uaWQuaW5kZXhPZigiZWR0IikhPT0tMSkpew0KCQkJaWYoYXJ5Q2hlY2tzW2ldLmNoZWNrZWQ9PXRydWUpew0KCQkJCWFyeUNoZWNrc1tpXS5jaGVja2VkPWZhbHNlOw0KCQkJfQ0KCQkJZWxzZXsNCgkJCQlhcnlDaGVja3NbaV0uY2hlY2tlZD10cnVlOw0KCQkJfTsNCgkJfQ0KCX0NCn0NCi8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCi8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQovLyDnm67nmoTvvJogICAgDQovLyDovpPlhaXvvJogICAg5pegDQovLyDov5Tlm57vvJogICAg5pegDQovLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KZnVuY3Rpb24gQmF0Y2hEZWxldGVBbGwob2JqRWRpdCkgew0KDQoJb2JqRWRpdD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChvYmpFZGl0KTsNCglvYmpFZGl0LnZhbHVlPSIiOw0KCXZhciBhcnlDaGVja3MgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaW5wdXQiKTsNCglmb3IgKHZhciBpID0gMDsgaSA8IGFyeUNoZWNrcy5sZW5ndGg7IGkrKyl7DQoJCWlmKChhcnlDaGVja3NbaV0udHlwZT09ImNoZWNrYm94IikmJihhcnlDaGVja3NbaV0uaWQuaW5kZXhPZigiZWR0IikhPT0tMSkpew0KCQkJaWYoYXJ5Q2hlY2tzW2ldLmNoZWNrZWQpew0KCQkJCW9iakVkaXQudmFsdWU9YXJ5Q2hlY2tzW2ldLnZhbHVlKyIsIitvYmpFZGl0LnZhbHVlOw0KCQkJfQ0KCQl9DQoJfQ0KDQp9DQovLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQoNCg0KDQoNCi8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQovLyDnm67nmoTvvJogICAgQWN0aXZlTGVmdE1lbnUNCi8vIOi+k+WFpe+8miAgICDml6ANCi8vIOi/lOWbnu+8miAgICDml6ANCi8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpmdW5jdGlvbiBBY3RpdmVMZWZ0TWVudShuYW1lKXsNCg0KCW5hbWU9IiMiK25hbWU7DQoJJCgiI2xlZnRtZW51IGxpIikucmVtb3ZlQ2xhc3MoIm9uIik7DQoJJChuYW1lKS5wYXJlbnQoKS5hZGRDbGFzcygib24iKTsNCgl2YXIgcz0kKG5hbWUpLmNoaWxkcmVuKCJzcGFuIikuY3NzKCJiYWNrZ3JvdW5kLWltYWdlIik7DQoJaWYocyE9PXVuZGVmaW5lZCl7DQoJCXM9cy5yZXBsYWNlKCIxLnBuZyIsIjIucG5nIik7DQoJCSQobmFtZSkuY2hpbGRyZW4oInNwYW4iKS5jc3MoImJhY2tncm91bmQtaW1hZ2UiLHMpOw0KCX0NCg0KfQ0KLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCi8vIOebrueahO+8miAgICBBY3RpdmVUb3BNZW51DQovLyDovpPlhaXvvJogICAg5pegDQovLyDov5Tlm57vvJogICAg5pegDQovLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KZnVuY3Rpb24gQWN0aXZlVG9wTWVudShuYW1lKXsNCg0KCW5hbWU9IiMiK25hbWU7DQoJJCgiI3RvcG1lbnUgbGkiKS5yZW1vdmVDbGFzcygib24iKTsNCgkkKG5hbWUpLmFkZENsYXNzKCJvbiIpOw0KDQp9DQovLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQoNCi8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQovLyDnm67nmoTvvJogICAg6KGo5qC85paR6ams57q/DQovLyDovpPlhaXvvJogICAg5pegDQovLyDov5Tlm57vvJogICAg5pegDQovLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KZnVuY3Rpb24gYm14MnRhYmxlKCl7DQoJdmFyIGNsYXNzXz1uZXcgQXJyYXkoImNvbG9yMiIsImNvbG9yMyIsImNvbG9yNCIpOw0KCXZhciBqPSQoInRhYmxlW2NsYXNzIT0nbm9ibXgnXSB0cjpoYXModGgpIikuYWRkQ2xhc3MoImNvbG9yMSIpOw0KICAgICQoInRhYmxlW2NsYXNzIT0nbm9ibXgnXSIpLmVhY2goZnVuY3Rpb24oKXsNCiAJCWlmKGoubGVuZ3RoPT0wKXtjbGFzc19bMV09ImNvbG9yMiI7Y2xhc3NfWzBdPSJjb2xvcjMiO30gDQoJCSQodGhpcykuZmluZCgidHI6bm90KDpoYXModGgpKTpldmVuIikucmVtb3ZlQ2xhc3MoY2xhc3NfWzBdKS5hZGRDbGFzcyhjbGFzc19bMV0pOw0KCQkkKHRoaXMpLmZpbmQoInRyOm5vdCg6aGFzKHRoKSk6b2RkIikucmVtb3ZlQ2xhc3MoY2xhc3NfWzFdKS5hZGRDbGFzcyhjbGFzc19bMF0pOw0KCX0pDQoJJCgidGFibGVbY2xhc3MhPSdub2JteCddIikuZmluZCgidHI6bm90KDpoYXModGgpKSIpLm1vdXNlb3ZlcihmdW5jdGlvbigpeyQodGhpcykuYWRkQ2xhc3MoY2xhc3NfWzJdKX0pLm1vdXNlb3V0KGZ1bmN0aW9uKCl7JCh0aGlzKS5yZW1vdmVDbGFzcyhjbGFzc19bMl0pfSk7IA0KfTsgDQovLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQoNCi8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQovLyDnm67nmoTvvJogICAg5om56YeP5pON5L2c5o+Q6YaSDQovLyDovpPlhaXvvJogICAg5pegDQovLyDov5Tlm57vvJogICAg5pegDQovLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KZnVuY3Rpb24gQmF0Y2gyVGlwKHMpeyQoIiNiYXRjaCBwIikuaHRtbChzKX0NCmZ1bmN0aW9uIEJhdGNoQ29udGludWUoKXskKCIjYmF0Y2ggcCIpLmJlZm9yZSgiPGlmcmFtZSBzdHlsZT0nd2lkdGg6MjBweDtoZWlnaHQ6MjBweDsnIGZyYW1lYm9yZGVyPScwJyBzY3JvbGxpbmc9J25vJyBzcmM9JzwlPUJsb2dIb3N0JT56Yl9zeXN0ZW0vY21kLmFzcD9hY3Q9YmF0Y2gnPjwvaWZyYW1lPiIpOyQoIiNiYXRjaCBpbWciKS5yZW1vdmUoKTt9DQpmdW5jdGlvbiBCYXRjaEJlZ2luKCl7fTsNCmZ1bmN0aW9uIEJhdGNoRW5kKCl7fTsNCmZ1bmN0aW9uIEJhdGNoTm90aWZ5KCl7bm90aWZ5KCQoIiNiYXRjaCBwIikuaHRtbCgpKX0NCmZ1bmN0aW9uIEJhdGNoQ2FuY2VsKCl7JCgiI2JhdGNoIGlmcmFtZSIpLnJlbW92ZSgpOyQoIiNiYXRjaCBwIikuYmVmb3JlKCI8aWZyYW1lIHN0eWxlPSd3aWR0aDoyMHB4O2hlaWdodDoyMHB4OycgZnJhbWVib3JkZXI9JzAnIHNjcm9sbGluZz0nbm8nIHNyYz0nPCU9QmxvZ0hvc3QlPnpiX3N5c3RlbS9jbWQuYXNwP2FjdD1iYXRjaCZjYW5jZWw9dHJ1ZSc+PC9pZnJhbWU+Iik7fTsNCi8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCi8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQovLyDnm67nmoTvvJogICAgQ2hlY2tCb3gNCi8vIOi+k+WFpe+8miAgICDml6ANCi8vIOi/lOWbnu+8miAgICDml6ANCi8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpmdW5jdGlvbiBjaGFuZ2VDaGVja1ZhbHVlKG9iail7DQoNCgkkKG9iaikudG9nZ2xlQ2xhc3MoJ2ltZ2NoZWNrLW9uJyk7DQoNCglpZigkKG9iaikuaGFzQ2xhc3MoJ2ltZ2NoZWNrLW9uJykpew0KCQkkKG9iaikucHJldignaW5wdXQnKS52YWwoJ1RydWUnKTsNCgl9ZWxzZXsNCgkJJChvYmopLnByZXYoJ2lucHV0JykudmFsKCdGYWxzZScpOw0KCX0NCg0KfQ0KLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCi8vIOebrueahO+8miAgICBOb3RpZmljYXRpb25zDQovLyDovpPlhaXvvJogICAg5pegDQovLyDov5Tlm57vvJogICAg5pegDQovLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KZnVuY3Rpb24gbm90aWZ5KHMpew0KCWlmICh3aW5kb3cud2Via2l0Tm90aWZpY2F0aW9ucykgew0KCQlpZiAod2luZG93LndlYmtpdE5vdGlmaWNhdGlvbnMuY2hlY2tQZXJtaXNzaW9uKCkgPT0gMCkgew0KCQkJdmFyIHpiX25vdGlmaWNhdGlvbnMgPSB3aW5kb3cud2Via2l0Tm90aWZpY2F0aW9ucy5jcmVhdGVOb3RpZmljYXRpb24oJzwlPUJsb2dIb3N0JT56Yl9zeXN0ZW0vSU1BR0UvQURNSU4vbG9nby0xNi5wbmcnLCAnPCU9WkNfTVNHMjU3JT4nLCBzKTsNCgkJCXpiX25vdGlmaWNhdGlvbnMuc2hvdygpOw0KCQkJemJfbm90aWZpY2F0aW9ucy5vbmNsaWNrID0gZnVuY3Rpb24oKSB7dG9wLmZvY3VzKCksdGhpcy5jYW5jZWwoKTt9DQoJCQl6Yl9ub3RpZmljYXRpb25zLnJlcGxhY2VJZCA9ICdNZXRlb3JpYyc7DQoJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7emJfbm90aWZpY2F0aW9ucy5jYW5jZWwoKX0sNTAwMCk7DQoJCX0gZWxzZSB7DQoJCQl3aW5kb3cud2Via2l0Tm90aWZpY2F0aW9ucy5yZXF1ZXN0UGVybWlzc2lvbihub3RpZnkpOw0KCQl9DQoJfSANCn0NCi8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQpmdW5jdGlvbiBzdGF0aXN0aWMocyl7DQoJJCgiI3N0YXRsb2FkaW5nIikuc2hvdygpOw0KCSQoIiN1cGRhdGF0aW1lIikuaGlkZSgpOw0KCSQuZ2V0KCJjX3N0YXRpc3RpYy5hc3AiK3Mse30sDQoJCWZ1bmN0aW9uKGRhdGEpew0KCQkJJCgiI3RiU3RhdGlzdGljIikuaHRtbChkYXRhKTsNCgkJCWJteDJ0YWJsZSgpOw0KCQkJJCgiI3N0YXRsb2FkaW5nIikuaGlkZSgpOw0KCQkJJCgiI3VwZGF0YXRpbWUiKS5zaG93KCk7DQoJCX0NCgkpOw0KfQ0KDQpmdW5jdGlvbiB1cGRhdGVpbmZvKHMpew0KCSQoIiNpbmZvbG9hZGluZyIpLnNob3coKTsNCgkkLmdldCgiY191cGRhdGVpbmZvLmFzcCIrcyx7fSwNCgkJZnVuY3Rpb24oZGF0YSl7DQoJCQkkKCIjdGRVcGRhdGVJbmZvIikuaHRtbChkYXRhKTsNCgkJCSQoIiNpbmZvbG9hZGluZyIpLmhpZGUoKTsNCgkJfQ0KCSk7DQp9DQoNCg0KDQoNCg0KLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCi8vIOebrueahO+8miAgICANCi8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQokKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpeyANCg0KCS8vIENvbnRlbnQgYm94IHRhYnM6DQoJJCgnLmNvbnRlbnQtYm94IC5jb250ZW50LWJveC1jb250ZW50IGRpdi50YWItY29udGVudCcpLmhpZGUoKTsgLy8gSGlkZSB0aGUgY29udGVudCBkaXZzDQoJJCgndWwuY29udGVudC1ib3gtdGFicyBsaSBhLmRlZmF1bHQtdGFiJykuYWRkQ2xhc3MoJ2N1cnJlbnQnKTsgLy8gQWRkIHRoZSBjbGFzcyAiY3VycmVudCIgdG8gdGhlIGRlZmF1bHQgdGFiDQoJJCgnLmNvbnRlbnQtYm94LWNvbnRlbnQgZGl2LmRlZmF1bHQtdGFiJykuc2hvdygpOyAvLyBTaG93IHRoZSBkaXYgd2l0aCBjbGFzcyAiZGVmYXVsdC10YWIiDQoNCgkkKCcuY29udGVudC1ib3ggdWwuY29udGVudC1ib3gtdGFicyBsaSBhJykuY2xpY2soIC8vIFdoZW4gYSB0YWIgaXMgY2xpY2tlZC4uLg0KCQlmdW5jdGlvbigpIHsgDQoJCQkkKHRoaXMpLnBhcmVudCgpLnNpYmxpbmdzKCkuZmluZCgiYSIpLnJlbW92ZUNsYXNzKCdjdXJyZW50Jyk7IC8vIFJlbW92ZSAiY3VycmVudCIgY2xhc3MgZnJvbSBhbGwgdGFicw0KCQkJJCh0aGlzKS5hZGRDbGFzcygnY3VycmVudCcpOyAvLyBBZGQgY2xhc3MgImN1cnJlbnQiIHRvIGNsaWNrZWQgdGFiDQoJCQl2YXIgY3VycmVudFRhYiA9ICQodGhpcykuYXR0cignaHJlZicpOyAvLyBTZXQgdmFyaWFibGUgImN1cnJlbnRUYWIiIHRvIHRoZSB2YWx1ZSBvZiBocmVmIG9mIGNsaWNrZWQgdGFiDQoJCQkkKGN1cnJlbnRUYWIpLnNpYmxpbmdzKCkuaGlkZSgpOyAvLyBIaWRlIGFsbCBjb250ZW50IGRpdnMNCgkJCSQoY3VycmVudFRhYikuc2hvdygpOyAvLyBTaG93IHRoZSBjb250ZW50IGRpdiB3aXRoIHRoZSBpZCBlcXVhbCB0byB0aGUgaWQgb2YgY2xpY2tlZCB0YWINCgkJCXJldHVybiBmYWxzZTsgDQoJCX0NCgkpOw0KDQoJLy/mlpHpqaznur/ljJbooajmoLwNCglibXgydGFibGUoKTsNCg0KCWlmKCQoJy5TdWJNZW51JykuZmluZCgnc3BhbicpLmxlbmd0aD4wKXsNCgkJLy9pZigkKCcjbGVmdG1lbnUnKS5maW5kKCdsaS5vbicpLmxlbmd0aD4wKXsNCgkJLy8JJCgnI2xlZnRtZW51IGxpLm9uJykuYWZ0ZXIoJzxsaSBjbGFzcz0ic3ViIj4nKyQoJy5TdWJNZW51JykuaHRtbCgpKyc8L2xpPicpOw0KCQkvL31lbHNlew0KCQkJJCgnLlN1Yk1lbnUnKS5zaG93KCk7DQoJCS8vfQ0KCX0NCgkNCgkvL2NoZWNrYm94DQoJaWYoISgoJC5icm93c2VyLm1zaWUpJiYoJC5icm93c2VyLnZlcnNpb24pPT0nNi4wJykpew0KCQkkKCdpbnB1dC5jaGVja2JveCcpLmNzcygiZGlzcGxheSIsIm5vbmUiKTsNCgkJJCgnaW5wdXQuY2hlY2tib3hbdmFsdWU9IlRydWUiXScpLmFmdGVyKCc8c3BhbiBjbGFzcz0iaW1nY2hlY2sgaW1nY2hlY2stb24iPjwvc3Bhbj4nKTsNCgkJJCgnaW5wdXQuY2hlY2tib3hbdmFsdWUhPSJUcnVlIl0nKS5hZnRlcignPHNwYW4gY2xhc3M9ImltZ2NoZWNrIj48L3NwYW4+Jyk7DQoJfWVsc2V7DQoJCSQoJ2lucHV0LmNoZWNrYm94JykuYXR0cigncmVhZG9ubHknLCdyZWFkb25seScpOw0KCQkkKCdpbnB1dC5jaGVja2JveCcpLmNzcygnY3Vyc29yJywncG9pbnRlcicpOw0KCQkkKCdpbnB1dC5jaGVja2JveCcpLmNsaWNrKGZ1bmN0aW9uKCl7ICBpZigkKHRoaXMpLnZhbCgpPT0nVHJ1ZScpeyQodGhpcykudmFsKCdGYWxzZScpfWVsc2V7JCh0aGlzKS52YWwoJ1RydWUnKX0gfSkNCgl9DQoNCgkkKCdzcGFuLmltZ2NoZWNrJykuY2xpY2soZnVuY3Rpb24oKXtjaGFuZ2VDaGVja1ZhbHVlKHRoaXMpfSkNCg0KCS8vYmF0Y2gNCgkkKCIjYmF0Y2ggYSIpLmJpbmQoImNsaWNrIiwgZnVuY3Rpb24oKXsgQmF0Y2hDb250aW51ZSgpOyQoIiNiYXRjaCBwIikuaHRtbCgiPCU9WkNfTVNHMTA5JT4uLi4iKTt9KTsNCg0KCSQoIi5TdWJNZW51IHNwYW4ubS1yaWdodCIpLnBhcmVudCgpLmNzcyh7ImZsb2F0IjoicmlnaHQifSk7DQoNCn0pOw0KDQo8JT1SZXNwb25zZV9QbHVnaW5fQWRtaW5fSnNfQWRkJT4=</file>
	<file name='zb_system\FUNCTION\c_system_base.asp' crc32='6FC0E285'  dt:dt='bin.base64'>77u/PCUNCicvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQonLy8gICAgICAgICAgICAgIFotQmxvZw0KJy8vIOS9nCAgICDogIU6ICAgIOacseeFiih6eC5hc2QpDQonLy8g54mI5p2D5omA5pyJOiAgICBSYWluYm93U29mdCBTdHVkaW8NCicvLyDmioDmnK/mlK/mjIE6ICAgIHJhaW5ib3dzb2Z0QDE2My5jb20NCicvLyDnqIvluo/lkI3np7A6DQonLy8g56iL5bqP54mI5pysOg0KJy8vIOWNleWFg+WQjeensDogICAgY19zeXN0ZW1fYmFzZS5hc3ANCicvLyDlvIDlp4vml7bpl7Q6ICAgIDIwMDUuMDIuMTENCicvLyDmnIDlkI7kv67mlLk6DQonLy8g5aSHICAgIOazqDoNCicvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQoNCiflrprkuYnlhajlsYDlj5jph48NCkRpbSBvYmpDb25uDQoNCkRpbSBCbG9nVGl0bGUNCg0KDQpEaW0gQmxvZ0hvc3QNCkJsb2dIb3N0PUdldEN1cnJlbnRIb3N0KCkNClpDX0JMT0dfSE9TVD1CbG9nSG9zdA0KDQpEaW0gQmxvZ1BhdGgNCkJsb2dQYXRoPUdldFJlYWxseURpcmVjdG9yeSgpDQoNCifooaXkuIpjX29wdGlvbi5hc3DmnKrmm7TmlrDnmoTlj4LmlbANCkNhbGwgQ2hlY2tVbmRlZmluZWQoKQ0KDQoNCkRpbSBCbG9nVmVyc2lvbg0KQmxvZ1ZlcnNpb249R2V0QmxvZ1ZlcnNpb24oKQ0KDQpEaW0gWkNfQkxPR19DTFNJRF9PUklHSU5BTA0KWkNfQkxPR19DTFNJRF9PUklHSU5BTD1aQ19CTE9HX0NMU0lEDQpaQ19CTE9HX0NMU0lEPU1ENShCbG9nUGF0aCAmIFpDX0JMT0dfQ0xTSURfT1JJR0lOQUwpDQoNCkRpbSBTdGFyVGltZQ0KRGltIEVuZFRpbWUNClN0YXJUaW1lID0gVGltZXIoKQ0KDQpEaW0gQmxvZ1VzZXINClNldCBCbG9nVXNlciA9TmV3IFRVc2VyDQoNCkRpbSBDYXRlZ29yeXMoKQ0KRGltIFVzZXJzKCkNCkRpbSBUYWdzKCkNCkRpbSBGdW5jdGlvbnMoKQ0KDQpSZURpbSBDYXRlZ29yeXMoMCkNClJlRGltIFVzZXJzKDApDQpSZURpbSBUYWdzKDApDQpSZURpbSBGdW5jdGlvbnMoMCkNCg0KU2V0IENhdGVnb3J5cygwKT1OZXcgVENhdGVnb3J5DQpTZXQgVXNlcnMoMCk9TmV3IFRVc2VyDQpTZXQgVGFncygwKT1OZXcgVFRhZw0KDQpEaW0gRnVuY3Rpb25NZXRhcw0KU2V0IEZ1bmN0aW9uTWV0YXM9TmV3IFRNZXRhDQoNCkRpbSBDb25maWdNZXRhcw0KU2V0IENvbmZpZ01ldGFzPU5ldyBUTWV0YQ0KDQpEaW0gQmxvZ0NvbmZpZw0KU2V0IEJsb2dDb25maWcgPSBOZXcgVENvbmZpZw0KDQpEaW0gUGx1Z2luTmFtZSgpDQpEaW0gUGx1Z2luQWN0aXZlRnVuY3Rpb24oKQ0KUmVEaW0gUGx1Z2luTmFtZSgwKQ0KUmVEaW0gUGx1Z2luQWN0aXZlRnVuY3Rpb24oMCkNCg0KDQpEaW0gVGVtcGxhdGVEaWMNCkRpbSBUZW1wbGF0ZVRhZ3NEaWMNCg0KU2V0IFRlbXBsYXRlRGljPUNyZWF0ZU9iamVjdCgiU2NyaXB0aW5nLkRpY3Rpb25hcnkiKQ0KU2V0IFRlbXBsYXRlVGFnc0RpYz1DcmVhdGVPYmplY3QoIlNjcmlwdGluZy5EaWN0aW9uYXJ5IikNCg0KRGltIFpDX0JMT0dfV0VCRURJVA0KWkNfQkxPR19XRUJFRElUPSJ1ZWRpdG9yIg0KDQpEaW0gWkNfVEJfRVhDRVJQVF9NQVgNClpDX1RCX0VYQ0VSUFRfTUFYPTI1MA0KDQpEaW0gWkNfVFJBQ0tCQUNLX1RVUk5PRkYNClpDX1RSQUNLQkFDS19UVVJOT0ZGPVRydWUNCg0KQ29uc3QgWkNfRElTUExBWV9NT0RFX0FMTD0xDQpDb25zdCBaQ19ESVNQTEFZX01PREVfSU5UUk89Mg0KQ29uc3QgWkNfRElTUExBWV9NT0RFX09OVE9QPTMNCkNvbnN0IFpDX0RJU1BMQVlfTU9ERV9TRUFSQ0g9NA0KQ29uc3QgWkNfRElTUExBWV9NT0RFX1NZU1RFTVBBR0U9NQ0KQ29uc3QgWkNfRElTUExBWV9NT0RFX0NPTU1FTlRTPTYNCg0KDQpDb25zdCBaQ19QT1NUX1RZUEVfQVJUSUNMRT0wDQpDb25zdCBaQ19QT1NUX1RZUEVfUEFHRT0xDQoNCg0KQ29uc3QgWkNfREVGQVVMVF9TSURFQkFSPSJjYWxlbmRhcjpjb250cm9scGFuZWw6Y2F0YWxvZzpzZWFyY2hwYW5lbDpjb21tZW50czphcmNoaXZlczpmYXZvcml0ZTpsaW5rOm1pc2MiDQoNCkRpbSBaQ19OQVZCQVJfTUVOVV9JVEVNDQpaQ19OQVZCQVJfTUVOVV9JVEVNPSI8bGkgaWQ9IiJtZW51LSV0eXBlLSVpZCIiPjxhIGhyZWY9IiIldXJsIiI+JW5hbWU8L2E+PC9saT4iDQoNCg0KRGltIFpDX1BBR0VfQU5EX0FSVElDTEVfUFJJVkFURV9SRUdFWA0KWkNfUEFHRV9BTkRfQVJUSUNMRV9QUklWQVRFX1JFR0VYPSJ7JWhvc3QlfS92aWV3LmFzcD9pZD17JWlkJX0iDQoNCg0KRGltIFpDX1BBR0VfQU5EX0FSVElDTEVfRFJBRlRfUkVHRVgNClpDX1BBR0VfQU5EX0FSVElDTEVfRFJBRlRfUkVHRVg9InslaG9zdCV9L3ZpZXcuYXNwP2lkPXslaWQlfSINCg0KJ+WmguaenOi/nuaOpeaVsOaNruW6k+S4uk1TU1FM77yM5YiZ5bqU5Li6J++8jOm7mOiupOi/nuaOpUFjY2Vzc+aVsOaNruW6k+WImeS4uiMNCkRpbSBaQ19TUUxfUE9VTkRfS0VZDQpaQ19TUUxfUE9VTkRfS0VZPSIjIg0KDQpEaW0gWkNfQ09NTUVOVF9WRVJJRllfRU5BQkxFX0lOVEVSTkFMDQpaQ19DT01NRU5UX1ZFUklGWV9FTkFCTEVfSU5URVJOQUw9VHJ1ZQ0KDQpEaW0gWkNfQkxPR19QUk9EVUNUDQpaQ19CTE9HX1BST0RVQ1Q9IlotQmxvZyINCg0KRGltIFpDX0JMT0dfUFJPRFVDVF9GVUxMDQpaQ19CTE9HX1BST0RVQ1RfRlVMTD0iIg0KDQpEaW0gWkNfQkxPR19QUk9EVUNUX0ZVTExIVE1MDQpaQ19CTE9HX1BST0RVQ1RfRlVMTEhUTUw9IiINCg0KRGltIEJsb2dWZXJzaW9ucw0KU2V0IEJsb2dWZXJzaW9ucyA9IE5ldyBUTWV0YQ0KQmxvZ1ZlcnNpb25zLlNldFZhbHVlICIxMzEyMjEiLCJaLUJsb2cgMi4yIFByaXNtIEJ1aWxkIDEzMTIyMSINCkJsb2dWZXJzaW9ucy5TZXRWYWx1ZSAiMTMwODAxIiwiWi1CbG9nIDIuMiBQcmlzbSBCdWlsZCAxMzA4MDEiDQpCbG9nVmVyc2lvbnMuU2V0VmFsdWUgIjEzMDcyMiIsIlotQmxvZyAyLjIgUHJpc20gQnVpbGQgMTMwNzIyIg0KQmxvZ1ZlcnNpb25zLlNldFZhbHVlICIxMzAxMjgiLCJaLUJsb2cgMi4xIFBob2VuaXggQnVpbGQgMTMwMTI4Ig0KQmxvZ1ZlcnNpb25zLlNldFZhbHVlICIxMjEyMjEiLCJaLUJsb2cgMi4wIERvb21zZGF5IEJ1aWxkIDEyMTIyMSINCkJsb2dWZXJzaW9ucy5TZXRWYWx1ZSAiMTIxMDI4IiwiWi1CbG9nIDIuMCBCZXRhMiBCdWlsZCAxMjEwMjgiDQpCbG9nVmVyc2lvbnMuU2V0VmFsdWUgIjEyMTAwMSIsIlotQmxvZyAyLjAgQmV0YSBCdWlsZCAxMjEwMDEiDQoNClJlc3BvbnNlLkFkZEhlYWRlciAiUHJvZHVjdCIsIlotQmxvZyAiICYgWkNfQkxPR19WRVJTSU9ODQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIFN5c3RlbSDliJ3lp4vljJYNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNClN1YiBTeXN0ZW1fSW5pdGlhbGl6ZSgpDQoNCgknQ2FsbCBBY3RpdmVQbHVnaW4oKQ0KDQoJSWYgT3BlbkNvbm5lY3QoKT1GYWxzZSBUaGVuDQoJCUNhbGwgU2hvd0Vycm9yKDQpDQoJRW5kIElmDQoNCglDYWxsIEdldENvbmZpZ3MoKQ0KCUJsb2dDb25maWcuTG9hZCgiQmxvZyIpDQoNCglCbG9nVXNlci5WZXJpZnkoKQ0KDQoJQ2FsbCBHZXRDYXRlZ29yeSgpDQoJJ0NhbGwgR2V0VXNlcigpDQoJJ0NhbGwgR2V0VGFncygpDQoJJ0NhbGwgR2V0S2V5V29yZHMoKQ0KCSdDYWxsIEdldEZ1bmN0aW9uKCkNCg0KCVpDX0JMT0dfVkVSU0lPTj1CbG9nQ29uZmlnLlJlYWQoIlpDX0JMT0dfVkVSU0lPTiIpDQoNCglaQ19CTE9HX1BST0RVQ1RfRlVMTD1aQ19CTE9HX1BST0RVQ1QgJiAiICIgJiBaQ19CTE9HX1ZFUlNJT04NCgkNCglaQ19CTE9HX1BST0RVQ1RfRlVMTEhUTUw9IjxhIGhyZWY9IiJodHRwOi8vd3d3LnJhaW5ib3dzb2Z0Lm9yZy8iIiB0aXRsZT0iIlJhaW5ib3dTb2Z0IFotQmxvZyIiPiIgJiBaQ19CTE9HX1BST0RVQ1RfRlVMTCAmICI8L2E+Ig0KDQoJVGVtcGxhdGVUYWdzRGljLkl0ZW0oIlpDX0JMT0dfSE9TVCIpPUJsb2dIb3N0DQoNCglDYWxsIExvYWRHbG9iZUNhY2hlKCkNCglDYWxsIENyZWF0ZUFkbWluTGVmdE1lbnUoKQ0KCUNhbGwgQ3JlYXRlQWRtaW5Ub3BNZW51KCkNCglDYWxsIEFjdGl2ZVBsdWdpbigpDQoJJ3BsdWdpbiBub2RlDQoJYkFjdGlvbl9QbHVnaW5fU3lzdGVtX0luaXRpYWxpemU9RmFsc2UNCglGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9TeXN0ZW1fSW5pdGlhbGl6ZSBpbiBBY3Rpb25fUGx1Z2luX1N5c3RlbV9Jbml0aWFsaXplDQoJCUlmIE5vdCBJc0VtcHR5KHNBY3Rpb25fUGx1Z2luX1N5c3RlbV9Jbml0aWFsaXplKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9TeXN0ZW1fSW5pdGlhbGl6ZSkNCgkJSWYgYkFjdGlvbl9QbHVnaW5fU3lzdGVtX0luaXRpYWxpemU9VHJ1ZSBUaGVuIEV4aXQgU3ViDQoJTmV4dA0KCQ0KCUlmIFpDX1BPU1RfU1RBVElDX01PREU8PiJTVEFUSUMiIFRoZW4NCgkJRGltIGJvbFJlYnVpbGRGaWxlcw0KCQlBcHBsaWNhdGlvbi5Mb2NrDQoJCWJvbFJlYnVpbGRGaWxlcz1BcHBsaWNhdGlvbihaQ19CTE9HX0NMU0lEICYgIlNJR05BTF9SRUJVSUxERklMRVMiKQ0KCQlBcHBsaWNhdGlvbi5VbkxvY2sNCgkJSWYgSXNFbXB0eShib2xSZWJ1aWxkRmlsZXMpPUZhbHNlIFRoZW4NCgkJCUlmIGJvbFJlYnVpbGRGaWxlcz1UcnVlIFRoZW4NCgkJCQlDYWxsIFNldEJsb2dIaW50KFRydWUsVHJ1ZSxGYWxzZSkNCgkJCUVuZCBJZg0KCQlFbmQgSWYNCglFbmQgSWYNCg0KCQ0KCQ0KCURpbSBib2xSZWJ1aWxkSW5kZXgNCglBcHBsaWNhdGlvbi5Mb2NrDQoJYm9sUmVidWlsZEluZGV4PUFwcGxpY2F0aW9uKFpDX0JMT0dfQ0xTSUQgJiAiU0lHTkFMX1JFQlVJTERJTkRFWCIpDQoJQXBwbGljYXRpb24uVW5Mb2NrDQoJSWYgSXNFbXB0eShib2xSZWJ1aWxkSW5kZXgpPUZhbHNlIFRoZW4NCgkJSWYgYm9sUmVidWlsZEluZGV4PVRydWUgVGhlbg0KCQkJQ2FsbCBNYWtlQmxvZ1JlQnVpbGRfQ29yZSgpDQoJCUVuZCBJZg0KCUVuZCBJZg0KDQoNCgkn5bCG5r+A5rS75o+S5Lu25ZCO56e7DQoJSWYgc0ZpbHRlcl9QbHVnaW5fVmFsaWRDb2RlX0NoZWNrPSIiIFRoZW4gQ2FsbCBBZGRfRmlsdGVyX1BsdWdpbigiRmlsdGVyX1BsdWdpbl9WYWxpZENvZGVfQ2hlY2siLCJDaGVja1ZlcmlmeU51bWJlciIpDQoNCg0KCSdwbHVnaW4gbm9kZQ0KCWJBY3Rpb25fUGx1Z2luX1N5c3RlbV9Jbml0aWFsaXplX1N1Y2NlZWQ9RmFsc2UNCglGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9TeXN0ZW1fSW5pdGlhbGl6ZV9TdWNjZWVkIGluIEFjdGlvbl9QbHVnaW5fU3lzdGVtX0luaXRpYWxpemVfU3VjY2VlZA0KCQlJZiBOb3QgSXNFbXB0eShzQWN0aW9uX1BsdWdpbl9TeXN0ZW1fSW5pdGlhbGl6ZV9TdWNjZWVkKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9TeXN0ZW1fSW5pdGlhbGl6ZV9TdWNjZWVkKQ0KCQlJZiBiQWN0aW9uX1BsdWdpbl9TeXN0ZW1fSW5pdGlhbGl6ZV9TdWNjZWVkPVRydWUgVGhlbiBFeGl0IFN1Yg0KCU5leHQNCg0KCSdJZiBFcnIuTnVtYmVyPD4wIFRoZW4gQ2FsbCBTaG93RXJyb3IoMTApDQoNCkVuZCBTdWINCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgU3lzdGVtIOmHiuaUvg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KU3ViIFN5c3RlbV9UZXJtaW5hdGUoKQ0KDQoJJ3BsdWdpbiBub2RlDQoJYkFjdGlvbl9QbHVnaW5fU3lzdGVtX1Rlcm1pbmF0ZT1GYWxzZQ0KCUZvciBFYWNoIHNBY3Rpb25fUGx1Z2luX1N5c3RlbV9UZXJtaW5hdGUgaW4gQWN0aW9uX1BsdWdpbl9TeXN0ZW1fVGVybWluYXRlDQoJCUlmIE5vdCBJc0VtcHR5KHNBY3Rpb25fUGx1Z2luX1N5c3RlbV9UZXJtaW5hdGUpIFRoZW4gQ2FsbCBFeGVjdXRlKHNBY3Rpb25fUGx1Z2luX1N5c3RlbV9UZXJtaW5hdGUpDQoJCUlmIGJBY3Rpb25fUGx1Z2luX1N5c3RlbV9UZXJtaW5hdGU9VHJ1ZSBUaGVuIEV4aXQgU3ViDQoJTmV4dA0KDQoJU2V0IFB1YmxpY09iakFkbz1Ob3RoaW5nDQoJU2V0IFB1YmxpY09iakZTTz1Ob3RoaW5nDQoJQ2FsbCBDbG9zZUNvbm5lY3QoKQ0KDQpFbmQgU3ViDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIOaVsOaNruW6k+i/nuaOpQ0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRGltIElzREJDb25uZWN0ICfmlbDmja7lupPmmK/lkKblt7Lov57mjqUNCklzREJDb25uZWN0PUZhbHNlDQpGdW5jdGlvbiBPcGVuQ29ubmVjdCgpDQoNCglPbiBFcnJvciBSZXN1bWUgTmV4dA0KDQoJSWYgSXNEQkNvbm5lY3Q9VHJ1ZSBUaGVuDQoJCU9wZW5Db25uZWN0PVRydWUNCgkJRXhpdCBGdW5jdGlvbg0KCUVuZCBJZg0KDQoJJ3BsdWdpbiBub2RlDQoJYkFjdGlvbl9QbHVnaW5fT3BlbkNvbm5lY3Q9RmFsc2UNCglGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9PcGVuQ29ubmVjdCBpbiBBY3Rpb25fUGx1Z2luX09wZW5Db25uZWN0DQoJCUlmIE5vdCBJc0VtcHR5KHNBY3Rpb25fUGx1Z2luX09wZW5Db25uZWN0KSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9PcGVuQ29ubmVjdCkNCgkJSWYgYkFjdGlvbl9QbHVnaW5fT3BlbkNvbm5lY3Q9VHJ1ZSBUaGVuIEV4aXQgRnVuY3Rpb24NCglOZXh0DQoNCgkn5Yik5a6a5piv5ZCm5Li65a2Q55uu5b2V6LCD55SoDQoJRGltIHN0ckRiUGF0aA0KDQoJc3RyRGJQYXRoPUJsb2dQYXRoICYgWkNfREFUQUJBU0VfUEFUSA0KDQoJU2V0IG9iakNvbm4gPSBTZXJ2ZXIuQ3JlYXRlT2JqZWN0KCJBRE9EQi5Db25uZWN0aW9uIikNCglJZiBaQ19NU1NRTF9FTkFCTEU9VHJ1ZSBUaGVuDQoJCW9iakNvbm4uT3BlbiAiUHJvdmlkZXI9U3FsT0xFREI7RGF0YSBTb3VyY2U9IiZaQ19NU1NRTF9TRVJWRVImIjtJbml0aWFsIENhdGFsb2c9IiZaQ19NU1NRTF9EQVRBQkFTRSYiO1BlcnNpc3QgU2VjdXJpdHkgSW5mbz1UcnVlO1VzZXIgSUQ9IiZaQ19NU1NRTF9VU0VSTkFNRSYiO1Bhc3N3b3JkPSImWkNfTVNTUUxfUEFTU1dPUkQmIjsiDQoJCVpDX1NRTF9QT1VORF9LRVk9IiciDQoJRWxzZQ0KCQlvYmpDb25uLk9wZW4gIlByb3ZpZGVyPU1pY3Jvc29mdC5KZXQuT0xFREIuNC4wO0RhdGEgU291cmNlPSIgJiBzdHJEYlBhdGgNCglFbmQgSWYNCg0KCUlmIEVyci5OdW1iZXI9MCBUaGVuDQoNCgkJSXNEQkNvbm5lY3Q9VHJ1ZQ0KCQlPcGVuQ29ubmVjdD1UcnVlDQoNCglFbHNlDQoNCgkJRXJyLkNsZWFyDQoJCUVyci5SYWlzZSAxDQoNCglFbmQgSWYNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIERCIERpc2FibGUgQ29ubmVjdA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gQ2xvc2VDb25uZWN0KCkNCg0KCUlmIElzREJDb25uZWN0PUZhbHNlIFRoZW4NCgkJRXhpdCBGdW5jdGlvbg0KCUVuZCBJZg0KDQoJb2JqQ29ubi5DbG9zZQ0KCVNldCBvYmpDb25uPU5vdGhpbmcNCg0KCUlzREJDb25uZWN0PUZhbHNlDQoNCglDbG9zZUNvbm5lY3Q9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAg5pe26Ze06K6h6ZW/DQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBSdW5UaW1lKCkNCg0KCUVuZFRpbWU9VGltZXIoKQ0KCVJ1blRpbWUgPSBDTG5nKEZvcm1hdE51bWJlcigoRW5kVGltZS1TdGFyVGltZSkqMTAwMCwzKSkNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIOWIhuexu+ivu+WPlg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJ0lzUnVuR2V0Q2F0ZWdvcnnpu5jorqTkuLpmYWxzZSzlpoLmnpzov5DooYzov4fkuIDmrKFHZXRDYXRlZ29yeeWImeS4ulRydWUs5LmL5ZCO5YaNR2V0Q2F0ZWdvcnnliJnkuI3miafooYwNCkRpbSBJc1J1bkdldENhdGVnb3J5DQpJc1J1bkdldENhdGVnb3J5PUZhbHNlDQpGdW5jdGlvbiBHZXRDYXRlZ29yeSgpDQoNCglJZiBJc1J1bkdldENhdGVnb3J5PVRydWUgVGhlbiBFeGl0IEZ1bmN0aW9uDQoNCglEaW0gaSxqLGssbA0KDQoJRGltIGFyeUFsbERhdGENCglEaW0gYXJ5U2luZ2xlRGF0YSgpDQoNCglFcmFzZSBDYXRlZ29yeXMNCglSZURpbSBDYXRlZ29yeXMoMCkNCg0KCURpbSBvYmpSUw0KDQoJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFRPUCAxIFtjYXRlX0lEXSBGUk9NIFtibG9nX0NhdGVnb3J5XSBPUkRFUiBCWSBbY2F0ZV9JRF0gREVTQyIpDQoJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KCQlpPW9ialJTKCJjYXRlX0lEIikNCgkJUmVEaW0gQ2F0ZWdvcnlzKGkpDQoJRW5kIElmDQoJb2JqUlMuQ2xvc2UNCglTZXQgb2JqUlM9Tm90aGluZw0KDQoJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFtjYXRlX0lEXSxbY2F0ZV9OYW1lXSxbY2F0ZV9JbnRyb10sW2NhdGVfT3JkZXJdLFtjYXRlX0NvdW50XSxbY2F0ZV9QYXJlbnRJRF0sW2NhdGVfVVJMXSxbY2F0ZV9UZW1wbGF0ZV0sW2NhdGVfTG9nVGVtcGxhdGVdLFtjYXRlX0Z1bGxVcmxdLFtjYXRlX01ldGFdIEZST00gW2Jsb2dfQ2F0ZWdvcnldIE9SREVSIEJZIFtjYXRlX0lEXSBBU0MiKQ0KCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCg0KCQlhcnlBbGxEYXRhPW9ialJTLkdldFJvd3Mob2JqUlMuUmVjb3JkQ291bnQpDQoJCW9ialJTLkNsb3NlDQoJCVNldCBvYmpSUz1Ob3RoaW5nDQoNCgkJaz1VQm91bmQoYXJ5QWxsRGF0YSwxKQ0KCQlsPVVCb3VuZChhcnlBbGxEYXRhLDIpDQoJCUZvciBpPTAgVG8gbA0KCQkJU2V0IENhdGVnb3J5cyhhcnlBbGxEYXRhKDAsaSkpPU5ldyBUQ2F0ZWdvcnkNCgkJCUNhdGVnb3J5cyhhcnlBbGxEYXRhKDAsaSkpLkxvYWRJbmZvQnlBcnJheShBcnJheShhcnlBbGxEYXRhKDAsaSksYXJ5QWxsRGF0YSgxLGkpLGFyeUFsbERhdGEoMixpKSxhcnlBbGxEYXRhKDMsaSksYXJ5QWxsRGF0YSg0LGkpLGFyeUFsbERhdGEoNSxpKSxhcnlBbGxEYXRhKDYsaSksYXJ5QWxsRGF0YSg3LGkpLGFyeUFsbERhdGEoOCxpKSxhcnlBbGxEYXRhKDksaSksYXJ5QWxsRGF0YSgxMCxpKSkpDQoJCU5leHQNCglFbmQgSWYNCg0KCVNldCBDYXRlZ29yeXMoMCk9TmV3IFRDYXRlZ29yeQ0KCUNhbGwgQ2F0ZWdvcnlzKDApLkxvYWRJbmZvQnlJRCgwKQ0KDQoJSXNSdW5HZXRDYXRlZ29yeT1UcnVlDQoNCglHZXRDYXRlZ29yeT1UcnVlDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICDnlKjmiLfor7vlj5YNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkRpbSBJc1J1bkdldFVzZXINCklzUnVuR2V0VXNlcj1GYWxzZQ0KRnVuY3Rpb24gR2V0VXNlcigpDQoNCglJZiBJc1J1bkdldFVzZXI9VHJ1ZSBUaGVuIEV4aXQgRnVuY3Rpb24NCg0KCURpbSBpLGosayxsDQoNCglEaW0gYXJ5QWxsRGF0YQ0KCURpbSBhcnlTaW5nbGVEYXRhKCkNCg0KCUVyYXNlIFVzZXJzDQoJUmVEaW0gVXNlcnMoMCkNCg0KCURpbSBvYmpSUw0KDQoJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFRPUCAxIFttZW1fSURdIEZST00gW2Jsb2dfTWVtYmVyXSBPUkRFUiBCWSBbbWVtX0lEXSBERVNDIikNCglJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoJCWk9b2JqUlMoIm1lbV9JRCIpDQoJCVJlRGltIFVzZXJzKGkpDQoJRW5kIElmDQoJb2JqUlMuQ2xvc2UNCglTZXQgb2JqUlM9Tm90aGluZw0KDQoNCglTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgW21lbV9JRF0sW21lbV9OYW1lXSxbbWVtX0xldmVsXSxbbWVtX1Bhc3N3b3JkXSxbbWVtX0VtYWlsXSxbbWVtX0hvbWVQYWdlXSxbbWVtX1Bvc3RMb2dzXSxbbWVtX1VybF0sW21lbV9UZW1wbGF0ZV0sW21lbV9GdWxsVXJsXSxbbWVtX0ludHJvXSxbbWVtX01ldGFdIEZST00gW2Jsb2dfTWVtYmVyXSBPUkRFUiBCWSBbbWVtX0lEXSBBU0MiKQ0KCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCg0KCQlhcnlBbGxEYXRhPW9ialJTLkdldFJvd3Mob2JqUlMuUmVjb3JkQ291bnQpDQoJCW9ialJTLkNsb3NlDQoJCVNldCBvYmpSUz1Ob3RoaW5nDQoNCgkJaz1VQm91bmQoYXJ5QWxsRGF0YSwxKQ0KCQlsPVVCb3VuZChhcnlBbGxEYXRhLDIpDQoJCUZvciBpPTAgVG8gbA0KCQkJU2V0IFVzZXJzKGFyeUFsbERhdGEoMCxpKSk9TmV3IFRVc2VyDQoJCQlVc2VycyhhcnlBbGxEYXRhKDAsaSkpLkxvYWRJbmZvQnlBcnJheShBcnJheShhcnlBbGxEYXRhKDAsaSksYXJ5QWxsRGF0YSgxLGkpLGFyeUFsbERhdGEoMixpKSxhcnlBbGxEYXRhKDMsaSksYXJ5QWxsRGF0YSg0LGkpLGFyeUFsbERhdGEoNSxpKSxhcnlBbGxEYXRhKDYsaSksYXJ5QWxsRGF0YSg3LGkpLGFyeUFsbERhdGEoOCxpKSxhcnlBbGxEYXRhKDksaSksYXJ5QWxsRGF0YSgxMCxpKSxhcnlBbGxEYXRhKDExLGkpKSkNCgkJTmV4dA0KDQoJRW5kIElmDQoNCglTZXQgVXNlcnMoMCk9TmV3IFRVc2VyDQoNCglJc1J1bkdldFVzZXI9VHJ1ZQ0KDQoJR2V0dXNlcj1UcnVlDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBUYWdz6K+75Y+WDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpEaW0gSXNSdW5HZXRUYWdzDQpJc1J1bkdldFRhZ3M9RmFsc2UNCkZ1bmN0aW9uIEdldFRhZ3MoKQ0KDQoJSWYgSXNSdW5HZXRUYWdzPVRydWUgVGhlbiBFeGl0IEZ1bmN0aW9uDQoNCglEaW0gaSxqLGssbA0KDQoJRGltIGFyeUFsbERhdGENCglEaW0gYXJ5U2luZ2xlRGF0YSgpDQoNCglFcmFzZSBUYWdzDQoJUmVEaW0gVGFncygwKQ0KDQoJRGltIG9ialJTDQoNCglTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgVE9QIDEgW3RhZ19JRF0gRlJPTSBbYmxvZ19UYWddIE9SREVSIEJZIFt0YWdfSURdIERFU0MiKQ0KCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCgkJaT1vYmpSUygidGFnX0lEIikNCgkJUmVEaW0gVGFncyhpKQ0KCUVuZCBJZg0KDQoJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFt0YWdfSURdLFt0YWdfTmFtZV0sW3RhZ19JbnRyb10sW3RhZ19PcmRlcl0sW3RhZ19Db3VudF0sW3RhZ19QYXJlbnRJRF0sW3RhZ19VUkxdLFt0YWdfVGVtcGxhdGVdLFt0YWdfRnVsbFVybF0sW3RhZ19NZXRhXSBGUk9NIFtibG9nX1RhZ10gT1JERVIgQlkgW3RhZ19JRF0gQVNDIikNCglJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoNCgkJYXJ5QWxsRGF0YT1vYmpSUy5HZXRSb3dzKG9ialJTLlJlY29yZENvdW50KQ0KCQlvYmpSUy5DbG9zZQ0KCQlTZXQgb2JqUlM9Tm90aGluZw0KDQoJCWs9VUJvdW5kKGFyeUFsbERhdGEsMSkNCgkJbD1VQm91bmQoYXJ5QWxsRGF0YSwyKQ0KCQlGb3IgaT0wIFRvIGwNCgkJCVNldCBUYWdzKGFyeUFsbERhdGEoMCxpKSk9TmV3IFRUYWcNCgkJCVRhZ3MoYXJ5QWxsRGF0YSgwLGkpKS5Mb2FkSW5mb0J5QXJyYXkoQXJyYXkoYXJ5QWxsRGF0YSgwLGkpLGFyeUFsbERhdGEoMSxpKSxhcnlBbGxEYXRhKDIsaSksYXJ5QWxsRGF0YSgzLGkpLGFyeUFsbERhdGEoNCxpKSxhcnlBbGxEYXRhKDUsaSksYXJ5QWxsRGF0YSg2LGkpLGFyeUFsbERhdGEoNyxpKSxhcnlBbGxEYXRhKDgsaSksYXJ5QWxsRGF0YSg5LGkpKSkNCgkJTmV4dA0KDQoJRW5kIElmDQoNCglTZXQgVGFncygwKT1OZXcgVFRhZw0KDQoJSXNSdW5HZXRUYWdzPVRydWUNCg0KCUdldFRhZ3M9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIENvbmZpZ3Por7vlj5YNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkRpbSBJc1J1bkNvbmZpZ3MNCklzUnVuQ29uZmlncz1GYWxzZQ0KRnVuY3Rpb24gR2V0Q29uZmlncygpDQoNCglJZiBJc1J1bkNvbmZpZ3M9VHJ1ZSBUaGVuIEV4aXQgRnVuY3Rpb24NCg0KCURpbSBvYmpSUw0KCVNldCBvYmpSUz1vYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBbY29uZl9OYW1lXSxbY29uZl9WYWx1ZV0gRlJPTSBbYmxvZ19Db25maWddIikNCglJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoNCgkJRG8gV2hpbGUgTm90IG9ialJTLmVvZg0KCQkJQ2FsbCBDb25maWdNZXRhcy5TZXRWYWx1ZShvYmpSUygwKSxvYmpSUygxKSkNCgkJCW9ialJTLk1vdmVOZXh0DQoJCUxvb3ANCg0KCUVuZCBJZg0KDQoJSXNSdW5Db25maWdzPVRydWUNCg0KCUdldENvbmZpZ3M9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgRnVuY3Rpb25z6K+75Y+WDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpEaW0gSXNSdW5GdW5jdGlvbnMNCklzUnVuRnVuY3Rpb25zPUZhbHNlDQpGdW5jdGlvbiBHZXRGdW5jdGlvbigpDQoNCglJZiBJc1J1bkZ1bmN0aW9ucz1UcnVlIFRoZW4gRXhpdCBGdW5jdGlvbg0KDQoJRGltIGksaixrLGwNCg0KCURpbSBhcnlBbGxEYXRhDQoJRGltIGFyeVNpbmdsZURhdGEoKQ0KDQoJRXJhc2UgRnVuY3Rpb25zDQoJUmVEaW0gRnVuY3Rpb25zKDApDQoNCglTZXQgRnVuY3Rpb25NZXRhcz1OZXcgVE1ldGENCg0KCURpbSBvYmpSUw0KDQoJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFRPUCAxIFtmbl9JRF0gRlJPTSBbYmxvZ19GdW5jdGlvbl0gT1JERVIgQlkgW2ZuX0lEXSBERVNDIikNCglJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoJCWk9b2JqUlMoImZuX0lEIikNCgkJUmVEaW0gRnVuY3Rpb25zKGkpDQoJRW5kIElmDQoNCglTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgW2ZuX0lEXSxbZm5fTmFtZV0sW2ZuX0ZpbGVOYW1lXSxbZm5fT3JkZXJdLFtmbl9Db250ZW50XSxbZm5fSXNIaWRkZW5dLFtmbl9TaWRlYmFySURdLFtmbl9IdG1sSURdLFtmbl9GdHlwZV0sW2ZuX01heExpXSxbZm5fU291cmNlXSxbZm5fVmlld1R5cGVdLFtmbl9Jc0hpZGVUaXRsZV0sW2ZuX01ldGFdIEZST00gW2Jsb2dfRnVuY3Rpb25dIE9SREVSIEJZIFtmbl9JRF0gQVNDIikNCglJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoNCg0KCQlhcnlBbGxEYXRhPW9ialJTLkdldFJvd3Mob2JqUlMuUmVjb3JkQ291bnQpDQoJCW9ialJTLkNsb3NlDQoJCVNldCBvYmpSUz1Ob3RoaW5nDQoNCgkJaz1VQm91bmQoYXJ5QWxsRGF0YSwxKQ0KCQlsPVVCb3VuZChhcnlBbGxEYXRhLDIpDQoJCUZvciBpPTAgVG8gbA0KCQkJU2V0IEZ1bmN0aW9ucyhhcnlBbGxEYXRhKDAsaSkpPU5ldyBURnVuY3Rpb24NCgkJCUZ1bmN0aW9ucyhhcnlBbGxEYXRhKDAsaSkpLkxvYWRJbmZvQnlBcnJheShBcnJheShhcnlBbGxEYXRhKDAsaSksYXJ5QWxsRGF0YSgxLGkpLGFyeUFsbERhdGEoMixpKSxhcnlBbGxEYXRhKDMsaSksYXJ5QWxsRGF0YSg0LGkpLGFyeUFsbERhdGEoNSxpKSxhcnlBbGxEYXRhKDYsaSksYXJ5QWxsRGF0YSg3LGkpLGFyeUFsbERhdGEoOCxpKSxhcnlBbGxEYXRhKDksaSksYXJ5QWxsRGF0YSgxMCxpKSxhcnlBbGxEYXRhKDExLGkpLGFyeUFsbERhdGEoMTIsaSksYXJ5QWxsRGF0YSgxMyxpKSkpDQoJCQlDYWxsIEZ1bmN0aW9uTWV0YXMuU2V0VmFsdWUoYXJ5QWxsRGF0YSgyLGkpLGFyeUFsbERhdGEoMCxpKSkNCgkJTmV4dA0KDQoJRW5kIElmDQoNCg0KCURpbSBhcnlGaWxlTGlzdA0KDQoJYXJ5RmlsZUxpc3Q9TG9hZEluY2x1ZGVGaWxlc09ubHlUeXBlKCJ6Yl91c2Vyc1xJTkNMVURFXCIpDQoNCglJZiBJc0FycmF5KGFyeUZpbGVMaXN0KSBUaGVuDQoJCWo9VUJvdW5kKGFyeUZpbGVMaXN0KQ0KDQoJCUlmIGo+MCBUaGVuDQoJCQlGb3IgaT0xIHRvIGoNCgkJCQlJZiBSaWdodChhcnlGaWxlTGlzdChpKSw0KT0iLmFzcCIgVGhlbg0KCQkJCWw9UmVwbGFjZShhcnlGaWxlTGlzdChpKSwiLmFzcCIsIiIpDQoJCQkJSWYgRnVuY3Rpb25NZXRhcy5FeGlzdHMobCkgPUZhbHNlIFRoZW4NCg0KCQkJCQlrPVVCb3VuZChGdW5jdGlvbnMpKzENCg0KCQkJCQlSZURpbSBQcmVzZXJ2ZSBGdW5jdGlvbnMoaykNCg0KCQkJCQlTZXQgRnVuY3Rpb25zKGspPU5ldyBURnVuY3Rpb24NCg0KCQkJCQlGdW5jdGlvbnMoaykuSUQ9aw0KCQkJCQlGdW5jdGlvbnMoaykuRmlsZU5hbWU9bA0KCQkJCQlGdW5jdGlvbnMoaykuTmFtZT1sDQoJCQkJCUZ1bmN0aW9ucyhrKS5Tb3VyY2U9Im90aGVyIg0KCQkJCQlGdW5jdGlvbnMoaykuSHRtbElEPSJmbiIgJiBsDQoJCQkJCUZ1bmN0aW9ucyhrKS5Db250ZW50PUxvYWRGcm9tRmlsZShCbG9nUGF0aCAmInpiX3VzZXJzXElOQ0xVREVcIiZhcnlGaWxlTGlzdChpKSwidXRmLTgiKQ0KCQkJCQlJZiBJbnN0cihGdW5jdGlvbnMoaykuQ29udGVudCwiPC9saT4iKT4wIFRoZW4NCgkJCQkJCUZ1bmN0aW9ucyhrKS5GVHlwZT0idWwiDQoJCQkJCUVsc2UNCgkJCQkJCUZ1bmN0aW9ucyhrKS5GVHlwZT0iZGl2Ig0KCQkJCQlFbmQgSWYNCgkJCQkJQ2FsbCBGdW5jdGlvbk1ldGFzLlNldFZhbHVlKGwsaykNCgkJCQlFbmQgSWYNCgkJCQlFbmQgSWYNCgkJCU5leHQNCgkJRW5kIElmDQoJRW5kIElmDQoNCglTZXQgRnVuY3Rpb25zKDApPU5ldyBURnVuY3Rpb24NCg0KCUlzUnVuRnVuY3Rpb25zPVRydWUNCg0KCUdldEZ1bmN0aW9uPVRydWUNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIOivu+WPluadg+mZkA0KJyDlpIfms6g6ICAgICDmnYPpmZDmnIDpq5jkuLoxIOacgOS9juS4ujUg5LiN5piv5YiZ6Z2e5rOVDQonICAgICAgICAgICAiUm9vdCLkuIDlrprlj6rog73kuLoxDQonICAgICAgICAgICDmnYPpmZDphY3nva7mlrnlvI/lj6/ku6Xlj5jpgJoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEdldFJpZ2h0cyhzdHJBY3Rpb24pDQoNCgkncGx1Z2luIG5vZGUNCgliQWN0aW9uX1BsdWdpbl9HZXRSaWdodHNfQmVnaW49RmFsc2UNCglGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9HZXRSaWdodHNfQmVnaW4gaW4gQWN0aW9uX1BsdWdpbl9HZXRSaWdodHNfQmVnaW4NCgkJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fR2V0UmlnaHRzX0JlZ2luKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9HZXRSaWdodHNfQmVnaW4pDQoJCUlmIGJBY3Rpb25fUGx1Z2luX0dldFJpZ2h0c19CZWdpbj1UcnVlIFRoZW4gRXhpdCBGdW5jdGlvbg0KCU5leHQNCg0KCVNlbGVjdCBDYXNlIHN0ckFjdGlvbg0KDQoJCUNhc2UgIlJvb3QiDQoJCQlHZXRSaWdodHM9MQ0KCQlDYXNlICJsb2dpbiINCgkJCUdldFJpZ2h0cz01DQoJCUNhc2UgInZlcmlmeSINCgkJCUdldFJpZ2h0cz01DQoJCUNhc2UgImxvZ291dCINCgkJCUdldFJpZ2h0cz01DQoJCUNhc2UgImFkbWluIg0KCQkJR2V0UmlnaHRzPTQNCgkJQ2FzZSAiY210Ig0KCQkJR2V0UmlnaHRzPTUNCgkJJ0Nhc2UgInRiIg0KCQknCUdldFJpZ2h0cz01DQoJCUNhc2UgInZycyINCgkJCUdldFJpZ2h0cz01DQoJCUNhc2UgInJzcyINCgkJCUdldFJpZ2h0cz01DQoJCUNhc2UgImJhdGNoIg0KCQkJR2V0UmlnaHRzPTQNCgkJJ0Nhc2UgImdldHRidXJsIg0KCQknCUdldFJpZ2h0cz01DQoJCUNhc2UgIkFydGljbGVBbGwiDQoJCQlHZXRSaWdodHM9Mg0KCQlDYXNlICJBcnRpY2xlTW5nIg0KCQkJR2V0UmlnaHRzPTMNCgkJQ2FzZSAiQXJ0aWNsZUVkdCINCgkJCUdldFJpZ2h0cz0zDQoJCUNhc2UgIkFydGljbGVQc3QiDQoJCQlHZXRSaWdodHM9Mw0KCQlDYXNlICJBcnRpY2xlRGVsIg0KCQkJR2V0UmlnaHRzPTMNCgkJQ2FzZSAiQXJ0aWNsZUJ1ZCINCgkJCUdldFJpZ2h0cz0zDQoJCUNhc2UgIkNhdGVnb3J5TW5nIg0KCQkJR2V0UmlnaHRzPTINCgkJQ2FzZSAiQ2F0ZWdvcnlFZHQiDQoJCQlHZXRSaWdodHM9Mg0KCQlDYXNlICJDYXRlZ29yeVBzdCINCgkJCUdldFJpZ2h0cz0yDQoJCUNhc2UgIkNhdGVnb3J5RGVsIg0KCQkJR2V0UmlnaHRzPTINCgkJQ2FzZSAiVGFnTW5nIg0KCQkJR2V0UmlnaHRzPTENCgkJQ2FzZSAiVGFnRWR0Ig0KCQkJR2V0UmlnaHRzPTENCgkJQ2FzZSAiVGFnUHN0Ig0KCQkJR2V0UmlnaHRzPTENCgkJQ2FzZSAiVGFnRGVsIg0KCQkJR2V0UmlnaHRzPTENCgkJJ0Nhc2UgIktleVdvcmRNbmciDQoJCScJR2V0UmlnaHRzPTENCgkJJ0Nhc2UgIktleVdvcmRFZHQiDQoJCScJR2V0UmlnaHRzPTENCgkJJ0Nhc2UgIktleVdvcmRQc3QiDQoJCScJR2V0UmlnaHRzPTENCgkJJ0Nhc2UgIktleVdvcmREZWwiDQoJCScJR2V0UmlnaHRzPTENCgkJJ0Nhc2UgIkd1ZXN0Qm9va01uZyINCgkJJwlHZXRSaWdodHM9Mg0KCQlDYXNlICJDb21tZW50QWxsIg0KCQkJR2V0UmlnaHRzPTINCgkJQ2FzZSAiQ29tbWVudE1uZyINCgkJCUdldFJpZ2h0cz00DQoJCUNhc2UgIkNvbW1lbnREZWwiDQoJCQlHZXRSaWdodHM9NA0KCQlDYXNlICJDb21tZW50RWR0Ig0KCQkJR2V0UmlnaHRzPTQNCgkJQ2FzZSAiQ29tbWVudFNhdiINCgkJCUdldFJpZ2h0cz00DQoJCUNhc2UgIkNvbW1lbnRHZXQiDQoJCQlHZXRSaWdodHM9NQ0KCQlDYXNlICJDb21tZW50QXVkaXQiDQoJCQlHZXRSaWdodHM9MQ0KCQlDYXNlICJDb21tZW50RGVsQmF0Y2giDQoJCQlHZXRSaWdodHM9NA0KCQknQ2FzZSAiVHJhY2tCYWNrTW5nIg0KCQknCUdldFJpZ2h0cz0zDQoJCSdDYXNlICJUcmFja0JhY2tEZWwiDQoJCScJR2V0UmlnaHRzPTMNCgkJJ0Nhc2UgIlRyYWNrQmFja0RlbEJhdGNoIg0KCQknCUdldFJpZ2h0cz0zDQoJCSdDYXNlICJUcmFja0JhY2tTbmQiDQoJCScJR2V0UmlnaHRzPTANCgkJQ2FzZSAiVXNlck1uZyINCgkJCUdldFJpZ2h0cz00DQoJCUNhc2UgIlVzZXJFZHQiDQoJCQlHZXRSaWdodHM9NA0KCQlDYXNlICJVc2VyTW9kIg0KCQkJR2V0UmlnaHRzPTQNCgkJQ2FzZSAiVXNlckRlbCINCgkJCUdldFJpZ2h0cz0xDQoJCUNhc2UgIlVzZXJDcnQiDQoJCQlHZXRSaWdodHM9MQ0KCQlDYXNlICJCbG9nUmVCdWlsZCINCgkJCUdldFJpZ2h0cz0zDQoJCUNhc2UgIkRpcmVjdG9yeVJlQnVpbGQiDQoJCQlHZXRSaWdodHM9Mw0KCQlDYXNlICJGaWxlUmVCdWlsZCINCgkJCUdldFJpZ2h0cz0xDQoJCUNhc2UgIkFza0ZpbGVSZUJ1aWxkIg0KCQkJR2V0UmlnaHRzPTENCgkJQ2FzZSAiRmlsZUFsbCINCgkJCUdldFJpZ2h0cz0yDQoJCUNhc2UgIkZpbGVNbmciDQoJCQlHZXRSaWdodHM9Mg0KCQlDYXNlICJGaWxlU25kIg0KCQkJR2V0UmlnaHRzPTINCgkJQ2FzZSAiRmlsZVVwbG9hZCINCgkJCUdldFJpZ2h0cz0yDQoJCUNhc2UgIkZpbGVEZWwiDQoJCQlHZXRSaWdodHM9Mg0KCQlDYXNlICJGaWxlRGVsQmF0Y2giDQoJCQlHZXRSaWdodHM9Mg0KCQlDYXNlICJTZWFyY2giDQoJCQlHZXRSaWdodHM9NQ0KCQknQ2FzZSAiQmxvZ01uZyINCgkJJwlHZXRSaWdodHM9NA0KCQlDYXNlICJTZXR0aW5nTW5nIg0KCQkJR2V0UmlnaHRzPTENCgkJQ2FzZSAiU2V0dGluZ1NhdiINCgkJCUdldFJpZ2h0cz0xDQoJCUNhc2UgIlBsdWdJbk1uZyINCgkJCUdldFJpZ2h0cz0yDQoJCUNhc2UgIlNpdGVJbmZvIg0KCQkJR2V0UmlnaHRzPTQNCgkJJ0Nhc2UgIlVwZGF0ZSINCgkJJwlHZXRSaWdodHM9MQ0KCQlDYXNlICJUaGVtZU1uZyINCgkJCUdldFJpZ2h0cz0xDQoJCUNhc2UgIlRoZW1lU2F2Ig0KCQkJR2V0UmlnaHRzPTENCgkJJ0Nhc2UgIkxpbmtNbmciDQoJCScJR2V0UmlnaHRzPTENCgkJJ0Nhc2UgIkxpbmtTYXYiDQoJCScJR2V0UmlnaHRzPTENCgkJQ2FzZSAiUGx1Z0luQWN0aXZlIg0KCQkJR2V0UmlnaHRzPTENCgkJQ2FzZSAiUGx1Z0luRGlzYWJsZSINCgkJCUdldFJpZ2h0cz0xDQoJCUNhc2UgIkZ1bmN0aW9uTW5nIg0KCQkJR2V0UmlnaHRzPTENCgkJQ2FzZSAiRnVuY3Rpb25FZHQiDQoJCQlHZXRSaWdodHM9MQ0KCQlDYXNlICJGdW5jdGlvblNhdiINCgkJCUdldFJpZ2h0cz0xDQoJCUNhc2UgIkZ1bmN0aW9uRGVsIg0KCQkJR2V0UmlnaHRzPTENCgkJQ2FzZSBFbHNlDQoJCQlHZXRSaWdodHM9TnVsbA0KCUVuZCBTZWxlY3QNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIOajgOafpeadg+mZkA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gQ2hlY2tSaWdodHMoc3RyQWN0aW9uKQ0KDQoJJ3BsdWdpbiBub2RlDQoJYkFjdGlvbl9QbHVnaW5fQ2hlY2tSaWdodHNfQmVnaW49RmFsc2UNCglGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9DaGVja1JpZ2h0c19CZWdpbiBpbiBBY3Rpb25fUGx1Z2luX0NoZWNrUmlnaHRzX0JlZ2luDQoJCUlmIE5vdCBJc0VtcHR5KHNBY3Rpb25fUGx1Z2luX0NoZWNrUmlnaHRzX0JlZ2luKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9DaGVja1JpZ2h0c19CZWdpbikNCgkJSWYgYkFjdGlvbl9QbHVnaW5fQ2hlY2tSaWdodHNfQmVnaW49VHJ1ZSBUaGVuIEV4aXQgRnVuY3Rpb24NCglOZXh0DQoNCglJZiBCbG9nVXNlci5MZXZlbD5HZXRSaWdodHMoc3RyQWN0aW9uKSBUaGVuDQoJCUNoZWNrUmlnaHRzPUZhbHNlDQoJRWxzZQ0KCQlDaGVja1JpZ2h0cz1UcnVlDQoJRW5kIElmDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICDmo4Dmn6XkvZzogIXmmK/lkKblrZjlnKgNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIENoZWNrQXV0aG9yQnlJRChpbnRBdXRob3JJZCkNCg0KCUNoZWNrQXV0aG9yQnlJRD1Ob3Qgb2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgW21lbV9JRF0gRlJPTSBbYmxvZ19NZW1iZXJdIFdIRVJFIFttZW1fSURdPSIgJiBDTG5nKGludEF1dGhvcklkKSApLkJPRg0KDQpFbmQgRnVuY3Rpb24NCg0KRnVuY3Rpb24gR2V0QXV0aG9yQnlOYW1lKHN0ck5hbWUpDQoJRGltIG9ialJTDQoJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFttZW1fSURdIEZST00gW2Jsb2dfTWVtYmVyXSBXSEVSRSBbbWVtX05hbWVdPSciJkZpbHRlclNRTChzdHJOYW1lKSYiJyIgKQ0KCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCgkJR2V0QXV0aG9yQnlOYW1lPW9ialJTKDApDQoJRWxzZQ0KCQlHZXRBdXRob3JCeU5hbWU9MA0KCUVuZCBJZg0KRW5kIEZ1bmN0aW9uDQoNCkZ1bmN0aW9uIEdldEF1dGhvckJ5QWxpYXMoc3RyQWxpYXMpDQoJRGltIG9ialJTDQoJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFttZW1fSURdIEZST00gW2Jsb2dfTWVtYmVyXSBXSEVSRSBbbWVtX1VybF09JyImRmlsdGVyU1FMKHN0ckFsaWFzKSYiJyIgKQ0KCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCgkJR2V0QXV0aG9yQnlBbGlhcz1vYmpSUygwKQ0KCUVsc2UNCgkJR2V0QXV0aG9yQnlBbGlhcz0wDQoJRW5kIElmDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAg5qOA5p+l5YiG57G75piv5ZCm5a2Y5ZyoDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBDaGVja0NhdGVCeUlEKGludENhdGVJZCkNCg0KCUlmIENMbmcoaW50Q2F0ZUlkKT0wIFRoZW4gQ2hlY2tDYXRlQnlJRD1UcnVlOkV4aXQgRnVuY3Rpb24NCg0KCUNoZWNrQ2F0ZUJ5SUQ9Tm90IG9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFtjYXRlX0lEXSBGUk9NIFtibG9nX0NhdGVnb3J5XSBXSEVSRSBbY2F0ZV9JRF09IiAmIENMbmcoaW50Q2F0ZUlkKSApLkJPRg0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIOagueaNruWIhuexu+WQjeW+l+WIsOWIhuexu0lEDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBHZXRDYXRlQnlOYW1lKHN0ck5hbWUpDQoNCglJZiBzdHJOYW1lPUJsb2dDb25maWcuUmVhZCgiWkNfVU5DQVRFR09SSVpFRF9OQU1FIikgVGhlbg0KCQlHZXRDYXRlQnlOYW1lPTANCgkJRXhpdCBGdW5jdGlvbg0KCUVuZCBJZg0KCURpbSBvYmpSUw0KCVNldCBvYmpSUz1vYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBbY2F0ZV9JRF0gRlJPTSBbYmxvZ19DYXRlZ29yeV0gV0hFUkUgW2NhdGVfTmFtZV09JyImRmlsdGVyU1FMKHN0ck5hbWUpJiInIiApDQoJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KCQlHZXRDYXRlQnlOYW1lPW9ialJTKDApDQoJRWxzZQ0KCQlHZXRDYXRlQnlOYW1lPS0xDQoJRW5kIElmDQpFbmQgRnVuY3Rpb24NCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAg5qC55o2u5YiG57G75Yir5ZCN5b6X5Yiw5YiG57G7SUQNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEdldENhdGVCeUFsaWFzKHN0ckFsaWFzKQ0KDQoJSWYgc3RyQWxpYXM9QmxvZ0NvbmZpZy5SZWFkKCJaQ19VTkNBVEVHT1JJWkVEX0FMSUFTIikgVGhlbg0KCQlHZXRDYXRlQnlBbGlhcz0wDQoJCUV4aXQgRnVuY3Rpb24NCglFbmQgSWYNCglEaW0gb2JqUlMNCglTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgW2NhdGVfSURdIEZST00gW2Jsb2dfQ2F0ZWdvcnldIFdIRVJFIFtjYXRlX1VybF09JyImRmlsdGVyU1FMKHN0ckFsaWFzKSYiJyIgKQ0KCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCgkJR2V0Q2F0ZUJ5QWxpYXM9b2JqUlMoMCkNCglFbHNlDQoJCUdldENhdGVCeUFsaWFzPS0xDQoJRW5kIElmDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAg5qOA5p+lVEFH5piv5ZCm5a2Y5ZyoDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBDaGVja1RhZ0J5SUQoaW50VGFnSUQpDQoNCglJZiBpbnRUYWdJRD0iIiBUaGVuIGludFRhZ0lEPTANCglDaGVja1RhZ0J5SUQ9Tm90IG9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFt0YWdfSURdIEZST00gW2Jsb2dfVGFnXSBXSEVSRSBbdGFnX0lEXT0iICYgaW50VGFnSUQgKS5CT0YNCg0KRW5kIEZ1bmN0aW9uDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIOajgOafpVRBR+aYr+WQpuWtmOWcqA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gQ2hlY2tUYWdCeU5hbWUoc3RyTmFtZSkNCg0KCUNoZWNrVGFnQnlOYW1lPU5vdCBvYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBbdGFnX0lEXSBGUk9NIFtibG9nX1RhZ10gV0hFUkUgW3RhZ19OYW1lXT0nIiAmIEZpbHRlclNRTChzdHJOYW1lKSAmIiciICkuQk9GDQoNCkVuZCBGdW5jdGlvbg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICDmo4Dmn6VUQUfmmK/lkKblrZjlnKgNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIENoZWNrVGFnQnlJbnRybyhzdHJOYW1lKQ0KDQoJRGltIHN0clNRTA0KCUlmIFpDX01TU1FMX0VOQUJMRSBUaGVuDQoJCXN0clNRTD0iU0VMRUNUIFt0YWdfSURdIEZST00gW2Jsb2dfVGFnXSBXSEVSRSBDT05WRVJUKE5WQVJDSEFSKDI1NSksW3RhZ19JbnRyb10pPSciICYgRmlsdGVyU1FMKHN0ck5hbWUpICYiJyINCglFbHNlDQoJCXN0clNRTD0iU0VMRUNUIFt0YWdfSURdIEZST00gW2Jsb2dfVGFnXSBXSEVSRSBbdGFnX0ludHJvXT0nIiAmIEZpbHRlclNRTChzdHJOYW1lKSAmIiciDQoJRW5kIElmDQoJQ2hlY2tUYWdCeUludHJvPU5vdCBvYmpDb25uLkV4ZWN1dGUoc3RyU1FMKS5CT0YNCg0KRW5kIEZ1bmN0aW9uDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAg5qC55o2uVEFH5Yir5ZCN5b6X5YiwVEFHIElEDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBHZXRUYWdCeUludHJvKHN0ck5hbWUpDQoJRGltIG9ialJTLHN0clNRTA0KCUlmIFpDX01TU1FMX0VOQUJMRSBUaGVuDQoJCXN0clNRTD0iU0VMRUNUIFt0YWdfSURdIEZST00gW2Jsb2dfVGFnXSBXSEVSRSBDT05WRVJUKE5WQVJDSEFSKDI1NSksW3RhZ19JbnRyb10pPSciICYgRmlsdGVyU1FMKHN0ck5hbWUpICYiJyINCglFbHNlDQoJCXN0clNRTD0iU0VMRUNUIFt0YWdfSURdIEZST00gW2Jsb2dfVGFnXSBXSEVSRSBbdGFnX0ludHJvXT0nIiAmIEZpbHRlclNRTChzdHJOYW1lKSAmIiciDQoJRW5kIElmDQoJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZShzdHJTUUwpDQoJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KCQlHZXRUYWdCeUludHJvPW9ialJTKDApDQoJRWxzZQ0KCQlHZXRUYWdCeUludHJvPTANCglFbmQgSWYNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgIOagueaNrlRBR+WQjeW+l+WIsFRBRyBJRA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gR2V0VGFnQnlOYW1lKHN0ck5hbWUpDQoJRGltIG9ialJTDQoJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFt0YWdfSURdIEZST00gW2Jsb2dfVGFnXSBXSEVSRSBbdGFnX05hbWVdPSciJkZpbHRlclNRTChzdHJOYW1lKSYiJyIgKQ0KCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCgkJR2V0VGFnQnlOYW1lPW9ialJTKDApDQoJRWxzZQ0KCQlHZXRUYWdCeU5hbWU9MA0KCUVuZCBJZg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIEdldCBDYXRlZ29yeSBPcmRlciDovpPlh7rmlbDnu4QuDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBHZXRDYXRlZ29yeU9yZGVyKCkNCg0KCURpbSBpDQoJRGltIG9ialJTDQoNCglTZXQgb2JqUlM9U2VydmVyLkNyZWF0ZU9iamVjdCgiQURPREIuUmVjb3Jkc2V0IikNCglvYmpSUy5DdXJzb3JUeXBlID0gYWRPcGVuS2V5c2V0DQoJb2JqUlMuTG9ja1R5cGUgPSBhZExvY2tSZWFkT25seQ0KCW9ialJTLkFjdGl2ZUNvbm5lY3Rpb249b2JqQ29ubg0KCW9ialJTLlNvdXJjZT0iIg0KDQoJRGltIGFyeUNhdGVJbk9yZGVyKCkNCglpPTANCglSZURpbSBQcmVzZXJ2ZSBhcnlDYXRlSW5PcmRlcigwKQ0KCWFyeUNhdGVJbk9yZGVyKDApPTANCg0KCW9ialJTLk9wZW4oIlNFTEVDVCBbY2F0ZV9pZF0gRlJPTSBbYmxvZ19DYXRlZ29yeV0gT1JERVIgQlkgW2NhdGVfT3JkZXJdIEFTQyxbY2F0ZV9JRF0gQVNDIikNCglEbyBXaGlsZSBOb3Qgb2JqUlMuZW9mDQoJCWk9aSsxDQoJCVJlRGltIFByZXNlcnZlIGFyeUNhdGVJbk9yZGVyKGkpDQoJCWFyeUNhdGVJbk9yZGVyKGkpPW9ialJTKCJjYXRlX0lEIikNCgkJb2JqUlMuTW92ZU5leHQNCglMb29wDQoJb2JqUlMuQ2xvc2UNCglTZXQgb2JqUlM9Tm90aGluZw0KDQoJR2V0Q2F0ZWdvcnlPcmRlcj1hcnlDYXRlSW5PcmRlcg0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAg5Y+W5b6X5omA5pyJ5a2Q5YiG57G755qESUQg6L6T5Ye65pWw57uELg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gR2V0U3ViQ2F0ZUlEKGludENhdGVJZCxib2xJbmNsdWRlUGFyZSkNCg0KCURpbSBpDQoJRGltIENhdGVnb3J5DQoJRGltIGFyeVN1YkNhdGVJRCgpDQoJaT0wDQoNCglJZiBib2xJbmNsdWRlUGFyZT1UcnVlIFRoZW4NCgkJUmVEaW0gUHJlc2VydmUgYXJ5U3ViQ2F0ZUlEKGkpDQoJCWFyeVN1YkNhdGVJRChpKT1pbnRDYXRlSWQNCgkJaT1pKzENCglFbmQgSWYNCg0KCUZvciBFYWNoIENhdGVnb3J5IEluIENhdGVnb3J5cw0KCQlJZiBJc09iamVjdChDYXRlZ29yeSkgVGhlbg0KCQkJSWYgQ2F0ZWdvcnkuUGFyZW50SUQ9aW50Q2F0ZUlkIFRoZW4NCgkJCQlSZURpbSBQcmVzZXJ2ZSBhcnlTdWJDYXRlSUQoaSkNCgkJCQlhcnlTdWJDYXRlSUQoaSk9Q2F0ZWdvcnkuSUQNCgkJCQlpPWkrMQ0KCQkJRW5kIElmDQoJCUVuZCBJZg0KCU5leHQNCg0KCUlmIGk+MCBUaGVuIEdldFN1YkNhdGVJRD1hcnlTdWJDYXRlSUQNCg0KCUVyYXNlIGFyeVN1YkNhdGVJRA0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gTWFrZUNhbGVuZGFyKGR0bVllYXJNb250aCkNCg0KCURpbSBzdHJDYWxlbmRhcg0KDQoJRGltIHkNCglEaW0gbQ0KCURpbSBkDQoJRGltIGZpcncNCglEaW0gbGFzdw0KCURpbSBueQ0KCURpbSBubQ0KCURpbSBweQ0KCURpbSBwbQ0KDQoJRGltIGkNCglEaW0gag0KCURpbSBrDQoJRGltIGINCglEaW0gcw0KCURpbSB0DQoNCglDYWxsIENoZWNrUGFyYW1ldGVyKGR0bVllYXJNb250aCwiZHRtIixEYXRlKCkpDQoNCgl5PXllYXIoZHRtWWVhck1vbnRoKQ0KCW09bW9udGgoZHRtWWVhck1vbnRoKQ0KCW55PXkNCglubT1tKzENCglJZiBtPTEyIFRoZW4gbnk9bnkrMTpubT0xDQoJcHk9eQ0KCXBtPW0tMQ0KCWlmIG09MSB0aGVuIHB5PXB5LTE6cG09MTINCg0KCWZpcnc9V2Vla2RheShDZGF0ZSh5JiItIiZtJiItMSIpKQ0KDQoJRm9yIGk9MjggdG8gMzINCgkJSWYgSXNEYXRlKHkmIi0iJm0mIi0iJmkpIFRoZW4NCgkJCWxhc3c9V2Vla2RheShDZGF0ZSh5JiItIiZtJiItIiZpKSkNCgkJRWxzZQ0KCQkJRXhpdCBGb3INCgkJRW5kIElmDQoJTmV4dA0KDQoJZD1pLTENCglrPTENCg0KCUlmIGZpcnc+NSBUaGVuIGI9NDIgRWxzZSBiPTM1DQoJSWYgKGQ9MjgpIEFuZCAoZmlydz0xKSBUaGVuIGI9MjgNCglJZiAoZmlydz41KSBBbmQgKGQ8MzEpIEFuZCAoZC1maXJ3PD4yMykgVGhlbiBiPTM1DQoNCg0KCScvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQoJJwnpgLvovpHlpITnkIYNCgkJRGltIGFyeURhdGVMaW5rKDMyKQ0KCQlEaW0gYXJ5RGF0ZUlEKDMyKQ0KCQlEaW0gYXJ5RGF0ZUFydGljbGUoMzIpDQoJCURpbSBvYmpSUw0KDQoJCVNldCBvYmpSUz1TZXJ2ZXIuQ3JlYXRlT2JqZWN0KCJBRE9EQi5SZWNvcmRzZXQiKQ0KCQlvYmpSUy5DdXJzb3JUeXBlID0gYWRPcGVuS2V5c2V0DQoJCW9ialJTLkxvY2tUeXBlID0gYWRMb2NrUmVhZE9ubHkNCgkJb2JqUlMuQWN0aXZlQ29ubmVjdGlvbj1vYmpDb25uDQoJCW9ialJTLlNvdXJjZT0iIg0KCQlvYmpSUy5PcGVuKCJzZWxlY3QgW2xvZ19JRF0sW2xvZ19UYWddLFtsb2dfQ2F0ZUlEXSxbbG9nX1RpdGxlXSxbbG9nX0ludHJvXSxbbG9nX0NvbnRlbnRdLFtsb2dfTGV2ZWxdLFtsb2dfQXV0aG9ySURdLFtsb2dfUG9zdFRpbWVdLFtsb2dfQ29tbU51bXNdLFtsb2dfVmlld051bXNdLFtsb2dfVHJhY2tCYWNrTnVtc10sW2xvZ19VcmxdLFtsb2dfSXN0b3BdLFtsb2dfVGVtcGxhdGVdLFtsb2dfRnVsbFVybF0sW2xvZ19UeXBlXSxbbG9nX01ldGFdIGZyb20gW2Jsb2dfQXJ0aWNsZV0gd2hlcmUgKFtsb2dfVHlwZV09MCkgQW5kIChbbG9nX0xldmVsXT4yKSBBbmQgKFtsb2dfUG9zdFRpbWVdIEJFVFdFRU4gIiYgWkNfU1FMX1BPVU5EX0tFWSAmeSYiLSImbSYiLTEiJiBaQ19TUUxfUE9VTkRfS0VZICYiIEFORCAiJiBaQ19TUUxfUE9VTkRfS0VZICZueSYiLSImbm0mIi0xIiYgWkNfU1FMX1BPVU5EX0tFWSAmIikgQU5EIGxvZ19JRCBpbihTRUxFQ1QgbWF4KGxvZ19JRCkgZnJvbSBbYmxvZ19BcnRpY2xlXSBncm91cCBieSBNb250aChsb2dfcG9zdHRpbWUpLERheShsb2dfcG9zdHRpbWUpKSIpDQoNCgkJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KCQkJRm9yIGk9MSBUbyBvYmpSUy5SZWNvcmRDb3VudA0KCQkJCWo9Q0xuZyhEYXkoQ0RhdGUob2JqUlMoImxvZ19Qb3N0VGltZSIpKSkpDQoJCQkJYXJ5RGF0ZUxpbmsoaik9VHJ1ZQ0KCQkJCWFyeURhdGVJRChqKT1vYmpSUygibG9nX0lEIikNCgkJCQlTZXQgYXJ5RGF0ZUFydGljbGUoaik9TmV3IFRBcnRpY2xlDQoJCQkJYXJ5RGF0ZUFydGljbGUoaikuTG9hZEluZm9ieUFycmF5IEFycmF5KG9ialJTKDApLG9ialJTKDEpLG9ialJTKDIpLG9ialJTKDMpLG9ialJTKDQpLG9ialJTKDUpLG9ialJTKDYpLG9ialJTKDcpLG9ialJTKDgpLG9ialJTKDkpLG9ialJTKDEwKSxvYmpSUygxMSksb2JqUlMoMTIpLG9ialJTKDEzKSxvYmpSUygxNCksb2JqUlMoMTUpLG9ialJTKDE2KSxvYmpSUygxNykpDQoJCQkJb2JqUlMuTW92ZU5leHQNCgkJCQlJZiBvYmpSUy5lb2YgVGhlbiBFeGl0IEZvcg0KCQkJTmV4dA0KCQlFbmQgSWYNCgkJb2JqUlMuQ2xvc2UNCgkJU2V0IG9ialJTPU5vdGhpbmcNCgknLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KDQoJcz1VcmxieURhdGVBdXRvKHksbS0xLCIiKQ0KCXQ9VXJsYnlEYXRlQXV0byh5LG0rMSwiIikNCglJZiBtPTEgVGhlbiBzPVVybGJ5RGF0ZUF1dG8oeS0xLDEyLCIiKQ0KCUlmIG09MTIgVGhlbiB0PVVybGJ5RGF0ZUF1dG8oeSsxLDEsIiIpDQoNCgkJc3RyQ2FsZW5kYXI9Ijx0YWJsZSBpZD0iInRiQ2FsZW5kYXIiIj48Y2FwdGlvbj48YSBocmVmPSIiIiZzJiIiIj4mIzAwMTcxOzwvYT4gIDxhIGhyZWY9IiIiJlVybGJ5RGF0ZUF1dG8oeSxtLCIiKSYiIiI+IiZSZXBsYWNlKFpDX01TRzIzMywiJXkiLHkpJiAiICIgJiBaVkFfTW9udGhfQWJicihtKSYiPC9hPiAgPGEgaHJlZj0iIiImdCYiIiI+JiMwMDE4Nzs8L2E+PC9jYXB0aW9uPiINCgkJDQoJJ3RoZWFkCQ0KCQlzdHJDYWxlbmRhcj1zdHJDYWxlbmRhciAmICIJPHRoZWFkPgk8dHI+IDx0aCB0aXRsZT0iIiImWlZBX1dlZWsoMSkmIiIiIHNjb3BlPSIiY29sIiIgYWJicj0iIiImWlZBX1dlZWsoMSkmIiIiPjxzbWFsbD4iJlpWQV9XZWVrX0FiYnIoMSkmIjwvc21hbGw+PC90aD4gPHRoIHRpdGxlPSIiIiZaVkFfV2VlaygyKSYiIiIgc2NvcGU9IiJjb2wiIiBhYmJyPSIiIiZaVkFfV2VlaygyKSYiIiI+PHNtYWxsPiImWlZBX1dlZWtfQWJicigyKSYiPC9zbWFsbD48L3RoPiA8dGggdGl0bGU9IiIiJlpWQV9XZWVrKDMpJiIiIiBzY29wZT0iImNvbCIiIGFiYnI9IiIiJlpWQV9XZWVrKDMpJiIiIj48c21hbGw+IiZaVkFfV2Vla19BYmJyKDMpJiI8L3NtYWxsPjwvdGg+CTx0aCB0aXRsZT0iIiImWlZBX1dlZWsoNCkmIiIiIHNjb3BlPSIiY29sIiIgYWJicj0iIiImWlZBX1dlZWsoNCkmIiIiPjxzbWFsbD4iJlpWQV9XZWVrX0FiYnIoNCkmIjwvc21hbGw+PC90aD4gPHRoIHRpdGxlPSIiIiZaVkFfV2Vlayg1KSYiIiIgc2NvcGU9IiJjb2wiIiBhYmJyPSIiIiZaVkFfV2Vlayg1KSYiIiI+PHNtYWxsPiImWlZBX1dlZWtfQWJicig1KSYiPC9zbWFsbD48L3RoPgk8dGggdGl0bGU9IiIiJlpWQV9XZWVrKDYpJiIiIiBzY29wZT0iImNvbCIiIGFiYnI9IiIiJlpWQV9XZWVrKDYpJiIiIj48c21hbGw+IiZaVkFfV2Vla19BYmJyKDYpJiI8L3NtYWxsPjwvdGg+IDx0aCB0aXRsZT0iIiImWlZBX1dlZWsoNykmIiIiIHNjb3BlPSIiY29sIiIgYWJicj0iIiImWlZBX1dlZWsoNykmIiIiPjxzbWFsbD4iJlpWQV9XZWVrX0FiYnIoNykmIjwvc21hbGw+PC90aD4JPC90cj4JPC90aGVhZD4iDQoJCQ0KCSd0Zm9vdAkNCgkJDQoJJ3Rib2R5CQ0KCXN0ckNhbGVuZGFyPXN0ckNhbGVuZGFyICYgIgk8dGJvZHk+Ig0KCQ0KCWo9MA0KCURpbSBiMSxiMg0KCUZvciBpPTEgdG8gYg0KDQoJCUlmIChqIE1vZCA3KT0wIFRoZW4gc3RyQ2FsZW5kYXI9c3RyQ2FsZW5kYXIgJiAiPHRyPiINCgkJSWYgKGovNyk8PTAgYW5kIGZpcnc8PjEgdGhlbiBzdHJDYWxlbmRhcj1zdHJDYWxlbmRhciAmICI8dGQgY2xhc3M9IiJwYWQiIiBjb2xzcGFuPSIiIiYgKGZpcnctMSkgJiIiIj4gPC90ZD4iDQoNCgkJSWYgKGo9PmZpcnctMSkgYW5kIChrPTxkKSBUaGVuDQoJCQ0KCQkJc3RyQ2FsZW5kYXI9c3RyQ2FsZW5kYXIgJiAiPHRkICINCgkJCQ0KCQkJSWYgCUNkYXRlKHkmIi0iJm0mIi0iJmspID0gRGF0ZSgpIFRoZW4NCgkJCQlzdHJDYWxlbmRhcj1zdHJDYWxlbmRhciAmICIgaWQgPSIidG9kYXkiIiAiDQoJCQkJYjE9IjxiPiINCgkJCQliMj0iPC9iPiINCgkJCUVsc2UNCgkJCQliMT0iIg0KCQkJCWIyPSIiDQoJCQlFbmQgSWYNCgkJCQ0KCQkJSWYgYXJ5RGF0ZUxpbmsoaykgVGhlbg0KCQkJCXN0ckNhbGVuZGFyPXN0ckNhbGVuZGFyICYgIj48YSBocmVmPSIiIiYgWkNfQkxPR19IT1NUICYiY2F0YWxvZy5hc3A/ZGF0ZT0iJlllYXIoYXJ5RGF0ZUFydGljbGUoaykuUG9zdFRpbWUpJiItIiZNb250aChhcnlEYXRlQXJ0aWNsZShrKS5Qb3N0VGltZSkmIi0iJkRheShhcnlEYXRlQXJ0aWNsZShrKS5Qb3N0VGltZSkmICIiIj4iJmIxJihrKSZiMiYiPC9hPjwvdGQ+Ig0KCQkJRWxzZQ0KCQkJCXN0ckNhbGVuZGFyPXN0ckNhbGVuZGFyICYiPiImYjEmKGspJmIyJiI8L3RkPiINCgkJCUVuZCBJZg0KDQoJCQlrPWsrMQ0KCQlFbmQgSWYNCgkJCQ0KCQlpZiBqPWItMSBBTkQgbGFzdzw+NyB0aGVuIHN0ckNhbGVuZGFyPXN0ckNhbGVuZGFyICYgIjx0ZCBjbGFzcz0iInBhZCIiIGNvbHNwYW49IiIiJiAoNy1sYXN3KSAmIiIiPiA8L3RkPiIJCQ0KDQoJCUlmIChqIE1vZCA3KT02IFRoZW4gc3RyQ2FsZW5kYXI9c3RyQ2FsZW5kYXIgJiAiPC90cj4iDQoNCgkJaj1qKzENCglOZXh0DQoNCglzdHJDYWxlbmRhcj1zdHJDYWxlbmRhciAmICIJPC90Ym9keT48L3RhYmxlPiINCglNYWtlQ2FsZW5kYXI9c3RyQ2FsZW5kYXINCgkNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICDliqDovb3pu5jorqTnmoTkuLvpopjmqKHmnb8NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIExvYWREZWZhdWx0VGVtcGxhdGVzKCkNCg0KSWYgVGVtcGxhdGVEaWMuRXhpc3RzKCJURU1QTEFURV9CX0FSVElDTEUtSVNUT1AiKT1GYWxzZSBUaGVuIENhbGwgVGVtcGxhdGVEaWMuYWRkKCJURU1QTEFURV9CX0FSVElDTEUtSVNUT1AiLExvYWRGcm9tRmlsZShCbG9nUGF0aCAmInpiX3N5c3RlbVxkZWZlbmRcZGVmYXVsdFxiX2FydGljbGUtaXN0b3AuaHRtbCIsInV0Zi04IikpDQpJZiBUZW1wbGF0ZURpYy5FeGlzdHMoIlRFTVBMQVRFX0JfQVJUSUNMRS1NVUxUSSIpPUZhbHNlIFRoZW4gQ2FsbCBUZW1wbGF0ZURpYy5hZGQoIlRFTVBMQVRFX0JfQVJUSUNMRS1NVUxUSSIsTG9hZEZyb21GaWxlKEJsb2dQYXRoICYiemJfc3lzdGVtXGRlZmVuZFxkZWZhdWx0XGJfYXJ0aWNsZS1tdWx0aS5odG1sIiwidXRmLTgiKSkNCklmIFRlbXBsYXRlRGljLkV4aXN0cygiVEVNUExBVEVfQl9BUlRJQ0xFLVNJTkdMRSIpPUZhbHNlIFRoZW4gQ2FsbCBUZW1wbGF0ZURpYy5hZGQoIlRFTVBMQVRFX0JfQVJUSUNMRS1TSU5HTEUiLExvYWRGcm9tRmlsZShCbG9nUGF0aCAmInpiX3N5c3RlbVxkZWZlbmRcZGVmYXVsdFxiX2FydGljbGUtc2luZ2xlLmh0bWwiLCJ1dGYtOCIpKQ0KSWYgVGVtcGxhdGVEaWMuRXhpc3RzKCJURU1QTEFURV9CX0FSVElDTEVfQ09NTUVOVCIpPUZhbHNlIFRoZW4gQ2FsbCBUZW1wbGF0ZURpYy5hZGQoIlRFTVBMQVRFX0JfQVJUSUNMRV9DT01NRU5UIixMb2FkRnJvbUZpbGUoQmxvZ1BhdGggJiJ6Yl9zeXN0ZW1cZGVmZW5kXGRlZmF1bHRcYl9hcnRpY2xlX2NvbW1lbnQuaHRtbCIsInV0Zi04IikpDQpJZiBUZW1wbGF0ZURpYy5FeGlzdHMoIlRFTVBMQVRFX0JfQVJUSUNMRV9DT01NRU5UUE9TVC1WRVJJRlkiKT1GYWxzZSBUaGVuIENhbGwgVGVtcGxhdGVEaWMuYWRkKCJURU1QTEFURV9CX0FSVElDTEVfQ09NTUVOVFBPU1QtVkVSSUZZIixMb2FkRnJvbUZpbGUoQmxvZ1BhdGggJiJ6Yl9zeXN0ZW1cZGVmZW5kXGRlZmF1bHRcYl9hcnRpY2xlX2NvbW1lbnRwb3N0LXZlcmlmeS5odG1sIiwidXRmLTgiKSkNCklmIFRlbXBsYXRlRGljLkV4aXN0cygiVEVNUExBVEVfQl9BUlRJQ0xFX0NPTU1FTlRQT1NUIik9RmFsc2UgVGhlbiBDYWxsIFRlbXBsYXRlRGljLmFkZCgiVEVNUExBVEVfQl9BUlRJQ0xFX0NPTU1FTlRQT1NUIixMb2FkRnJvbUZpbGUoQmxvZ1BhdGggJiJ6Yl9zeXN0ZW1cZGVmZW5kXGRlZmF1bHRcYl9hcnRpY2xlX2NvbW1lbnRwb3N0Lmh0bWwiLCJ1dGYtOCIpKQ0KSWYgVGVtcGxhdGVEaWMuRXhpc3RzKCJURU1QTEFURV9CX0FSVElDTEVfQ09NTUVOVF9QQUdFQkFSIik9RmFsc2UgVGhlbiBDYWxsIFRlbXBsYXRlRGljLmFkZCgiVEVNUExBVEVfQl9BUlRJQ0xFX0NPTU1FTlRfUEFHRUJBUiIsTG9hZEZyb21GaWxlKEJsb2dQYXRoICYiemJfc3lzdGVtXGRlZmVuZFxkZWZhdWx0XGJfYXJ0aWNsZV9jb21tZW50X3BhZ2ViYXIuaHRtbCIsInV0Zi04IikpDQpJZiBUZW1wbGF0ZURpYy5FeGlzdHMoIlRFTVBMQVRFX0JfQVJUSUNMRV9NVVRVQUxJVFkiKT1GYWxzZSBUaGVuIENhbGwgVGVtcGxhdGVEaWMuYWRkKCJURU1QTEFURV9CX0FSVElDTEVfTVVUVUFMSVRZIixMb2FkRnJvbUZpbGUoQmxvZ1BhdGggJiJ6Yl9zeXN0ZW1cZGVmZW5kXGRlZmF1bHRcYl9hcnRpY2xlX211dHVhbGl0eS5odG1sIiwidXRmLTgiKSkNCklmIFRlbXBsYXRlRGljLkV4aXN0cygiVEVNUExBVEVfQl9BUlRJQ0xFX05BVkJBUl9MIik9RmFsc2UgVGhlbiBDYWxsIFRlbXBsYXRlRGljLmFkZCgiVEVNUExBVEVfQl9BUlRJQ0xFX05BVkJBUl9MIixMb2FkRnJvbUZpbGUoQmxvZ1BhdGggJiJ6Yl9zeXN0ZW1cZGVmZW5kXGRlZmF1bHRcYl9hcnRpY2xlX25hdmJhcl9sLmh0bWwiLCJ1dGYtOCIpKQ0KSWYgVGVtcGxhdGVEaWMuRXhpc3RzKCJURU1QTEFURV9CX0FSVElDTEVfTkFWQkFSX1IiKT1GYWxzZSBUaGVuIENhbGwgVGVtcGxhdGVEaWMuYWRkKCJURU1QTEFURV9CX0FSVElDTEVfTkFWQkFSX1IiLExvYWRGcm9tRmlsZShCbG9nUGF0aCAmInpiX3N5c3RlbVxkZWZlbmRcZGVmYXVsdFxiX2FydGljbGVfbmF2YmFyX3IuaHRtbCIsInV0Zi04IikpDQpJZiBUZW1wbGF0ZURpYy5FeGlzdHMoIlRFTVBMQVRFX0JfQVJUSUNMRV9UQUciKT1GYWxzZSBUaGVuIENhbGwgVGVtcGxhdGVEaWMuYWRkKCJURU1QTEFURV9CX0FSVElDTEVfVEFHIixMb2FkRnJvbUZpbGUoQmxvZ1BhdGggJiJ6Yl9zeXN0ZW1cZGVmZW5kXGRlZmF1bHRcYl9hcnRpY2xlX3RhZy5odG1sIiwidXRmLTgiKSkNCklmIFRlbXBsYXRlRGljLkV4aXN0cygiVEVNUExBVEVfQl9GVU5DVElPTiIpPUZhbHNlIFRoZW4gQ2FsbCBUZW1wbGF0ZURpYy5hZGQoIlRFTVBMQVRFX0JfRlVOQ1RJT04iLExvYWRGcm9tRmlsZShCbG9nUGF0aCAmInpiX3N5c3RlbVxkZWZlbmRcZGVmYXVsdFxiX2Z1bmN0aW9uLmh0bWwiLCJ1dGYtOCIpKQ0KSWYgVGVtcGxhdGVEaWMuRXhpc3RzKCJURU1QTEFURV9CX1BBR0VCQVIiKT1GYWxzZSBUaGVuIENhbGwgVGVtcGxhdGVEaWMuYWRkKCJURU1QTEFURV9CX1BBR0VCQVIiLExvYWRGcm9tRmlsZShCbG9nUGF0aCAmInpiX3N5c3RlbVxkZWZlbmRcZGVmYXVsdFxiX3BhZ2ViYXIuaHRtbCIsInV0Zi04IikpDQpJZiBUZW1wbGF0ZURpYy5FeGlzdHMoIlRFTVBMQVRFX0NBVEFMT0ciKT1GYWxzZSBUaGVuIENhbGwgVGVtcGxhdGVEaWMuYWRkKCJURU1QTEFURV9DQVRBTE9HIixMb2FkRnJvbUZpbGUoQmxvZ1BhdGggJiJ6Yl9zeXN0ZW1cZGVmZW5kXGRlZmF1bHRcY2F0YWxvZy5odG1sIiwidXRmLTgiKSkNCklmIFRlbXBsYXRlRGljLkV4aXN0cygiVEVNUExBVEVfREVGQVVMVCIpPUZhbHNlIFRoZW4gQ2FsbCBUZW1wbGF0ZURpYy5hZGQoIlRFTVBMQVRFX0RFRkFVTFQiLExvYWRGcm9tRmlsZShCbG9nUGF0aCAmInpiX3N5c3RlbVxkZWZlbmRcZGVmYXVsdFxkZWZhdWx0Lmh0bWwiLCJ1dGYtOCIpKQ0KSWYgVGVtcGxhdGVEaWMuRXhpc3RzKCJURU1QTEFURV9GT09URVIiKT1GYWxzZSBUaGVuIENhbGwgVGVtcGxhdGVEaWMuYWRkKCJURU1QTEFURV9GT09URVIiLExvYWRGcm9tRmlsZShCbG9nUGF0aCAmInpiX3N5c3RlbVxkZWZlbmRcZGVmYXVsdFxmb290ZXIuaHRtbCIsInV0Zi04IikpDQpJZiBUZW1wbGF0ZURpYy5FeGlzdHMoIlRFTVBMQVRFX0hFQURFUiIpPUZhbHNlIFRoZW4gQ2FsbCBUZW1wbGF0ZURpYy5hZGQoIlRFTVBMQVRFX0hFQURFUiIsTG9hZEZyb21GaWxlKEJsb2dQYXRoICYiemJfc3lzdGVtXGRlZmVuZFxkZWZhdWx0XGhlYWRlci5odG1sIiwidXRmLTgiKSkNCklmIFRlbXBsYXRlRGljLkV4aXN0cygiVEVNUExBVEVfU0lERUJBUiIpPUZhbHNlIFRoZW4gQ2FsbCBUZW1wbGF0ZURpYy5hZGQoIlRFTVBMQVRFX1NJREVCQVIiLExvYWRGcm9tRmlsZShCbG9nUGF0aCAmInpiX3N5c3RlbVxkZWZlbmRcZGVmYXVsdFwuaHRtbCIsInV0Zi04IikpDQpJZiBUZW1wbGF0ZURpYy5FeGlzdHMoIlRFTVBMQVRFX1NJTkdMRSIpPUZhbHNlIFRoZW4gQ2FsbCBUZW1wbGF0ZURpYy5hZGQoIlRFTVBMQVRFX1NJTkdMRSIsTG9hZEZyb21GaWxlKEJsb2dQYXRoICYiemJfc3lzdGVtXGRlZmVuZFxkZWZhdWx0XHNpbmdsZS5odG1sIiwidXRmLTgiKSkNCklmIFRlbXBsYXRlRGljLkV4aXN0cygiVEVNUExBVEVfQl9BUlRJQ0xFLVNFQVJDSC1DT05URU5UIik9RmFsc2UgVGhlbiBDYWxsIFRlbXBsYXRlRGljLmFkZCgiVEVNUExBVEVfQl9BUlRJQ0xFLVNFQVJDSC1DT05URU5UIixMb2FkRnJvbUZpbGUoQmxvZ1BhdGggJiJ6Yl9zeXN0ZW1cZGVmZW5kXGRlZmF1bHRcYl9hcnRpY2xlLXNlYXJjaC1jb250ZW50Lmh0bWwiLCJ1dGYtOCIpKQ0KSWYgVGVtcGxhdGVEaWMuRXhpc3RzKCJURU1QTEFURV9CX0FSVElDTEUtUEFHRSIpPUZhbHNlIFRoZW4gQ2FsbCBUZW1wbGF0ZURpYy5hZGQoIlRFTVBMQVRFX0JfQVJUSUNMRS1QQUdFIixMb2FkRnJvbUZpbGUoQmxvZ1BhdGggJiJ6Yl9zeXN0ZW1cZGVmZW5kXGRlZmF1bHRcYl9hcnRpY2xlLXBhZ2UuaHRtbCIsInV0Zi04IikpDQpJZiBUZW1wbGF0ZURpYy5FeGlzdHMoIlRFTVBMQVRFX1BBR0UiKT1GYWxzZSBUaGVuIENhbGwgVGVtcGxhdGVEaWMuYWRkKCJURU1QTEFURV9QQUdFIixMb2FkRnJvbUZpbGUoQmxvZ1BhdGggJiJ6Yl9zeXN0ZW1cZGVmZW5kXGRlZmF1bHRccGFnZS5odG1sIiwidXRmLTgiKSkNCklmIFRlbXBsYXRlRGljLkV4aXN0cygiVEVNUExBVEVfQl9BUlRJQ0xFX0NPTU1FTlRfUEFHRUJBUl9MIik9RmFsc2UgVGhlbiBDYWxsIFRlbXBsYXRlRGljLmFkZCgiVEVNUExBVEVfQl9BUlRJQ0xFX0NPTU1FTlRfUEFHRUJBUl9MIixMb2FkRnJvbUZpbGUoQmxvZ1BhdGggJiJ6Yl9zeXN0ZW1cZGVmZW5kXGRlZmF1bHRcYl9hcnRpY2xlX2NvbW1lbnRfcGFnZWJhcl9sLmh0bWwiLCJ1dGYtOCIpKQ0KSWYgVGVtcGxhdGVEaWMuRXhpc3RzKCJURU1QTEFURV9CX0FSVElDTEVfQ09NTUVOVF9QQUdFQkFSX1IiKT1GYWxzZSBUaGVuIENhbGwgVGVtcGxhdGVEaWMuYWRkKCJURU1QTEFURV9CX0FSVElDTEVfQ09NTUVOVF9QQUdFQkFSX1IiLExvYWRGcm9tRmlsZShCbG9nUGF0aCAmInpiX3N5c3RlbVxkZWZlbmRcZGVmYXVsdFxiX2FydGljbGVfY29tbWVudF9wYWdlYmFyX3IuaHRtbCIsInV0Zi04IikpDQoNCifkuLoyLjLmlLnkuobmqKHmnb/nmoTpu5jorqTooajljZUNCkRpbSBzDQpzPVRlbXBsYXRlRGljLkl0ZW0oIlRFTVBMQVRFX0JfQVJUSUNMRV9DT01NRU5UUE9TVCIpDQoNCklmIEluU3RyKHMsImlucFJldklEIik9MCBUaGVuDQoJSWYgSW5TdHIocywiaW5wTG9jYXRpb24iKT4wIFRoZW4NCgkJcz1SZXBsYWNlKHMsImlucExvY2F0aW9uIiwiaW5wUmV2SUQiKQ0KCUVsc2UNCgkJcz1SZXBsYWNlKHMsIjxpbnB1dCIsIjxpbnB1dCB0eXBlPSIiaGlkZGVuIiIgbmFtZT0iImlucFJldklEIiIgaWQ9IiJpbnBSZXZJRCIiIHZhbHVlPSIiIiIgLz48aW5wdXQiLDEsMSkNCglFbmQgSWYNCkVuZCBJZg0KVGVtcGxhdGVEaWMuSXRlbSgiVEVNUExBVEVfQl9BUlRJQ0xFX0NPTU1FTlRQT1NUIik9cw0KDQoJRGltIGksag0KCSflnKjmqKHmnb/mlofku7bkuK3lhYjmm7/mjaLkuIDmrKHmqKHmnb9JTkNMVURF6YeM55qE5paH5Lu25qCH562+DQoJRm9yIEVhY2ggaSBJbiBUZW1wbGF0ZURpYy5LZXlzDQoJCUZvciBFYWNoIGogSW4gVGVtcGxhdGVEaWMuS2V5cw0KCQkJVGVtcGxhdGVEaWMuSXRlbShqKT1SZXBsYWNlKFRlbXBsYXRlRGljLkl0ZW0oaiksIjwjIitpKyIjPiIsVGVtcGxhdGVEaWMuSXRlbShpKSkNCgkJTmV4dA0KCU5leHQNCg0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAg5Yqg6L295oyH5a6a55uu5b2V55qE5paH5Lu25YiX6KGoDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBMb2FkSW5jbHVkZUZpbGVzKHN0ckRpcikNCg0KCURpbSBhcnlGaWxlTGlzdCgpDQoJUmVEaW0gYXJ5RmlsZUxpc3QoLTEpDQoNCglEaW0gZiwgZjEsIGZjLCBzLCBpDQoNCglJZiBOb3QgSXNPYmplY3QoUHVibGljT2JqRlNPKSBUaGVuIFNldCBQdWJsaWNPYmpGU089U2VydmVyLkNyZWF0ZU9iamVjdCgiU2NyaXB0aW5nLkZpbGVTeXN0ZW1PYmplY3QiKQ0KCQ0KCUlmIFB1YmxpY09iakZTTy5Gb2xkZXJFeGlzdHMoQmxvZ1BhdGggJiBzdHJEaXIpPUZhbHNlIFRoZW4NCgkJTG9hZEluY2x1ZGVGaWxlcz1BcnJheSgpDQoJCUV4aXQgRnVuY3Rpb24NCglFbmQgSWYNCg0KCVNldCBmID0gUHVibGljT2JqRlNPLkdldEZvbGRlcihCbG9nUGF0aCAmIHN0ckRpcikNCglTZXQgZmMgPSBmLkZpbGVzDQoNCglpPTANCg0KCUZvciBFYWNoIGYxIGluIGZjDQoJCWk9aSsxDQoJCVJlRGltIFByZXNlcnZlIGFyeUZpbGVMaXN0KGkpDQoJCWFyeUZpbGVMaXN0KGkpPWYxLm5hbWUNCglOZXh0DQoNCglMb2FkSW5jbHVkZUZpbGVzPWFyeUZpbGVMaXN0DQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAg5Yqg6L295oyH5a6a55uu5b2V55qE5paH5Lu25YiX6KGoDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBMb2FkSW5jbHVkZUZpbGVzT25seVR5cGUoc3RyRGlyKQ0KDQoJRGltIGFyeUZpbGVMaXN0KCkNCglSZURpbSBhcnlGaWxlTGlzdCgtMSkNCg0KCURpbSBmLCBmMSwgZmMsIHMsIGkNCg0KCUlmIE5vdCBJc09iamVjdChQdWJsaWNPYmpGU08pIFRoZW4gU2V0IFB1YmxpY09iakZTTz1TZXJ2ZXIuQ3JlYXRlT2JqZWN0KCJTY3JpcHRpbmcuRmlsZVN5c3RlbU9iamVjdCIpDQoNCglJZiBQdWJsaWNPYmpGU08uRm9sZGVyRXhpc3RzKEJsb2dQYXRoICYgc3RyRGlyKT1GYWxzZSBUaGVuDQoJCUxvYWRJbmNsdWRlRmlsZXNPbmx5VHlwZT1BcnJheSgpDQoJCUV4aXQgRnVuY3Rpb24NCglFbmQgSWYNCg0KCVNldCBmID0gUHVibGljT2JqRlNPLkdldEZvbGRlcihCbG9nUGF0aCAmIHN0ckRpcikNCglTZXQgZmMgPSBmLkZpbGVzDQoNCglpPTANCg0KCUZvciBFYWNoIGYxIGluIGZjDQoJCUlmIFJpZ2h0KGYxLm5hbWUsNSk9Ii5odG1sIiBPciBSaWdodChmMS5uYW1lLDQpPSIuYXNwIiBPciBSaWdodChmMS5uYW1lLDQpPSIuaHRtIiAgVGhlbg0KCQkJaT1pKzENCgkJCVJlRGltIFByZXNlcnZlIGFyeUZpbGVMaXN0KGkpDQoJCQlhcnlGaWxlTGlzdChpKT1mMS5uYW1lDQoJCUVuZCBJZg0KCU5leHQNCg0KCUxvYWRJbmNsdWRlRmlsZXNPbmx5VHlwZT1hcnlGaWxlTGlzdA0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgR2V0IFRlbXBsYXRlIGJ5IE5hbWUNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEdldFRlbXBsYXRlKE5hbWUpDQoNCglHZXRUZW1wbGF0ZT1UZW1wbGF0ZURpYy5JdGVtKE5hbWUpDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBTZXQgVGVtcGxhdGUgYnkgTmFtZQ0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gU2V0VGVtcGxhdGUoTmFtZSxWYWx1ZSkNCg0KCVRlbXBsYXRlRGljLkl0ZW0oTmFtZSk9VmFsdWUNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIOW+l+WIsOaooeadv+agh+etvg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gR2V0VGVtcGxhdGVUYWdzKE5hbWUpDQoJR2V0VGVtcGxhdGVUYWdzPVRlbXBsYXRlVGFnc0RpYy5JdGVtKE5hbWUpDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAg6K6+572u5qih5p2/5qCH562+DQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBTZXRUZW1wbGF0ZVRhZ3MoTmFtZSxWYWx1ZSkNCglUZW1wbGF0ZVRhZ3NEaWMuSXRlbShOYW1lKT1WYWx1ZQ0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIENoZWNrIFRlbXBsYXRlIE1vZGlmaWVkIERhdGUNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIENoZWNrVGVtcGxhdGVNb2RpZmllZCgpDQoNCglEaW0gZiwgZjEsIGZjLCBzDQoJRGltIGQsbmQNCg0KCUlmIE5vdCBJc09iamVjdChQdWJsaWNPYmpGU08pIFRoZW4gU2V0IFB1YmxpY09iakZTTz1TZXJ2ZXIuQ3JlYXRlT2JqZWN0KCJTY3JpcHRpbmcuRmlsZVN5c3RlbU9iamVjdCIpDQoJDQoJSWYgUHVibGljT2JqRlNPLkZvbGRlckV4aXN0cyhCbG9nUGF0aCAmICJ6Yl91c2Vyc1wiICYgInRoZW1lIiAmICJcIiAmIFpDX0JMT0dfVEhFTUUgJiAiXCIgJiBaQ19URU1QTEFURV9ESVJFQ1RPUlkpPUZhbHNlIFRoZW4gRXhpdCBGdW5jdGlvbg0KCVNldCBmID0gUHVibGljT2JqRlNPLkdldEZvbGRlcihCbG9nUGF0aCAmICJ6Yl91c2Vyc1wiICYgInRoZW1lIiAmICJcIiAmIFpDX0JMT0dfVEhFTUUgJiAiXCIgJiBaQ19URU1QTEFURV9ESVJFQ1RPUlkpDQoJU2V0IGZjID0gZi5GaWxlcw0KDQoJRm9yIEVhY2ggZjEgaW4gZmMNCgkgIGQ9ZjEuRGF0ZUxhc3RNb2RpZmllZA0KCSAgSWYgbmQ9IiIgVGhlbiBuZD1kDQoJICBJZiBEYXRlRGlmZigicyIsbmQsZCk+MCBUaGVuIG5kPWQNCglOZXh0DQoNCglDaGVja1RlbXBsYXRlTW9kaWZpZWQ9bmQNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIExvYWQg5YWo5bGAIENhY2hlDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBMb2FkR2xvYmVDYWNoZSgpDQoNCglPbiBFcnJvciBSZXN1bWUgTmV4dA0KDQoJRGltIGlpLGpqDQoNCglEaW0gYm9sUmVMb2FkQ2FjaGUNCglBcHBsaWNhdGlvbi5Mb2NrDQoJYm9sUmVMb2FkQ2FjaGU9QXBwbGljYXRpb24oWkNfQkxPR19DTFNJRCAmICJTSUdOQUxfUkVMT0FEQ0FDSEUiKQ0KCUFwcGxpY2F0aW9uLlVuTG9jaw0KDQoJSWYgSXNFbXB0eShib2xSZUxvYWRDYWNoZSk9VHJ1ZSBUaGVuDQoJCWJvbFJlTG9hZENhY2hlPSJvayINCglFbHNlDQoJCURpbSBUZW1wbGF0ZXNOYW1lDQoJCURpbSBUZW1wbGF0ZXNDb250ZW50DQoNCgkJRGltIFRlbXBsYXRlVGFnc05hbWUNCgkJRGltIFRlbXBsYXRlVGFnc1ZhbHVlDQoNCgkJVGVtcGxhdGVUYWdzRGljLlJlbW92ZUFsbA0KCQlUZW1wbGF0ZURpYy5SZW1vdmVBbGwNCg0KCQlBcHBsaWNhdGlvbi5Mb2NrDQoJCVRlbXBsYXRlVGFnc05hbWU9QXBwbGljYXRpb24oWkNfQkxPR19DTFNJRCAmICJUZW1wbGF0ZVRhZ3NOYW1lIikNCgkJVGVtcGxhdGVUYWdzVmFsdWU9QXBwbGljYXRpb24oWkNfQkxPR19DTFNJRCAmICJUZW1wbGF0ZVRhZ3NWYWx1ZSIpDQoNCgkJVGVtcGxhdGVzTmFtZT1BcHBsaWNhdGlvbihaQ19CTE9HX0NMU0lEICYgIlRlbXBsYXRlc05hbWUiKQ0KCQlUZW1wbGF0ZXNDb250ZW50PUFwcGxpY2F0aW9uKFpDX0JMT0dfQ0xTSUQgJiAiVGVtcGxhdGVzQ29udGVudCIpDQoJCUFwcGxpY2F0aW9uLlVuTG9jaw0KDQoJCWpqPVVCb3VuZChUZW1wbGF0ZXNOYW1lKQ0KCQlGb3IgaWk9MCB0byBqag0KCQkJSWYgVGVtcGxhdGVEaWMuRXhpc3RzKFRlbXBsYXRlc05hbWUoaWkpKT1GYWxzZSBUaGVuIFRlbXBsYXRlRGljLkFkZCBUZW1wbGF0ZXNOYW1lKGlpKSwgVGVtcGxhdGVzQ29udGVudChpaSkNCgkJTmV4dA0KDQoJCWpqPVVCb3VuZChUZW1wbGF0ZVRhZ3NOYW1lKQ0KCQlGb3IgaWk9MCB0byBqag0KCQkJSWYgVGVtcGxhdGVUYWdzRGljLkV4aXN0cyhUZW1wbGF0ZVRhZ3NOYW1lKGlpKSk9RmFsc2UgVGhlbiBUZW1wbGF0ZVRhZ3NEaWMuQWRkIFRlbXBsYXRlVGFnc05hbWUoaWkpLCBUZW1wbGF0ZVRhZ3NWYWx1ZShpaSkNCgkJTmV4dA0KDQoJCSdDYWxsIExvYWREZWZhdWx0VGVtcGxhdGVzKCkNCg0KCQlJZiBJc0VtcHR5KFRlbXBsYXRlVGFnc1ZhbHVlKT1GYWxzZSBBbmQgSXNFbXB0eShUZW1wbGF0ZVRhZ3NWYWx1ZSk9RmFsc2UgQW5kIElzRW1wdHkoVGVtcGxhdGVzTmFtZSk9RmFsc2UgQW5kIElzRW1wdHkoVGVtcGxhdGVzQ29udGVudCk9RmFsc2UgVGhlbg0KCQkJRXhpdCBGdW5jdGlvbg0KCQlFbmQgSWYNCglFbmQgSWYNCg0KCURpbSBpLGoNCg0KCSfliqDovb3mqKHmnb8NCglEaW0gb2JqU3RyZWFtDQoJRGltIHN0ckNvbnRlbnQNCg0KDQoJRGltIGFyeVRlbXBsYXRlc05hbWUoKQ0KCURpbSBhcnlUZW1wbGF0ZXNDb250ZW50KCkNCg0KCSfor7vlj5ZUZW1wbGF0ZeebruW9leS4i+eahOaJgOacieaWh+S7tuW5tuWGmeWFpUNhY2hlDQoJRGltIGFyeUZpbGVMaXN0DQoJRGltIGFyeUZpbGVOYW1lVGVtcGxhdGUoKQ0KCURpbSBhcnlGaWxlTmFtZVRlbXBsYXRlX1ZhcmlhYmxlKCkNCg0KCWFyeUZpbGVMaXN0PUxvYWRJbmNsdWRlRmlsZXNPbmx5VHlwZSgiemJfdXNlcnNcdGhlbWUiICYgIi8iICYgWkNfQkxPR19USEVNRSAmICIvIiAmIFpDX1RFTVBMQVRFX0RJUkVDVE9SWSkNCg0KCUlmIElzQXJyYXkoYXJ5RmlsZUxpc3QpIFRoZW4NCg0KCQlqPVVCb3VuZChhcnlGaWxlTGlzdCkNCg0KCQlJZiBqPjAgVGhlbg0KDQoJCQlSZURpbSBhcnlGaWxlTmFtZVRlbXBsYXRlKGopDQoJCQlSZURpbSBhcnlGaWxlTmFtZVRlbXBsYXRlX1ZhcmlhYmxlKGopDQoNCgkJCVJlRGltIFByZXNlcnZlIGFyeVRlbXBsYXRlc05hbWUoaikNCgkJCVJlRGltIFByZXNlcnZlIGFyeVRlbXBsYXRlc0NvbnRlbnQoaikNCg0KCQkJRm9yIGk9MSB0byBqDQoNCgkJCQlhcnlGaWxlTmFtZVRlbXBsYXRlKGkpPSJ0aGVtZSIgJiAiLyIgJiBaQ19CTE9HX1RIRU1FICYgIi8iICYgWkNfVEVNUExBVEVfRElSRUNUT1JZICYgIi8iICYgYXJ5RmlsZUxpc3QoaSkNCgkJCQlhcnlGaWxlTmFtZVRlbXBsYXRlX1ZhcmlhYmxlKGkpPSJURU1QTEFURV8iICYgVUNhc2UoTGVmdChhcnlGaWxlTGlzdChpKSxJblN0cihhcnlGaWxlTGlzdChpKSwiLiIpLTEpKQ0KCQkJCUlmIEluU3RyKGFyeUZpbGVMaXN0KGkpLCIuIik9MCBUaGVuDQoJCQkJCWFyeUZpbGVOYW1lVGVtcGxhdGVfVmFyaWFibGUoaSk9IlRFTVBMQVRFXyIgJiBVQ2FzZShhcnlGaWxlTGlzdChpKSkNCgkJCQlFbmQgSWYNCgkJCQlhcnlUZW1wbGF0ZXNOYW1lKGkpPWFyeUZpbGVOYW1lVGVtcGxhdGVfVmFyaWFibGUoaSkNCg0KCQkJCXN0ckNvbnRlbnQ9IiINCgkJCQlzdHJDb250ZW50PUxvYWRGcm9tRmlsZShCbG9nUGF0aCAmICJ6Yl91c2Vyc1wiICYgYXJ5RmlsZU5hbWVUZW1wbGF0ZShpKSwidXRmLTgiKQ0KDQoJCQkJYXJ5VGVtcGxhdGVzQ29udGVudChpKT1zdHJDb250ZW50DQoJCQlOZXh0DQoNCgkJCSflnKjmqKHmnb/mlofku7bkuK3lhYjmm7/mjaLlvZPliY3mqKHniYjlhoXnmoTmlofku7bmoIfnrb4NCgkJCUZvciBpPTEgVG8gVUJvdW5kKGFyeVRlbXBsYXRlc05hbWUpDQoJCQkJRm9yIGo9MSB0byBVQm91bmQoYXJ5VGVtcGxhdGVzTmFtZSkNCgkJCQkJYXJ5VGVtcGxhdGVzQ29udGVudChpKT1SZXBsYWNlKGFyeVRlbXBsYXRlc0NvbnRlbnQoaSksIjwjIithcnlUZW1wbGF0ZXNOYW1lKGopKyIjPiIsYXJ5VGVtcGxhdGVzQ29udGVudChqKSkNCgkJCQlOZXh0DQoJCQkJYXJ5VGVtcGxhdGVzQ29udGVudChpKT1SZXBsYWNlKGFyeVRlbXBsYXRlc0NvbnRlbnQoaSksIjwjWkNfQkxPR19IT1NUIz50aGVtZXMvIiwiPCNaQ19CTE9HX0hPU1QjPnpiX3VzZXJzL3RoZW1lLyIpDQoJCQlOZXh0DQoJCQlqPVVCb3VuZChhcnlGaWxlTGlzdCkNCg0KCQlFbHNlDQoJCQlqPTANCgkJRW5kIElmDQoNCglFbmQgSWYNCg0KDQoJJ+ivu+WPlkNhY2hl55uu5b2V5LiL55qE5omA5pyJ5L6n5qCP5paH5Lu25bm25YaZ5YWlQ2FjaGUNCg0KCVJlRGltIFByZXNlcnZlIGFyeVRlbXBsYXRlc05hbWUoais1KQ0KCVJlRGltIFByZXNlcnZlIGFyeVRlbXBsYXRlc0NvbnRlbnQoais1KQ0KDQoNCglhcnlUZW1wbGF0ZXNOYW1lKGorMSk9IkNBQ0hFX1NJREVCQVIiDQoJYXJ5VGVtcGxhdGVzTmFtZShqKzIpPSJDQUNIRV9TSURFQkFSMiINCglhcnlUZW1wbGF0ZXNOYW1lKGorMyk9IkNBQ0hFX1NJREVCQVIzIg0KCWFyeVRlbXBsYXRlc05hbWUoais0KT0iQ0FDSEVfU0lERUJBUjQiDQoJYXJ5VGVtcGxhdGVzTmFtZShqKzUpPSJDQUNIRV9TSURFQkFSNSINCg0KCWFyeVRlbXBsYXRlc0NvbnRlbnQoaisxKT1Mb2FkRnJvbUZpbGUoQmxvZ1BhdGggJiAiemJfdXNlcnNcY2FjaGUiICYgIlxzaWRlYmFyLmFzcCIsInV0Zi04IiApDQoJYXJ5VGVtcGxhdGVzQ29udGVudChqKzIpPUxvYWRGcm9tRmlsZShCbG9nUGF0aCAmICJ6Yl91c2Vyc1xjYWNoZSIgJiAiXHNpZGViYXIyLmFzcCIsInV0Zi04IikNCglhcnlUZW1wbGF0ZXNDb250ZW50KGorMyk9TG9hZEZyb21GaWxlKEJsb2dQYXRoICYgInpiX3VzZXJzXGNhY2hlIiAmICJcc2lkZWJhcjMuYXNwIiwidXRmLTgiKQ0KCWFyeVRlbXBsYXRlc0NvbnRlbnQoais0KT1Mb2FkRnJvbUZpbGUoQmxvZ1BhdGggJiAiemJfdXNlcnNcY2FjaGUiICYgIlxzaWRlYmFyNC5hc3AiLCJ1dGYtOCIpDQoJYXJ5VGVtcGxhdGVzQ29udGVudChqKzUpPUxvYWRGcm9tRmlsZShCbG9nUGF0aCAmICJ6Yl91c2Vyc1xjYWNoZSIgJiAiXHNpZGViYXI1LmFzcCIsInV0Zi04IikNCg0KDQoJJ+WKoOi9veagh+etvg0KCURpbSBhLGIsYyxkLGUsYTIsYTMsZg0KCURpbSB0KCkNCglEaW0gcygpDQoNCglhPTANCgliPTI0DQoJYz0xDQoJZD0zNTANCgllPTANCglhMj0wDQoJYTM9MA0KCWY9MQ0KDQoJJ+ivu+WPllRFTVBMQVRF5LiL55qESW5jbHVkZeebruW9leS4i+eahOaJgOacieaWh+S7tuW5tuWGmeWFpUNhY2hlDQoJJ0RpbSBhcnlGaWxlTGlzdA0KCURpbSBhcnlGaWxlTmFtZVRlbXBsYXRlSW5jbHVkZSgpDQoJRGltIGFyeUZpbGVOYW1lVGVtcGxhdGVJbmNsdWRlX1ZhcmlhYmxlKCkNCg0KCWFyeUZpbGVMaXN0PUxvYWRJbmNsdWRlRmlsZXNPbmx5VHlwZSgiemJfdXNlcnNcdGhlbWUiICYgIi8iICYgWkNfQkxPR19USEVNRSAmICIvIiAmICJJTkNMVURFIikNCg0KCUlmIElzQXJyYXkoYXJ5RmlsZUxpc3QpIFRoZW4NCg0KCQllPVVCb3VuZChhcnlGaWxlTGlzdCkNCg0KCQlJZiBlPjAgVGhlbg0KDQoJCQlSZURpbSBhcnlGaWxlTmFtZVRlbXBsYXRlSW5jbHVkZShlKQ0KCQkJUmVEaW0gYXJ5RmlsZU5hbWVUZW1wbGF0ZUluY2x1ZGVfVmFyaWFibGUoZSkNCgkJCVJlRGltIGFyeUZpbGVOYW1lVGVtcGxhdGVJbmNsdWRlX0NvbnRlbnQoZSkNCgkJCVJlRGltIHMoZSkNCgkJCVJlRGltIFByZXNlcnZlIGFyeVRlbXBsYXRlVGFnc05hbWUoZSkNCgkJCVJlRGltIFByZXNlcnZlIGFyeVRlbXBsYXRlVGFnc1ZhbHVlKGUpDQoNCgkJCUZvciBpPTEgdG8gZQ0KDQoJCQkJYXJ5RmlsZU5hbWVUZW1wbGF0ZUluY2x1ZGUoaSk9InRoZW1lIiAmICIvIiAmIFpDX0JMT0dfVEhFTUUgJiAiLyIgJiAiSU5DTFVERSIgJiAiLyIgJiBhcnlGaWxlTGlzdChpKQ0KCQkJCWFyeUZpbGVOYW1lVGVtcGxhdGVJbmNsdWRlX1ZhcmlhYmxlKGkpPSJURU1QTEFURV9JTkNMVURFXyIgJiBVQ2FzZShMZWZ0KGFyeUZpbGVMaXN0KGkpLEluU3RyKGFyeUZpbGVMaXN0KGkpLCIuIiktMSkpDQoJCQkJSWYgSW5TdHIoYXJ5RmlsZUxpc3QoaSksIi4iKT0wIFRoZW4NCgkJCQkJYXJ5RmlsZU5hbWVUZW1wbGF0ZUluY2x1ZGVfVmFyaWFibGUoaSk9IlRFTVBMQVRFX0lOQ0xVREVfIiAmIFVDYXNlKGFyeUZpbGVMaXN0KGkpKQ0KCQkJCUVuZCBJZg0KDQoJCQkJcyhpKT1hcnlGaWxlTmFtZVRlbXBsYXRlSW5jbHVkZV9WYXJpYWJsZShpKQ0KDQoJCQkJc3RyQ29udGVudD0iIg0KCQkJCXN0ckNvbnRlbnQ9TG9hZEZyb21GaWxlKEJsb2dQYXRoICYgInpiX3VzZXJzXCIgJiBhcnlGaWxlTmFtZVRlbXBsYXRlSW5jbHVkZShpKSwidXRmLTgiKQ0KCQkJCXN0ckNvbnRlbnQ9UmVwbGFjZShzdHJDb250ZW50LCI8IiYiJT1aQ19CTE9HX0hPU1QlIiYiPiIsIjwjWkNfQkxPR19IT1NUIz4iKQ0KDQoJCQkJYXJ5RmlsZU5hbWVUZW1wbGF0ZUluY2x1ZGVfQ29udGVudChpKT1zdHJDb250ZW50DQoNCgkJCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKGkpPXMoaSkNCgkJCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZShpKT1hcnlGaWxlTmFtZVRlbXBsYXRlSW5jbHVkZV9Db250ZW50KGkpDQoJCQlOZXh0DQoNCgkJRWxzZQ0KCQkJZT0wDQoJCUVuZCBJZg0KDQoJRW5kIElmDQoNCg0KCSfor7vlj5ZJbmNsdWRl55uu5b2V5LiL55qE5omA5pyJ5paH5Lu25bm25YaZ5YWlQ2FjaGUNCgknRGltIGFyeUZpbGVMaXN0DQoJRGltIGFyeUZpbGVOYW1lSW5jbHVkZSgpDQoJRGltIGFyeUZpbGVOYW1lSW5jbHVkZV9WYXJpYWJsZSgpDQoJRGltIGFyeUZpbGVOYW1lSW5jbHVkZV9Db250ZW50KCkNCg0KCWFyeUZpbGVMaXN0PUxvYWRJbmNsdWRlRmlsZXNPbmx5VHlwZSgiemJfdXNlcnNcSU5DTFVERSIpDQoNCglJZiBJc0FycmF5KGFyeUZpbGVMaXN0KSBUaGVuDQoNCgkJYT1VQm91bmQoYXJ5RmlsZUxpc3QpDQoJCQ0KCQlJZiBhPjAgVGhlbg0KDQoJCQlSZURpbSBhcnlGaWxlTmFtZUluY2x1ZGUoYSkNCgkJCVJlRGltIGFyeUZpbGVOYW1lSW5jbHVkZV9WYXJpYWJsZShhKQ0KCQkJUmVEaW0gYXJ5RmlsZU5hbWVJbmNsdWRlX0NvbnRlbnQoYSkNCgkJCVJlRGltIHMoYSkNCgkJCVJlRGltIFByZXNlcnZlIGFyeVRlbXBsYXRlVGFnc05hbWUoZSthKQ0KCQkJUmVEaW0gUHJlc2VydmUgYXJ5VGVtcGxhdGVUYWdzVmFsdWUoZSthKQ0KDQoJCQlGb3IgaT0xIHRvIGENCg0KCQkJCWFyeUZpbGVOYW1lSW5jbHVkZShpKT0iSU5DTFVERS8iICYgYXJ5RmlsZUxpc3QoaSkNCgkJCQlhcnlGaWxlTmFtZUluY2x1ZGVfVmFyaWFibGUoaSk9IkNBQ0hFX0lOQ0xVREVfIiAmIFVDYXNlKExlZnQoYXJ5RmlsZUxpc3QoaSksSW5TdHIoYXJ5RmlsZUxpc3QoaSksIi4iKS0xKSkNCgkJCQlJZiBJblN0cihhcnlGaWxlTGlzdChpKSwiLiIpPTAgVGhlbg0KCQkJCQlhcnlGaWxlTmFtZUluY2x1ZGVfVmFyaWFibGUoaSk9IkNBQ0hFX0lOQ0xVREVfIiAmIFVDYXNlKGFyeUZpbGVMaXN0KGkpKQ0KCQkJCUVuZCBJZg0KDQoJCQkJcyhpKT1hcnlGaWxlTmFtZUluY2x1ZGVfVmFyaWFibGUoaSkNCg0KCQkJCXN0ckNvbnRlbnQ9IiINCgkJCQlzdHJDb250ZW50PUxvYWRGcm9tRmlsZShCbG9nUGF0aCAmICJ6Yl91c2Vyc1wiICYgYXJ5RmlsZU5hbWVJbmNsdWRlKGkpLCJ1dGYtOCIpDQoJCQkJc3RyQ29udGVudD1SZXBsYWNlKHN0ckNvbnRlbnQsIjwiJiIlPVpDX0JMT0dfSE9TVCUiJiI+IiwiPCNaQ19CTE9HX0hPU1QjPiIpDQoJCQkJYXJ5RmlsZU5hbWVJbmNsdWRlX0NvbnRlbnQoaSk9c3RyQ29udGVudA0KDQoJCQkJYXJ5VGVtcGxhdGVUYWdzTmFtZShlK2kpPXMoaSkNCgkJCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZShlK2kpPWFyeUZpbGVOYW1lSW5jbHVkZV9Db250ZW50KGkpDQoNCgkJCU5leHQNCg0KDQoJCQlhMj1hDQoJCQlSZURpbSBQcmVzZXJ2ZSBhcnlUZW1wbGF0ZVRhZ3NOYW1lKGUrYSthMikNCgkJCVJlRGltIFByZXNlcnZlIGFyeVRlbXBsYXRlVGFnc1ZhbHVlKGUrYSthMikNCg0KCQkJRm9yIGk9MSB0byBhDQoNCgkJCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKGUraSthKT1hcnlGaWxlTmFtZUluY2x1ZGVfVmFyaWFibGUoaSkgJiAiX0pTIg0KDQoJCQkJRGltIG1vZG5hbWUNCgkJCQltb2RuYW1lPUxDYXNlKFJlcGxhY2UoYXJ5RmlsZU5hbWVJbmNsdWRlX1ZhcmlhYmxlKGkpLCJDQUNIRV9JTkNMVURFXyIsIiIpKQ0KDQoJCQkJRGltIGZ1bmN0aW9uc3R5cGUNCg0KCQkJCVNldCBmdW5jdGlvbnN0eXBlPU5ldyBUTWV0YQ0KCQkJCWZ1bmN0aW9uc3R5cGUuTG9hZFN0cmluZz1Mb2FkRnJvbUZpbGUoQmxvZ1BhdGggJiAiemJfdXNlcnNcY2FjaGVcZnVuY3Rpb25zdHlwZS5hc3AiLCJ1dGYtOCIpDQoJCQkJDQoJCQkJDQoJCQkJSWYgZnVuY3Rpb25zdHlwZS5HZXRWYWx1ZShtb2RuYW1lKT0iZGl2IiBUaGVuDQoJCQkJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKGUraSthKT0iPGRpdiBpZD0iIm1vZF8iK21vZG5hbWUrIiIiIHN0eWxlPSIiZGlzcGxheTpub25lOyIiPjxzY3JpcHQgdHlwZT0iInRleHQvamF2YXNjcmlwdCIiPkxvYWRGdW5jdGlvbignIiZtb2RuYW1lJiInKTs8L3NjcmlwdD48L2Rpdj4iDQoJCQkJRWxzZQ0KCQkJCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZShlK2krYSk9IjxsaSBpZD0iIm1vZF8iK21vZG5hbWUrIiIiIHN0eWxlPSIiZGlzcGxheTpub25lOyIiPjxzY3JpcHQgdHlwZT0iInRleHQvamF2YXNjcmlwdCIiPkxvYWRGdW5jdGlvbignIiZtb2RuYW1lJiInKTs8L3NjcmlwdD48L2xpPiINCgkJCQlFbmQgSWYNCg0KCQkJTmV4dA0KDQoJCQlhMz1hDQoJCQlSZURpbSBQcmVzZXJ2ZSBhcnlUZW1wbGF0ZVRhZ3NOYW1lKGUrYSthMithMykNCgkJCVJlRGltIFByZXNlcnZlIGFyeVRlbXBsYXRlVGFnc1ZhbHVlKGUrYSthMithMykNCg0KCQkJRm9yIGk9MSB0byBhDQoJCQkJYXJ5VGVtcGxhdGVUYWdzTmFtZShlK2krYSthMik9YXJ5RmlsZU5hbWVJbmNsdWRlX1ZhcmlhYmxlKGkpICYgIl9IVE1MIg0KCQkJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKGUraSthK2EyKT1hcnlGaWxlTmFtZUluY2x1ZGVfQ29udGVudChpKQ0KCQkJTmV4dA0KDQoJCUVsc2UNCgkJCWE9MA0KCQlFbmQgSWYNCg0KCUVuZCBJZg0KDQoNCglSZURpbSBQcmVzZXJ2ZSBhcnlUZW1wbGF0ZVRhZ3NOYW1lKGErYTIrYTMrZStkKQ0KCVJlRGltIFByZXNlcnZlIGFyeVRlbXBsYXRlVGFnc1ZhbHVlKGErYTIrYTMrZStkKQ0KCUZvciBqPTEgdG8gZA0KCQlpPVJpZ2h0KCIwMDAiICYgQ1N0cihqKSwzKQ0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKGErYTIrYTMrZStqKT0iWkNfTVNHIiAmIGkNCgkJQ2FsbCBFeGVjdXRlKCJhcnlUZW1wbGF0ZVRhZ3NWYWx1ZShhK2EyK2EzK2Uraik9WkNfTVNHIiAmIGkpDQoJTmV4dA0KDQoNCglSZURpbSB0KGIpDQoJdCgxKT0iWkNfQkxPR19WRVJTSU9OIg0KCXQoMik9IlpDX0JMT0dfTEFOR1VBR0UiDQoJdCgzKT0iWkNfQkxPR19USVRMRSINCgl0KDQpPSJaQ19CTE9HX1NVQlRJVExFIg0KCXQoNSk9IlpDX0JMT0dfTkFNRSINCgl0KDYpPSJaQ19CTE9HX1NVQl9OQU1FIg0KCXQoNyk9IlpDX0JMT0dfVEhFTUUiDQoJdCg4KT0iWkNfQkxPR19DU1MiDQoJdCg5KT0iWkNfQkxPR19DT1BZUklHSFQiDQoJdCgxMCk9IlpDX0JMT0dfTUFTVEVSIg0KCXQoMTEpPSJaQ19DT05URU5UX01BWCINCgl0KDEyKT0iWkNfRU1PVElDT05TX0ZJTEVOQU1FIg0KCXQoMTMpPSJaQ19FTU9USUNPTlNfRklMRVNJWkUiDQoJdCgxNCk9IlpDX0VNT1RJQ09OU19GSUxFVFlQRSINCgl0KDE1KT0iWkNfR1VFU1RCT09LX0NPTlRFTlQiDQoJdCgxNik9IlpDX0JMT0dfQ0xTSUQiDQoJdCgxNyk9IlpDX1RJTUVfWk9ORSINCgl0KDE4KT0iWkNfSE9TVF9USU1FX1pPTkUiDQoJdCgxOSk9IlpDX1ZFUklGWUNPREVfV0lEVEgiDQoJdCgyMCk9IlpDX1ZFUklGWUNPREVfSEVJR0hUIg0KCXQoMjEpPSJaQ19CTE9HX0hPU1QiDQoJdCgyMik9IlpDX0JMT0dfUFJPRFVDVCINCgl0KDIzKT0iWkNfQkxPR19QUk9EVUNUX0ZVTEwiDQoJdCgyNCk9IlpDX0JMT0dfUFJPRFVDVF9GVUxMSFRNTCINCg0KCQ0KCVJlRGltIFByZXNlcnZlIGFyeVRlbXBsYXRlVGFnc05hbWUoYSthMithMytlK2QrYikNCglSZURpbSBQcmVzZXJ2ZSBhcnlUZW1wbGF0ZVRhZ3NWYWx1ZShhK2EyK2EzK2UrZCtiKQ0KCUZvciBqPTEgdG8gYg0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKGErYTIrYTMrZStkK2opPXQoaikNCgkJQ2FsbCBFeGVjdXRlKCJhcnlUZW1wbGF0ZVRhZ3NWYWx1ZShhK2EyK2EzK2UrZCtqKT0iJiB0KGopKQ0KCU5leHQNCg0KCVJlRGltIFByZXNlcnZlIGFyeVRlbXBsYXRlVGFnc05hbWUoYSthMithMytlK2QrYitjKQ0KCVJlRGltIFByZXNlcnZlIGFyeVRlbXBsYXRlVGFnc1ZhbHVlKGErYTIrYTMrZStkK2IrYykNCglhcnlUZW1wbGF0ZVRhZ3NOYW1lKGErYTIrYTMrZStkK2IrYyk9IkJMT0dfQ1JFQVRFX1RJTUUiDQoJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoYSthMithMytlK2QrYitjKT1HZXRUaW1lKE5vdygpKQ0KDQoJUmVEaW0gUHJlc2VydmUgYXJ5VGVtcGxhdGVUYWdzTmFtZShhK2EyK2EzK2UrZCtiK2MrZikNCglSZURpbSBQcmVzZXJ2ZSBhcnlUZW1wbGF0ZVRhZ3NWYWx1ZShhK2EyK2EzK2UrZCtiK2MrZikNCg0KCWFyeVRlbXBsYXRlVGFnc05hbWUoYSthMithMytlK2QrYitjK2YpPSJDQUNIRV9JTkNMVURFX0NBTEVOREFSX05PVyINCglhcnlUZW1wbGF0ZVRhZ3NWYWx1ZShhK2EyK2EzK2UrZCtiK2MrZik9IiINCg0KDQoNCglBcHBsaWNhdGlvbi5Mb2NrDQoJQXBwbGljYXRpb24oWkNfQkxPR19DTFNJRCAmICJURU1QTEFURU1PRElGSUVEIik9Q2hlY2tUZW1wbGF0ZU1vZGlmaWVkKCkNCglBcHBsaWNhdGlvbi5VbkxvY2sNCg0KCUFwcGxpY2F0aW9uLkxvY2sNCglBcHBsaWNhdGlvbihaQ19CTE9HX0NMU0lEICYgIlNJR05BTF9SRUxPQURDQUNIRSIpPWJvbFJlTG9hZENhY2hlDQoJQXBwbGljYXRpb24uVW5Mb2NrDQoNCg0KCVRlbXBsYXRlVGFnc0RpYy5SZW1vdmVBbGwNCglUZW1wbGF0ZURpYy5SZW1vdmVBbGwNCglUZW1wbGF0ZVRhZ3NEaWMuYWRkICJCbG9nVGl0bGUiLCIiDQoNCglqaj1VQm91bmQoYXJ5VGVtcGxhdGVzTmFtZSkNCglGb3IgaWk9MSB0byBqag0KCQlJZiBUZW1wbGF0ZURpYy5FeGlzdHMoYXJ5VGVtcGxhdGVzTmFtZShpaSkpPUZhbHNlIFRoZW4gVGVtcGxhdGVEaWMuQWRkIGFyeVRlbXBsYXRlc05hbWUoaWkpLCBhcnlUZW1wbGF0ZXNDb250ZW50KGlpKQ0KCU5leHQNCg0KCWpqPVVCb3VuZChhcnlUZW1wbGF0ZVRhZ3NOYW1lKQ0KCUZvciBpaT0xIHRvIGpqDQoJCUlmIFRlbXBsYXRlVGFnc0RpYy5FeGlzdHMoYXJ5VGVtcGxhdGVUYWdzTmFtZShpaSkpPUZhbHNlIFRoZW4gVGVtcGxhdGVUYWdzRGljLkFkZCBhcnlUZW1wbGF0ZVRhZ3NOYW1lKGlpKSwgYXJ5VGVtcGxhdGVUYWdzVmFsdWUoaWkpDQoJTmV4dA0KDQoJQ2FsbCBMb2FkRGVmYXVsdFRlbXBsYXRlcygpDQoNCg0KCUFwcGxpY2F0aW9uLkxvY2sNCglBcHBsaWNhdGlvbihaQ19CTE9HX0NMU0lEICYgIlRlbXBsYXRlVGFnc05hbWUiKT1UZW1wbGF0ZVRhZ3NEaWMuS2V5cw0KCUFwcGxpY2F0aW9uKFpDX0JMT0dfQ0xTSUQgJiAiVGVtcGxhdGVUYWdzVmFsdWUiKT1UZW1wbGF0ZVRhZ3NEaWMuSXRlbXMNCg0KDQoJQXBwbGljYXRpb24oWkNfQkxPR19DTFNJRCAmICJUZW1wbGF0ZXNOYW1lIik9VGVtcGxhdGVEaWMuS2V5cw0KCUFwcGxpY2F0aW9uKFpDX0JMT0dfQ0xTSUQgJiAiVGVtcGxhdGVzQ29udGVudCIpPVRlbXBsYXRlRGljLkl0ZW1zDQoNCglBcHBsaWNhdGlvbi5VbkxvY2sNCg0KDQoJU2V0IFRlbXBsYXRlc05hbWU9Tm90aGluZw0KCVNldCBUZW1wbGF0ZXNDb250ZW50PU5vdGhpbmcNCg0KCVNldCBUZW1wbGF0ZVRhZ3NOYW1lPU5vdGhpbmcNCglTZXQgVGVtcGxhdGVUYWdzVmFsdWU9Tm90aGluZw0KDQoJTG9hZEdsb2JlQ2FjaGU9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgQ2xlYXIgQ2FjaGUNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIENsZWFyR2xvYmVDYWNoZSgpDQoNCglBcHBsaWNhdGlvbi5Mb2NrDQoNCg0KCUFwcGxpY2F0aW9uKFpDX0JMT0dfQ0xTSUQgJiAiVGVtcGxhdGVUYWdzTmFtZSIpPUVtcHR5DQoJQXBwbGljYXRpb24oWkNfQkxPR19DTFNJRCAmICJUZW1wbGF0ZVRhZ3NWYWx1ZSIpPUVtcHR5DQoNCglBcHBsaWNhdGlvbihaQ19CTE9HX0NMU0lEICYgIlRlbXBsYXRlc05hbWUiKT1FbXB0eQ0KCUFwcGxpY2F0aW9uKFpDX0JMT0dfQ0xTSUQgJiAiVGVtcGxhdGVzQ29udGVudCIpPUVtcHR5DQoNCg0KCUFwcGxpY2F0aW9uKFpDX0JMT0dfQ0xTSUQgJiAiU0lHTkFMX1JFTE9BRENBQ0hFIik9RW1wdHkNCg0KCUFwcGxpY2F0aW9uKFpDX0JMT0dfQ0xTSUQgJiAiVEVNUExBVEVNT0RJRklFRCIpPUVtcHR5DQoNCglBcHBsaWNhdGlvbihaQ19CTE9HX0NMU0lEICYgIkNBQ0hFX0FSVElDTEVfVklFV0NPVU5UIik9RW1wdHkNCg0KCUFwcGxpY2F0aW9uLlVuTG9jaw0KDQoJQ2xlYXJHbG9iZUNhY2hlPVRydWUNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIFBhcnNlIFRhZyDlubbmoLzlvI/ljJYNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIFBhcnNlVGFnKHN0clRhZykNCg0KCURpbSBzDQoJRGltIHQNCglEaW0gaQ0KCURpbSBUYWcNCglEaW0gYg0KCURpbSBvYmpUYWcNCg0KCXN0clRhZz1UcmltKHN0clRhZykNCglzdHJUYWc9UmVwbGFjZShzdHJUYWcsIu+8jCIsIiwiKQ0KCXN0clRhZz1UcmFuc2ZlckhUTUwoc3RyVGFnLCJbbm9ybWFsdGFnXSIpDQoNCglJZiBzdHJUYWc9IiIgVGhlbiBQYXJzZVRhZz0iIjpFeGl0IEZ1bmN0aW9uDQoNCgl0PVNwbGl0KHN0clRhZywiLCIpDQoNCglDYWxsIEdldFRhZ3NieVRhZ05hbWVMaXN0KHN0clRhZykNCg0KCUZvciBpPUxCb3VuZCh0KSBUbyBVQm91bmQodCkNCgkJdChpKT1UcmltKHQoaSkpDQoJTmV4dA0KDQoJRm9yIGk9TEJvdW5kKHQpIFRvIFVCb3VuZCh0KQ0KDQoJCWI9RmFsc2UNCg0KCQlGb3IgRWFjaCBUYWcgaW4gVGFncw0KCQkJSWYgSXNPYmplY3QoVGFnKSBUaGVuDQoJCQkJSWYgVUNhc2UoVGFnLk5hbWUpPVVDYXNlKHQoaSkpIFRoZW4NCgkJCQkJYj1UcnVlDQoJCQkJRW5kIElmDQoJCQlFbmQgSWYNCgkJTmV4dA0KDQoJCUlmIGI9RmFsc2UgVGhlbg0KCQkJU2V0IG9ialRhZz1OZXcgVFRhZw0KCQkJb2JqVGFnLklEPTANCgkJCW9ialRhZy5OYW1lPXQoaSkNCgkJCW9ialRhZy5PcmRlcj0wDQoJCQlvYmpUYWcuSW50cm89IiINCgkJCUlmIG9ialRhZy5Qb3N0IFRoZW4NCgkJCQlSZURpbSBQcmVzZXJ2ZSBUYWdzKG9ialRhZy5JRCkNCgkJCQlTZXQgVGFncyhvYmpUYWcuSUQpPW9ialRhZw0KCQkJRW5kIElmDQoJCQlTZXQgb2JqVGFnPU5vdGhpbmcNCgkJRW5kIElmDQoNCglOZXh0DQoNCglGb3IgaT1MQm91bmQodCkgVG8gVUJvdW5kKHQpDQoJCUZvciBFYWNoIFRhZyBpbiBUYWdzDQoJCQlJZiBJc09iamVjdChUYWcpIFRoZW4NCgkJCQlJZiBVQ2FzZShUYWcuTmFtZSk9VUNhc2UodChpKSkgVGhlbg0KCQkJCQl0KGkpPSJ7IiZUYWcuSUQmIn0iDQoJCQkJRW5kIElmDQoJCQlFbmQgSWYNCgkJTmV4dA0KCU5leHQNCg0KCXM9Sm9pbih0KQ0KCXM9UmVwbGFjZShzLCIgIiwiIikNCg0KCVBhcnNlVGFnPXMNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIOW+l+WIsOWunumZheS4iueahEJMT0fnmoTnnJ/lrp7niannkIbnm67lvZUNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEdldFJlYWxseURpcmVjdG9yeSgpDQoNCglJZiBDdXJyZW50UmVhbGx5RGlyZWN0b3J5PD4iIiBUaGVuDQoJCUdldFJlYWxseURpcmVjdG9yeT1DdXJyZW50UmVhbGx5RGlyZWN0b3J5DQoJCUV4aXQgRnVuY3Rpb24NCglFbmQgSWYNCg0KCUlmIE5vdCBJc09iamVjdChQdWJsaWNPYmpGU08pIFRoZW4gU2V0IFB1YmxpY09iakZTTz1TZXJ2ZXIuQ3JlYXRlT2JqZWN0KCJTY3JpcHRpbmcuRmlsZVN5c3RlbU9iamVjdCIpDQoNCglEaW0gcAkNCglwPVNlcnZlci5NYXBQYXRoKCIuIikgJiAiXCINCg0KCUlmIFB1YmxpY09iakZTTy5Gb2xkZXJFeGlzdHMocCAmICJaQl9TWVNURU1cIikgVGhlbg0KCQlwPXANCglFbHNlSWYgUHVibGljT2JqRlNPLkZvbGRlckV4aXN0cyhwICYgIi4uXFpCX1NZU1RFTVwiKSBUaGVuDQoJCXA9cCAmICIuLlwiDQoJRWxzZUlmIFB1YmxpY09iakZTTy5Gb2xkZXJFeGlzdHMocCAmICIuLlwuLlxaQl9TWVNURU1cIikgVGhlbg0KCQlwPXAgJiAiLi5cLi5cIg0KCUVsc2VJZiBQdWJsaWNPYmpGU08uRm9sZGVyRXhpc3RzKHAgJiAiLi5cLi5cLi5cWkJfU1lTVEVNXCIpIFRoZW4NCgkJcD1wICYgIi4uXC4uXC4uXCINCglFbHNlSWYgUHVibGljT2JqRlNPLkZvbGRlckV4aXN0cyhwICYgIi4uXC4uXC4uXC4uXFpCX1NZU1RFTVwiKSBUaGVuDQoJCXA9cCAmICIuLlwuLlwuLlwuLlwiDQoJRWxzZUlmIFB1YmxpY09iakZTTy5Gb2xkZXJFeGlzdHMocCAmICIuLlwuLlwuLlwuLlwuLlxaQl9TWVNURU1cIikgVGhlbg0KCQlwPXAgJiAiLi5cLi5cLi5cLi5cLi5cIg0KCUVsc2VJZiBQdWJsaWNPYmpGU08uRm9sZGVyRXhpc3RzKHAgJiAiLi5cLi5cLi5cLi5cLi5cLi5cWkJfU1lTVEVNXCIpIFRoZW4NCgkJcD1wICYgIi4uXC4uXC4uXC4uXC4uXC4uXCINCglFbHNlSWYgUHVibGljT2JqRlNPLkZvbGRlckV4aXN0cyhwICYgIi4uXC4uXC4uXC4uXC4uXC4uXC4uXFpCX1NZU1RFTVwiKSBUaGVuDQoJCXA9cCAmICIuLlwuLlwuLlwuLlwuLlwuLlwuLlwiDQoJRW5kIElmDQoJU2V0IGZzbz1Ob3RoaW5nDQoNCglHZXRSZWFsbHlEaXJlY3Rvcnk9UHVibGljT2JqRlNPLkdldEZvbGRlcihwKS5QYXRoICYgIlwiDQoNCgknRXJyLkNsZWFyDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICDorr7nva7mj5DnpLrmoIflv5cNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIFNldEJsb2dIaW50KGJvbE9wZXJhdGVTdWNjZXNzLGJvbFJlYnVpbGRJbmRleCxib2xSZWJ1aWxkRmlsZXMpDQoNCglDYWxsIFNldEJsb2dIaW50V2l0aENMU0lEKGJvbE9wZXJhdGVTdWNjZXNzLGJvbFJlYnVpbGRJbmRleCxib2xSZWJ1aWxkRmlsZXMsWkNfQkxPR19DTFNJRCkNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIOiuvue9ruaPkOekuuiHquWumuS5ieagh+W/lw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gU2V0QmxvZ0hpbnRfQ3VzdG9tKHN0ckluZm8pDQoNCglBcHBsaWNhdGlvbi5Mb2NrDQoNCglBcHBsaWNhdGlvbihaQ19CTE9HX0NMU0lEICYgQmxvZ1VzZXIuSUQgJiAiU0lHTkFMX09QRVJBVEVJTkZPIik9QXBwbGljYXRpb24oWkNfQkxPR19DTFNJRCAmIEJsb2dVc2VyLklEICYgIlNJR05BTF9PUEVSQVRFSU5GTyIpICYgdmJDcmxmICYgIHN0ckluZm8NCg0KCUFwcGxpY2F0aW9uLlVuTG9jaw0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAg6K6+572u5o+Q56S65qCH5b+Xd2l0aENMU0lEDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBTZXRCbG9nSGludFdpdGhDTFNJRChib2xPcGVyYXRlU3VjY2Vzcyxib2xSZWJ1aWxkSW5kZXgsYm9sUmVidWlsZEZpbGVzLG5ld0NMU0lEKQ0KDQoJQXBwbGljYXRpb24uTG9jaw0KDQoJQXBwbGljYXRpb24obmV3Q0xTSUQgICYgQmxvZ1VzZXIuSUQgJiAiU0lHTkFMX09QRVJBVEVTVUNDRVNTIik9Ym9sT3BlcmF0ZVN1Y2Nlc3MNCg0KCUlmIElzRW1wdHkoYm9sUmVidWlsZEluZGV4KT1GYWxzZSBUaGVuDQoJCUFwcGxpY2F0aW9uKG5ld0NMU0lEICYgIlNJR05BTF9SRUJVSUxESU5ERVgiKT1ib2xSZWJ1aWxkSW5kZXgNCglFbmQgSWYNCg0KCUlmIElzRW1wdHkoYm9sUmVidWlsZEZpbGVzKT1GYWxzZSBUaGVuDQoJCUFwcGxpY2F0aW9uKG5ld0NMU0lEICYgIlNJR05BTF9SRUJVSUxERklMRVMiKT1ib2xSZWJ1aWxkRmlsZXMNCglFbmQgSWYNCg0KCUFwcGxpY2F0aW9uLlVuTG9jaw0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAg6L6T5Ye65o+Q56S6DQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBHZXRCbG9nSGludCgpDQoNCglEaW0gYm9sT3BlcmF0ZVN1Y2Nlc3MsYm9sUmVidWlsZEluZGV4LGJvbFJlYnVpbGRGaWxlcyxzdHJPcGVyYXRlSW5mbw0KDQoJQXBwbGljYXRpb24uTG9jaw0KCWJvbE9wZXJhdGVTdWNjZXNzPUFwcGxpY2F0aW9uKFpDX0JMT0dfQ0xTSUQgJiBCbG9nVXNlci5JRCAmICJTSUdOQUxfT1BFUkFURVNVQ0NFU1MiKQ0KCWJvbFJlYnVpbGRJbmRleD1BcHBsaWNhdGlvbihaQ19CTE9HX0NMU0lEICYgIlNJR05BTF9SRUJVSUxESU5ERVgiKQ0KCWJvbFJlYnVpbGRGaWxlcz1BcHBsaWNhdGlvbihaQ19CTE9HX0NMU0lEICYgIlNJR05BTF9SRUJVSUxERklMRVMiKQ0KCXN0ck9wZXJhdGVJbmZvPUFwcGxpY2F0aW9uKFpDX0JMT0dfQ0xTSUQgJiBCbG9nVXNlci5JRCAmICJTSUdOQUxfT1BFUkFURUlORk8iKQ0KCUFwcGxpY2F0aW9uKFpDX0JMT0dfQ0xTSUQgJiBCbG9nVXNlci5JRCAmICJTSUdOQUxfT1BFUkFURUlORk8iKT1FbXB0eQ0KCUFwcGxpY2F0aW9uLlVuTG9jaw0KDQoNCglJZiBJc0VtcHR5KGJvbE9wZXJhdGVTdWNjZXNzKT1GYWxzZSBUaGVuDQoNCgkJSWYgYm9sT3BlcmF0ZVN1Y2Nlc3M9VHJ1ZSBUaGVuDQoJCQlSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0naGludCc+PHAgY2xhc3M9J2hpbnQgaGludF9ncmVlbic+PGZvbnQgY29sb3I9J2dyZWVuJz4iICYgWkNfTVNHMjY2ICYgIjwvZm9udD48L3A+PC9kaXY+Ig0KCQlFbmQgSWYNCg0KCQlJZiBib2xPcGVyYXRlU3VjY2Vzcz1GYWxzZSBUaGVuDQoJCQlSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0naGludCc+PHAgY2xhc3M9J2hpbnQgaGludF9yZWQnPjxmb250IGNvbG9yPSdyZWQnPiIgJiBaQ19NU0cyNjcgJiAiPC9mb250PjwvcD48L2Rpdj4iDQoJCUVuZCBJZg0KDQoJCUFwcGxpY2F0aW9uLkxvY2sNCgkJQXBwbGljYXRpb24oWkNfQkxPR19DTFNJRCAmIEJsb2dVc2VyLklEICYgIlNJR05BTF9PUEVSQVRFU1VDQ0VTUyIpPUVtcHR5DQoJCUFwcGxpY2F0aW9uLlVuTG9jaw0KDQoJRW5kIElmDQoNCglJZiBJc0VtcHR5KHN0ck9wZXJhdGVJbmZvKT1GYWxzZSBUaGVuDQoNCgkJRGltIHMsdA0KCQl0PVNwbGl0KHN0ck9wZXJhdGVJbmZvLHZiQ3JsZikNCg0KCQlGb3IgRWFjaCBzIEluIHQNCgkJCUlmIHM8PiIiIFRoZW4NCgkJCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSdoaW50Jz48cCBjbGFzcz0naGludCBoaW50X3RlYWwnPjxmb250IGNvbG9yPSdvcmFuZ2VyZWQnPiIgJiBzICYgIjwvZm9udD48L3A+PC9kaXY+Ig0KCQkJRW5kIElmDQoJCU5leHQNCg0KCUVuZCBJZg0KDQoNCglJZiBJc0VtcHR5KGJvbFJlYnVpbGRJbmRleCk9RmFsc2UgVGhlbg0KDQoJCUlmIGJvbFJlYnVpbGRJbmRleD1UcnVlIFRoZW4NCgkJCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSdoaW50Jz48cCBjbGFzcz0naGludCBoaW50X2JsdWUnPjxmb250IGNvbG9yPSdibHVlJz4iICYgWkNfTVNHMjY4ICYgIjwvZm9udD48L3A+PC9kaXY+Ig0KCQlFbmQgSWYNCg0KCUVuZCBJZg0KDQoJSWYgSXNFbXB0eShib2xSZWJ1aWxkRmlsZXMpPUZhbHNlIFRoZW4NCg0KCQlJZiBib2xSZWJ1aWxkRmlsZXM9VHJ1ZSBUaGVuDQoJCQlSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0naGludCc+PHAgY2xhc3M9J2hpbnQgaGludF9ibHVlJz48Zm9udCBjb2xvcj0nYmx1ZSc+IiAmIFJlcGxhY2UoWkNfTVNHMjY5LCIldSIsQmxvZ0hvc3QmInpiX3N5c3RlbS9jbWQuYXNwP2FjdD1Bc2tGaWxlUmVCdWlsZCIpICYgIjwvZm9udD48L3A+PC9kaXY+Ig0KCQlFbmQgSWYNCg0KCUVuZCBJZg0KDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICDop6PmnpAgUkVHRVggRm9yIFBhdGgNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIFBhcnNlQ3VzdG9tRGlyZWN0b3J5Rm9yUGF0aChzdHJSZWdleCxzdHJQb3N0LHN0ckNhdGVnb3J5LHN0clVzZXIsc3RyWWVhcixzdHJNb250aCxzdHJEYXksc3RySUQsc3RyTmFtZSxzdHJBbGlhcykNCglEaW0gcw0KCXM9UGFyc2VDdXN0b21EaXJlY3Rvcnkoc3RyUmVnZXgsc3RyUG9zdCxzdHJDYXRlZ29yeSxzdHJVc2VyLHN0clllYXIsc3RyTW9udGgsc3RyRGF5LHN0cklELHN0ck5hbWUsc3RyQWxpYXMpDQoJcz1SZXBsYWNlKHMsInslaG9zdCV9IixMZWZ0KEJsb2dQYXRoLExlbihCbG9nUGF0aCktMSkpDQoJUGFyc2VDdXN0b21EaXJlY3RvcnlGb3JQYXRoPVJlcGxhY2UocywiLyIsIlwiKQ0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIOino+aekCBSRUdFWCBGb3IgVXJsDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBQYXJzZUN1c3RvbURpcmVjdG9yeUZvclVybChzdHJSZWdleCxzdHJQb3N0LHN0ckNhdGVnb3J5LHN0clVzZXIsc3RyWWVhcixzdHJNb250aCxzdHJEYXksc3RySUQsc3RyTmFtZSxzdHJBbGlhcykNCglEaW0gcw0KCXM9UGFyc2VDdXN0b21EaXJlY3Rvcnkoc3RyUmVnZXgsc3RyUG9zdCxzdHJDYXRlZ29yeSxzdHJVc2VyLHN0clllYXIsc3RyTW9udGgsc3RyRGF5LHN0cklELHN0ck5hbWUsc3RyQWxpYXMpDQoJcz1SZXBsYWNlKHMsInslaG9zdCV9IixMZWZ0KEJsb2dIb3N0LExlbihCbG9nSG9zdCktMSkpDQoJUGFyc2VDdXN0b21EaXJlY3RvcnlGb3JVcmw9UmVwbGFjZShzLCJcIiwiLyIpDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAg6Kej5p6QWkNfQ1VTVE9NX0RJUkVDVE9SWV9SRUdFWA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gUGFyc2VDdXN0b21EaXJlY3Rvcnkoc3RyUmVnZXgsc3RyUG9zdCxzdHJDYXRlZ29yeSxzdHJVc2VyLHN0clllYXIsc3RyTW9udGgsc3RyRGF5LHN0cklELHN0ck5hbWUsc3RyQWxpYXMpDQoNCglPbiBFcnJvciBSZXN1bWUgTmV4dA0KDQoJRGltIHMsZA0KCXM9c3RyUmVnZXgNCg0KCWQ9c3RyWWVhcg0KCUlmIHN0ck1vbnRoPD4iIiBUaGVuDQoJCWQ9ZCAmICItIiAmIFJpZ2h0KCIwIiAmIHN0ck1vbnRoLDIpDQoJRW5kIElmDQoJSWYgc3RyRGF5PD4iIiBUaGVuDQoJCWQ9ZCAmICItIiAmIFJpZ2h0KCIwIiAmIHN0ckRheSwyKQ0KCUVuZCBJZg0KDQoJcz1SZXBsYWNlKHMsInslcG9zdCV9IixzdHJQb3N0KQ0KCXM9UmVwbGFjZShzLCJ7JWNhdGVnb3J5JX0iLHN0ckNhdGVnb3J5KQ0KCXM9UmVwbGFjZShzLCJ7JWF1dGhvciV9IixzdHJVc2VyKQ0KCXM9UmVwbGFjZShzLCJ7JXllYXIlfSIsc3RyWWVhcikNCglzPVJlcGxhY2UocywieyVtb250aCV9IixSaWdodCgiMCIgJiBzdHJNb250aCwyKSkNCglzPVJlcGxhY2UocywieyVkYXklfSIsUmlnaHQoIjAiICYgc3RyRGF5LDIpKQ0KCXM9UmVwbGFjZShzLCJ7JWlkJX0iLHN0cklEKQ0KCXM9UmVwbGFjZShzLCJ7JWFsaWFzJX0iLHN0ckFsaWFzKQ0KCXM9UmVwbGFjZShzLCJ7JW5hbWUlfSIsc3RyTmFtZSkNCglzPVJlcGxhY2UocywieyVkYXRlJX0iLGQpDQoNCglQYXJzZUN1c3RvbURpcmVjdG9yeT1zDQoNCglFcnIuQ2xlYXINCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIOaMieeFp0N1c3RvbURpcmVjdG9yeeaMh+ekuuWIm+W7uuebuOW6lOeahOebruW9lQ0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KU3ViIENyZWF0RGlyZWN0b3J5QnlDdXN0b21EaXJlY3RvcnlXaXRoRnVsbEJsb2dQYXRoKEJ5VmFsIHN0ckN1c3RvbURpcmVjdG9yeSkNCg0KCU9uIEVycm9yIFJlc3VtZSBOZXh0DQoNCglJZiBOb3QgSXNPYmplY3QoUHVibGljT2JqRlNPKSBUaGVuIFNldCBQdWJsaWNPYmpGU089U2VydmVyLkNyZWF0ZU9iamVjdCgiU2NyaXB0aW5nLkZpbGVTeXN0ZW1PYmplY3QiKQ0KCQ0KCURpbSBzDQoJRGltIHQNCglEaW0gaQ0KCURpbSBqDQoNCglzPUJsb2dQYXRoDQoNCglzdHJDdXN0b21EaXJlY3Rvcnk9UmVwbGFjZShzdHJDdXN0b21EaXJlY3RvcnksIi8iLCJcIikNCg0KCXN0ckN1c3RvbURpcmVjdG9yeT1SaWdodChzdHJDdXN0b21EaXJlY3RvcnksTGVuKHN0ckN1c3RvbURpcmVjdG9yeSktTGVuKEJsb2dQYXRoKSkNCg0KCXQ9U3BsaXQoc3RyQ3VzdG9tRGlyZWN0b3J5LCJcIikNCg0KCUZvciBpPUxCb3VuZCh0KSBUbyBVQm91bmQodCktMQ0KCQlJZiAoSXNFbXB0eSh0KGkpKT1GYWxzZSkgQW5kICh0KGkpPD4iIikgVGhlbg0KCQkJcz1zICYgdChpKSAmICJcIg0KCQkJSWYgKFB1YmxpY09iakZTTy5Gb2xkZXJFeGlzdHMocyk9RmFsc2UpIFRoZW4NCgkJCQlDYWxsIFB1YmxpY09iakZTTy5DcmVhdGVGb2xkZXIocykNCgkJCUVuZCBJZg0KCQlFbmQgSWYNCglOZXh0DQoNCg0KCUVyci5DbGVhcg0KDQpFbmQgU3ViDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICDmjInnhadDdXN0b21EaXJlY3RvcnnmjIfnpLrliJvlu7rnm7jlupTnmoTnm67lvZUNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNClN1YiBDcmVhdERpcmVjdG9yeUJ5Q3VzdG9tRGlyZWN0b3J5KEJ5VmFsIHN0ckN1c3RvbURpcmVjdG9yeSkNCg0KCU9uIEVycm9yIFJlc3VtZSBOZXh0DQoNCglJZiBOb3QgSXNPYmplY3QoUHVibGljT2JqRlNPKSBUaGVuIFNldCBQdWJsaWNPYmpGU089U2VydmVyLkNyZWF0ZU9iamVjdCgiU2NyaXB0aW5nLkZpbGVTeXN0ZW1PYmplY3QiKQ0KCQ0KCURpbSBzDQoJRGltIHQNCglEaW0gaQ0KCURpbSBqDQoNCglzPUJsb2dQYXRoDQoNCglzdHJDdXN0b21EaXJlY3Rvcnk9UmVwbGFjZShzdHJDdXN0b21EaXJlY3RvcnksIi8iLCJcIikNCg0KCXQ9U3BsaXQoc3RyQ3VzdG9tRGlyZWN0b3J5LCJcIikNCg0KCWo9MA0KCUZvciBpPUxCb3VuZCh0KSBUbyBVQm91bmQodCkNCgkJSWYgKElzRW1wdHkodChpKSk9RmFsc2UpIEFuZCAodChpKTw+IiIpIFRoZW4NCgkJCXM9cyAmIHQoaSkgJiAiXCINCgkJCUlmIChQdWJsaWNPYmpGU08uRm9sZGVyRXhpc3RzKHMpPUZhbHNlKSBUaGVuDQoJCQkJQ2FsbCBQdWJsaWNPYmpGU08uQ3JlYXRlRm9sZGVyKHMpDQoJCQlFbmQgSWYNCgkJCWo9aisxDQoJCUVuZCBJZg0KCU5leHQNCg0KCQ0KDQoJRXJyLkNsZWFyDQoNCkVuZCBTdWINCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogIOeUn+aIkOW3puS+p+WvvOiIquagjw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRGltIEFkbWluTGVmdE1lbnVDb3VudA0KQWRtaW5MZWZ0TWVudUNvdW50PTANCkZ1bmN0aW9uIE1ha2VMZWZ0TWVudShyZXF1aXJlTGV2ZWwsc3RyTmFtZSxzdHJVcmwsc3RyTGlJZCxzdHJBSWQsc3RySW1nVXJsKQ0KDQoJSWYgQmxvZ1VzZXIuTGV2ZWw+cmVxdWlyZUxldmVsIFRoZW4gRXhpdCBGdW5jdGlvbg0KDQoJQWRtaW5MZWZ0TWVudUNvdW50PUFkbWluTGVmdE1lbnVDb3VudCsxDQoJZGltIHRtcA0KCUlmIFRyaW0oc3RySW1nVXJsKTw+IiIgVGhlbg0KCQl0bXA9IjxsaSBpZD0iIiImc3RyTGlJZCYiIiI+PGEgaWQ9IiIiJnN0ckFJZCYiIiIgaHJlZj0iIiImc3RyVXJsJiIiIj48c3BhbiBzdHlsZT0iImJhY2tncm91bmQtaW1hZ2U6dXJsKCciJnN0ckltZ1VybCYiJykiIj4iJnN0ck5hbWUmIjwvc3Bhbj48L2E+PC9saT4iDQoJRWxzZQ0KCQl0bXA9IjxsaSBpZD0iIiImc3RyTGlJZCYiIiI+PGEgaWQ9IiIiJnN0ckFJZCYiIiIgaHJlZj0iIiImc3RyVXJsJiIiIj48c3Bhbj4iJnN0ck5hbWUmIjwvc3Bhbj48L2E+PC9saT4iDQoJRW5kIElmDQoJTWFrZUxlZnRNZW51PXRtcA0KCQ0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICDnlJ/miJDlpLTpg6joj5zljZUNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkRpbSBBZG1pblRvcE1lbnVDb3VudA0KQWRtaW5Ub3BNZW51Q291bnQ9MA0KRnVuY3Rpb24gTWFrZVRvcE1lbnUocmVxdWlyZUxldmVsLHN0ck5hbWUsc3RyVXJsLHN0ckxpSWQsc3RyVGFyZ2V0KQ0KDQoJSWYgQmxvZ1VzZXIuTGV2ZWw+cmVxdWlyZUxldmVsIFRoZW4gRXhpdCBGdW5jdGlvbg0KDQoJRGltIHRtcA0KCUlmIHN0clRhcmdldD0iIiBUaGVuIHN0clRhcmdldD0iX3NlbGYiDQoJQWRtaW5Ub3BNZW51Q291bnQ9QWRtaW5Ub3BNZW51Q291bnQrMQ0KCUlmIHN0ckxpSWQ9IiIgVGhlbiBzdHJMaUlkPSJ0b3BtZW51IiZBZG1pblRvcE1lbnVDb3VudA0KCXRtcD0iPGxpIGlkPSIiIiZzdHJMaUlkJiIiIj48YSBocmVmPSIiIiZzdHJVcmwmIiIiIHRhcmdldD0iIiImc3RyVGFyZ2V0JiIiIj4iJnN0ck5hbWUmIjwvYT48L2xpPiINCglNYWtlVG9wTWVudT10bXANCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miDliqDlhaXkuoznuqfoj5zljZXpobkNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIE1ha2VTdWJNZW51KHN0ck5hbWUsc3RyVXJsLHN0clR5cGUsaXNOZXdXaW5kb3dzKQ0KDQoJRGltIHN0clNvdXJjZQ0KDQoJc3RyU291cmNlPXN0clNvdXJjZSAmICI8YSAiICYgImhyZWY9IiIiICYgc3RyVXJsICAmICIiIiINCg0KCUlmIGlzTmV3V2luZG93cz1UcnVlIFRoZW4gc3RyU291cmNlPXN0clNvdXJjZSAmICIgdGFyZ2V0PSIiX2JsYW5rIiIiDQoNCglzdHJTb3VyY2U9c3RyU291cmNlICYgIj4iICYgIjxzcGFuIGNsYXNzPSIiIiAmIHN0clR5cGUgJiAiIiI+Ig0KDQoNCglzdHJTb3VyY2U9c3RyU291cmNlICYgc3RyTmFtZQ0KDQoJc3RyU291cmNlPXN0clNvdXJjZSAmICI8L3NwYW4+PC9hPiINCg0KCU1ha2VTdWJNZW51PXN0clNvdXJjZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJog5rOo5YaM5o+S5Lu25Ye95pWwDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBSZWdpc3RlclBsdWdpbihzdHJQbHVnaW5OYW1lLHN0clBsdWdpbkFjdGl2ZUZ1bmN0aW9uKQ0KDQoJRGltIGkNCglpPVVCb3VuZChQbHVnaW5OYW1lKQ0KDQoJUmVEaW0gUHJlc2VydmUgUGx1Z2luTmFtZShpKzEpDQoJUmVEaW0gUHJlc2VydmUgUGx1Z2luQWN0aXZlRnVuY3Rpb24oaSsxKQ0KDQoJUGx1Z2luTmFtZShpKT1zdHJQbHVnaW5OYW1lDQoJUGx1Z2luQWN0aXZlRnVuY3Rpb24oaSk9c3RyUGx1Z2luQWN0aXZlRnVuY3Rpb24NCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaIOa/gOa0u+aPkuS7tuWHveaVsA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRGltIElzUnVuQWN0aXZlUGx1Z2luDQpGdW5jdGlvbiBBY3RpdmVQbHVnaW4oKQ0KDQoJSWYgSXNSdW5BY3RpdmVQbHVnaW49VHJ1ZSBUaGVuIEV4aXQgRnVuY3Rpb24NCg0KCU9uIEVycm9yIFJlc3VtZSBOZXh0DQoNCglEaW0gaQ0KCUZvciBpPTAgVG8gVUJvdW5kKFBsdWdpbkFjdGl2ZUZ1bmN0aW9uKS0xDQoNCgkJQ2FsbCBFeGVjdXRlKFBsdWdpbkFjdGl2ZUZ1bmN0aW9uKGkpKQ0KDQoJTmV4dA0KDQoJRXJyLkNsZWFyDQoNCglJc1J1bkFjdGl2ZVBsdWdpbj1UcnVlDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miDlronoo4Xmj5Lku7blh73mlbDvvIzlj6rov5DooYzkuIDmrKENCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEluc3RhbGxQbHVnaW4oc3RyUGx1Z2luTmFtZSkNCglPbiBFcnJvciBSZXN1bWUgTmV4dA0KCUNhbGwgRXhlY3V0ZSgiQ2FsbCBJbnN0YWxsUGx1Z2luXyIgJiBzdHJQbHVnaW5OYW1lICYgIigpIikNCglFcnIuQ2xlYXINCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miDliKDpmaTmj5Lku7blh73mlbDvvIzlj6rov5DooYzkuIDmrKENCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIFVuaW5zdGFsbFBsdWdpbihzdHJQbHVnaW5OYW1lKQ0KCU9uIEVycm9yIFJlc3VtZSBOZXh0DQoJQ2FsbCBFeGVjdXRlKCJDYWxsIFVuaW5zdGFsbFBsdWdpbl8iICYgc3RyUGx1Z2luTmFtZSAmICIoKSIpDQoJRXJyLkNsZWFyDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJog5qOA5rWL5o+S5Lu25piv5ZCm5bey5r+A5rS7DQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBDaGVja1BsdWdpblN0YXRlKHN0clBsdWdpbk5hbWUpDQoNCglDaGVja1BsdWdpblN0YXRlPUNoZWNrUGx1Z2luU3RhdGVCeU5ld1ZhbHVlKHN0clBsdWdpbk5hbWUsWkNfQkxPR19USEVNRSAmICJ8IiAmIFpDX1VTSU5HX1BMVUdJTl9MSVNUKQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaIOajgOa1i+aPkuS7tuaYr+WQpuW3sua/gOa0uyBieSBuZXcgdmFsdWUNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIENoZWNrUGx1Z2luU3RhdGVCeU5ld1ZhbHVlKHN0clBsdWdpbk5hbWUsbmV3WkNfVVNJTkdfUExVR0lOX0xJU1QpDQoNCglEaW0gcyxpDQoJcz1TcGxpdChuZXdaQ19VU0lOR19QTFVHSU5fTElTVCwifCIpDQoNCglGb3IgaT1MQm91bmQocykgVG8gVUJvdW5kKHMpDQoJCUlmIFVDYXNlKHMoaSkpPVVDYXNlKHN0clBsdWdpbk5hbWUpIFRoZW4NCgkJCUNoZWNrUGx1Z2luU3RhdGVCeU5ld1ZhbHVlPVRydWUNCgkJCUV4aXQgRnVuY3Rpb24NCgkJRW5kIElmDQoJTmV4dA0KDQoJQ2hlY2tQbHVnaW5TdGF0ZUJ5TmV3VmFsdWU9RmFsc2UNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77ya5oyC5LiKQWN0aW9u5o6l5Y+jDQonIOWPguaVsO+8midwbHVnbmFtZTrmjqXlj6PlkI3np7ANCgkJJ2FjdGlvbmNvZGU66KaB5omn6KGM55qE6K+t5Y+l77yM6KaB6L2s5LmJ5Li6RXhlY3V0ZeWPr+aJp+ihjOivreWPpQ0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gQWRkX0FjdGlvbl9QbHVnaW4ocGx1Z25hbWUsYWN0aW9uY29kZSkNCglPbiBFcnJvciBSZXN1bWUgTmV4dA0KCWFjdGlvbmNvZGU9UmVwbGFjZShhY3Rpb25jb2RlLCJFeGl0IEZ1bmN0aW9uIiwiYiIgJiBwbHVnbmFtZSAmICI9VHJ1ZSIpDQoJYWN0aW9uY29kZT1SZXBsYWNlKGFjdGlvbmNvZGUsIkV4aXQgU3ViIiwiYiIgJiBwbHVnbmFtZSAmICI9VHJ1ZSIpDQoJYWN0aW9uY29kZT1SZXBsYWNlKGFjdGlvbmNvZGUsIkV4aXQgUHJvcGVydHkiLCJiIiAmIHBsdWduYW1lICYgIj1UcnVlIikNCglDYWxsIEV4ZWN1dGUoIlJlRGltIFByZXNlcnZlICIgJiBwbHVnbmFtZSAmICIoVUJvdW5kKCImIHBsdWduYW1lICYiKSsxKSIpDQoJQ2FsbCBFeGVjdXRlKHBsdWduYW1lICYgIihVQm91bmQoIiYgcGx1Z25hbWUgJiIpKT0iICYgcGx1Z25hbWUgJiAiKFVCb3VuZCgiJiBwbHVnbmFtZSAmIikpJiIiIiAmIFJlcGxhY2UoYWN0aW9uY29kZSwiIiIiLCIiIiIiIikgJiAiIiIiICYgIjoiKQ0KCUVyci5DbGVhcg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77ya5oyC5LiKRmlsdGVy5o6l5Y+jDQonIOWPguaVsO+8midwbHVnbmFtZTrmjqXlj6PlkI3np7ANCgkJJ2Z1bmN0aW9ubmFtZTropoHmjILmjqXnmoTlh73mlbDlkI0NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEFkZF9GaWx0ZXJfUGx1Z2luKHBsdWduYW1lLGZ1bmN0aW9ubmFtZSkNCglPbiBFcnJvciBSZXN1bWUgTmV4dA0KCUNhbGwgRXhlY3V0ZSgicyIgJiBwbHVnbmFtZSAmICI9IiAmICJzIiAmIHBsdWduYW1lICYgIiYiIiIgJiBmdW5jdGlvbm5hbWUgJiAiIiIiICYgIiYgIiJ8IiIiKQ0KCUVyci5DbGVhcg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77ya5oyC5LiKUmVzcG9uc2XmjqXlj6MNCicg5Y+C5pWw77yaJ3BsdWduYW1lOuaOpeWPo+WQjeensA0KCQkncGFyYW1ldGVyOuimgeWGmeWFpeeahOWGheWuuQ0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gQWRkX1Jlc3BvbnNlX1BsdWdpbihwbHVnbmFtZSxwYXJhbWV0ZXIpDQoJT24gRXJyb3IgUmVzdW1lIE5leHQNCglDYWxsIEV4ZWN1dGUocGx1Z25hbWUgJiAiPSIgJiBwbHVnbmFtZSAmICImIiIiICYgUmVwbGFjZShSZXBsYWNlKFJlcGxhY2UoUmVwbGFjZShwYXJhbWV0ZXIsIiIiIiwiIiIiIiIpLHZiQ3JsZiwiIiImdmJDcmxmJiIiIiksdmJMZiwiIiImdmJMZiYiIiIpLHZiQ3IsIiIiJnZiQ3ImIiIiKSAmICIiIiIpDQoJRXJyLkNsZWFyDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJpHZXRTZXR0aW5nRm9ybU5hbWUNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEdldFNldHRpbmdGb3JtTmFtZShzKQ0KCU9uIEVycm9yIFJlc3VtZSBOZXh0DQoJRGltIHgNCglDYWxsIEV4ZWN1dGUoIng9IiAmIHMpDQoJR2V0U2V0dGluZ0Zvcm1OYW1lPXgNCglFcnIuQ2xlYXINCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8mkdldFNldHRpbmdGb3JtTmFtZSB3aXRoIERlZmF1bHQNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEdldFNldHRpbmdGb3JtTmFtZVdpdGhEZWZhdWx0KHMsZCkNCglPbiBFcnJvciBSZXN1bWUgTmV4dA0KCUVyci5DbGVhcg0KCURpbSB4DQoJQ2FsbCBFeGVjdXRlKCJ4PSIgJiBzKQ0KCUdldFNldHRpbmdGb3JtTmFtZVdpdGhEZWZhdWx0PXgNCglJZiBFcnIuTnVtYmVyPD4wIFRoZW4NCgkJR2V0U2V0dGluZ0Zvcm1OYW1lV2l0aERlZmF1bHQ9ZA0KCUVuZCBJZg0KCUVyci5DbGVhcg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaR2V0TmFtZUZvcm1UaGVtZQ0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gR2V0TmFtZUZvcm1UaGVtZShzKQ0KCU9uIEVycm9yIFJlc3VtZSBOZXh0DQoNCglHZXROYW1lRm9ybVRoZW1lPXMNCglEaW0gb2JqWG1sRmlsZQ0KCVNldCBvYmpYbWxGaWxlPVNlcnZlci5DcmVhdGVPYmplY3QoIk1pY3Jvc29mdC5YTUxET00iKQ0KCW9ialhtbEZpbGUuYXN5bmMgPSBGYWxzZQ0KCW9ialhtbEZpbGUuVmFsaWRhdGVPblBhcnNlPUZhbHNlDQoJb2JqWG1sRmlsZS5sb2FkKEJsb2dQYXRoICYgInpiX3VzZXJzXCIgJiAidGhlbWUiICYgIlwiICYgcyAmICJcIiAmICJ0aGVtZS54bWwiKQ0KCUlmIG9ialhtbEZpbGUucmVhZHlTdGF0ZT00IFRoZW4NCgkJSWYgb2JqWG1sRmlsZS5wYXJzZUVycm9yLmVycm9yQ29kZSA8PiAwIFRoZW4NCgkJRWxzZQ0KCQkJR2V0TmFtZUZvcm1UaGVtZT1vYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJuYW1lIikudGV4dA0KCQlFbmQgSWYNCglFbmQgSWYNCg0KCUVyci5DbGVhcg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIEJsb2cgUmVCdWlsZCDmoLjlv4MNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIE1ha2VCbG9nUmVCdWlsZF9Db3JlKCkNCg0KCSdPbiBFcnJvciBSZXN1bWUgTmV4dA0KDQoJJ3BsdWdpbiBub2RlDQoJYkFjdGlvbl9QbHVnaW5fTWFrZUJsb2dSZUJ1aWxkX0NvcmVfQmVnaW49RmFsc2UNCglGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9NYWtlQmxvZ1JlQnVpbGRfQ29yZV9CZWdpbiBpbiBBY3Rpb25fUGx1Z2luX01ha2VCbG9nUmVCdWlsZF9Db3JlX0JlZ2luDQoJCUlmIE5vdCBJc0VtcHR5KHNBY3Rpb25fUGx1Z2luX01ha2VCbG9nUmVCdWlsZF9Db3JlX0JlZ2luKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9NYWtlQmxvZ1JlQnVpbGRfQ29yZV9CZWdpbikNCgkJSWYgYkFjdGlvbl9QbHVnaW5fTWFrZUJsb2dSZUJ1aWxkX0NvcmVfQmVnaW49VHJ1ZSBUaGVuIEV4aXQgRnVuY3Rpb24NCglOZXh0DQoNCglCbG9nUmVCdWlsZF9TdGF0aXN0aWNzDQoNCglCbG9nUmVCdWlsZF9BdXRob3JzDQoNCglCbG9nUmVCdWlsZF9BcmNoaXZlcw0KDQoJQmxvZ1JlQnVpbGRfUHJldmlvdXMNCg0KCUJsb2dSZUJ1aWxkX0NvbW1lbnRzDQoNCglCbG9nUmVCdWlsZF9DYXRhbG9ncw0KDQoJQmxvZ1JlQnVpbGRfQ2F0ZWdvcnlzDQoNCglCbG9nUmVCdWlsZF9DYWxlbmRhcg0KDQoJQmxvZ1JlQnVpbGRfVGFncw0KDQoJQmxvZ1JlQnVpbGRfRnVuY3Rpb25zDQoNCglCdWlsZEFsbENhY2hlDQoNCglFeHBvcnRSU1MNCg0KCUJsb2dSZUJ1aWxkX0RlZmF1bHQNCg0KCURpbSBib2xPcGVyYXRlU3VjY2Vzcw0KDQoJQXBwbGljYXRpb24uTG9jaw0KCWJvbE9wZXJhdGVTdWNjZXNzPUFwcGxpY2F0aW9uKFpDX0JMT0dfQ0xTSUQgICYgQmxvZ1VzZXIuSUQgJiAiU0lHTkFMX09QRVJBVEVTVUNDRVNTIikNCglBcHBsaWNhdGlvbi5VbkxvY2sNCg0KCUNhbGwgU2V0QmxvZ0hpbnQoYm9sT3BlcmF0ZVN1Y2Nlc3MsRmFsc2UsRW1wdHkpDQoNCglNYWtlQmxvZ1JlQnVpbGRfQ29yZT1UcnVlDQoNCgkncGx1Z2luIG5vZGUNCgliQWN0aW9uX1BsdWdpbl9NYWtlQmxvZ1JlQnVpbGRfQ29yZV9FbmQ9RmFsc2UNCglGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9NYWtlQmxvZ1JlQnVpbGRfQ29yZV9FbmQgaW4gQWN0aW9uX1BsdWdpbl9NYWtlQmxvZ1JlQnVpbGRfQ29yZV9FbmQNCgkJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fTWFrZUJsb2dSZUJ1aWxkX0NvcmVfRW5kKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9NYWtlQmxvZ1JlQnVpbGRfQ29yZV9FbmQpDQoJCUlmIGJBY3Rpb25fUGx1Z2luX01ha2VCbG9nUmVCdWlsZF9Db3JlX0VuZD1UcnVlIFRoZW4gRXhpdCBGdW5jdGlvbg0KCU5leHQNCg0KCSdFcnIuQ2xlYXINCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIOWFqOaWsOeahOmDqOS7vee0ouW8leeoi+W6jw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gQnVpbGRBbGxDYWNoZSgpDQoNCgkncGx1Z2luIG5vZGUNCgliQWN0aW9uX1BsdWdpbl9CdWlsZEFsbENhY2hlX0JlZ2luPUZhbHNlDQoJRm9yIEVhY2ggc0FjdGlvbl9QbHVnaW5fQnVpbGRBbGxDYWNoZV9CZWdpbiBpbiBBY3Rpb25fUGx1Z2luX0J1aWxkQWxsQ2FjaGVfQmVnaW4NCgkJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fQnVpbGRBbGxDYWNoZV9CZWdpbikgVGhlbiBDYWxsIEV4ZWN1dGUoc0FjdGlvbl9QbHVnaW5fQnVpbGRBbGxDYWNoZV9CZWdpbikNCgkJSWYgYkFjdGlvbl9QbHVnaW5fQnVpbGRBbGxDYWNoZV9CZWdpbj1UcnVlIFRoZW4gRXhpdCBGdW5jdGlvbg0KCU5leHQNCg0KCUJ1aWxkQWxsQ2FjaGU9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEJsb2dSZUJ1aWxkX0NhbGVuZGFyKCkNCg0KCSdwbHVnaW4gbm9kZQ0KCWJBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX0NhbGVuZGFyX0JlZ2luPUZhbHNlDQoJRm9yIEVhY2ggc0FjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfQ2FsZW5kYXJfQmVnaW4gaW4gQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9DYWxlbmRhcl9CZWdpbg0KCQlJZiBOb3QgSXNFbXB0eShzQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9DYWxlbmRhcl9CZWdpbikgVGhlbiBDYWxsIEV4ZWN1dGUoc0FjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfQ2FsZW5kYXJfQmVnaW4pDQoJCUlmIGJBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX0NhbGVuZGFyX0JlZ2luPVRydWUgVGhlbiBFeGl0IEZ1bmN0aW9uDQoJTmV4dA0KDQoJRGltIG9ialN0cmVhbQ0KCURpbSBzdHJDYWxlbmRhcg0KCURpbSBpLGoNCglEaW0gb2JqUlMNCglEaW0gayxsLG0sbg0KCUNhbGwgR2V0RnVuY3Rpb24oKQ0KCUlmIEZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKCJjYWxlbmRhciIpKS5Jc0hpZGRlbj1UcnVlIFRoZW4gDQoNCgkJRXhpdCBGdW5jdGlvbg0KCUVuZCBJZg0KCSdDYWxlbmRhcg0KDQoJc3RyQ2FsZW5kYXI9TWFrZUNhbGVuZGFyKCIiKQ0KDQoJc3RyQ2FsZW5kYXI9VHJhbnNmZXJIVE1MKHN0ckNhbGVuZGFyLCJbbm8tYXNwXSIpDQoNCg0KCQ0KCUZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKCJjYWxlbmRhciIpKS5Db250ZW50PXN0ckNhbGVuZGFyDQoJRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUoImNhbGVuZGFyIikpLlBvc3QoKQ0KCUJsb2dSZUJ1aWxkX0NhbGVuZGFyPVRydWUNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBCbG9nUmVCdWlsZF9BcmNoaXZlcygpDQoNCgkncGx1Z2luIG5vZGUNCgliQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9BcmNoaXZlc19CZWdpbj1GYWxzZQ0KCUZvciBFYWNoIHNBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX0FyY2hpdmVzX0JlZ2luIGluIEFjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfQXJjaGl2ZXNfQmVnaW4NCgkJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfQXJjaGl2ZXNfQmVnaW4pIFRoZW4gQ2FsbCBFeGVjdXRlKHNBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX0FyY2hpdmVzX0JlZ2luKQ0KCQlJZiBiQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9BcmNoaXZlc19CZWdpbj1UcnVlIFRoZW4gRXhpdCBGdW5jdGlvbg0KCU5leHQNCg0KCURpbSBpDQoJRGltIGoNCglEaW0gbA0KCURpbSBuDQoJRGltIG9ialJTDQoJRGltIG9ialN0cmVhbQ0KCURpbSBzDQoNCglEaW0gQXJ0TGlzdA0KDQoJQ2FsbCBHZXRGdW5jdGlvbigpDQoJSWYgRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUoImFyY2hpdmVzIikpLklzSGlkZGVuPVRydWUgVGhlbiANCg0KCQlFeGl0IEZ1bmN0aW9uDQoJRW5kIElmDQoJJ0FyY2hpdmVzDQoJRGltIHN0ckFyY2hpdmVzDQoJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFtsb2dfUG9zdFRpbWVdIEZST00gW2Jsb2dfQXJ0aWNsZV0gV0hFUkUgKFtsb2dfVHlwZV09MCkgQW5kIChbbG9nX0xldmVsXT4xKSBPUkRFUiBCWSBbbG9nX1Bvc3RUaW1lXSBERVNDIikNCglJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoJCURpbSBkdG1ZTSgpDQoJCWk9MA0KCQlqPTANCgkJUmVEaW0gUHJlc2VydmUgZHRtWU0oMCkNCgkJRG8gV2hpbGUgTm90IG9ialJTLmVvZg0KCQkJaj1VQm91bmQoZHRtWU0pDQoJCQlpPVllYXIob2JqUlMoImxvZ19Qb3N0VGltZSIpKSAmICItIiAmIE1vbnRoKG9ialJTKCJsb2dfUG9zdFRpbWUiKSkNCgkJCUlmIGk8PmR0bVlNKGopIFRoZW4NCgkJCQlSZURpbSBQcmVzZXJ2ZSBkdG1ZTShqKzEpDQoJCQkJZHRtWU0oaisxKT1pDQoJCQlFbmQgSWYNCgkJCW9ialJTLk1vdmVOZXh0DQoJCUxvb3ANCglFbmQgSWYNCglvYmpSUy5DbG9zZQ0KCVNldCBvYmpSUz1Ob3RoaW5nDQoNCg0KCWo9RnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUoImFyY2hpdmVzIikpLk1heExpDQoNCg0KSWYgQmxvZ0NvbmZpZy5SZWFkKCJaQ19BUkNISVZFU19PTERfTElTVFRZUEUiKT0iVHJ1ZSIgVGhlbg0KCUlmIE5vdCBJc0VtcHR5KGR0bVlNKSBUaGVuDQoJCUZvciBpPTEgdG8gVUJvdW5kKGR0bVlNKQ0KDQoJCQlsPVllYXIoZHRtWU0oaSkpDQoJCQluPU1vbnRoKGR0bVlNKGkpKSsxDQoJCQlJRiBuPjEyIFRoZW4gbD1sKzE6bj0xDQoNCgkJCVNldCBvYmpSUz1vYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBDT1VOVChbbG9nX0lEXSkgRlJPTSBbYmxvZ19BcnRpY2xlXSBXSEVSRSAoW2xvZ19UeXBlXT0wKSBBbmQgKFtsb2dfTGV2ZWxdPjEpIEFORCBbbG9nX1Bvc3RUaW1lXSBCRVRXRUVOICImIFpDX1NRTF9QT1VORF9LRVkgJiBZZWFyKGR0bVlNKGkpKSAmIi0iJiBNb250aChkdG1ZTShpKSkgJiItMSImIFpDX1NRTF9QT1VORF9LRVkgJiIgQU5EICImIFpDX1NRTF9QT1VORF9LRVkgJiBsICYiLSImIG4gJiItMSIgJiBaQ19TUUxfUE9VTkRfS0VZKQ0KDQoJCQlJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoJCQkJc3RyQXJjaGl2ZXM9c3RyQXJjaGl2ZXMgJiAiPGxpPjxhIGhyZWY9IiIiJiBVcmxieURhdGVBdXRvKFllYXIoZHRtWU0oaSkpLE1vbnRoKGR0bVlNKGkpKSwiIikgJiIiIj4iICYgWWVhcihkdG1ZTShpKSkgJiAiICIgJiBaVkFfTW9udGgoTW9udGgoZHRtWU0oaSkpKSAmICI8c3BhbiBjbGFzcz0iImFydGljbGUtbnVtcyIiPiAoIiAmIG9ialJTKDApICYgIik8L3NwYW4+IiArIjwvYT48L2xpPiINCgkJCQlJZiBqPjAgVGhlbg0KCQkJCQlJZiBpPWogVGhlbiBFeGl0IEZvcg0KCQkJCUVuZCBJZg0KCQkJRW5kIElmDQoNCgkJCW9ialJTLkNsb3NlDQoJCQlTZXQgb2JqUlM9Tm90aGluZw0KCQlOZXh0DQoJRW5kIElmDQpFbHNlDQoJcz0iPGxpPiINCglJZiBOb3QgSXNFbXB0eShkdG1ZTSkgVGhlbg0KCQlGb3IgaT0xIHRvIFVCb3VuZChkdG1ZTSkNCg0KCQkJbD1ZZWFyKGR0bVlNKGkpKQ0KCQkJbj1Nb250aChkdG1ZTShpKSkrMQ0KCQkJSUYgbj4xMiBUaGVuIGw9bCsxOm49MQ0KDQoJCQlTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgQ09VTlQoW2xvZ19JRF0pIEZST00gW2Jsb2dfQXJ0aWNsZV0gV0hFUkUgKFtsb2dfVHlwZV09MCkgQW5kIChbbG9nX0xldmVsXT4xKSBBTkQgW2xvZ19Qb3N0VGltZV0gQkVUV0VFTiAiJiBaQ19TUUxfUE9VTkRfS0VZICYgWWVhcihkdG1ZTShpKSkgJiItIiYgTW9udGgoZHRtWU0oaSkpICYiLTEiJiBaQ19TUUxfUE9VTkRfS0VZICYiIEFORCAiJiBaQ19TUUxfUE9VTkRfS0VZICYgbCAmIi0iJiBuICYiLTEiICYgWkNfU1FMX1BPVU5EX0tFWSkNCg0KCQkJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KCQkJCUlmIEluU3RyKHMsIjwhLS0geWVhciAtLT4iJlJlcGxhY2UoWkNfTVNHMjMzLCIleSIsWWVhcihkdG1ZTShpKSkpJiI8IS0tIHllYXIgLS0+Iik9MCBUaGVuIHM9cyAmICI8L2xpPjxsaT48IS0tIHllYXIgLS0+IiZSZXBsYWNlKFpDX01TRzIzMywiJXkiLFllYXIoZHRtWU0oaSkpKSYiPCEtLSB5ZWFyIC0tPjxici8+Ig0KCQkJCQ0KCQkJCXM9cyAmICI8YSBocmVmPSIiIiYgVXJsYnlEYXRlQXV0byhZZWFyKGR0bVlNKGkpKSxNb250aChkdG1ZTShpKSksIiIpICYiIiI+IiAmICBaVkFfTW9udGhfQWJicihNb250aChkdG1ZTShpKSkpICAmICI8c3BhbiBjbGFzcz0iImFydGljbGUtbnVtcyIiPigiICYgb2JqUlMoMCkgJiAiKTwvc3Bhbj4iICsiPC9hPiZuYnNwOyAiDQoJCQkJSWYgaj4wIFRoZW4NCgkJCQkJSWYgaT1qIFRoZW4gRXhpdCBGb3INCgkJCQlFbmQgSWYNCgkJCUVuZCBJZg0KDQoJCQlvYmpSUy5DbG9zZQ0KCQkJU2V0IG9ialJTPU5vdGhpbmcNCgkJTmV4dA0KCUVuZCBJZg0KCXM9cyAmICI8L2xpPiINCglzPVJlcGxhY2UocywiPGxpPjwvbGk+IiwiIikNCglzdHJBcmNoaXZlcz1SZXBsYWNlKHMsIjwhLS0geWVhciAtLT4iLCIiKQ0KRW5kIElmDQoNCglzdHJBcmNoaXZlcz1UcmFuc2ZlckhUTUwoc3RyQXJjaGl2ZXMsIltuby1hc3BdIikNCglGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZSgiYXJjaGl2ZXMiKSkuQ29udGVudD1zdHJBcmNoaXZlcw0KCUZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKCJhcmNoaXZlcyIpKS5Qb3N0KCkNCg0KCUJsb2dSZUJ1aWxkX0FyY2hpdmVzPVRydWUNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBCbG9nUmVCdWlsZF9DYXRhbG9ncygpDQoNCgkncGx1Z2luIG5vZGUNCgliQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9DYXRhbG9nc19CZWdpbj1GYWxzZQ0KCUZvciBFYWNoIHNBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX0NhdGFsb2dzX0JlZ2luIGluIEFjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfQ2F0YWxvZ3NfQmVnaW4NCgkJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfQ2F0YWxvZ3NfQmVnaW4pIFRoZW4gQ2FsbCBFeGVjdXRlKHNBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX0NhdGFsb2dzX0JlZ2luKQ0KCQlJZiBiQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9DYXRhbG9nc19CZWdpbj1UcnVlIFRoZW4gRXhpdCBGdW5jdGlvbg0KCU5leHQNCg0KCUlzUnVuR2V0Q2F0ZWdvcnk9RmFsc2UNCglDYWxsIEdldEZ1bmN0aW9uDQoJSWYgRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUoImNhdGFsb2ciKSkuSXNIaWRkZW49VHJ1ZSBUaGVuIA0KDQoJCUV4aXQgRnVuY3Rpb24NCglFbmQgSWYNCglDYWxsIEdldENhdGVnb3J5KCkNCgkNCglEaW0gb2JqUlMNCglEaW0gb2JqU3RyZWFtDQoNCglEaW0gQXJ0TGlzdA0KDQoJJ0NhdGFsb2dzDQoJRGltIHN0ckNhdGFsb2csYm9sSGFzU3ViQ2F0ZQ0KDQoJRGltIGFyeUNhdGVJbk9yZGVyIA0KCWFyeUNhdGVJbk9yZGVyPUdldENhdGVnb3J5T3JkZXIoKQ0KDQoNCglDYXRlZ29yeXMoMCkuQ291bnQ9Q0xuZyhvYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBDT1VOVChbbG9nX0lEXSkgRlJPTSBbYmxvZ19BcnRpY2xlXSBXSEVSRSBbbG9nX0xldmVsXT4xIEFORCBbbG9nX1R5cGVdPTAgQU5EIFtsb2dfQ2F0ZUlEXT0wIikoMCkpDQoJSWYgQ2F0ZWdvcnlzKDApLkNvdW50PjAgVGhlbg0KCQlzdHJDYXRhbG9nPXN0ckNhdGFsb2cgJiAiPGxpIGNsYXNzPSIibGktY2F0ZSBjYXRlLSImIENhdGVnb3J5cygwKS5pZCAmIiIiPjxhIGhyZWY9IiIiJiBDYXRlZ29yeXMoMCkuVXJsICYgIiIiPiIrQ2F0ZWdvcnlzKDApLk5hbWUgKyAiPHNwYW4gY2xhc3M9IiJhcnRpY2xlLW51bXMiIj4gKCIgJiBDYXRlZ29yeXMoMCkuQ291bnQgJiAiKTwvc3Bhbj4iICsiPC9hPjwvbGk+Ig0KCUVuZCBJZg0KDQoJRGltIGksaixjDQoJRGltIHN0clByZWNhdGEsc3RyU3ViY2F0ZQ0KCUZvciBpPUxib3VuZChhcnlDYXRlSW5PcmRlcikrMSBUbyBVYm91bmQoYXJ5Q2F0ZUluT3JkZXIpDQoJCXN0clByZWNhdGE9IiI6c3RyU3ViY2F0ZT0iIg0KCQlJZiBDYXRlZ29yeXMoYXJ5Q2F0ZUluT3JkZXIoaSkpLlBhcmVudElEPTAgVGhlbg0KCQkJYz1DYXRlZ29yeXMoYXJ5Q2F0ZUluT3JkZXIoaSkpLkNvdW50DQoNCgkJCWJvbEhhc1N1YkNhdGU9RmFsc2UNCgkJCUZvciBqPUxib3VuZChhcnlDYXRlSW5PcmRlcikrMSBUbyBVQm91bmQoYXJ5Q2F0ZUluT3JkZXIpDQoJCQkJSWYgQ2F0ZWdvcnlzKGFyeUNhdGVJbk9yZGVyKGopKS5QYXJlbnRJRD1DYXRlZ29yeXMoYXJ5Q2F0ZUluT3JkZXIoaSkpLklEIFRoZW4gYm9sSGFzU3ViQ2F0ZT1UcnVlDQoJCQlOZXh0DQoJCQknSWYgYm9sSGFzU3ViQ2F0ZSBUaGVuIHN0clN1YmNhdGUgPSAiPHVsIGNsYXNzPSIidWwtc3ViY2F0ZXMiIj4iDQoJCQlGb3Igaj1MYm91bmQoYXJ5Q2F0ZUluT3JkZXIpKzEgVG8gVUJvdW5kKGFyeUNhdGVJbk9yZGVyKQ0KCQkJCUlmIENhdGVnb3J5cyhhcnlDYXRlSW5PcmRlcihqKSkuUGFyZW50SUQ9Q2F0ZWdvcnlzKGFyeUNhdGVJbk9yZGVyKGkpKS5JRCBBbmQgQ2F0ZWdvcnlzKGFyeUNhdGVJbk9yZGVyKGopKS5Db3VudD4wIFRoZW4NCgkJCQkJc3RyU3ViY2F0ZT1zdHJTdWJjYXRlICYgIjxsaSBjbGFzcz0iImxpLXN1YmNhdGUgY2F0ZS0iJiBDYXRlZ29yeXMoYXJ5Q2F0ZUluT3JkZXIoaikpLklEICYiIiI+PGEgaHJlZj0iIiImIENhdGVnb3J5cyhhcnlDYXRlSW5PcmRlcihqKSkuVXJsICYgIiIiPiIrQ2F0ZWdvcnlzKGFyeUNhdGVJbk9yZGVyKGopKS5OYW1lICsgIjxzcGFuIGNsYXNzPSIiYXJ0aWNsZS1udW1zIiI+ICgiICYgQ2F0ZWdvcnlzKGFyeUNhdGVJbk9yZGVyKGopKS5Db3VudCAmICIpPC9zcGFuPiIgKyI8L2E+PC9saT4iDQoJCQkJCWM9YytDYXRlZ29yeXMoYXJ5Q2F0ZUluT3JkZXIoaikpLkNvdW50DQoJCQkJRW5kIElmDQoJCQlOZXh0DQoJCQlJZiBib2xIYXNTdWJDYXRlIEFuZCBzdHJTdWJjYXRlPD4iIiBUaGVuIHN0clN1YmNhdGU9Ijx1bCBjbGFzcz0iInVsLXN1YmNhdGVzIiI+IiAmIHN0clN1YmNhdGUgJiAiPC91bD4iDQoNCgkJCUlmIGM+MCBUaGVuIHN0clByZWNhdGE9IjxsaSBjbGFzcz0iImxpLWNhdGUgY2F0ZS0iJiBDYXRlZ29yeXMoYXJ5Q2F0ZUluT3JkZXIoaSkpLklEICYiIiI+PGEgaHJlZj0iIiImIENhdGVnb3J5cyhhcnlDYXRlSW5PcmRlcihpKSkuVXJsICYgIiIiPiIrQ2F0ZWdvcnlzKGFyeUNhdGVJbk9yZGVyKGkpKS5OYW1lICsgIjxzcGFuIGNsYXNzPSIiYXJ0aWNsZS1udW1zIiI+ICgiICYgYyAmICIpPC9zcGFuPiIgKyI8L2E+IiYgc3RyU3ViY2F0ZSAmIjwvbGk+Ig0KDQoJCQlzdHJDYXRhbG9nPXN0ckNhdGFsb2cgJiBzdHJQcmVjYXRhDQoJCUVuZCBJZg0KDQoJTmV4dA0KDQoJc3RyQ2F0YWxvZz1UcmFuc2ZlckhUTUwoc3RyQ2F0YWxvZywiW25vLWFzcF0iKQ0KDQoNCglGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZSgiY2F0YWxvZyIpKS5Db250ZW50PXN0ckNhdGFsb2cNCglGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZSgiY2F0YWxvZyIpKS5Qb3N0KCkNCg0KCUJsb2dSZUJ1aWxkX0NhdGFsb2dzPVRydWUNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBCbG9nUmVCdWlsZF9DYXRlZ29yeXMoKQ0KDQoJJ3BsdWdpbiBub2RlDQoJYkFjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfQ2F0ZWdvcnlzX0JlZ2luPUZhbHNlDQoJRm9yIEVhY2ggc0FjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfQ2F0ZWdvcnlzX0JlZ2luIGluIEFjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfQ2F0ZWdvcnlzX0JlZ2luDQoJCUlmIE5vdCBJc0VtcHR5KHNBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX0NhdGVnb3J5c19CZWdpbikgVGhlbiBDYWxsIEV4ZWN1dGUoc0FjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfQ2F0ZWdvcnlzX0JlZ2luKQ0KCQlJZiBiQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9DYXRlZ29yeXNfQmVnaW49VHJ1ZSBUaGVuIEV4aXQgRnVuY3Rpb24NCglOZXh0DQoNCglCbG9nUmVCdWlsZF9DYXRlZ29yeXM9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEJsb2dSZUJ1aWxkX0F1dGhvcnMoKQ0KDQoJJ3BsdWdpbiBub2RlDQoJYkFjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfQXV0aG9yc19CZWdpbj1GYWxzZQ0KCUZvciBFYWNoIHNBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX0F1dGhvcnNfQmVnaW4gaW4gQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9BdXRob3JzX0JlZ2luDQoJCUlmIE5vdCBJc0VtcHR5KHNBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX0F1dGhvcnNfQmVnaW4pIFRoZW4gQ2FsbCBFeGVjdXRlKHNBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX0F1dGhvcnNfQmVnaW4pDQoJCUlmIGJBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX0F1dGhvcnNfQmVnaW49VHJ1ZSBUaGVuIEV4aXQgRnVuY3Rpb24NCglOZXh0DQoNCglDYWxsIEdldFVzZXIoKQ0KCUNhbGwgR2V0RnVuY3Rpb24oKQ0KCUlmIEZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKCJhdXRob3JzIikpLklzSGlkZGVuPVRydWUgVGhlbiANCg0KCQlFeGl0IEZ1bmN0aW9uDQoJRW5kIElmDQoJDQoJRGltIG9ialJTDQoJRGltIG9ialN0cmVhbQ0KDQoJJ0F1dGhvcnMNCglEaW0gc3RyQXV0aG9yDQoJRGltIFVzZXINCglGb3IgRWFjaCBVc2VyIGluIFVzZXJzDQoJCUlmIElzT2JqZWN0KFVzZXIpIFRoZW4nJycnJycNCgkJCUlmIFVzZXIuSUQ+MCBBbmQgVXNlci5MZXZlbDw0IEFuZCBVc2VyLkNvdW50PjAgVGhlbg0KCQkJCXN0ckF1dGhvcj1zdHJBdXRob3IgJiAiPGxpPjxhIGhyZWY9IiIiJiBVc2VyLlVybCAmICIiIj4iK1VzZXIuRmlyc3ROYW1lICsgIiAoIiAmIFVzZXIuQ291bnQgJiAiKSIgKyI8L2E+PC9saT4iDQoJCQlFbmQgSWYNCgkJRW5kIElmDQoJTmV4dA0KDQoJc3RyQXV0aG9yPVRyYW5zZmVySFRNTChzdHJBdXRob3IsIltuby1hc3BdIikNCg0KCQ0KCUZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKCJhdXRob3JzIikpLkNvbnRlbnQ9c3RyQXV0aG9yDQoJRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUoImF1dGhvcnMiKSkuUG9zdCgpDQoNCglCbG9nUmVCdWlsZF9BdXRob3JzPVRydWUNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBCbG9nUmVCdWlsZF9UYWdzKCkNCg0KCSdwbHVnaW4gbm9kZQ0KCWJBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX1RhZ3NfQmVnaW49RmFsc2UNCglGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9UYWdzX0JlZ2luIGluIEFjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfVGFnc19CZWdpbg0KCQlJZiBOb3QgSXNFbXB0eShzQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9UYWdzX0JlZ2luKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9UYWdzX0JlZ2luKQ0KCQlJZiBiQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9UYWdzX0JlZ2luPVRydWUgVGhlbiBFeGl0IEZ1bmN0aW9uDQoJTmV4dA0KDQoJQ2FsbCBHZXRGdW5jdGlvbigpDQoJDQoJSWYgRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUoInRhZ3MiKSkuSXNIaWRkZW49VHJ1ZSBUaGVuIA0KDQoJCUV4aXQgRnVuY3Rpb24NCglFbmQgSWYNCgkNCglEaW0gb2JqUlMNCglEaW0gb2JqU3RyZWFtDQoNCglEaW0gaSxqLHMsdCxoDQoJDQoJaT1GdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZSgidGFncyIpKS5NYXhMaQ0KCUlmIGk9MCBUaGVuIGk9MjUNCglqPTANCgknQXV0aG9ycw0KCURpbSBzdHJUYWcNCg0KCVNldCBvYmpSUz1vYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBbdGFnX2lkXSBGUk9NIFtibG9nX1RhZ10gT1JERVIgQlkgW3RhZ19Db3VudF0gREVTQyxbdGFnX0lEXSBBU0MiKQ0KCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCgkJRG8gV2hpbGUgTm90IG9ialJTLmVvZg0KCQkJcz1zICYgInsiICYgb2JqUlMoInRhZ19JRCIpICYgIn0iDQoJCQl0PXQgJiBvYmpSUygidGFnX0lEIikgJiAiLCINCgkJCW9ialJTLk1vdmVOZXh0DQoJCQlqPWorMQ0KCQkJSWYgaj5pIFRoZW4gRXhpdCBEbw0KCQlMb29wDQoJRW5kIElmDQoJb2JqUlMuQ2xvc2UNCglTZXQgb2JqUlM9Tm90aGluZw0KDQoJQ2FsbCBHZXRUYWdzYnlUYWdJRExpc3QocykNCg0KCVNldCBoPUNyZWF0ZU9iamVjdCgiU2NyaXB0aW5nLkRpY3Rpb25hcnkiKQ0KDQoJcz1TcGxpdCh0LCIsIikNCglGb3IgaT0wIFRvIFVCb3VuZChzKS0xDQoJCUlmIHMoaSk8PiIiIEFuZCBUYWdzKHMoaSkpLkNvdW50PD4wIFRoZW4NCgkJCWguYWRkIHMoaSksVGFncyhzKGkpKQ0KCQlFbmQgSWYNCglOZXh0DQoNCglGb3IgRWFjaCBzIEluIFRhZ3MNCgkJSWYgSXNPYmplY3Qocyk9VHJ1ZSBUaGVuDQoJCQlJZiBoLkV4aXN0cyhDU3RyKHMuSUQpKSBUaGVuDQoJCQkJc3RyVGFnPXN0clRhZyAmICI8bGkgY2xhc3M9IiJ0YWctbmFtZSB0YWctbmFtZS1zaXplLSImVGFnQ2xvdWQocy5Db3VudCkmIiIiPjxhIGhyZWY9IiIiJnMuVXJsJiIiIj4iK3MuTmFtZSArICI8c3BhbiBjbGFzcz0iInRhZy1jb3VudCIiPiAoIiAmIHMuQ291bnQgJiAiKTwvc3Bhbj4iICsiPC9hPjwvbGk+Ig0KCQkJRW5kIElmDQoJCUVuZCBJZg0KCU5leHQNCg0KDQoJc3RyVGFnPVRyYW5zZmVySFRNTChzdHJUYWcsIltuby1hc3BdIikNCg0KDQoJRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUoInRhZ3MiKSkuQ29udGVudD1zdHJUYWcNCglGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZSgidGFncyIpKS5Qb3N0KCkNCg0KCUJsb2dSZUJ1aWxkX1RhZ3M9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEJsb2dSZUJ1aWxkX1ByZXZpb3VzKCkNCg0KCSdwbHVnaW4gbm9kZQ0KCWJBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX1ByZXZpb3VzX0JlZ2luPUZhbHNlDQoJRm9yIEVhY2ggc0FjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfUHJldmlvdXNfQmVnaW4gaW4gQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9QcmV2aW91c19CZWdpbg0KCQlJZiBOb3QgSXNFbXB0eShzQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9QcmV2aW91c19CZWdpbikgVGhlbiBDYWxsIEV4ZWN1dGUoc0FjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfUHJldmlvdXNfQmVnaW4pDQoJCUlmIGJBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX1ByZXZpb3VzX0JlZ2luPVRydWUgVGhlbiBFeGl0IEZ1bmN0aW9uDQoJTmV4dA0KDQoNCglEaW0gaSxqDQoJRGltIG9ialJTDQoJRGltIG9ialN0cmVhbQ0KCURpbSBvYmpBcnRpY2xlDQoJQ2FsbCBHZXRGdW5jdGlvbigpDQoJaj1GdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZSgicHJldmlvdXMiKSkuTWF4TGkNCgkNCglJZiBGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZSgicHJldmlvdXMiKSkuSXNIaWRkZW49VHJ1ZSBUaGVuIA0KDQoJCUV4aXQgRnVuY3Rpb24NCglFbmQgSWYNCgkNCglJZiBqPTAgVGhlbiBqPTEwDQoNCgknUHJldmlvdXMNCglEaW0gc3RyUHJldmlvdXMNCglTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgVE9QICImaiYiIFtsb2dfSURdLFtsb2dfVGFnXSxbbG9nX0NhdGVJRF0sW2xvZ19UaXRsZV0sW2xvZ19JbnRyb10sW2xvZ19Db250ZW50XSxbbG9nX0xldmVsXSxbbG9nX0F1dGhvcklEXSxbbG9nX1Bvc3RUaW1lXSxbbG9nX0NvbW1OdW1zXSxbbG9nX1ZpZXdOdW1zXSxbbG9nX1RyYWNrQmFja051bXNdLFtsb2dfVXJsXSxbbG9nX0lzdG9wXSxbbG9nX1RlbXBsYXRlXSxbbG9nX0Z1bGxVcmxdLFtsb2dfVHlwZV0sW2xvZ19NZXRhXSBGUk9NIFtibG9nX0FydGljbGVdIFdIRVJFIChbbG9nX1R5cGVdPTApIEFuZCAoW2xvZ19JRF0+MCkgQU5EIChbbG9nX0xldmVsXT4xKSBPUkRFUiBCWSBbbG9nX1Bvc3RUaW1lXSBERVNDIikNCg0KCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCgkJRm9yIGk9MSB0byBqDQoJCQlTZXQgb2JqQXJ0aWNsZT1OZXcgVEFydGljbGUNCgkJCUlmIG9iakFydGljbGUuTG9hZEluZm9CeUFycmF5KEFycmF5KG9ialJTKDApLG9ialJTKDEpLG9ialJTKDIpLG9ialJTKDMpLG9ialJTKDQpLG9ialJTKDUpLG9ialJTKDYpLG9ialJTKDcpLG9ialJTKDgpLG9ialJTKDkpLG9ialJTKDEwKSxvYmpSUygxMSksb2JqUlMoMTIpLG9ialJTKDEzKSxvYmpSUygxNCksb2JqUlMoMTUpLG9ialJTKDE2KSxvYmpSUygxNykpKSBUaGVuDQoJCQkJc3RyUHJldmlvdXM9c3RyUHJldmlvdXMgJiAiPGxpPjxhIGhyZWY9IiIiJiBvYmpBcnRpY2xlLkh0bWxVcmwgJiAiIiIgdGl0bGU9IiIiJiBvYmpBcnRpY2xlLkh0bWxUaXRsZSAmIiIiPjxzcGFuIGNsYXNzPSIiYXJ0aWNsZS1kYXRlIiI+WyImIFJpZ2h0KCIwIiAmIE1vbnRoKG9iakFydGljbGUuUG9zdFRpbWUpLDIpICYgIi8iICYgUmlnaHQoIjAiICYgRGF5KG9iakFydGljbGUuUG9zdFRpbWUpLDIpICYiXTwvc3Bhbj4iICYgb2JqQXJ0aWNsZS5UaXRsZSAmICI8L2E+PC9saT4iDQoJCQlFbmQgSWYNCgkJCVNldCBvYmpBcnRpY2xlPU5vdGhpbmcNCgkJCW9ialJTLk1vdmVOZXh0DQoJCQlJZiBvYmpSUy5lb2YgVGhlbiBFeGl0IEZvcg0KCQlOZXh0DQoJRW5kIElmDQoJb2JqUlMuY2xvc2UNCg0KCXN0clByZXZpb3VzPVRyYW5zZmVySFRNTChzdHJQcmV2aW91cywiW25vLWFzcF0iKQ0KDQoJRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUoInByZXZpb3VzIikpLkNvbnRlbnQ9c3RyUHJldmlvdXMNCglGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZSgicHJldmlvdXMiKSkuUG9zdCgpDQoJRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUoInByZXZpb3VzIikpLlNhdmVGaWxlDQoNCglCbG9nUmVCdWlsZF9QcmV2aW91cz1UcnVlDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8mg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gQmxvZ1JlQnVpbGRfQ29tbWVudHMoKQ0KDQoJJ3BsdWdpbiBub2RlDQoJYkFjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfQ29tbWVudHNfQmVnaW49RmFsc2UNCglGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9Db21tZW50c19CZWdpbiBpbiBBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX0NvbW1lbnRzX0JlZ2luDQoJCUlmIE5vdCBJc0VtcHR5KHNBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX0NvbW1lbnRzX0JlZ2luKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9Db21tZW50c19CZWdpbikNCgkJSWYgYkFjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfQ29tbWVudHNfQmVnaW49VHJ1ZSBUaGVuIEV4aXQgRnVuY3Rpb24NCglOZXh0DQoNCglDYWxsIEdldEZ1bmN0aW9uKCkNCglJZiBGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZSgiY29tbWVudHMiKSkuSXNIaWRkZW49VHJ1ZSBUaGVuIA0KDQoJCUV4aXQgRnVuY3Rpb24NCglFbmQgSWYNCgkNCglEaW0gb2JqUlMNCglEaW0gb2JqU3RyZWFtDQoJRGltIG9iakFydGljbGUNCg0KCSdDb21tZW50cw0KCURpbSBzdHJDb21tZW50cw0KDQoJRGltIHMsdA0KCURpbSBpLGoNCg0KCWo9RnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUoImNvbW1lbnRzIikpLk1heExpDQoJSWYgaj0wIFRoZW4gaj0xMA0KDQoJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFRPUCAiJmomIiBbbG9nX0lEXSxbY29tbV9JRF0sW2NvbW1fQ29udGVudF0sW2NvbW1fUG9zdFRpbWVdLFtjb21tX0F1dGhvcklEXSxbY29tbV9BdXRob3JdIEZST00gW2Jsb2dfQ29tbWVudF0gV0hFUkUgW2xvZ19JRF0+MCBBTkQgW2NvbW1fSXNDaGVja109MCBPUkRFUiBCWSBbY29tbV9Qb3N0VGltZV0gREVTQyxbY29tbV9JRF0gREVTQyIpDQoJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KCQlGb3IgaT0xIHRvIGoNCgkJCUNhbGwgR2V0VXNlcnNieVVzZXJJRExpc3Qob2JqUlMoImNvbW1fQXV0aG9ySUQiKSkNCg0KCQkJU2V0IG9iakFydGljbGU9TmV3IFRBcnRpY2xlDQoNCgkJCUlmIG9iakFydGljbGUuTG9hZEluZm9CeUlEKG9ialJTKCJsb2dfSUQiKSkgVGhlbg0KCQkJCXQ9b2JqQXJ0aWNsZS5VcmwNCgkJCUVuZCBJZg0KDQoJCQlzPW9ialJTKCJjb21tX0NvbnRlbnQiKQ0KCQkJcz1SZXBsYWNlKHMsdmJDcmxmLCIiKQ0KCQkJcz1MZWZ0KHMsWkNfQ09NTUVOVF9FWENFUlBUX01BWCkNCgkJCXM9VHJhbnNmZXJIVE1MKHMsIltub2h0bWxdIikNCgkJCQ0KCQkJc3RyQ29tbWVudHM9c3RyQ29tbWVudHMgJiAiPGxpIHN0eWxlPSIidGV4dC1vdmVyZmxvdzplbGxpcHNpczsiIj48YSBocmVmPSIiIiYgdCAmICIjY210IiAmIG9ialJTKCJjb21tX0lEIikgJiAiIiIgdGl0bGU9IiIiICYgb2JqUlMoImNvbW1fUG9zdFRpbWUiKSAmICIgcG9zdCBieSAiICYgSUlmKFVzZXJzKG9ialJTKCJjb21tX0F1dGhvcklEIikpLkxldmVsPTUsb2JqUlMoImNvbW1fQXV0aG9yIiksVXNlcnMob2JqUlMoImNvbW1fQXV0aG9ySUQiKSkuRmlyc3ROYW1lKSAmICIiIj4iK3MrIjwvYT48L2xpPiINCgkJCVNldCBvYmpBcnRpY2xlPU5vdGhpbmcNCgkJCW9ialJTLk1vdmVOZXh0DQoJCQlJZiBvYmpSUy5lb2YgVGhlbiBFeGl0IEZvcg0KCQlOZXh0DQoJRW5kIElmDQoJb2JqUlMuY2xvc2UNCglTZXQgb2JqUlM9Tm90aGluZw0KDQoJc3RyQ29tbWVudHM9VHJhbnNmZXJIVE1MKHN0ckNvbW1lbnRzLCJbbm8tYXNwXSIpDQoNCglGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZSgiY29tbWVudHMiKSkuQ29udGVudD1zdHJDb21tZW50cw0KCUZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKCJjb21tZW50cyIpKS5Qb3N0KCkNCglGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZSgiY29tbWVudHMiKSkuU2F2ZUZpbGUNCg0KCUJsb2dSZUJ1aWxkX0NvbW1lbnRzPVRydWUNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBCbG9nUmVCdWlsZF9HdWVzdENvbW1lbnRzKCkNCg0KCSdwbHVnaW4gbm9kZQ0KCWJBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX0d1ZXN0Q29tbWVudHNfQmVnaW49RmFsc2UNCglGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9HdWVzdENvbW1lbnRzX0JlZ2luIGluIEFjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfR3Vlc3RDb21tZW50c19CZWdpbg0KCQlJZiBOb3QgSXNFbXB0eShzQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9HdWVzdENvbW1lbnRzX0JlZ2luKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9HdWVzdENvbW1lbnRzX0JlZ2luKQ0KCQlJZiBiQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9HdWVzdENvbW1lbnRzX0JlZ2luPVRydWUgVGhlbiBFeGl0IEZ1bmN0aW9uDQoJTmV4dA0KDQoJQmxvZ1JlQnVpbGRfR3Vlc3RDb21tZW50cz1UcnVlDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8mg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gQmxvZ1JlQnVpbGRfVHJhY2tCYWNrcygpDQoNCgkncGx1Z2luIG5vZGUNCgliQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9UcmFja0JhY2tzX0JlZ2luPUZhbHNlDQoJRm9yIEVhY2ggc0FjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfVHJhY2tCYWNrc19CZWdpbiBpbiBBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX1RyYWNrQmFja3NfQmVnaW4NCgkJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfVHJhY2tCYWNrc19CZWdpbikgVGhlbiBDYWxsIEV4ZWN1dGUoc0FjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfVHJhY2tCYWNrc19CZWdpbikNCgkJSWYgYkFjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfVHJhY2tCYWNrc19CZWdpbj1UcnVlIFRoZW4gRXhpdCBGdW5jdGlvbg0KCU5leHQNCg0KCUJsb2dSZUJ1aWxkX1RyYWNrQmFja3M9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEJsb2dSZUJ1aWxkX1N0YXRpc3RpY3MoKQ0KDQoJJ3BsdWdpbiBub2RlDQoJYkFjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfU3RhdGlzdGljc19CZWdpbj1GYWxzZQ0KCUZvciBFYWNoIHNBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX1N0YXRpc3RpY3NfQmVnaW4gaW4gQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9TdGF0aXN0aWNzX0JlZ2luDQoJCUlmIE5vdCBJc0VtcHR5KHNBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX1N0YXRpc3RpY3NfQmVnaW4pIFRoZW4gQ2FsbCBFeGVjdXRlKHNBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX1N0YXRpc3RpY3NfQmVnaW4pDQoJCUlmIGJBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX1N0YXRpc3RpY3NfQmVnaW49VHJ1ZSBUaGVuIEV4aXQgRnVuY3Rpb24NCglOZXh0DQoNCglEaW0gaQ0KCURpbSBvYmpSUw0KCURpbSBvYmpTdHJlYW0NCglDYWxsIEdldEZ1bmN0aW9uKCkNCglJZiBGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZSgic3RhdGlzdGljcyIpKS5Jc0hpZGRlbj1UcnVlIFRoZW4gDQoNCgkJRXhpdCBGdW5jdGlvbg0KCUVuZCBJZg0KDQoJJ1N0YXRpc3RpY3MNCglEaW0gc3RyU3RhdGlzdGljcw0KCVNldCBvYmpSUz1TZXJ2ZXIuQ3JlYXRlT2JqZWN0KCJBRE9EQi5SZWNvcmRzZXQiKQ0KCW9ialJTLkN1cnNvclR5cGUgPSBhZE9wZW5LZXlzZXQNCglvYmpSUy5Mb2NrVHlwZSA9IGFkTG9ja1JlYWRPbmx5DQoJb2JqUlMuQWN0aXZlQ29ubmVjdGlvbj1vYmpDb25uDQoJb2JqUlMuU291cmNlPSIiDQoNCglvYmpSUy5PcGVuKCJTRUxFQ1QgQ09VTlQoW2xvZ19JRF0pQVMgYWxsQXJ0aWNsZSxTVU0oW2xvZ19WaWV3TnVtc10pIEFTIGFsbFZpZXdOdW1zIEZST00gW2Jsb2dfQXJ0aWNsZV0gV0hFUkUgW2xvZ19UeXBlXT0wIikNCglJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoJCXN0clN0YXRpc3RpY3M9c3RyU3RhdGlzdGljcyAmICI8bGk+IiYgWkNfTVNHMDgyICYiOiIgJiBvYmpSUygiYWxsQXJ0aWNsZSIpICYgIjwvbGk+Ig0KCQlzdHJTdGF0aXN0aWNzPXN0clN0YXRpc3RpY3MgJiAiPGxpPiImIFpDX01TRzEyNCAmIjoiICYgb2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgU1VNKFtsb2dfQ29tbU51bXNdKSBGUk9NIFtibG9nX0FydGljbGVdIikoMCkgJiAiPC9saT4iDQoJCXN0clN0YXRpc3RpY3M9c3RyU3RhdGlzdGljcyAmICI8bGk+IiYgWkNfTVNHMTI5ICYiOiIgJiBvYmpSUygiYWxsVmlld051bXMiKSAmICI8L2xpPiINCglFbmQgSWYNCglvYmpSUy5DbG9zZQ0KDQoJc3RyU3RhdGlzdGljcz1zdHJTdGF0aXN0aWNzICYgIjxsaT4iJiBaQ19NU0cyMDQgJiI6IiAmIEdldE5hbWVGb3JtVGhlbWUoWkNfQkxPR19USEVNRSkgJiAiPC9saT4iDQoJJ3N0clN0YXRpc3RpY3M9c3RyU3RhdGlzdGljcyAmICI8bGk+IiYgWkNfTVNHMDgzICYiOiIgJiBaQ19CTE9HX0NTUyAmICI8L2xpPiINCg0KCVNldCBvYmpSUz1Ob3RoaW5nDQoNCglzdHJTdGF0aXN0aWNzPVRyYW5zZmVySFRNTChzdHJTdGF0aXN0aWNzLCJbbm8tYXNwXSIpDQoNCgkNCglGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZSgic3RhdGlzdGljcyIpKS5Db250ZW50PXN0clN0YXRpc3RpY3MNCglGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZSgic3RhdGlzdGljcyIpKS5Qb3N0KCkNCg0KCUJsb2dSZUJ1aWxkX1N0YXRpc3RpY3M9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgQmxvZ1JlQnVpbGQgRnVuY3Rpb25zDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBCbG9nUmVCdWlsZF9GdW5jdGlvbnMNCg0KCSdwbHVnaW4gbm9kZQ0KCWJBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX0Z1bmN0aW9uc19CZWdpbj1GYWxzZQ0KCUZvciBFYWNoIHNBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX0Z1bmN0aW9uc19CZWdpbiBpbiBBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX0Z1bmN0aW9uc19CZWdpbg0KCQlJZiBOb3QgSXNFbXB0eShzQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9GdW5jdGlvbnNfQmVnaW4pIFRoZW4gQ2FsbCBFeGVjdXRlKHNBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX0Z1bmN0aW9uc19CZWdpbikNCgkJSWYgYkFjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfRnVuY3Rpb25zX0JlZ2luPVRydWUgVGhlbiBFeGl0IEZ1bmN0aW9uDQoJTmV4dA0KDQoJSXNSdW5GdW5jdGlvbnM9RmFsc2UNCglDYWxsIEdldEZ1bmN0aW9uKCkNCg0KCUNhbGwgU2F2ZUZ1bmN0aW9uVHlwZSgpDQoNCglEaW0gaSxqLHMsdCxmDQoNCglGb3IgRWFjaCBmIEluIEZ1bmN0aW9ucw0KCQlJZiBJc09iamVjdChmKT1UcnVlIFRoZW4NCgkJCUlmIGYuaWQ+MCBBbmQgZi5Tb3VyY2VUeXBlPD4ib3RoZXIiIFRoZW4NCgkJCQlmLlNhdmVGaWxlDQoJCQlFbmQgSWYNCgkJRW5kIElmIA0KCU5leHQNCg0KDQoJRGltIGFyeUZ1bmN0aW9uSW5PcmRlcg0KCSdhcnlGdW5jdGlvbkluT3JkZXI9R2V0RnVuY3Rpb25PcmRlcigpDQoNCgl0PUdldFRlbXBsYXRlKCJURU1QTEFURV9CX0ZVTkNUSU9OIikNCg0KCWFyeUZ1bmN0aW9uSW5PcmRlcj1TcGxpdChaQ19TSURFQkFSX09SREVSLCI6IikNCglzPSIiDQoJRm9yIEVhY2ggZiBJbiBhcnlGdW5jdGlvbkluT3JkZXINCgkJSWYgRnVuY3Rpb25NZXRhcy5FeGlzdHMoZik9VHJ1ZSBUaGVuDQoJCQlJZiBGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZShmKSkuSXNIaWRkZW49RmFsc2UgVGhlbg0KCQkJCXM9cyAmIEZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKGYpKS5NYWtlVGVtcGxhdGUodCkNCgkJCUVuZCBJZg0KCQlFbmQgSWYNCglOZXh0DQoJQ2FsbCBTYXZlVG9GaWxlKEJsb2dQYXRoICYgInpiX3VzZXJzL2NhY2hlL3NpZGViYXIuYXNwIixzLCJ1dGYtOCIsRmFsc2UpDQoNCglhcnlGdW5jdGlvbkluT3JkZXI9U3BsaXQoWkNfU0lERUJBUl9PUkRFUjIsIjoiKQ0KCXM9IiINCglGb3IgRWFjaCBmIEluIGFyeUZ1bmN0aW9uSW5PcmRlcg0KCQlJZiBGdW5jdGlvbk1ldGFzLkV4aXN0cyhmKT1UcnVlIFRoZW4NCgkJCUlmIEZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKGYpKS5Jc0hpZGRlbj1GYWxzZSBUaGVuDQoJCQkJcz1zICYgRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUoZikpLk1ha2VUZW1wbGF0ZSh0KQ0KCQkJRW5kIElmDQoJCUVuZCBJZg0KCU5leHQNCglDYWxsIFNhdmVUb0ZpbGUoQmxvZ1BhdGggJiAiemJfdXNlcnMvY2FjaGUvc2lkZWJhcjIuYXNwIixzLCJ1dGYtOCIsRmFsc2UpDQoNCglhcnlGdW5jdGlvbkluT3JkZXI9U3BsaXQoWkNfU0lERUJBUl9PUkRFUjMsIjoiKQ0KCXM9IiINCglGb3IgRWFjaCBmIEluIGFyeUZ1bmN0aW9uSW5PcmRlcg0KCQlJZiBGdW5jdGlvbk1ldGFzLkV4aXN0cyhmKT1UcnVlIFRoZW4NCgkJCUlmIEZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKGYpKS5Jc0hpZGRlbj1GYWxzZSBUaGVuDQoJCQkJcz1zICYgRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUoZikpLk1ha2VUZW1wbGF0ZSh0KQ0KCQkJRW5kIElmDQoJCUVuZCBJZg0KCU5leHQNCglDYWxsIFNhdmVUb0ZpbGUoQmxvZ1BhdGggJiAiemJfdXNlcnMvY2FjaGUvc2lkZWJhcjMuYXNwIixzLCJ1dGYtOCIsRmFsc2UpDQoNCglhcnlGdW5jdGlvbkluT3JkZXI9U3BsaXQoWkNfU0lERUJBUl9PUkRFUjQsIjoiKQ0KCXM9IiINCglGb3IgRWFjaCBmIEluIGFyeUZ1bmN0aW9uSW5PcmRlcg0KCQlJZiBGdW5jdGlvbk1ldGFzLkV4aXN0cyhmKT1UcnVlIFRoZW4NCgkJCUlmIEZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKGYpKS5Jc0hpZGRlbj1GYWxzZSBUaGVuDQoJCQkJcz1zICYgRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUoZikpLk1ha2VUZW1wbGF0ZSh0KQ0KCQkJRW5kIElmDQoJCUVuZCBJZg0KCU5leHQNCglDYWxsIFNhdmVUb0ZpbGUoQmxvZ1BhdGggJiAiemJfdXNlcnMvY2FjaGUvc2lkZWJhcjQuYXNwIixzLCJ1dGYtOCIsRmFsc2UpDQoNCglhcnlGdW5jdGlvbkluT3JkZXI9U3BsaXQoWkNfU0lERUJBUl9PUkRFUjUsIjoiKQ0KCXM9IiINCglGb3IgRWFjaCBmIEluIGFyeUZ1bmN0aW9uSW5PcmRlcg0KCQlJZiBGdW5jdGlvbk1ldGFzLkV4aXN0cyhmKT1UcnVlIFRoZW4NCgkJCUlmIEZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKGYpKS5Jc0hpZGRlbj1GYWxzZSBUaGVuDQoJCQkJcz1zICYgRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUoZikpLk1ha2VUZW1wbGF0ZSh0KQ0KCQkJRW5kIElmDQoJCUVuZCBJZg0KCU5leHQNCglDYWxsIFNhdmVUb0ZpbGUoQmxvZ1BhdGggJiAiemJfdXNlcnMvY2FjaGUvc2lkZWJhcjUuYXNwIixzLCJ1dGYtOCIsRmFsc2UpDQonCU5leHQNCg0KCUJsb2dSZUJ1aWxkX0Z1bmN0aW9ucz1UcnVlDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBCbG9nUmVCdWlsZCBEZWZhdWx0DQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBCbG9nUmVCdWlsZF9EZWZhdWx0DQoNCgkncGx1Z2luIG5vZGUNCgliQWN0aW9uX1BsdWdpbl9CbG9nUmVCdWlsZF9EZWZhdWx0X0JlZ2luPUZhbHNlDQoJRm9yIEVhY2ggc0FjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfRGVmYXVsdF9CZWdpbiBpbiBBY3Rpb25fUGx1Z2luX0Jsb2dSZUJ1aWxkX0RlZmF1bHRfQmVnaW4NCgkJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfRGVmYXVsdF9CZWdpbikgVGhlbiBDYWxsIEV4ZWN1dGUoc0FjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfRGVmYXVsdF9CZWdpbikNCgkJSWYgYkFjdGlvbl9QbHVnaW5fQmxvZ1JlQnVpbGRfRGVmYXVsdF9CZWdpbj1UcnVlIFRoZW4gRXhpdCBGdW5jdGlvbg0KCU5leHQNCg0KCUNhbGwgQ2xlYXJHbG9iZUNhY2hlKCkNCglDYWxsIExvYWRHbG9iZUNhY2hlKCkNCg0KCVRlbXBsYXRlVGFnc0RpYy5JdGVtKCJaQ19CTE9HX0hPU1QiKT0iPCNaQ19CTE9HX0hPU1QjPiINCg0KCURpbSBBcnRMaXN0DQoJU2V0IEFydExpc3Q9TmV3IFRBcnRpY2xlTGlzdA0KDQoJQXJ0TGlzdC5Mb2FkQ2FjaGUNCg0KCUFydExpc3QudGVtcGxhdGU9IkRFRkFVTFQiDQoNCglJZiBBcnRMaXN0LkV4cG9ydCgiIiwiIiwiIiwiIiwiIixaQ19ESVNQTEFZX01PREVfSU5UUk8pIFRoZW4NCg0KCQlBcnRMaXN0LkJ1aWxkDQoNCgkJQ2FsbCBTYXZlVG9GaWxlKEJsb2dQYXRoICYgInpiX3VzZXJzL0NBQ0hFL2RlZmF1bHQuYXNwIixBcnRMaXN0Lmh0bWwsInV0Zi04IixGYWxzZSkgDQoNCglFbmQgSWYNCg0KDQoJQmxvZ1JlQnVpbGRfRGVmYXVsdD1UcnVlDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQoNCicvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgRXhwb3J0IFJTUyAyLjANCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEV4cG9ydFJTUygpDQoNCgkncGx1Z2luIG5vZGUNCgliQWN0aW9uX1BsdWdpbl9FeHBvcnRSU1NfQmVnaW49RmFsc2UNCglGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9FeHBvcnRSU1NfQmVnaW4gaW4gQWN0aW9uX1BsdWdpbl9FeHBvcnRSU1NfQmVnaW4NCgkJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fRXhwb3J0UlNTX0JlZ2luKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9FeHBvcnRSU1NfQmVnaW4pDQoJCUlmIGJBY3Rpb25fUGx1Z2luX0V4cG9ydFJTU19CZWdpbj1UcnVlIFRoZW4gRXhpdCBGdW5jdGlvbg0KCU5leHQNCg0KCURpbSBSc3MyRXhwb3J0DQoJRGltIG9iakFydGljbGUNCg0KCVNldCBSc3MyRXhwb3J0ID0gTmV3IFROZXdSc3MyRXhwb3J0DQoNCglXaXRoIFJzczJFeHBvcnQNCg0KCQkuVGltZVpvbmU9WkNfVElNRV9aT05FDQoNCgkJLkFkZENoYW5uZWxBdHRyaWJ1dGUgInRpdGxlIixUcmFuc2ZlckhUTUwoWkNfQkxPR19USVRMRSwiW2h0bWwtZm9ybWF0XSIpDQoJCS5BZGRDaGFubmVsQXR0cmlidXRlICJsaW5rIixUcmFuc2ZlckhUTUwoQmxvZ0hvc3QsIltodG1sLWZvcm1hdF0iKQ0KCQkuQWRkQ2hhbm5lbEF0dHJpYnV0ZSAiZGVzY3JpcHRpb24iLFRyYW5zZmVySFRNTChaQ19CTE9HX1NVQlRJVExFLCJbaHRtbC1mb3JtYXRdIikNCgkJLkFkZENoYW5uZWxBdHRyaWJ1dGUgImdlbmVyYXRvciIsIlJhaW5ib3dTb2Z0IFN0dWRpbyBaLUJsb2cgIiAmIFpDX0JMT0dfVkVSU0lPTg0KCQkuQWRkQ2hhbm5lbEF0dHJpYnV0ZSAibGFuZ3VhZ2UiLFpDX0JMT0dfTEFOR1VBR0UNCgkJLkFkZENoYW5uZWxBdHRyaWJ1dGUgInB1YkRhdGUiLEdldFRpbWUoTm93KCkpDQoNCgkJCURpbSBpDQoJCQlEaW0gb2JqUlMNCgkJCVNldCBvYmpSUz1vYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBUT1AgIiZaQ19SU1MyX0NPVU5UJiIgW2xvZ19JRF0sW2xvZ19UYWddLFtsb2dfQ2F0ZUlEXSxbbG9nX1RpdGxlXSxbbG9nX0ludHJvXSxbbG9nX0NvbnRlbnRdLFtsb2dfTGV2ZWxdLFtsb2dfQXV0aG9ySURdLFtsb2dfUG9zdFRpbWVdLFtsb2dfQ29tbU51bXNdLFtsb2dfVmlld051bXNdLFtsb2dfVHJhY2tCYWNrTnVtc10sW2xvZ19VcmxdLFtsb2dfSXN0b3BdLFtsb2dfVGVtcGxhdGVdLFtsb2dfRnVsbFVybF0sW2xvZ19UeXBlXSxbbG9nX01ldGFdIEZST00gW2Jsb2dfQXJ0aWNsZV0gV0hFUkUgKFtsb2dfVHlwZV09MCkgQW5kIChbbG9nX0lEXT4wKSBBTkQgKFtsb2dfTGV2ZWxdPjIpIE9SREVSIEJZIFtsb2dfUG9zdFRpbWVdIERFU0MiKQ0KDQoJCQlJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoJCQkJRm9yIGk9MSB0byBaQ19SU1MyX0NPVU5UDQoJCQkJCVNldCBvYmpBcnRpY2xlPU5ldyBUQXJ0aWNsZQ0KCQkJCQlJZiBvYmpBcnRpY2xlLkxvYWRJbmZvQnlBcnJheShBcnJheShvYmpSUygwKSxvYmpSUygxKSxvYmpSUygyKSxvYmpSUygzKSxvYmpSUyg0KSxvYmpSUyg1KSxvYmpSUyg2KSxvYmpSUyg3KSxvYmpSUyg4KSxvYmpSUyg5KSxvYmpSUygxMCksb2JqUlMoMTEpLG9ialJTKDEyKSxvYmpSUygxMyksb2JqUlMoMTQpLG9ialJTKDE1KSxvYmpSUygxNiksb2JqUlMoMTcpKSkgVGhlbg0KDQoJCQkJCUlmIFpDX1JTU19FWFBPUlRfV0hPTEUgVGhlbg0KCQkJCQkuQWRkSXRlbSBvYmpBcnRpY2xlLkh0bWxUaXRsZSxVc2VycyhvYmpBcnRpY2xlLkF1dGhvcklEKS5FbWFpbCAmICIgKCIgJiBVc2VycyhvYmpBcnRpY2xlLkF1dGhvcklEKS5GaXJzdE5hbWUgJiAiKSIsb2JqQXJ0aWNsZS5IdG1sVXJsLG9iakFydGljbGUuUG9zdFRpbWUsb2JqQXJ0aWNsZS5IdG1sVXJsLG9iakFydGljbGUuSHRtbENvbnRlbnQsQ2F0ZWdvcnlzKG9iakFydGljbGUuQ2F0ZUlEKS5IdG1sTmFtZSxvYmpBcnRpY2xlLkNvbW1lbnRVcmwsb2JqQXJ0aWNsZS5XZndDb21tZW50LG9iakFydGljbGUuV2Z3Q29tbWVudFJzcyxvYmpBcnRpY2xlLlRyYWNrQmFja1VybA0KCQkJCQlFbHNlDQoJCQkJCS5BZGRJdGVtIG9iakFydGljbGUuSHRtbFRpdGxlLFVzZXJzKG9iakFydGljbGUuQXV0aG9ySUQpLkVtYWlsICYgIiAoIiAmIFVzZXJzKG9iakFydGljbGUuQXV0aG9ySUQpLkZpcnN0TmFtZSAmICIpIixvYmpBcnRpY2xlLkh0bWxVcmwsb2JqQXJ0aWNsZS5Qb3N0VGltZSxvYmpBcnRpY2xlLkh0bWxVcmwsb2JqQXJ0aWNsZS5IdG1sSW50cm8sQ2F0ZWdvcnlzKG9iakFydGljbGUuQ2F0ZUlEKS5IdG1sTmFtZSxvYmpBcnRpY2xlLkNvbW1lbnRVcmwsb2JqQXJ0aWNsZS5XZndDb21tZW50LG9iakFydGljbGUuV2Z3Q29tbWVudFJzcyxvYmpBcnRpY2xlLlRyYWNrQmFja1VybA0KCQkJCQlFbmQgSWYNCg0KCQkJCQlFbmQgSWYNCgkJCQkJb2JqUlMuTW92ZU5leHQNCgkJCQkJSWYgb2JqUlMuZW9mIFRoZW4gRXhpdCBGb3INCgkJCQkJU2V0IG9iakFydGljbGU9Tm90aGluZw0KCQkJCU5leHQNCgkJCUVuZCBJZg0KDQoJRW5kIFdpdGgNCg0KCVJzczJFeHBvcnQuU2F2ZVRvRmlsZShCbG9nUGF0aCAmICJ6Yl91c2Vycy9jYWNoZS9yc3MueG1sIikNCg0KCVNldCBSc3MyRXhwb3J0ID0gTm90aGluZw0KDQoJb2JqUlMuY2xvc2UNCglTZXQgb2JqUlM9Tm90aGluZw0KCUV4cG9ydFJTUz1UcnVlDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBFeHBvcnQgQVRPTSAxLjANCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEV4cG9ydEFUT00oKQ0KDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBCdWlsZCBDYXRlZ29yeQ0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gQnVpbGRDYXRlZ29yeShpbnRQYWdlLGludENhdGVJZCxpbnRBdXRob3JJZCxkdG1ZZWFyTW9udGgsc3RyVGFnc05hbWUsaW50VHlwZSxzdHJEaXJlY3Rvcnksc3RyRmlsZU5hbWUpDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBCdWlsZCBBcnRpY2xlDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBCdWlsZEFydGljbGUoaW50SUQsYm9sQnVpbGROYXZpZ2F0ZSxib2xCdWlsZENhdGVnb3J5KQ0KDQoJRGltIG9iakFydGljbGUNCglTZXQgb2JqQXJ0aWNsZT1OZXcgVEFydGljbGUNCg0KCUlmIG9iakFydGljbGUuTG9hZEluZm9CeUlEKGludElEKSBUaGVuDQoJCUlmIG9iakFydGljbGUuRXhwb3J0KFpDX0RJU1BMQVlfTU9ERV9BTEwpIFRoZW4NCgkJCW9iakFydGljbGUuU2F2ZUNhY2hlDQoJCQlvYmpBcnRpY2xlLlN0YXRpc3RpYw0KCQkJb2JqQXJ0aWNsZS5CdWlsZA0KCQkJb2JqQXJ0aWNsZS5TYXZlDQoJCUVuZCBJZg0KDQoJCUlmIFpDX1BPU1RfU1RBVElDX01PREU9IlNUQVRJQyIgVGhlbg0KDQoJCQlJZiAoYm9sQnVpbGROYXZpZ2F0ZT1UcnVlKSBBbmQgKFpDX1VTRV9OQVZJR0FURV9BUlRJQ0xFPVRydWUpIFRoZW4NCg0KCQkJCURpbSBvYmpSUw0KCQkJCVNldCBvYmpSUz1vYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBUT1AgMSBbbG9nX0lEXSBGUk9NIFtibG9nX0FydGljbGVdIFdIRVJFIChbbG9nX0xldmVsXT4yKSBBTkQgKFtsb2dfVHlwZV09MCkgQU5EIChbbG9nX1Bvc3RUaW1lXTwiICYgWkNfU1FMX1BPVU5EX0tFWSAmIG9iakFydGljbGUuUG9zdFRpbWUgJiBaQ19TUUxfUE9VTkRfS0VZICYiKSBPUkRFUiBCWSBbbG9nX1Bvc3RUaW1lXSBERVNDIikNCgkJCQlJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoJCQkJCUNhbGwgQnVpbGRBcnRpY2xlKG9ialJTKCJsb2dfSUQiKSxGYWxzZSxGYWxzZSkNCgkJCQlFbmQgSWYNCgkJCQlTZXQgb2JqUlM9Tm90aGluZw0KCQkJCVNldCBvYmpSUz1vYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBUT1AgMSBbbG9nX0lEXSBGUk9NIFtibG9nX0FydGljbGVdIFdIRVJFIChbbG9nX0xldmVsXT4yKSBBTkQgKFtsb2dfVHlwZV09MCkgQU5EIChbbG9nX1Bvc3RUaW1lXT4iICYgWkNfU1FMX1BPVU5EX0tFWSAmIG9iakFydGljbGUuUG9zdFRpbWUgJiBaQ19TUUxfUE9VTkRfS0VZICYiKSBPUkRFUiBCWSBbbG9nX1Bvc3RUaW1lXSBBU0MiKQ0KCQkJCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCgkJCQkJQ2FsbCBCdWlsZEFydGljbGUob2JqUlMoImxvZ19JRCIpLEZhbHNlLEZhbHNlKQ0KCQkJCUVuZCBJZg0KCQkJCVNldCBvYmpSUz1Ob3RoaW5nDQoNCgkJCUVuZCBJZg0KDQoJCUVuZCBJZg0KDQoJCUJ1aWxkQXJ0aWNsZT1UcnVlDQoNCglFbmQgSWYNCg0KCVNldCBvYmpBcnRpY2xlPU5vdGhpbmcNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIEdldFVzZXJzYnlVc2VySURMaXN0DQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBHZXRVc2Vyc2J5VXNlcklETGlzdChzdHJVc2VycykNCidzdHJUYWdzPTEsMiwzLDQsNSw2LDcsOA0KDQpJZiBzdHJVc2Vycz0iIiBUaGVuIEV4aXQgRnVuY3Rpb24NCg0KRGltIHMsdCxpLGosZA0KDQp0PVNwbGl0KHN0clVzZXJzLCIsIikNCg0KU2V0IGQgPSBDcmVhdGVPYmplY3QoIlNjcmlwdGluZy5EaWN0aW9uYXJ5IikNCg0KRm9yIGk9TEJvdW5kKHQpIFRvIFVCb3VuZCh0KQ0KCUlmIFRyaW0odChpKSk8PiIiIFRoZW4NCgkJSWYgVUJvdW5kKFVzZXJzKT49dChpKSBUaGVuDQoJCQlJZiBJc09iamVjdChVc2Vycyh0KGkpKSk9RmFsc2UgVGhlbg0KCQkJCUlmIGQuRXhpc3RzKHQoaSkpPUZhbHNlIFRoZW4gQ2FsbCBkLmFkZCh0KGkpLHQoaSkpDQoJCQlFbmQgSWYNCgkJRWxzZQ0KCQkJSWYgZC5FeGlzdHModChpKSk9RmFsc2UgVGhlbiBDYWxsIGQuYWRkKHQoaSksdChpKSkNCgkJRW5kIElmDQoJRW5kIElmDQpOZXh0DQoNCnQgPSBkLktleXMNCkZvciBpID0gMCBUbyBkLkNvdW50IC0xDQoNCglJZiBVQm91bmQoVXNlcnMpPj1DTG5nKHQoaSkpIFRoZW4NCgkJSWYgSXNPYmplY3QoVXNlcnModChpKSkpPUZhbHNlIFRoZW4gDQoJCQlqPWorMQ0KCQkJcz1zICYgIihbbWVtX0lEXT0iJkNMbmcodChpKSkmIikgT3IiDQoJCUVuZCBJZg0KCUVsc2UNCgkJaj1qKzENCgkJcz1zICYgIihbbWVtX0lEXT0iJkNMbmcodChpKSkmIikgT3IiDQoJRW5kIElmDQoJSWYgaj0xMDAgVGhlbg0KCQlDYWxsIEdldFVzZXJzX1N1YihzKQ0KCQlqPTANCgkJcz0iIg0KCUVuZCBJZg0KTmV4dA0KDQpDYWxsIEdldFVzZXJzX1N1YihzKQ0KDQpHZXRVc2Vyc2J5VXNlcklETGlzdD1UcnVlDQoNCg0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgR2V0VXNlcnNieVVzZXLlrZDlh73mlbANCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNClN1YiBHZXRVc2Vyc19TdWIocykNCg0KSWYgTGVuKHMpPjIgVGhlbiANCglzPUxlZnQocyxMZW4ocyktMikNCkVsc2UNCglFeGl0IFN1Yg0KRW5kIElmDQoNCkRpbSBvYmpSUw0KRGltIG9ialVzZXINCg0KU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFttZW1fSURdLFttZW1fTmFtZV0sW21lbV9MZXZlbF0sW21lbV9QYXNzd29yZF0sW21lbV9FbWFpbF0sW21lbV9Ib21lUGFnZV0sW21lbV9Qb3N0TG9nc10sW21lbV9VcmxdLFttZW1fVGVtcGxhdGVdLFttZW1fRnVsbFVybF0sW21lbV9JbnRyb10sW21lbV9NZXRhXSBGUk9NIFtibG9nX01lbWJlcl0gV0hFUkUgKCIgJiBzICYgIikiKQ0KDQpJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoNCglEbyBXaGlsZSBOb3Qgb2JqUlMuZW9mDQoNCgkJU2V0IG9ialVzZXI9TmV3IFRVc2VyDQoJCUNhbGwgb2JqVXNlci5Mb2FkSW5mb0J5QXJyYXkoQXJyYXkob2JqUlMoMCksb2JqUlMoMSksb2JqUlMoMiksb2JqUlMoMyksb2JqUlMoNCksb2JqUlMoNSksb2JqUlMoNiksb2JqUlMoNyksb2JqUlMoOCksb2JqUlMoOSksb2JqUlMoMTApLG9ialJTKDExKSkpDQoNCgkJSWYgVUJvdW5kKFVzZXJzKTxvYmpVc2VyLklEIFRoZW4NCgkJCVJlRGltIFByZXNlcnZlIFVzZXJzKG9ialVzZXIuSUQpDQoJCUVuZCBJZg0KDQoJCVNldCBVc2VycyhvYmpVc2VyLklEKT1vYmpVc2VyDQoNCgkJU2V0IG9ialVzZXI9Tm90aGluZw0KDQoJCW9ialJTLk1vdmVOZXh0DQoJTG9vcA0KDQpFbmQgSWYNCg0Kb2JqUlMuQ2xvc2UNClNldCBvYmpSUz1Ob3RoaW5nDQoNCkVuZCBTdWINCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgR2V0VGFnc2J5VGFnSURMaXN0DQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBHZXRUYWdzYnlUYWdJRExpc3Qoc3RyVGFncykNCidzdHJUYWdzPXsxfXsyfXszfXs0fQ0KDQpJZiBzdHJUYWdzPSIiIFRoZW4gRXhpdCBGdW5jdGlvbg0KSWYgc3RyVGFncz0ie30iIFRoZW4gRXhpdCBGdW5jdGlvbg0KSWYgSXNOdWxsKHN0clRhZ3MpIFRoZW4gRXhpdCBGdW5jdGlvbg0KDQpEaW0gcyx0LGksaixkDQpzdHJUYWdzPVJlcGxhY2Uoc3RyVGFncywifSIsIiIpDQp0PVNwbGl0KHN0clRhZ3MsInsiKQ0KDQpTZXQgZCA9IENyZWF0ZU9iamVjdCgiU2NyaXB0aW5nLkRpY3Rpb25hcnkiKQ0KDQpGb3IgaT1MQm91bmQodCkgVG8gVUJvdW5kKHQpDQoJSWYgVHJpbSh0KGkpKTw+IiIgVGhlbg0KCQlJZiBVQm91bmQoVGFncyk+PXQoaSkgVGhlbg0KCQkJSWYgSXNPYmplY3QoVGFncyh0KGkpKSk9RmFsc2UgVGhlbg0KCQkJCUlmIGQuRXhpc3RzKHQoaSkpPUZhbHNlIFRoZW4gQ2FsbCBkLmFkZCh0KGkpLHQoaSkpDQoJCQlFbmQgSWYNCgkJRWxzZQ0KCQkJSWYgZC5FeGlzdHModChpKSk9RmFsc2UgVGhlbiBDYWxsIGQuYWRkKHQoaSksdChpKSkNCgkJRW5kIElmDQoJRW5kIElmDQpOZXh0DQoNCnQgPSBkLktleXMNCkZvciBpID0gMCBUbyBkLkNvdW50IC0xDQoNCglJZiBVQm91bmQoVGFncyk+PUNMbmcodChpKSkgVGhlbg0KCQlJZiBJc09iamVjdChUYWdzKHQoaSkpKT1GYWxzZSBUaGVuIA0KCQkJaj1qKzENCgkJCXM9cyAmICIoW3RhZ19JRF09IiZDTG5nKHQoaSkpJiIpIE9yIg0KCQlFbmQgSWYNCglFbHNlDQoJCWo9aisxDQoJCXM9cyAmICIoW3RhZ19JRF09IiZDTG5nKHQoaSkpJiIpIE9yIg0KCUVuZCBJZg0KCUlmIGo9MTAwIFRoZW4NCgkJQ2FsbCBHZXRUYWdzX1N1YihzKQ0KCQlqPTANCgkJcz0iIg0KCUVuZCBJZg0KTmV4dA0KDQpDYWxsIEdldFRhZ3NfU3ViKHMpDQoNCkdldFRhZ3NieVRhZ0lETGlzdD1UcnVlDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBHZXRUYWdzYnlUYWflrZDlh73mlbANCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNClN1YiBHZXRUYWdzX1N1YihzKQ0KDQpJZiBMZW4ocyk+MiBUaGVuIA0KCXM9TGVmdChzLExlbihzKS0yKQ0KRWxzZQ0KCUV4aXQgU3ViDQpFbmQgSWYNCg0KRGltIG9ialJTDQpEaW0gb2JqVGFnDQoNClNldCBvYmpSUz1vYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBbdGFnX0lEXSxbdGFnX05hbWVdLFt0YWdfSW50cm9dLFt0YWdfT3JkZXJdLFt0YWdfQ291bnRdLFt0YWdfUGFyZW50SURdLFt0YWdfVVJMXSxbdGFnX1RlbXBsYXRlXSxbdGFnX0Z1bGxVcmxdLFt0YWdfTWV0YV0gRlJPTSBbYmxvZ19UYWddIFdIRVJFICgiICYgcyAmICIpIikNCg0KSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KDQoJRG8gV2hpbGUgTm90IG9ialJTLmVvZg0KDQoJCVNldCBvYmpUYWc9TmV3IFRUYWcNCgkJQ2FsbCBvYmpUYWcuTG9hZEluZm9CeUFycmF5KEFycmF5KG9ialJTKDApLG9ialJTKDEpLG9ialJTKDIpLG9ialJTKDMpLG9ialJTKDQpLG9ialJTKDUpLG9ialJTKDYpLG9ialJTKDcpLG9ialJTKDgpLG9ialJTKDkpKSkNCg0KCQlJZiBVQm91bmQoVGFncyk8b2JqVGFnLklEIFRoZW4NCgkJCVJlRGltIFByZXNlcnZlIFRhZ3Mob2JqVGFnLklEKQ0KCQlFbmQgSWYNCg0KCQlTZXQgVGFncyhvYmpUYWcuSUQpPW9ialRhZw0KDQoJCVNldCBvYmpUYWc9Tm90aGluZw0KDQoJCW9ialJTLk1vdmVOZXh0DQoJTG9vcA0KDQpFbmQgSWYNCg0Kb2JqUlMuQ2xvc2UNClNldCBvYmpSUz1Ob3RoaW5nDQoNCkVuZCBTdWINCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgR2V0VGFnc2J5VGFnTmFtZUxpc3QNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEdldFRhZ3NieVRhZ05hbWVMaXN0KHN0clRhZ3MpDQonc3RyVGFncz1hLGIsYyxkLGUsZixnDQoNClNldCBUYWdzKDApPU5ldyBUVGFnDQoNCklmIHN0clRhZ3M9IiIgVGhlbiBFeGl0IEZ1bmN0aW9uDQoNCkRpbSBzLHQsaQ0KdD1TcGxpdChzdHJUYWdzLCIsIikNCg0KRm9yIGk9TEJvdW5kKHQpIFRvIFVCb3VuZCh0KQ0KCUlmIFRyaW0odChpKSk8PiIiIFRoZW4NCgkJcz1zICYgIihbdGFnX05hbWVdPSciJkZpbHRlclNRTCh0KGkpKSYiJykgT3IiDQoJRW5kIElmDQpOZXh0DQoNCkNhbGwgR2V0VGFnc19TdWIocykNCg0KR2V0VGFnc2J5VGFnTmFtZUxpc3Q9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBHZXRDb21tZW50Rmxvb3IoSUQpDQoNCglEaW0gaSxqDQoJaT1JRA0KCWo9MA0KDQoJRGltIG9ialJTDQoNCglEbyBXaGlsZSBpPjANCg0KCQlqPWorMQ0KDQoJCVNldCBvYmpSUz1vYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBbY29tbV9QYXJlbnRJRF0gRlJPTSBbYmxvZ19Db21tZW50XSBXSEVSRSBbY29tbV9JRF0gPSIgJiBpKQ0KDQoJCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCgkJCWk9b2JqUlMoMCkNCgkJRWxzZQ0KCQkJaT0wDQoJCUVuZCBJZg0KDQoJTG9vcA0KDQoJR2V0Q29tbWVudEZsb29yPWoNCg0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAg5bqf5byDDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBHZXRGdW5jdGlvbk9yZGVyKCkNCg0KCURpbSBpDQoJRGltIG9ialJTDQoNCglTZXQgb2JqUlM9U2VydmVyLkNyZWF0ZU9iamVjdCgiQURPREIuUmVjb3Jkc2V0IikNCglvYmpSUy5DdXJzb3JUeXBlID0gYWRPcGVuS2V5c2V0DQoJb2JqUlMuTG9ja1R5cGUgPSBhZExvY2tSZWFkT25seQ0KCW9ialJTLkFjdGl2ZUNvbm5lY3Rpb249b2JqQ29ubg0KCW9ialJTLlNvdXJjZT0iIg0KDQoJRGltIGFyeUNhdGVJbk9yZGVyKCkNCglpPTANCg0KCW9ialJTLk9wZW4oIlNFTEVDVCBbZm5faWRdIEZST00gW2Jsb2dfRnVuY3Rpb25dIE9SREVSIEJZIFtmbl9PcmRlcl0gQVNDLFtmbl9JRF0gQVNDIikNCglEbyBXaGlsZSBOb3Qgb2JqUlMuZW9mDQoJCWk9aSsxDQoJCVJlRGltIFByZXNlcnZlIGFyeUNhdGVJbk9yZGVyKGkpDQoJCWFyeUNhdGVJbk9yZGVyKGkpPW9ialJTKCJmbl9JRCIpDQoJCW9ialJTLk1vdmVOZXh0DQoJTG9vcA0KCW9ialJTLkNsb3NlDQoJU2V0IG9ialJTPU5vdGhpbmcNCg0KCUlmIGk+MCBUaGVuIEdldEZ1bmN0aW9uT3JkZXI9YXJ5Q2F0ZUluT3JkZXINCglJZiBpPTAgVGhlbiBHZXRGdW5jdGlvbk9yZGVyPUFycmF5KCkNCg0KCUVyYXNlIGFyeUNhdGVJbk9yZGVyDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8mg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gU2F2ZUZ1bmN0aW9uVHlwZSgpDQoNCglDYWxsIEdldEZ1bmN0aW9uKCkNCg0KCURpbSB0IA0KDQoJU2V0IHQ9TmV3IFRNZXRhDQoNCglEaW0gaQ0KDQoJRm9yIGk9MSBUbyBVQm91bmQoRnVuY3Rpb25zKQ0KCQlJZiBJc09iamVjdChGdW5jdGlvbnMoaSkpPVRydWUgVGhlbg0KDQoJCQlDYWxsIHQuU2V0VmFsdWUoRnVuY3Rpb25zKGkpLkZpbGVOYW1lLEZ1bmN0aW9ucyhpKS5GVHlwZSkNCg0KCQlFbmQgSWYNCglOZXh0DQoNCglDYWxsIFNhdmVUb0ZpbGUoQmxvZ1BhdGggJiAiemJfdXNlcnMvQ0FDSEUvZnVuY3Rpb25zdHlwZS5hc3AiLHQuU2F2ZVN0cmluZywidXRmLTgiLEZhbHNlKQ0KDQoJU2F2ZUZ1bmN0aW9uVHlwZT1UcnVlDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBDcmVhdGUgQWRtaW4gTWVudQ0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gQ3JlYXRlQWRtaW5MZWZ0TWVudSgpDQoNCiflvLrliLbmuIXnqbpNZW51LOmYsuatouafkOS6m+aPkuS7tuaPkOWJjeaPkuWFpemAoOaIkOaOkuWcqOezu+e7n+iPnOWNleS5i+WJjSzmj5Lku7bmj5LlhaXoj5zljZXopoHlnKjns7vnu5/liJ3lp4vljJblrozmiJDlkI4NClJlc3BvbnNlX1BsdWdpbl9BZG1pbl9MZWZ0PSIiDQoNCkNhbGwgQWRkX1Jlc3BvbnNlX1BsdWdpbigiUmVzcG9uc2VfUGx1Z2luX0FkbWluX0xlZnQiLE1ha2VMZWZ0TWVudShHZXRSaWdodHMoIkFydGljbGVFZHQiKSxaQ19NU0cxNjgsQmxvZ0hvc3QmInpiX3N5c3RlbS9jbWQuYXNwP2FjdD1BcnRpY2xlRWR0JmFtcDt3ZWJlZGl0PSImWkNfQkxPR19XRUJFRElULCJuYXZfbmV3IiwiYUFydGljbGVFZHQiLCIiKSkNCkNhbGwgQWRkX1Jlc3BvbnNlX1BsdWdpbigiUmVzcG9uc2VfUGx1Z2luX0FkbWluX0xlZnQiLE1ha2VMZWZ0TWVudShHZXRSaWdodHMoIkFydGljbGVNbmciKSxaQ19NU0cwNjcsQmxvZ0hvc3QmInpiX3N5c3RlbS9jbWQuYXNwP2FjdD1BcnRpY2xlTW5nIiwibmF2X2FydGljbGUiLCJhQXJ0aWNsZU1uZyIsIiIpKQ0KQ2FsbCBBZGRfUmVzcG9uc2VfUGx1Z2luKCJSZXNwb25zZV9QbHVnaW5fQWRtaW5fTGVmdCIsTWFrZUxlZnRNZW51KEdldFJpZ2h0cygiQXJ0aWNsZUFsbCIpLFpDX01TRzExMSxCbG9nSG9zdCYiemJfc3lzdGVtL2NtZC5hc3A/YWN0PUFydGljbGVNbmcmYW1wO3R5cGU9UGFnZSIsIm5hdl9wYWdlIiwiYVBhZ2VNbmciLCIiKSkNCg0KQ2FsbCBBZGRfUmVzcG9uc2VfUGx1Z2luKCJSZXNwb25zZV9QbHVnaW5fQWRtaW5fTGVmdCIsIjxsaSBjbGFzcz0nc3BsaXQnPjxoci8+PC9saT4iKQ0KDQoNCkNhbGwgQWRkX1Jlc3BvbnNlX1BsdWdpbigiUmVzcG9uc2VfUGx1Z2luX0FkbWluX0xlZnQiLE1ha2VMZWZ0TWVudShHZXRSaWdodHMoIkNhdGVnb3J5TW5nIiksWkNfTVNHMDY2LEJsb2dIb3N0JiJ6Yl9zeXN0ZW0vY21kLmFzcD9hY3Q9Q2F0ZWdvcnlNbmciLCJuYXZfY2F0ZWdvcnkiLCJhQ2F0ZWdvcnlNbmciLCIiKSkNCkNhbGwgQWRkX1Jlc3BvbnNlX1BsdWdpbigiUmVzcG9uc2VfUGx1Z2luX0FkbWluX0xlZnQiLE1ha2VMZWZ0TWVudShHZXRSaWdodHMoIlRhZ01uZyIpLFpDX01TRzE0MSxCbG9nSG9zdCYiemJfc3lzdGVtL2NtZC5hc3A/YWN0PVRhZ01uZyIsIm5hdl90YWdzIiwiYVRhZ01uZyIsIiIpKQ0KQ2FsbCBBZGRfUmVzcG9uc2VfUGx1Z2luKCJSZXNwb25zZV9QbHVnaW5fQWRtaW5fTGVmdCIsTWFrZUxlZnRNZW51KEdldFJpZ2h0cygiQ29tbWVudE1uZyIpLFpDX01TRzA2OCxCbG9nSG9zdCYiemJfc3lzdGVtL2NtZC5hc3A/YWN0PUNvbW1lbnRNbmciLCJuYXZfY29tbWVudHMiLCJhQ29tbWVudE1uZyIsIiIpKQ0KQ2FsbCBBZGRfUmVzcG9uc2VfUGx1Z2luKCJSZXNwb25zZV9QbHVnaW5fQWRtaW5fTGVmdCIsTWFrZUxlZnRNZW51KEdldFJpZ2h0cygiRmlsZU1uZyIpLFpDX01TRzA3MSxCbG9nSG9zdCYiemJfc3lzdGVtL2NtZC5hc3A/YWN0PUZpbGVNbmciLCJuYXZfYWNjZXNzb3JpZXMiLCJhRmlsZU1uZyIsIiIpKQ0KQ2FsbCBBZGRfUmVzcG9uc2VfUGx1Z2luKCJSZXNwb25zZV9QbHVnaW5fQWRtaW5fTGVmdCIsTWFrZUxlZnRNZW51KEdldFJpZ2h0cygiVXNlck1uZyIpLFpDX01TRzA3MCxCbG9nSG9zdCYiemJfc3lzdGVtL2NtZC5hc3A/YWN0PVVzZXJNbmciLCJuYXZfdXNlciIsImFVc2VyTW5nIiwiIikpDQoNCkNhbGwgQWRkX1Jlc3BvbnNlX1BsdWdpbigiUmVzcG9uc2VfUGx1Z2luX0FkbWluX0xlZnQiLCI8bGkgY2xhc3M9J3NwbGl0Jz48aHIvPjwvbGk+IikNCg0KQ2FsbCBBZGRfUmVzcG9uc2VfUGx1Z2luKCJSZXNwb25zZV9QbHVnaW5fQWRtaW5fTGVmdCIsTWFrZUxlZnRNZW51KEdldFJpZ2h0cygiVGhlbWVNbmciKSxaQ19NU0cyMjMsQmxvZ0hvc3QmInpiX3N5c3RlbS9jbWQuYXNwP2FjdD1UaGVtZU1uZyIsIm5hdl90aGVtZXMiLCJhVGhlbWVNbmciLCIiKSkNCkNhbGwgQWRkX1Jlc3BvbnNlX1BsdWdpbigiUmVzcG9uc2VfUGx1Z2luX0FkbWluX0xlZnQiLE1ha2VMZWZ0TWVudShHZXRSaWdodHMoIkZ1bmN0aW9uTW5nIiksWkNfTVNHMDA3LEJsb2dIb3N0JiJ6Yl9zeXN0ZW0vY21kLmFzcD9hY3Q9RnVuY3Rpb25NbmciLCJuYXZfZnVuY3Rpb24iLCJhRnVuY3Rpb25NbmciLCIiKSkNCkNhbGwgQWRkX1Jlc3BvbnNlX1BsdWdpbigiUmVzcG9uc2VfUGx1Z2luX0FkbWluX0xlZnQiLE1ha2VMZWZ0TWVudShHZXRSaWdodHMoIlBsdWdJbk1uZyIpLFpDX01TRzEwNyxCbG9nSG9zdCYiemJfc3lzdGVtL2NtZC5hc3A/YWN0PVBsdWdJbk1uZyIsIm5hdl9wbHVnaW4iLCJhUGx1Z0luTW5nIiwiIikpDQoNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIENyZWF0ZSBUb3AgTWVudQ0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gQ3JlYXRlQWRtaW5Ub3BNZW51KCkNCg0KUmVzcG9uc2VfUGx1Z2luX0FkbWluX1RvcD0iIg0KDQpDYWxsIEFkZF9SZXNwb25zZV9QbHVnaW4oIlJlc3BvbnNlX1BsdWdpbl9BZG1pbl9Ub3AiLE1ha2VUb3BNZW51KEdldFJpZ2h0cygiYWRtaW4iKSxaQ19NU0cyNDUsQmxvZ0hvc3QmInpiX3N5c3RlbS9jbWQuYXNwP2FjdD1hZG1pbiIsIiIsIiIpKQ0KQ2FsbCBBZGRfUmVzcG9uc2VfUGx1Z2luKCJSZXNwb25zZV9QbHVnaW5fQWRtaW5fVG9wIixNYWtlVG9wTWVudShHZXRSaWdodHMoIlNldHRpbmdNbmciKSxaQ19NU0cyNDcsQmxvZ0hvc3QmInpiX3N5c3RlbS9jbWQuYXNwP2FjdD1TZXR0aW5nTW5nIiwiIiwiIikpDQpJZiBOb3QgWkNfUE9TVF9TVEFUSUNfTU9ERTw+IlNUQVRJQyIgVGhlbiANCglDYWxsIEFkZF9SZXNwb25zZV9QbHVnaW4oIlJlc3BvbnNlX1BsdWdpbl9BZG1pbl9Ub3AiLE1ha2VUb3BNZW51KEdldFJpZ2h0cygiQXNrRmlsZVJlQnVpbGQiKSxaQ19NU0cwNzMsQmxvZ0hvc3QmInpiX3N5c3RlbS9jbWQuYXNwP2FjdD1Bc2tGaWxlUmVCdWlsZCIsIiIsIiIpKQ0KRW5kIElmDQoNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIGh0bWw9UmVzcG9uc2VfUGx1Z2luX0FkbWluX0xlZnQNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIFJlc3BvbnNlQWRtaW5MZWZ0TWVudShodG1sKQ0KCUNhbGwgRmlsdGVyX1BsdWdpbl9SZXNwb25zZUFkbWluTGVmdE1lbnUoaHRtbCkNCglSZXNwb25zZUFkbWluTGVmdE1lbnU9aHRtbA0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIGh0bWw9UmVzcG9uc2VfUGx1Z2luX0FkbWluX1RvcA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gUmVzcG9uc2VBZG1pblRvcE1lbnUoaHRtbCkNCglDYWxsIEZpbHRlcl9QbHVnaW5fUmVzcG9uc2VBZG1pblRvcE1lbnUoaHRtbCkNCglSZXNwb25zZUFkbWluVG9wTWVudT1odG1sDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgU2VhcmNoIENoaWxkIENvbW1lbnRzJ+mAkuW9kg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gU2VhcmNoQ2hpbGRDb21tZW50cyhCeVZhbCBpZCxCeVJlZiBhbGxjb21tKQ0KDQoJSWYgSXNPYmplY3QoYWxsY29tbSk9RmFsc2UgVGhlbg0KCQlTZXQgYWxsY29tbT1DcmVhdGVPYmplY3QoIlNjcmlwdGluZy5EaWN0aW9uYXJ5IikNCglFbmQgSWYNCg0KCURpbSBvYmpSUw0KCVNldCBvYmpSUz1vYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBbY29tbV9JRF0gRlJPTSBbYmxvZ19Db21tZW50XSBXSEVSRSBbY29tbV9QYXJlbnRJRF09IiZpZCkNCglJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoJCURvIFdoaWxlIE5vdCBvYmpSUy5lb2YNCgkJCUlmIGFsbGNvbW0uRXhpc3RzKG9ialJTKCJjb21tX0lEIikpPUZhbHNlIFRoZW4NCgkJCQlhbGxjb21tLmFkZCBDTG5nKG9ialJTKCJjb21tX0lEIikpLCIiDQoJCQlFbmQgSWYNCgkJCUNhbGwgU2VhcmNoQ2hpbGRDb21tZW50cyhvYmpSUygiY29tbV9JRCIpLGFsbGNvbW0pDQoJCQlvYmpSUy5Nb3ZlTmV4dA0KCQlMb29wDQoJCVNlYXJjaENoaWxkQ29tbWVudHM9VHJ1ZQ0KCUVsc2UNCgkJU2VhcmNoQ2hpbGRDb21tZW50cz1GYWxzZQ0KCUVuZCBJZg0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgQWRkIEJhdGNoIA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gQWRkQmF0Y2gobmFtZSxhY3Rpb25jb2RlKQ0KDQoJSWYgSXNPYmplY3QoU2Vzc2lvbigiYmF0Y2giKSk9RmFsc2UgVEhlbg0KCQlTZXQgU2Vzc2lvbigiYmF0Y2giKT1DcmVhdGVPYmplY3QoIlNjcmlwdGluZy5EaWN0aW9uYXJ5IikNCgkJU2Vzc2lvbigiYmF0Y2hvcmRlciIpPTANCgkJU2Vzc2lvbigiYmF0Y2h0aW1lIik9MA0KCUVuZCBJZg0KDQoJJ+ajgOWImeaYr+WQpuacquWujOaIkOaJueaTjeS9nCzmnKrlrozmiJDnmoTor53kuI3mlrDlop7liqDmibnmk43kvZwuDQoJSWYgU2Vzc2lvbigiYmF0Y2giKS5Db3VudCA8PiBDTG5nKFNlc3Npb24oImJhdGNob3JkZXIiKSkgVGhlbiBFeGl0IEZ1bmN0aW9uDQoNCglEaW0gaQ0KCWk9U2Vzc2lvbigiYmF0Y2hvcmRlciIpKzENCg0KCVNlc3Npb24oImJhdGNob3JkZXIiKT1pDQoJQ2FsbCBTZXNzaW9uKCJiYXRjaCIpLmFkZCgiPGI+IiAmIGkgJiAiPC9iPiA6IDx1PiIgJiBuYW1lICYgIjwvdT4iLGFjdGlvbmNvZGUpDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBTYXZlIENvbmZpZyB0byBvcHRpb24uYXNwDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBTYXZlQ29uZmlnMk9wdGlvbigpDQoNCglEaW0gc3RyQ29udGVudA0KCXN0ckNvbnRlbnQ9TG9hZEZyb21GaWxlKEJsb2dQYXRoICYgInpiX3N5c3RlbVxkZWZlbmRcY19vcHRpb24uYXNwLmh0bWwiLCJ1dGYtOCIpDQoNCg0KCURpbSBpDQoNCglGb3IgaT0xIFRvIEJsb2dDb25maWcuQ291bnQNCg0KCQlJZiBUcmltKEJsb2dDb25maWcuTWV0YS5HZXRWYWx1ZShCbG9nQ29uZmlnLk1ldGEuTmFtZXMoaSkpKT0iIiBBbmQgSW5TdHIoc3RyQ29udGVudCwiIiIiJiAiPCMiJkJsb2dDb25maWcuTWV0YS5OYW1lcyhpKSYiIz4iICYiIiIiKT0wIFRoZW4NCgkJCXN0ckNvbnRlbnQ9UmVwbGFjZShzdHJDb250ZW50LCI8IyImQmxvZ0NvbmZpZy5NZXRhLk5hbWVzKGkpJiIjPiIsIkVtcHR5IikNCgkJRWxzZQ0KCQkJc3RyQ29udGVudD1SZXBsYWNlKHN0ckNvbnRlbnQsIjwjIiZCbG9nQ29uZmlnLk1ldGEuTmFtZXMoaSkmIiM+IixSZXBsYWNlKEJsb2dDb25maWcuTWV0YS5HZXRWYWx1ZShCbG9nQ29uZmlnLk1ldGEuTmFtZXMoaSkpLCIiIiIsIiIiIiIiKSkNCgkJRW5kIElmDQoNCglOZXh0DQoNCglJZiBJbnN0cihzdHJDb250ZW50LCI8I1pDX0JMT0dfTEFOR1VBR0VQQUNLIz4iKT4wIFRoZW4NCgkJc3RyQ29udGVudD1SZXBsYWNlKHN0ckNvbnRlbnQsIjwjWkNfQkxPR19MQU5HVUFHRVBBQ0sjPiIsIlNpbXBDaGluZXNlIikNCgkJQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19CTE9HX0xBTkdVQUdFUEFDSyIsIlNpbXBDaGluZXNlIikNCglFbmQgSWYNCgkNCglDYWxsIEJsb2dDb25maWcuU2F2ZSgpDQoNCglDYWxsIFNhdmVUb0ZpbGUoQmxvZ1BhdGggJiAiemJfdXNlcnNcY19vcHRpb24uYXNwIixzdHJDb250ZW50LCJ1dGYtOCIsRmFsc2UpDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICDml6XmnJ/nsbvnmoTnroDljJblh73mlbAgUmVnZXgNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIFJlZ2V4YnlEYXRlKHksbSxkKQ0KDQoJUmVnZXhieURhdGU9WkNfREFURV9SRUdFWA0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIOaXpeacn+exu+eahOeugOWMluWHveaVsCBGdWxsUGF0aA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gRnVsbFBhdGgoeSxtLGQpDQoJRnVsbFBhdGg9UGFyc2VDdXN0b21EaXJlY3RvcnlGb3JQYXRoKEZ1bGxSZWdleCxaQ19TVEFUSUNfRElSRUNUT1JZLCIiLCIiLHksbSxkLCIiLCIiLCIiKQ0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICDml6XmnJ/nsbvnmoTnroDljJblh73mlbAgVXJsDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBVcmxieURhdGUoeSxtLGQpDQoNCglVcmxieURhdGU9UGFyc2VDdXN0b21EaXJlY3RvcnlGb3JVcmwoUmVnZXhieURhdGUoeSxtLGQpLFpDX1NUQVRJQ19ESVJFQ1RPUlksIiIsIiIseSxtLGQsIiIsIiIsIiIpDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAg5pel5pyf57G755qE566A5YyW5Ye95pWwIFVybCBhdXRvDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBVcmxieURhdGVBdXRvKHksbSxkKQ0KCURpbSBzDQoJSWYgWkNfU1RBVElDX01PREU9Ik1JWCIgVGhlbg0KCQlzPVBhcnNlQ3VzdG9tRGlyZWN0b3J5Rm9yVXJsKCJ7JWhvc3QlfS9jYXRhbG9nLmFzcD9kYXRlPXsleWVhciV9LXslbW9udGglfSIsWkNfU1RBVElDX0RJUkVDVE9SWSwiIiwiIix5LG0sZCwiIiwiIiwiIikNCglFbHNlDQoJCXM9VXJsYnlEYXRlKHksbSxkKQ0KCUVuZCBJZg0KCUlmIFJpZ2h0KHMsMTIpPSJkZWZhdWx0Lmh0bWwiIFRoZW4gcz1MZWZ0KHMsTGVuKHMpLTEyKQ0KCVVybGJ5RGF0ZUF1dG89cw0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICDliLfmlrBjX29wdGlvbi5hc3Doh7PmlbDmja7lupMgIA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gUmVmcmVzaE9wdGlvbkZvcm1GaWxlVG9EQigpDQoJT24gRXJyb3IgUmVzdW1lIE5leHQNCg0KCUlmIE5vdCBDaGVja1VwZGF0ZURCKCJbZm5fU291cmNlXSIsIltibG9nX0Z1bmN0aW9uXSIpIFRoZW4NCgkJSUYgWkNfTVNTUUxfRU5BQkxFPVRydWUgVGhlbgkNCgkJCW9iakNvbm4uZXhlY3V0ZSgiQUxURVIgVEFCTEUgW2Jsb2dfRnVuY3Rpb25dIEFERCBmbl9Tb3VyY2UgbnZhcmNoYXIoNTApIGRlZmF1bHQgJyciKQ0KCQkJb2JqQ29ubi5leGVjdXRlKCJBTFRFUiBUQUJMRSBbYmxvZ19GdW5jdGlvbl0gQUREIGZuX1ZpZXdUeXBlIG52YXJjaGFyKDUwKSBkZWZhdWx0ICcnIikNCgkJCW9iakNvbm4uZXhlY3V0ZSgiQUxURVIgVEFCTEUgW2Jsb2dfRnVuY3Rpb25dIEFERCBmbl9Jc0hpZGRlbiBiaXQgZGVmYXVsdCAwIikNCgkJRWxzZQ0KCQkJb2JqQ29ubi5leGVjdXRlKCJBTFRFUiBUQUJMRSBbYmxvZ19GdW5jdGlvbl0gQUREIENPTFVNTiBmbl9Tb3VyY2UgVkFSQ0hBUig1MCkgZGVmYXVsdCAiIiIiIikNCgkJCW9iakNvbm4uZXhlY3V0ZSgiQUxURVIgVEFCTEUgW2Jsb2dfRnVuY3Rpb25dIEFERCBDT0xVTU4gZm5fVmlld1R5cGUgVkFSQ0hBUig1MCkgZGVmYXVsdCAiIiIiIikNCgkJCW9iakNvbm4uZXhlY3V0ZSgiQUxURVIgVEFCTEUgW2Jsb2dfRnVuY3Rpb25dIEFERCBDT0xVTU4gZm5fSXNIaWRkZW4gWUVTTk8gREVGQVVMVCAwIikNCgkJRW5kIElmDQoNCgkJb2JqQ29ubi5leGVjdXRlKCJVUERBVEUgW2Jsb2dfRnVuY3Rpb25dIFNFVCBbZm5fU291cmNlXT0nc3lzdGVtJyBXSEVSRSBbZm5fSXNTeXN0ZW1dPD4wIikNCgkJb2JqQ29ubi5leGVjdXRlKCJVUERBVEUgW2Jsb2dfRnVuY3Rpb25dIFNFVCBbZm5fU291cmNlXT0ndXNlcnMnIFdIRVJFIFtmbl9Jc1N5c3RlbV09MCIpDQoJCW9iakNvbm4uZXhlY3V0ZSgiVVBEQVRFIFtibG9nX0Z1bmN0aW9uXSBTRVQgW2ZuX0lzSGlkZGVuXT0wIikNCgkJb2JqQ29ubi5leGVjdXRlKCJVUERBVEUgW2Jsb2dfRnVuY3Rpb25dIFNFVCBbZm5fVmlld1R5cGVdPScnIikNCgkJb2JqQ29ubi5leGVjdXRlKCJVUERBVEUgW2Jsb2dfRnVuY3Rpb25dIFNFVCBbZm5fTWV0YV09JyciKQ0KDQoJCUlGIFpDX01TU1FMX0VOQUJMRT1UcnVlIFRoZW4JDQoJCQlvYmpDb25uLmV4ZWN1dGUoIkFMVEVSIFRBQkxFIFtibG9nX0Z1bmN0aW9uXSBEUk9QIENPTFVNTiBmbl9Jc1N5c3RlbSIpDQoJCUVsc2UNCgkJCW9iakNvbm4uZXhlY3V0ZSgiQUxURVIgVEFCTEUgW2Jsb2dfRnVuY3Rpb25dIERST1AgQ09MVU1OIGZuX0lzU3lzdGVtIikNCgkJRW5kIElmDQoNCgkJSUYgWkNfTVNTUUxfRU5BQkxFPVRydWUgVGhlbgkNCgkJCW9iakNvbm4uZXhlY3V0ZSgiQUxURVIgVEFCTEUgW2Jsb2dfRnVuY3Rpb25dIEFERCBmbl9Jc0hpZGVUaXRsZSBiaXQgZGVmYXVsdCAwIikNCgkJRWxzZQ0KCQkJb2JqQ29ubi5leGVjdXRlKCJBTFRFUiBUQUJMRSBbYmxvZ19GdW5jdGlvbl0gQUREIENPTFVNTiBmbl9Jc0hpZGVUaXRsZSBZRVNOTyBERUZBVUxUIDAiKQ0KCQlFbmQgSWYNCgkJb2JqQ29ubi5leGVjdXRlKCJVUERBVEUgW2Jsb2dfRnVuY3Rpb25dIFNFVCBbZm5fSXNIaWRlVGl0bGVdPTAiKQ0KCUVuZCBJZg0KDQoJRGltIGEsYg0KCWI9TG9hZEZyb21GaWxlKEJsb2dQYXRoICYiemJfdXNlcnNcY19vcHRpb24uYXNwIiwidXRmLTgiKQ0KCUZvciBFYWNoIGEgSW4gQmxvZ0NvbmZpZy5NZXRhLk5hbWVzDQoJCUlmIEluU3RyKGIsIkRpbSAiJiBhKT4wIFRoZW4NCgkJCUNhbGwgRXhlY3V0ZSgiQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCIiIiZhJiIiIiwiJmEmIikiKQ0KCQlFbmQgSWYNCglOZXh0DQoJQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19CTE9HX1ZFUlNJT04iLFJlcGxhY2UoQmxvZ1ZlcnNpb25zLkdldFZhbHVlKEJsb2dWZXJzaW9ucy5OYW1lcygxKSksIlotQmxvZyAiLCIiKSkNCglDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX0JMT0dfQ0xTSUQiLFpDX0JMT0dfQ0xTSURfT1JJR0lOQUwpDQoNCglDYWxsIEJsb2dDb25maWcuU2F2ZSgpDQoNCg0KCUNhbGwgR2V0RnVuY3Rpb24oKQ0KCUlmIEZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKCJjb250cm9scGFuZWwiKSkuQ29udGVudD0iPHNwYW4gY2xhc3M9IiJjcC1sb2dpbiIiPjxhIGhyZWY9IiI8I1pDX0JMT0dfSE9TVCM+emJfc3lzdGVtL2NtZC5hc3A/YWN0PWxvZ2luIiI+WzwjWkNfTVNHMDA5Iz5dPC9hPjwvc3Bhbj4mbmJzcDsmbmJzcDs8c3BhbiBjbGFzcz0iImNwLXZycyIiPjxhIGhyZWY9IiI8I1pDX0JMT0dfSE9TVCM+emJfc3lzdGVtL2NtZC5hc3A/YWN0PXZycyIiPls8I1pDX01TRzAyMSM+XTwvYT48L3NwYW4+IiBUaGVuIA0KCQlGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZSgiY29udHJvbHBhbmVsIikpLkNvbnRlbnQ9IjxzcGFuIGNsYXNzPSIiY3AtaGVsbG8iIj7mgqjlpb0s5qyi6L+O5Yiw6K6/572R56uZITwvc3Bhbj48YnIvPjxzcGFuIGNsYXNzPSIiY3AtbG9naW4iIj48YSBocmVmPSIiPCNaQ19CTE9HX0hPU1QjPnpiX3N5c3RlbS9jbWQuYXNwP2FjdD1sb2dpbiIiPls8I1pDX01TRzAwOSM+XTwvYT48L3NwYW4+Jm5ic3A7Jm5ic3A7PHNwYW4gY2xhc3M9IiJjcC12cnMiIj48YSBocmVmPSIiPCNaQ19CTE9HX0hPU1QjPnpiX3N5c3RlbS9jbWQuYXNwP2FjdD12cnMiIj5bPCNaQ19NU0cwMjEjPl08L2E+PC9zcGFuPiINCgkJRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUoImNvbnRyb2xwYW5lbCIpKS5Qb3N0KCkNCglFbmQgSWYNCg0KCUVyci5DbGVhcg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEdldFZlcnNpb25CeUJ1aWxkKGIpDQoNCglEaW0gcw0KCWI9Q1N0cihiKQ0KDQoJSWYgQmxvZ1ZlcnNpb25zLkV4aXN0cyhiKT1UcnVlIFRoZW4NCgkJcz1CbG9nVmVyc2lvbnMuR2V0VmFsdWUoYikNCglFbHNlDQoJCXM9IlotQmxvZyAyLlggT3RoZXIgQnVpbGQgIiAmIGINCglFbmQgSWYNCg0KCUdldFZlcnNpb25CeUJ1aWxkPXMNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIENoZWNrVXBkYXRlREIoYSxiKQ0KCUVyci5DbGVhcg0KCU9uIEVycm9yIFJlc3VtZSBOZXh0DQoJRGltIFJzDQoJU2V0IFJzPW9iakNvbm4uZXhlY3V0ZSgiU0VMRUNUICImYSYiIEZST00gIiZiKQ0KCVNldCBScz1Ob3RoaW5nDQoJSWYgRXJyLk51bWJlcj0wIFRoZW4NCglDaGVja1VwZGF0ZURCPVRydWUNCglFbHNlDQoJRXJyLkNsZWFyDQoJQ2hlY2tVcGRhdGVEQj1GYWxzZQ0KCUVuZCBJZgkNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBHZXRNZXRhVmFsdWVXaXRoRm9ybShvYmopDQoNCglEaW0gYSxiDQoNCglGb3IgRWFjaCBhIEluIFJlcXVlc3QuRm9ybSANCgkJSWYgTGVmdChhLDUpPSJtZXRhXyIgVGhlbg0KCQkJYj1NaWQoYSw2LExlbihhKSkNCgkJCUNhbGwgb2JqLk1ldGEuU2V0VmFsdWUoIGIsUmVxdWVzdC5Gb3JtKGEpICkNCgkJRW5kIElmDQoJTmV4dA0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogIA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gR2V0RnVuY3Rpb25CeUZpbGVOYW1lKGZuKQ0KDQoJQ2FsbCBHZXRGdW5jdGlvbigpDQoNCglEaW0gb2JqUlNzdWINCglTZXQgb2JqUlNzdWI9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgKiBGUk9NIFtibG9nX0Z1bmN0aW9uXSBXSEVSRSBbZm5fRmlsZU5hbWVdPSciJiBmbiAmIiciICkNCglJZiAoTm90IG9ialJTc3ViLmJvZikgQW5kIChOb3Qgb2JqUlNzdWIuZW9mKSBUaGVuDQoJCVNldCBHZXRGdW5jdGlvbkJ5RmlsZU5hbWU9RnVuY3Rpb25zKG9ialJTc3ViKCJmbl9JRCIpKQ0KCUVsc2UNCgkJU2V0IEdldEZ1bmN0aW9uQnlGaWxlTmFtZT1OZXcgVEZ1bmN0aW9uDQoJRW5kIElmDQoJU2V0IG9ialJTc3ViPU5vdGhpbmcNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaIA0KJyBtb2RlPXtbYWRkXVttb2RpZl1bZGVsXX0NCicgaXRlbXR5cGU9e3BhZ2UsY2F0ZSx0YWdzLOetieetiX0NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEFkZE5hdkJhcihpdGVtdHlwZSxpZCxuYW1lLHVybCxtb2RlKQ0KDQoJQ2FsbCBHZXRGdW5jdGlvbigpDQoNCglEaW0gcyxzMix0LGksaixiDQoNCgliPUZhbHNlDQoNCglEaW0gcmUNCglTZXQgcmUgPSBOZXcgUmVnRXhwDQoJcmUuR2xvYmFsID0gVHJ1ZQ0KCXJlLlBhdHRlcm4gPSAiaHJlZj0iIlteXCIiXSs/IiIiDQoJcmUuSWdub3JlQ2FzZSA9IFRydWUNCg0KCXM9RnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUoIm5hdmJhciIpKS5Db250ZW50DQoJczI9cw0KDQoJdD1TcGxpdChzLCI8L2xpPiIpDQoNCglJZiBVQm91bmQodCk+MCBUaGVuDQoJCUZvciBpPTAgVG8gVUJvdW5kKHQpLTENCgkJCXQoaSk9dChpKSAmICI8L2xpPiINCgkJCWo9dChpKQ0KCQkJSWYgSW5TdHIoaiwibWVudS0iJml0ZW10eXBlJiItIiZpZCk+MCBUaGVuDQoJCQkJSWYgSW5TdHIobW9kZSwiW21vZGlmXSIpPjAgVGhlbg0KCQkJCQlqPXJlLlJlcGxhY2UoaiwiaHJlZj0iIiImdXJsJiIiIiIpDQoJCQkJRW5kIElmDQoJCQkJYj1UcnVlDQoJCQlFbmQgSWYNCg0KCQkJdChpKT1qDQoJCU5leHQNCglFbmQgSWYNCg0KCSdaQ19OQVZCQVJfTUVOVV9JVEVNPSI8bGkgaWQ9IiJtZW51LSV0eXBlLSVpZCIiPjxhIGhyZWY9IiIldXJsIiI+JW5hbWU8L2E+PC9saT4iDQoJSWYgYj1GYWxzZSBBbmQgSW5TdHIobW9kZSwiW2FkZF0iKT4wIFRoZW4NCgkJaT1VQm91bmQodCkNCgkJUmVEaW0gUHJlc2VydmUgdChpKzEpDQoJCWo9WkNfTkFWQkFSX01FTlVfSVRFTQ0KCQlqPVJlcGxhY2UoaiwiJXR5cGUiLGl0ZW10eXBlKQ0KCQlqPVJlcGxhY2UoaiwiJWlkIixpZCkNCgkJaj1SZXBsYWNlKGosIiV1cmwiLHVybCkNCgkJaj1SZXBsYWNlKGosIiVuYW1lIixuYW1lKQ0KCQl0KGkpPWoNCglFbmQgSWYNCg0KCUlmIEluU3RyKG1vZGUsIltkZWxdIik+MCBUaGVuDQoJCUZvciBpPTAgVG8gVUJvdW5kKHQpLTENCgkJCWo9dChpKQ0KCQkJSWYgSW5TdHIoaiwibWVudS0iJml0ZW10eXBlJiItIiZpZCk+MCBUaGVuDQoJCQkJaj0iIg0KCQkJRW5kIElmDQoJCQl0KGkpPWoNCgkJTmV4dA0KCUVuZCBJZg0KDQoJcz1Kb2luKHQsIiIpDQoNCglGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZSgibmF2YmFyIikpLkNvbnRlbnQ9cw0KCUZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKCJuYXZiYXIiKSkuUG9zdCgpDQoNCglJZiBzPD5zMiBUaGVuDQoJCUNhbGwgU2V0QmxvZ0hpbnQoRW1wdHksRW1wdHksVHJ1ZSkNCglFbmQgSWYNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICANCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEdldENhdGVJREJ5TmFtZUFuZEFsaWFzKE5hbWUsQWxpYXMpDQoJRGltIGFyeUNhdGVJbk9yZGVyIDogYXJ5Q2F0ZUluT3JkZXI9R2V0Q2F0ZWdvcnlPcmRlcigpDQoJRGltIG0sbg0KCUZvciBtPUxCb3VuZChhcnlDYXRlSW5PcmRlcikgVG8gVWJvdW5kKGFyeUNhdGVJbk9yZGVyKQ0KCQlJZiBBbGlhcz1DYXRlZ29yeXMoYXJ5Q2F0ZUluT3JkZXIobSkpLkFsaWFzIFRoZW4NCgkJCUdldENhdGVJREJ5TmFtZUFuZEFsaWFzPUNhdGVnb3J5cyhhcnlDYXRlSW5PcmRlcihtKSkuSUQNCgkJCUV4aXQgRnVuY3Rpb24NCgkJRW5kIElmDQoJCUlmIE5hbWU9Q2F0ZWdvcnlzKGFyeUNhdGVJbk9yZGVyKG0pKS5OYW1lIFRoZW4NCgkJCUdldENhdGVJREJ5TmFtZUFuZEFsaWFzPUNhdGVnb3J5cyhhcnlDYXRlSW5PcmRlcihtKSkuSUQNCgkJCUV4aXQgRnVuY3Rpb24NCgkJRW5kIElmDQoJTmV4dA0KCUdldENhdGVJREJ5TmFtZUFuZEFsaWFzPUVtcHR5DQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogIA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gQ29va2llc1BhdGgoKQ0KDQoJRGltIHMNCglzPUJsb2dIb3N0DQoJcz1SaWdodChCbG9nSG9zdCxMZW4oQmxvZ0hvc3QpLUluU3RyKEJMb2dIb3N0LCIvLyIpLTEpDQoJcz1SZXBsYWNlKHMsUmVxdWVzdC5TZXJ2ZXJWYXJpYWJsZXMoIkhUVFBfSE9TVCIpLCIiKQ0KCUlmIHM9IiIgVGhlbiBzPSIvIg0KDQoJQ29va2llc1BhdGg9cw0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogIA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gQ2hlY2tVbmRlZmluZWQoKQ0KDQoJT24gRXJyb3IgUmVzdW1lIE5leHQNCglEaW0gYQ0KCWE9VUNhc2UoTG9hZEZyb21GaWxlKEJsb2dQYXRoICYiemJfdXNlcnNcY19vcHRpb24uYXNwIiwidXRmLTgiKSkNCg0KCUlmIFRyaW0oYSk9IiIgVGhlbiBFeGl0IEZ1bmN0aW9uDQoNCglJZiBJblN0cihhLCJESU0gWkNfU1lOVEFYSElHSExJR0hURVJfRU5BQkxFIik9MCBUaGVuDQoJCUNhbGwgRXhlY3V0ZUdsb2JhbCgiWkNfU1lOVEFYSElHSExJR0hURVJfRU5BQkxFPVRydWUiKQ0KCUVuZCBJZg0KDQoJSWYgSW5TdHIoYSwiRElNIFpDX0NPREVNSVJST1JfRU5BQkxFIik9MCBUaGVuDQoJCUNhbGwgRXhlY3V0ZUdsb2JhbCgiWkNfQ09ERU1JUlJPUl9FTkFCTEU9VHJ1ZSIpDQoJRW5kIElmDQoNCglJZiBJblN0cihhLCJESU0gWkNfQVJUSUNMRV9FWENFUlBUX01BWCIpPTAgVGhlbg0KCQlDYWxsIEV4ZWN1dGVHbG9iYWwoIlpDX0FSVElDTEVfRVhDRVJQVF9NQVg9MjUwIikNCglFbmQgSWYNCg0KCUlmIEluU3RyKGEsIkRJTSBaQ19QT1NUX1NUQVRJQ19NT0RFIik9MCBUaGVuDQoJCUNhbGwgRXhlY3V0ZUdsb2JhbCgiWkNfUE9TVF9TVEFUSUNfTU9ERT0iIlNUQVRJQyIiIikNCglFbmQgSWYNCgkNCglJZiBJblN0cihhLCJESU0gWkNfSFRUUF9MQVNUTU9ESUZJRUQiKT0wIFRoZW4NCgkJQ2FsbCBFeGVjdXRlR2xvYmFsKCJaQ19IVFRQX0xBU1RNT0RJRklFRD1GYWxzZSIpDQoJRW5kIElmDQoNCglJZiBJblN0cihhLCJESU0gWkNfUEVSTUFORU5UX0RPTUFJTl9FTkFCTEUiKT0wIFRoZW4NCgkJQ2FsbCBFeGVjdXRlR2xvYmFsKCJaQ19QRVJNQU5FTlRfRE9NQUlOX0VOQUJMRT1GYWxzZSIpDQoJRW5kIElmDQoNCglJZiBJblN0cihhLCJESU0gWkNfREVGQVVMVF9QQUdFU19URU1QTEFURSIpPTAgVGhlbg0KCQlDYWxsIEV4ZWN1dGVHbG9iYWwoIlpDX0RFRkFVTFRfUEFHRVNfVEVNUExBVEU9IiIiIiIpDQoJRW5kIElmDQoNCglJZiBJblN0cihhLCJESU0gWkNfU0lERUJBUl9PUkRFUiIpPTAgVGhlbg0KCQlDYWxsIEV4ZWN1dGVHbG9iYWwoIlpDX1NJREVCQVJfT1JERVI9IiIiJlpDX0RFRkFVTFRfU0lERUJBUiYiIiIiKQ0KCUVuZCBJZg0KDQoJSWYgSW5TdHIoYSwiRElNIFpDX1NJREVCQVJfT1JERVIyIik9MCBUaGVuDQoJCUNhbGwgRXhlY3V0ZUdsb2JhbCgiWkNfU0lERUJBUl9PUkRFUjI9IiIiIiIpDQoJRW5kIElmDQoNCglJZiBJblN0cihhLCJESU0gWkNfU0lERUJBUl9PUkRFUjMiKT0wIFRoZW4NCgkJQ2FsbCBFeGVjdXRlR2xvYmFsKCJaQ19TSURFQkFSX09SREVSMz0iIiIiIikNCglFbmQgSWYNCg0KCUlmIEluU3RyKGEsIkRJTSBaQ19TSURFQkFSX09SREVSNCIpPTAgVGhlbg0KCQlDYWxsIEV4ZWN1dGVHbG9iYWwoIlpDX1NJREVCQVJfT1JERVI0PSIiIiIiKQ0KCUVuZCBJZg0KDQoJSWYgSW5TdHIoYSwiRElNIFpDX1NJREVCQVJfT1JERVI1Iik9MCBUaGVuDQoJCUNhbGwgRXhlY3V0ZUdsb2JhbCgiWkNfU0lERUJBUl9PUkRFUjU9IiIiIiIpDQoJRW5kIElmDQoJDQoJSWYgSW5TdHIoYSwiRElNIFpDX0JMT0dfTEFOR1VBR0VQQUNLIik9MCBUaGVuDQoJCUNhbGwgRXhlY3V0ZUdsb2JhbCgiWkNfQkxPR19MQU5HVUFHRVBBQ0s9IiJTaW1wQ2hpbmVzZSIiIikNCglFbmQgSWYNCg0KDQoJSWYgSW5TdHIoYSwiRElNIFpDX0NPTU1FTlRfRVhDRVJQVF9NQVgiKT0wIFRoZW4NCgkJQ2FsbCBFeGVjdXRlR2xvYmFsKCJaQ19DT01NRU5UX0VYQ0VSUFRfTUFYPTIwIikNCglFbmQgSWYNCg0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogIA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gR2V0QmxvZ1ZlcnNpb24oKQ0KCURpbSBzDQoJcz1aQ19CTE9HX1ZFUlNJT04NCglzPVJpZ2h0KHMsNikNCglzPVRyaW0ocykNCglzPUNMbmcocykNCglHZXRCbG9nVmVyc2lvbj1zDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJrkuLrkuLvpopjmj5DkvpvnmoTkvr/mjbflh73mlbAs5Y+v5Lul55Sf5oiQ6Ieq5bex55qE5qih5Z2XDQonIOWPguaVsDrkuLvpophJRCzmqKHlnZflkI0s5qih5Z2XSUQo5paH5Lu25ZCNKSzmqKHlnZdIdG1sSUQs5qih5Z2X57G75Z6LKGRpdi91bCks5qih5Z2XTWF4bGko6buY6K6kMCks5qih5Z2X5YaF5a65DQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBBZGRUaGVtZUZ1bmN0aW9uKFRoZW1lSUQsRnVuY3Rpb25OYW1lLEZ1bmN0aW9uRmlsZU5hbWUsRnVuY3Rpb25IdG1sSUQsRnVuY3Rpb25UeXBlLEZ1bmN0aW9uTWF4TGksRnVuY3Rpb25IaWRlVGl0bGUsRnVuY3Rpb25Db250ZW50KQ0KDQoJRGltIG9iakZ1bmN0aW9uDQoJU2V0IG9iakZ1bmN0aW9uPUdldEZ1bmN0aW9uQnlGaWxlTmFtZShGdW5jdGlvbkZpbGVOYW1lKQ0KDQoJb2JqRnVuY3Rpb24uTmFtZT1GdW5jdGlvbk5hbWUNCglvYmpGdW5jdGlvbi5GaWxlTmFtZT1GdW5jdGlvbkZpbGVOYW1lDQoJb2JqRnVuY3Rpb24uSHRtbElEPUZ1bmN0aW9uSHRtbElEDQoJb2JqRnVuY3Rpb24uRnR5cGU9RnVuY3Rpb25UeXBlDQoJb2JqRnVuY3Rpb24uTWF4TGk9RnVuY3Rpb25NYXhMaQ0KCW9iakZ1bmN0aW9uLkNvbnRlbnQ9RnVuY3Rpb25Db250ZW50DQoJb2JqRnVuY3Rpb24uSXNIaWRlVGl0bGU9Q0Jvb2woRnVuY3Rpb25IaWRlVGl0bGUpDQoJb2JqRnVuY3Rpb24uU291cmNlPSJ0aGVtZV8iJiBUaGVtZUlEDQoNCglJZiBvYmpGdW5jdGlvbi5Qb3N0IFRoZW4NCgkJQWRkVGhlbWVGdW5jdGlvbj1UcnVlDQoJRW5kIElmDQoJU2V0IG9iakZ1bmN0aW9uPU5vdGhpbmcNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77ya5Li65o+S5Lu2Li4uIA0KJyDlj4LmlbA65o+S5Lu2SUQs5qih5Z2X5ZCNLOaooeWdl0lEKOaWh+S7tuWQjSks5qih5Z2XSHRtbElELOaooeWdl+exu+WeiyhkaXYvdWwpLOaooeWdl01heGxpKOm7mOiupDApLOaooeWdl+WGheWuuQ0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gQWRkUGx1Z2luRnVuY3Rpb24oUGx1Z2luSUQsRnVuY3Rpb25OYW1lLEZ1bmN0aW9uRmlsZU5hbWUsRnVuY3Rpb25IdG1sSUQsRnVuY3Rpb25UeXBlLEZ1bmN0aW9uTWF4TGksRnVuY3Rpb25IaWRlVGl0bGUsRnVuY3Rpb25Db250ZW50KQ0KDQoJRGltIG9iakZ1bmN0aW9uDQoJU2V0IG9iakZ1bmN0aW9uPUdldEZ1bmN0aW9uQnlGaWxlTmFtZShGdW5jdGlvbkZpbGVOYW1lKQ0KDQoJb2JqRnVuY3Rpb24uTmFtZT1GdW5jdGlvbk5hbWUNCglvYmpGdW5jdGlvbi5GaWxlTmFtZT1GdW5jdGlvbkZpbGVOYW1lDQoJb2JqRnVuY3Rpb24uSHRtbElEPUZ1bmN0aW9uSHRtbElEDQoJb2JqRnVuY3Rpb24uRnR5cGU9RnVuY3Rpb25UeXBlDQoJb2JqRnVuY3Rpb24uTWF4TGk9RnVuY3Rpb25NYXhMaQ0KCW9iakZ1bmN0aW9uLkNvbnRlbnQ9RnVuY3Rpb25Db250ZW50DQoJb2JqRnVuY3Rpb24uSXNIaWRlVGl0bGU9Q0Jvb2woRnVuY3Rpb25IaWRlVGl0bGUpDQoJb2JqRnVuY3Rpb24uU291cmNlPSJwbHVnaW5fIiYgUGx1Z2luSUQNCg0KCUlmIG9iakZ1bmN0aW9uLlBvc3QgVGhlbg0KCQlBZGRQbHVnaW5GdW5jdGlvbj1UcnVlDQoJRW5kIElmDQoJU2V0IG9iakZ1bmN0aW9uPU5vdGhpbmcNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCkZ1bmN0aW9uIENyZWF0ZVZhbGlkQ29kZShzdHJWZXJpZnlOdW1iZXIpDQoJQ2FsbCBGaWx0ZXJfUGx1Z2luX1ZhbGlkQ29kZV9DcmVhdGUoc3RyVmVyaWZ5TnVtYmVyKQ0KRW5kIEZ1bmN0aW9uDQoNCg0KRnVuY3Rpb24gQ2hlY2tWYWxpZENvZGUoc3RySW5wdXROdW1iZXIpDQoJQ2hlY2tWYWxpZENvZGU9RmlsdGVyX1BsdWdpbl9WYWxpZENvZGVfQ2hlY2soc3RySW5wdXROdW1iZXIpDQpFbmQgRnVuY3Rpb24NCg0KDQolPg0K</file>
	<file name='zb_system\FUNCTION\c_system_event.asp' crc32='9C8ECA98'  dt:dt='bin.base64'>77u/PCUNCicvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQonLy8gICAgICAgICAgICAgIFotQmxvZw0KJy8vIOS9nCAgICDogIU6ICAgIOacseeFiih6eC5hc2QpDQonLy8g54mI5p2D5omA5pyJOiAgICBSYWluYm93U29mdCBTdHVkaW8NCicvLyDmioDmnK/mlK/mjIE6ICAgIHJhaW5ib3dzb2Z0QDE2My5jb20NCicvLyDnqIvluo/lkI3np7A6DQonLy8g56iL5bqP54mI5pysOg0KJy8vIOWNleWFg+WQjeensDogICAgY19zeXN0ZW1fZXZlbnQuYXNwDQonLy8g5byA5aeL5pe26Ze0OiAgICAyMDA1LjAyLjExDQonLy8g5pyA5ZCO5L+u5pS5Og0KJy8vIOWkhyAgICDms6g6DQonLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KDQoNCg0KDQoNCicvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAg55So5oi355m76ZmGDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpQdWJsaWMgRnVuY3Rpb24gTG9naW4oKQ0KDQoJJ0lmIENoZWNrVmFsaWRDb2RlKFJlcXVlc3QuRm9ybSgiZWR0Q2hlY2tPdXQiKSk9RmFsc2UgVGhlbiBDYWxsIFNob3dFcnJvcigzOCkNCg0KCUJsb2dVc2VyLkxvZ2luVHlwZT0iU2VsZiINCglCbG9nVXNlci5OYW1lPVJlcXVlc3QuRm9ybSgidXNlcm5hbWUiKQ0KCUJsb2dVc2VyLlBhc3NXb3JkPUJsb2dVc2VyLkdldFBhc3N3b3JkQnlNRDUoUmVxdWVzdC5Gb3JtKCJwYXNzd29yZCIpKQ0KDQoJSWYgQmxvZ1VzZXIuVmVyaWZ5PVRydWUgVGhlbg0KDQoJCVJlc3BvbnNlLkNvb2tpZXMoInBhc3N3b3JkIik9QmxvZ1VzZXIuUGFzc1dvcmQNCgkJSWYgUmVxdWVzdC5Gb3JtKCJzYXZlZGF0ZSIpPD4wIFRoZW4NCgkJCVJlc3BvbnNlLkNvb2tpZXMoInBhc3N3b3JkIikuRXhwaXJlcyA9IERhdGVBZGQoImQiLCBSZXF1ZXN0LkZvcm0oInNhdmVkYXRlIiksIG5vdykNCgkJRW5kIElmDQoJCVJlc3BvbnNlLkNvb2tpZXMoInBhc3N3b3JkIikuUGF0aCA9IENvb2tpZXNQYXRoKCkNCg0KCQlMb2dpbj1UcnVlDQoNCg0KCUVuZCBJZg0KDQoJUmVzcG9uc2UuQ29va2llcygidXNlcm5hbWUiKT1lc2NhcGUoUmVxdWVzdC5Gb3JtKCJ1c2VybmFtZSIpKQ0KCUlmIFJlcXVlc3QuRm9ybSgic2F2ZWRhdGUiKTw+MCBUaGVuDQoJCVJlc3BvbnNlLkNvb2tpZXMoInVzZXJuYW1lIikuRXhwaXJlcyA9IERhdGVBZGQoImQiLCBSZXF1ZXN0LkZvcm0oInNhdmVkYXRlIiksIG5vdykNCglFbmQgSWYNCglSZXNwb25zZS5Db29raWVzKCJ1c2VybmFtZSIpLlBhdGggPSBDb29raWVzUGF0aCgpDQoNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIOeUqOaIt+mAgOWHug0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KUHVibGljIEZ1bmN0aW9uIExvZ291dCgpDQoNCglSZXNwb25zZS5Db29raWVzKCJ1c2VybmFtZSIpPSIiDQoJUmVzcG9uc2UuQ29va2llcygicGFzc3dvcmQiKT0iIg0KCVJlc3BvbnNlLkNvb2tpZXMoInVzZXJuYW1lIikuUGF0aCA9IENvb2tpZXNQYXRoKCkNCglSZXNwb25zZS5Db29raWVzKCJwYXNzd29yZCIpLlBhdGggPSBDb29raWVzUGF0aCgpDQoJDQoJTG9nb3V0PVRydWUNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAg5paH5Lu25LiK5LygDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBVcGxvYWRGaWxlKGJvbEF1dG9OYW1lKQ0KDQoJRGltIG9ialVwTG9hZEZpbGUNCglTZXQgb2JqVXBMb2FkRmlsZT1OZXcgVFVwTG9hZEZpbGUNCg0KCW9ialVwTG9hZEZpbGUuQXV0aG9ySUQ9QmxvZ1VzZXIuSUQNCglvYmpVcExvYWRGaWxlLkF1dG9OYW1lPWJvbEF1dG9OYW1lDQoNCglJZiBvYmpVcExvYWRGaWxlLlVwTG9hZCgpIFRoZW4NCg0KCQlVcGxvYWRGaWxlPVRydWUNCg0KCUVuZCBJZg0KDQoJU2V0IG9ialVwTG9hZEZpbGU9Tm90aGluZw0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgRm9ybSBvZiBTZW5kIEZpbGUNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIFNlbmRGaWxlKCkNCg0KCVJlc3BvbnNlLldyaXRlICI8IURPQ1RZUEUgaHRtbCBQVUJMSUMgIiItLy9XM0MvL0RURCBYSFRNTCAxLjAgVHJhbnNpdGlvbmFsLy9FTiIiICIiaHR0cDovL3d3dy53My5vcmcvVFIveGh0bWwxL0RURC94aHRtbDEtdHJhbnNpdGlvbmFsLmR0ZCIiPjxodG1sPjxoZWFkPjxtZXRhIGh0dHAtZXF1aXY9IiJDb250ZW50LVR5cGUiIiBjb250ZW50PSIidGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04IiIvPjxtZXRhIGh0dHAtZXF1aXY9IiJDb250ZW50LUxhbmd1YWdlIiIgY29udGVudD0iInpoLWNuIiIgLz48bGluayByZWw9IiJzdHlsZXNoZWV0IiIgcmV2PSIic3R5bGVzaGVldCIiIGhyZWY9IiJDU1MvYWRtaW4uY3NzIiIgdHlwZT0iInRleHQvY3NzIiIgbWVkaWE9IiJzY3JlZW4iIiAvPjxzY3JpcHQgc3JjPSIic2NyaXB0L2NvbW1vbi5qcyIiIHR5cGU9IiJ0ZXh0L2phdmFzY3JpcHQiIj48L3NjcmlwdD48L2hlYWQ+PGJvZHk+Ig0KDQoJUmVzcG9uc2UuV3JpdGUgIjxmb3JtIGJvcmRlcj0iIjEiIiBuYW1lPSIiZWRpdCIiIGlkPSIiZWRpdCIiIG1ldGhvZD0iInBvc3QiIiBlbmN0eXBlPSIibXVsdGlwYXJ0L2Zvcm0tZGF0YSIiIGFjdGlvbj0iIiImIEJsb2dIb3N0ICYiY21kLmFzcD9hY3Q9RmlsZVVwbG9hZCZyZWxvYWQ9MSIiPiINCglSZXNwb25zZS5Xcml0ZSAiPHA+IiYgWkNfTVNHMTA4ICYiOiAiDQoJUmVzcG9uc2UuV3JpdGUgIjxpbnB1dCB0eXBlPSIiZmlsZSIiIGlkPSIiZWR0RmlsZUxvYWQiIiBuYW1lPSIiZWR0RmlsZUxvYWQiIiBzaXplPSIiMjAiIj4gIDxpbnB1dCB0eXBlPSIic3VibWl0IiIgY2xhc3M9IiJidXR0b24iIiB2YWx1ZT0iIiImIFpDX01TRzA4NyAmIiIiIG5hbWU9IiJCMSIiIG9uY2xpY2s9J2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCIiZWRpdCIiKS5hY3Rpb249ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIiJlZGl0IiIpLmFjdGlvbisiIiZmaWxlbmFtZT0iIitlc2NhcGUoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIiJlZHRGaWxlTG9hZCIiKS52YWx1ZSknIC8+IDxpbnB1dCBjbGFzcz0iImJ1dHRvbiIiIHR5cGU9IiJyZXNldCIiIHZhbHVlPSIiIiYgWkNfTVNHMDg4ICYiIiIgbmFtZT0iIkIyIiIgLz4iDQoJUmVzcG9uc2UuV3JpdGUgIiZuYnNwOzxpbnB1dCB0eXBlPSIiY2hlY2tib3giIiBvbmNsaWNrPSdpZih0aGlzLmNoZWNrZWQ9PXRydWUpe2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCIiZWRpdCIiKS5hY3Rpb249ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIiJlZGl0IiIpLmFjdGlvbisiIiZhdXRvbmFtZT0xIiI7fWVsc2V7ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIiJlZGl0IiIpLmFjdGlvbj0iIiImIEJsb2dIb3N0ICYiY21kLmFzcD9hY3Q9RmlsZVVwbG9hZCZyZWxvYWQ9MSIiO307U2V0Q29va2llKCIiY2hrQXV0b0ZpbGVOYW1lIiIsdGhpcy5jaGVja2VkLDM2NSk7JyBpZD0iImNoa0F1dG9OYW1lIiIgaWQ9IiJjaGtBdXRvTmFtZSIiLz48bGFiZWwgZm9yPSIiY2hrQXV0b05hbWUiIj4iJiBaQ19NU0cxMzEgJiI8L2xhYmVsPjwvcD48L2Zvcm0+Ig0KDQoJUmVzcG9uc2UuV3JpdGUgIjxzY3JpcHQgdHlwZT0iInRleHQvamF2YXNjcmlwdCIiPmlmKEdldENvb2tpZSgiImNoa0F1dG9GaWxlTmFtZSIiKT09IiJ0cnVlIiIpe2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCIiY2hrQXV0b05hbWUiIikuY2hlY2tlZD10cnVlO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCIiZWRpdCIiKS5hY3Rpb249ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIiJlZGl0IiIpLmFjdGlvbisiIiZhdXRvbmFtZT0xIiI7fTs8L3NjcmlwdD48L2JvZHk+PC9odG1sPiINCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgIOaWh+S7tuWIoOmZpA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gRGVsRmlsZShpbnRJRCkNCg0KCURpbSBvYmpVcExvYWRGaWxlDQoJU2V0IG9ialVwTG9hZEZpbGU9TmV3IFRVcExvYWRGaWxlDQoNCglJZiBvYmpVcExvYWRGaWxlLkxvYWRJbmZvQnlJRChpbnRJRCkgVGhlbg0KDQoJCUlmIChvYmpVcExvYWRGaWxlLkF1dGhvcklEPUJsb2dVc2VyLklEKSBPciAoQ2hlY2tSaWdodHMoIlJvb3QiKT1UcnVlKSAgT3IgKENoZWNrUmlnaHRzKCJGaWxlQWxsIik9VHJ1ZSkgVGhlbg0KCQkJSWYgb2JqVXBMb2FkRmlsZS5EZWwgVGhlbiBEZWxGaWxlPVRydWUNCgkJRW5kIElmDQoNCglFbHNlDQoJCUV4aXQgRnVuY3Rpb24NCglFbmQgSWYNCg0KCVNldCBvYmpVcExvYWRGaWxlPU5vdGhpbmcNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgUG9zdCBBcnRpY2xlDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBQb3N0QXJ0aWNsZSgpDQoNCglEaW0gcyxpLHQsaw0KCURpbSBzdHJUYWcsc3RyTWV0YQ0KDQoJSWYgUmVxdWVzdC5Gb3JtKCJlZHRJRCIpPD4iMCIgVGhlbg0KCQlEaW0gb2JqVGVzdEFydGljbGUNCgkJU2V0IG9ialRlc3RBcnRpY2xlPU5ldyBUQXJ0aWNsZQ0KCQlJZiBvYmpUZXN0QXJ0aWNsZS5Mb2FkSW5mb2J5SUQoUmVxdWVzdC5Gb3JtKCJlZHRJRCIpKSBUaGVuDQoJCQlJZiBOb3QoKG9ialRlc3RBcnRpY2xlLkF1dGhvcklEPUJsb2dVc2VyLklEKSBPciAoQ2hlY2tSaWdodHMoIlJvb3QiKT1UcnVlKSBPciAoQ2hlY2tSaWdodHMoIkFydGljbGVBbGwiKT1UcnVlKSkgVGhlbiBFeGl0IEZ1bmN0aW9uDQoJCQlzdHJUYWc9b2JqVGVzdEFydGljbGUuVGFnDQoJCQlzdHJNZXRhPW9ialRlc3RBcnRpY2xlLk1ldGFTdHJpbmcNCgkJRWxzZQ0KCQkJQ2FsbCBTaG93RXJyb3IoOSkNCgkJRW5kIElmDQoJRW5kIElmDQoNCglEaW0gb2JqQXJ0aWNsZQ0KCVNldCBvYmpBcnRpY2xlPU5ldyBUQXJ0aWNsZQ0KCW9iakFydGljbGUuSUQ9UmVxdWVzdC5Gb3JtKCJlZHRJRCIpDQoJb2JqQXJ0aWNsZS5DYXRlSUQ9UmVxdWVzdC5Gb3JtKCJlZHRDYXRlSUQiKQ0KCW9iakFydGljbGUuQXV0aG9ySUQ9SUlmKENoZWNrUmlnaHRzKCJSb290IikgT3IgQ2hlY2tSaWdodHMoIkFydGljbGVBbGwiKSxSZXF1ZXN0LkZvcm0oImVkdEF1dGhvcklEIiksQmxvZ1VzZXIuSUQpDQoJb2JqQXJ0aWNsZS5MZXZlbD1SZXF1ZXN0LkZvcm0oImVkdExldmVsIikNCicJb2JqQXJ0aWNsZS5Qb3N0VGltZT1SZXF1ZXN0LkZvcm0oImVkdFllYXIiKSAmICItIiAmIFJlcXVlc3QuRm9ybSgiZWR0TW9udGgiKSAmICItIiAmIFJlcXVlc3QuRm9ybSgiZWR0RGF5IikgJiAiICIgJiAgUmVxdWVzdC5Gb3JtKCJlZHRUaW1lIikNCglvYmpBcnRpY2xlLlBvc3RUaW1lPVJlcXVlc3QuRm9ybSgiZWR0RGF0ZVRpbWUiKQ0KCW9iakFydGljbGUuVGl0bGU9UmVxdWVzdC5Gb3JtKCJlZHRUaXRsZSIpDQoJb2JqQXJ0aWNsZS5UYWc9UGFyc2VUYWcoUmVxdWVzdC5Gb3JtKCJlZHRUYWciKSkNCglvYmpBcnRpY2xlLkFsaWFzPVJlcXVlc3QuRm9ybSgiZWR0QWxpYXMiKQ0KCW9iakFydGljbGUuSXN0b3A9SUlmKENoZWNrUmlnaHRzKCJSb290IiksUmVxdWVzdC5Gb3JtKCJlZHRJc3RvcCIpLEZhbHNlKQ0KCW9iakFydGljbGUuVGVtcGxhdGVOYW1lPVJlcXVlc3QuRm9ybSgiZWR0VGVtcGxhdGUiKQ0KCW9iakFydGljbGUuRlR5cGU9Q0xuZyhSZXF1ZXN0LkZvcm0oImVkdEZUeXBlIikpDQoNCglvYmpBcnRpY2xlLkludHJvPVJlcXVlc3QuRm9ybSgidHhhSW50cm8iKQ0KDQoJb2JqQXJ0aWNsZS5Db250ZW50PVJlcXVlc3QuRm9ybSgidHhhQ29udGVudCIpDQoNCg0KDQoJSWYgb2JqQXJ0aWNsZS5GVHlwZT1aQ19QT1NUX1RZUEVfQVJUSUNMRSBUaGVuDQoNCgkJJ+aRmOimgeeUn+aIkA0KDQoJCUlmIEluU3RyKG9iakFydGljbGUuQ29udGVudCwiPGhyIGNsYXNzPSIibW9yZSIiIC8+Iik+MCBUaGVuDQoJCQlzPW9iakFydGljbGUuQ29udGVudA0KCQkJaT1JblN0cihzLCI8aHIgY2xhc3M9IiJtb3JlIiIgLz4iKQ0KCQkJcz1MZWZ0KHMsaS0xKQ0KCQkJb2JqQXJ0aWNsZS5JbnRybz1jbG9zZUhUTUwocykgJiAiPCEtLWF1dG9pbnRyby0tPiINCgkJCW9iakFydGljbGUuQ29udGVudD1SZXBsYWNlKG9iakFydGljbGUuQ29udGVudCwiPGhyIGNsYXNzPSIibW9yZSIiIC8+IiwiPCEtLW1vcmUtLT4iLDEsMSkNCgkJRWxzZUlmIEluU3RyKG9iakFydGljbGUuQ29udGVudCwiPGhyIGNsYXNzPSIibW9yZSIiLz4iKT4wIFRoZW4NCgkJCXM9b2JqQXJ0aWNsZS5Db250ZW50DQoJCQlpPUluU3RyKHMsIjxociBjbGFzcz0iIm1vcmUiIi8+IikNCgkJCXM9TGVmdChzLGktMSkNCgkJCW9iakFydGljbGUuSW50cm89Y2xvc2VIVE1MKHMpICYgIjwhLS1hdXRvaW50cm8tLT4iDQoJCQlvYmpBcnRpY2xlLkNvbnRlbnQ9UmVwbGFjZShvYmpBcnRpY2xlLkNvbnRlbnQsIjxociBjbGFzcz0iIm1vcmUiIi8+IiwiPCEtLW1vcmUtLT4iLDEsMSkNCgkJRW5kIElmDQoJCQ0KCQkn5qC55o2uPC9wPuWIhuWJsg0KCQlJZiBvYmpBcnRpY2xlLkludHJvPSIiIFRoZW4NCgkJCXM9b2JqQXJ0aWNsZS5Db250ZW50DQoJCQlEaW0gYXJ5SW50cm8NCgkJCWFyeUludHJvPVNwbGl0KHMsIjwvcD4iKQ0KCQkJRm9yIGkgPSAwIFRvIFVCb3VuZChhcnlJbnRybykNCgkJCQlJZiBUcmltKGFyeUludHJvKGkpKTw+IiIgVGhlbg0KCQkJCQl0PXQgJiBhcnlJbnRybyhpKSAmICBJSWYoSW5TdHIoYXJ5SW50cm8oaSksIjxwPiIpPjAsIjwvcD4iLCIiKQ0KCQkJCUVuZCBJZg0KCQkJCUlmIExlbih0KT5aQ19BUlRJQ0xFX0VYQ0VSUFRfTUFYIFRoZW4gRXhpdCBmb3INCgkJCU5leHQgDQoJCQlvYmpBcnRpY2xlLkludHJvPWNsb3NlSFRNTCh0KSAmICI8IS0tYXV0b2ludHJvLS0+Ig0KCQlFbmQgSWYNCglFbHNlSWYgb2JqQXJ0aWNsZS5GVHlwZT1aQ19QT1NUX1RZUEVfUEFHRSBUaGVuDQoJCUlmIENoZWNrUmlnaHRzKCJSb290Iik9RmFsc2UgQW5kIENoZWNrUmlnaHRzKCJBcnRpY2xlQWxsIik9RmFsc2UgVGhlbiBDYWxsIFNob3dFcnJvcig2KQ0KCUVuZCBJZg0KDQoJb2JqQXJ0aWNsZS5NZXRhU3RyaW5nPXN0ck1ldGENCglDYWxsIEdldE1ldGFWYWx1ZXdpdGhGb3JtKG9iakFydGljbGUpDQoNCgkn5o6l5Y+jDQoJQ2FsbCBGaWx0ZXJfUGx1Z2luX1Bvc3RBcnRpY2xlX0NvcmUob2JqQXJ0aWNsZSkNCgkNCglJZiBvYmpBcnRpY2xlLlBvc3QgVGhlbg0KCQlDYWxsIFNjYW5UYWdDb3VudChzdHJUYWcgJiBvYmpBcnRpY2xlLlRhZykNCgkJQ2FsbCBCdWlsZEFydGljbGUob2JqQXJ0aWNsZS5JRCxUcnVlLFRydWUpDQoJCUlmIG9iakFydGljbGUuRlR5cGU9WkNfUE9TVF9UWVBFX1BBR0UgVGhlbg0KCQkJSWYgUmVxdWVzdC5Gb3JtKCJlZHRBZGROYXZCYXIiKT0iVHJ1ZSIgVGhlbg0KCQkJCUNhbGwgQWRkTmF2QmFyKCJwYWdlIixvYmpBcnRpY2xlLklELG9iakFydGljbGUuSHRtbFRpdGxlLG9iakFydGljbGUuSHRtbFVybCwiW21vZGlmXVthZGRdIikNCgkJCUVsc2UNCgkJCQlDYWxsIEFkZE5hdkJhcigicGFnZSIsb2JqQXJ0aWNsZS5JRCxvYmpBcnRpY2xlLkh0bWxUaXRsZSxvYmpBcnRpY2xlLkh0bWxVcmwsIlttb2RpZl0iKQ0KCQkJRW5kIElmDQoJCUVuZCBJZg0KCQlQb3N0QXJ0aWNsZT1UcnVlDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9Qb3N0QXJ0aWNsZV9TdWNjZWVkKG9iakFydGljbGUpDQoJRW5kIElmDQoNCglTZXQgb2JqQXJ0aWNsZT1Ob3RoaW5nDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBEZWwgQXJ0aWNsZQ0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gRGVsQXJ0aWNsZShpbnRJRCkNCg0KCURpbSBzdHJUYWcNCg0KCUlmIGludElEPD4iIiBUaGVuDQoJCURpbSBvYmpUZXN0QXJ0aWNsZQ0KCQlTZXQgb2JqVGVzdEFydGljbGU9TmV3IFRBcnRpY2xlDQoJCUlmIG9ialRlc3RBcnRpY2xlLkxvYWRJbmZvYnlJRChpbnRJRCkgVGhlbg0KCQkJSWYgTm90KChvYmpUZXN0QXJ0aWNsZS5BdXRob3JJRD1CbG9nVXNlci5JRCkgT3IgKENoZWNrUmlnaHRzKCJSb290Iik9VHJ1ZSkgT3IgKENoZWNrUmlnaHRzKCJBcnRpY2xlQWxsIik9VHJ1ZSkpIFRoZW4gRXhpdCBGdW5jdGlvbg0KCQkJc3RyVGFnPW9ialRlc3RBcnRpY2xlLlRhZw0KCQlFbHNlDQoJCQlDYWxsIFNob3dFcnJvcig5KQ0KCQlFbmQgSWYNCgkJU2V0IG9ialRlc3RBcnRpY2xlPU5vdGhpbmcNCglFbmQgSWYNCg0KCURpbSBvYmpBcnRpY2xlDQoJU2V0IG9iakFydGljbGU9TmV3IFRBcnRpY2xlDQoNCglJZiBvYmpBcnRpY2xlLkxvYWRJbmZvQnlJRChpbnRJRCkgVGhlbg0KDQoJCUlmIG9iakFydGljbGUuRGVsIFRoZW4gDQoJCQlvYmpBcnRpY2xlLlN0YXRpc3RpYw0KCQkJRGVsQXJ0aWNsZT1UcnVlDQoJCUVuZCBJZiANCgkJQ2FsbCBTY2FuVGFnQ291bnQoc3RyVGFnKQ0KDQoJCUNhbGwgQmxvZ1JlQnVpbGRfQ29tbWVudHMNCgkJQ2FsbCBCbG9nUmVCdWlsZF9EZWZhdWx0DQoNCglFbmQgSWYNCg0KCVNldCBvYmpBcnRpY2xlPU5vdGhpbmcNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgUG9zdCBDYXRlZ29yeQ0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gUG9zdENhdGVnb3J5KCkNCg0KCUlmIEluc3RyKFJlcXVlc3QuU2VydmVyVmFyaWFibGVzKCJIVFRQX1JFRkVSRVIiKSwiP2lkPTAiKT4wIFRoZW4NCg0KCQlDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX1VOQ0FURUdPUklaRURfTkFNRSIsUmVxdWVzdC5Gb3JtKCJlZHROYW1lIikpDQoJCUNhbGwgQmxvZ0NvbmZpZy5Xcml0ZSgiWkNfVU5DQVRFR09SSVpFRF9BTElBUyIsUmVxdWVzdC5Gb3JtKCJlZHRBbGlhcyIpKQ0KCQlCbG9nQ29uZmlnLlNhdmUNCgkJUG9zdENhdGVnb3J5PVRydWUNCgkJRXhpdCBGdW5jdGlvbg0KCQlSZXNwb25zZS5FbmQNCglFbmQgSWYNCg0KCURpbSBvYmpDYXRlZ29yeQ0KCVNldCBvYmpDYXRlZ29yeT1OZXcgVENhdGVnb3J5DQoJb2JqQ2F0ZWdvcnkuSUQ9UmVxdWVzdC5Gb3JtKCJlZHRJRCIpDQoJb2JqQ2F0ZWdvcnkuTmFtZT1SZXF1ZXN0LkZvcm0oImVkdE5hbWUiKQ0KCW9iakNhdGVnb3J5Lk9yZGVyPVJlcXVlc3QuRm9ybSgiZWR0T3JkZXIiKQ0KCW9iakNhdGVnb3J5LlBhcmVudElEPVJlcXVlc3QuRm9ybSgiZWR0UGFyZUlEIikNCglvYmpDYXRlZ29yeS5BbGlhcz1SZXF1ZXN0LkZvcm0oImVkdEFsaWFzIikNCglvYmpDYXRlZ29yeS5UZW1wbGF0ZU5hbWU9UmVxdWVzdC5Gb3JtKCJlZHRUZW1wbGF0ZSIpDQoJb2JqQ2F0ZWdvcnkuTG9nVGVtcGxhdGU9UmVxdWVzdC5Gb3JtKCJlZHRMb2dUZW1wbGF0ZSIpDQoNCglJZiBDTG5nKG9iakNhdGVnb3J5LklEKT4wIFRoZW4gb2JqQ2F0ZWdvcnkuTWV0YVN0cmluZz1vYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBbY2F0ZV9NZXRhXSBGUk9NIFtibG9nX0NhdGVnb3J5XSBXSEVSRSBbY2F0ZV9JRF09IiZDTG5nKG9iakNhdGVnb3J5LklEKSkoMCkNCglDYWxsIEdldE1ldGFWYWx1ZXdpdGhGb3JtKG9iakNhdGVnb3J5KQ0KDQoJJ+aOpeWPow0KCUNhbGwgRmlsdGVyX1BsdWdpbl9Qb3N0Q2F0ZWdvcnlfQ29yZShvYmpDYXRlZ29yeSkNCg0KDQoJSWYgb2JqQ2F0ZWdvcnkuUG9zdCBUaGVuDQoNCgkJUG9zdENhdGVnb3J5PVRydWUNCg0KCQlJZiBSZXF1ZXN0LkZvcm0oImVkdEFkZE5hdkJhciIpPSJUcnVlIiBUaGVuDQoJCQlDYWxsIEFkZE5hdkJhcigiY2F0ZSIsb2JqQ2F0ZWdvcnkuSUQsb2JqQ2F0ZWdvcnkuSHRtbE5hbWUsb2JqQ2F0ZWdvcnkuSHRtbFVybCwiW21vZGlmXVthZGRdIikNCgkJRWxzZQ0KCQkJQ2FsbCBBZGROYXZCYXIoImNhdGUiLG9iakNhdGVnb3J5LklELG9iakNhdGVnb3J5Lkh0bWxOYW1lLG9iakNhdGVnb3J5Lkh0bWxVcmwsIlttb2RpZl0iKQ0KCQlFbmQgSWYNCg0KCQlDYWxsIEZpbHRlcl9QbHVnaW5fUG9zdENhdGVnb3J5X1N1Y2NlZWQob2JqQ2F0ZWdvcnkpDQoNCglFbmQgSWYNCg0KCVNldCBvYmpDYXRlZ29yeT1Ob3RoaW5nDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBEZWwgQ2F0ZWdvcnkNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIERlbENhdGVnb3J5KGludElEKQ0KDQoJRGltIG9iakNhdGVnb3J5DQoJU2V0IG9iakNhdGVnb3J5PU5ldyBUQ2F0ZWdvcnkNCg0KCUlmIG9iakNhdGVnb3J5LkxvYWRJbmZvYnlJRChpbnRJRCkgVGhlbg0KCQlJZiBvYmpDYXRlZ29yeS5EZWwgVGhlbiBEZWxDYXRlZ29yeT1UcnVlDQoJRW5kIElmDQoNCglTZXQgb2JqQ2F0ZWdvcnk9Tm90aGluZw0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KDQonLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIFBvc3QgQ29tbWVudA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gUG9zdENvbW1lbnQoc3RyS2V5KQ0KDQoJQ2FsbCBHZXRVc2VyKCkNCg0KCUlmIElzRW1wdHkoUmVxdWVzdC5Gb3JtKCJpbnBBamF4IikpPUZhbHNlIFRoZW4NCgkJU2hvd0Vycm9yX0N1c3RvbT0iQ2FsbCBSZXNwb25kRXJyb3IoaWQsWlZBX0Vycm9yTXNnKGlkKSk6UmVzcG9uc2UuRW5kIg0KCUVuZCBJZg0KDQoJSWYgWkNfQ09NTUVOVF9UVVJOT0ZGIFRoZW4NCgkJQ2FsbCBTaG93RXJyb3IoNDApDQoJRW5kIElmDQoNCglJZiBaQ19DT01NRU5UX1ZFUklGWV9FTkFCTEUgQW5kIFpDX0NPTU1FTlRfVkVSSUZZX0VOQUJMRV9JTlRFUk5BTCBUaGVuDQoJCUlmIENoZWNrVmFsaWRDb2RlKFJlcXVlc3QuRm9ybSgiaW5wVmVyaWZ5IikpPUZhbHNlIFRoZW4gQ2FsbCBTaG93RXJyb3IoMzgpDQoJRW5kIElmDQoNCglEaW0gaW5wSUQsaW5wTmFtZSxpbnBBcnRpY2xlLGlucEVtYWlsLGlucEhvbWVQYWdlLGlucFBhcmVudElEDQoNCglpbnBJRD1SZXF1ZXN0LkZvcm0oImlucElEIikNCglpbnBOYW1lPVJlcXVlc3QuRm9ybSgiaW5wTmFtZSIpDQoJaW5wQXJ0aWNsZT1SZXF1ZXN0LkZvcm0oImlucEFydGljbGUiKQ0KCWlucEVtYWlsPVJlcXVlc3QuRm9ybSgiaW5wRW1haWwiKQ0KCWlucEhvbWVQYWdlPVJlcXVlc3QuRm9ybSgiaW5wSG9tZVBhZ2UiKQ0KCWlucFBhcmVudElEPUNMbmcoSUlmKFJlcXVlc3QuRm9ybSgiaW5wUmV2SUQiKT0iIiwwLFJlcXVlc3QuRm9ybSgiaW5wUmV2SUQiKSkpDQoJDQoJSWYgTGVuKGlucEFydGljbGUpPTAgT3IgTGVuKGlucEFydGljbGUpPlpDX0NPTlRFTlRfTUFYIFRoZW4NCgkJQ2FsbCAgU2hvd0Vycm9yKDQ2KQ0KCUVuZCBJZg0KDQoJRGltIG9iakNvbW1lbnQNCglEaW0gb2JqQXJ0aWNsZQ0KCURpbSB0bXBDb3VudA0KDQoJU2V0IG9iakNvbW1lbnQ9TmV3IFRDb21tZW50DQoNCg0KCUlmIENMbmcoaW5wUGFyZW50SUQpPjAgVGhlbg0KCQkNCgkJRGltIGkNCgkJaT1HZXRDb21tZW50Rmxvb3IoaW5wUGFyZW50SUQpDQoJCUlmIGk+WkNfQ09NTU5FVF9NQVhGTE9PUi0xIFRoZW4JQ2FsbCBTaG93RXJyb3IoNTIpDQoNCglFbmQgSWYNCg0KDQoJb2JqQ29tbWVudC5sb2dfSUQ9aW5wSUQNCglvYmpDb21tZW50LkF1dGhvcklEPUJsb2dVc2VyLklEDQoJb2JqQ29tbWVudC5BdXRob3I9aW5wTmFtZQ0KCW9iakNvbW1lbnQuQ29udGVudD1pbnBBcnRpY2xlDQoJb2JqQ29tbWVudC5FbWFpbD1pbnBFbWFpbA0KCW9iakNvbW1lbnQuSG9tZVBhZ2U9aW5wSG9tZVBhZ2UNCglvYmpDb21tZW50LlBhcmVudElEPWlucFBhcmVudElEDQoNCg0KCSfmjqXlj6MNCglDYWxsIEZpbHRlcl9QbHVnaW5fUG9zdENvbW1lbnRfQ29yZShvYmpDb21tZW50KQ0KDQoJSWYgb2JqQ29tbWVudC5Jc1Rocm93PVRydWUgVGhlbiBDYWxsIFNob3dFcnJvcigxNCkNCg0KCUlmIG9iakNvbW1lbnQuQXV0aG9ySUQ+MCBUaGVuDQoJCW9iakNvbW1lbnQuQXV0aG9yICA9VXNlcnMob2JqQ29tbWVudC5BdXRob3JJRCkuTmFtZQ0KCQlvYmpDb21tZW50LkVNYWlsICAgPVVzZXJzKG9iakNvbW1lbnQuQXV0aG9ySUQpLkVtYWlsDQoJCW9iakNvbW1lbnQuSG9tZVBhZ2U9VXNlcnMob2JqQ29tbWVudC5BdXRob3JJRCkuSG9tZVBhZ2UNCglFbmQgSWYNCg0KCUlmIG9iakNvbW1lbnQubG9nX0lEPjAgVGhlbg0KCQlTZXQgb2JqQXJ0aWNsZT1OZXcgVEFydGljbGUNCgkJSWYgb2JqQXJ0aWNsZS5Mb2FkSW5mb0J5SUQob2JqQ29tbWVudC5sb2dfSUQpIFRoZW4NCgkJCUlmIE5vdCAoc3RyS2V5PW9iakFydGljbGUuQ29tbWVudEtleSkgVGhlbiBDYWxsIFNob3dFcnJvcig0MykNCgkJCUlmIG9iakFydGljbGUuTGV2ZWw8NCBUaGVuIENhbGwgU2hvd0Vycm9yKDQ0KQ0KCQlFbmQgSWYNCgkJU2V0IG9iakFydGljbGU9Tm90aGluZw0KCUVuZCBJZg0KDQoJRGltIG9ialVzZXINCglGb3IgRWFjaCBvYmpVc2VyIGluIFVzZXJzDQoJCUlmIElzT2JqZWN0KG9ialVzZXIpIFRoZW4NCgkJCUlmIChVQ2FzZShvYmpVc2VyLk5hbWUpPVVDYXNlKG9iakNvbW1lbnQuQXV0aG9yKSkgQW5kIChvYmpVc2VyLklEPD5vYmpDb21tZW50LkF1dGhvcklEKSBUaGVuIFNob3dFcnJvcigzMSkNCgkJRW5kIElmDQoJTmV4dA0KDQoJSWYgb2JqQ29tbWVudC5Qb3N0IFRoZW4NCg0KCQlJZiBvYmpDb21tZW50LklzQ2hlY2s9VHJ1ZSBUaGVuIENhbGwgU2hvd0Vycm9yKDUzKQ0KDQoJCUNhbGwgQnVpbGRBcnRpY2xlKG9iakNvbW1lbnQubG9nX0lELEZhbHNlLFRydWUpDQoJCUNhbGwgQmxvZ1JlQnVpbGRfQ29tbWVudHMNCgkJQ2FsbCBCbG9nUmVCdWlsZF9EZWZhdWx0DQoJCVBvc3RDb21tZW50PVRydWUNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1Bvc3RDb21tZW50X1N1Y2NlZWQob2JqQ29tbWVudCkNCg0KCUVuZCBpZg0KDQoJSWYgSXNFbXB0eShSZXF1ZXN0LkZvcm0oImlucEFqYXgiKSk9RmFsc2UgVGhlbg0KCQlDYWxsIFJldHVybkFqYXhDb21tZW50KG9iakNvbW1lbnQpDQoJCUNhbGwgQ2xlYXJHbG9iZUNhY2hlDQoJCUNhbGwgTG9hZEdsb2JlQ2FjaGUNCglFbmQgSWYNCg0KCVNldCBvYmpDb21tZW50PU5vdGhpbmcNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIERlbCBDb21tZW50DQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBEZWxDb21tZW50KGludElELGludExvZ19JRCkNCg0KCURpbSBvYmpDb21tZW50DQoJRGltIG9iakFydGljbGUNCg0KCVNldCBvYmpDb21tZW50PU5ldyBUQ29tbWVudA0KCVNldCBvYmpBcnRpY2xlPU5ldyBUQXJ0aWNsZQ0KDQoJSWYgb2JqQ29tbWVudC5Mb2FkSW5mb2J5SUQoaW50SUQpIFRoZW4NCg0KCQlJZiBvYmpDb21tZW50LmxvZ19JRD4wIFRoZW4NCgkJCURpbSBvYmpUZXN0QXJ0aWNsZQ0KCQkJU2V0IG9ialRlc3RBcnRpY2xlPU5ldyBUQXJ0aWNsZQ0KCQkJSWYgb2JqVGVzdEFydGljbGUuTG9hZEluZm9ieUlEKG9iakNvbW1lbnQubG9nX0lEKSBUaGVuDQoJCQkJSWYgTm90KChvYmpDb21tZW50LkF1dGhvcklEPUJsb2dVc2VyLklEKSBPciAob2JqVGVzdEFydGljbGUuQXV0aG9ySUQ9QmxvZ1VzZXIuSUQpIE9yIChDaGVja1JpZ2h0cygiUm9vdCIpPVRydWUpIE9yIChDaGVja1JpZ2h0cygiQ29tbWVudEFsbCIpPVRydWUpKSBUaGVuIEV4aXQgRnVuY3Rpb24NCgkJCUVsc2UNCgkJCQlDYWxsIFNob3dFcnJvcig5KQ0KCQkJRW5kIElmDQoJCQlTZXQgb2JqVGVzdEFydGljbGU9Tm90aGluZw0KDQoJCQlEaW0gYWxsY29tbSxpDQoJCQlJZiBTZWFyY2hDaGlsZENvbW1lbnRzKGludElELGFsbGNvbW0pPVRydWUgVGhlbg0KCQkJCUZvciBFYWNoIGkgSW4gYWxsY29tbS5LZXlzDQoJCQkJCURpbSBvYmpTdWJDb21tZW50DQoJCQkJCVNldCBvYmpTdWJDb21tZW50PU5ldyBUQ29tbWVudA0KCQkJCQlJZiBvYmpTdWJDb21tZW50LkxvYWRJbmZvYnlJRChpKSBUaGVuDQoJCQkJCQlvYmpTdWJDb21tZW50LkRlbA0KCQkJCQlFbmQgSWYNCgkJCQlOZXh0DQoJCQlFbmQgSWYNCg0KCQlFbmQgSWYNCgkJRGVsQ2hpbGQgb2JqQ29tbWVudC5JRA0KCQlJZiBvYmpDb21tZW50LkRlbCBUaGVuDQoNCgkJCUNhbGwgQnVpbGRBcnRpY2xlKG9iakNvbW1lbnQubG9nX0lELEZhbHNlLFRydWUpDQoJCQlDYWxsIEJsb2dSZUJ1aWxkX0NvbW1lbnRzDQoJCQlDYWxsIEJsb2dSZUJ1aWxkX0RlZmF1bHQNCg0KCQkJRGVsQ29tbWVudD1UcnVlDQoJCUVuZCBJZg0KDQoJRW5kIElmDQoNCglTZXQgb2JqQ29tbWVudD1Ob3RoaW5nDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBTYXZlIENvbW1lbnQNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIFNhdmVDb21tZW50KCkNCg0KCURpbSBvYmpDb21tZW50DQoJRGltIG9iakFydGljbGUNCg0KCVNldCBvYmpDb21tZW50PU5ldyBUQ29tbWVudA0KDQoJSWYgb2JqQ29tbWVudC5Mb2FkSW5mb0J5SUQoUmVxdWVzdC5Gb3JtKCJpbnBJRCIpKSBUaGVuDQoJCW9iakNvbW1lbnQuQXV0aG9yPVJlcXVlc3QuRm9ybSgiaW5wTmFtZSIpDQoJCW9iakNvbW1lbnQuRW1haWw9UmVxdWVzdC5Gb3JtKCJpbnBFbWFpbCIpDQoJCW9iakNvbW1lbnQuSG9tZVBhZ2U9UmVxdWVzdC5Gb3JtKCJpbnBIb21lUGFnZSIpDQoJCW9iakNvbW1lbnQuQ29udGVudD1SZXF1ZXN0LkZvcm0oInR4YUNvbnRlbnQiKQ0KCUVsc2UNCgkJQ2FsbCBTaG93RXJyb3IoNjEpDQoJRW5kIElmDQoNCg0KCUlmIG9iakNvbW1lbnQubG9nX0lEPjAgVGhlbg0KCQlTZXQgb2JqQXJ0aWNsZT1OZXcgVEFydGljbGUNCgkJSWYgb2JqQXJ0aWNsZS5Mb2FkSW5mb0J5SUQob2JqQ29tbWVudC5sb2dfSUQpIFRoZW4NCgkJCUlmIE5vdCAoKG9iakFydGljbGUuQXV0aG9ySUQ9QmxvZ1VzZXIuSUQpIE9yIChvYmpDb21tZW50LkF1dGhvcklEPUJsb2dVc2VyLklEKSBPciAoQ2hlY2tSaWdodHMoIlJvb3QiKT1UcnVlKSBPciAoQ2hlY2tSaWdodHMoIkNvbW1lbnRBbGwiKT1UcnVlKSkgVGhlbiBFeGl0IEZ1bmN0aW9uDQoJCUVuZCBJZg0KCQlTZXQgb2JqQXJ0aWNsZT1Ob3RoaW5nDQoJRW5kIElmDQoNCglDYWxsIEZpbHRlcl9QbHVnaW5fUG9zdENvbW1lbnRfQ29yZShvYmpDb21tZW50KQ0KDQoJSWYgb2JqQ29tbWVudC5Qb3N0IFRoZW4NCg0KCQlDYWxsIEJ1aWxkQXJ0aWNsZShvYmpDb21tZW50LmxvZ19JRCxGYWxzZSxGYWxzZSkNCgkJQ2FsbCBCbG9nUmVCdWlsZF9Db21tZW50cw0KCQlDYWxsIEJsb2dSZUJ1aWxkX0RlZmF1bHQNCg0KCQlTYXZlQ29tbWVudD1UcnVlDQoNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1Bvc3RDb21tZW50X1N1Y2NlZWQob2JqQ29tbWVudCkNCg0KCUVuZCBpZg0KDQoJU2V0IG9iakNvbW1lbnQ9Tm90aGluZw0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIFNhdmUgUmV2IENvbW1lbnQNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIFNhdmVSZXZDb21tZW50KCkNCg0KCURpbSBvYmpSZXZDb21tZW50DQoJRGltIG9iak5ld0NvbW1lbnQNCglEaW0gb2JqQXJ0aWNsZQ0KDQoJU2V0IG9iak5ld0NvbW1lbnQ9TmV3IFRDb21tZW50DQoJU2V0IG9ialJldkNvbW1lbnQ9TmV3IFRDb21tZW50DQoNCglJZiBvYmpSZXZDb21tZW50LkxvYWRJbmZvQnlJRChSZXF1ZXN0LkZvcm0oImludFJldklEIikpIFRoZW4NCg0KCQlvYmpOZXdDb21tZW50LlBhcmVudElEPW9ialJldkNvbW1lbnQuSUQNCgkJb2JqTmV3Q29tbWVudC5sb2dfSUQ9b2JqUmV2Q29tbWVudC5sb2dfSUQNCgkJb2JqTmV3Q29tbWVudC5BdXRob3JJRD1CbG9nVXNlci5JRA0KCQlvYmpOZXdDb21tZW50LkF1dGhvcj1CbG9nVXNlci5OYW1lDQoJCW9iak5ld0NvbW1lbnQuRW1haWw9QmxvZ1VzZXIuRW1haWwNCgkJb2JqTmV3Q29tbWVudC5Ib21lUGFnZT1CbG9nVXNlci5Ib21lUGFnZQ0KCQlvYmpOZXdDb21tZW50LkNvbnRlbnQ9UmVxdWVzdC5Gb3JtKCJ0eGFDb250ZW50IikNCg0KCUVsc2UNCgkJQ2FsbCBTaG93RXJyb3IoNjEpDQoJRW5kIElmDQoNCglJZiBMZW4ob2JqTmV3Q29tbWVudC5Db250ZW50KT0wIE9yIExlbihvYmpOZXdDb21tZW50LkNvbnRlbnQpPlpDX0NPTlRFTlRfTUFYIFRoZW4NCgkJQ2FsbCBTaG93RXJyb3IoNDYpDQoJRW5kIElmDQoNCglJZiBvYmpOZXdDb21tZW50LmxvZ19JRD4wIFRoZW4NCgkJU2V0IG9iakFydGljbGU9TmV3IFRBcnRpY2xlDQoJCUlmIG9iakFydGljbGUuTG9hZEluZm9CeUlEKG9iak5ld0NvbW1lbnQubG9nX0lEKSBUaGVuDQoJCQlJZiBOb3QgKChvYmpBcnRpY2xlLkF1dGhvcklEPUJsb2dVc2VyLklEKSBPciAob2JqTmV3Q29tbWVudC5BdXRob3JJRD1CbG9nVXNlci5JRCkgT3IgKENoZWNrUmlnaHRzKCJSb290Iik9VHJ1ZSkgT3IgKENoZWNrUmlnaHRzKCJDb21tZW50QWxsIik9VHJ1ZSkpIFRoZW4gRXhpdCBGdW5jdGlvbg0KCQlFbmQgSWYNCgkJU2V0IG9iakFydGljbGU9Tm90aGluZw0KCUVuZCBJZg0KDQoJQ2FsbCBGaWx0ZXJfUGx1Z2luX1Bvc3RDb21tZW50X0NvcmUob2JqTmV3Q29tbWVudCkNCg0KCUlmIG9iak5ld0NvbW1lbnQuUG9zdCBUaGVuDQoNCgkJQ2FsbCBCdWlsZEFydGljbGUob2JqTmV3Q29tbWVudC5sb2dfSUQsRmFsc2UsRmFsc2UpDQoJCUNhbGwgQmxvZ1JlQnVpbGRfQ29tbWVudHMNCgkJQ2FsbCBCbG9nUmVCdWlsZF9EZWZhdWx0DQoNCgkJU2F2ZVJldkNvbW1lbnQ9VHJ1ZQ0KDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9Qb3N0Q29tbWVudF9TdWNjZWVkKG9iak5ld0NvbW1lbnQpDQoNCglFbmQgaWYNCg0KCVNldCBvYmpOZXdDb21tZW50PU5vdGhpbmcNCglTZXQgb2JqUmV2Q29tbWVudD1Ob3RoaW5nDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIFJldHVybiBBamF4IENvbW1lbnQNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkRpbSBSZXR1cm5BamF4Q29tbWVudF9hcnlUZW1wbGF0ZVRhZ3NOYW1lDQpEaW0gUmV0dXJuQWpheENvbW1lbnRfYXJ5VGVtcGxhdGVUYWdzVmFsdWUNCg0KRnVuY3Rpb24gUmV0dXJuQWpheENvbW1lbnRfUGx1Z2luKGFyeVRlbXBsYXRlVGFnc05hbWUsYXJ5VGVtcGxhdGVUYWdzVmFsdWUpDQoJUmV0dXJuQWpheENvbW1lbnRfYXJ5VGVtcGxhdGVUYWdzTmFtZT1hcnlUZW1wbGF0ZVRhZ3NOYW1lDQoJUmV0dXJuQWpheENvbW1lbnRfYXJ5VGVtcGxhdGVUYWdzVmFsdWU9YXJ5VGVtcGxhdGVUYWdzVmFsdWUNCkVuZCBGdW5jdGlvbg0KJ01hcms1DQpGdW5jdGlvbiBSZXR1cm5BamF4Q29tbWVudChvYmpDb21tZW50KQ0KDQoJT24gRXJyb3IgUmVzdW1lIE5leHQNCg0KCURpbSBpLGoNCglpPTANCglEaW0gb2JqQXJ0aWNsZQ0KDQoNCgknRmlsdGVyX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfVGVtcGxhdGVUYWdzDQoJQ2FsbCBBZGRfRmlsdGVyX1BsdWdpbigiRmlsdGVyX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfVGVtcGxhdGVUYWdzIiwiUmV0dXJuQWpheENvbW1lbnRfUGx1Z2luIikNCg0KCVNldCBvYmpBcnRpY2xlPU5ldyBUQXJ0aWNsZQ0KCUlmIG9iakFydGljbGUuTG9hZEluZm9CeUlEKG9iakNvbW1lbnQubG9nX0lEKSBUaGVuDQoJCUNhbGwgb2JqQXJ0aWNsZS5FeHBvcnQoWkNfRElTUExBWV9NT0RFX0FMTCkNCgkJaT1vYmpBcnRpY2xlLkNvbW1OdW1zDQoJRW5kIElmDQoNCg0KCURpbSBzdHJDDQoJc3RyQz1HZXRUZW1wbGF0ZSgiVEVNUExBVEVfQl9BUlRJQ0xFX0NPTU1FTlQiKQ0KCW9iakNvbW1lbnQuQ291bnQ9b2JqQ29tbWVudC5Db3VudCsxDQoJc3RyQz1vYmpDb21tZW50Lk1ha2VUZW1wbGF0ZShzdHJDKQ0KCXN0ckM9UmVwbGFjZShzdHJDLCI8I1pDX0JMT0dfSE9TVCM+IixCbG9nSG9zdCkNCg0KCURpbSBhcnlUZW1wbGF0ZVRhZ3NOYW1lMg0KCURpbSBhcnlUZW1wbGF0ZVRhZ3NWYWx1ZTINCg0KCWFyeVRlbXBsYXRlVGFnc05hbWUyPVRlbXBsYXRlVGFnc0RpYy5LZXlzDQoJYXJ5VGVtcGxhdGVUYWdzVmFsdWUyPVRlbXBsYXRlVGFnc0RpYy5JdGVtcw0KDQoJaj1VQm91bmQoUmV0dXJuQWpheENvbW1lbnRfYXJ5VGVtcGxhdGVUYWdzTmFtZSkNCglGb3IgaT0xIHRvIGoNCgkJSWYgSXNOdWxsKFJldHVybkFqYXhDb21tZW50X2FyeVRlbXBsYXRlVGFnc1ZhbHVlKGkpKT1GYWxzZSBUaGVuDQoJCQlzdHJDID0gUmVwbGFjZShzdHJDLCI8IyIgJiBSZXR1cm5BamF4Q29tbWVudF9hcnlUZW1wbGF0ZVRhZ3NOYW1lKGkpICYgIiM+IiwgUmV0dXJuQWpheENvbW1lbnRfYXJ5VGVtcGxhdGVUYWdzVmFsdWUoaSkpDQoJCUVuZCBJZg0KCU5leHQNCg0KCWo9VUJvdW5kKGFyeVRlbXBsYXRlVGFnc05hbWUyKQ0KDQoJRm9yIGk9MSB0byBqDQoJCXN0ckM9UmVwbGFjZShzdHJDLCI8IyIgJiBhcnlUZW1wbGF0ZVRhZ3NOYW1lMihpKSAmICIjPiIsYXJ5VGVtcGxhdGVUYWdzVmFsdWUyKGkpKQ0KCU5leHQNCg0KDQoJc3RyQz0gUmVwbGFjZShzdHJDLHZiQ3JMZiwiIikNCglzdHJDPSBSZXBsYWNlKHN0ckMsdmJMZiwiIikNCglzdHJDPSBSZXBsYWNlKHN0ckMsdmJUYWIsIiIpDQoJUmVzcG9uc2UuV3JpdGUgc3RyQw0KDQoJUmV0dXJuQWpheENvbW1lbnQ9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBHZXQgQ29tbWVudCBBamF4DQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBHZXRDb21tZW50KGxvZ2lkLHBhZ2UpDQoNCglEaW0gb2JqQXJ0aWNsZQ0KCVNldCBvYmpBcnRpY2xlPU5ldyBUQXJ0aWNsZQ0KDQoJJ0ZpbHRlcl9QbHVnaW5fVEFydGljbGVfRXhwb3J0X1RlbXBsYXRlVGFncw0KCUNhbGwgQWRkX0ZpbHRlcl9QbHVnaW4oIkZpbHRlcl9QbHVnaW5fVEFydGljbGVfRXhwb3J0X1RlbXBsYXRlVGFncyIsIlJldHVybkFqYXhDb21tZW50X1BsdWdpbiIpDQoNCglJZiBvYmpBcnRpY2xlLkxvYWRJbmZvQnlJRChsb2dpZCkgVGhlbg0KCQlvYmpBcnRpY2xlLkNvbW1lbnRzUGFnZT1wYWdlDQoJCUNhbGwgb2JqQXJ0aWNsZS5FeHBvcnQoWkNfRElTUExBWV9NT0RFX0NPTU1FTlRTKQ0KCQlzPW9iakFydGljbGUuc3ViaHRtbA0KCUVuZCBJZg0KDQoJRGltIGksaixzDQoJRGltIGFyeVRlbXBsYXRlVGFnc05hbWUyDQoJRGltIGFyeVRlbXBsYXRlVGFnc1ZhbHVlMg0KDQoJYXJ5VGVtcGxhdGVUYWdzTmFtZTI9VGVtcGxhdGVUYWdzRGljLktleXMNCglhcnlUZW1wbGF0ZVRhZ3NWYWx1ZTI9VGVtcGxhdGVUYWdzRGljLkl0ZW1zDQoNCglqPVVCb3VuZChSZXR1cm5BamF4Q29tbWVudF9hcnlUZW1wbGF0ZVRhZ3NOYW1lKQ0KCUZvciBpPTEgdG8gag0KCQlJZiBJc051bGwoUmV0dXJuQWpheENvbW1lbnRfYXJ5VGVtcGxhdGVUYWdzVmFsdWUoaSkpPUZhbHNlIFRoZW4NCgkJCXMgPSBSZXBsYWNlKHMsIjwjIiAmIFJldHVybkFqYXhDb21tZW50X2FyeVRlbXBsYXRlVGFnc05hbWUoaSkgJiAiIz4iLCBSZXR1cm5BamF4Q29tbWVudF9hcnlUZW1wbGF0ZVRhZ3NWYWx1ZShpKSkNCgkJRW5kIElmDQoJTmV4dA0KDQoJaj1VQm91bmQoYXJ5VGVtcGxhdGVUYWdzTmFtZTIpDQoNCglGb3IgaT0xIHRvIGoNCgkJcz1SZXBsYWNlKHMsIjwjIiAmIGFyeVRlbXBsYXRlVGFnc05hbWUyKGkpICYgIiM+IixhcnlUZW1wbGF0ZVRhZ3NWYWx1ZTIoaSkpDQoJTmV4dA0KDQoJRGltIG9ialJlZ0V4cA0KCVNldCBvYmpSZWdFeHA9TmV3IFJlZ0V4cA0KCW9ialJlZ0V4cC5JZ25vcmVDYXNlID1UcnVlDQoJb2JqUmVnRXhwLkdsb2JhbD1UcnVlDQoJb2JqUmVnRXhwLlBhdHRlcm49IjxpbnQgaWQ9IiJBamF4Q29tbWVudFtcRFxkXSs/PC9pbnM+Ig0KCXM9IG9ialJlZ0V4cC5SZXBsYWNlKHMsIiIpDQoNCg0KCXM9IFJlcGxhY2Uocyx2YkNyTGYsIiIpDQoJcz0gUmVwbGFjZShzLHZiTGYsIiIpDQoJcz0gUmVwbGFjZShzLHZiVGFiLCIiKQ0KDQoJUmVzcG9uc2UuV3JpdGUgcw0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBQb3N0IFRyYWNrQmFjaw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gUG9zdFRyYWNrQmFjayhpbnRJRCxzdHJLZXkpDQoNCglEaW0gb2JqVHJhY2tCYWNrDQoJRGltIG9iakFydGljbGUNCg0KCURpbSBrZXlzDQoJRGltIGksaixrLGINCg0KCUlmIFpDX1RSQUNLQkFDS19UVVJOT0ZGIFRoZW4NCgkJQ2FsbCBSZXNwb25kRXJyb3IoNDEsWlZBX0Vycm9yTXNnKDQxKSkNCglFbmQgSWYNCg0KCUlmIExlbihzdHJLZXkpPTUgVGhlbg0KDQoJCUlmIENoZWNrVmFsaWRDb2RlKHN0cktleSk9RmFsc2UgVGhlbiBDYWxsIFNob3dFcnJvcig0MykNCg0KCUVsc2VJZiBMZW4oc3RyS2V5KT04IFRoZW4NCg0KCQlTZXQgb2JqQXJ0aWNsZT1OZXcgVEFydGljbGUNCgkJSWYgb2JqQXJ0aWNsZS5Mb2FkSW5mb0J5SUQoaW50SUQpIFRoZW4NCgkJCUlmIE5vdCAoc3RyS2V5PW9iakFydGljbGUuVHJhY2tCYWNrS2V5KSBUaGVuIENhbGwgUmVzcG9uZEVycm9yKDQzKQ0KCQkJSWYgb2JqQXJ0aWNsZS5MZXZlbDw0IFRoZW4gQ2FsbCBSZXNwb25kRXJyb3IoNDQpDQoJCUVuZCBJZg0KCQlTZXQgb2JqQXJ0aWNsZT1Ob3RoaW5nDQoNCglFbHNlDQoJCUV4aXQgRnVuY3Rpb24NCglFbmQgSWYNCg0KCVNldCBvYmpUcmFja0JhY2s9TmV3IFRUcmFja0JhY2sNCglTZXQgb2JqQXJ0aWNsZT1OZXcgVEFydGljbGUNCg0KCW9ialRyYWNrQmFjay5sb2dfSUQ9aW50SUQNCglvYmpUcmFja0JhY2suVVJMPVJlcXVlc3QuRm9ybSgidXJsIikNCglvYmpUcmFja0JhY2suVGl0bGU9UmVxdWVzdC5Gb3JtKCJ0aXRsZSIpDQoJb2JqVHJhY2tCYWNrLkJsb2c9UmVxdWVzdC5Gb3JtKCJibG9nX25hbWUiKQ0KCW9ialRyYWNrQmFjay5FeGNlcnB0PVJlcXVlc3QuRm9ybSgiZXhjZXJwdCIpDQoNCgkn5o6l5Y+jDQoJQ2FsbCBGaWx0ZXJfUGx1Z2luX1Bvc3RUcmFja0JhY2tfQ29yZShvYmpUcmFja0JhY2spDQoNCglJZiBvYmpUcmFja0JhY2suUG9zdCBUaGVuDQoJCUNhbGwgQnVpbGRBcnRpY2xlKG9ialRyYWNrQmFjay5sb2dfSUQsRmFsc2UsVHJ1ZSkNCgkJQmxvZ1JlQnVpbGRfVHJhY2tCYWNrcw0KCQlQb3N0VHJhY2tCYWNrPVRydWUNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1Bvc3RUcmFja0JhY2tfU3VjY2VlZChvYmpUcmFja0JhY2spDQoJRW5kIElmDQoNCglSZXNwb25zZS5Db250ZW50VHlwZSA9ICJ0ZXh0L3htbCINCglSZXNwb25zZS5DbGVhcg0KCVJlc3BvbnNlLldyaXRlIG9ialRyYWNrQmFjay5UYlhNTA0KDQoJU2V0IG9ialRyYWNrQmFjaz1Ob3RoaW5nDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBEZWwgVHJhY2tCYWNrDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBEZWxUcmFja0JhY2soaW50SUQsaW50TG9nX0lEKQ0KDQoJRGltIG9ialRyYWNrQmFjaw0KCURpbSBvYmpBcnRpY2xlDQoNCglTZXQgb2JqVHJhY2tCYWNrPU5ldyBUVHJhY2tCYWNrDQoJU2V0IG9iakFydGljbGU9TmV3IFRBcnRpY2xlDQoNCglJZiBvYmpUcmFja0JhY2suTG9hZEluZm9ieUlEKGludElEKSBUaGVuDQoNCgkJRGltIG9ialRlc3RBcnRpY2xlDQoJCVNldCBvYmpUZXN0QXJ0aWNsZT1OZXcgVEFydGljbGUNCgkJSWYgb2JqVGVzdEFydGljbGUuTG9hZEluZm9ieUlEKG9ialRyYWNrQmFjay5sb2dfSUQpIFRoZW4NCgkJCUlmIE5vdCgob2JqVGVzdEFydGljbGUuQXV0aG9ySUQ9QmxvZ1VzZXIuSUQpIE9yIChDaGVja1JpZ2h0cygiUm9vdCIpPVRydWUpKSBUaGVuIEV4aXQgRnVuY3Rpb24NCgkJRWxzZQ0KCQkJQ2FsbCBTaG93RXJyb3IoOSkNCgkJRW5kIElmDQoJCVNldCBvYmpUZXN0QXJ0aWNsZT1Ob3RoaW5nDQoNCgkJSWYgb2JqVHJhY2tCYWNrLkRlbCBUaGVuDQoJCQlDYWxsIEJ1aWxkQXJ0aWNsZShvYmpUcmFja0JhY2subG9nX0lELEZhbHNlLFRydWUpDQoJCQlCbG9nUmVCdWlsZF9UcmFja0JhY2tzDQoJCQlEZWxUcmFja0JhY2s9VHJ1ZQ0KCQlFbmQgSWYNCg0KCUVuZCBJZg0KDQoJU2V0IG9ialRyYWNrQmFjaz1Ob3RoaW5nDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBTZW5kIFRyYWNrQmFjaw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gU2VuZFRyYWNrQmFjaygpDQoNCglEaW0gb2JqVHJhY2tCYWNrDQoJRGltIG9iakFydGljbGUNCg0KCVNldCBvYmpUcmFja0JhY2s9TmV3IFRUcmFja0JhY2sNCglTZXQgb2JqQXJ0aWNsZT1OZXcgVEFydGljbGUNCg0KCUlmIG9iakFydGljbGUuTG9hZEluZm9ieUlEKFJlcXVlc3QuRm9ybSgiZWR0SUQiKSkgVGhlbg0KCQlvYmpUcmFja0JhY2suVVJMPW9iakFydGljbGUuVXJsDQoJCW9ialRyYWNrQmFjay5UaXRsZT1vYmpBcnRpY2xlLlRpdGxlDQoJCW9ialRyYWNrQmFjay5CbG9nPVpDX0JMT0dfTkFNRQ0KCQlvYmpUcmFja0JhY2suRXhjZXJwdD1MZWZ0KG9iakFydGljbGUuSHRtbENvbnRlbnQsMjUwKQ0KCUVsc2UNCgkJQ2FsbCBTaG93RXJyb3IoOSkNCglFbmQgSWYNCg0KCUlmIG9ialRyYWNrQmFjay5TZW5kKFJlcXVlc3QuRm9ybSgiZWR0VHJhY2tCYWNrIikpIFRoZW4gU2VuZFRyYWNrQmFjaz1UcnVlDQoJU2V0IG9ialRyYWNrQmFjaz1Ob3RoaW5nDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIEVkaXQgVXNlcg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gRWRpdFVzZXIoKQ0KDQoJRGltIG9ialVzZXINCglTZXQgb2JqVXNlcj1OZXcgVFVzZXINCglvYmpVc2VyLklEPVJlcXVlc3QuRm9ybSgiZWR0SUQiKQ0KCW9ialVzZXIuTGV2ZWw9UmVxdWVzdC5Gb3JtKCJlZHRMZXZlbCIpDQoJb2JqVXNlci5OYW1lPVJlcXVlc3QuRm9ybSgiZWR0TmFtZSIpDQoJb2JqVXNlci5FbWFpbD1SZXF1ZXN0LkZvcm0oImVkdEVtYWlsIikNCglvYmpVc2VyLkhvbWVQYWdlPVJlcXVlc3QuRm9ybSgiZWR0SG9tZVBhZ2UiKQ0KCW9ialVzZXIuQWxpYXM9UmVxdWVzdC5Gb3JtKCJlZHRBbGlhcyIpDQoJb2JqVXNlci5UZW1wbGF0ZU5hbWU9UmVxdWVzdC5Gb3JtKCJlZHRUZW1wbGF0ZSIpDQoNCglJZiBCbG9nVXNlci5MZXZlbDw0IFRoZW4NCgkJb2JqVXNlci5JbnRybz1SZXF1ZXN0LkZvcm0oImVkdEludHJvIikNCglFbmQgSWYNCg0KCUlmIFRyaW0oUmVxdWVzdC5Gb3JtKCJlZHRQYXNzV29yZCIpKTw+IiIgVGhlbg0KCQlvYmpVc2VyLlBhc3NXb3JkPW9ialVzZXIuQ3JlYXRlUGFzc3dvcmRCeU9yaWdpbmFsKFJlcXVlc3QuRm9ybSgiZWR0UGFzc1dvcmQiKSkNCgkJSWYgTm90IENoZWNrUmVnRXhwKFJlcXVlc3QuRm9ybSgiZWR0UGFzc1dvcmQiKSwiW3Bhc3N3b3JkXSIpIFRoZW4gQ2FsbCBTaG93RXJyb3IoNTQpDQoJRW5kIElmDQoNCglJZiBDTG5nKG9ialVzZXIuSUQpPjAgVGhlbiBvYmpVc2VyLk1ldGFTdHJpbmc9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgW21lbV9NZXRhXSBGUk9NIFtibG9nX01lbWJlcl0gV0hFUkUgW21lbV9JRF09IiZDTG5nKG9ialVzZXIuSUQpKSgwKQ0KCUNhbGwgR2V0TWV0YVZhbHVld2l0aEZvcm0ob2JqVXNlcikNCg0KCUlmIE5vdCgoQ0xuZyhvYmpVc2VyLklEKT1CbG9nVXNlci5JRCkgT3IgKENoZWNrUmlnaHRzKCJSb290Iik9VHJ1ZSkpIFRoZW4gRXhpdCBGdW5jdGlvbg0KDQoJJ+aOpeWPow0KCUNhbGwgRmlsdGVyX1BsdWdpbl9FZGl0VXNlcl9Db3JlKG9ialVzZXIpDQoNCglJZiBvYmpVc2VyLkVkaXQoQmxvZ1VzZXIpIFRoZW4NCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX0VkaXRVc2VyX1N1Y2NlZWQob2JqVXNlcikNCgkJRWRpdFVzZXI9VHJ1ZQ0KCUVuZCBJRg0KDQoJU2V0IG9ialVzZXI9Tm90aGluZw0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgRGVsIFVzZXINCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIERlbFVzZXIoaW50SUQpDQoNCglEaW0gb2JqUlMNCglEaW0gb2JqVXNlcg0KCURpbSBvYmpVcExvYWRGaWxlDQoNCglTZXQgb2JqVXNlcj1OZXcgVFVzZXINCglvYmpVc2VyLklEPWludElEDQoJSWYgb2JqVXNlci5EZWwoQmxvZ1VzZXIpIFRoZW4gRGVsVXNlcj1UcnVlDQoJU2V0IG9ialVzZXI9Tm90aGluZw0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBCbG9nIFJlQnVpbGQNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIE1ha2VCbG9nUmVCdWlsZCgpDQoNCgkncGx1Z2luIG5vZGUNCgliQWN0aW9uX1BsdWdpbl9NYWtlQmxvZ1JlQnVpbGRfQmVnaW49RmFsc2UNCglGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9NYWtlQmxvZ1JlQnVpbGRfQmVnaW4gaW4gQWN0aW9uX1BsdWdpbl9NYWtlQmxvZ1JlQnVpbGRfQmVnaW4NCgkJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fTWFrZUJsb2dSZUJ1aWxkX0JlZ2luKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9NYWtlQmxvZ1JlQnVpbGRfQmVnaW4pDQoJCUlmIGJBY3Rpb25fUGx1Z2luX01ha2VCbG9nUmVCdWlsZF9CZWdpbj1UcnVlIFRoZW4gRXhpdCBGdW5jdGlvbg0KCU5leHQNCg0KCUNhbGwgTWFrZUJsb2dSZUJ1aWxkX0NvcmUoKQ0KDQoJU2Vzc2lvbigiYmF0Y2h0aW1lIik9U2Vzc2lvbigiYmF0Y2h0aW1lIikrUnVuVGltZQ0KDQoJQ2FsbCBTZXRCbG9nSGludChUcnVlLEZhbHNlLEVtcHR5KQ0KDQoJTWFrZUJsb2dSZUJ1aWxkPVRydWUNCg0KCSdwbHVnaW4gbm9kZQ0KCWJBY3Rpb25fUGx1Z2luX01ha2VCbG9nUmVCdWlsZF9FbmQ9RmFsc2UNCglGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9NYWtlQmxvZ1JlQnVpbGRfRW5kIGluIEFjdGlvbl9QbHVnaW5fTWFrZUJsb2dSZUJ1aWxkX0VuZA0KCQlJZiBOb3QgSXNFbXB0eShzQWN0aW9uX1BsdWdpbl9NYWtlQmxvZ1JlQnVpbGRfRW5kKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9NYWtlQmxvZ1JlQnVpbGRfRW5kKQ0KCQlJZiBiQWN0aW9uX1BsdWdpbl9NYWtlQmxvZ1JlQnVpbGRfRW5kPVRydWUgVGhlbiBFeGl0IEZ1bmN0aW9uDQoJTmV4dA0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICDmlofku7bph43lu7og5om55aSE55CGIOWJjee9rg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gQmVmb3JlRmlsZVJlQnVpbGQoKQ0KDQoJSWYgWkNfUE9TVF9TVEFUSUNfTU9ERTw+IlNUQVRJQyIgVGhlbiBFeGl0IEZ1bmN0aW9uDQoNCglEaW0gb2JqUlMNCglEaW0gb2JqQXJ0aWNsZQ0KDQoJU2V0IG9ialJTPVNlcnZlci5DcmVhdGVPYmplY3QoIkFET0RCLlJlY29yZHNldCIpDQoJb2JqUlMuQ3Vyc29yVHlwZSA9IGFkT3BlbktleXNldA0KCW9ialJTLkxvY2tUeXBlID0gYWRMb2NrUmVhZE9ubHkNCglvYmpSUy5BY3RpdmVDb25uZWN0aW9uPW9iakNvbm4NCglvYmpSUy5Tb3VyY2U9IlNFTEVDVCBbbG9nX0lEXSBGUk9NIFtibG9nX0FydGljbGVdIFdIRVJFIFtsb2dfTGV2ZWxdPjEiDQoJb2JqUlMuT3BlbigpDQoNCglJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoNCgkJb2JqUlMuUGFnZVNpemUgPSBaQ19SRUJVSUxEX0ZJTEVfQ09VTlQNCg0KCQlEaW0gaQ0KCQlGb3IgaT0xIFRvIG9ialJTLlBhZ2VDb3VudA0KCQkJQ2FsbCBBZGRCYXRjaChaQ19NU0cwNzMgJiAiPCImaSYiPiIsIkNhbGwgTWFrZUZpbGVSZUJ1aWxkKCImaSYiKSIpDQoJCU5leHQNCg0KCUVuZCBJZg0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIEFsbCBGaWxlcyBSZUJ1aWxkDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBNYWtlRmlsZVJlQnVpbGQoaW50UGFnZSkNCg0KCSdwbHVnaW4gbm9kZQ0KCSdiQWN0aW9uX1BsdWdpbl9NYWtlRmlsZVJlQnVpbGRfQmVnaW49RmFsc2UNCgknRm9yIEVhY2ggc0FjdGlvbl9QbHVnaW5fTWFrZUZpbGVSZUJ1aWxkX0JlZ2luIGluIEFjdGlvbl9QbHVnaW5fTWFrZUZpbGVSZUJ1aWxkX0JlZ2luDQoJJwlJZiBOb3QgSXNFbXB0eShzQWN0aW9uX1BsdWdpbl9NYWtlRmlsZVJlQnVpbGRfQmVnaW4pIFRoZW4gQ2FsbCBFeGVjdXRlKHNBY3Rpb25fUGx1Z2luX01ha2VGaWxlUmVCdWlsZF9CZWdpbikNCgknCUlmIGJBY3Rpb25fUGx1Z2luX01ha2VGaWxlUmVCdWlsZF9CZWdpbj1UcnVlIFRoZW4gRXhpdCBGdW5jdGlvbg0KCSdOZXh0DQoNCglEaW0gaSxqDQoNCglEaW0gb2JqUlMNCglEaW0gb2JqQXJ0aWNsZQ0KDQoJU2V0IG9ialJTPVNlcnZlci5DcmVhdGVPYmplY3QoIkFET0RCLlJlY29yZHNldCIpDQoJb2JqUlMuQ3Vyc29yVHlwZSA9IGFkT3BlbktleXNldA0KCW9ialJTLkxvY2tUeXBlID0gYWRMb2NrUmVhZE9ubHkNCglvYmpSUy5BY3RpdmVDb25uZWN0aW9uPW9iakNvbm4NCglvYmpSUy5Tb3VyY2U9IlNFTEVDVCBbbG9nX0lEXSBGUk9NIFtibG9nX0FydGljbGVdIFdIRVJFIFtsb2dfTGV2ZWxdPjEiDQoJb2JqUlMuT3BlbigpDQoNCglJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoNCgkJb2JqUlMuUGFnZVNpemUgPSBaQ19SRUJVSUxEX0ZJTEVfQ09VTlQNCg0KCQlvYmpSUy5BYnNvbHV0ZVBhZ2UgPSBpbnRQYWdlDQoNCgkJRm9yIGkgPSAxIFRvIG9ialJTLlBhZ2VTaXplDQoNCgkJCUNhbGwgQnVpbGRBcnRpY2xlKG9ialJTKCJsb2dfSUQiKSxGYWxzZSxGYWxzZSkNCg0KCQkJb2JqUlMuTW92ZU5leHQNCgkJCUlmIG9ialJTLmVvZiBUaGVuIEV4aXQgRm9yDQoJCQkNCgkJCQ0KCQlOZXh0DQoNCgkJU2Vzc2lvbigiYmF0Y2h0aW1lIik9U2Vzc2lvbigiYmF0Y2h0aW1lIikrUnVuVGltZQ0KDQoJRW5kIElmDQoNCgkncGx1Z2luIG5vZGUNCgknYkFjdGlvbl9QbHVnaW5fTWFrZUZpbGVSZUJ1aWxkX0VuZD1GYWxzZQ0KCSdGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9NYWtlRmlsZVJlQnVpbGRfRW5kIGluIEFjdGlvbl9QbHVnaW5fTWFrZUZpbGVSZUJ1aWxkX0VuZA0KCScJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fTWFrZUZpbGVSZUJ1aWxkX0VuZCkgVGhlbiBDYWxsIEV4ZWN1dGUoc0FjdGlvbl9QbHVnaW5fTWFrZUZpbGVSZUJ1aWxkX0VuZCkNCgknCUlmIGJBY3Rpb25fUGx1Z2luX01ha2VGaWxlUmVCdWlsZF9FbmQ9VHJ1ZSBUaGVuIEV4aXQgRnVuY3Rpb24NCgknTmV4dA0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgQmF0Y2ggQUxMDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBCYXRjaEFsbCgpDQoNCglPbiBFcnJvciBSZXN1bWUgTmV4dA0KDQoJU2VydmVyLlNjcmlwdFRpbWVvdXQgPSAxMjAwDQoNCglJZiBSZXF1ZXN0LlF1ZXJ5U3RyaW5nKCJjYW5jZWwiKT0idHJ1ZSIgVGhlbg0KCQlTZXNzaW9uKCJiYXRjaCIpLlJlbW92ZUFsbA0KCQlTZXNzaW9uKCJiYXRjaG9yZGVyIik9MA0KCQlTZXNzaW9uKCJiYXRjaHRpbWUiKT0wDQoJRW5kIElmIA0KCQ0KCQ0KCUlmIElzT2JqZWN0KFNlc3Npb24oImJhdGNoIikpIFRoZW4NCgkNCgkJRGltIGkNCgkJRGltIGENCgkJU2V0IGEgPSBTZXNzaW9uKCJiYXRjaCIpDQoJCURpbSBiDQoJCWI9YS5LZXlzDQoJCURpbSBjDQoJCWM9YS5JdGVtcw0KCQ0KCQlEaW0gaW50QWxsVGltZQ0KCQ0KCSANCgkJSWYgYS5Db3VudCA+MCBUaGVuDQoJDQoJCQlGb3IgaSA9IDAgVG8gMA0KCQ0KCQkJCVJlc3BvbnNlLldyaXRlICI8IURPQ1RZUEUgaHRtbCBQVUJMSUMgIiItLy9XM0MvL0RURCBYSFRNTCAxLjAgVHJhbnNpdGlvbmFsLy9FTiIiICIiaHR0cDovL3d3dy53My5vcmcvVFIveGh0bWwxL0RURC94aHRtbDEtdHJhbnNpdGlvbmFsLmR0ZCIiPjxodG1sPjxoZWFkPjxtZXRhIGh0dHAtZXF1aXY9IiJDb250ZW50LVR5cGUiIiBjb250ZW50PSIidGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04IiIvPjxtZXRhIGh0dHAtZXF1aXY9IiJyZWZyZXNoIiIgY29udGVudD0iIiImWkNfUkVCVUlMRF9GSUxFX0lOVEVSVkFMJiI7VVJMPSImQmxvZ0hvc3QgJiAiemJfc3lzdGVtL2NtZC5hc3A/YWN0PWJhdGNoIiYiJmFsbD0iJmludEFsbFRpbWUmIiIiLz48c3R5bGU+Ym9keXtwYWRkaW5nOjA7IG1hcmdpbjowO2JhY2tncm91bmQ6I2RiZTNmZjt9aW1ne2JvcmRlcjowO3BhZGRpbmc6MDsgbWFyZ2luOjA7YmFja2dyb3VuZDpUcmFuc3BhcmVudDt9PC9zdHlsZT48L2hlYWQ+PGJvZHk+Ig0KCQkJCVJlc3BvbnNlLldyaXRlICI8aW1nIHNyYz0naW1hZ2UvYWRtaW4vbG9hZGluZy5naWYnIHdpZHRoPScyMCc+Ig0KCQkJCVJlc3BvbnNlLldyaXRlICI8c2NyaXB0IHR5cGU9IiJ0ZXh0L2phdmFzY3JpcHQiIj5wYXJlbnQuQmF0Y2gyVGlwKCIiIiZiKDApICYgWkNfTVNHMTA5JiIiIik8L3NjcmlwdD4iDQoJCQkJSWYgU2Vzc2lvbigiYmF0Y2hvcmRlciIpPVNlc3Npb24oImJhdGNoIikuQ291bnQgVGhlbg0KCQkJCQlSZXNwb25zZS5Xcml0ZSAiPHNjcmlwdCB0eXBlPSIidGV4dC9qYXZhc2NyaXB0IiI+cGFyZW50LkJhdGNoQmVnaW4oKTwvc2NyaXB0PiINCgkJCQlFbmQgSWYNCgkJCQlSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iImhpZGRlbiIiPiINCgkJCQlDYWxsIEdldEJsb2dIaW50KCkNCgkJCQlSZXNwb25zZS5Xcml0ZSAiPC9kaXY+Ig0KCQ0KCQkJCVJlc3BvbnNlLkZsdXNoDQoJDQoJCQkJUmVzcG9uc2UuV3JpdGUgIjwvYm9keT48L2h0bWw+Ig0KCQ0KCQkJCUNhbGwgRXhlY3V0ZShjKDApKQ0KCQkJCVNlc3Npb24oImJhdGNoIikuUmVtb3ZlKGIoMCkpDQoJDQoJCQlOZXh0DQoJDQoJCUVsc2UNCgkNCgkNCgkJCVJlc3BvbnNlLldyaXRlICI8IURPQ1RZUEUgaHRtbCBQVUJMSUMgIiItLy9XM0MvL0RURCBYSFRNTCAxLjAgVHJhbnNpdGlvbmFsLy9FTiIiICIiaHR0cDovL3d3dy53My5vcmcvVFIveGh0bWwxL0RURC94aHRtbDEtdHJhbnNpdGlvbmFsLmR0ZCIiPjxodG1sPjxoZWFkPjxtZXRhIGh0dHAtZXF1aXY9IiJDb250ZW50LVR5cGUiIiBjb250ZW50PSIidGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04IiIvPjxzdHlsZT5ib2R5e3BhZGRpbmc6MDsgbWFyZ2luOjA7YmFja2dyb3VuZDojZGJlM2ZmO31pbWd7Ym9yZGVyOjA7cGFkZGluZzowOyBtYXJnaW46MDtiYWNrZ3JvdW5kOlRyYW5zcGFyZW50O308L3N0eWxlPjwvaGVhZD48Ym9keT4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiPGltZyBzcmM9J2ltYWdlL2FkbWluL29rLnBuZycgd2lkdGg9JzE2Jz4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiPHNjcmlwdCB0eXBlPSIidGV4dC9qYXZhc2NyaXB0IiI+cGFyZW50LkJhdGNoMlRpcCgiIiImWkNfTVNHMjI3ICYgUmVwbGFjZShaQ19NU0cxNjksIiVuIixTZXNzaW9uKCJiYXRjaHRpbWUiKS8xMDAwKSAmIiIiKTwvc2NyaXB0PiINCgkJCVJlc3BvbnNlLldyaXRlICI8c2NyaXB0IHR5cGU9IiJ0ZXh0L2phdmFzY3JpcHQiIj5wYXJlbnQuQmF0Y2hFbmQoKTwvc2NyaXB0PiINCgkNCgkJCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIiaGlkZGVuIiI+Ig0KCQkJQ2FsbCBHZXRCbG9nSGludCgpDQoJCQlSZXNwb25zZS5Xcml0ZSAiPC9kaXY+Ig0KCQkJSWYgU2Vzc2lvbigiYmF0Y2h0aW1lIikvMTAwMD4wIFRoZW4NCgkJCQlSZXNwb25zZS5Xcml0ZSAiPHNjcmlwdCB0eXBlPSIidGV4dC9qYXZhc2NyaXB0IiI+cGFyZW50LkJhdGNoTm90aWZ5KCk7PC9zY3JpcHQ+Ig0KCQkJRW5kIElmDQoJCQkNCgkJCVJlc3BvbnNlLldyaXRlICI8L2JvZHk+PC9odG1sPiINCgkNCgkJCVNlc3Npb24uQWJhbmRvbg0KCQ0KCQlFbmQgSWYNCglFbmQgSWYNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgTGlzdCBVc2VyIFJpZ2h0cw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gTGlzdFVzZXJfUmlnaHRzKCkNCg0KCURpbSBzDQoJRGltIGkNCglEaW0gdA0KCURpbSBzdHJBY3Rpb24NCglEaW0gYXJ5QWN0aW9uDQoNCglzdHJBY3Rpb249IlJvb3R8bG9naW58dmVyaWZ5fGxvZ291dHxhZG1pbnxjbXR8dnJzfHJzc3xiYXRjaHxCbG9nUmVCdWlsZHxGaWxlUmVCdWlsZHxBcnRpY2xlTW5nfEFydGljbGVFZHR8QXJ0aWNsZVBzdHxBcnRpY2xlRGVsfENhdGVnb3J5TW5nfENhdGVnb3J5UHN0fENhdGVnb3J5RGVsfENvbW1lbnRNbmd8Q29tbWVudERlbHxVc2VyTW5nfFVzZXJFZHR8VXNlck1vZHxVc2VyQ3J0fFVzZXJEZWx8RmlsZU1uZ3xGaWxlVXBsb2FkfEZpbGVEZWx8U2VhcmNofFRhZ01uZ3xUYWdFZHR8VGFnUHN0fFRhZ0RlbHxTZXR0aW5nTW5nfFNldHRpbmdTYXZ8UGx1Z0luTW5nfEZ1bmN0aW9uTW5nfEFydGljbGVBbGx8Q29tbWVudEFsbHxGaWxlQWxsIg0KDQoJYXJ5QWN0aW9uPVNwbGl0KHN0ckFjdGlvbiwgInwiKQ0KDQoJcz1TcGxpdChaQ19NU0cwMTksIiVzIikNCg0KCVJlc3BvbnNlLldyaXRlICI8IURPQ1RZUEUgaHRtbCBQVUJMSUMgIiItLy9XM0MvL0RURCBYSFRNTCAxLjAgVHJhbnNpdGlvbmFsLy9FTiIiICIiaHR0cDovL3d3dy53My5vcmcvVFIveGh0bWwxL0RURC94aHRtbDEtdHJhbnNpdGlvbmFsLmR0ZCIiPjxodG1sIHhtbG5zPSIiaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIiIHhtbDpsYW5nPSIiIiZaQ19CTE9HX0xBTkdVQUdFJiIiIiBsYW5nPSIiIiZaQ19CTE9HX0xBTkdVQUdFJiIiIj48aGVhZD48bWV0YSBodHRwLWVxdWl2PSIiQ29udGVudC1UeXBlIiIgY29udGVudD0iInRleHQvaHRtbDsgY2hhcnNldD11dGYtOCIiIC8+PG1ldGEgaHR0cC1lcXVpdj0iIkNvbnRlbnQtTGFuZ3VhZ2UiIiBjb250ZW50PSIiIiZaQ19CTE9HX0xBTkdVQUdFJiIiIiAvPjxsaW5rIHJlbD0iInN0eWxlc2hlZXQiIiByZXY9IiJzdHlsZXNoZWV0IiIgaHJlZj0iImNzcy9hZG1pbi5jc3MiIiB0eXBlPSIidGV4dC9jc3MiIiBtZWRpYT0iInNjcmVlbiIiIC8+PHRpdGxlPiImWkNfQkxPR19USVRMRSAmIFpDX01TRzA0NCAmIFpDX01TRzAyMSYiPC90aXRsZT48L2hlYWQ+PGJvZHkgY2xhc3M9IiJzaG9ydCIiPjxkaXYgY2xhc3M9IiJiZyIiPjxkaXYgaWQ9IiJ3cmFwcGVyIiI+PGRpdiBjbGFzcz0iImxvZ28iIj48aW1nIHNyYz0iImltYWdlL2FkbWluL25vbmUuZ2lmIiIgdGl0bGU9IiJaLUJsb2ciIiBhbHQ9IiJaLUJsb2ciIi8+PC9kaXY+PGRpdiBjbGFzcz0iImxvZ2luIiIgc3R5bGU9IiJ3aWR0aDozMDBweDsiIj48Zm9ybSBpZD0iImZybUxvZ2luIiIgbWV0aG9kPSIicG9zdCIiIGFjdGlvbj0iIiIiPjxkbD48ZGQ+Ig0KDQoNCglSZXNwb25zZS5Xcml0ZSBaQ19NU0cwMDEgJiAiOiIgJiBCTG9nVXNlci5OYW1lICYgIjxici8+PGJyLz4iDQoJUmVzcG9uc2UuV3JpdGUgWkNfTVNHMjQ5ICYgIjoiICYgWlZBX1VzZXJfTGV2ZWxfTmFtZShCTG9nVXNlci5MZXZlbCkgJiAiPGJyLz48YnIvPiINCg0KCUZvciBpPUxCb3VuZChhcnlBY3Rpb24pIFRvIFVCb3VuZChhcnlBY3Rpb24pDQoJCUlmIE5vdCBDaGVja1JpZ2h0cyhhcnlBY3Rpb24oaSkpIFRoZW4gdD10ICYgIjxwIHN0eWxlPSdkaXNwbGF5Om5vbmU7Jz4iICYgUmVwbGFjZShzKGkpICYgIiVzIiwiJXMiLCI6PGZvbnQgY29sb3I9UmVkPmZhaWw8L2ZvbnQ+IiYiIiwxLDEpICYgIjwvcD4iIEVsc2UgdD10ICYgIjxwPiIgJiBSZXBsYWNlKHMoaSkgJiAiJXMiLCIlcyIsIjo8Zm9udCBjb2xvcj1ncmVlbj5vazwvZm9udD4iJiIiLDEsMSkgJiAiPC9wPjxici8+IiANCglOZXh0DQoNCglSZXNwb25zZS5Xcml0ZSB0DQoNCglSZXNwb25zZS5Xcml0ZSAiPC9kZD48L2RsPjwvZGl2PjwvZGl2PjwvZGl2PjwvYm9keT48L2h0bWw+Ig0KDQoNCglMaXN0VXNlcl9SaWdodHM9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KDQonLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIFNhdmUgQmxvZyBTZXR0aW5nDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBTYXZlU2V0dGluZygpDQoNCglPbiBFcnJvciBSZXN1bWUgTmV4dA0KDQoJSWYgQmxvZ0NvbmZpZy5FeGlzdHMoIlpDX1NZTlRBWEhJR0hMSUdIVEVSX0VOQUJMRSIpPUZhbHNlIFRoZW4gQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19TWU5UQVhISUdITElHSFRFUl9FTkFCTEUiLEZhbHNlKQ0KDQoJSWYgQmxvZ0NvbmZpZy5FeGlzdHMoIlpDX0NPREVNSVJST1JfRU5BQkxFIik9RmFsc2UgVGhlbiBDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX0NPREVNSVJST1JfRU5BQkxFIixGYWxzZSkNCg0KCUlmIEJsb2dDb25maWcuRXhpc3RzKCJaQ19BUlRJQ0xFX0VYQ0VSUFRfTUFYIik9RmFsc2UgVGhlbiBDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX0FSVElDTEVfRVhDRVJQVF9NQVgiLDI1MCkNCg0KCUlmIEJsb2dDb25maWcuRXhpc3RzKCJaQ19QT1NUX1NUQVRJQ19NT0RFIik9RmFsc2UgVGhlbiBDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX1BPU1RfU1RBVElDX01PREUiLCJTVEFUSUMiKQ0KCQ0KCUlmIEJsb2dDb25maWcuRXhpc3RzKCJaQ19IVFRQX0xBU1RNT0RJRklFRCIpPUZhbHNlIFRoZW4gQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19IVFRQX0xBU1RNT0RJRklFRCIsRmFsc2UpDQoNCglJZiBCbG9nQ29uZmlnLkV4aXN0cygiWkNfVU5DQVRFR09SSVpFRF9OQU1FIik9RmFsc2UgVGhlbiBDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX1VOQ0FURUdPUklaRURfTkFNRSIsWkNfTVNHMDU5KQ0KDQoJSWYgQmxvZ0NvbmZpZy5FeGlzdHMoIlpDX1VOQ0FURUdPUklaRURfQUxJQVMiKT1GYWxzZSBUaGVuIENhbGwgQmxvZ0NvbmZpZy5Xcml0ZSgiWkNfVU5DQVRFR09SSVpFRF9BTElBUyIsIiIpDQoNCglJZiBCbG9nQ29uZmlnLkV4aXN0cygiWkNfVU5DQVRFR09SSVpFRF9DT1VOVCIpPUZhbHNlIFRoZW4gQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19VTkNBVEVHT1JJWkVEX0NPVU5UIiwwKQ0KDQoJSWYgQmxvZ0NvbmZpZy5FeGlzdHMoIlpDX0hUVFBfTEFTVE1PRElGSUVEIik9RmFsc2UgVGhlbiBDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX0hUVFBfTEFTVE1PRElGSUVEIixGYWxzZSkNCg0KCUlmIEJsb2dDb25maWcuRXhpc3RzKCJaQ19QRVJNQU5FTlRfRE9NQUlOX0VOQUJMRSIpPUZhbHNlIFRoZW4gQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19QRVJNQU5FTlRfRE9NQUlOX0VOQUJMRSIsRmFsc2UpDQoNCglJZiBCbG9nQ29uZmlnLkV4aXN0cygiWkNfREVGQVVMVF9QQUdFU19URU1QTEFURSIpPUZhbHNlIFRoZW4gQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19ERUZBVUxUX1BBR0VTX1RFTVBMQVRFIiwiIikNCg0KCUlmIEJsb2dDb25maWcuRXhpc3RzKCJaQ19TSURFQkFSX09SREVSIiApPUZhbHNlIFRoZW4gQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19TSURFQkFSX09SREVSIixaQ19ERUZBVUxUX1NJREVCQVIpDQoNCglJZiBCbG9nQ29uZmlnLkV4aXN0cygiWkNfU0lERUJBUl9PUkRFUjIiKT1GYWxzZSBUaGVuIENhbGwgQmxvZ0NvbmZpZy5Xcml0ZSgiWkNfU0lERUJBUl9PUkRFUjIiLCIiKQ0KDQoJSWYgQmxvZ0NvbmZpZy5FeGlzdHMoIlpDX1NJREVCQVJfT1JERVIzIik9RmFsc2UgVGhlbiBDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX1NJREVCQVJfT1JERVIzIiwiIikNCg0KCUlmIEJsb2dDb25maWcuRXhpc3RzKCJaQ19TSURFQkFSX09SREVSNCIpPUZhbHNlIFRoZW4gQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19TSURFQkFSX09SREVSNCIsIiIpDQoNCglJZiBCbG9nQ29uZmlnLkV4aXN0cygiWkNfU0lERUJBUl9PUkRFUjUiKT1GYWxzZSBUaGVuIENhbGwgQmxvZ0NvbmZpZy5Xcml0ZSgiWkNfU0lERUJBUl9PUkRFUjUiLCIiKQ0KDQoJSWYgQmxvZ0NvbmZpZy5FeGlzdHMoIlpDX1NJREVCQVJfT1JERVJfT0xEIiApPUZhbHNlIFRoZW4gQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19TSURFQkFSX09SREVSX09MRCIgLCIiKQ0KDQoJSWYgQmxvZ0NvbmZpZy5FeGlzdHMoIlpDX1NJREVCQVJfT1JERVIyX09MRCIpPUZhbHNlIFRoZW4gQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19TSURFQkFSX09SREVSMl9PTEQiLCIiKQ0KDQoJSWYgQmxvZ0NvbmZpZy5FeGlzdHMoIlpDX1NJREVCQVJfT1JERVIzX09MRCIpPUZhbHNlIFRoZW4gQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19TSURFQkFSX09SREVSM19PTEQiLCIiKQ0KDQoJSWYgQmxvZ0NvbmZpZy5FeGlzdHMoIlpDX1NJREVCQVJfT1JERVI0X09MRCIpPUZhbHNlIFRoZW4gQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19TSURFQkFSX09SREVSNF9PTEQiLCIiKQ0KDQoJSWYgQmxvZ0NvbmZpZy5FeGlzdHMoIlpDX1NJREVCQVJfT1JERVI1X09MRCIpPUZhbHNlIFRoZW4gQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19TSURFQkFSX09SREVSNV9PTEQiLCIiKQ0KDQoJSWYgQmxvZ0NvbmZpZy5FeGlzdHMoIlpDX0FSQ0hJVkVTX09MRF9MSVNUVFlQRSIpPUZhbHNlIFRoZW4gQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19BUkNISVZFU19PTERfTElTVFRZUEUiLCIiKQ0KCQ0KCUlmIEJsb2dDb25maWcuRXhpc3RzKCJaQ19CTE9HX0xBTkdVQUdFUEFDSyIpPUZhbHNlIFRoZW4gQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19CTE9HX0xBTkdVQUdFUEFDSyIsIlNpbXBDaGluZXNlIikNCg0KCUlmIEJsb2dDb25maWcuRXhpc3RzKCJaQ19DT01NRU5UX0VYQ0VSUFRfTUFYIik9RmFsc2UgVGhlbiBDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX0NPTU1FTlRfRVhDRVJQVF9NQVgiLDIwKQ0KDQoNCglEaW0gYSxiLGMsZCxlDQoNCglTZXQgZD1DcmVhdGVPYmplY3QoIlNjcmlwdGluZy5EaWN0aW9uYXJ5IikNCgllPSIiDQoJRm9yIEVhY2ggYSBJbiBSZXF1ZXN0LkZvcm0NCgkJZT1lICYgYSAmICJ8Ig0KCU5leHQNCg0KCUZvciBFYWNoIGEgSW4gUmVxdWVzdC5Gb3JtIA0KCQliPU1pZChhLDQsTGVuKGEpKQ0KCQlJZiBCbG9nQ29uZmlnLkV4aXN0cyhiKT1UcnVlIFRoZW4NCgkJCUlmIGI9IlpDX1VQTE9BRF9GSUxFU0laRSIgT3IgYj0iWkNfRElTUExBWV9DT1VOVCIgT3IgYj0iWkNfU0VBUkNIX0NPVU5UIiBPciBiPSJaQ19NVVRVQUxJVFlfQ09VTlQiIE9yIGI9IlpDX01VVFVBTElUWV9DT1VOVCIgT3IgYj0iWkNfQ09NTUVOVFNfRElTUExBWV9DT1VOVCIgIE9yIGI9IlpDX1JFQlVJTERfRklMRV9DT1VOVCIgIE9yIGI9IlpDX1JFQlVJTERfRklMRV9JTlRFUlZBTCIgT3IgYj0iWkNfUEFHRUJBUl9DT1VOVCIgVGhlbg0KCQkJCWM9UmVxdWVzdC5Gb3JtKGEpDQoJCQkJQ2FsbCBDaGVja1BhcmFtZXRlcihjLCJpbnQiLDApDQoJCQkJZC5hZGQgYixDU3RyKGMpDQoJCQlFbHNlDQoJCQkJZC5hZGQgYixSZXF1ZXN0LkZvcm0oYSkNCg0KCQkJRW5kIElmDQoJCUVuZCBJZg0KCU5leHQNCgkNCglJZiBkLkV4aXN0cygiWkNfU1RBVElDX0RJUkVDVE9SWSIpPVRydWUgVGhlbg0KCQlJZiBCbG9nQ29uZmlnLlJlYWQoIlpDX1NUQVRJQ19ESVJFQ1RPUlkiKTw+ZC5JdGVtKCJaQ19TVEFUSUNfRElSRUNUT1JZIilUaGVuDQoJCQlDYWxsIENyZWF0RGlyZWN0b3J5QnlDdXN0b21EaXJlY3RvcnkoZC5JdGVtKCJaQ19TVEFUSUNfRElSRUNUT1JZIikpDQoJCQlDYWxsIFNldEJsb2dIaW50KEVtcHR5LEVtcHR5LFRydWUpDQoJCUVuZCBJZg0KCUVuZCBJZg0KCUlmIGQuRXhpc3RzKCJaQ19CTE9HX0hPU1QiKT1UcnVlIFRoZW4NCgkJSWYgQmxvZ0NvbmZpZy5SZWFkKCJaQ19CTE9HX0hPU1QiKTw+ZC5JdGVtKCJaQ19CTE9HX0hPU1QiKVRoZW4NCgkJCUlmIExlZnQoZC5JdGVtKCJaQ19CTE9HX0hPU1QiKSw3KTw+Imh0dHA6Ly8iIEFuZCBMZWZ0KGQuSXRlbSgiWkNfQkxPR19IT1NUIiksOCk8PiJodHRwczovLyIgVGhlbg0KCQkJCWQuSXRlbSgiWkNfQkxPR19IT1NUIik9Imh0dHA6Ly8iICYgZC5JdGVtKCJaQ19CTE9HX0hPU1QiKQ0KCQkJRW5kIElmDQoJCQlJZiBSaWdodChkLkl0ZW0oIlpDX0JMT0dfSE9TVCIpLDEpPD4iLyIgVGhlbg0KCQkJCWQuSXRlbSgiWkNfQkxPR19IT1NUIik9ZC5JdGVtKCJaQ19CTE9HX0hPU1QiKSAmICIvIg0KCQkJRW5kIElmDQoJCQlJZiBkLkl0ZW0oIlpDX1BFUk1BTkVOVF9ET01BSU5fRU5BQkxFIik9IlRydWUiIFRoZW4gQ2FsbCBTZXRCbG9nSGludChFbXB0eSxFbXB0eSxUcnVlKQ0KCQlFbmQgSWYNCglFbmQgSWYNCglJZiBkLkV4aXN0cygiWkNfUEVSTUFORU5UX0RPTUFJTl9FTkFCTEUiKT1UcnVlIFRoZW4NCgkJSWYgQmxvZ0NvbmZpZy5SZWFkKCJaQ19QRVJNQU5FTlRfRE9NQUlOX0VOQUJMRSIpPD5kLkl0ZW0oIlpDX1BFUk1BTkVOVF9ET01BSU5fRU5BQkxFIikgVGhlbiBDYWxsIFNldEJsb2dIaW50KEVtcHR5LEVtcHR5LFRydWUpDQoJRW5kIElmDQoJSWYgZC5FeGlzdHMoIlpDX0JMT0dfVElUTEUiKT1UcnVlIFRoZW4NCgkJSWYgQmxvZ0NvbmZpZy5SZWFkKCJaQ19CTE9HX1RJVExFIik8PmQuSXRlbSgiWkNfQkxPR19USVRMRSIpVGhlbiBDYWxsIFNldEJsb2dIaW50KEVtcHR5LEVtcHR5LFRydWUpDQoJRW5kIElmDQoJSWYgZC5FeGlzdHMoIlpDX0JMT0dfU1VCVElUTEUiKT1UcnVlIFRoZW4NCgkJSWYgQmxvZ0NvbmZpZy5SZWFkKCJaQ19CTE9HX1NVQlRJVExFIik8PmQuSXRlbSgiWkNfQkxPR19TVUJUSVRMRSIpVGhlbiBDYWxsIFNldEJsb2dIaW50KEVtcHR5LEVtcHR5LFRydWUpDQoJRW5kIElmDQoJSWYgZC5FeGlzdHMoIlpDX0JMT0dfQ09QWVJJR0hUIik9VHJ1ZSBUaGVuDQoJCUlmIEJsb2dDb25maWcuUmVhZCgiWkNfQkxPR19DT1BZUklHSFQiKTw+ZC5JdGVtKCJaQ19CTE9HX0NPUFlSSUdIVCIpVGhlbiBDYWxsIFNldEJsb2dIaW50KEVtcHR5LEVtcHR5LFRydWUpDQoJRW5kIElmDQoJSWYgZC5FeGlzdHMoIlpDX0JMT0dfTEFOR1VBR0UiKT1UcnVlIFRoZW4NCgkJSWYgQmxvZ0NvbmZpZy5SZWFkKCJaQ19CTE9HX0xBTkdVQUdFIik8PmQuSXRlbSgiWkNfQkxPR19MQU5HVUFHRSIpVGhlbiBDYWxsIFNldEJsb2dIaW50KEVtcHR5LEVtcHR5LFRydWUpDQoJRW5kIElmDQoJSWYgZC5FeGlzdHMoIlpDX0JMT0dfQ09QWVJJR0hUIik9VHJ1ZSBUaGVuDQoJCUlmIEJsb2dDb25maWcuUmVhZCgiWkNfQkxPR19DT1BZUklHSFQiKTw+ZC5JdGVtKCJaQ19CTE9HX0NPUFlSSUdIVCIpVGhlbg0KCQkJZC5JdGVtKCJaQ19CTE9HX0NPUFlSSUdIVCIpPVJlcGxhY2UoUmVwbGFjZShkLkl0ZW0oIlpDX0JMT0dfQ09QWVJJR0hUIiksdmJDciwiIiksdmJMZiwiIikNCgkJCUNhbGwgU2V0QmxvZ0hpbnQoRW1wdHksRW1wdHksVHJ1ZSkNCgkJRW5kIElmDQoJRW5kIElmDQoJSWYgZC5FeGlzdHMoIlpDX0JMT0dfTEFOR1VBR0VQQUNLIik9VHJ1ZSBUaGVuDQoJCUlmIEJsb2dDb25maWcuUmVhZCgiWkNfQkxPR19MQU5HVUFHRVBBQ0siKTw+ZC5JdGVtKCJaQ19CTE9HX0xBTkdVQUdFUEFDSyIpVGhlbiBDYWxsIFNldEJsb2dIaW50KEVtcHR5LEVtcHR5LFRydWUpDQoJRW5kIElmDQoJSWYgZC5FeGlzdHMoIlpDX1RJTUVfWk9ORSIpPVRydWUgVGhlbg0KCQlJZiBUcmltKGQuSXRlbSgiWkNfVElNRV9aT05FIikpPSIiIFRoZW4gZC5JdGVtKCJaQ19USU1FX1pPTkUiKT0iMDAwMCINCgkJSWYgSXNOdW1lcmljKGQuSXRlbSgiWkNfVElNRV9aT05FIikpPUZhbHNlIFRoZW4gZC5JdGVtKCJaQ19USU1FX1pPTkUiKT0iMDAwMCINCglFbmQgSWYNCglJZiBkLkV4aXN0cygiWkNfSE9TVF9USU1FX1pPTkUiKT1UcnVlIFRoZW4NCgkJSWYgVHJpbShkLkl0ZW0oIlpDX0hPU1RfVElNRV9aT05FIikpPSIiIFRoZW4gZC5JdGVtKCJaQ19IT1NUX1RJTUVfWk9ORSIpPSIwMDAwIg0KCQlJZiBJc051bWVyaWMoZC5JdGVtKCJaQ19IT1NUX1RJTUVfWk9ORSIpKT1GYWxzZSBUaGVuIGQuSXRlbSgiWkNfSE9TVF9USU1FX1pPTkUiKT0iMDAwMCINCglFbmQgSWYNCglJZiBkLkV4aXN0cygiWkNfQkxPR19MQU5HVUFHRSIpPVRydWUgVGhlbg0KCQlJZiBCbG9nQ29uZmlnLlJlYWQoIlpDX0JMT0dfTEFOR1VBR0UiKTw+ZC5JdGVtKCJaQ19CTE9HX0xBTkdVQUdFIilUaGVuIENhbGwgU2V0QmxvZ0hpbnQoRW1wdHksRW1wdHksVHJ1ZSkNCglFbmQgSWYNCglJZiBkLkV4aXN0cygiWkNfQ09NTUVOVF9UVVJOT0YiKT1UcnVlIFRoZW4NCgkJSWYgQmxvZ0NvbmZpZy5SZWFkKCJaQ19DT01NRU5UX1RVUk5PRkYiKTw+ZC5JdGVtKCJaQ19DT01NRU5UX1RVUk5PRkYiKVRoZW4gQ2FsbCBTZXRCbG9nSGludChFbXB0eSxFbXB0eSxUcnVlKQ0KCUVuZCBJZg0KCUlmIGQuRXhpc3RzKCJaQ19DT01NRU5UX1JFVkVSU0VfT1JERVJfRVhQT1JUIik9VHJ1ZSBUaGVuDQoJCUlmIEJsb2dDb25maWcuUmVhZCgiWkNfQ09NTUVOVF9SRVZFUlNFX09SREVSX0VYUE9SVCIpPD5kLkl0ZW0oIlpDX0NPTU1FTlRfUkVWRVJTRV9PUkRFUl9FWFBPUlQiKVRoZW4gQ2FsbCBTZXRCbG9nSGludChFbXB0eSxFbXB0eSxUcnVlKQ0KCUVuZCBJZg0KCUlmIGQuRXhpc3RzKCJaQ19DT01NRU5UU19ESVNQTEFZX0NPVU5UIik9VHJ1ZSBUaGVuDQoJCUlmIEJsb2dDb25maWcuUmVhZCgiWkNfQ09NTUVOVFNfRElTUExBWV9DT1VOVCIpPD5kLkl0ZW0oIlpDX0NPTU1FTlRTX0RJU1BMQVlfQ09VTlQiKVRoZW4gQ2FsbCBTZXRCbG9nSGludChFbXB0eSxFbXB0eSxUcnVlKQ0KCUVuZCBJZg0KCUlmIGQuRXhpc3RzKCJaQ19ESVNQTEFZX0NPVU5UIik9VHJ1ZSBUaGVuDQoJCUlmIEJsb2dDb25maWcuUmVhZCgiWkNfRElTUExBWV9DT1VOVCIpPD5kLkl0ZW0oIlpDX0RJU1BMQVlfQ09VTlQiKVRoZW4gQ2FsbCBTZXRCbG9nSGludChFbXB0eSxUcnVlLFRydWUpDQoJRW5kIElmDQoJSWYgZC5FeGlzdHMoIlpDX1BBR0VCQVJfQ09VTlQiKT1UcnVlIFRoZW4NCgkJSWYgQmxvZ0NvbmZpZy5SZWFkKCJaQ19QQUdFQkFSX0NPVU5UIik8PmQuSXRlbSgiWkNfUEFHRUJBUl9DT1VOVCIpVGhlbiBDYWxsIFNldEJsb2dIaW50KEVtcHR5LFRydWUsRW1wdHkpDQoJRW5kIElmDQoJSWYgZC5FeGlzdHMoIlpDX01VVFVBTElUWV9DT1VOVCIpPVRydWUgVGhlbg0KCQlJZiBCbG9nQ29uZmlnLlJlYWQoIlpDX01VVFVBTElUWV9DT1VOVCIpPD5kLkl0ZW0oIlpDX01VVFVBTElUWV9DT1VOVCIpVGhlbiBDYWxsIFNldEJsb2dIaW50KEVtcHR5LFRydWUsVHJ1ZSkNCglFbmQgSWYNCglJZiBkLkV4aXN0cygiWkNfVVNFX05BVklHQVRFX0FSVElDTEUiKT1UcnVlIFRoZW4NCgkJSWYgQmxvZ0NvbmZpZy5SZWFkKCJaQ19VU0VfTkFWSUdBVEVfQVJUSUNMRSIpPD5kLkl0ZW0oIlpDX1VTRV9OQVZJR0FURV9BUlRJQ0xFIilUaGVuIENhbGwgU2V0QmxvZ0hpbnQoRW1wdHksVHJ1ZSxUcnVlKQ0KCUVuZCBJZg0KCUlmIGQuRXhpc3RzKCJaQ19DT01NRU5UX1ZFUklGWV9FTkFCTEUiKT1UcnVlIFRoZW4NCgkJSWYgQmxvZ0NvbmZpZy5SZWFkKCJaQ19DT01NRU5UX1ZFUklGWV9FTkFCTEUiKTw+ZC5JdGVtKCJaQ19DT01NRU5UX1ZFUklGWV9FTkFCTEUiKVRoZW4gQ2FsbCBTZXRCbG9nSGludChFbXB0eSxUcnVlLFRydWUpDQoJRW5kIElmDQoNCglGb3IgRWFjaCBhIEluIGQuS2V5cw0KCQlJZiBTZWFyY2hJbkFycmF5cygiZWR0IiYgYSxTcGxpdChlLCJ8IikpPVRydWUgVGhlbg0KCQkJQ2FsbCBCbG9nQ29uZmlnLldyaXRlKGEsZC5JdGVtKGEpKQ0KCQlFbmQgSWYNCglOZXh0DQoNCglDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX0JMT0dfTkFNRSIsQmxvZ0NvbmZpZy5SZWFkKCJaQ19CTE9HX1RJVExFIikpDQoJQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19CTE9HX1NVQl9OQU1FIixCbG9nQ29uZmlnLlJlYWQoIlpDX0JMT0dfU1VCVElUTEUiKSkNCg0KCUNhbGwgU2F2ZUNvbmZpZzJPcHRpb24oKQ0KDQoJU2F2ZVNldHRpbmc9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBQb3N0IFRhZw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gUG9zdFRhZygpDQoNCglEaW0gb2JqVGFnDQoJU2V0IG9ialRhZz1OZXcgVFRhZw0KCW9ialRhZy5JRD1SZXF1ZXN0LkZvcm0oImVkdElEIikNCglvYmpUYWcuTmFtZT1SZXF1ZXN0LkZvcm0oImVkdE5hbWUiKQ0KCW9ialRhZy5PcmRlcj1SZXF1ZXN0LkZvcm0oImVkdE9yZGVyIikNCglvYmpUYWcuSW50cm89UmVxdWVzdC5Gb3JtKCJlZHRJbnRybyIpDQoJb2JqVGFnLkFsaWFzPVJlcXVlc3QuRm9ybSgiZWR0QWxpYXMiKQ0KCW9ialRhZy5UZW1wbGF0ZU5hbWU9UmVxdWVzdC5Gb3JtKCJlZHRUZW1wbGF0ZSIpDQoNCg0KCUlmIENMbmcob2JqVGFnLklEKT4wIFRoZW4gb2JqVGFnLk1ldGFTdHJpbmc9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgW3RhZ19NZXRhXSBGUk9NIFtibG9nX1RhZ10gV0hFUkUgW3RhZ19JRF09IiZDTG5nKG9ialRhZy5JRCkpKDApDQoNCgkn5o6l5Y+jDQoJQ2FsbCBGaWx0ZXJfUGx1Z2luX1Bvc3RUYWdfQ29yZShvYmpUYWcpDQoNCglJZiBvYmpUYWcuUG9zdCBUaGVuDQoJCUNhbGwgR2V0VGFnc2J5VGFnSURMaXN0KCJ7IiZvYmpUYWcuSUQmIn0iKQ0KCQlDYWxsIFNjYW5UYWdDb3VudCgieyImb2JqVGFnLklEJiJ9IikNCgkJUG9zdFRhZz1UcnVlDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9Qb3N0VGFnX1N1Y2NlZWQob2JqVGFnKQ0KCUVuZCBJZg0KCVNldCBvYmpUYWc9Tm90aGluZw0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgRGVsIFRhZw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gRGVsVGFnKGludElEKQ0KDQoJRGltIG9ialRhZw0KCVNldCBvYmpUYWc9TmV3IFRUYWcNCglvYmpUYWcuSUQ9aW50SUQNCg0KCUNhbGwgR2V0VGFnc2J5VGFnSURMaXN0KCJ7IiZvYmpUYWcuSUQmIn0iKQ0KDQoJSWYgb2JqVGFnLkRlbCBUaGVuIERlbFRhZz1UcnVlDQoJU2V0IG9ialRhZz1Ob3RoaW5nDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIFBvc3QgS2V5V29yZA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gUG9zdEtleVdvcmQoKQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgRGVsIFRhZw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gRGVsS2V5V29yZChpbnRJRCkNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBQb3N0U2l0ZUZpbGUodHBhdGgpDQoJSWYgSW5zdHIobGNhc2UodHBhdGgpLCJnbG9iYWwuYXNhIikgdGhlbiBwb3N0c2l0ZWZpbGU9ZmFsc2U6ZXhpdCBmdW5jdGlvbg0KCURpbSB0eGFDb250ZW50DQoJdHhhQ29udGVudD1SZXF1ZXN0LkZvcm0oInR4YUNvbnRlbnQiKQ0KDQoJSWYgSXNFbXB0eSh0eGFDb250ZW50KSBUaGVuIHR4YUNvbnRlbnQ9TnVsbA0KDQoJSWYgTm90IElzTnVsbCh0cGF0aCkgVGhlbg0KDQoJCUlmIE5vdCBJc051bGwodHhhQ29udGVudCkgVGhlbg0KDQoJCQlDYWxsIFNhdmVUb0ZpbGUoQmxvZ1BhdGggJiB0cGF0aCx0eGFDb250ZW50LCJ1dGYtOCIsRmFsc2UpDQoNCgkJCVBvc3RTaXRlRmlsZT1UcnVlDQoNCgkJRW5kIElGDQoNCglFbmQgSWYNCg0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIERlbFNpdGVGaWxlKHRwYXRoKQ0KDQoJSWYgTm90IElzT2JqZWN0KFB1YmxpY09iakZTTykgVGhlbiBTZXQgUHVibGljT2JqRlNPPVNlcnZlci5DcmVhdGVPYmplY3QoIlNjcmlwdGluZy5GaWxlU3lzdGVtT2JqZWN0IikNCgkNCglJZiBQdWJsaWNPYmpGU08uRmlsZUV4aXN0cyhCbG9nUGF0aCAmIHRwYXRoKSBUaGVuDQoJCVB1YmxpY09iakZTTy5EZWxldGVmaWxlKEJsb2dQYXRoICYgdHBhdGgpDQoJCURlbFNpdGVGaWxlPVRydWUNCglFbmQgSWYNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBHZXRSZWFsVXJsb2ZUcmFja0JhY2tVcmwoaW50SUQpDQoNCg0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICDlrqHmoLjor4TorroNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEF1ZGl0Q29tbWVudCgpDQoNCglPbiBFcnJvciBSZXN1bWUgTmV4dA0KCURpbSBpLGoNCglEaW0gcyx0DQoJRGltIGFyeUFydGljbGUoKQ0KCXM9UmVxdWVzdC5Gb3JtKCJlZHRCYXRjaCIpDQoJSWYgaXNFbXB0eShzKSBUaGVuIHM9UmVxdWVzdC5RdWVyeVN0cmluZygiaWQiKQ0KCUlmIHM9ImRlbGFsbCIgVGhlbg0KCQlvYmpDb25uLkV4ZWN1dGUgIkRFTEVURSBGUk9NIFtibG9nX0NvbW1lbnRdIFdIRVJFIFtjb21tX2lzQ2hlY2tdPD4wIg0KCQlBdWRpdENvbW1lbnQ9VHJ1ZQ0KCQlFeGl0IEZ1bmN0aW9uDQoJRW5kIElmDQoJdD1TcGxpdChzLCIsIikNCgkNCglSZURpbSBQcmVzZXJ2ZSBhcnlBcnRpY2xlKFVCb3VuZCh0KSkNCglGb3Igaj0wIFRvIFVCb3VuZCh0KS0xDQoJCWFyeUFydGljbGUoaik9MA0KCU5leHQNCg0KCURpbSBvYmpDb21tZW50DQoJRGltIG9iakFydGljbGUNCglEaW0gb2JqUnMNCg0KCUZvciBpPTAgVG8gVUJvdW5kKHQpJy0xDQoJCUlmIHQoaSk9IiIgVGhlbiBFeGl0IEZvcg0KCQlTZXQgb2JqQ29tbWVudD1OZXcgVENvbW1lbnQNCgkJSWYgb2JqQ29tbWVudC5Mb2FkSW5mb2J5SUQodChpKSkgVGhlbg0KCQkJSWYgb2JqQ29tbWVudC5sb2dfSUQ+MCBUaGVuDQoJCQkJRGltIG9ialRlc3RBcnRpY2xlDQoJCQkJU2V0IG9ialRlc3RBcnRpY2xlPU5ldyBUQXJ0aWNsZQ0KCQkJCUlmIG9ialRlc3RBcnRpY2xlLkxvYWRJbmZvYnlJRChvYmpDb21tZW50LmxvZ19JRCkgVGhlbg0KDQoJCQkJCUZvciBqPTAgVG8gVUJvdW5kKHQpDQoJCQkJCQlJZiBhcnlBcnRpY2xlKGopPTAgVGhlbg0KCQkJCQkJCWFyeUFydGljbGUoaik9b2JqQ29tbWVudC5sb2dfSUQNCgkJCQkJCUVuZCBJZg0KCQkJCQkJSWYgYXJ5QXJ0aWNsZShqKT1vYmpDb21tZW50LmxvZ19JRCBUaGVuIEV4aXQgRm9yDQoJCQkJCU5leHQNCg0KCQkJCQlJZiBOb3QoKG9iakNvbW1lbnQuQXV0aG9ySUQ9QmxvZ1VzZXIuSUQpIE9yIChvYmpUZXN0QXJ0aWNsZS5BdXRob3JJRD1CbG9nVXNlci5JRCkgT3IgKENoZWNrUmlnaHRzKCJSb290Iik9VHJ1ZSkpIFRoZW4gRXhpdCBGdW5jdGlvbg0KCQkJCUVsc2UNCgkJCQkJQ2FsbCBTaG93RXJyb3IoOSkNCgkJCQlFbmQgSWYNCgkJCQlTZXQgb2JqVGVzdEFydGljbGU9Tm90aGluZw0KDQoNCgkJCQlEaW0gYWxsY29tbSxpaQ0KCQkJCUlmIFNlYXJjaENoaWxkQ29tbWVudHModChpKSxhbGxjb21tKT1UcnVlIFRoZW4NCgkJCQkJRm9yIEVhY2ggaWkgSW4gYWxsY29tbS5LZXlzDQoJCQkJCQlEaW0gb2JqU3ViQ29tbWVudA0KCQkJCQkJU2V0IG9ialN1YkNvbW1lbnQ9TmV3IFRDb21tZW50DQoJCQkJCQlJZiBvYmpTdWJDb21tZW50LkxvYWRJbmZvYnlJRChpaSkgVGhlbg0KCQkJCQkJCW9ialN1YkNvbW1lbnQuaXNDaGVjaz1JSWYob2JqU3ViQ29tbWVudC5pc0NoZWNrLEZhbHNlLFRydWUpDQoJCQkJCQkJQ2FsbCBGaWx0ZXJfUGx1Z2luX0NvbW1lbnRBZHVpdF9Db3JlKG9ialN1YkNvbW1lbnQsVHJ1ZSkNCgkJCQkJCQlvYmpTdWJDb21tZW50LlBvc3QNCgkJCQkJCUVuZCBJZg0KCQkJCQlOZXh0DQoJCQkJRW5kIElmDQoNCgkJCUVsc2UNCg0KCQkJRW5kIElmDQoNCgkJCURlbENoaWxkIG9iakNvbW1lbnQuSUQNCgkJCW9iakNvbW1lbnQuaXNDaGVjaz1JSWYob2JqQ29tbWVudC5pc0NoZWNrLEZhbHNlLFRydWUpDQoJCQlDYWxsIEZpbHRlcl9QbHVnaW5fQ29tbWVudEFkdWl0X0NvcmUob2JqQ29tbWVudCxGYWxzZSkNCgkJCW9iakNvbW1lbnQuUG9zdA0KDQoJCUVuZCBJZg0KCQlTZXQgb2JqQ29tbWVudD1Ob3RoaW5nDQoJTmV4dA0KDQoNCglGb3Igaj0wIFRvIFVCb3VuZCh0KQ0KCQlJZiBhcnlBcnRpY2xlKGopPjAgVGhlbg0KCQkJQ2FsbCBCdWlsZEFydGljbGUoYXJ5QXJ0aWNsZShqKSxGYWxzZSxGYWxzZSkNCgkJRW5kIElmDQoJTmV4dA0KDQoJQ2FsbCBCbG9nUmVCdWlsZF9Db21tZW50cw0KCUNhbGwgQmxvZ1JlQnVpbGRfRGVmYXVsdA0KDQoJQXVkaXRDb21tZW50PVRydWUNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIERlbENvbW1lbnRCYXRjaCgpDQoJT24gRXJyb3IgUmVzdW1lIE5leHQNCglEaW0gaSxqDQoJRGltIHMsdA0KCURpbSBhcnlBcnRpY2xlKCkNCglzPVJlcXVlc3QuRm9ybSgiZWR0QmF0Y2giKQ0KCXQ9U3BsaXQocywiLCIpDQoNCglSZURpbSBQcmVzZXJ2ZSBhcnlBcnRpY2xlKFVCb3VuZCh0KSkNCglGb3Igaj0wIFRvIFVCb3VuZCh0KS0xDQoJCWFyeUFydGljbGUoaik9MA0KCU5leHQNCg0KCURpbSBvYmpDb21tZW50DQoJRGltIG9iakFydGljbGUNCglEaW0gb2JqUnMNCg0KCUZvciBpPTAgVG8gVUJvdW5kKHQpLTENCgkJU2V0IG9iakNvbW1lbnQ9TmV3IFRDb21tZW50DQoJCUlmIG9iakNvbW1lbnQuTG9hZEluZm9ieUlEKHQoaSkpIFRoZW4NCgkJCUlmIG9iakNvbW1lbnQubG9nX0lEPjAgVGhlbg0KCQkJCURpbSBvYmpUZXN0QXJ0aWNsZQ0KCQkJCVNldCBvYmpUZXN0QXJ0aWNsZT1OZXcgVEFydGljbGUNCgkJCQlJZiBvYmpUZXN0QXJ0aWNsZS5Mb2FkSW5mb2J5SUQob2JqQ29tbWVudC5sb2dfSUQpIFRoZW4NCg0KCQkJCQlGb3Igaj0wIFRvIFVCb3VuZCh0KS0xDQoJCQkJCQlJZiBhcnlBcnRpY2xlKGopPTAgVGhlbg0KCQkJCQkJCWFyeUFydGljbGUoaik9b2JqQ29tbWVudC5sb2dfSUQNCgkJCQkJCUVuZCBJZg0KCQkJCQkJSWYgYXJ5QXJ0aWNsZShqKT1vYmpDb21tZW50LmxvZ19JRCBUaGVuIEV4aXQgRm9yDQoJCQkJCU5leHQNCg0KCQkJCQlJZiBOb3QoKG9iakNvbW1lbnQuQXV0aG9ySUQ9QmxvZ1VzZXIuSUQpIE9yIChvYmpUZXN0QXJ0aWNsZS5BdXRob3JJRD1CbG9nVXNlci5JRCkgT3IgKENoZWNrUmlnaHRzKCJSb290Iik9VHJ1ZSkpIFRoZW4gRXhpdCBGdW5jdGlvbg0KCQkJCUVsc2UNCgkJCQkJQ2FsbCBTaG93RXJyb3IoOSkNCgkJCQlFbmQgSWYNCgkJCQlTZXQgb2JqVGVzdEFydGljbGU9Tm90aGluZw0KDQoNCgkJCQlEaW0gYWxsY29tbSxpaQ0KCQkJCUlmIFNlYXJjaENoaWxkQ29tbWVudHModChpKSxhbGxjb21tKT1UcnVlIFRoZW4NCgkJCQkJRm9yIEVhY2ggaWkgSW4gYWxsY29tbS5LZXlzDQoJCQkJCQlEaW0gb2JqU3ViQ29tbWVudA0KCQkJCQkJU2V0IG9ialN1YkNvbW1lbnQ9TmV3IFRDb21tZW50DQoJCQkJCQlJZiBvYmpTdWJDb21tZW50LkxvYWRJbmZvYnlJRChpaSkgVGhlbg0KCQkJCQkJCW9ialN1YkNvbW1lbnQuRGVsDQoJCQkJCQlFbmQgSWYNCgkJCQkJTmV4dA0KCQkJCUVuZCBJZg0KDQoJCQlFbHNlDQoNCgkJCUVuZCBJZg0KDQoJCQlEZWxDaGlsZCBvYmpDb21tZW50LklEDQoJCQlvYmpDb21tZW50LkRlbA0KDQoJCUVuZCBJZg0KCQlTZXQgb2JqQ29tbWVudD1Ob3RoaW5nDQoJTmV4dA0KDQoNCglGb3Igaj0wIFRvIFVCb3VuZCh0KS0xDQoJCUlmIGFyeUFydGljbGUoaik+MCBUaGVuDQoJCQlDYWxsIEJ1aWxkQXJ0aWNsZShhcnlBcnRpY2xlKGopLEZhbHNlLEZhbHNlKQ0KCQlFbmQgSWYNCglOZXh0DQoNCglDYWxsIEJsb2dSZUJ1aWxkX0NvbW1lbnRzDQoJQ2FsbCBCbG9nUmVCdWlsZF9EZWZhdWx0DQoNCglEZWxDb21tZW50QmF0Y2g9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBEZWxDaGlsZChJRCkNCglEaW0gb2JqUnMsdG1wUGFyZW50SUQsdG1wSUQNCglTZXQgb2JqUnM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgY29tbV9QYXJlbnRJRCxjb21tX0lEIEZST00gW2Jsb2dfQ29tbWVudF0gV0hFUkUgY29tbV9QYXJlbnRJRD0iJklEKQ0KCURvIFVudGlsIG9ialJTLmJvZiBPciBvYmpSUy5lb2YNCgkJdG1wUGFyZW50SUQ9Y2xuZyhvYmpScygiY29tbV9QYXJlbnRJRCIpKQ0KCQl0bXBJRD1jbG5nKG9ialJzKCJjb21tX0lEIikpDQoNCgkJSWYgdG1wUGFyZW50SUQ+MCBUaGVuDQoJCQlEZWxDaGlsZCh0bXBJRCkNCgkJRW5kIElmDQoJCW9iakNvbm4uRXhlY3V0ZSAiREVMRVRFIEZST00gW2Jsb2dfQ29tbWVudF0gV0hFUkUgY29tbV9JRD0iJnRtcElEDQoJCW9ialJTLk1vdmVOZXh0DQoJTG9vcA0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBEZWxUcmFja0JhY2tCYXRjaCgpDQoNCglEaW0gaSxqDQoJRGltIHMsdA0KCURpbSBhcnlBcnRpY2xlKCkNCglzPVJlcXVlc3QuRm9ybSgiZWR0QmF0Y2giKQ0KCXQ9U3BsaXQocywiLCIpDQoNCglSZURpbSBQcmVzZXJ2ZSBhcnlBcnRpY2xlKFVCb3VuZCh0KSkNCglGb3Igaj0wIFRvIFVCb3VuZCh0KS0xDQoJCWFyeUFydGljbGUoaik9MA0KCU5leHQNCg0KCURpbSBvYmpUcmFja0JhY2sNCglEaW0gb2JqQXJ0aWNsZQ0KDQoJU2V0IG9iakFydGljbGU9TmV3IFRBcnRpY2xlDQoNCg0KCUZvciBpPTAgVG8gVUJvdW5kKHQpLTENCgkJU2V0IG9ialRyYWNrQmFjaz1OZXcgVFRyYWNrQmFjaw0KCQlJZiBvYmpUcmFja0JhY2suTG9hZEluZm9ieUlEKHQoaSkpIFRoZW4NCgkJCURpbSBvYmpUZXN0QXJ0aWNsZQ0KCQkJU2V0IG9ialRlc3RBcnRpY2xlPU5ldyBUQXJ0aWNsZQ0KCQkJSWYgb2JqVGVzdEFydGljbGUuTG9hZEluZm9ieUlEKG9ialRyYWNrQmFjay5sb2dfSUQpIFRoZW4NCg0KCQkJCUZvciBqPTAgVG8gVUJvdW5kKHQpLTENCgkJCQkJSWYgYXJ5QXJ0aWNsZShqKT0wIFRoZW4NCgkJCQkJCWFyeUFydGljbGUoaik9b2JqVHJhY2tCYWNrLmxvZ19JRA0KCQkJCQlFbmQgSWYNCgkJCQkJSWYgYXJ5QXJ0aWNsZShqKT1vYmpUcmFja0JhY2subG9nX0lEIFRoZW4gRXhpdCBGb3INCgkJCQlOZXh0DQoNCgkJCQlJZiBOb3QoKG9ialRlc3RBcnRpY2xlLkF1dGhvcklEPUJsb2dVc2VyLklEKSBPciAoQ2hlY2tSaWdodHMoIlJvb3QiKT1UcnVlKSkgVGhlbiBFeGl0IEZ1bmN0aW9uDQoJCQlFbHNlDQoJCQkJQ2FsbCBTaG93RXJyb3IoOSkNCgkJCUVuZCBJZg0KCQkJU2V0IG9ialRlc3RBcnRpY2xlPU5vdGhpbmcNCgkJCW9ialRyYWNrQmFjay5EZWwNCgkJRW5kIElmDQoJCVNldCBvYmpUcmFja0JhY2s9Tm90aGluZw0KCU5leHQNCg0KDQoJRm9yIGo9MCBUbyBVQm91bmQodCktMQ0KCQlJZiBhcnlBcnRpY2xlKGopPjAgVGhlbg0KCQkJQ2FsbCBCdWlsZEFydGljbGUoYXJ5QXJ0aWNsZShqKSxGYWxzZSxGYWxzZSkNCgkJRW5kIElmDQoJTmV4dA0KDQoJQmxvZ1JlQnVpbGRfVHJhY2tCYWNrcw0KCURlbFRyYWNrQmFja0JhdGNoPVRydWUNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgICDmlofku7bliKDpmaQNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIERlbEZpbGVCYXRjaCgpDQoNCglEaW0gaSxqDQoJRGltIHMsdA0KDQoJcz1SZXF1ZXN0LkZvcm0oImVkdEJhdGNoIikNCgl0PVNwbGl0KHMsIiwiKQ0KDQoJRGltIG9ialVwTG9hZEZpbGUNCg0KCUZvciBpPTAgVG8gVUJvdW5kKHQpLTENCgkJdChpKT1DTG5nKHQoaSkpDQoJCUlmIHQoaSk+MCBUaGVuDQoJCQlTZXQgb2JqVXBMb2FkRmlsZT1OZXcgVFVwTG9hZEZpbGUNCgkJCUlmIG9ialVwTG9hZEZpbGUuTG9hZEluZm9CeUlEKHQoaSkpIFRoZW4NCgkJCQlJZiAob2JqVXBMb2FkRmlsZS5BdXRob3JJRD1CbG9nVXNlci5JRCkgT3IgKENoZWNrUmlnaHRzKCJSb290Iik9VHJ1ZSkgVGhlbg0KCQkJCQlvYmpVcExvYWRGaWxlLkRlbA0KCQkJCUVuZCBJZg0KCQkJRWxzZQ0KCQkJCUV4aXQgRnVuY3Rpb24NCgkJCUVuZCBJZg0KCQkJU2V0IG9ialVwTG9hZEZpbGU9Tm90aGluZw0KCQlFbmQgSWYNCglOZXh0DQoNCglEZWxGaWxlQmF0Y2g9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgU2F2ZSBUaGVtZSBTZXR0aW5nDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBTYXZlVGhlbWUoKQ0KDQoJRGltIGksag0KCURpbSBzLHQNCg0KCURpbSBzdHJaQ19CTE9HX0NTUw0KCURpbSBzdHJaQ19CTE9HX1RIRU1FDQoNCglzdHJaQ19CTE9HX0NTUz1SZXF1ZXN0LkZvcm0oImVkdFpDX0JMT0dfQ1NTIikNCglzdHJaQ19CTE9HX1RIRU1FPVJlcXVlc3QuRm9ybSgiZWR0WkNfQkxPR19USEVNRSIpDQoNCg0KDQoJQ2FsbCBDaGVja1htbFZlcnNpb24oQmxvZ1BhdGggJiAiemJfdXNlcnNcVEhFTUVcIiZzdHJaQ19CTE9HX1RIRU1FJiJcdGhlbWUueG1sIikNCgkNCglJZiBDaGVja0RlcGVuZGVuY3koWkNfVVNJTkdfUExVR0lOX0xJU1Qsc3RyWkNfQkxPR19USEVNRSwidGhlbWUiKT1GYWxzZSBUaGVuIEV4aXQgRnVuY3Rpb24NCg0KCUNhbGwgU2NhblBsdWdpblRvVGhlbWVGaWxlKHN0clpDX0JMT0dfQ1NTLHN0clpDX0JMT0dfVEhFTUUpDQoNCglJZiBVQ2FzZShzdHJaQ19CTE9HX0NTUyk8PlVDYXNlKENTdHIoWkNfQkxPR19DU1MpKSBUaGVuIENhbGwgU2V0QmxvZ0hpbnQoRW1wdHksVHJ1ZSxFbXB0eSkNCglJZiBVQ2FzZShzdHJaQ19CTE9HX1RIRU1FKTw+VUNhc2UoQ1N0cihaQ19CTE9HX1RIRU1FKSkgVGhlbg0KCQlDYWxsIFNldEJsb2dIaW50KEVtcHR5LFRydWUsVHJ1ZSkNCgkJQ2FsbCBVbmluc3RhbGxQbHVnaW4oWkNfQkxPR19USEVNRSkNCgkJQ2FsbCBTY2FuRnVuY3Rpb25BbmRTaWRlYmFyVG9UaGVtZUZpbGUoc3RyWkNfQkxPR19USEVNRSkNCg0KCQlDYWxsIEdldEZ1bmN0aW9uKCkNCgkJRGltIGZ1bg0KCQlGb3IgRWFjaCBmdW4gSW4gRnVuY3Rpb25zDQoJCQlJZiBJc09iamVjdChmdW4pPVRydWUgVGhlbg0KCQkJCUlmIGZ1bi5Tb3VyY2U9InRoZW1lXyImWkNfQkxPR19USEVNRSBUaGVuDQoJCQkJCWZ1bi5EZWwNCgkJCQlFbmQgSWYNCgkJCUVuZCBJZg0KCQlOZXh0DQoJDQoJRW5kIElmDQoNCglDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX0JMT0dfQ1NTIixzdHJaQ19CTE9HX0NTUykNCg0KCUNhbGwgQmxvZ0NvbmZpZy5Xcml0ZSgiWkNfQkxPR19USEVNRSIsc3RyWkNfQkxPR19USEVNRSkNCgkNCg0KCUNhbGwgU2F2ZUNvbmZpZzJPcHRpb24oKQ0KDQoJQ2FsbCBDbGVhckdsb2JlQ2FjaGUNCg0KCVNhdmVUaGVtZT1UcnVlDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8mg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gU2NhbkZ1bmN0aW9uQW5kU2lkZWJhclRvVGhlbWVGaWxlKG5ld1pDX0JMT0dfVEhFTUUpDQoJT24gRXJyb3IgUmVzdW1lIE5leHQNCg0KCURpbSBvYmpYbWxGaWxlLHN0clhtbEZpbGUscyx0DQoNCglEaW0gb2xkU0IxLG9sZFNCMixvbGRTQjMsb2xkU0I0LG9sZFNCNQ0KDQoJc3RyWG1sRmlsZSA9QmxvZ1BhdGggJiAiemJfdXNlcnMvdGhlbWUvIiAmIG5ld1pDX0JMT0dfVEhFTUUgJiAiLyIgJiAidGhlbWUueG1sIg0KDQoJU2V0IG9ialhtbEZpbGU9U2VydmVyLkNyZWF0ZU9iamVjdCgiTWljcm9zb2Z0LlhNTERPTSIpDQoJb2JqWG1sRmlsZS5hc3luYyA9IEZhbHNlDQoJb2JqWG1sRmlsZS5WYWxpZGF0ZU9uUGFyc2U9RmFsc2UNCglvYmpYbWxGaWxlLmxvYWQoc3RyWG1sRmlsZSkNCglJZiBvYmpYbWxGaWxlLnJlYWR5U3RhdGU9NCBUaGVuDQoJCUlmIG9ialhtbEZpbGUucGFyc2VFcnJvci5lcnJvckNvZGUgPD4gMCBUaGVuDQoJCUVsc2UNCgkJCUlmIG9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdE5vZGVzKCJzaWRlYmFycy9zaWRlYmFyMSIpLmxlbmd0aD4wIFRoZW4NCgkJCQlvbGRTQjE9WkNfU0lERUJBUl9PUkRFUg0KCQkJCUlmIG9sZFNCMT0iIiBUaGVuIG9sZFNCMT0iICINCgkJCQlDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX1NJREVCQVJfT1JERVJfT0xEIixvbGRTQjEpDQoJCQkJQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19TSURFQkFSX09SREVSIixvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJzaWRlYmFycy9zaWRlYmFyMSIpLnRleHQpIA0KCQkJRWxzZQ0KCQkJCW9sZFNCMT1CbG9nQ29uZmlnLlJlYWQoIlpDX1NJREVCQVJfT1JERVJfT0xEIikNCgkJCQlJZiBvbGRTQjE8PiIiIFRoZW4NCgkJCQkJSWYgb2xkU0IxPSIgIiBUaGVuIG9sZFNCMT0iIg0KCQkJCQlDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX1NJREVCQVJfT1JERVIiLG9sZFNCMSkNCgkJCQkJQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19TSURFQkFSX09SREVSX09MRCIsIiIpDQoJCQkJRW5kIElmDQoJCQlFbmQgSWYNCgkJCUlmIG9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdE5vZGVzKCJzaWRlYmFycy9zaWRlYmFyMiIpLmxlbmd0aD4wIFRoZW4NCgkJCQlvbGRTQjI9WkNfU0lERUJBUl9PUkRFUjINCgkJCQlJZiBvbGRTQjI9IiIgVGhlbiBvbGRTQjI9IiAiDQoJCQkJQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19TSURFQkFSX09SREVSMl9PTEQiLG9sZFNCMikNCgkJCQlDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX1NJREVCQVJfT1JERVIyIixvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJzaWRlYmFycy9zaWRlYmFyMiIpLnRleHQpDQoJCQlFbHNlDQoJCQkJb2xkU0IyPUJsb2dDb25maWcuUmVhZCgiWkNfU0lERUJBUl9PUkRFUjJfT0xEIikNCgkJCQlJZiBvbGRTQjI8PiIiIFRoZW4NCgkJCQkJSWYgb2xkU0IyPSIgIiBUaGVuIG9sZFNCMj0iIg0KCQkJCQlDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX1NJREVCQVJfT1JERVIyIixvbGRTQjIpDQoJCQkJCUNhbGwgQmxvZ0NvbmZpZy5Xcml0ZSgiWkNfU0lERUJBUl9PUkRFUjJfT0xEIiwiIikNCgkJCQlFbmQgSWYNCgkJCUVuZCBJZg0KCQkJSWYgb2JqWG1sRmlsZS5kb2N1bWVudEVsZW1lbnQuc2VsZWN0Tm9kZXMoInNpZGViYXJzL3NpZGViYXIzIikubGVuZ3RoPjAgVGhlbg0KCQkJCW9sZFNCMz1aQ19TSURFQkFSX09SREVSMw0KCQkJCUlmIG9sZFNCMz0iIiBUaGVuIG9sZFNCMz0iICINCgkJCQlDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX1NJREVCQVJfT1JERVIzX09MRCIsb2xkU0IzKQ0KCQkJCUNhbGwgQmxvZ0NvbmZpZy5Xcml0ZSgiWkNfU0lERUJBUl9PUkRFUjMiLG9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoInNpZGViYXJzL3NpZGViYXIzIikudGV4dCkNCgkJCUVsc2UNCgkJCQlvbGRTQjM9QmxvZ0NvbmZpZy5SZWFkKCJaQ19TSURFQkFSX09SREVSM19PTEQiKQ0KCQkJCUlmIG9sZFNCMzw+IiIgVGhlbg0KCQkJCQlJZiBvbGRTQjM9IiAiIFRoZW4gb2xkU0IzPSIiDQoJCQkJCUNhbGwgQmxvZ0NvbmZpZy5Xcml0ZSgiWkNfU0lERUJBUl9PUkRFUjMiLG9sZFNCMykNCgkJCQkJQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19TSURFQkFSX09SREVSM19PTEQiLCIiKQ0KCQkJCUVuZCBJZg0KCQkJRW5kIElmDQoJCQlJZiBvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3ROb2Rlcygic2lkZWJhcnMvc2lkZWJhcjQiKS5sZW5ndGg+MCBUaGVuDQoJCQkJb2xkU0I0PVpDX1NJREVCQVJfT1JERVI0DQoJCQkJSWYgb2xkU0I0PSIiIFRoZW4gb2xkU0I0PSIgIg0KCQkJCUNhbGwgQmxvZ0NvbmZpZy5Xcml0ZSgiWkNfU0lERUJBUl9PUkRFUjRfT0xEIixvbGRTQjQpDQoJCQkJQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19TSURFQkFSX09SREVSNCIsb2JqWG1sRmlsZS5kb2N1bWVudEVsZW1lbnQuc2VsZWN0U2luZ2xlTm9kZSgic2lkZWJhcnMvc2lkZWJhcjQiKS50ZXh0KQ0KCQkJRWxzZQ0KCQkJCW9sZFNCND1CbG9nQ29uZmlnLlJlYWQoIlpDX1NJREVCQVJfT1JERVI0X09MRCIpDQoJCQkJSWYgb2xkU0I0PD4iIiBUaGVuDQoJCQkJCUlmIG9sZFNCND0iICIgVGhlbiBvbGRTQjQ9IiINCgkJCQkJQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19TSURFQkFSX09SREVSNCIsb2xkU0I0KQ0KCQkJCQlDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX1NJREVCQVJfT1JERVI0X09MRCIsIiIpDQoJCQkJRW5kIElmDQoJCQlFbmQgSWYNCgkJCUlmIG9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdE5vZGVzKCJzaWRlYmFycy9zaWRlYmFyNSIpLmxlbmd0aD4wIFRoZW4NCgkJCQlvbGRTQjU9WkNfU0lERUJBUl9PUkRFUjUNCgkJCQlJZiBvbGRTQjU9IiIgVGhlbiBvbGRTQjU9IiAiDQoJCQkJQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19TSURFQkFSX09SREVSNV9PTEQiLG9sZFNCNSkNCgkJCQlDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX1NJREVCQVJfT1JERVI1IixvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJzaWRlYmFycy9zaWRlYmFyNSIpLnRleHQpDQoJCQlFbHNlDQoJCQkJb2xkU0I1PUJsb2dDb25maWcuUmVhZCgiWkNfU0lERUJBUl9PUkRFUjVfT0xEIikNCgkJCQlJZiBvbGRTQjU8PiIiIFRoZW4NCgkJCQkJSWYgb2xkU0I1PSIgIiBUaGVuIG9sZFNCNT0iIg0KCQkJCQlDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX1NJREVCQVJfT1JERVI1IixvbGRTQjUpDQoJCQkJCUNhbGwgQmxvZ0NvbmZpZy5Xcml0ZSgiWkNfU0lERUJBUl9PUkRFUjVfT0xEIiwiIikNCgkJCQlFbmQgSWYNCgkJCUVuZCBJZg0KDQoJCQlEaW0gb2JqWG1saXRlbXMsaXRlbQ0KCQkJU2V0IG9ialhtbGl0ZW1zPW9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LlNlbGVjdE5vZGVzKCJmdW5jdGlvbnMvZnVuY3Rpb24iKQ0KCQkJZm9yIGVhY2ggaXRlbSBpbiBvYmpYbWxpdGVtcw0KDQoJCQkJQ2FsbCBBZGRUaGVtZUZ1bmN0aW9uKG5ld1pDX0JMT0dfVEhFTUUsaXRlbS5nZXRBdHRyaWJ1dGUoIm5hbWUiKSxpdGVtLmdldEF0dHJpYnV0ZSgiZmlsZW5hbWUiKSxpdGVtLmdldEF0dHJpYnV0ZSgiaHRtbGlkIiksaXRlbS5nZXRBdHRyaWJ1dGUoImZ0eXBlIiksaXRlbS5nZXRBdHRyaWJ1dGUoIm1heGxpIiksaXRlbS5nZXRBdHRyaWJ1dGUoImhpZGV0aXRsZSIpLGl0ZW0udGV4dCkNCg0KCQkJTmV4dA0KDQoJCUVuZCBJZg0KCUVuZCBJZg0KCQ0KCSfliqDlhaVXQVANCglDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX0RJU1BMQVlfQ09VTlRfV0FQIixJSWYoVHJ5VG9HZXRBZHZhbmNlZChvYmpYbWxGaWxlLCJ3YXAiKT0iVHJ1ZSIsMSwwKSkNCgkNCglTZXQgb2JqWG1sRmlsZT1Ob3RoaW5nDQoNCglFcnIuQ2xlYXINCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBTYXZlIExpbmtzDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBTYXZlTGluaygpDQoNCglTYXZlTGluaz1UcnVlDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBBY3RpdmVQbHVnSW4gQnkgTmFtZQ0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gQWN0aXZlUGx1Z0luQnlOYW1lKHN0clBsdWdpbk5hbWUpDQoNCglDYWxsIENoZWNrWG1sVmVyc2lvbihCbG9nUGF0aCAmICJ6Yl91c2Vyc1xQTFVHSU5cIiZzdHJQbHVnaW5OYW1lJiJccGx1Z2luLnhtbCIpDQoNCglEaW0gcyxpLHQsYixhLGFyeUFsbFhtbCxzdHJDb250ZW50DQoJYj1GYWxzZQ0KCXM9IFpDX1VTSU5HX1BMVUdJTl9MSVNUDQoNCglJZiBzPSIiIFRoZW4NCgkJcz1zdHJQbHVnaW5OYW1lDQoJRWxzZQ0KCQl0PVNwbGl0KFpDX1VTSU5HX1BMVUdJTl9MSVNULCJ8IikNCgkJRm9yIGk9TEJvdW5kKHQpIFRvIFVCb3VuZCh0KQ0KCQkJSWYgVUNhc2UodChpKSk9VUNhc2Uoc3RyUGx1Z2luTmFtZSkgVGhlbg0KCQkJCWI9VHJ1ZQ0KCQkJRW5kIElmDQoJCU5leHQNCgkJSWYgYjw+VHJ1ZSBUaGVuDQoJCQlzPXMgJiAifCIgJiBzdHJQbHVnaW5OYW1lDQoJCUVuZCBJZg0KCUVuZCBJZg0KCQ0KCWFyeUFsbFhtbD1HZXRBbGxYbWxQYXRoKHMpDQoJDQoJSWYgYj1GYWxzZSBUaGVuDQoJCSfotbDotbfvvIEJDQoJCSfnrKwx5q2l77ya5Yik5pat5L6d6LWWCQ0KDQoJCUlmIENoZWNrRGVwZW5kZW5jeShaQ19VU0lOR19QTFVHSU5fTElTVCxzdHJQbHVnaW5OYW1lLCJwbHVnaW4iKT1GYWxzZSBUaGVuIEV4aXQgRnVuY3Rpb24NCgkJJ+esrDLmraXvvJrlvpfliLDmiYDmnInmj5Lku7ZYTUzmlofku7bnu53lr7nlnLDlnYANCgkJDQoJCSfnrKwz5q2l77ya6K+75Y+W5omA5pyJWE1M5paH5Lu2DQoJCXN0ckNvbnRlbnQ9Q2hlY2tDb25mbGljdFJlV3JpdGVBbmRUb0ZpbGUoc3RyUGx1Z2luTmFtZSxhcnlBbGxYbWwsVHJ1ZSkNCgkJSWYgc3RyQ29udGVudCgwKT1GYWxzZSBUaGVuIEV4aXQgRnVuY3Rpb24NCgkJJ+esrDTmraXvvJrliKTmlq3lhrLnqoENCgkJJ+esrDXmraXvvJrliKTmlq3ph43lhpkNCglFbHNlDQoJCXN0ckNvbnRlbnQ9Q2hlY2tDb25mbGljdFJlV3JpdGVBbmRUb0ZpbGUoc3RyUGx1Z2luTmFtZSxhcnlBbGxYbWwsRmFsc2UpDQoJRW5kIElmDQoNCglEaW0gc3RyWkNfVVNJTkdfUExVR0lOX0xJU1QNCgkNCglzdHJaQ19VU0lOR19QTFVHSU5fTElTVD1zDQoNCglDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX1VTSU5HX1BMVUdJTl9MSVNUIixzdHJaQ19VU0lOR19QTFVHSU5fTElTVCkNCg0KCUNhbGwgU2F2ZUNvbmZpZzJPcHRpb24oKQ0KDQoJQ2FsbCBTY2FuUGx1Z2luVG9JbmNsdWRlRmlsZShzdHJDb250ZW50KDIpKQ0KDQoJYT1Mb2FkRnJvbUZpbGUoQmxvZ1BhdGggJiAiemJfdXNlcnNcUExVR0lOXCImIHN0clBsdWdpbk5hbWUgJiJcaW5jbHVkZS5hc3AiLCJ1dGYtOCIpDQoNCglJZiBJblN0cihMQ2FzZShhKSxMQ2FzZSgiSW5zdGFsbFBsdWdpbl8iKSk+MCBUaGVuDQoJCUNhbGwgQWRkQmF0Y2goWkNfTVNHMjAyICYgc3RyUGx1Z2luTmFtZSwiQ2FsbCBJbnN0YWxsUGx1Z2luKCIiIiZzdHJQbHVnaW5OYW1lJiIiIikiKQ0KCUVuZCBJZg0KDQoJQWN0aXZlUGx1Z0luQnlOYW1lPVRydWUNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAg5qOA5p+lWE1M54mI5pysDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBDaGVja1htbFZlcnNpb24oeG1scGF0aCkNCglEaW0gc3RyWG1sRmlsZSxvYmpYbWxGaWxlDQoJU2V0IG9ialhtbEZpbGU9U2VydmVyLkNyZWF0ZU9iamVjdCgiTWljcm9zb2Z0LlhNTERPTSIpDQoJb2JqWG1sRmlsZS5hc3luYyA9IEZhbHNlDQoJb2JqWG1sRmlsZS5WYWxpZGF0ZU9uUGFyc2U9RmFsc2UNCglvYmpYbWxGaWxlLmxvYWQoeG1scGF0aCkNCglJZiBvYmpYbWxGaWxlLnJlYWR5U3RhdGU9NCBUaGVuDQoJCUlmIG9ialhtbEZpbGUucGFyc2VFcnJvci5lcnJvckNvZGUgPD4gMCBUaGVuDQoJCUVsc2UNCgkJCUlmIG9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgidmVyc2lvbiIpPD4iMi4wIiBUaGVuDQoJCQkJQ2FsbCBTZXRCbG9nSGludF9DdXN0b20oWlZBX0Vycm9yTXNnKDY0KSkNCgkJCQlSZXNwb25zZS5SZWRpcmVjdCBSZXF1ZXN0LlNlcnZlclZhcmlhYmxlcygiSHR0cF9SZWZlcmVyIikNCgkJCUVuZCBJZg0KCQlFbmQgSWYNCglFbmQgSWYNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAg6aqM6K+B5L6d6LWWDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBDaGVja0RlcGVuZGVuY3koc3RyUGx1Z2luTGlzdCxzdHJOYW1lLHN0ckZvbGRlcikNCglDaGVja0RlcGVuZGVuY3k9VHJ1ZQ0KCURpbSBzdHJUZW1wLHNwdFRlbXAsc3RyRmlsZVBhdGgNCglJZiBzdHJGb2xkZXI9InRoZW1lIiBUaGVuDQoJCXN0ckZpbGVQYXRoPUJsb2dQYXRoICYgInpiX3VzZXJzXHRoZW1lXCIgJiBzdHJOYW1lICYgIlx0aGVtZS54bWwiDQoJRWxzZQ0KCQlzdHJGaWxlUGF0aD1CbG9nUGF0aCAmICJ6Yl91c2Vyc1xwbHVnaW5cIiAmIHN0ck5hbWUgJiAiXHBsdWdpbi54bWwiDQoJRW5kIElmDQoNCglzdHJUZW1wPVVDYXNlKCJ8IiZzdHJQbHVnaW5MaXN0JiJ8IikgJ+W+l+WIsOWFqOmDqOWQr+eUqOeahOaPkuS7tuWIl+ihqOS7peS+v0luU3RyDQoJRGltIG9ialhtbA0KCVNldCBvYmpYbWw9Q3JlYXRlT2JqZWN0KCJNaWNyb3NvZnQuWE1MRE9NIikJDQoJb2JqWG1sLmFzeW5jID0gRmFsc2UNCglvYmpYbWwuVmFsaWRhdGVPblBhcnNlPUZhbHNlDQoJb2JqWG1sLkxvYWQoc3RyRmlsZVBhdGgpDQoJc3B0VGVtcD1TcGxpdChVQ2FzZShUcnlUb0dldEFkdmFuY2VkKG9ialhtbCwiZGVwZW5kZW5jeSIpKSwifCIpDQoJRGltIGkNCglEaW0gTm90SW5zdGFsbGVkUGx1Z2luLGJvbE5vdEluc3RhbGwNCglGb3IgaT0wIFRvIFVib3VuZChzcHRUZW1wKQ0KCQlJZiBJblN0cihzdHJUZW1wLCJ8IiZzcHRUZW1wKGkpJiJ8Iik8PTAgVGhlbg0KCQkJSWYgSW5TdHIoWkNfVVNJTkdfUExVR0lOX0xJU1QsIkFwcENlbnRyZSIpIFRoZW4NCgkJCQlOb3RJbnN0YWxsZWRQbHVnaW49Tm90SW5zdGFsbGVkUGx1Z2luICYgIjxhIHRhcmdldD0nX2JsYW5rJyBocmVmPSciJiBaQ19CTE9HX0hPU1QgJiJ6Yl91c2Vycy9wbHVnaW4vYXBwY2VudHJlL3NlcnZlci5hc3A/bWV0aG9kPXNlYXJjaCZxPSImIFNlcnZlci5IdG1sRW5jb2RlKHNwdFRlbXAoaSkpICYiJz4iICYgc3B0VGVtcChpKSAmICI8L2E+IiAmICIgIg0KCQkJRWxzZQ0KCQkJCU5vdEluc3RhbGxlZFBsdWdpbj1Ob3RJbnN0YWxsZWRQbHVnaW4gJiBzcHRUZW1wKGkpICYgIiAiDQoJCQlFbmQgSWYNCgkJCWJvbE5vdEluc3RhbGw9VHJ1ZQ0KCQlFbmQgSWYNCglOZXh0DQoJSWYgYm9sTm90SW5zdGFsbCBUaGVuDQoJCVNldEJsb2dIaW50X0N1c3RvbSBOb3RJbnN0YWxsZWRQbHVnaW4gJiBaQ19NU0cyODINCgkJQ2hlY2tEZXBlbmRlbmN5PUZhbHNlDQoJRW5kIElmDQoJU2V0IG9ialhtbD1Ob3RoaW5nDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICDlgZznlKjml7bpqozor4Hkvp3otZYNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIENoZWNrRGVwZW5kZW5jeURpc2FibGUoYXJ5UGx1Z2luTGlzdCxzdHJQbHVnaW5OYW1lKQ0KDQoJRGltIHN0clhtbEZpbGUsb2JqWG1sRmlsZQ0KCURpbSBzdHJEZXBlbmRlbmN5LHN0clJldHVybkRlcGVuZGVuY3ksYm9sRGVwZW5kZW5jeSxzdHJJbmNsdWRlLHN0cklEDQoJRGltIGFyeVINCglEaW0gaixpLGsNCglib2xEZXBlbmRlbmN5PUZhbHNlDQoJDQoNCglTZXQgb2JqWG1sRmlsZT1TZXJ2ZXIuQ3JlYXRlT2JqZWN0KCJNaWNyb3NvZnQuWE1MRE9NIikNCglvYmpYbWxGaWxlLmFzeW5jID0gRmFsc2UNCglvYmpYbWxGaWxlLlZhbGlkYXRlT25QYXJzZT1GYWxzZQ0KCSfpppblhYjlhYjmo4Dmn6XkuIDkuIvkuLvpopgNCglvYmpYbWxGaWxlLkxvYWQoQmxvZ1BhdGggJiAiemJfdXNlcnNcVEhFTUVcIiZaQ19CTE9HX1RIRU1FJiJcdGhlbWUueG1sIikNCglJZiBvYmpYbWxGaWxlLnJlYWR5U3RhdGU9NCBUaGVuDQoJCUlmIG9ialhtbEZpbGUucGFyc2VFcnJvci5lcnJvckNvZGUgPSAwIFRoZW4NCgkJCXN0ckRlcGVuZGVuY3k9InwiJlVDYXNlKFRyeVRvR2V0QWR2YW5jZWQob2JqWG1sRmlsZSwiZGVwZW5kZW5jeSIpKSYifCINCgkJCUlmIEluU3RyKHN0ckRlcGVuZGVuY3ksInwiJnN0clBsdWdpbk5hbWUmInwiKSBUaGVuDQoJCQkJYm9sRGVwZW5kZW5jeT1UcnVlDQoJCQkJc3RyUmV0dXJuRGVwZW5kZW5jeT1aQ19CTE9HX1RIRU1FDQoJCQkJU2V0QmxvZ0hpbnRfQ3VzdG9tIFpDX01TRzI4MyAmIHN0clJldHVybkRlcGVuZGVuY3kNCgkJCQlDaGVja0RlcGVuZGVuY3lEaXNhYmxlPUZhbHNlDQoJCQkJRXhpdCBGdW5jdGlvbg0KCQkJRW5kIElmDQoJCUVuZCBJZg0KCUVuZCBJZg0KDQoJRm9yIGo9MCBUbyBVYm91bmQoYXJ5UGx1Z2luTGlzdCkNCgkJc3RyWG1sRmlsZSA9YXJ5UGx1Z2luTGlzdChqKQ0KCQlvYmpYbWxGaWxlLmxvYWQoc3RyWG1sRmlsZSkNCgkJSWYgb2JqWG1sRmlsZS5yZWFkeVN0YXRlPTQgVGhlbg0KCQkJSWYgb2JqWG1sRmlsZS5wYXJzZUVycm9yLmVycm9yQ29kZSA8PiAwIFRoZW4NCgkJCUVsc2UNCgkJCQlzdHJJRD1vYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJpZCIpLnRleHQNCgkJCQlzdHJJbmNsdWRlPW9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoImluY2x1ZGUiKS50ZXh0DQoJCQkJc3RyRGVwZW5kZW5jeT1TcGxpdChVQ2FzZShUcnlUb0dldEFkdmFuY2VkKG9ialhtbEZpbGUsImRlcGVuZGVuY3kiKSksInwiKQ0KCQkJCUlmIFRyaW0oc3RySW5jbHVkZSk8PiIiIFRoZW4NCgkJCQkJSWYgTGVuKExvYWRGcm9tRmlsZShCbG9nUGF0aCAmICJ6Yl91c2Vycy9wbHVnaW4vIiAmIHN0cklEICYgIi8iICYgc3RySW5jbHVkZSwidXRmLTgiKSk+MCBUaGVuDQoJCQkJCQlGb3IgaT0wIFRvIFVib3VuZChzdHJEZXBlbmRlbmN5KQ0KCQkJCQkJCUlmIHN0ckRlcGVuZGVuY3koaSk9VUNhc2Uoc3RyUGx1Z2luTmFtZSkgVGhlbg0KCQkJCQkJCQlzdHJSZXR1cm5EZXBlbmRlbmN5PXN0clJldHVybkRlcGVuZGVuY3kgJiBzdHJJRCAmICIgIg0KCQkJCQkJCQlpPVVib3VuZChzdHJEZXBlbmRlbmN5KSsxDQoJCQkJCQkJCWJvbERlcGVuZGVuY3k9VHJ1ZQ0KCQkJCQkJCUVuZCBJZg0KCQkJCQkJTmV4dA0KCQkJCQlFbmQgSWYNCgkJCQlFbmQgSWYNCgkJCUVuZCBJZg0KCQlFbmQgSWYNCglOZXh0DQoJSWYgYm9sRGVwZW5kZW5jeSBUaGVuIFNldEJsb2dIaW50X0N1c3RvbSBaQ19NU0cyODMgJiBzdHJSZXR1cm5EZXBlbmRlbmN5DQoJQ2hlY2tEZXBlbmRlbmN5RGlzYWJsZT1Ob3QoYm9sRGVwZW5kZW5jeSkNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgIOW+l+WIsOWFqOmDqFhNTOWcsOWdgA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gR2V0QWxsWG1sUGF0aChuZXdaQ19VU0lOR19QTFVHSU5fTElTVCkNCg0KCURpbSBhcnlQTCxpLGoscyx0DQoJYXJ5UEw9U3BsaXQobmV3WkNfVVNJTkdfUExVR0lOX0xJU1QsInwiKQ0KDQoJSWYgbmV3WkNfVVNJTkdfUExVR0lOX0xJU1Q8PiIiIFRoZW4NCgkJaT1VQm91bmQoYXJ5UEwpDQoJRWxzZQ0KCQlpPTANCgkJR2V0QWxsWG1sUGF0aD1hcnlQTA0KCQlFeGl0IEZ1bmN0aW9uDQoJRW5kIElmDQoNCglEaW0gZiwgZjEsIGZjDQoJRGltIGFyeVhtbEZpbGUoKQ0KCVJlZGltIGFyeVhtbEZpbGUoLTEpDQoJDQoJSWYgTm90IElzT2JqZWN0KFB1YmxpY09iakZTTykgVGhlbiBTZXQgUHVibGljT2JqRlNPPVNlcnZlci5DcmVhdGVPYmplY3QoIlNjcmlwdGluZy5GaWxlU3lzdGVtT2JqZWN0IikNCgkNCglTZXQgZiA9IFB1YmxpY09iakZTTy5HZXRGb2xkZXIoQmxvZ1BhdGggJiAiemJfdXNlcnMvcGx1Z2luLyIpDQoJU2V0IGZjID0gZi5TdWJGb2xkZXJzDQoJRm9yIGo9MCBUbyBpDQoJCUlmIFB1YmxpY09iakZTTy5GaWxlRXhpc3RzKEJsb2dQYXRoICYgInpiX3VzZXJzL3BsdWdpbi8iICYgYXJ5UEwoaikgJiAiLyIgJiAicGx1Z2luLnhtbCIpIFRoZW4NCgkJCUlmIENoZWNrUGx1Z2luU3RhdGVCeU5ld1ZhbHVlKGFyeVBMKGopLG5ld1pDX1VTSU5HX1BMVUdJTl9MSVNUKSBUaGVuDQoJCQkJUmVkaW0gUHJlc2VydmUgYXJ5WG1sRmlsZShVYm91bmQoYXJ5WG1sRmlsZSkrMSkNCgkJCQlhcnlYbWxGaWxlKFVib3VuZChhcnlYbWxGaWxlKSk9QmxvZ1BhdGggJiAiemJfdXNlcnMvcGx1Z2luLyIgJiBhcnlQTChqKSAmICIvIiAmICJwbHVnaW4ueG1sIg0KCQkJRW5kIElmDQoJCUVuZCBJZg0KCU5leHQNCglHZXRBbGxYbWxQYXRoPWFyeVhtbEZpbGUNCglTZXQgZj1Ob3RoaW5nDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogIOWFvOWuueiAgeeJiOacrFotQkxPRzIuMO+8jOmYsuatouWHuumUmQ0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gVHJ5VG9HZXRBZHZhbmNlZChvYmpYbWwsc2luZ2xlTm9kZSkNCglPbiBFcnJvciBSZXN1bWUgTmV4dA0KCVRyeVRvR2V0QWR2YW5jZWQ9IiINCglUcnlUb0dldEFkdmFuY2VkPW9ialhtbC5kb2N1bWVudEVsZW1lbnQuc2VsZWN0U2luZ2xlTm9kZSgiYWR2YW5jZWQvIiZzaW5nbGVOb2RlKS50ZXh0DQoJRXJyLkNsZWFyDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgIOmqjOivgeWGsueqgeOAgemHjeWGmeS7peWPiuWGmeWFpeaWh+S7tuOAkOWlvee7leWPo++8jOacm+WkqeOAkQ0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gQ2hlY2tDb25mbGljdFJlV3JpdGVBbmRUb0ZpbGUoc3RyUGx1Z2luTmFtZSxhcnlGaWxlUGF0aCxib2xDaGVjaykNCglEaW0gUmV0dXJuQXJyYXkoMikNCglSZXR1cm5BcnJheSgwKT1UcnVlICAnQ29uZmxpY3QNCglSZXR1cm5BcnJheSgxKT1UcnVlICAnUmVXcml0ZQ0KCVJldHVybkFycmF5KDIpPUZhbHNlICdHZXRUZXh0DQoJRGltIHN0clhtbEZpbGUsb2JqWG1sRmlsZSxhcnlKb2luVGV4dCxzdHJJRCxzdHJJbmNsdWRlLHN0ckNvbmZsaWN0LHN0clJld3JpdGUNCglEaW0gdGhpc1Jld3JpdGUsdGhpc0NvbmZsaWN0DQoJRGltIHN0clJlc3BvbnNlQ29uZmxpY3Qsc3RyUmVzcG9uc2VSZXdyaXRlDQoJRGltIGFyeVINCglSZWRpbSBhcnlKb2luVGV4dChVYm91bmQoYXJ5RmlsZVBhdGgpKQ0KCURpbSBqLGksaw0KCQ0KCVNldCBvYmpYbWxGaWxlPVNlcnZlci5DcmVhdGVPYmplY3QoIk1pY3Jvc29mdC5YTUxET00iKQ0KCW9ialhtbEZpbGUuYXN5bmMgPSBGYWxzZQ0KCW9ialhtbEZpbGUuVmFsaWRhdGVPblBhcnNlPUZhbHNlDQoJJ+WFiOivu+S4gOmBjeiHquW3seeahOmFjee9ruaWh+S7tuW+l+WIsOmHjeWGmeWSjOWGsueqgeS/oeaBr++8jOWGsueqgeWQjumdouS4gOS4quS4gOS4quavlOWvuQ0KCUlmIGJvbENoZWNrIFRoZW4NCgkJc3RyWG1sRmlsZSA9IEJsb2dQYXRoICYgInpiX3VzZXJzL3BsdWdpbi8iICYgc3RyUGx1Z2luTmFtZSAmICIvIiAmICJwbHVnaW4ueG1sIg0KCQlvYmpYbWxGaWxlLmxvYWQoc3RyWG1sRmlsZSkNCgkJdGhpc1Jld3JpdGU9U3BsaXQoVUNhc2UoVHJ5VG9HZXRBZHZhbmNlZChvYmpYbWxGaWxlLCJyZXdyaXRlZnVuY3Rpb25zIikpLCJ8IikNCgkJdGhpc0NvbmZsaWN0PVNwbGl0KFVDYXNlKFRyeVRvR2V0QWR2YW5jZWQob2JqWG1sRmlsZSwiY29uZmxpY3QiKSksInwiKQ0KCUVuZCBJZg0KCQ0KCQ0KCUZvciBqPTAgVG8gVWJvdW5kKGFyeUZpbGVQYXRoKQ0KCQlzdHJYbWxGaWxlID1hcnlGaWxlUGF0aChqKQ0KCQlvYmpYbWxGaWxlLmxvYWQoc3RyWG1sRmlsZSkNCgkJSWYgb2JqWG1sRmlsZS5yZWFkeVN0YXRlPTQgVGhlbg0KCQkJSWYgb2JqWG1sRmlsZS5wYXJzZUVycm9yLmVycm9yQ29kZSA8PiAwIFRoZW4NCgkJCUVsc2UNCgkJCQlzdHJJRD1vYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJpZCIpLnRleHQNCgkJCQlzdHJJbmNsdWRlPW9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoImluY2x1ZGUiKS50ZXh0DQoJCQkJc3RyUmV3cml0ZT1TcGxpdChVQ2FzZShUcnlUb0dldEFkdmFuY2VkKG9ialhtbEZpbGUsInJld3JpdGVmdW5jdGlvbnMiKSksInwiKQ0KCQkJCXN0ckNvbmZsaWN0PVNwbGl0KFVDYXNlKFRyeVRvR2V0QWR2YW5jZWQob2JqWG1sRmlsZSwiY29uZmxpY3QiKSksInwiKQ0KCQkJCUlmIFRyaW0oc3RySW5jbHVkZSk8PiIiIFRoZW4NCgkJCQkJSWYgTGVuKExvYWRGcm9tRmlsZShCbG9nUGF0aCAmICJ6Yl91c2Vycy9wbHVnaW4vIiAmIHN0cklEICYgIi8iICYgc3RySW5jbHVkZSwidXRmLTgiKSk+MCBUaGVuDQoJCQkJCQlhcnlKb2luVGV4dChqKT0iPCEtLSImIiAjaW5jbHVkZSBmaWxlPSIiIiZfDQoJCQkJCQkJCQkJc3RySUQgJl8NCgkJCQkJCQkJCQkiLyImXw0KCQkJCQkJCQkJCXN0ckluY2x1ZGUgJl8NCgkJCQkJCQkJCQkiIiIgLS0+Ig0KCQkJCQkJSWYgYm9sQ2hlY2sgVGhlbg0KCQkJCQkJCSflhYjliKTmlq3mmK/lkKblhrLnqoHvvIzku47kuKTkuKrmlrnpnaLliKTmlq3jgIINCgkJCQkJCQkn56ys5LiA5q2l77ya5Yik5pat5b6F5ZCv55So5o+S5Lu25piv5ZCm5LiO6K+l5o+S5Lu25Yay56qB4oCU4oCUDQoJCQkJCQkJRm9yIGk9MCBUbyBVYm91bmQodGhpc0NvbmZsaWN0KQ0KCQkJCQkJCQlJZiB0aGlzQ29uZmxpY3QoaSk9VUNhc2Uoc3RySUQpIFRoZW4NCgkJCQkJCQkJCVJldHVybkFycmF5KDApPUZhbHNlDQoJCQkJCQkJCQlzdHJSZXNwb25zZUNvbmZsaWN0PXN0clJlc3BvbnNlQ29uZmxpY3QgJiBzdHJJRCAmICIgIg0KCQkJCQkJCQlFbmQgSWYNCgkJCQkJCQlOZXh0DQoJCQkJCQkJJ+esrOS6jOatpe+8muWIpOaWreivpeaPkuS7tuaYr+WQpuS4juW+heWQr+eUqOaPkuS7tuWGsueqgeKAlOKAlA0KCQkJCQkJCUZvciBpPTAgVG8gVWJvdW5kKHN0ckNvbmZsaWN0KQ0KCQkJCQkJCQlJZiBzdHJDb25mbGljdChpKT1VQ2FzZShzdHJQbHVnaW5OYW1lKSBUaGVuDQoJCQkJCQkJCQlSZXR1cm5BcnJheSgwKT1GYWxzZQ0KCQkJCQkJCQkJSWYgSW5TdHIoc3RyUmVzcG9uc2VDb25mbGljdCxzdHJJRCk8PTAgVGhlbiBzdHJSZXNwb25zZUNvbmZsaWN0PXN0clJlc3BvbnNlQ29uZmxpY3QgJiBzdHJJRCAmICIgIg0KCQkJCQkJCQlFbmQgSWYNCgkJCQkJCQlOZXh0DQoJCQkJCQkJDQoJCQkJCQkJJ+aOpeedgOWIpOaWremHjeWGmeWHveaVsOOAgg0KCQkJCQkJCSfnm7TmjqXliKTmlq3lvoXlkK/nlKjmj5Lku7bmmK/lkKbkuI7or6Xmj5Lku7bmnInph43lhpnlh73mlbDljbPlj6/vvIzkuI3pnIDopoHlho3liIbkuKTkuKrlvqrnjq/liKTmlq0NCgkJCQkJCQkn5LiN6L+H6LKM5Ly86ZyA6KaB5Y+M6YeN5b6q546v4oCm4oCm77yfDQoJCQkJCQkJDQoJCQkJCQkJRm9yIGk9MCBUbyBVYm91bmQodGhpc1Jld3JpdGUpDQoJCQkJCQkJCUZvciBrPTAgVG8gVWJvdW5kKHN0clJld3JpdGUpDQoJCQkJCQkJCQlJZiB0aGlzUmV3cml0ZShpKT1zdHJSZXdyaXRlKGspIEFuZCBzdHJJRDw+c3RyUGx1Z2luTmFtZSBUaGVuDQoJCQkJCQkJCQkJUmV0dXJuQXJyYXkoMSk9RmFsc2UNCgkJCQkJCQkJCQlJZiBJblN0cihzdHJSZXNwb25zZVJld3JpdGUsc3RyUmV3cml0ZShrKSk8PTAgVGhlbiBzdHJSZXNwb25zZVJld3JpdGU9c3RyUmVzcG9uc2VSZXdyaXRlICYgc3RySUQgJiAiICINCgkJCQkJCQkJCUVuZCBJZg0KCQkJCQkJCQlOZXh0DQoJCQkJCQkJTmV4dA0KCQkJCQkJRW5kIElmDQoJCQkJCUVuZCBJZg0KCQkJCUVuZCBJZg0KCQkJRW5kIElmDQoJCUVuZCBJZg0KCU5leHQNCglJZiBSZXR1cm5BcnJheSgwKT1GYWxzZSBUaGVuIFNldEJsb2dIaW50X0N1c3RvbShaQ19NU0cyODMgJiBzdHJSZXNwb25zZUNvbmZsaWN0KQ0KCUlmIFJldHVybkFycmF5KDEpPUZhbHNlIEFuZCBSZXR1cm5BcnJheSgwKT1UcnVlIFRoZW4gU2V0QmxvZ0hpbnRfQ3VzdG9tKFpDX01TRzI4NSAmIHN0clJlc3BvbnNlUmV3cml0ZSkNCglSZXR1cm5BcnJheSgyKT1Kb2luKGFyeUpvaW5UZXh0LHZiQ3JsZikNCglDaGVja0NvbmZsaWN0UmVXcml0ZUFuZFRvRmlsZT1SZXR1cm5BcnJheQ0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgRGlzYWJsZVBsdWdJbiBCeSBOYW1lDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBEaXNhYmxlUGx1Z0luQnlOYW1lKHN0clBsdWdpbk5hbWUpDQoNCglDYWxsIFVuaW5zdGFsbFBsdWdpbihzdHJQbHVnaW5OYW1lKQ0KDQoJRGltIHMsaSx0DQoNCglzPVNwbGl0KFpDX1VTSU5HX1BMVUdJTl9MSVNULCJ8IikNCg0KCUZvciBpPUxCb3VuZChzKSBUbyBVQm91bmQocykNCg0KCQlJZiBVQ2FzZShzKGkpKTw+VUNhc2Uoc3RyUGx1Z2luTmFtZSkgVGhlbg0KDQoJCQlJZiB0PSIiIFRoZW4NCgkJCQl0PXMoaSkNCgkJCUVsc2UNCgkJCQl0PXQgJiAifCIgJiBzKGkpDQoJCQlFbmQgSWYNCgkJCQ0KCQkJDQoJCUVuZCBJZg0KDQoJTmV4dA0KCQ0KCURpbSBhcnlBbGxYbWxQYXRoDQoJYXJ5QWxsWG1sUGF0aD1HZXRBbGxYbWxQYXRoKHQpDQoJDQoJSWYgQ2hlY2tEZXBlbmRlbmN5RGlzYWJsZShhcnlBbGxYbWxQYXRoLHN0clBsdWdpbk5hbWUpPUZhbHNlIFRoZW4gRXhpdCBGdW5jdGlvbg0KDQoJRGltIHN0ckNvbnRlbnQNCglEaW0gc3RyWkNfVVNJTkdfUExVR0lOX0xJU1QNCg0KCXN0clpDX1VTSU5HX1BMVUdJTl9MSVNUPXQNCg0KCUNhbGwgQmxvZ0NvbmZpZy5Xcml0ZSgiWkNfVVNJTkdfUExVR0lOX0xJU1QiLHN0clpDX1VTSU5HX1BMVUdJTl9MSVNUKQ0KDQoJQ2FsbCBTYXZlQ29uZmlnMk9wdGlvbigpDQoJDQoJdD1DaGVja0NvbmZsaWN0UmVXcml0ZUFuZFRvRmlsZShzdHJQbHVnaW5OYW1lLGFyeUFsbFhtbFBhdGgsRmFsc2UpKDIpDQoJQ2FsbCBTY2FuUGx1Z2luVG9JbmNsdWRlRmlsZSh0KQ0KDQoJRGlzYWJsZVBsdWdJbkJ5TmFtZT1UcnVlDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8mg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gU2NhblBsdWdpblRvSW5jbHVkZUZpbGUocykNCg0KCUNhbGwgU2F2ZVRvRmlsZShCbG9nUGF0aCAmICJ6Yl91c2Vycy9QTFVHSU4vcF9pbmNsdWRlLmFzcCIscywidXRmLTgiLEZhbHNlKQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIFNjYW5QbHVnaW5Ub1RoZW1lRmlsZShuZXdaQ19CTE9HX0NTUyxuZXdaQ19CTE9HX1RIRU1FKQ0KDQoJT24gRXJyb3IgUmVzdW1lIE5leHQNCg0KCURpbSBvYmpYbWxGaWxlLHN0clhtbEZpbGUscyx0DQoNCglzdHJYbWxGaWxlID1CbG9nUGF0aCAmICJ6Yl91c2Vycy90aGVtZS8iICYgbmV3WkNfQkxPR19USEVNRSAmICIvIiAmICJ0aGVtZS54bWwiDQoNCglTZXQgb2JqWG1sRmlsZT1TZXJ2ZXIuQ3JlYXRlT2JqZWN0KCJNaWNyb3NvZnQuWE1MRE9NIikNCglvYmpYbWxGaWxlLmFzeW5jID0gRmFsc2UNCglvYmpYbWxGaWxlLlZhbGlkYXRlT25QYXJzZT1GYWxzZQ0KCW9ialhtbEZpbGUubG9hZChzdHJYbWxGaWxlKQ0KCUlmIG9ialhtbEZpbGUucmVhZHlTdGF0ZT00IFRoZW4NCgkJSWYgb2JqWG1sRmlsZS5wYXJzZUVycm9yLmVycm9yQ29kZSA8PiAwIFRoZW4NCgkJRWxzZQ0KCQkJSWYgTENhc2Uob2JqWG1sRmlsZS5kb2N1bWVudEVsZW1lbnQuc2VsZWN0U2luZ2xlTm9kZSgiaWQiKS50ZXh0KT1MQ2FzZShuZXdaQ19CTE9HX1RIRU1FKSBUaGVuDQoJCQkJSWYgTm90IElzT2JqZWN0KFB1YmxpY09iakZTTykgVGhlbiBTZXQgUHVibGljT2JqRlNPPVNlcnZlci5DcmVhdGVPYmplY3QoIlNjcmlwdGluZy5GaWxlU3lzdGVtT2JqZWN0IikNCgkJCQlJZiBQdWJsaWNPYmpGU08uRmlsZUV4aXN0cyhCbG9nUGF0aCAmICJ6Yl91c2Vycy90aGVtZS8iICYgb2JqWG1sRmlsZS5kb2N1bWVudEVsZW1lbnQuc2VsZWN0U2luZ2xlTm9kZSgiaWQiKS50ZXh0ICYiL3BsdWdpbi8iICYgb2JqWG1sRmlsZS5kb2N1bWVudEVsZW1lbnQuc2VsZWN0U2luZ2xlTm9kZSgicGx1Z2luL2luY2x1ZGUiKS50ZXh0KSBUaGVuDQoJCQkJCUlmIFRyaW0ob2JqWG1sRmlsZS5kb2N1bWVudEVsZW1lbnQuc2VsZWN0U2luZ2xlTm9kZSgicGx1Z2luL2luY2x1ZGUiKS50ZXh0KTw+IiIgVGhlbg0KCQkJCQkJdD1Mb2FkRnJvbUZpbGUoQmxvZ1BhdGggJiAiemJfdXNlcnMvdGhlbWUvIiAmIG9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoImlkIikudGV4dCAmIi9wbHVnaW4vIiAmIG9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoInBsdWdpbi9pbmNsdWRlIikudGV4dCwidXRmLTgiKQ0KCQkJCQkJSWYgSW5TdHIoTENhc2UodCksTENhc2UoIkluc3RhbGxQbHVnaW5fIikpPjAgVGhlbg0KCQkJCQkJCUNhbGwgQWRkQmF0Y2goWkNfTVNHMjAyICYgb2JqWG1sRmlsZS5kb2N1bWVudEVsZW1lbnQuc2VsZWN0U2luZ2xlTm9kZSgiaWQiKS50ZXh0LCJDYWxsIEluc3RhbGxQbHVnaW4oIiIiJm9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoImlkIikudGV4dCYiIiIpIikJDQoJCQkJCQlFbmQgSWYNCgkJCQkJCXM9cyAmICI8IS0iJiItICNpbmNsdWRlIGZpbGU9IiIuLi90aGVtZS8iJiBvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJpZCIpLnRleHQgJiIvcGx1Z2luLyImIG9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoInBsdWdpbi9pbmNsdWRlIikudGV4dCAmIiIiIC0tPiIgJiB2YkNyTGYNCgkJCQkJRW5kIElmDQoJCQkJRW5kIElmDQoJCQlFbmQgSWYNCgkJRW5kIElmDQoJRW5kIElmDQoJU2V0IG9ialhtbEZpbGU9Tm90aGluZw0KDQoJQ2FsbCBTYXZlVG9GaWxlKEJsb2dQYXRoICYgInpiX3VzZXJzL1BMVUdJTi9wX3RoZW1lLmFzcCIscywidXRmLTgiLEZhbHNlKQ0KDQoJRXJyLkNsZWFyDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8mg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gU2NhblRhZ0NvdW50KHN0clRhZ3MpDQonc3RyVGFncz0iezF9ezJ9ezN9ezR9ezV9Ig0KCURpbSB0LGkscw0KCURpbSBvYmpSUyxqLGsNCg0KCUlmIHN0clRhZ3M8PiIiIFRoZW4NCg0KCQlzPXN0clRhZ3MNCgkJcz1SZXBsYWNlKHMsIn0iLCIiKQ0KCQl0PVNwbGl0KHMsInsiKQ0KDQoJCUZvciBpPUxCb3VuZCh0KSBUbyBVQm91bmQodCkNCg0KCQkJSWYgdChpKTw+IiIgVGhlbg0KDQoJCQkJaz10KGkpDQoJCQkJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIENPVU5UKFtsb2dfSURdKSBGUk9NIFtibG9nX0FydGljbGVdIFdIRVJFIFtsb2dfTGV2ZWxdPjEgQU5EIFtsb2dfVGFnXSBMSUtFICcleyIgJiBrICYgIn0lJyIpDQoJCQkJaj1vYmpSUygwKQ0KCQkJCW9iakNvbm4uRXhlY3V0ZSgiVVBEQVRFIFtibG9nX1RhZ10gU0VUIFt0YWdfQ291bnRdPSImaiYiIFdIRVJFIFt0YWdfSURdID0iICYgaykNCgkJCQlTZXQgb2JqUlM9Tm90aGluZw0KDQoJCQlFbmQgSWYNCg0KCQlOZXh0DQoNCgkJcz1Kb2luKHQsIiwiKQ0KCQlzPVJpZ2h0KHMsTGVuKHMpLTEpDQoNCgkJc3RyVGFncz1zDQoNCglFbmQgSWYNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8mg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gU2F2ZVNpZGViYXJPcmRlcihzMSxzMixzMyxzNCxzNSkNCg0KCUlmIFJpZ2h0KHMxLDEpPSI6IiBUaGVuIHMxPUxlZnQoczEsTGVuKHMxKS0xKQ0KCUlmIFJpZ2h0KHMyLDEpPSI6IiBUaGVuIHMyPUxlZnQoczIsTGVuKHMyKS0xKQ0KCUlmIFJpZ2h0KHMzLDEpPSI6IiBUaGVuIHMzPUxlZnQoczMsTGVuKHMzKS0xKQ0KCUlmIFJpZ2h0KHM0LDEpPSI6IiBUaGVuIHM0PUxlZnQoczQsTGVuKHM0KS0xKQ0KCUlmIFJpZ2h0KHM1LDEpPSI6IiBUaGVuIHM1PUxlZnQoczUsTGVuKHM1KS0xKQ0KDQoJWkNfU0lERUJBUl9PUkRFUj1zMQ0KCUJsb2dDb25maWcuV3JpdGUgIlpDX1NJREVCQVJfT1JERVIiLHMxDQoJWkNfU0lERUJBUl9PUkRFUjI9czINCglCbG9nQ29uZmlnLldyaXRlICJaQ19TSURFQkFSX09SREVSMiIsczINCglaQ19TSURFQkFSX09SREVSMz1zMw0KCUJsb2dDb25maWcuV3JpdGUgIlpDX1NJREVCQVJfT1JERVIzIixzMw0KCVpDX1NJREVCQVJfT1JERVI0PXM0DQoJQmxvZ0NvbmZpZy5Xcml0ZSAiWkNfU0lERUJBUl9PUkRFUjQiLHM0DQoJWkNfU0lERUJBUl9PUkRFUjU9czUNCglCbG9nQ29uZmlnLldyaXRlICJaQ19TSURFQkFSX09SREVSNSIsczUNCg0KCVNhdmVTaWRlYmFyT3JkZXI9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIFNhdmVGdW5jdGlvbigpDQoNCglEaW0gb2JqRnVuY3Rpb24NCglTZXQgb2JqRnVuY3Rpb249TmV3IFRGdW5jdGlvbg0KDQoJSWYgQ0xuZyhSZXF1ZXN0LkZvcm0oImlucElEIikpPjAgVGhlbiBvYmpGdW5jdGlvbi5Mb2FkSW5mb0J5SUQoUmVxdWVzdC5Gb3JtKCJpbnBJRCIpKQ0KDQoJb2JqRnVuY3Rpb24uSUQ9UmVxdWVzdC5Gb3JtKCJpbnBJRCIpDQoJb2JqRnVuY3Rpb24uTmFtZT1SZXF1ZXN0LkZvcm0oImlucE5hbWUiKQ0KCUlmIG9iakZ1bmN0aW9uLklzVXNlcnM9VHJ1ZSBUaGVuIG9iakZ1bmN0aW9uLkZpbGVOYW1lPVJlcXVlc3QuRm9ybSgiaW5wRmlsZU5hbWUiKQ0KCUlmIG9iakZ1bmN0aW9uLklzVXNlcnM9VHJ1ZSBUaGVuIG9iakZ1bmN0aW9uLkZ0eXBlPVJlcXVlc3QuRm9ybSgiaW5wRnR5cGUiKQ0KCW9iakZ1bmN0aW9uLkh0bWxJRD1SZXF1ZXN0LkZvcm0oImlucEh0bWxJRCIpDQoJb2JqRnVuY3Rpb24uT3JkZXI9UmVxdWVzdC5Gb3JtKCJpbnBPcmRlciIpDQoJb2JqRnVuY3Rpb24uTWF4TGk9UmVxdWVzdC5Gb3JtKCJpbnBNYXhMaSIpDQoJb2JqRnVuY3Rpb24uU2lkZWJhcklEPVJlcXVlc3QuRm9ybSgiaW5wU2lkZWJhcklEIikNCglvYmpGdW5jdGlvbi5Db250ZW50PVJlcGxhY2UoUmVxdWVzdC5Gb3JtKCJpbnBDb250ZW50IiksVkJDcmxmLCIiKQ0KCW9iakZ1bmN0aW9uLlZpZXdUeXBlPVJlcXVlc3QuRm9ybSgiaW5wVmlld1R5cGUiKQ0KCW9iakZ1bmN0aW9uLlNvdXJjZT1SZXF1ZXN0LkZvcm0oImlucFNvdXJjZSIpDQoJb2JqRnVuY3Rpb24uSXNIaWRkZW49Tm90IChSZXF1ZXN0LkZvcm0oImlucElzSGlkZGVuIik9IlRydWUiKQ0KCW9iakZ1bmN0aW9uLklzSGlkZVRpdGxlPShSZXF1ZXN0LkZvcm0oImlucElzSGlkZVRpdGxlIik9IlRydWUiKQ0KCUlmIFJlcXVlc3QuRm9ybSgiaW5wRmlsZU5hbWUiKT0ibmF2YmFyIiBUaGVuDQoJCUNhbGwgR2V0RnVuY3Rpb24oKQ0KCQlJZiBUcmFuc2ZlckhUTUwob2JqRnVuY3Rpb24uQ29udGVudCwiW2FudGktemNfYmxvZ19ob3N0XSIpPD5GdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZSgibmF2YmFyIikpLkNvbnRlbnQgVGhlbg0KCQkJQ2FsbCBTZXRCbG9nSGludChFbXB0eSxFbXB0eSxUcnVlKQ0KCQlFbmQgSWYNCglFbmQgSWYNCg0KCSfmjqXlj6MNCgknQ2FsbCBGaWx0ZXJfUGx1Z2luX1NhdmVGdW5jdGlvbl9Db3JlKG9iakZ1bmN0aW9uKQ0KCUlmIG9iakZ1bmN0aW9uLlNvdXJjZTw+InN5c3RlbSIgVGhlbg0KCQlJZiBTZWFyY2hJbkFycmF5cyhvYmpGdW5jdGlvbi5GaWxlTmFtZSxTcGxpdCgibmF2YmFyOiImWkNfREVGQVVMVF9TSURFQkFSLCI6IikpPVRydWUgVGhlbiBvYmpGdW5jdGlvbi5GaWxlTmFtZT1vYmpGdW5jdGlvbi5GaWxlTmFtZSAmIExlZnQoQ1N0cihSbmQoKSoxMDAwMCksNCkNCglFbmQgSWYNCg0KCUlmIG9iakZ1bmN0aW9uLlBvc3QgVGhlbg0KDQoJCVNhdmVGdW5jdGlvbj1UcnVlDQoJCSdDYWxsIEZpbHRlcl9QbHVnaW5fU2F2ZUZ1bmN0aW9uX1N1Y2NlZWQob2JqRnVuY3Rpb24pDQoJRW5kIElmDQoJU2V0IG9iakZ1bmN0aW9uPU5vdGhpbmcNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBEZWxGdW5jdGlvbihpbnRJRCkNCg0KCURpbSBvYmpGdW5jdGlvbg0KDQoJU2V0IG9iakZ1bmN0aW9uPU5ldyBURnVuY3Rpb24NCg0KCUlmIG9iakZ1bmN0aW9uLkxvYWRJbmZvYnlJRChpbnRJRCkgVGhlbg0KDQoJCUlmIG9iakZ1bmN0aW9uLkRlbCBUaGVuDQoJCQlEZWxGdW5jdGlvbj1UcnVlDQoJCUVuZCBJZg0KDQoJRW5kIElmDQoNCglTZXQgb2JqRnVuY3Rpb249Tm90aGluZw0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCiU+</file>
	<file name='zb_system\FUNCTION\c_system_lib.asp' crc32='25683CE5'  dt:dt='bin.base64'>77u/PCUNCicvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQonLy8gICAgICAgICAgICAgIFotQmxvZw0KJy8vIOS9nCAgICDogIU6ICAgIOacseeFiih6eC5hc2QpDQonLy8g54mI5p2D5omA5pyJOiAgICBSYWluYm93U29mdCBTdHVkaW8NCicvLyDmioDmnK/mlK/mjIE6ICAgIHJhaW5ib3dzb2Z0QDE2My5jb20NCicvLyDnqIvluo/lkI3np7A6DQonLy8g56iL5bqP54mI5pysOg0KJy8vIOWNleWFg+WQjeensDogICAgY19zeXN0ZW1fbGliLmFzcA0KJy8vIOW8gOWni+aXtumXtDogICAgMjAwNC4wNy4yNQ0KJy8vIOacgOWQjuS/ruaUuTogICAgMjAwNy0xLTQNCicvLyDlpIcgICAg5rOoOiAgICDlupPmqKHlnZcNCicvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIOWumuS5iVRDYXRlZ29yeeexuw0KJyDovpPlhaXvvJogICAg5pegDQonIOi/lOWbnu+8miAgICDml6ANCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkNsYXNzIFRDYXRlZ29yeQ0KDQoJUHVibGljIElEDQoJUHVibGljIE5hbWUNCglQdWJsaWMgSW50cm8NCglQdWJsaWMgT3JkZXINCglQdWJsaWMgQ291bnQNCglQdWJsaWMgQWxpYXMNCglQdWJsaWMgUGFyZW50SUQNCglQdWJsaWMgRnVsbFVybA0KCVB1YmxpYyBNZXRhDQoJUHVibGljIFRlbXBsYXRlTmFtZQ0KCVB1YmxpYyBMb2dUZW1wbGF0ZQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBNZXRhU3RyaW5nDQoJCU1ldGFTdHJpbmc9TWV0YS5TYXZlU3RyaW5nDQoJRW5kIFByb3BlcnR5DQoJUHVibGljIFByb3BlcnR5IExldCBNZXRhU3RyaW5nKHMpDQoJCU1ldGEuTG9hZFN0cmluZz1zDQoJRW5kIFByb3BlcnR5DQoNCg0KCVByaXZhdGUgRnRlbXBsYXRlDQoJUHVibGljIFByb3BlcnR5IExldCBUZW1wbGF0ZShzdHJGaWxlTmFtZSkNCgkJRnRlbXBsYXRlPUdldFRlbXBsYXRlKCJURU1QTEFURV8iICYgc3RyRmlsZU5hbWUpDQoJRW5kIFByb3BlcnR5DQoJUHVibGljIFByb3BlcnR5IEdldCBUZW1wbGF0ZQ0KCQlJZiBGdGVtcGxhdGU8PiIiIFRoZW4NCgkJCVRlbXBsYXRlID0gRnRlbXBsYXRlDQoJCQlFeGl0IFByb3BlcnR5DQoJCUVsc2UNCgkJCUlmIFRlbXBsYXRlTmFtZTw+IiIgVGhlbg0KCQkJCURpbSBzDQoJCQkJcz1HZXRUZW1wbGF0ZSgiVEVNUExBVEVfIiAmVGVtcGxhdGVOYW1lKQ0KCQkJCUlmIHM8PiIiIFRoZW4NCgkJCQkJRnRlbXBsYXRlID0gcw0KCQkJCUVsc2UNCgkJCQkJRnRlbXBsYXRlPUdldFRlbXBsYXRlKCJURU1QTEFURV9DQVRBTE9HIikNCgkJCQlFbmQgSWYNCgkJCUVsc2UNCgkJCQlGdGVtcGxhdGU9R2V0VGVtcGxhdGUoIlRFTVBMQVRFX0NBVEFMT0ciKQ0KCQkJRW5kIElmDQoJCQlUZW1wbGF0ZSA9IEZ0ZW1wbGF0ZQ0KCQlFbmQgSWYNCglFbmQgUHJvcGVydHkNCg0KCVB1YmxpYyBGdW5jdGlvbiBHZXREZWZhdWx0VGVtcGxhdGVOYW1lDQoJCUlmIFRlbXBsYXRlTmFtZTw+IiIgVGhlbg0KCQkJR2V0RGVmYXVsdFRlbXBsYXRlTmFtZT1UZW1wbGF0ZU5hbWUNCgkJRWxzZQ0KCQkJR2V0RGVmYXVsdFRlbXBsYXRlTmFtZT0iQ0FUQUxPRyINCgkJRW5kIElmDQoJRW5kIEZ1bmN0aW9uDQoNCglQdWJsaWMgRnVuY3Rpb24gR2V0RGVmYXVsdExvZ1RlbXBsYXRlTmFtZQ0KCQlJZiBMb2dUZW1wbGF0ZTw+IiIgIFRoZW4NCgkJCUdldERlZmF1bHRMb2dUZW1wbGF0ZU5hbWU9TG9nVGVtcGxhdGUNCgkJRWxzZQ0KCQkJR2V0RGVmYXVsdExvZ1RlbXBsYXRlTmFtZT0iU0lOR0xFIg0KCQlFbmQgSUYNCglFbmQgRnVuY3Rpb24NCg0KCVByaXZhdGUgRmZ1bGxyZWdleA0KCVB1YmxpYyBQcm9wZXJ0eSBMZXQgRnVsbFJlZ2V4KHMpDQoJCUZmdWxscmVnZXg9cw0KCUVuZCBQcm9wZXJ0eQ0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgRnVsbFJlZ2V4DQoJCUlmIEZmdWxscmVnZXg8PiIiIFRoZW4gDQoJCQlGdWxsUmVnZXg9RmZ1bGxyZWdleA0KCQlFbHNlDQoJCQlGdWxsUmVnZXg9WkNfQ0FURUdPUllfUkVHRVgNCgkJRW5kIElmDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgaHRtbA0KDQoJUHVibGljIFByb3BlcnR5IEdldCBGdWxsUGF0aA0KCQlGdWxsUGF0aD1QYXJzZUN1c3RvbURpcmVjdG9yeUZvclBhdGgoRnVsbFJlZ2V4LFpDX1NUQVRJQ19ESVJFQ1RPUlksIiIsIiIsIiIsIiIsIiIsSUQsTmFtZSxTdGF0aWNOYW1lKQ0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBVcmwNCg0KCQkncGx1Z2luIG5vZGUNCgkJYkFjdGlvbl9QbHVnaW5fVENhdGVnb3J5X1VybD1GYWxzZQ0KCQlGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9UQ2F0ZWdvcnlfVXJsIGluIEFjdGlvbl9QbHVnaW5fVENhdGVnb3J5X1VybA0KCQkJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fVENhdGVnb3J5X1VybCkgVGhlbiBDYWxsIEV4ZWN1dGUoc0FjdGlvbl9QbHVnaW5fVENhdGVnb3J5X1VybCkNCgkJCUlmIGJBY3Rpb25fUGx1Z2luX1RDYXRlZ29yeV9Vcmw9VHJ1ZSBUaGVuIEV4aXQgUHJvcGVydHkNCgkJTmV4dA0KCQkNCgkJVXJsID1QYXJzZUN1c3RvbURpcmVjdG9yeUZvclVybChGdWxsUmVnZXgsWkNfU1RBVElDX0RJUkVDVE9SWSwiIiwiIiwiIiwiIiwiIixJRCxOYW1lLFN0YXRpY05hbWUpDQoJCUlmIFJpZ2h0KFVybCwxMik9ImRlZmF1bHQuaHRtbCIgVGhlbiBVcmw9TGVmdChVcmwsTGVuKFVybCktMTIpDQoNCgkJVXJsPVJlcGxhY2UoUmVwbGFjZShVcmwsIi8vIiwiLyIpLCI6LyIsIjovLyIsMSwxKQ0KDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UQ2F0ZWdvcnlfVXJsKFVybCkNCg0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBSc3NVcmwNCgkJUnNzVXJsID0gQmxvZ0hvc3QgJiAiZmVlZC5hc3A/Y2F0ZT0iICYgSUQNCglFbmQgUHJvcGVydHkNCg0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgSHRtbE5hbWUNCgkJSHRtbE5hbWU9VHJhbnNmZXJIVE1MKE5hbWUsIltodG1sLWZvcm1hdF0iKQ0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBIdG1sVXJsDQoJCUh0bWxVcmw9VHJhbnNmZXJIVE1MKFVybCwiW2h0bWwtZm9ybWF0XSIpDQoJRW5kIFByb3BlcnR5DQoJDQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IFN0YXRpY05hbWUNCgkJSWYgSXNOdWxsKEFsaWFzKSBPciBJc0VtcHR5KEFsaWFzKSBPciBBbGlhcz0iIiBUaGVuDQoJCQlTdGF0aWNOYW1lID0gTmFtZQ0KCQlFbHNlDQoJCQlTdGF0aWNOYW1lID0gQWxpYXMNCgkJRW5kIElmDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUmVDb3VudA0KCVB1YmxpYyBFeElEICfljp9JRA0KDQoJUHVibGljIEZ1bmN0aW9uIFBvc3QoKQ0KDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UQ2F0ZWdvcnlfUG9zdChJRCxOYW1lLEludHJvLE9yZGVyLENvdW50LFBhcmVudElELEFsaWFzLFRlbXBsYXRlTmFtZSxMb2dUZW1wbGF0ZSxGdWxsVXJsLE1ldGFTdHJpbmcpDQoNCgkJQ2FsbCBDaGVja1BhcmFtZXRlcihJRCwiaW50IiwwKQ0KCQlDYWxsIENoZWNrUGFyYW1ldGVyKE9yZGVyLCJpbnQiLDApDQoJCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoUGFyZW50SUQsImludCIsMCkNCg0KCQknSUTlj6/ku6XkuLowDQoJCU5hbWU9RmlsdGVyU1FMKE5hbWUpDQoJCUFsaWFzPVRyYW5zZmVySFRNTChBbGlhcywiW2RpcmVjdG9yeSZmaWxlXSIpDQoJCUlmIExlZnQoQWxpYXMsMSk9Ii8iIFRoZW4gQWxpYXM9UmlnaHQoQWxpYXMsTGVuKEFsaWFzKS0xKQ0KCQlJZiBSaWdodChBbGlhcywxKT0iLyIgVGhlbiBBbGlhcz1MZWZ0KEFsaWFzLExlbihBbGlhcyktMSkNCgkJQWxpYXM9RmlsdGVyU1FMKEFsaWFzKQ0KCQlJbnRybz1GaWx0ZXJTUUwoSW50cm8pDQoNCgkJVGVtcGxhdGVOYW1lPVVDYXNlKEZpbHRlclNRTChUZW1wbGF0ZU5hbWUpKQ0KCQlJZiBUZW1wbGF0ZU5hbWU9IkNBVEFMT0ciIFRoZW4gVGVtcGxhdGVOYW1lPSIiDQoNCgkJTG9nVGVtcGxhdGU9VUNhc2UoRmlsdGVyU1FMKExvZ1RlbXBsYXRlKSkNCgkJSWYgTG9nVGVtcGxhdGU9IlNJTkdMRSIgVGhlbiBMb2dUZW1wbGF0ZT0iIg0KDQoJCUlmIExlbihOYW1lKT0wIFRoZW4gUG9zdD1GYWxzZTpFeGl0IEZ1bmN0aW9uDQoNCgkJSWYgSUQ9MCBUaGVuDQoNCgkJCUlmIE5vdCBQYXJlbnRJRD0wIFRoZW4NCgkJCQlTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgW2NhdGVfSURdLFtjYXRlX1BhcmVudElEXSBGUk9NIFtibG9nX0NhdGVnb3J5XSBXSEVSRSBbY2F0ZV9JRF09IiAmIFBhcmVudElEKQ0KCQkJCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCgkJCQkJSWYgTm90IG9ialJTKCJjYXRlX1BhcmVudElEIik9MCBUaGVuIFNob3dFcnJvcig1MSkNCgkJCQlFbHNlDQoJCQkJCVNob3dFcnJvcig1MCkNCgkJCQlFbmQgSWYNCgkJCUVuZCBJZg0KDQoJCQlvYmpDb25uLkV4ZWN1dGUoIklOU0VSVCBJTlRPIFtibG9nX0NhdGVnb3J5XShbY2F0ZV9OYW1lXSxbY2F0ZV9PcmRlcl0sW2NhdGVfSW50cm9dLFtjYXRlX1BhcmVudElEXSxbY2F0ZV9VcmxdLFtjYXRlX1RlbXBsYXRlXSxbY2F0ZV9Mb2dUZW1wbGF0ZV0sW2NhdGVfRnVsbFVybF0sW2NhdGVfTWV0YV0pIFZBTFVFUyAoJyImTmFtZSYiJywiJk9yZGVyJiIsJyImSW50cm8mIicsIiZQYXJlbnRJRCYiLCciJkFsaWFzJiInLCciJlRlbXBsYXRlTmFtZSYiJywnIiZMb2dUZW1wbGF0ZSYiJywnIiZGdWxsVXJsJiInLCciJk1ldGFTdHJpbmcmIicpIikNCg0KCQkJRGltIG9ialJTDQoJCQlTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgTUFYKFtjYXRlX0lEXSkgRlJPTSBbYmxvZ19DYXRlZ29yeV0iKQ0KCQkJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KCQkJCUlEPW9ialJTKDApDQoJCQlFbmQgSWYNCgkJCVNldCBvYmpSUz1Ob3RoaW5nDQoNCgkJCUlmIFBhcmVudElEPUlEIFRoZW4NCgkJCQlQYXJlbnRJRD0wDQoJCQkJb2JqQ29ubi5FeGVjdXRlKCJVUERBVEUgW2Jsb2dfQ2F0ZWdvcnldIHNldCBbY2F0ZV9OYW1lXT0nIiZOYW1lJiInLFtjYXRlX09yZGVyXT0iJk9yZGVyJiIsW2NhdGVfSW50cm9dPSciJkludHJvJiInLFtjYXRlX1BhcmVudElEXT0iJlBhcmVudElEJiIsW2NhdGVfVXJsXT0nIiZBbGlhcyYiJyxbY2F0ZV9UZW1wbGF0ZV09JyImVGVtcGxhdGVOYW1lJiInLFtjYXRlX0xvZ1RlbXBsYXRlXT0nIiZMb2dUZW1wbGF0ZSYiJyxbY2F0ZV9GdWxsVXJsXT0nIiZGdWxsVXJsJiInLFtjYXRlX01ldGFdPSciJk1ldGFTdHJpbmcmIicgV0hFUkUgW2NhdGVfSURdID0iICYgSUQpDQoJCQlFbmQgSWYNCg0KCQlFbHNlDQoNCgkJCSflpoLmnpzpgInmi6nkuobniLbliIbnsbssIOmcgOimgei/m+ihjOS7peS4i+WIpOaWrQ0KCQkJSWYgTm90IFBhcmVudElEPTAgVGhlbg0KCQkJCSfniLbliIbnsbvkuI3og73kuLroh6rouqsNCgkJCQlJZiBQYXJlbnRJRD1JRCBUaGVuIFBhcmVudElEPTANCgkJCQkn5LiN6IO95bCG5YiG57G7572u5LqO5a2Q5YiG57G75LiLLCDlhbzliKTmlq3pgInmi6nnmoTniLbliIbnsbvmmK/lkKblrZjlnKguDQoJCQkJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFtjYXRlX0lEXSxbY2F0ZV9QYXJlbnRJRF0gRlJPTSBbYmxvZ19DYXRlZ29yeV0gV0hFUkUgW2NhdGVfSURdPSIgJiBQYXJlbnRJRCkNCgkJCQlJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoJCQkJCUlmIE5vdCBvYmpSUygiY2F0ZV9QYXJlbnRJRCIpPTAgVGhlbiBTaG93RXJyb3IoNTEpDQoJCQkJRWxzZQ0KCQkJCQlTaG93RXJyb3IoNTApDQoJCQkJRW5kIElmDQoJCQkJJ+S4jeiDveWwhuWQq+acieWtkOWIhuexu+eahOWIhuexu+e9ruS6juWFtuWug+WIhuexu+S4iy4NCgkJCQlTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgW2NhdGVfSURdIEZST00gW2Jsb2dfQ2F0ZWdvcnldIFdIRVJFIFtjYXRlX1BhcmVudElEXT0iICYgSUQpDQoJCQkJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbiAgU2hvd0Vycm9yKDUxKQ0KCQkJCVNldCBvYmpSUz1Ob3RoaW5nDQoJCQlFbmQgSWYNCg0KCQkJb2JqQ29ubi5FeGVjdXRlKCJVUERBVEUgW2Jsb2dfQ2F0ZWdvcnldIHNldCBbY2F0ZV9OYW1lXT0nIiZOYW1lJiInLFtjYXRlX09yZGVyXT0iJk9yZGVyJiIsW2NhdGVfSW50cm9dPSciJkludHJvJiInLFtjYXRlX1BhcmVudElEXT0iJlBhcmVudElEJiIsW2NhdGVfVXJsXT0nIiZBbGlhcyYiJyxbY2F0ZV9UZW1wbGF0ZV09JyImVGVtcGxhdGVOYW1lJiInLFtjYXRlX0xvZ1RlbXBsYXRlXT0nIiZMb2dUZW1wbGF0ZSYiJyxbY2F0ZV9GdWxsVXJsXT0nIiZGdWxsVXJsJiInLFtjYXRlX01ldGFdPSciJk1ldGFTdHJpbmcmIicgV0hFUkUgW2NhdGVfSURdID0iICYgSUQpDQoNCgkJRW5kIElmDQoNCgkJUG9zdD1UcnVlDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJUHVibGljIEZ1bmN0aW9uIExvYWRJbmZvQnlJRChjYXRlX0lEKQ0KDQoJCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoY2F0ZV9JRCwiaW50IiwwKQ0KDQoJCUlmIGNhdGVfSUQ9MCBUaGVuDQoJCQlJZiBCbG9nQ29uZmlnLkV4aXN0cygiWkNfVU5DQVRFR09SSVpFRF9OQU1FIik9VHJ1ZSBUaGVuIE5hbWU9QmxvZ0NvbmZpZy5SZWFkKCJaQ19VTkNBVEVHT1JJWkVEX05BTUUiKQ0KCQkJSWYgQmxvZ0NvbmZpZy5FeGlzdHMoIlpDX1VOQ0FURUdPUklaRURfQUxJQVMiKT1UcnVlIFRoZW4gQWxpYXM9QmxvZ0NvbmZpZy5SZWFkKCJaQ19VTkNBVEVHT1JJWkVEX0FMSUFTIikNCgkJCUlmIEJsb2dDb25maWcuRXhpc3RzKCJaQ19VTkNBVEVHT1JJWkVEX0NPVU5UIik9VHJ1ZSBUaGVuIA0KCQkJCURpbSBpbnRVbkNhdGVDb3VudA0KCQkJCWludFVuQ2F0ZUNvdW50PUJsb2dDb25maWcuUmVhZCgiWkNfVU5DQVRFR09SSVpFRF9DT1VOVCIpDQoJCQkJQ2FsbCBDaGVja1BhcmFtZXRlcihpbnRVbkNhdGVDb3VudCwiaW50IiwwKQ0KCQkJCUNvdW50PWludFVuQ2F0ZUNvdW50DQoJCQlFbmQgaWYgDQoJCQlMb2FkSW5mb0J5SUQ9VHJ1ZQ0KCQkJRXhpdCBGdW5jdGlvbg0KCQlFbmQgSWYNCg0KCQlEaW0gb2JqUlMNCgkJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFtjYXRlX0lEXSxbY2F0ZV9OYW1lXSxbY2F0ZV9JbnRyb10sW2NhdGVfT3JkZXJdLFtjYXRlX0NvdW50XSxbY2F0ZV9QYXJlbnRJRF0sW2NhdGVfVXJsXSxbY2F0ZV9UZW1wbGF0ZV0sW2NhdGVfTG9nVGVtcGxhdGVdLFtjYXRlX0Z1bGxVcmxdLFtjYXRlX01ldGFdIEZST00gW2Jsb2dfQ2F0ZWdvcnldIFdIRVJFIFtjYXRlX0lEXT0iICYgY2F0ZV9JRCkNCg0KCQlJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoNCgkJCUlEPW9ialJTKCJjYXRlX0lEIikNCgkJCU5hbWU9b2JqUlMoImNhdGVfTmFtZSIpDQoJCQlBbGlhcz1vYmpSUygiY2F0ZV9VcmwiKQ0KCQkJT3JkZXI9b2JqUlMoImNhdGVfT3JkZXIiKQ0KCQkJQ291bnQ9b2JqUlMoImNhdGVfQ291bnQiKQ0KCQkJUGFyZW50SUQ9b2JqUlMoImNhdGVfUGFyZW50SUQiKQ0KCQkJSW50cm89b2JqUlMoImNhdGVfSW50cm8iKQ0KCQkJVGVtcGxhdGVOYW1lPW9ialJTKCJjYXRlX1RlbXBsYXRlIikNCgkJCUxvZ1RlbXBsYXRlPW9ialJTKCJjYXRlX0xvZ1RlbXBsYXRlIikNCgkJCUZ1bGxVcmw9b2JqUlMoImNhdGVfRnVsbFVybCIpDQoJCQlNZXRhU3RyaW5nPW9ialJTKCJjYXRlX01ldGEiKQ0KCQkJTG9hZEluZm9CeUlEPVRydWUNCg0KCQlFbmQgSWYNCg0KCQlvYmpSUy5DbG9zZQ0KCQlTZXQgb2JqUlM9Tm90aGluZw0KCQkNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RDYXRlZ29yeV9Mb2FkSW5mb0J5SUQoSUQsTmFtZSxJbnRybyxPcmRlcixDb3VudCxQYXJlbnRJRCxBbGlhcyxUZW1wbGF0ZU5hbWUsTG9nVGVtcGxhdGUsRnVsbFVybCxNZXRhU3RyaW5nKQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCVB1YmxpYyBGdW5jdGlvbiBMb2FkSW5mb0J5QXJyYXkoYXJ5Q2F0ZUluZm8pDQoNCgkJSWYgSXNBcnJheShhcnlDYXRlSW5mbyk9VHJ1ZSBUaGVuDQoJCQlJRD1hcnlDYXRlSW5mbygwKQ0KCQkJTmFtZT1hcnlDYXRlSW5mbygxKQ0KCQkJSW50cm89YXJ5Q2F0ZUluZm8oMikNCgkJCU9yZGVyPWFyeUNhdGVJbmZvKDMpDQoJCQlDb3VudD1hcnlDYXRlSW5mbyg0KQ0KCQkJUGFyZW50SUQ9YXJ5Q2F0ZUluZm8oNSkNCgkJCUFsaWFzPWFyeUNhdGVJbmZvKDYpDQoJCQlUZW1wbGF0ZU5hbWU9YXJ5Q2F0ZUluZm8oNykNCgkJCUxvZ1RlbXBsYXRlPWFyeUNhdGVJbmZvKDgpDQoJCQlGdWxsVXJsPWFyeUNhdGVJbmZvKDkpDQoJCQlNZXRhU3RyaW5nPWFyeUNhdGVJbmZvKDEwKQ0KCQlFbmQgSWYNCg0KCQlMb2FkSW5mb0J5QXJyYXk9VHJ1ZQ0KCQkNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RDYXRlZ29yeV9Mb2FkSW5mb0J5QXJyYXkoSUQsTmFtZSxJbnRybyxPcmRlcixDb3VudCxQYXJlbnRJRCxBbGlhcyxUZW1wbGF0ZU5hbWUsTG9nVGVtcGxhdGUsRnVsbFVybCxNZXRhU3RyaW5nKQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCVB1YmxpYyBGdW5jdGlvbiBEZWwoKQ0KDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UQ2F0ZWdvcnlfRGVsKElELE5hbWUsSW50cm8sT3JkZXIsQ291bnQsUGFyZW50SUQsQWxpYXMsVGVtcGxhdGVOYW1lLExvZ1RlbXBsYXRlLEZ1bGxVcmwsTWV0YVN0cmluZykNCg0KCQlDYWxsIENoZWNrUGFyYW1ldGVyKElELCJpbnQiLDApDQoJCUlmIChJRD0wKSBUaGVuIERlbD1GYWxzZTpFeGl0IEZ1bmN0aW9uDQoJCURpbSBvYmpSUw0KCQlTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgW2xvZ19JRF0gRlJPTSBbYmxvZ19BcnRpY2xlXSBXSEVSRSBbbG9nX0NhdGVJRF09IiAmIElEKQ0KCQlJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuICBTaG93RXJyb3IoMTMpDQoNCgkJJ+S4jeiDveWIoOmZpOWQq+acieWtkOWIhuexu+eahOWIhuexuy4NCgkJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFtjYXRlX0lEXSBGUk9NIFtibG9nX0NhdGVnb3J5XSBXSEVSRSBbY2F0ZV9QYXJlbnRJRF09IiAmIElEKQ0KCQlJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuICBTaG93RXJyb3IoNDkpDQoNCgkJb2JqQ29ubi5FeGVjdXRlKCJERUxFVEUgRlJPTSBbYmxvZ19DYXRlZ29yeV0gV0hFUkUgW2NhdGVfSURdID0iICYgSUQpDQoNCgkJU2V0IG9ialJTPU5vdGhpbmcNCg0KCQlEZWw9VHJ1ZQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCglQcml2YXRlIFN1YiBDbGFzc19Jbml0aWFsaXplKCkNCgkJSUQ9MA0KCQlOYW1lPVpDX01TRzA1OQ0KCQlSZUNvdW50PTANCgkJT3JkZXI9MA0KCQlFeElEPS0xICfooajnpLrml6Dljp9JRO+8jOaWh+eroOWIhuexu+aXoOWPmOWMlg0KCQlTZXQgTWV0YT1OZXcgVE1ldGENCglFbmQgU3ViDQoNCkVuZCBDbGFzcw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICDlrprkuYlUQXJ0aWNsZeexuw0KJyDovpPlhaXvvJogICAg5pegDQonIOi/lOWbnu+8miAgICDml6ANCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkNsYXNzIFRBcnRpY2xlDQoNCglQdWJsaWMgSUQNCglQdWJsaWMgQ2F0ZUlEDQoJUHVibGljIEF1dGhvcklEDQoJUHVibGljIExldmVsDQoNCglQdWJsaWMgVGl0bGUNCglQdWJsaWMgSW50cm8NCglQdWJsaWMgQ29udGVudA0KCVB1YmxpYyBQb3N0VGltZQ0KDQoJUHVibGljIFRhZw0KCVB1YmxpYyBBbGlhcw0KDQoJUHVibGljIENvbW1OdW1zDQoJUHVibGljIFZpZXdOdW1zDQoJUHVibGljIFRyYWNrQmFja051bXMNCg0KCVByaXZhdGUgSVANCg0KCVB1YmxpYyBJc3RvcA0KCVB1YmxpYyBGdWxsVXJsDQoJUHVibGljIEZUeXBlDQoJUHVibGljIE1ldGENCglQdWJsaWMgVGVtcGxhdGVOYW1lDQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IE1ldGFTdHJpbmcNCgkJTWV0YVN0cmluZz1NZXRhLlNhdmVTdHJpbmcNCglFbmQgUHJvcGVydHkNCglQdWJsaWMgUHJvcGVydHkgTGV0IE1ldGFTdHJpbmcocykNCgkJTWV0YS5Mb2FkU3RyaW5nPXMNCglFbmQgUHJvcGVydHkNCg0KCVByaXZhdGUgVGVtcGxhdGVfQXJ0aWNsZV9UcmFja2JhY2sNCglQcml2YXRlIFRlbXBsYXRlX0FydGljbGVfQ29tbWVudA0KCVByaXZhdGUgVGVtcGxhdGVfQXJ0aWNsZV9Db21tZW50X1BhZ2ViYXINCglQcml2YXRlIFRlbXBsYXRlX0FydGljbGVfQ29tbWVudHBvc3QNCglQcml2YXRlIFRlbXBsYXRlX0FydGljbGVfVGFnDQoJUHJpdmF0ZSBUZW1wbGF0ZV9BcnRpY2xlX05hdmJhcl9MDQoJUHJpdmF0ZSBUZW1wbGF0ZV9BcnRpY2xlX05hdmJhcl9SDQoJUHJpdmF0ZSBUZW1wbGF0ZV9BcnRpY2xlX0NvbW1lbnRwb3N0X1ZlcmlmeQ0KCVByaXZhdGUgVGVtcGxhdGVfQXJ0aWNsZV9NdXR1YWxpdHkNCglQcml2YXRlIFRlbXBsYXRlX0NhbGVuZGFyDQoNCg0KCVByaXZhdGUgRGlzYWJsZV9FeHBvcnRfVGFnDQoJUHJpdmF0ZSBEaXNhYmxlX0V4cG9ydF9DTVRhbmRUQg0KCVByaXZhdGUgRGlzYWJsZV9FeHBvcnRfQ29tbWVudFBvc3QNCglQcml2YXRlIERpc2FibGVfRXhwb3J0X011dHVhbGl0eQ0KCVByaXZhdGUgRGlzYWJsZV9FeHBvcnRfTmF2QmFyDQoNCglQcml2YXRlIEhhc1RhZw0KCVByaXZhdGUgSGFzQ01UYW5kVEINCglQcml2YXRlIEhhc011dHVhbGl0eQ0KDQoJUHVibGljIGh0bWwNCglQdWJsaWMgc3ViaHRtbA0KCVB1YmxpYyBzdWJodG1sX1RlbXBsYXRlTmFtZQ0KDQoJUHVibGljIElzRHluYW1pY0xvYWRTaWxkYmFyDQoJUHVibGljIFNlYXJjaFRleHQNCglQdWJsaWMgQ29tbWVudHNQYWdlDQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IElzUGFnZQ0KCQlJZiBGVHlwZT0xIFRoZW4NCgkJCUlzUGFnZT1UcnVlDQoJCUVsc2UgDQoJCQlJc1BhZ2U9RmFsc2UNCgkJRW5kIElmDQoJRW5kIFByb3BlcnR5DQoNCglQcml2YXRlIEZ0ZW1wbGF0ZQ0KCVB1YmxpYyBQcm9wZXJ0eSBMZXQgVGVtcGxhdGUoc3RyRmlsZU5hbWUpDQoJCUZ0ZW1wbGF0ZT1HZXRUZW1wbGF0ZSgiVEVNUExBVEVfIiAmIHN0ckZpbGVOYW1lKQ0KCUVuZCBQcm9wZXJ0eQ0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgVGVtcGxhdGUNCgkJSWYgRnRlbXBsYXRlPD4iIiBUaGVuDQoJCQlUZW1wbGF0ZSA9IEZ0ZW1wbGF0ZQ0KCQkJRXhpdCBQcm9wZXJ0eQ0KCQlFbHNlDQoJCQlJZiBUZW1wbGF0ZU5hbWU8PiIiIFRoZW4NCgkJCQlEaW0gcw0KCQkJCXM9R2V0VGVtcGxhdGUoIlRFTVBMQVRFXyIgJlRlbXBsYXRlTmFtZSkNCgkJCQlJZiBzPD4iIiBUaGVuDQoJCQkJCUZ0ZW1wbGF0ZSA9IHMNCgkJCQkJVGVtcGxhdGUgPSBGdGVtcGxhdGUNCgkJCQkJRXhpdCBQcm9wZXJ0eQ0KCQkJCUVuZCBJZg0KCQkJRW5kIElmDQoJCQlJZiBJc1BhZ2U9RmFsc2UgQW5kIENhdGVnb3J5cyhDYXRlSUQpLkxvZ1RlbXBsYXRlPD4iIiBUaGVuDQoJCQkJRGltIHQNCgkJCQl0PUdldFRlbXBsYXRlKCJURU1QTEFURV8iICZDYXRlZ29yeXMoQ2F0ZUlEKS5Mb2dUZW1wbGF0ZSkNCgkJCQlJZiB0PD4iIiBUaGVuDQoJCQkJCUZ0ZW1wbGF0ZSA9IHQNCgkJCQkJVGVtcGxhdGUgPSBGdGVtcGxhdGUNCgkJCQkJRXhpdCBQcm9wZXJ0eQ0KCQkJCUVuZCBJZg0KCQkJRW5kIElmDQoJCQlJZiBJc1BhZ2U9VHJ1ZSBUaGVuDQoJCQkJRnRlbXBsYXRlPUdldFRlbXBsYXRlKCJURU1QTEFURV9QQUdFIikNCgkJCUVsc2UNCgkJCQlGdGVtcGxhdGU9R2V0VGVtcGxhdGUoIlRFTVBMQVRFX1NJTkdMRSIpDQoJCQlFbmQgSWYNCg0KCQkJVGVtcGxhdGUgPSBGdGVtcGxhdGUNCgkJRW5kIElmDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgRnVuY3Rpb24gR2V0RGVmYXVsdFRlbXBsYXRlTmFtZQ0KCQlJZiBUZW1wbGF0ZU5hbWU8PiIiIFRoZW4NCgkJCUdldERlZmF1bHRUZW1wbGF0ZU5hbWU9VGVtcGxhdGVOYW1lDQoJCUVsc2UNCgkJCUlmIElzUGFnZT1UcnVlIFRoZW4NCgkJCQlHZXREZWZhdWx0VGVtcGxhdGVOYW1lPSJQQUdFIg0KCQkJRWxzZQ0KCQkJCUlmIENhdGVnb3J5cyhDYXRlSUQpLkxvZ1RlbXBsYXRlPD4iIiBUaGVuDQoJCQkJCUdldERlZmF1bHRUZW1wbGF0ZU5hbWU9Q2F0ZWdvcnlzKENhdGVJRCkuTG9nVGVtcGxhdGUNCgkJCQlFbHNlDQoJCQkJCUdldERlZmF1bHRUZW1wbGF0ZU5hbWU9IlNJTkdMRSINCgkJCQlFbmQgSWYNCgkJCUVuZCBJZg0KCQlFbmQgSWYNCglFbmQgRnVuY3Rpb24NCg0KCVByaXZhdGUgRmZ1bGxyZWdleA0KCVB1YmxpYyBQcm9wZXJ0eSBMZXQgRnVsbFJlZ2V4KHMpDQoJCUZmdWxscmVnZXg9cw0KCUVuZCBQcm9wZXJ0eQ0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgRnVsbFJlZ2V4DQoJCUlmIEZmdWxscmVnZXg8PiIiIFRoZW4gDQoJCQlGdWxsUmVnZXg9RmZ1bGxyZWdleA0KCQlFbHNlDQoJCQlJZiBJc1BhZ2U9VHJ1ZSBUaGVuDQoJCQkJSWYgTGV2ZWw+MiBUaGVuDQoJCQkJCUZ1bGxSZWdleD1aQ19QQUdFX1JFR0VYDQoJCQkJRWxzZUlmIExldmVsPjEgVGhlbg0KCQkJCQlGdWxsUmVnZXg9WkNfUEFHRV9BTkRfQVJUSUNMRV9QUklWQVRFX1JFR0VYCQ0KCQkJCUVsc2UNCgkJCQkJRnVsbFJlZ2V4PVpDX1BBR0VfQU5EX0FSVElDTEVfRFJBRlRfUkVHRVgNCgkJCQlFbmQgSWYNCgkJCUVsc2UNCgkJCQlJZiBMZXZlbD4yIFRoZW4NCgkJCQkJRnVsbFJlZ2V4PVpDX0FSVElDTEVfUkVHRVgNCgkJCQlFbHNlSWYgTGV2ZWw+MSBUaGVuDQoJCQkJCUZ1bGxSZWdleD1aQ19QQUdFX0FORF9BUlRJQ0xFX1BSSVZBVEVfUkVHRVgJDQoJCQkJRWxzZQ0KCQkJCQlGdWxsUmVnZXg9WkNfUEFHRV9BTkRfQVJUSUNMRV9EUkFGVF9SRUdFWA0KCQkJCUVuZCBJZg0KCQkJRW5kIElmDQoJCUVuZCBJZg0KCUVuZCBQcm9wZXJ0eQ0KDQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IEZ1bGxQYXRoDQoJCUNhbGwgR2V0VXNlcnNieVVzZXJJRExpc3QoQXV0aG9ySUQpDQoJCUZ1bGxQYXRoPVBhcnNlQ3VzdG9tRGlyZWN0b3J5Rm9yUGF0aChGdWxsUmVnZXgsWkNfU1RBVElDX0RJUkVDVE9SWSxDYXRlZ29yeXMoQ2F0ZUlEKS5TdGF0aWNOYW1lLFVzZXJzKEF1dGhvcklEKS5TdGF0aWNOYW1lLFllYXIoUG9zdFRpbWUpLE1vbnRoKFBvc3RUaW1lKSxEYXkoUG9zdFRpbWUpLElELFN0YXRpY05hbWUsU3RhdGljTmFtZSkNCglFbmQgUHJvcGVydHkNCg0KDQoJUHJpdmF0ZSBGVXJsDQoJUHVibGljIFByb3BlcnR5IEdldCBVcmwNCg0KCQlJZiBGVXJsPD4iIiBUaGVuIA0KCQkJVXJsPUZVcmwNCgkJRWxzZQ0KDQoJCQkncGx1Z2luIG5vZGUNCgkJCWJBY3Rpb25fUGx1Z2luX1RBcnRpY2xlX1VybD1GYWxzZQ0KCQkJRm9yIEVhY2ggc0FjdGlvbl9QbHVnaW5fVEFydGljbGVfVXJsIGluIEFjdGlvbl9QbHVnaW5fVEFydGljbGVfVXJsDQoJCQkJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fVEFydGljbGVfVXJsKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9VcmwpDQoJCQkJSWYgYkFjdGlvbl9QbHVnaW5fVEFydGljbGVfVXJsPVRydWUgVGhlbiBFeGl0IFByb3BlcnR5DQoJCQlOZXh0DQoNCgkJCUNhbGwgR2V0VXNlcnNieVVzZXJJRExpc3QoQXV0aG9ySUQpDQoJCQlGVXJsID1QYXJzZUN1c3RvbURpcmVjdG9yeUZvclVybChGdWxsUmVnZXgsWkNfU1RBVElDX0RJUkVDVE9SWSxDYXRlZ29yeXMoQ2F0ZUlEKS5TdGF0aWNOYW1lLFVzZXJzKEF1dGhvcklEKS5TdGF0aWNOYW1lLFllYXIoUG9zdFRpbWUpLE1vbnRoKFBvc3RUaW1lKSxEYXkoUG9zdFRpbWUpLElELFN0YXRpY05hbWUsU3RhdGljTmFtZSkNCgkJCUlmIFJpZ2h0KEZVcmwsMTIpPSJkZWZhdWx0Lmh0bWwiIFRoZW4gRlVybD1MZWZ0KEZVcmwsTGVuKEZVcmwpLTEyKQ0KCQkJJ0lmIFJpZ2h0KFVybCwxMCk9ImluZGV4Lmh0bWwiIFRoZW4gVXJsPUxlZnQoVXJsLExlbihVcmwpLTEwKQ0KDQoJCQlGVXJsPVJlcGxhY2UoUmVwbGFjZShGVXJsLCIvLyIsIi8iKSwiOi8iLCI6Ly8iLDEsMSkNCg0KCQkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RBcnRpY2xlX1VybChGVXJsKQ0KCQkJVXJsPUZVcmwNCg0KCQlFbmQgSWYNCg0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBTdGF0aWNOYW1lDQoJCUlmIElzTnVsbChBbGlhcykgT3IgSXNFbXB0eShBbGlhcykgT3IgQWxpYXM9IiIgVGhlbg0KCQkJU3RhdGljTmFtZSA9IElEDQoJCUVsc2UNCgkJCVN0YXRpY05hbWUgPSBBbGlhcw0KCQlFbmQgSWYNCglFbmQgUHJvcGVydHkNCg0KCVByaXZhdGUgRlRyYWNrQmFja0tleQ0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgVHJhY2tCYWNrS2V5DQoJCUlmIElzTnVsbChGVHJhY2tCYWNrS2V5KSBPciBJc0VtcHR5KEZUcmFja0JhY2tLZXkpIE9yIEZUcmFja0JhY2tLZXk9IiIgVGhlbg0KCQkJJ0ZUcmFja0JhY2tLZXk9TGVmdChNRDUoWkNfQkxPR19DTFNJRCAmIENTdHIoSUQpICYgQ1N0cihUcmFja0JhY2tOdW1zKSksOCkNCgkJCUZUcmFja0JhY2tLZXk9RW1wdHkNCgkJRW5kIElmDQoJCVRyYWNrQmFja0tleT1GVHJhY2tCYWNrS2V5DQoJRW5kIFByb3BlcnR5DQoNCglQcml2YXRlIEZDb21tZW50S2V5DQoJUHVibGljIFByb3BlcnR5IEdldCBDb21tZW50S2V5DQoJCUlmIElzTnVsbChGQ29tbWVudEtleSkgT3IgSXNFbXB0eShGQ29tbWVudEtleSkgT3IgRkNvbW1lbnRLZXk9IiIgVGhlbg0KCQkJRkNvbW1lbnRLZXk9TGVmdChNRDUoWkNfQkxPR19DTFNJRCAmIENTdHIoSUQpKSw4KQ0KCQlFbmQgSWYNCgkJQ29tbWVudEtleT1GQ29tbWVudEtleQ0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBUcmFja0JhY2sNCgkJVHJhY2tCYWNrID0gQmxvZ0hvc3QgJiAiemJfc3lzdGVtL2NtZC5hc3A/YWN0PXRiJmlkPSImIElEICYiJmtleT0iICYgVHJhY2tCYWNrS2V5DQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IFByZVRyYWNrQmFjaw0KCQlQcmVUcmFja0JhY2sgPSBCbG9nSG9zdCAmICJ6Yl9zeXN0ZW0vY21kLmFzcD9hY3Q9Z2V0dGJ1cmwmaWQ9IiAmIElEDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IFRyYWNrQmFja1VybA0KCQlUcmFja0JhY2tVcmwgPSBUcmFja0JhY2sNCglFbmQgUHJvcGVydHkNCg0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgQ29tbWVudFVybA0KCQlDb21tZW50VXJsID0gVXJsICYgIiNjb21tZW50Ig0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBXZndDb21tZW50DQoJCVdmd0NvbW1lbnQgPSBCbG9nSG9zdA0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBXZndDb21tZW50UnNzDQoJCVdmd0NvbW1lbnRSc3MgPSBCbG9nSG9zdCAmICJmZWVkLmFzcD9jbXQ9IiAmIElEDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IFdBUFVybA0KCQlXQVBVcmwgPSBCbG9nSG9zdCAmICJ3YXAuYXNwP2FjdD1WaWV3JmlkPSIgJiBJRA0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBIdG1sV0FQVXJsDQoJCUh0bWxXQVBVcmw9VHJhbnNmZXJIVE1MKFdBUFVybCwiW2h0bWwtZm9ybWF0XSIpDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IENvbW1lbnRQb3N0VXJsDQoJCUNvbW1lbnRQb3N0VXJsID0gQmxvZ0hvc3QgJiAiemJfc3lzdGVtL2NtZC5hc3A/YWN0PWNtdCZrZXk9IiAmIENvbW1lbnRLZXkNCglFbmQgUHJvcGVydHkNCg0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgSHRtbENvbnRlbnQNCgkJSHRtbENvbnRlbnQ9VHJhbnNmZXJIVE1MKFVCQkNvZGUoQ29udGVudCwiW2ZhY2VdW2xpbmtdW2VtYWlsXVthdXRvbGlua11bZm9udF1bY29kZV1baW1hZ2VdW3R5cGVzZXRdW21lZGlhXVtmbGFzaF1ba2V5XSIpLCJbaHRtbC1qYXBhbl1bdXBsb2FkXSIpDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IEh0bWxUaXRsZQ0KCQlIdG1sVGl0bGU9VHJhbnNmZXJIVE1MKFRpdGxlLCJbaHRtbC1qYXBhbl1baHRtbC1mb3JtYXRdIikNCglFbmQgUHJvcGVydHkNCg0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgSHRtbEludHJvDQoJCUh0bWxJbnRybz1UcmFuc2ZlckhUTUwoVUJCQ29kZShJbnRybywiW2ZhY2VdW2xpbmtdW2VtYWlsXVthdXRvbGlua11bZm9udF1bY29kZV1baW1hZ2VdW3R5cGVzZXRdW21lZGlhXVtmbGFzaF1ba2V5XSIpLCJbaHRtbC1qYXBhbl1bdXBsb2FkXSIpDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IEh0bWxVcmwNCgkJSHRtbFVybD1UcmFuc2ZlckhUTUwoVHJhbnNmZXJIVE1MKFVybCwiW3pjX2Jsb2dfaG9zdF0iKSwiW2h0bWwtZm9ybWF0XSIpDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IFRhZ1RvTmFtZQ0KDQoJCURpbSB0LGkscw0KDQoJCUlmIFRhZzw+IiIgVGhlbg0KCQkJQ2FsbCBHZXRUYWdzYnlUYWdJRExpc3QoVGFnKQ0KCQkJcz1UYWcNCgkJCXM9UmVwbGFjZShzLCJ9IiwiIikNCgkJCXQ9U3BsaXQocywieyIpDQoNCgkJCUZvciBpPUxCb3VuZCh0KSBUbyBVQm91bmQodCkNCgkJCQlJZiB0KGkpPD4iIiBUaGVuDQoJCQkJCUlmIElzRW1wdHkoRmlyc3RUYWdJbnRybykgVGhlbiBGaXJzdFRhZ0ludHJvPVRhZ3ModChpKSkuSW50cm8NCgkJCQkJdChpKT1UYWdzKHQoaSkpLk5hbWUNCgkJCQlFbmQgSWYNCgkJCU5leHQNCg0KCQkJcz1Kb2luKHQsIiwiKQ0KCQkJcz1SaWdodChzLExlbihzKS0xKQ0KDQoJCQlUYWdUb05hbWU9cw0KCQlFbmQgSWYNCg0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIEZpcnN0VGFnSW50cm8NCg0KDQoNCglQdWJsaWMgRnVuY3Rpb24gTG9hZEluZm9ieUlEKGxvZ19JRCkNCg0KCQlDYWxsIENoZWNrUGFyYW1ldGVyKGxvZ19JRCwiaW50IiwwKQ0KDQoJCURpbSBvYmpSUw0KCQlTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgW2xvZ19JRF0sW2xvZ19UYWddLFtsb2dfQ2F0ZUlEXSxbbG9nX1RpdGxlXSxbbG9nX0ludHJvXSxbbG9nX0NvbnRlbnRdLFtsb2dfTGV2ZWxdLFtsb2dfQXV0aG9ySURdLFtsb2dfUG9zdFRpbWVdLFtsb2dfQ29tbU51bXNdLFtsb2dfVmlld051bXNdLFtsb2dfVHJhY2tCYWNrTnVtc10sW2xvZ19VcmxdLFtsb2dfSXN0b3BdLFtsb2dfVGVtcGxhdGVdLFtsb2dfRnVsbFVybF0sW2xvZ19UeXBlXSxbbG9nX01ldGFdIEZST00gW2Jsb2dfQXJ0aWNsZV0gV0hFUkUgW2xvZ19JRF09IiAmIGxvZ19JRCkNCg0KCQlJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoNCgkJCUlEPW9ialJTKCJsb2dfSUQiKQ0KCQkJVGFnPW9ialJTKCJsb2dfVGFnIikNCgkJCUNhdGVJRD1vYmpSUygibG9nX0NhdGVJRCIpDQoJCQlUaXRsZT1vYmpSUygibG9nX1RpdGxlIikNCgkJCUludHJvPW9ialJTKCJsb2dfSW50cm8iKQ0KCQkJQ29udGVudD1vYmpSUygibG9nX0NvbnRlbnQiKQ0KCQkJTGV2ZWw9b2JqUlMoImxvZ19MZXZlbCIpDQoJCQlBdXRob3JJRD1vYmpSUygibG9nX0F1dGhvcklEIikNCgkJCVBvc3RUaW1lPW9ialJTKCJsb2dfUG9zdFRpbWUiKQ0KCQkJQ29tbU51bXM9b2JqUlMoImxvZ19Db21tTnVtcyIpDQoJCQlWaWV3TnVtcz1vYmpSUygibG9nX1ZpZXdOdW1zIikNCgkJCVRyYWNrQmFja051bXM9b2JqUlMoImxvZ19UcmFja0JhY2tOdW1zIikNCgkJCUFsaWFzPW9ialJTKCJsb2dfVXJsIikNCgkJCUlzdG9wPW9ialJTKCJsb2dfSXN0b3AiKQ0KCQkJVGVtcGxhdGVOYW1lPW9ialJTKCJsb2dfVGVtcGxhdGUiKQ0KCQkJRnVsbFVybD1vYmpSUygibG9nX0Z1bGxVcmwiKQ0KCQkJRlR5cGU9b2JqUlMoImxvZ19UeXBlIikNCgkJCU1ldGFTdHJpbmc9b2JqUlMoImxvZ19NZXRhIikNCg0KCQkJQ29udGVudD1UcmFuc2ZlckhUTUwoQ29udGVudCwiW3VwbG9hZF1bemNfYmxvZ19ob3N0XSIpDQoJCQlJbnRybz1UcmFuc2ZlckhUTUwoSW50cm8sIlt1cGxvYWRdW3pjX2Jsb2dfaG9zdF0iKQ0KDQoJCQlJZiBaQ19QT1NUX1NUQVRJQ19NT0RFPD4iU1RBVElDIiBUaGVuIEZ1bGxVcmw9UmVwbGFjZShVcmwsQmxvZ0hvc3QsIjwjWkNfQkxPR19IT1NUIz4iKQ0KDQoJCQlQb3N0VGltZSA9IFllYXIoUG9zdFRpbWUpICYgIi0iICYgTW9udGgoUG9zdFRpbWUpICYgIi0iICYgRGF5KFBvc3RUaW1lKSAmICIgIiAmIEhvdXIoUG9zdFRpbWUpICYgIjoiICYgTWludXRlKFBvc3RUaW1lKSAmICI6IiAmIFNlY29uZChQb3N0VGltZSkNCg0KCQlFbHNlDQoJCQlFeGl0IEZ1bmN0aW9uDQoJCUVuZCBJZg0KDQoJCW9ialJTLkNsb3NlDQoJCVNldCBvYmpSUz1Ob3RoaW5nDQoNCgkJRlVybD0iIg0KDQoJCUxvYWRJbmZvYnlJRD1UcnVlDQoNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RBcnRpY2xlX0xvYWRJbmZvYnlJRChJRCxUYWcsQ2F0ZUlELFRpdGxlLEludHJvLENvbnRlbnQsTGV2ZWwsQXV0aG9ySUQsUG9zdFRpbWUsQ29tbU51bXMsVmlld051bXMsVHJhY2tCYWNrTnVtcyxBbGlhcyxJc3RvcCxUZW1wbGF0ZU5hbWUsRnVsbFVybCxGVHlwZSxNZXRhU3RyaW5nKQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KDQoJUHVibGljIEZ1bmN0aW9uIExvYWRJbmZvQnlBcnJheShhcnlBcnRpY2xlSW5mbykNCg0KCQknW2xvZ19JRF0sW2xvZ19UYWddLFtsb2dfQ2F0ZUlEXSxbbG9nX1RpdGxlXSxbbG9nX0ludHJvXSxbbG9nX0NvbnRlbnRdLFtsb2dfTGV2ZWxdLFtsb2dfQXV0aG9ySURdLFtsb2dfUG9zdFRpbWVdLFtsb2dfQ29tbU51bXNdLFtsb2dfVmlld051bXNdLFtsb2dfVHJhY2tCYWNrTnVtc10sW2xvZ19VcmxdLFtsb2dfSXN0b3BdLFtsb2dfVGVtcGxhdGVdLFtsb2dfRnVsbFVybF0sW2xvZ19UeXBlXSxbbG9nX01ldGFdDQoNCgkJSWYgSXNBcnJheShhcnlBcnRpY2xlSW5mbyk9VHJ1ZSBUaGVuDQoNCgkJCUlEPWFyeUFydGljbGVJbmZvKDApDQoJCQlUYWc9YXJ5QXJ0aWNsZUluZm8oMSkNCgkJCUNhdGVJRD1hcnlBcnRpY2xlSW5mbygyKQ0KCQkJVGl0bGU9YXJ5QXJ0aWNsZUluZm8oMykNCgkJCUludHJvPWFyeUFydGljbGVJbmZvKDQpDQoJCQlDb250ZW50PWFyeUFydGljbGVJbmZvKDUpDQoJCQlMZXZlbD1hcnlBcnRpY2xlSW5mbyg2KQ0KCQkJQXV0aG9ySUQ9YXJ5QXJ0aWNsZUluZm8oNykNCgkJCVBvc3RUaW1lPWFyeUFydGljbGVJbmZvKDgpDQoJCQlDb21tTnVtcz1hcnlBcnRpY2xlSW5mbyg5KQ0KCQkJVmlld051bXM9YXJ5QXJ0aWNsZUluZm8oMTApDQoJCQlUcmFja0JhY2tOdW1zPWFyeUFydGljbGVJbmZvKDExKQ0KCQkJQWxpYXM9YXJ5QXJ0aWNsZUluZm8oMTIpDQoJCQlJc3RvcD1hcnlBcnRpY2xlSW5mbygxMykNCgkJCVRlbXBsYXRlTmFtZT1hcnlBcnRpY2xlSW5mbygxNCkNCgkJCUZ1bGxVcmw9YXJ5QXJ0aWNsZUluZm8oMTUpDQoJCQlGVHlwZT1hcnlBcnRpY2xlSW5mbygxNikNCgkJCU1ldGFTdHJpbmc9YXJ5QXJ0aWNsZUluZm8oMTcpDQoNCgkJCUNvbnRlbnQ9VHJhbnNmZXJIVE1MKENvbnRlbnQsIlt1cGxvYWRdW3pjX2Jsb2dfaG9zdF0iKQ0KCQkJSW50cm89VHJhbnNmZXJIVE1MKEludHJvLCJbdXBsb2FkXVt6Y19ibG9nX2hvc3RdIikNCg0KCQkJUG9zdFRpbWUgPSBZZWFyKFBvc3RUaW1lKSAmICItIiAmIE1vbnRoKFBvc3RUaW1lKSAmICItIiAmIERheShQb3N0VGltZSkgJiAiICIgJiBIb3VyKFBvc3RUaW1lKSAmICI6IiAmIE1pbnV0ZShQb3N0VGltZSkgJiAiOiIgJiBTZWNvbmQoUG9zdFRpbWUpDQoNCgkJCUlmIFpDX1BPU1RfU1RBVElDX01PREU8PiJTVEFUSUMiIFRoZW4gRnVsbFVybD1SZXBsYWNlKFVybCxCbG9nSG9zdCwiPCNaQ19CTE9HX0hPU1QjPiIpDQoNCgkJRW5kIElmDQoNCgkJRlVybD0iIg0KCQkNCgkJTG9hZEluZm9CeUFycmF5PVRydWUNCg0KCQlDYWxsIEZpbHRlcl9QbHVnaW5fVEFydGljbGVfTG9hZEluZm9CeUFycmF5KElELFRhZyxDYXRlSUQsVGl0bGUsSW50cm8sQ29udGVudCxMZXZlbCxBdXRob3JJRCxQb3N0VGltZSxDb21tTnVtcyxWaWV3TnVtcyxUcmFja0JhY2tOdW1zLEFsaWFzLElzdG9wLFRlbXBsYXRlTmFtZSxGdWxsVXJsLEZUeXBlLE1ldGFTdHJpbmcpDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoNCglQdWJsaWMgRnVuY3Rpb24gUG9zdCgpDQoNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RBcnRpY2xlX1Bvc3QoSUQsVGFnLENhdGVJRCxUaXRsZSxJbnRybyxDb250ZW50LExldmVsLEF1dGhvcklELFBvc3RUaW1lLENvbW1OdW1zLFZpZXdOdW1zLFRyYWNrQmFja051bXMsQWxpYXMsSXN0b3AsVGVtcGxhdGVOYW1lLEZ1bGxVcmwsRlR5cGUsTWV0YVN0cmluZykNCg0KCQlDYWxsIENoZWNrUGFyYW1ldGVyKElELCJpbnQiLDApDQoJCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoQ2F0ZUlELCJpbnQiLDApDQoJCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoQXV0aG9ySUQsImludCIsMCkNCgkJQ2FsbCBDaGVja1BhcmFtZXRlcihMZXZlbCwiaW50IiwwKQ0KCQlDYWxsIENoZWNrUGFyYW1ldGVyKFBvc3RUaW1lLCJkdG0iLEVtcHR5KQ0KCQlDYWxsIENoZWNrUGFyYW1ldGVyKElzdG9wLCJib29sIixGYWxzZSkNCg0KCQknSUTlj6/ku6XkuLowDQoJCSdJZiAoQ2F0ZUlEPTApIFRoZW4gUG9zdD1GYWxzZTpFeGl0IEZ1bmN0aW9uDQoJCUlmIChBdXRob3JJRD0wKSBUaGVuIFBvc3Q9RmFsc2U6RXhpdCBGdW5jdGlvbg0KCQlJZiBJc0VtcHR5KFBvc3RUaW1lKSBUaGVuIFBvc3Q9RmFsc2U6RXhpdCBGdW5jdGlvbg0KDQoJCURpbSBzVGl0bGUsc0ludHJvLHNDb250ZW50DQoJCXNUaXRsZT1UaXRsZQ0KCQlzSW50cm89Q29udGVudA0KCQlzQ29udGVudD1Db250ZW50DQoJCVRpdGxlPUZpbHRlclNRTChUaXRsZSkNCgkJSW50cm89RmlsdGVyU1FMKEludHJvKQ0KCQlDb250ZW50PUZpbHRlclNRTChDb250ZW50KQ0KCQlUYWc9RmlsdGVyU1FMKFRhZykNCgkJSVA9RmlsdGVyU1FMKElQKQ0KDQoJCVRpdGxlPVRyYW5zZmVySFRNTChUaXRsZSwiW2phcGFuLWh0bWxdIikNCgkJSW50cm89VHJhbnNmZXJIVE1MKEludHJvLCJbamFwYW4taHRtbF0iKQ0KCQlDb250ZW50PVRyYW5zZmVySFRNTChDb250ZW50LCJbamFwYW4taHRtbF0iKQ0KDQoJCUludHJvPVRyYW5zZmVySFRNTChJbnRybywiW2FudGktdXBsb2FkXSIpDQoJCUNvbnRlbnQ9VHJhbnNmZXJIVE1MKENvbnRlbnQsIlthbnRpLXVwbG9hZF0iKQ0KDQoJCSflhYjov5vooYwiW2FudGktdXBsb2FkXSLvvIzlho3mm7/mjaI8I1pDX0JMT0dfSE9TVCM+DQoJCUludHJvPVRyYW5zZmVySFRNTChJbnRybywiW2FudGktemNfYmxvZ19ob3N0XSIpDQoJCUNvbnRlbnQ9VHJhbnNmZXJIVE1MKENvbnRlbnQsIlthbnRpLXpjX2Jsb2dfaG9zdF0iKQ0KDQoJCUFsaWFzPVRyYW5zZmVySFRNTChBbGlhcywiW2RpcmVjdG9yeSZmaWxlXSIpDQoJCUlmIExlZnQoQWxpYXMsMSk9Ii8iIFRoZW4gQWxpYXM9UmlnaHQoQWxpYXMsTGVuKEFsaWFzKS0xKQ0KCQlJZiBSaWdodChBbGlhcywxKT0iLyIgVGhlbiBBbGlhcz1MZWZ0KEFsaWFzLExlbihBbGlhcyktMSkNCgkJQWxpYXM9RmlsdGVyU1FMKEFsaWFzKQ0KDQoJCUNhbGwgR2V0VXNlcnNieVVzZXJJRExpc3QoQXV0aG9ySUQpDQoNCgkJJ+ajgOafpeKAnOWIq+WQjeKAneaYr+WQpuaciemHjeWQjQ0KCQlJZiBBbGlhczw+IiIgVGhlbg0KCQkJRGltIG9ialJTc3ViDQoJCQlTZXQgb2JqUlNzdWI9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgW2xvZ19JRF0gRlJPTSBbYmxvZ19BcnRpY2xlXSBXSEVSRSBbbG9nX0lEXTw+IiYgSUQgJiIgQU5EIFtsb2dfVXJsXT0nIiYgQWxpYXMgJiInIiApDQoJCQlJZiAoTm90IG9ialJTc3ViLmJvZikgQW5kIChOb3Qgb2JqUlNzdWIuZW9mKSBUaGVuDQoJCQkJUmFuZG9taXplDQoJCQkJQWxpYXM9QWxpYXMgJiAiXyIgJiBDU3RyKEludCgoOSAqIFJuZCkgKyAxKSkgJiBDU3RyKEludCgoOSAqIFJuZCkgKyAxKSkgJiBDU3RyKEludCgoOSAqIFJuZCkgKyAxKSkgJiBDU3RyKEludCgoOSAqIFJuZCkgKyAxKSkNCgkJCUVuZCBJZg0KCQkJU2V0IG9ialJTc3ViPU5vdGhpbmcNCgkJRW5kIElmDQoNCg0KCQlJZiBMZW4oVGl0bGUpPTAgVGhlbiBQb3N0PUZhbHNlOkV4aXQgRnVuY3Rpb24NCgkJSWYgTGVuKENvbnRlbnQpPTAgVGhlbiBQb3N0PUZhbHNlOkV4aXQgRnVuY3Rpb24NCgkJJ0lmIExlbihJbnRybyk9MCBUaGVuIEludHJvPUxlZnQoQ29udGVudCxaQ19BUlRJQ0xFX0VYQ0VSUFRfTUFYKSAmICIuLi4iDQoNCgkJVGVtcGxhdGVOYW1lPVVDYXNlKEZpbHRlclNRTChUZW1wbGF0ZU5hbWUpKQ0KDQoJCUlmIElzUGFnZT1GYWxzZSBUaGVuDQoJCQlJZiBDYXRlZ29yeXMoQ2F0ZUlEKS5Mb2dUZW1wbGF0ZTw+IiIgVGhlbg0KCQkJCUlmIFRlbXBsYXRlTmFtZT1DYXRlZ29yeXMoQ2F0ZUlEKS5Mb2dUZW1wbGF0ZSBUaGVuIFRlbXBsYXRlTmFtZT0iIg0KCQkJRWxzZQ0KCQkJCUlmIFRlbXBsYXRlTmFtZT0iU0lOR0xFIiBUaGVuIFRlbXBsYXRlTmFtZT0iIg0KCQkJRW5kIElmDQoJCUVsc2UNCgkJCUlmIFRlbXBsYXRlTmFtZT0iUEFHRSIgVGhlbiBUZW1wbGF0ZU5hbWU9IiINCgkJRW5kIElmDQoNCgkJRGltIG9ialJTDQoJCUlmIElEPTAgVGhlbg0KCQkJb2JqQ29ubi5FeGVjdXRlKCJJTlNFUlQgSU5UTyBbYmxvZ19BcnRpY2xlXShbbG9nX0NhdGVJRF0sW2xvZ19BdXRob3JJRF0sW2xvZ19MZXZlbF0sW2xvZ19UaXRsZV0sW2xvZ19JbnRyb10sW2xvZ19Db250ZW50XSxbbG9nX1Bvc3RUaW1lXSxbbG9nX0lQXSxbbG9nX1RhZ10sW2xvZ19VcmxdLFtsb2dfSXN0b3BdLFtsb2dfVGVtcGxhdGVdLFtsb2dfRnVsbFVybF0sW2xvZ19WaWV3TnVtc10sW2xvZ19UeXBlXSxbbG9nX01ldGFdKSBWQUxVRVMgKCImQ2F0ZUlEJiIsIiZBdXRob3JJRCYiLCImTGV2ZWwmIiwnIiZUaXRsZSYiJywnIiZJbnRybyYiJywnIiZDb250ZW50JiInLCciJlBvc3RUaW1lJiInLCciJklQJiInLCciJlRhZyYiJywnIiZBbGlhcyYiJywiJkNMbmcoSXN0b3ApJiIsJyImVGVtcGxhdGVOYW1lJiInLCciJkZ1bGxVcmwmIicsMCwiJkNMbmcoRlR5cGUpJiIsJyImTWV0YVN0cmluZyYiJykiKQ0KCQkJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIE1BWChbbG9nX0lEXSkgRlJPTSBbYmxvZ19BcnRpY2xlXSIpDQoJCQlJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoJCQkJSUQ9b2JqUlMoMCkNCgkJCUVuZCBJZg0KCQkJU2V0IG9ialJTPU5vdGhpbmcNCg0KCQkJJ0Z1bGxVcmw9UmVwbGFjZShVcmwsQmxvZ0hvc3QsIjwjWkNfQkxPR19IT1NUIz4iKQ0KCQkJJ29iakNvbm4uRXhlY3V0ZSgiVVBEQVRFIFtibG9nX0FydGljbGVdIFNFVCBbbG9nX0Z1bGxVcmxdPSciJkZ1bGxVcmwmIicgV0hFUkUgW2xvZ19JRF0gPSIgJiBJRCkNCgkJRWxzZQ0KCQkJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFtsb2dfQ2F0ZUlEXSxbbG9nX0F1dGhvcklEXSBGUk9NIFtibG9nX0FydGljbGVdIFdIRVJFIFtsb2dfSURdID0iICYgSUQpDQoJCQlJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoJCQkJSWYgb2JqUlMoMCk8PkNhdGVJRCBUaGVuDQoJCQkJCUNhdGVnb3J5cyhDYXRlSUQpLkV4SUQ9b2JqUlMoMCkNCgkJCQlFbmQgSWYgDQoJCQkJSWYgb2JqUlMoMSk8PkF1dGhvcklEIFRoZW4NCgkJCQkJVXNlcnMoQXV0aG9ySUQpLkV4SUQ9b2JqUlMoMSkNCgkJCQlFbmQgSWYgDQoJCQlFbmQgSWYNCgkJCVNldCBvYmpSUz1Ob3RoaW5nDQoNCgkJCSdGdWxsVXJsPVJlcGxhY2UoVXJsLEJsb2dIb3N0LCI8I1pDX0JMT0dfSE9TVCM+IikNCg0KCQkJb2JqQ29ubi5FeGVjdXRlKCJVUERBVEUgW2Jsb2dfQXJ0aWNsZV0gU0VUIFtsb2dfQ2F0ZUlEXT0iJkNhdGVJRCYiLFtsb2dfQXV0aG9ySURdPSImQXV0aG9ySUQmIixbbG9nX0xldmVsXT0iJkxldmVsJiIsW2xvZ19UaXRsZV09JyImVGl0bGUmIicsW2xvZ19JbnRyb109JyImSW50cm8mIicsW2xvZ19Db250ZW50XT0nIiZDb250ZW50JiInLFtsb2dfUG9zdFRpbWVdPSciJlBvc3RUaW1lJiInLFtsb2dfSVBdPSciJklQJiInLFtsb2dfVGFnXT0nIiZUYWcmIicsW2xvZ19VcmxdPSciJkFsaWFzJiInLFtsb2dfSXN0b3BdPSImQ0xuZyhJc3RvcCkmIixbbG9nX1RlbXBsYXRlXT0nIiZUZW1wbGF0ZU5hbWUmIicsW2xvZ19GdWxsVXJsXT0nIiZGdWxsVXJsJiInLFtsb2dfVHlwZV09IiZDTG5nKEZUeXBlKSYiLFtsb2dfTWV0YV09JyImTWV0YVN0cmluZyYiJyBXSEVSRSBbbG9nX0lEXSA9IiAmIElEKQ0KCQlFbmQgSWYNCg0KCQlUaXRsZT1zVGl0bGUNCgkJQ29udGVudD1zSW50cm8NCgkJQ29udGVudD1zQ29udGVudA0KDQoJCVBvc3Q9VHJ1ZQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KDQoJUHVibGljIEZ1bmN0aW9uIEV4cG9ydF9UYWcNCg0KCQlJZiBEaXNhYmxlX0V4cG9ydF9UYWc9VHJ1ZSBUaGVuIEV4aXQgRnVuY3Rpb24NCg0KCQkncGx1Z2luIG5vZGUNCgkJYkFjdGlvbl9QbHVnaW5fVEFydGljbGVfRXhwb3J0X1RhZ19CZWdpbj1GYWxzZQ0KCQlGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfVGFnX0JlZ2luIGluIEFjdGlvbl9QbHVnaW5fVEFydGljbGVfRXhwb3J0X1RhZ19CZWdpbg0KCQkJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fVEFydGljbGVfRXhwb3J0X1RhZ19CZWdpbikgVGhlbiBDYWxsIEV4ZWN1dGUoc0FjdGlvbl9QbHVnaW5fVEFydGljbGVfRXhwb3J0X1RhZ19CZWdpbikNCgkJCUlmIGJBY3Rpb25fUGx1Z2luX1RBcnRpY2xlX0V4cG9ydF9UYWdfQmVnaW49VHJ1ZSBUaGVuIEV4aXQgRnVuY3Rpb24NCgkJTmV4dA0KDQoJCUNhbGwgR2V0VGFnc2J5VGFnSURMaXN0KFRhZykNCg0KCQknVGFnDQoJCURpbSB0LGkscyxqDQoNCgkJSWYgVGFnPD4iIiBUaGVuDQoNCgkJCUhhc1RhZz1UcnVlDQoNCgkJCXM9UmVwbGFjZShUYWcsIn0iLCIiKQ0KCQkJdD1TcGxpdChzLCJ7IikNCgkJCUZvciBpPUxCb3VuZCh0KSBUbyBVQm91bmQodCkNCgkJCQlJZiB0KGkpPD4iIiBUaGVuDQoNCgkJCQkJSWYgSXNPYmplY3QoVGFncyh0KGkpKSk9VHJ1ZSBUaGVuDQoJCQkJCQlqPUdldFRlbXBsYXRlKCJURU1QTEFURV9CX0FSVElDTEVfVEFHIikNCg0KCQkJCQkJVGVtcGxhdGVfQXJ0aWNsZV9UYWc9VGVtcGxhdGVfQXJ0aWNsZV9UYWcgJiBUYWdzKHQoaSkpLk1ha2VUZW1wbGF0ZShqKQ0KCQkJCQlFbmQgSWYNCgkJCQlFbmQgSWYNCgkJCU5leHQNCg0KCQlFbmQgSWYNCg0KCQlUZW1wbGF0ZV9BcnRpY2xlX1RhZz1UcmFuc2ZlckhUTUwoVGVtcGxhdGVfQXJ0aWNsZV9UYWcsIlthbnRpLXpjX2Jsb2dfaG9zdF0iKQ0KDQoJCUV4cG9ydF9UYWc9VHJ1ZQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KDQoNCglGdW5jdGlvbiBFeHBvcnRfQ01UYW5kVEIoaW50UGFnZSkNCg0KCQlJZiBEaXNhYmxlX0V4cG9ydF9DTVRhbmRUQj1UcnVlIFRoZW4gRXhpdCBGdW5jdGlvbg0KDQoJCUlmIFpDX0NPTU1FTlRfVFVSTk9GRj1UcnVlIFRoZW4gDQoJCQlUZW1wbGF0ZV9BcnRpY2xlX0NvbW1lbnQ9IiINCgkJCUV4aXQgRnVuY3Rpb24NCgkJRW5kIElmDQoNCgkJQ2FsbCBDaGVja1BhcmFtZXRlcihpbnRQYWdlLCJpbnQiLDEpDQoNCgkJJ3BsdWdpbiBub2RlDQoJCWJBY3Rpb25fUGx1Z2luX1RBcnRpY2xlX0V4cG9ydF9DTVRhbmRUQl9CZWdpbj1GYWxzZQ0KCQlGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfQ01UYW5kVEJfQmVnaW4gaW4gQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfQ01UYW5kVEJfQmVnaW4NCgkJCUlmIE5vdCBJc0VtcHR5KHNBY3Rpb25fUGx1Z2luX1RBcnRpY2xlX0V4cG9ydF9DTVRhbmRUQl9CZWdpbikgVGhlbiBDYWxsIEV4ZWN1dGUoc0FjdGlvbl9QbHVnaW5fVEFydGljbGVfRXhwb3J0X0NNVGFuZFRCX0JlZ2luKQ0KCQkJSWYgYkFjdGlvbl9QbHVnaW5fVEFydGljbGVfRXhwb3J0X0NNVGFuZFRCX0JlZ2luPVRydWUgVGhlbiBFeGl0IEZ1bmN0aW9uDQoJCU5leHQNCgkJDQoJCURpbSBpbnRDb21tbnVtcw0KCQlpbnRDb21tbnVtcz1vYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBDT1VOVChbbG9nX0lEXSkgRlJPTSBbYmxvZ19Db21tZW50XSBXSEVSRSBbbG9nX0lEXSA9IiAmIElEICYgIiBBTkQgW2NvbW1faXNDaGVja109MCBBTkQgW2NvbW1fUGFyZW50SURdPTAiKSgwKQ0KCQlJZiBpbnRDb21tbnVtcyA+IDAgVGhlbg0KDQoJCQlIYXNDTVRhbmRUQj1UcnVlDQoNCgkJCURpbSBzdHJDX0NvdW50LHN0ckMsc3RyVF9Db3VudCxzdHJUDQoNCgkJCURpbSBvYmpDb21tZW50DQoJCQlEaW0gb2JqVHJhY2tCYWNrDQoNCgkJCURpbSBpLGoscyx0DQoNCgkJCURpbSBjb21tZW50c19JRCgpDQoJCQlEaW0gY29tbWVudHNfUGFyZW50SUQoKQ0KCQkJRGltIGNvbW1lbnRzX1RlbXBsYXRlKCkNCg0KDQoJCQlEaW0gSURhbmRUZW1wDQoJCQlTZXQgSURhbmRUZW1wID0gQ3JlYXRlT2JqZWN0KCJTY3JpcHRpbmcuRGljdGlvbmFyeSIpDQoNCgkJCURpbSB0cmVlDQoJCQlTZXQgdHJlZSA9IENyZWF0ZU9iamVjdCgiU2NyaXB0aW5nLkRpY3Rpb25hcnkiKQ0KDQoJCQlEaW0gYWxsDQoJCQlTZXQgYWxsID0gQ3JlYXRlT2JqZWN0KCJTY3JpcHRpbmcuRGljdGlvbmFyeSIpDQoNCg0KCQkJRGltIGFsbHRlbXBsYXRlDQoJCQlTZXQgYWxsdGVtcGxhdGUgPSBDcmVhdGVPYmplY3QoIlNjcmlwdGluZy5EaWN0aW9uYXJ5IikNCg0KCQkJRGltIG9ialJTDQoNCgkJCURpbSBvcmRlcg0KCQkJb3JkZXI9SUlmKFpDX0NPTU1FTlRfUkVWRVJTRV9PUkRFUl9FWFBPUlQsIkRFU0MiLCJBU0MiKSANCg0KCQkJc3RyQ19Db3VudD0wDQoJCQlTZXQgb2JqUlM9U2VydmVyLkNyZWF0ZU9iamVjdCgiQURPREIuUmVjb3Jkc2V0IikNCgkJCW9ialJTLkN1cnNvclR5cGUgPSBhZE9wZW5LZXlzZXQNCgkJCW9ialJTLkxvY2tUeXBlID0gYWRMb2NrUmVhZE9ubHkNCgkJCW9ialJTLkFjdGl2ZUNvbm5lY3Rpb249b2JqQ29ubg0KCQkJWkNfQ09NTUVOVFNfRElTUExBWV9DT1VOVD1JSUYoWkNfQ09NTUVOVFNfRElTUExBWV9DT1VOVD0wLDEwMDAwLFpDX0NPTU1FTlRTX0RJU1BMQVlfQ09VTlQpDQoJCQlEaW0gUGFnZVNpemUyLFBhZ2VTaXplMw0KCQkJUGFnZVNpemUyPVpDX0NPTU1FTlRTX0RJU1BMQVlfQ09VTlQNCgkJCVBhZ2VTaXplMz1aQ19DT01NRU5UU19ESVNQTEFZX0NPVU5UDQoJCQlJZiBpbnRQYWdlPDEgVGhlbiBpbnRQYWdlPTENCgkJCUlmIFBhZ2VTaXplMyppbnRQYWdlPmludENvbW1udW1zIFRoZW4NCgkJCQlQYWdlU2l6ZTI9Q0xuZyhpbnRDb21tbnVtcyBNb2QgUGFnZVNpemUzKQ0KCQkJCUlmIFBhZ2VTaXplMyooaW50UGFnZS0xKStQYWdlU2l6ZTI+aW50Q29tbW51bXMgVGhlbg0KCQkJCQlUZW1wbGF0ZV9BcnRpY2xlX0NvbW1lbnQ9IjxpbnMgc3R5bGU9IiJkaXNwbGF5Om5vbmU7IiIgaWQ9IiJBamF4Q29tbWVudEJlZ2luIiI+PC9pbnM+IiAmIFRlbXBsYXRlX0FydGljbGVfQ29tbWVudCAmICI8aW5zIHN0eWxlPSIiZGlzcGxheTpub25lOyIiIGlkPSIiQWpheENvbW1lbnRFbmQiIj48L2lucz4iDQoJCQkJCUV4cG9ydF9DTVRhbmRUQj1UcnVlDQoJCQkJCUV4aXQgRnVuY3Rpb24NCgkJCQlFbmQgSWYNCgkJCUVuZCBJZg0KCQkJaj1QYWdlU2l6ZTINCgkJCQ0KCQkJb2JqUlMuU291cmNlPSJTRUxFQ1QgKiBGUk9NIChTRUxFQ1QgVE9QICImUGFnZVNpemUyJiIgKiAgRlJPTSAoU0VMRUNUIFRPUCAiJihQYWdlU2l6ZTMqaW50UGFnZSkmIiAqIEZST00gW2Jsb2dfQ29tbWVudF0gIFdIRVJFIChbbG9nX0lEXT0iJmlkJiIgQU5EIFtjb21tX2lzQ2hlY2tdPTAgQU5EIFtjb21tX1BhcmVudElEXT0wKSBPUkRFUiBCWSBbY29tbV9pZF0gIiZvcmRlciYiKSBBcyBbVGVzdF0gT1JERVIgQlkgW2NvbW1faWRdICImSUlmKFpDX0NPTU1FTlRfUkVWRVJTRV9PUkRFUl9FWFBPUlQsIkFTQyIsIkRFU0MiKSYiICkgQXMgW3Rlc3RdIG9yZGVyIGJ5IFtjb21tX3Bvc3R0aW1lXSAiJm9yZGVyDQoJCQlvYmpSUy5PcGVuKCkNCgkJCWo9UGFnZVNpemUyDQoJCQlEaW0gaW50UGFnZUFsbA0KCQkJSWYgKGludENvbW1udW1zIE1vZCBQYWdlU2l6ZTMpPTAgVGhlbiANCgkJCQlpbnRQYWdlQWxsPUludChpbnRDb21tbnVtcy9QYWdlU2l6ZTMpDQoJCQlFbHNlIA0KCQkJCWludFBhZ2VBbGw9SW50KGludENvbW1udW1zL1BhZ2VTaXplMykrMQ0KCQkJRW5kIElmDQoNCg0KCQkJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KDQoNCgkJCQlzdHJDPUdldFRlbXBsYXRlKCJURU1QTEFURV9CX0FSVElDTEVfQ09NTUVOVCIpDQoJCQkJRm9yIGk9MSBUbyBqDQoNCg0KCQkJCQlTZXQgb2JqQ29tbWVudD1OZXcgVENvbW1lbnQNCgkJCQkJb2JqQ29tbWVudC5Mb2FkSW5mb0J5QXJyYXkoQXJyYXkob2JqUlMoImNvbW1fSUQiKSxvYmpSUygibG9nX0lEIiksb2JqUlMoImNvbW1fQXV0aG9ySUQiKSxvYmpSUygiY29tbV9BdXRob3IiKSxvYmpSUygiY29tbV9Db250ZW50Iiksb2JqUlMoImNvbW1fRW1haWwiKSxvYmpSUygiY29tbV9Ib21lUGFnZSIpLG9ialJTKCJjb21tX1Bvc3RUaW1lIiksb2JqUlMoImNvbW1fSVAiKSxvYmpSUygiY29tbV9BZ2VudCIpLG9ialJTKCJjb21tX1JlcGx5Iiksb2JqUlMoImNvbW1fTGFzdFJlcGx5SVAiKSxvYmpSUygiY29tbV9MYXN0UmVwbHlUaW1lIiksb2JqUlMoImNvbW1fUGFyZW50SUQiKSxvYmpSUygiY29tbV9Jc0NoZWNrIiksb2JqUnMoImNvbW1fTWV0YSIpKSkNCg0KCQkJCQlDYWxsIEdldFVzZXJzYnlVc2VySURMaXN0KG9ialJTKCJjb21tX0F1dGhvcklEIikpDQoNCgkJCQkJJ29iakNvbW1lbnQuQ291bnQ9MA0KCQkJCQlvYmpDb21tZW50LkNvdW50PUlJZihaQ19DT01NRU5UX1JFVkVSU0VfT1JERVJfRVhQT1JULGludENvbW1udW1zLSgoaW50UGFnZS0xKSpaQ19DT01NRU5UU19ESVNQTEFZX0NPVU5UK2kpKzEsKGludFBhZ2UtMSkqWkNfQ09NTUVOVFNfRElTUExBWV9DT1VOVCtpKQ0KDQoJCQkJCXRyZWUuYWRkIG9iakNvbW1lbnQuSUQsIG9iakNvbW1lbnQuTWFrZVRlbXBsYXRlKHN0ckMpJ29iakNvbW1lbnQNCg0KCQkJCQlJZiBaQ19DT01NRU5UX1JFVkVSU0VfT1JERVJfRVhQT1JUIFRoZW4gDQoJCQkJCQl0PW9ialJTKCJjb21tX0lEIikNCgkJCQkJRWxzZUlmIGk9MSBUaGVuIA0KCQkJCQkJdD1vYmpSUygiY29tbV9JRCIpDQoJCQkJCUVuZCBJZiANCg0KCQkJCQlTZXQgb2JqQ29tbWVudD1Ob3RoaW5nDQoNCgkJCQkJb2JqUlMuTW92ZU5leHQNCgkJCQkJSWYgb2JqUlMuZW9mIFRoZW4gRXhpdCBGb3INCg0KCQkJCU5leHQNCg0KCQkJCURpbSBvYmpSUzINCg0KCQkJCVNldCBvYmpSUzI9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgKiBGUk9NIFtibG9nX0NvbW1lbnRdIFdIRVJFIChbbG9nX0lEXT0iICYgSUQgJiIgQU5EIFtjb21tX2lzQ2hlY2tdPTAgQU5EIFtjb21tX1BhcmVudElEXTw+MCBBbmQgW2NvbW1fSURdPiImdCYiKSAgT1JERVIgQlkgW2NvbW1fUG9zdFRpbWVdIERFU0MiKQ0KCQkJCUlmIChOb3Qgb2JqUlMyLmJvZikgQW5kIChOb3Qgb2JqUlMyLmVvZikgVGhlbg0KCQkJCQlEbyBXaGlsZSBOb3Qgb2JqUlMyLmVvZg0KDQoJCQkJCQlTZXQgb2JqQ29tbWVudD1OZXcgVENvbW1lbnQNCgkJCQkJCW9iakNvbW1lbnQuTG9hZEluZm9CeUFycmF5KEFycmF5KG9ialJTMigiY29tbV9JRCIpLG9ialJTMigibG9nX0lEIiksb2JqUlMyKCJjb21tX0F1dGhvcklEIiksb2JqUlMyKCJjb21tX0F1dGhvciIpLG9ialJTMigiY29tbV9Db250ZW50Iiksb2JqUlMyKCJjb21tX0VtYWlsIiksb2JqUlMyKCJjb21tX0hvbWVQYWdlIiksb2JqUlMyKCJjb21tX1Bvc3RUaW1lIiksb2JqUlMyKCJjb21tX0lQIiksb2JqUlMyKCJjb21tX0FnZW50Iiksb2JqUlMyKCJjb21tX1JlcGx5Iiksb2JqUlMyKCJjb21tX0xhc3RSZXBseUlQIiksb2JqUlMyKCJjb21tX0xhc3RSZXBseVRpbWUiKSxvYmpSUzIoImNvbW1fUGFyZW50SUQiKSxvYmpSUzIoImNvbW1fSXNDaGVjayIpLG9ialJTMigiY29tbV9NZXRhIikpKQ0KCQkJCQkJJ0NhbGwgR2V0VXNlcnNieVVzZXJJRExpc3Qob2JqUlMyKCJjb21tX0F1dGhvcklEIikpDQoJCQkJCQlvYmpDb21tZW50LkNvdW50PTANCgkJCQkJCWFsbC5hZGQgb2JqQ29tbWVudC5JRCwgb2JqQ29tbWVudC5QYXJlbnRJRA0KCQkJCQkJYWxsdGVtcGxhdGUuYWRkIG9iakNvbW1lbnQuSUQsb2JqQ29tbWVudC5NYWtlVGVtcGxhdGUoc3RyQykNCgkJCQkJCVNldCBvYmpDb21tZW50PU5vdGhpbmcNCgkJCQkJCW9ialJTMi5Nb3ZlTmV4dA0KCQkJCQlMb29wDQoJCQkJRW5kIElmDQoJCQkJb2JqUlMyLkNsb3NlDQoJCQkJU2V0IG9ialJTMj1Ob3RoaW5nDQoNCgkJCUVuZCBpZg0KDQoJCQlvYmpSUy5DbG9zZSgpDQoJCQlTZXQgb2JqUlM9Tm90aGluZw0KDQoNCgkJCUZvciBFYWNoIHMgSW4gdHJlZS5LZXlzDQoJCQkJdD0iPCEtLXJldiImcyYiLS0+Ig0KCQkJCUlmIFNlYXJjaENoaWxkQ29tbWVudHNJbkRpYyhzLHQsYWxsLGFsbHRlbXBsYXRlKT1UcnVlIFRoZW4NCgkJCQkJdHJlZS5JdGVtKHMpID1SZXBsYWNlKHRyZWUuSXRlbShzKSwiPCEtLXJldiImcyYiLS0+Iix0KQ0KCQkJCUVuZCBJZg0KCQkJCXQ9IiINCg0KCQkJTmV4dA0KDQoJCQkn6L6T5Ye65qCRDQoJCQlGb3IgRWFjaCBzIEluIHRyZWUuSXRlbXMNCgkJCQknSWYgWkNfQ09NTUVOVF9SRVZFUlNFX09SREVSX0VYUE9SVD1UcnVlIFRoZW4NCgkJCQkJVGVtcGxhdGVfQXJ0aWNsZV9Db21tZW50PVRlbXBsYXRlX0FydGljbGVfQ29tbWVudCAmIHMNCgkJCQknRWxzZQ0KCQkJCScJVGVtcGxhdGVfQXJ0aWNsZV9Db21tZW50PXMgJiBUZW1wbGF0ZV9BcnRpY2xlX0NvbW1lbnQNCgkJCQknRW5kIElmDQoJCQlOZXh0DQoNCgkJRW5kIElmDQoNCgkJQ2FsbCBFeHBvcnRDTVRhbmRUQkJhcihpbnRQYWdlLGludFBhZ2VBbGwpDQoNCgkJVGVtcGxhdGVfQXJ0aWNsZV9Db21tZW50PSI8aW5zIHN0eWxlPSIiZGlzcGxheTpub25lOyIiIGlkPSIiQWpheENvbW1lbnRCZWdpbiIiPjwvaW5zPiIgJiBUZW1wbGF0ZV9BcnRpY2xlX0NvbW1lbnQgJiBUZW1wbGF0ZV9BcnRpY2xlX0NvbW1lbnRfUGFnZWJhciAmIjxpbnMgc3R5bGU9IiJkaXNwbGF5Om5vbmU7IiIgaWQ9IiJBamF4Q29tbWVudEVuZCIiPjwvaW5zPiINCg0KCQlUZW1wbGF0ZV9BcnRpY2xlX0NvbW1lbnQ9UmVwbGFjZShUZW1wbGF0ZV9BcnRpY2xlX0NvbW1lbnQsIjwhLS0oY291bnQtLT4wPCEtLWNvdW50KS0tPiIsIjxzcGFuIGNsYXNzPSIicmV2Y291bnQiIj48L3NwYW4+IikNCgkJVGVtcGxhdGVfQXJ0aWNsZV9Db21tZW50PVJlcGxhY2UoVGVtcGxhdGVfQXJ0aWNsZV9Db21tZW50LCI8IS0tKGNvdW50LS0+IiwiIikNCgkJVGVtcGxhdGVfQXJ0aWNsZV9Db21tZW50PVJlcGxhY2UoVGVtcGxhdGVfQXJ0aWNsZV9Db21tZW50LCI8IS0tY291bnQpLS0+IiwiIikNCg0KCQlUZW1wbGF0ZV9BcnRpY2xlX0NvbW1lbnQ9VHJhbnNmZXJIVE1MKFRlbXBsYXRlX0FydGljbGVfQ29tbWVudCwiW2FudGktemNfYmxvZ19ob3N0XSIpDQoNCgkJRXhwb3J0X0NNVGFuZFRCPVRydWUNCg0KCUVuZCBGdW5jdGlvbg0KDQoNCg0KDQoJUHVibGljIEZ1bmN0aW9uIEV4cG9ydENNVGFuZFRCQmFyKGludFBhZ2UsaW50UGFnZUFsbCkNCg0KCQkncGx1Z2luIG5vZGUNCgkJYkFjdGlvbl9QbHVnaW5fVEFydGljbGVfRXhwb3J0Q01UYW5kVEJCYXJfQmVnaW49RmFsc2UNCgkJRm9yIEVhY2ggc0FjdGlvbl9QbHVnaW5fVEFydGljbGVfRXhwb3J0Q01UYW5kVEJCYXJfQmVnaW4gaW4gQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRDTVRhbmRUQkJhcl9CZWdpbg0KCQkJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fVEFydGljbGVfRXhwb3J0Q01UYW5kVEJCYXJfQmVnaW4pIFRoZW4gQ2FsbCBFeGVjdXRlKHNBY3Rpb25fUGx1Z2luX1RBcnRpY2xlX0V4cG9ydENNVGFuZFRCQmFyX0JlZ2luKQ0KCQkJSWYgYkFjdGlvbl9QbHVnaW5fVEFydGljbGVfRXhwb3J0Q01UYW5kVEJCYXJfQmVnaW49VHJ1ZSBUaGVuIEV4aXQgRnVuY3Rpb24NCgkJTmV4dA0KDQoJCURpbSBzLGwscg0KDQoJCUlmIGludFBhZ2VBbGw+MSBUaGVuDQoJCQlEaW0gbHAscnANCg0KCQkJbHA9IkdldENvbW1lbnRzKCImSUQmIiwiJihpbnRQYWdlLTEpJiIpIg0KCQkJcnA9IkdldENvbW1lbnRzKCImSUQmIiwiJihpbnRQYWdlKzEpJiIpIg0KDQoJCQlsPUdldFRlbXBsYXRlKCJURU1QTEFURV9CX0FSVElDTEVfQ09NTUVOVF9QQUdFQkFSX0wiKQ0KCQkJcj1HZXRUZW1wbGF0ZSgiVEVNUExBVEVfQl9BUlRJQ0xFX0NPTU1FTlRfUEFHRUJBUl9SIikNCg0KCQkJbD1SZXBsYWNlKGwsIjwjYXJ0aWNsZS9jb21tZW50X3BhZ2ViYXJfbC91cmwjPiIsbHApDQoJCQlyPVJlcGxhY2UociwiPCNhcnRpY2xlL2NvbW1lbnRfcGFnZWJhcl9yL3VybCM+IixycCkNCg0KCQkJSWYgaW50UGFnZT0xIFRoZW4NCgkJCQlsPSIiDQoJCQlFbmQgSWYNCgkJCUlmIGludFBhZ2U9aW50UGFnZUFsbCBUaGVuDQoJCQkJcj0iIg0KCQkJRW5kIElmDQoJCQkNCgkJCXM9R2V0VGVtcGxhdGUoIlRFTVBMQVRFX0JfQVJUSUNMRV9DT01NRU5UX1BBR0VCQVIiKQ0KCQkJcz1SZXBsYWNlKHMsIjwjdGVtcGxhdGU6cGFnZWJhciM+IixsJnImIiIpDQoJCUVuZCBJZg0KDQoJCVRlbXBsYXRlX0FydGljbGVfQ29tbWVudF9QYWdlYmFyPXMNCg0KCQlFeHBvcnRDTVRhbmRUQkJhcj1UcnVlDQoNCgkJJ3BsdWdpbiBub2RlDQoJCWJBY3Rpb25fUGx1Z2luX1RBcnRpY2xlX0V4cG9ydENNVGFuZFRCQmFyX0VuZD1GYWxzZQ0KCQlGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRDTVRhbmRUQkJhcl9FbmQgaW4gQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRDTVRhbmRUQkJhcl9FbmQNCgkJCUlmIE5vdCBJc0VtcHR5KHNBY3Rpb25fUGx1Z2luX1RBcnRpY2xlX0V4cG9ydENNVGFuZFRCQmFyX0VuZCkgVGhlbiBDYWxsIEV4ZWN1dGUoc0FjdGlvbl9QbHVnaW5fVEFydGljbGVfRXhwb3J0Q01UYW5kVEJCYXJfRW5kKQ0KCQkJSWYgYkFjdGlvbl9QbHVnaW5fVEFydGljbGVfRXhwb3J0Q01UYW5kVEJCYXJfRW5kPVRydWUgVGhlbiBFeGl0IEZ1bmN0aW9uDQoJCU5leHQNCg0KCUVuZCBGdW5jdGlvbg0KDQoNCg0KDQoJUHJpdmF0ZSBGdW5jdGlvbiBTZWFyY2hDaGlsZENvbW1lbnRzSW5EaWMoQnlWYWwgaWQsQnlSZWYgdCxCeVZhbCBhbGx0cmVlLEJ5VmFsIGFsbHRlbXBsYXRlKQ0KDQoJCURpbSBzDQoNCgkJRm9yIEVhY2ggcyBJbiBhbGx0cmVlLktleXMNCg0KCQkJSWYgYWxsdHJlZS5JdGVtKHMpPWlkIFRoZW4NCgkJCQl0PVJlcGxhY2UodCwiPCEtLXJldiImaWQmIi0tPiIsIjwhLS1yZXYiJmlkJiItLT4iICYgYWxsdGVtcGxhdGUuSXRlbShDTG5nKHMpICkgKQ0KCQkJCUNhbGwgU2VhcmNoQ2hpbGRDb21tZW50c0luRGljKHMsdCxhbGx0cmVlLGFsbHRlbXBsYXRlKQ0KCQkJCVNlYXJjaENoaWxkQ29tbWVudHNJbkRpYz1UcnVlDQoJCQlFbmQgSWYNCg0KCQlOZXh0DQoNCglFbmQgRnVuY3Rpb24NCg0KDQoNCg0KCUZ1bmN0aW9uIEV4cG9ydF9OYXZCYXIoKQ0KDQoJCUlmIERpc2FibGVfRXhwb3J0X05hdkJhcj1UcnVlIFRoZW4gRXhpdCBGdW5jdGlvbg0KDQoJCSdwbHVnaW4gbm9kZQ0KCQliQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfTmF2QmFyX0JlZ2luPUZhbHNlDQoJCUZvciBFYWNoIHNBY3Rpb25fUGx1Z2luX1RBcnRpY2xlX0V4cG9ydF9OYXZCYXJfQmVnaW4gaW4gQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfTmF2QmFyX0JlZ2luDQoJCQlJZiBOb3QgSXNFbXB0eShzQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfTmF2QmFyX0JlZ2luKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfTmF2QmFyX0JlZ2luKQ0KCQkJSWYgYkFjdGlvbl9QbHVnaW5fVEFydGljbGVfRXhwb3J0X05hdkJhcl9CZWdpbj1UcnVlIFRoZW4gRXhpdCBGdW5jdGlvbg0KCQlOZXh0DQoNCg0KCQlJZiBaQ19VU0VfTkFWSUdBVEVfQVJUSUNMRT1GYWxzZSBPciBJc1BhZ2U9VHJ1ZSBUaGVuDQoNCgkJCVRlbXBsYXRlX0FydGljbGVfTmF2YmFyX0w9IiINCgkJCVRlbXBsYXRlX0FydGljbGVfTmF2YmFyX1I9IiINCg0KCQkJRXhwb3J0X05hdkJhcj1UcnVlDQoJCQlFeGl0IEZ1bmN0aW9uDQoNCgkJRW5kIElmDQoNCgkJRGltIHMsdA0KDQoJCURpbSBzdHJOYW1lDQoJCURpbSBzdHJVcmwNCg0KCQlEaW0gb2JqTmF2QXJ0aWNsZQ0KDQoJCURpbSBvYmpSUw0KDQoJCVNldCBvYmpSUz1vYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBUT1AgMSBbbG9nX0lEXSxbbG9nX1RhZ10sW2xvZ19DYXRlSURdLFtsb2dfVGl0bGVdLFtsb2dfSW50cm9dLFtsb2dfQ29udGVudF0sW2xvZ19MZXZlbF0sW2xvZ19BdXRob3JJRF0sW2xvZ19Qb3N0VGltZV0sW2xvZ19Db21tTnVtc10sW2xvZ19WaWV3TnVtc10sW2xvZ19UcmFja0JhY2tOdW1zXSxbbG9nX1VybF0sW2xvZ19Jc3RvcF0sW2xvZ19UZW1wbGF0ZV0sW2xvZ19GdWxsVXJsXSxbbG9nX1R5cGVdLFtsb2dfTWV0YV0gRlJPTSBbYmxvZ19BcnRpY2xlXSBXSEVSRSAoW2xvZ19UeXBlXT0wKSBBbmQgKFtsb2dfTGV2ZWxdPjIpIEFORCAoW2xvZ19Qb3N0VGltZV08IiAmIFpDX1NRTF9QT1VORF9LRVkgJiBQb3N0VGltZSAmIFpDX1NRTF9QT1VORF9LRVkgJiIpIE9SREVSIEJZIFtsb2dfUG9zdFRpbWVdIERFU0MiKQ0KCQlJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoNCgkJCVNldCBvYmpOYXZBcnRpY2xlPU5ldyBUQXJ0aWNsZQ0KCQkJSWYgb2JqTmF2QXJ0aWNsZS5Mb2FkSW5mb0J5QXJyYXkoQXJyYXkob2JqUlMoMCksb2JqUlMoMSksb2JqUlMoMiksb2JqUlMoMyksb2JqUlMoNCksb2JqUlMoNSksb2JqUlMoNiksb2JqUlMoNyksb2JqUlMoOCksb2JqUlMoOSksb2JqUlMoMTApLG9ialJTKDExKSxvYmpSUygxMiksb2JqUlMoMTMpLG9ialJTKDE0KSxvYmpSUygxNSksb2JqUlMoMTYpLG9ialJTKDE3KSkpIFRoZW4NCgkJCQlzdHJOYW1lPW9iak5hdkFydGljbGUuVGl0bGUNCgkJCQlzdHJVcmw9b2JqTmF2QXJ0aWNsZS5VcmwNCgkJCUVuZCBJZg0KCQkJU2V0IG9iak5hdkFydGljbGU9Tm90aGluZw0KDQoJCQlzPUdldFRlbXBsYXRlKCJURU1QTEFURV9CX0FSVElDTEVfTkFWQkFSX0wiKQ0KDQoJCQkncz1SZXBsYWNlKHMsIjwjYXJ0aWNsZS9uYXZfbC91cmwjPiIsIjwjWkNfQkxPR19IT1NUIz52aWV3LmFzcD9uYXZwPSImSUQpDQoJCQkncz1SZXBsYWNlKHMsIjwjYXJ0aWNsZS9uYXZfbC9uYW1lIz4iLFpDX01TRzE0NikNCgkJCXM9UmVwbGFjZShzLCI8I2FydGljbGUvbmF2X2wvdXJsIz4iLHN0clVybCkNCgkJCXM9UmVwbGFjZShzLCI8I2FydGljbGUvbmF2X2wvbmFtZSM+IixzdHJOYW1lKQ0KDQoJCQlUZW1wbGF0ZV9BcnRpY2xlX05hdmJhcl9MPXMNCg0KCQlFbmQgSWYNCgkJU2V0IG9ialJTPU5vdGhpbmcNCg0KCQlTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgVE9QIDEgW2xvZ19JRF0sW2xvZ19UYWddLFtsb2dfQ2F0ZUlEXSxbbG9nX1RpdGxlXSxbbG9nX0ludHJvXSxbbG9nX0NvbnRlbnRdLFtsb2dfTGV2ZWxdLFtsb2dfQXV0aG9ySURdLFtsb2dfUG9zdFRpbWVdLFtsb2dfQ29tbU51bXNdLFtsb2dfVmlld051bXNdLFtsb2dfVHJhY2tCYWNrTnVtc10sW2xvZ19VcmxdLFtsb2dfSXN0b3BdLFtsb2dfVGVtcGxhdGVdLFtsb2dfRnVsbFVybF0sW2xvZ19UeXBlXSxbbG9nX01ldGFdIEZST00gW2Jsb2dfQXJ0aWNsZV0gV0hFUkUgKFtsb2dfVHlwZV09MCkgQW5kIChbbG9nX0xldmVsXT4yKSBBTkQgKFtsb2dfUG9zdFRpbWVdPiIgJiBaQ19TUUxfUE9VTkRfS0VZICYgUG9zdFRpbWUgJiBaQ19TUUxfUE9VTkRfS0VZICYiKSBPUkRFUiBCWSBbbG9nX1Bvc3RUaW1lXSBBU0MiKQ0KDQoJCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCg0KCQkJU2V0IG9iak5hdkFydGljbGU9TmV3IFRBcnRpY2xlDQoJCQlJZiBvYmpOYXZBcnRpY2xlLkxvYWRJbmZvQnlBcnJheShBcnJheShvYmpSUygwKSxvYmpSUygxKSxvYmpSUygyKSxvYmpSUygzKSxvYmpSUyg0KSxvYmpSUyg1KSxvYmpSUyg2KSxvYmpSUyg3KSxvYmpSUyg4KSxvYmpSUyg5KSxvYmpSUygxMCksb2JqUlMoMTEpLG9ialJTKDEyKSxvYmpSUygxMyksb2JqUlMoMTQpLG9ialJTKDE1KSxvYmpSUygxNiksb2JqUlMoMTcpKSkgVGhlbg0KCQkJCXN0ck5hbWU9b2JqTmF2QXJ0aWNsZS5UaXRsZQ0KCQkJCXN0clVybD1vYmpOYXZBcnRpY2xlLlVybA0KCQkJRW5kIElmDQoJCQlTZXQgb2JqTmF2QXJ0aWNsZT1Ob3RoaW5nDQoNCgkJCXQ9R2V0VGVtcGxhdGUoIlRFTVBMQVRFX0JfQVJUSUNMRV9OQVZCQVJfUiIpDQoNCgkJCSd0PVJlcGxhY2UodCwiPCNhcnRpY2xlL25hdl9yL3VybCM+IiwiPCNaQ19CTE9HX0hPU1QjPnZpZXcuYXNwP25hdm49IiZJRCkNCgkJCSd0PVJlcGxhY2UodCwiPCNhcnRpY2xlL25hdl9yL25hbWUjPiIsWkNfTVNHMTQ4KQ0KCQkJdD1SZXBsYWNlKHQsIjwjYXJ0aWNsZS9uYXZfci91cmwjPiIsc3RyVXJsKQ0KCQkJdD1SZXBsYWNlKHQsIjwjYXJ0aWNsZS9uYXZfci9uYW1lIz4iLHN0ck5hbWUpDQoNCgkJCVRlbXBsYXRlX0FydGljbGVfTmF2YmFyX1I9dA0KDQoJCUVuZCBJZg0KCQlTZXQgb2JqUlM9Tm90aGluZw0KDQoJCUV4cG9ydF9OYXZCYXI9VHJ1ZQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCUZ1bmN0aW9uIEV4cG9ydF9Db21tZW50UG9zdCgpDQoNCgkJSWYgRGlzYWJsZV9FeHBvcnRfQ29tbWVudFBvc3Q9VHJ1ZSBUaGVuIEV4aXQgRnVuY3Rpb24NCg0KCQkncGx1Z2luIG5vZGUNCgkJYkFjdGlvbl9QbHVnaW5fVEFydGljbGVfRXhwb3J0X0NvbW1lbnRQb3N0X0JlZ2luPUZhbHNlDQoJCUZvciBFYWNoIHNBY3Rpb25fUGx1Z2luX1RBcnRpY2xlX0V4cG9ydF9Db21tZW50UG9zdF9CZWdpbiBpbiBBY3Rpb25fUGx1Z2luX1RBcnRpY2xlX0V4cG9ydF9Db21tZW50UG9zdF9CZWdpbg0KCQkJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fVEFydGljbGVfRXhwb3J0X0NvbW1lbnRQb3N0X0JlZ2luKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfQ29tbWVudFBvc3RfQmVnaW4pDQoJCQlJZiBiQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfQ29tbWVudFBvc3RfQmVnaW49VHJ1ZSBUaGVuIEV4aXQgRnVuY3Rpb24NCgkJTmV4dA0KDQoJCUlmIFpDX0NPTU1FTlRfVFVSTk9GRj1UcnVlIFRoZW4gDQoJCQlUZW1wbGF0ZV9BcnRpY2xlX0NvbW1lbnRwb3N0PSIiDQoJCQlFeGl0IEZ1bmN0aW9uDQoJCUVuZCBJZg0KDQoJCUlmIExldmVsPDQgVGhlbiBFeGl0IEZ1bmN0aW9uDQoNCgkJVGVtcGxhdGVfQXJ0aWNsZV9Db21tZW50cG9zdD1HZXRUZW1wbGF0ZSgiVEVNUExBVEVfQl9BUlRJQ0xFX0NPTU1FTlRQT1NUIikNCg0KCQlEaW0gUkUNCgkJU2V0IFJFID0gTmV3IFJlZ0V4cCANCgkJUkUuSWdub3JlQ2FzZSA9IFRydWUgDQoJCVJFLkdsb2JhbCA9IFRydWUgDQoNCgkJSWYgSW5TdHIoVGVtcGxhdGVfQXJ0aWNsZV9Db21tZW50cG9zdCwidGVtcGxhdGU6YXJ0aWNsZV9jb21tZW50cG9zdC12ZXJpZnk6Iik+MCAgVGhlbicyLjLmlrDlop7mnaHku7bliKTmlq0NCgkJCUlmIFpDX0NPTU1FTlRfVkVSSUZZX0VOQUJMRT1UcnVlIFRoZW4NCgkJCQlUZW1wbGF0ZV9BcnRpY2xlX0NvbW1lbnRwb3N0PVJlcGxhY2UoVGVtcGxhdGVfQXJ0aWNsZV9Db21tZW50cG9zdCwidGVtcGxhdGU6YXJ0aWNsZV9jb21tZW50cG9zdC12ZXJpZnk6YmVnaW4iLCIiKQ0KCQkJCVRlbXBsYXRlX0FydGljbGVfQ29tbWVudHBvc3Q9UmVwbGFjZShUZW1wbGF0ZV9BcnRpY2xlX0NvbW1lbnRwb3N0LCJ0ZW1wbGF0ZTphcnRpY2xlX2NvbW1lbnRwb3N0LXZlcmlmeTplbmQiLCIiKQ0KCQkJRWxzZQ0KCQkJCVJFLlBhdHRlcm4gPSAiPCN0ZW1wbGF0ZTphcnRpY2xlX2NvbW1lbnRwb3N0LXZlcmlmeTpiZWdpbiM+KC58XG4pKjwjdGVtcGxhdGU6YXJ0aWNsZV9jb21tZW50cG9zdC12ZXJpZnk6ZW5kIz4iDQoJCQkJVGVtcGxhdGVfQXJ0aWNsZV9Db21tZW50cG9zdCA9IFJFLlJlcGxhY2UoVGVtcGxhdGVfQXJ0aWNsZV9Db21tZW50cG9zdCwgIiIpDQoJCQlFbmQgSWYNCgkJRWxzZQ0KCQkJSWYgWkNfQ09NTUVOVF9WRVJJRllfRU5BQkxFPVRydWUgVGhlbg0KCQkJCVRlbXBsYXRlX0FydGljbGVfQ29tbWVudHBvc3RfVmVyaWZ5PUdldFRlbXBsYXRlKCJURU1QTEFURV9CX0FSVElDTEVfQ09NTUVOVFBPU1QtVkVSSUZZIikNCgkJCUVuZCBJZg0KCQkJVGVtcGxhdGVfQXJ0aWNsZV9Db21tZW50cG9zdD1SZXBsYWNlKFRlbXBsYXRlX0FydGljbGVfQ29tbWVudHBvc3QsIjwjdGVtcGxhdGU6YXJ0aWNsZV9jb21tZW50cG9zdC12ZXJpZnkjPiIsVGVtcGxhdGVfQXJ0aWNsZV9Db21tZW50cG9zdF9WZXJpZnkpDQoJCUVuZCBJZg0KDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJJ+ebuOWFs+aWh+eroOeahOeUn+aIkA0KCUZ1bmN0aW9uIEV4cG9ydF9NdXR1YWxpdHkoKQ0KDQoJCUlmIERpc2FibGVfRXhwb3J0X011dHVhbGl0eT1UcnVlIFRoZW4gRXhpdCBGdW5jdGlvbg0KDQoJCSdwbHVnaW4gbm9kZQ0KCQliQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfTXV0dWFsaXR5X0JlZ2luPUZhbHNlDQoJCUZvciBFYWNoIHNBY3Rpb25fUGx1Z2luX1RBcnRpY2xlX0V4cG9ydF9NdXR1YWxpdHlfQmVnaW4gaW4gQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfTXV0dWFsaXR5X0JlZ2luDQoJCQlJZiBOb3QgSXNFbXB0eShzQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfTXV0dWFsaXR5X0JlZ2luKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfTXV0dWFsaXR5X0JlZ2luKQ0KCQkJSWYgYkFjdGlvbl9QbHVnaW5fVEFydGljbGVfRXhwb3J0X011dHVhbGl0eV9CZWdpbj1UcnVlIFRoZW4gRXhpdCBGdW5jdGlvbg0KCQlOZXh0DQoNCgkJSWYgWkNfTVVUVUFMSVRZX0NPVU5UPTAgVGhlbiANCgkJCUV4cG9ydF9NdXR1YWxpdHk9VHJ1ZQ0KCQkJRXhpdCBGdW5jdGlvbg0KCQlFbmQgSWYNCg0KCQlJZiBUYWc8PiIiIFRoZW4NCg0KCQkJRGltIHN0ckNDX0NvdW50LHN0ckNDX0lELHN0ckNDX05hbWUsc3RyQ0NfVXJsLHN0ckNDX1Bvc3RUaW1lLHN0ckNDX1RpdGxlDQoJCQlEaW0gc3RyQ0MNCgkJCURpbSBpLGoscw0KCQkJRGltIG9ialJTDQoJCQlEaW0gc3RyU1FMDQoNCgkJCVNldCBvYmpSUz1TZXJ2ZXIuQ3JlYXRlT2JqZWN0KCJBRE9EQi5SZWNvcmRzZXQiKQ0KDQoJCQlzdHJTUUw9IlNFTEVDVCBUT1AgIiYgWkNfTVVUVUFMSVRZX0NPVU5UICYiIFtsb2dfSURdLFtsb2dfVGFnXSxbbG9nX0NhdGVJRF0sW2xvZ19UaXRsZV0sW2xvZ19JbnRyb10sW2xvZ19Db250ZW50XSxbbG9nX0xldmVsXSxbbG9nX0F1dGhvcklEXSxbbG9nX1Bvc3RUaW1lXSxbbG9nX0NvbW1OdW1zXSxbbG9nX1ZpZXdOdW1zXSxbbG9nX1RyYWNrQmFja051bXNdLFtsb2dfVXJsXSxbbG9nX0lzdG9wXSxbbG9nX1RlbXBsYXRlXSxbbG9nX0Z1bGxVcmxdLFtsb2dfVHlwZV0sW2xvZ19NZXRhXSBGUk9NIFtibG9nX0FydGljbGVdIFdIRVJFIChbbG9nX1R5cGVdPTApIEFuZCAoW2xvZ19MZXZlbF0+MikgQU5EIFtsb2dfSURdPD4iJiBJRA0KCQkJc3RyU1FMID0gc3RyU1FMICYgIiBBTkQgKCINCg0KCQkJRGltIGFyeVRBR3MNCgkJCXM9UmVwbGFjZShUYWcsIn0iLCIiKQ0KCQkJYXJ5VEFHcz1TcGxpdChzLCJ7IikNCg0KCQkJRm9yIGogPSBMQm91bmQoYXJ5VEFHcykgVG8gVUJvdW5kKGFyeVRBR3MpDQoJCQkJSWYgYXJ5VEFHcyhqKTw+IiIgVGhlbg0KCQkJCQlzdHJTUUwgPSBzdHJTUUwgJiAiKFtsb2dfVGFnXSBMaWtlICcleyImRmlsdGVyU1FMKGFyeVRBR3MoaikpJiJ9JScpIg0KCQkJCQlJZiBqPVVCb3VuZChhcnlUQUdzKSBUaGVuIEV4aXQgRm9yDQoJCQkJCUlmIGFyeVRBR3Moaik8PiIiIFRoZW4gc3RyU1FMID0gc3RyU1FMICYgIiBPUiAiDQoJCQkJRW5kIElmDQoJCQlOZXh0DQoNCgkJCXN0clNRTCA9IHN0clNRTCAmICIpIg0KCQkJc3RyU1FMID0gc3RyU1FMICsgIiBPUkRFUiBCWSBbbG9nX1Bvc3RUaW1lXSBERVNDICINCg0KCQkJU2V0IG9ialJTPVNlcnZlci5DcmVhdGVPYmplY3QoIkFET0RCLlJlY29yZHNldCIpDQoJCQlvYmpSUy5DdXJzb3JUeXBlID0gYWRPcGVuS2V5c2V0DQoJCQlvYmpSUy5Mb2NrVHlwZSA9IGFkTG9ja1JlYWRPbmx5DQoJCQlvYmpSUy5BY3RpdmVDb25uZWN0aW9uPW9iakNvbm4NCgkJCW9ialJTLlNvdXJjZT1zdHJTUUwNCgkJCW9ialJTLk9wZW4oKQ0KCQkJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KDQoJCQkJRGltIG9iakFydGljbGUNCgkJCQlGb3IgaT0xIFRvIFpDX01VVFVBTElUWV9DT1VOVCAn55u45YWz5paH56ug5pWw55uu77yM5Y+v6Ieq6KGM6K6+5a6aDQoNCgkJCQkJSGFzTXV0dWFsaXR5PVRydWUNCg0KCQkJCQlTZXQgb2JqQXJ0aWNsZT1OZXcgVEFydGljbGUNCg0KCQkJCQlJZiBvYmpBcnRpY2xlLkxvYWRJbmZvQnlBcnJheShBcnJheShvYmpSUygwKSxvYmpSUygxKSxvYmpSUygyKSxvYmpSUygzKSxvYmpSUyg0KSxvYmpSUyg1KSxvYmpSUyg2KSxvYmpSUyg3KSxvYmpSUyg4KSxvYmpSUyg5KSxvYmpSUygxMCksb2JqUlMoMTEpLG9ialJTKDEyKSxvYmpSUygxMyksb2JqUlMoMTQpLG9ialJTKDE1KSxvYmpSUygxNiksb2JqUlMoMTcpKSkgIFRoZW4NCg0KCQkJCQkJc3RyQ0NfQ291bnQ9c3RyQ0NfQ291bnQrMQ0KCQkJCQkJc3RyQ0NfSUQ9b2JqQXJ0aWNsZS5JRA0KCQkJCQkJc3RyQ0NfVXJsPW9iakFydGljbGUuVXJsDQoJCQkJCQlzdHJDQ19Qb3N0VGltZT1vYmpBcnRpY2xlLlBvc3RUaW1lDQoJCQkJCQlzdHJDQ19UaXRsZT1vYmpBcnRpY2xlLlRpdGxlDQoNCgkJCQkJCXN0ckNDPUdldFRlbXBsYXRlKCJURU1QTEFURV9CX0FSVElDTEVfTVVUVUFMSVRZIikNCg0KCQkJCQkJc3RyQ0M9UmVwbGFjZShzdHJDQywiPCNhcnRpY2xlL211dHVhbGl0eS9pZCM+IixzdHJDQ19JRCkNCgkJCQkJCXN0ckNDPVJlcGxhY2Uoc3RyQ0MsIjwjYXJ0aWNsZS9tdXR1YWxpdHkvdXJsIz4iLHN0ckNDX1VybCkNCgkJCQkJCXN0ckNDPVJlcGxhY2Uoc3RyQ0MsIjwjYXJ0aWNsZS9tdXR1YWxpdHkvcG9zdHRpbWUjPiIsc3RyQ0NfUG9zdFRpbWUpDQoJCQkJCQlzdHJDQz1SZXBsYWNlKHN0ckNDLCI8I2FydGljbGUvbXV0dWFsaXR5L25hbWUjPiIsc3RyQ0NfVGl0bGUpDQoNCgkJCQkJCVRlbXBsYXRlX0FydGljbGVfTXV0dWFsaXR5PVRlbXBsYXRlX0FydGljbGVfTXV0dWFsaXR5ICYgc3RyQ0MNCg0KCQkJCQlFbmQgSWYNCg0KCQkJCQlvYmpSUy5Nb3ZlTmV4dA0KCQkJCQlJZiBvYmpSUy5lb2YgVGhlbiBFeGl0IEZvcg0KCQkJCQlTZXQgb2JqQXJ0aWNsZT1Ob3RoaW5nDQoJCQkJTmV4dA0KDQoJCQlFbmQgaWYNCg0KCQkJb2JqUlMuQ2xvc2UoKQ0KCQkJU2V0IG9ialJTPU5vdGhpbmcNCg0KCQlFbmQgSWYNCg0KCQlFeHBvcnRfTXV0dWFsaXR5PVRydWUNCg0KCUVuZCBGdW5jdGlvbg0KDQoNCglQdWJsaWMgRnVuY3Rpb24gRXhwb3J0KGludFR5cGUpDQoNCgkJJ3BsdWdpbiBub2RlDQoJCWJBY3Rpb25fUGx1Z2luX1RBcnRpY2xlX0V4cG9ydF9CZWdpbj1GYWxzZQ0KCQlGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfQmVnaW4gaW4gQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfQmVnaW4NCgkJCUlmIE5vdCBJc0VtcHR5KHNBY3Rpb25fUGx1Z2luX1RBcnRpY2xlX0V4cG9ydF9CZWdpbikgVGhlbiBDYWxsIEV4ZWN1dGUoc0FjdGlvbl9QbHVnaW5fVEFydGljbGVfRXhwb3J0X0JlZ2luKQ0KCQkJSWYgYkFjdGlvbl9QbHVnaW5fVEFydGljbGVfRXhwb3J0X0JlZ2luPVRydWUgVGhlbiBFeGl0IEZ1bmN0aW9uDQoJCU5leHQNCg0KCQlJZiBJc0VtcHR5KGh0bWwpPVRydWUgVGhlbiBodG1sPVRlbXBsYXRlDQoNCgkJQ2FsbCBHZXRVc2Vyc2J5VXNlcklETGlzdChBdXRob3JJRCkNCg0KCQlJZiAoWkNfRElTUExBWV9NT0RFX0lOVFJPPWludFR5cGUpIE9yIChaQ19ESVNQTEFZX01PREVfT05UT1A9aW50VHlwZSkgT3IgKFpDX0RJU1BMQVlfTU9ERV9TRUFSQ0g9aW50VHlwZSkgT3IgKFpDX0RJU1BMQVlfTU9ERV9TWVNURU1QQUdFPWludFR5cGUpIE9yIChaQ19ESVNQTEFZX01PREVfQ09NTUVOVFM9aW50VHlwZSkgVGhlbg0KCQkJRGlzYWJsZV9FeHBvcnRfVGFnPUZhbHNlDQoJCQlEaXNhYmxlX0V4cG9ydF9DTVRhbmRUQj1UcnVlDQoJCQlEaXNhYmxlX0V4cG9ydF9Db21tZW50UG9zdD1UcnVlDQoJCQlEaXNhYmxlX0V4cG9ydF9NdXR1YWxpdHk9VHJ1ZQ0KCQkJRGlzYWJsZV9FeHBvcnRfTmF2QmFyPVRydWUNCgkJCUlmIFpDX0RJU1BMQVlfTU9ERV9TWVNURU1QQUdFPWludFR5cGUgVGhlbg0KCQkJCURpc2FibGVfRXhwb3J0X1RhZz1UcnVlDQoJCQlFbmQgSWYNCgkJCUlmIFpDX0RJU1BMQVlfTU9ERV9PTlRPUD1pbnRUeXBlIFRoZW4NCgkJCQknRGlzYWJsZV9FeHBvcnRfVGFnPVRydWUNCgkJCQlzdWJodG1sX1RlbXBsYXRlTmFtZT0iIg0KCQkJCXN1Ymh0bWw9R2V0VGVtcGxhdGUoIlRFTVBMQVRFX0JfQVJUSUNMRS1JU1RPUCIpDQoJCQlFbmQgSWYNCgkJCUlmIFpDX0RJU1BMQVlfTU9ERV9TRUFSQ0g9aW50VHlwZSBUaGVuDQoJCQkJRGlzYWJsZV9FeHBvcnRfVGFnPVRydWUNCgkJCQlzdWJodG1sX1RlbXBsYXRlTmFtZT0iIg0KCQkJCXN1Ymh0bWw9R2V0VGVtcGxhdGUoIlRFTVBMQVRFX0JfQVJUSUNMRS1TRUFSQ0gtQ09OVEVOVCIpDQoJCQlFbmQgSWYNCgkJCUlmIFpDX0RJU1BMQVlfTU9ERV9DT01NRU5UUz1pbnRUeXBlIFRoZW4NCgkJCQlEaXNhYmxlX0V4cG9ydF9UYWc9VHJ1ZQ0KCQkJCURpc2FibGVfRXhwb3J0X0NNVGFuZFRCPUZhbHNlDQoJCQkJc3ViaHRtbF9UZW1wbGF0ZU5hbWU9IiINCgkJCQlzdWJodG1sPSI8I3RlbXBsYXRlOmFydGljbGVfY29tbWVudCM+Ig0KCQkJRW5kIElmDQoJCUVuZCBJZg0KDQoJCUlmIFpDX0RJU1BMQVlfTU9ERV9BTEw9aW50VHlwZSBBbmQgSXNQYWdlPVRydWUgVGhlbg0KCQkJRGlzYWJsZV9FeHBvcnRfQ01UYW5kVEI9RmFsc2UNCgkJCURpc2FibGVfRXhwb3J0X0NvbW1lbnRQb3N0PUZhbHNlDQoJCQlEaXNhYmxlX0V4cG9ydF9UYWc9VHJ1ZQ0KCQkJRGlzYWJsZV9FeHBvcnRfTXV0dWFsaXR5PVRydWUNCgkJCURpc2FibGVfRXhwb3J0X05hdkJhcj1UcnVlDQoJCUVuZCBJZg0KDQoJCUNhbGwgRXhwb3J0X1RhZw0KCQlDYWxsIEV4cG9ydF9DTVRhbmRUQihDb21tZW50c1BhZ2UpDQoJCUNhbGwgRXhwb3J0X0NvbW1lbnRQb3N0DQoJCUNhbGwgRXhwb3J0X011dHVhbGl0eQ0KCQlDYWxsIEV4cG9ydF9OYXZCYXINCg0KCQlEaW0gUkUgLE1hdGNoLE1hdGNoZXMNCgkJU2V0IFJFID0gTmV3IFJlZ0V4cCANCgkJCVJFLlBhdHRlcm4gPSAiXDxcI3RlbXBsYXRlXDooYXJ0aWNsZVwtKFthLXowLTldKikoW1wtYS16MC05XSopKVwjXD4iDQoJCQlSRS5JZ25vcmVDYXNlID0gVHJ1ZSANCgkJCVJFLkdsb2JhbCA9IFRydWUgDQoJCQlTZXQgTWF0Y2hlcyA9IFJFLkV4ZWN1dGUoaHRtbCkgDQoJCQlGb3IgRWFjaCBNYXRjaCBpbiBNYXRjaGVzDQoJCQkJSWYgSXNFbXB0eShzdWJodG1sX1RlbXBsYXRlTmFtZSkgVGhlbiBzdWJodG1sX1RlbXBsYXRlTmFtZT0idGVtcGxhdGU6IiZNYXRjaC5TdWJNYXRjaGVzKDApJiIiDQoJCQkJSWYgSXNFbXB0eShzdWJodG1sKSBUaGVuIHN1Ymh0bWw9R2V0VGVtcGxhdGUoIlRFTVBMQVRFX0JfIiYgVUNhc2UoTWF0Y2guU3ViTWF0Y2hlcygwKSkpDQoJCQkJRXhpdCBGb3INCgkJCU5leHQNCgkJCVNldCBNYXRjaGVzID0gTm90aGluZw0KCQlTZXQgUkUgPSBOb3RoaW5nDQoNCgkJSWYgc3ViaHRtbD0iIiBUaGVuDQoJCQlzdWJodG1sPWh0bWwNCgkJCXN1Ymh0bWxfVGVtcGxhdGVOYW1lPSJ0ZW1wbGF0ZTphcnRpY2xlX3NpbmdsZSINCgkJCWh0bWw9IjwjdGVtcGxhdGU6YXJ0aWNsZV9zaW5nbGUjPiINCgkJRW5kIElmDQoNCg0KCQkncGx1Z2luIG5vZGUNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RBcnRpY2xlX0V4cG9ydF9UZW1wbGF0ZShodG1sLHN1Ymh0bWwpDQoNCgkJJ3BsdWdpbiBub2RlDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfVGVtcGxhdGVfU3ViKFRlbXBsYXRlX0FydGljbGVfQ29tbWVudCxUZW1wbGF0ZV9BcnRpY2xlX1RyYWNrYmFjayxUZW1wbGF0ZV9BcnRpY2xlX1RhZyxUZW1wbGF0ZV9BcnRpY2xlX0NvbW1lbnRwb3N0LFRlbXBsYXRlX0FydGljbGVfTmF2YmFyX0wsVGVtcGxhdGVfQXJ0aWNsZV9OYXZiYXJfUixUZW1wbGF0ZV9BcnRpY2xlX011dHVhbGl0eSkNCg0KCQlzdWJodG1sPVJlcGxhY2Uoc3ViaHRtbCwiPCN0ZW1wbGF0ZTphcnRpY2xlX2NvbW1lbnQjPiIsVGVtcGxhdGVfQXJ0aWNsZV9Db21tZW50KQ0KCQlzdWJodG1sPVJlcGxhY2Uoc3ViaHRtbCwiPCN0ZW1wbGF0ZTphcnRpY2xlX3RyYWNrYmFjayM+IixUZW1wbGF0ZV9BcnRpY2xlX1RyYWNrYmFjaykNCgkJc3ViaHRtbD1SZXBsYWNlKHN1Ymh0bWwsIjwjdGVtcGxhdGU6YXJ0aWNsZV9jb21tZW50X3BhZ2ViYXIjPiIsIiIpDQoJCXN1Ymh0bWw9UmVwbGFjZShzdWJodG1sLCI8I3RlbXBsYXRlOmFydGljbGVfY29tbWVudHBvc3QjPiIsVGVtcGxhdGVfQXJ0aWNsZV9Db21tZW50cG9zdCkNCgkJc3ViaHRtbD1SZXBsYWNlKHN1Ymh0bWwsIjwjdGVtcGxhdGU6YXJ0aWNsZV90YWcjPiIsVGVtcGxhdGVfQXJ0aWNsZV9UYWcpDQoJCXN1Ymh0bWw9UmVwbGFjZShzdWJodG1sLCI8I3RlbXBsYXRlOmFydGljbGVfbmF2YmFyX2wjPiIsVGVtcGxhdGVfQXJ0aWNsZV9OYXZiYXJfTCkNCgkJc3ViaHRtbD1SZXBsYWNlKHN1Ymh0bWwsIjwjdGVtcGxhdGU6YXJ0aWNsZV9uYXZiYXJfciM+IixUZW1wbGF0ZV9BcnRpY2xlX05hdmJhcl9SKQ0KCQlzdWJodG1sPVJlcGxhY2Uoc3ViaHRtbCwiPCN0ZW1wbGF0ZTphcnRpY2xlX211dHVhbGl0eSM+IixUZW1wbGF0ZV9BcnRpY2xlX011dHVhbGl0eSkNCg0KCQlEaW0gZGENCgkJRGltIHMsdA0KCQlTZXQgZGE9Q3JlYXRlT2JqZWN0KCJTY3JpcHRpbmcuRGljdGlvbmFyeSIpDQoNCgkJU2V0IFJFID0gTmV3IFJlZ0V4cCANCgkJCVJFLlBhdHRlcm4gPSAiPCNhcnRpY2xlLygoY2F0ZWdvcnkvbWV0YXxhdXRob3IvbWV0YXxtZXRhKS8oW2EtejAtOV9dezEsfSkpIz4iDQoJCQlSRS5JZ25vcmVDYXNlID0gVHJ1ZSANCgkJCVJFLkdsb2JhbCA9IFRydWUgDQoJCQlTZXQgTWF0Y2hlcyA9IFJFLkV4ZWN1dGUoaHRtbCZzdWJodG1sKSANCgkJCUZvciBFYWNoIE1hdGNoIGluIE1hdGNoZXMNCgkJCQlzPU1hdGNoLlN1Yk1hdGNoZXMoMCkNCgkJCQlJZiBkYS5FeGlzdHMocyk9RmFsc2UgVGhlbiBkYS5hZGQgcyxzDQoJCQlOZXh0DQoJCQlTZXQgTWF0Y2hlcyA9IE5vdGhpbmcNCgkJU2V0IFJFID0gTm90aGluZw0KDQoJCXM9ZGEuSXRlbXMNCgkJRm9yIHQgPSAwIFRvIGRhLkNvdW50IC0xDQoJCQlJZiBJblN0cihzKHQpLCJjYXRlZ29yeS9tZXRhLyIpPjAgVGhlbg0KCQkJCXModCk9UmVwbGFjZShzKHQpLCJjYXRlZ29yeS9tZXRhLyIsIiIpDQoJCQkJc3ViaHRtbD1SZXBsYWNlKHN1Ymh0bWwsIjwjYXJ0aWNsZS9jYXRlZ29yeS9tZXRhLyIgJiBzKHQpICYgIiM+IixDYXRlZ29yeXMoQ2F0ZUlEKS5NZXRhLkdldFZhbHVlKHModCkpICkNCgkJCQlodG1sID0gUmVwbGFjZShodG1sLCI8I2FydGljbGUvY2F0ZWdvcnkvbWV0YS8iICYgcyh0KSAmICIjPiIsQ2F0ZWdvcnlzKENhdGVJRCkuTWV0YS5HZXRWYWx1ZShzKHQpKSApDQoJCQlFbHNlSWYgSW5TdHIocyh0KSwiYXV0aG9yL21ldGEvIik+MCBUaGVuIA0KCQkJCXModCk9UmVwbGFjZShzKHQpLCJhdXRob3IvbWV0YS8iLCIiKQ0KCQkJCXN1Ymh0bWw9UmVwbGFjZShzdWJodG1sLCI8I2FydGljbGUvYXV0aG9yL21ldGEvIiAmIHModCkgJiAiIz4iLFVzZXJzKEF1dGhvcklEKS5NZXRhLkdldFZhbHVlKHModCkpICkNCgkJCQlodG1sID0gUmVwbGFjZShodG1sLCI8I2FydGljbGUvYXV0aG9yL21ldGEvIiAmIHModCkgJiAiIz4iLFVzZXJzKEF1dGhvcklEKS5NZXRhLkdldFZhbHVlKHModCkpICkNCgkJCUVsc2UNCgkJCQlzKHQpPVJlcGxhY2Uocyh0KSwibWV0YS8iLCIiKQ0KCQkJCXN1Ymh0bWw9UmVwbGFjZShzdWJodG1sLCI8I2FydGljbGUvbWV0YS8iICYgcyh0KSAmICIjPiIsTWV0YS5HZXRWYWx1ZShzKHQpKSApDQoJCQkJaHRtbCA9IFJlcGxhY2UoaHRtbCwiPCNhcnRpY2xlL21ldGEvIiAmIHModCkgJiAiIz4iLE1ldGEuR2V0VmFsdWUocyh0KSkgKQ0KCQkJRW5kIElmDQoJCU5leHQNCg0KCQlJZiBaQ19NVUxUSV9ET01BSU5fU1VQUE9SVD1UcnVlIEFuZCBaQ19QRVJNQU5FTlRfRE9NQUlOX0VOQUJMRT1GYWxzZSBUaGVuDQoJCQlDb250ZW50PVJlcGxhY2UoQ29udGVudCwiaHJlZj0iIiIgJiBCbG9nSG9zdCwiaHJlZj0iIjwjWkNfQkxPR19IT1NUIz4iKQ0KCQkJQ29udGVudD1SZXBsYWNlKENvbnRlbnQsInNyYz0iIiIgJiBCbG9nSG9zdCwic3JjPSIiPCNaQ19CTE9HX0hPU1QjPiIpDQoJCQlJbnRybz1SZXBsYWNlKEludHJvLCJocmVmPSIiIiAmIEJsb2dIb3N0LCJocmVmPSIiPCNaQ19CTE9HX0hPU1QjPiIpDQoJCQlJbnRybz1SZXBsYWNlKEludHJvLCJzcmM9IiIiICYgQmxvZ0hvc3QsInNyYz0iIjwjWkNfQkxPR19IT1NUIz4iKQ0KCQlFbmQgSWYNCg0KCQlEaW0gYXJ5VGVtcGxhdGVUYWdzTmFtZSgpDQoJCURpbSBhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSgpDQoJCURpbSBpLGoNCgkJUmVEaW0gYXJ5VGVtcGxhdGVUYWdzTmFtZSg2NikNCgkJUmVEaW0gYXJ5VGVtcGxhdGVUYWdzVmFsdWUoNjYpDQoNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSgxKT0iYXJ0aWNsZS9pZCINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMSk9SUQNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSgyKT0iYXJ0aWNsZS9sZXZlbCINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMik9TGV2ZWwNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSgzKT0iYXJ0aWNsZS90aXRsZSINCgkJSWYgaW50VHlwZT1aQ19ESVNQTEFZX01PREVfU0VBUkNIIFRoZW4NCgkJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDMpPVNlYXJjaChUaXRsZSxTZWFyY2hUZXh0KQ0KCQlFbHNlDQoJCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSgzKT1IdG1sVGl0bGUNCgkJRW5kIElmDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoNCk9ImFydGljbGUvaW50cm8iDQoJCUlmIGludFR5cGU9WkNfRElTUExBWV9NT0RFX1NFQVJDSCBUaGVuDQoJCQknYXJ5VGVtcGxhdGVUYWdzVmFsdWUoNCk9U2VhcmNoKFRyYW5zZmVySFRNTChJbnRybyAmIENvbnRlbnQsIltodG1sLWZvcm1hdF0iKSxSZXF1ZXN0LlF1ZXJ5U3RyaW5nKCJxIikpDQoJCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSg0KT1UcmltKFNlYXJjaChUcmFuc2ZlckhUTUwoSW50cm8gJiBDb250ZW50LCJbbm9odG1sXSIpLFNlYXJjaFRleHQpKQ0KCQlFbHNlDQoJCQlJZiBMZXZlbD0yIFRoZW4NCgkJCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSg0KT0iPHA+IiZaQ19NU0cwNDMmIjwvcD4iDQoJCQlFbHNlDQoJCQkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoNCk9SHRtbEludHJvDQoJCQlFbmQgSWYNCgkJRW5kIElmDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoNSk9ImFydGljbGUvY29udGVudCINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoNSk9SHRtbENvbnRlbnQNCgkJSWYgaW50VHlwZT1aQ19ESVNQTEFZX01PREVfU0VBUkNIIFRoZW4NCgkJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDUpPWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDQpDQoJCUVuZCBJZg0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDYpPSJhcnRpY2xlL3Bvc3R0aW1lIg0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSg2KT1Qb3N0VGltZQ0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDcpPSJhcnRpY2xlL2NvbW1udW1zIg0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSg3KT1Db21tbnVtcw0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDgpPSJhcnRpY2xlL3ZpZXdudW1zIg0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSg4KT1WaWV3bnVtcw0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDkpPSJhcnRpY2xlL3RyYWNrYmFja251bXMiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDkpPVRyYWNrYmFja251bXMNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSgxMCk9ImFydGljbGUvdHJhY2tiYWNrX3VybCINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMTApPVRyYWNrQmFjaw0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDExKT0iYXJ0aWNsZS91cmwiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDExKT1UcmFuc2ZlckhUTUwoSHRtbFVybCwiW2FudGktemNfYmxvZ19ob3N0XSIpDQoNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSgxMik9ImFydGljbGUvY2F0ZWdvcnkvaWQiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDEyKT1DYXRlZ29yeXMoQ2F0ZUlEKS5JRA0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDEzKT0iYXJ0aWNsZS9jYXRlZ29yeS9uYW1lIg0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSgxMyk9Q2F0ZWdvcnlzKENhdGVJRCkuSHRtbE5hbWUNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSgxNSk9ImFydGljbGUvY2F0ZWdvcnkvb3JkZXIiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDE1KT1DYXRlZ29yeXMoQ2F0ZUlEKS5PcmRlcg0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDE2KT0iYXJ0aWNsZS9jYXRlZ29yeS9jb3VudCINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMTYpPUNhdGVnb3J5cyhDYXRlSUQpLkNvdW50DQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoMTcpPSJhcnRpY2xlL2NhdGVnb3J5L3VybCINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMTcpPVRyYW5zZmVySFRNTChDYXRlZ29yeXMoQ2F0ZUlEKS5IdG1sVXJsLCJbYW50aS16Y19ibG9nX2hvc3RdIikNCg0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDE4KT0iYXJ0aWNsZS9hdXRob3IvaWQiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDE4KT1Vc2VycyhBdXRob3JJRCkuSUQNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSgxOSk9ImFydGljbGUvYXV0aG9yL25hbWUiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDE5KT1Vc2VycyhBdXRob3JJRCkuRmlyc3ROYW1lDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoMjApPSJhcnRpY2xlL2F1dGhvci9sZXZlbCINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMjApPVVzZXJzKEF1dGhvcklEKS5MZXZlbA0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDIxKT0iYXJ0aWNsZS9hdXRob3IvZW1haWwiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDIxKT1Vc2VycyhBdXRob3JJRCkuRW1haWwNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSgyMik9ImFydGljbGUvYXV0aG9yL2hvbWVwYWdlIg0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSgyMik9VXNlcnMoQXV0aG9ySUQpLkhvbWVQYWdlDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoMjMpPSJhcnRpY2xlL2F1dGhvci9jb3VudCINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMjMpPVVzZXJzKEF1dGhvcklEKS5Db3VudA0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDI0KT0iYXJ0aWNsZS9hdXRob3IvdXJsIg0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSgyNCk9VHJhbnNmZXJIVE1MKFVzZXJzKEF1dGhvcklEKS5IdG1sVXJsLCJbYW50aS16Y19ibG9nX2hvc3RdIikNCg0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDI1KT0iYXJ0aWNsZS9wb3N0dGltZS9sb25nZGF0ZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMjUpPUZvcm1hdERhdGVUaW1lKFBvc3RUaW1lLHZiTG9uZ0RhdGUpDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoMjYpPSJhcnRpY2xlL3Bvc3R0aW1lL3Nob3J0ZGF0ZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMjYpPUZvcm1hdERhdGVUaW1lKFBvc3RUaW1lLHZiU2hvcnREYXRlKQ0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDI3KT0iYXJ0aWNsZS9wb3N0dGltZS9sb25ndGltZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMjcpPUZvcm1hdERhdGVUaW1lKFBvc3RUaW1lLHZiTG9uZ1RpbWUpDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoMjgpPSJhcnRpY2xlL3Bvc3R0aW1lL3Nob3J0dGltZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMjgpPUZvcm1hdERhdGVUaW1lKFBvc3RUaW1lLHZiU2hvcnRUaW1lKQ0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDI5KT0iYXJ0aWNsZS9wb3N0dGltZS95ZWFyIg0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSgyOSk9WWVhcihQb3N0VGltZSkNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSgzMCk9ImFydGljbGUvcG9zdHRpbWUvbW9udGgiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDMwKT1SaWdodCgiMCImTW9udGgoUG9zdFRpbWUpLDIpDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoMzEpPSJhcnRpY2xlL3Bvc3R0aW1lL21vbnRobmFtZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMzEpPVpWQV9Nb250aChNb250aChQb3N0VGltZSkpDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoMzIpPSJhcnRpY2xlL3Bvc3R0aW1lL2RheSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMzIpPVJpZ2h0KCIwIiZEYXkoUG9zdFRpbWUpLDIpDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoMzMpPSJhcnRpY2xlL3Bvc3R0aW1lL3dlZWtkYXkiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDMzKT1XZWVrZGF5KFBvc3RUaW1lKQ0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDM0KT0iYXJ0aWNsZS9wb3N0dGltZS93ZWVrZGF5bmFtZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMzQpPVpWQV9XZWVrKFdlZWtkYXkoUG9zdFRpbWUpKQ0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDM1KT0iYXJ0aWNsZS9wb3N0dGltZS9ob3VyIg0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSgzNSk9UmlnaHQoIjAiJkhvdXIoUG9zdFRpbWUpLDIpDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoMzYpPSJhcnRpY2xlL3Bvc3R0aW1lL21pbnV0ZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMzYpPVJpZ2h0KCIwIiZNaW51dGUoUG9zdFRpbWUpLDIpDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoMzcpPSJhcnRpY2xlL3Bvc3R0aW1lL3NlY29uZCINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMzcpPVJpZ2h0KCIwIiZTZWNvbmQoUG9zdFRpbWUpLDIpDQoNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSgzOCk9ImFydGljbGUvY29tbWVudHJzcyINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMzgpPVRyYW5zZmVySFRNTChXZndDb21tZW50UnNzLCJbYW50aS16Y19ibG9nX2hvc3RdIikNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSgzOSk9ImFydGljbGUvY29tbWVudHBvc3R1cmwiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDM5KT1UcmFuc2ZlckhUTUwoQ29tbWVudFBvc3RVcmwsIltodG1sLWZvcm1hdF1bYW50aS16Y19ibG9nX2hvc3RdIikNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSg0MCk9ImFydGljbGUvcHJldHJhY2tiYWNrX3VybCINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoNDApPVRyYW5zZmVySFRNTChQcmVUcmFja0JhY2ssIltodG1sLWZvcm1hdF1bYW50aS16Y19ibG9nX2hvc3RdIikNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSg0MSk9ImFydGljbGUvdHJhY2tiYWNra2V5Ig0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSg0MSk9VHJhY2tCYWNrS2V5DQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoNDIpPSJhcnRpY2xlL2NvbW1lbnRrZXkiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDQyKT1Db21tZW50S2V5DQoNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSg0Myk9ImFydGljbGUvc3RhdGljbmFtZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoNDMpPVN0YXRpY05hbWUNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSg0NCk9ImFydGljbGUvY2F0ZWdvcnkvc3RhdGljbmFtZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoNDQpPUNhdGVnb3J5cyhDYXRlSUQpLlN0YXRpY05hbWUNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSg0NSk9ImFydGljbGUvYXV0aG9yL3N0YXRpY25hbWUiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDQ1KT1Vc2VycyhBdXRob3JJRCkuU3RhdGljTmFtZQ0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDQ2KT0iYXJ0aWNsZS90YWd0b25hbWUiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDQ2KT1UYWdUb05hbWUNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSg0Nyk9ImFydGljbGUvZmlyc3R0YWdpbnRybyINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoNDcpPUZpcnN0VGFnSW50cm8NCg0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDQ4KT0iYXJ0aWNsZS9wb3N0dGltZS9tb250aG5hbWVhYmJyIg0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSg0OCk9WlZBX01vbnRoX0FiYnIoTW9udGgoUG9zdFRpbWUpKQ0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDQ5KT0iYXJ0aWNsZS9wb3N0dGltZS93ZWVrZGF5bmFtZWFiYnIiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDQ5KT1aVkFfV2Vla19BYmJyKFdlZWtkYXkoUG9zdFRpbWUpKQ0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDUwKT0iYXJ0aWNsZS9hdXRob3IvaW50cm8iDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDUwKT1Vc2VycyhBdXRob3JJRCkuSW50cm8NCg0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDUxKT0idGVtcGxhdGU6c2lkZWJhciINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoNTEpPUdldFRlbXBsYXRlKCJDQUNIRV9TSURFQkFSIikNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSg1Mik9InRlbXBsYXRlOnNpZGViYXIyIg0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSg1Mik9R2V0VGVtcGxhdGUoIkNBQ0hFX1NJREVCQVIyIikNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSg1Myk9InRlbXBsYXRlOnNpZGViYXIzIg0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSg1Myk9R2V0VGVtcGxhdGUoIkNBQ0hFX1NJREVCQVIzIikNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSg1NCk9InRlbXBsYXRlOnNpZGViYXI0Ig0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSg1NCk9R2V0VGVtcGxhdGUoIkNBQ0hFX1NJREVCQVI0IikNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSg1NSk9InRlbXBsYXRlOnNpZGViYXI1Ig0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSg1NSk9R2V0VGVtcGxhdGUoIkNBQ0hFX1NJREVCQVI1IikNCg0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDU2KT0iYXJ0aWNsZS9hbGlhcyINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoNTYpPUFsaWFzDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoNTcpPSJhcnRpY2xlL2xvYWR2aWV3Y291bnQiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDU3KT0iPHNwYW4gaWQ9IiJzcG4iJklEJiIiIj48L3NwYW4+PHNjcmlwdCB0eXBlPSIidGV4dC9qYXZhc2NyaXB0IiI+TG9hZFZpZXdDb3VudCgiJklEJiIpPC9zY3JpcHQ+Ig0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDU4KT0iYXJ0aWNsZS9hZGR2aWV3Y291bnQiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDU4KT0iPHNwYW4gaWQ9IiJzcG4iJklEJiIiIj48L3NwYW4+PHNjcmlwdCB0eXBlPSIidGV4dC9qYXZhc2NyaXB0IiI+QWRkVmlld0NvdW50KCImSUQmIik8L3NjcmlwdD4iDQoNCg0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDU5KT0iYXJ0aWNsZS9jYXRlZ29yeS9wYXJlbnQvaWQiDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoNjApPSJhcnRpY2xlL2NhdGVnb3J5L3BhcmVudC9uYW1lIg0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKDYxKT0iYXJ0aWNsZS9jYXRlZ29yeS9wYXJlbnQvb3JkZXIiDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoNjIpPSJhcnRpY2xlL2NhdGVnb3J5L3BhcmVudC9jb3VudCINCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSg2Myk9ImFydGljbGUvY2F0ZWdvcnkvcGFyZW50L3VybCINCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSg2NCk9ImFydGljbGUvY2F0ZWdvcnkvcGFyZW50L3N0YXRpY25hbWUiDQoNCgkJSWYgQ2F0ZWdvcnlzKENhdGVJRCkuUGFyZW50SUQ8PjAgVGhlbg0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSg1OSk9Q2F0ZWdvcnlzKENhdGVnb3J5cyhDYXRlSUQpLlBhcmVudElEKS5JRA0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSg2MCk9Q2F0ZWdvcnlzKENhdGVnb3J5cyhDYXRlSUQpLlBhcmVudElEKS5IdG1sTmFtZQ0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSg2MSk9Q2F0ZWdvcnlzKENhdGVnb3J5cyhDYXRlSUQpLlBhcmVudElEKS5PcmRlcg0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSg2Mik9Q2F0ZWdvcnlzKENhdGVnb3J5cyhDYXRlSUQpLlBhcmVudElEKS5Db3VudA0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSg2Myk9VHJhbnNmZXJIVE1MKENhdGVnb3J5cyhDYXRlZ29yeXMoQ2F0ZUlEKS5QYXJlbnRJRCkuSHRtbFVybCwiW2FudGktemNfYmxvZ19ob3N0XSIpDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDY0KT1DYXRlZ29yeXMoQ2F0ZWdvcnlzKENhdGVJRCkuUGFyZW50SUQpLlN0YXRpY05hbWUNCgkJRW5kIElmDQoNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSg2NSk9ImFydGljbGUvYXV0aG9yL2F2YXRhciINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoNjUpPVVzZXJzKEF1dGhvcklEKS5BdmF0YXINCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSg2Nik9ImFydGljbGUvYXV0aG9yL2xldmVsbmFtZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoNjYpPVVzZXJzKEF1dGhvcklEKS5MZXZlbE5hbWUNCg0KDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfVGVtcGxhdGVUYWdzKGFyeVRlbXBsYXRlVGFnc05hbWUsYXJ5VGVtcGxhdGVUYWdzVmFsdWUpDQoNCgkJaj1VQm91bmQoYXJ5VGVtcGxhdGVUYWdzTmFtZSkNCgkJRm9yIGk9MSB0byBqDQoJCQlJZiBJc051bGwoYXJ5VGVtcGxhdGVUYWdzVmFsdWUoaSkpPUZhbHNlIFRoZW4NCgkJCQlzdWJodG1sPVJlcGxhY2Uoc3ViaHRtbCwiPCMiICYgYXJ5VGVtcGxhdGVUYWdzTmFtZShpKSAmICIjPiIsYXJ5VGVtcGxhdGVUYWdzVmFsdWUoaSkpDQoJCQkJaHRtbCA9IFJlcGxhY2UoaHRtbCwiPCMiICYgYXJ5VGVtcGxhdGVUYWdzTmFtZShpKSAmICIjPiIsIGFyeVRlbXBsYXRlVGFnc1ZhbHVlKGkpKQ0KCQkJRW5kIElmDQoJCU5leHQNCg0KCQlTZXQgUkUgPSBOZXcgUmVnRXhwIA0KCQlSRS5JZ25vcmVDYXNlID0gVHJ1ZSANCgkJUkUuR2xvYmFsID0gVHJ1ZSANCg0KCQlJZiBIYXNUYWc9RmFsc2UgVGhlbg0KCQkJUkUuUGF0dGVybiA9ICI8I3RlbXBsYXRlOmFydGljbGVfdGFnOmJlZ2luIz4oLnxcbikqPCN0ZW1wbGF0ZTphcnRpY2xlX3RhZzplbmQjPiINCgkJCXN1Ymh0bWwgPSBSRS5SZXBsYWNlKHN1Ymh0bWwsICIiKQ0KCQlFbHNlDQoJCQlzdWJodG1sPVJlcGxhY2Uoc3ViaHRtbCwiPCN0ZW1wbGF0ZTphcnRpY2xlX3RhZzpiZWdpbiM+IiwiIikNCgkJCXN1Ymh0bWw9UmVwbGFjZShzdWJodG1sLCI8I3RlbXBsYXRlOmFydGljbGVfdGFnOmVuZCM+IiwiIikNCgkJRW5kIElmDQoJCUlmIEhhc0NNVGFuZFRCPUZhbHNlIFRoZW4NCgkJCVJFLlBhdHRlcm4gPSAiPCN0ZW1wbGF0ZTphcnRpY2xlX2NvbW1lbnQ6YmVnaW4jPigufFxuKSo8I3RlbXBsYXRlOmFydGljbGVfY29tbWVudDplbmQjPiINCgkJCXN1Ymh0bWwgPSBSRS5SZXBsYWNlKHN1Ymh0bWwsICI8aW5zIHN0eWxlPSIiZGlzcGxheTpub25lOyIiIGlkPSIiQWpheENvbW1lbnRFbmQiIj48L2lucz48aW5zIHN0eWxlPSIiZGlzcGxheTpub25lOyIiIGlkPSIiQWpheENvbW1lbnRCZWdpbiIiPjwvaW5zPiIpIA0KCQlFbHNlDQoJCQlzdWJodG1sPVJlcGxhY2Uoc3ViaHRtbCwiPCN0ZW1wbGF0ZTphcnRpY2xlX2NvbW1lbnQ6YmVnaW4jPiIsIiIpDQoJCQlzdWJodG1sPVJlcGxhY2Uoc3ViaHRtbCwiPCN0ZW1wbGF0ZTphcnRpY2xlX2NvbW1lbnQ6ZW5kIz4iLCIiKQ0KCQlFbmQgSUYNCgkJSWYgSGFzTXV0dWFsaXR5PUZhbHNlIFRoZW4NCgkJCVJFLlBhdHRlcm4gPSAiPCN0ZW1wbGF0ZTphcnRpY2xlX211dHVhbGl0eTpiZWdpbiM+KC58XG4pKjwjdGVtcGxhdGU6YXJ0aWNsZV9tdXR1YWxpdHk6ZW5kIz4iDQoJCQlzdWJodG1sID0gUkUuUmVwbGFjZShzdWJodG1sLCAiIikgDQoJCUVsc2UNCgkJCXN1Ymh0bWw9UmVwbGFjZShzdWJodG1sLCI8I3RlbXBsYXRlOmFydGljbGVfbXV0dWFsaXR5OmJlZ2luIz4iLCIiKQ0KCQkJc3ViaHRtbD1SZXBsYWNlKHN1Ymh0bWwsIjwjdGVtcGxhdGU6YXJ0aWNsZV9tdXR1YWxpdHk6ZW5kIz4iLCIiKQ0KCQlFbmQgSWYNCg0KCQlJZiBDYXRlZ29yeXMoQ2F0ZUlEKS5QYXJlbnRJRD0wIFRoZW4NCgkJCVJFLlBhdHRlcm4gPSAiPCN0ZW1wbGF0ZTphcnRpY2xlX2NhdGVnb3J5X3BhcmVudDpiZWdpbiM+KC58XG4pKjwjdGVtcGxhdGU6YXJ0aWNsZV9jYXRlZ29yeV9wYXJlbnQ6ZW5kIz4iDQoJCQlzdWJodG1sID0gUkUuUmVwbGFjZShzdWJodG1sLCAiIikNCgkJRWxzZQ0KCQkJc3ViaHRtbD1SZXBsYWNlKHN1Ymh0bWwsIjwjdGVtcGxhdGU6YXJ0aWNsZV9jYXRlZ29yeV9wYXJlbnQ6YmVnaW4jPiIsIiIpDQoJCQlzdWJodG1sPVJlcGxhY2Uoc3ViaHRtbCwiPCN0ZW1wbGF0ZTphcnRpY2xlX2NhdGVnb3J5X3BhcmVudDplbmQjPiIsIiIpDQoJCUVuZCBJZg0KCQlTZXQgUkUgPSBOb3RoaW5nDQoNCg0KCQlodG1sPVJlcGxhY2UoaHRtbCwiPCMiJnN1Ymh0bWxfVGVtcGxhdGVOYW1lJiIjPiIsc3ViaHRtbCkNCg0KCQlFeHBvcnQ9VHJ1ZQ0KDQoJCSdwbHVnaW4gbm9kZQ0KCQliQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfRW5kPUZhbHNlDQoJCUZvciBFYWNoIHNBY3Rpb25fUGx1Z2luX1RBcnRpY2xlX0V4cG9ydF9FbmQgaW4gQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfRW5kDQoJCQlJZiBOb3QgSXNFbXB0eShzQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfRW5kKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9FeHBvcnRfRW5kKQ0KCQkJSWYgYkFjdGlvbl9QbHVnaW5fVEFydGljbGVfRXhwb3J0X0VuZD1UcnVlIFRoZW4gRXhpdCBGdW5jdGlvbg0KCQlOZXh0DQoNCglFbmQgRnVuY3Rpb24NCg0KDQoNCg0KCUZ1bmN0aW9uIEJ1aWxkKCkNCg0KCQlEaW0gYXJ5VGVtcGxhdGVUYWdzTmFtZQ0KCQlEaW0gYXJ5VGVtcGxhdGVUYWdzVmFsdWUNCg0KCQlEaW0gaSxqDQoNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RBcnRpY2xlX0J1aWxkX1RlbXBsYXRlKGh0bWwpDQoNCgkJVGVtcGxhdGVUYWdzRGljLkl0ZW0oIkJsb2dUaXRsZSIpPUh0bWxUaXRsZQ0KCQlUZW1wbGF0ZVRhZ3NEaWMuSXRlbSgiWkNfQkxPR19IT1NUIik9QmxvZ0hvc3QNCg0KCQlJZiBUZW1wbGF0ZV9DYWxlbmRhcj0iIiBUaGVuIFRlbXBsYXRlX0NhbGVuZGFyPSI8c2NyaXB0IHNyYz0iIjwjWkNfQkxPR19IT1NUIz56Yl9zeXN0ZW0vZnVuY3Rpb24vY19odG1sX2pzLmFzcD9kYXRlPW5vdyIiIHR5cGU9IiJ0ZXh0L2phdmFzY3JpcHQiIj48L3NjcmlwdD4iDQoNCgkJSWYgWkNfTVVMVElfRE9NQUlOX1NVUFBPUlQ9VHJ1ZSBBbmQgWkNfUEVSTUFORU5UX0RPTUFJTl9FTkFCTEU9RmFsc2UgVGhlbg0KCQkJRGltIHgseQ0KCQkJeD1DU3RyKFJlcGxhY2UoVXJsLEJsb2dIb3N0LCIiKSkNCgkJCXg9UmVwbGFjZSh4LCIvLy8vLyIsIi8iKTp4PVJlcGxhY2UoeCwiLy8vLyIsIi8iKTp4PVJlcGxhY2UoeCwiLy8vIiwiLyIpOng9UmVwbGFjZSh4LCIvLyIsIi8iKQ0KCQkJRm9yIGk9MSBUbyBVQm91bmQoU3BsaXQoeCwiLyIpKQ0KCQkJCXk9eSAmICIuLi8iDQoJCQlOZXh0DQoJCQlJZiB5PSIiIFRoZW4geT0iLi8iDQoJCQlUZW1wbGF0ZVRhZ3NEaWMuSXRlbSgiWkNfQkxPR19IT1NUIik9eQ0KCQlFbmQgSWYNCg0KDQoJCWFyeVRlbXBsYXRlVGFnc05hbWU9VGVtcGxhdGVUYWdzRGljLktleXMNCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWU9VGVtcGxhdGVUYWdzRGljLkl0ZW1zDQoNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RBcnRpY2xlX0J1aWxkX1RlbXBsYXRlVGFncyhhcnlUZW1wbGF0ZVRhZ3NOYW1lLGFyeVRlbXBsYXRlVGFnc1ZhbHVlKQ0KDQoJCURpbSBzLHQNCg0KCQlqPVVCb3VuZChhcnlUZW1wbGF0ZVRhZ3NOYW1lKQ0KCQlGb3IgaT0xIHRvIGoNCgkJCUlmIChJblN0cihhcnlUZW1wbGF0ZVRhZ3NOYW1lKGkpLCJDQUNIRV9JTkNMVURFXyIpPjApIEFuZCAoUmlnaHQoYXJ5VGVtcGxhdGVUYWdzTmFtZShpKSw1KTw+Il9IVE1MIikgQW5kIChSaWdodChhcnlUZW1wbGF0ZVRhZ3NOYW1lKGkpLDMpPD4iX0pTIikgVGhlbg0KCQkJCXM9cyAmIGFyeVRlbXBsYXRlVGFnc05hbWUoaSkgJiAifCINCgkJCUVuZCBJZg0KCQkJSWYgKCI8IyIgJiBhcnlUZW1wbGF0ZVRhZ3NOYW1lKGkpICYgIiM+Ij0iPCNDQUNIRV9JTkNMVURFX0NBTEVOREFSIz4iKSBPciAoIjwjIiAmIGFyeVRlbXBsYXRlVGFnc05hbWUoaSkgJiAiIz4iPSI8I0NBQ0hFX0lOQ0xVREVfQ0FMRU5EQVJfSlMjPiIpIE9yICgiPCMiICYgYXJ5VGVtcGxhdGVUYWdzTmFtZShpKSAmICIjPiI9IjwjQ0FDSEVfSU5DTFVERV9DQUxFTkRBUl9OT1cjPiIpIFRoZW4NCgkJCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZShpKT1UZW1wbGF0ZV9DYWxlbmRhcg0KCQkJRW5kIElmDQoJCU5leHQNCg0KDQoJCUlmIElzRHluYW1pY0xvYWRTaWxkYmFyPVRydWUgVGhlbg0KCQkJRm9yIEVhY2ggdCBJbiBTcGxpdChzLCJ8IikNCgkJCQlJZiB0PSIiIFRoZW4gRXhpdCBGb3INCgkJCQlJZiB0PD4iQ0FDSEVfSU5DTFVERV9OQVZCQVIiIFRoZW4NCgkJCQkJaHRtbD1SZXBsYWNlKGh0bWwsIjwjIiZ0JiIjPiIsIjwjIiZ0JiJfSlMjPiIpDQoJCQkJRW5kIElmDQoJCQlOZXh0DQoJCUVuZCBJZg0KDQoNCgkJaj1VQm91bmQoYXJ5VGVtcGxhdGVUYWdzTmFtZSkNCg0KCQlGb3IgaT0xIHRvIGoNCgkJCWh0bWw9UmVwbGFjZShodG1sLCI8IyIgJiBhcnlUZW1wbGF0ZVRhZ3NOYW1lKGkpICYgIiM+IixhcnlUZW1wbGF0ZVRhZ3NWYWx1ZShpKSkNCgkJTmV4dA0KCQlodG1sPVJlcGxhY2UoaHRtbCwiPCMiICYgYXJ5VGVtcGxhdGVUYWdzTmFtZSgwKSAmICIjPiIsYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMCkpDQoNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RBcnRpY2xlX0J1aWxkX1RlbXBsYXRlX1N1Y2NlZWQoaHRtbCkNCg0KCQlCdWlsZD1UcnVlDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJUHVibGljIEZ1bmN0aW9uIFN0YXRpc3RpYygpDQoNCgkJQ2FsbCBHZXRVc2Vyc2J5VXNlcklETGlzdChBdXRob3JJRCkNCg0KCQkn6YeN5paw57uf6K6h5YiG57G75Y+K55So5oi355qE5paH56ug5pWw44CB6K+E6K665pWwDQoJCURpbSBzdHJTUUwsYXJ5MSgyKSxhcnkyKDIpLGFyeTMoMikNCgkJc3RyU1FMPSJTRUxFQ1QiDQoJCWFyeTEoMCk9VHJ1ZQ0KCQlhcnkyKDApPSIoU0VMRUNUIENPVU5UKFtsb2dfSURdKSBGUk9NIFtibG9nX0NvbW1lbnRdIFdIRVJFIFtsb2dfSURdID0iICYgSUQgJiAiIEFORCBbY29tbV9QYXJlbnRJRF09MCBBTkQgW2NvbW1faXNDaGVja109MCkgQXMgW2NvbW1fY291bnRdIg0KCQlhcnkzKDApPSJTRUxFQ1QgQ09VTlQoW2xvZ19JRF0pIEFzIFtjb21tX2NvdW50XSBGUk9NIFtibG9nX0NvbW1lbnRdIFdIRVJFIFtsb2dfSURdID0iICYgSUQgJiAiIEFORCBbY29tbV9QYXJlbnRJRF09MCBBTkQgW2NvbW1faXNDaGVja109MCINCg0KDQoJCWFyeTEoMSk9SUlmKENhdGVnb3J5cyhDYXRlSUQpLlJlQ291bnQ9MCxUcnVlLEZhbHNlKQ0KCQlhcnkyKDEpPSIoU0VMRUNUIENPVU5UKFtsb2dfSURdKSBGUk9NIFtibG9nX0FydGljbGVdIFdIRVJFIFtsb2dfTGV2ZWxdPjEgQU5EIFtsb2dfVHlwZV09MCBBTkQgW2xvZ19DYXRlSURdPSIgJiBDYXRlSUQgJiAiKSBBcyBbY2F0ZV9jb3VudF0iDQoJCWFyeTMoMSk9IlNFTEVDVCBDT1VOVChbbG9nX0lEXSkgQXMgW2NhdGVfY291bnRdIEZST00gW2Jsb2dfQXJ0aWNsZV0gV0hFUkUgW2xvZ19MZXZlbF0+MSBBTkQgW2xvZ19UeXBlXT0wIEFORCBbbG9nX0NhdGVJRF09IiAmIENhdGVJRCANCg0KDQoJCWFyeTEoMik9SUlmKFVzZXJzKEF1dGhvcklEKS5SZUNvdW50PTAsVHJ1ZSxGYWxzZSkNCgkJYXJ5MigyKT0iKFNFTEVDVCBDT1VOVChbbG9nX0lEXSkgRlJPTSBbYmxvZ19BcnRpY2xlXSBXSEVSRSBbbG9nX0xldmVsXT4xIEFORCBbbG9nX1R5cGVdPTAgQU5EIFtsb2dfQXV0aG9ySURdPSIgJiBBdXRob3JJRCAmIikgQXMgW2F1dGhvcl9jb3VudF0iDQoJCWFyeTMoMik9IlNFTEVDVCBDT1VOVChbbG9nX0lEXSkgQXMgW2F1dGhvcl9jb3VudF0gRlJPTSBbYmxvZ19BcnRpY2xlXSBXSEVSRSBbbG9nX0xldmVsXT4xIEFORCBbbG9nX1R5cGVdPTAgQU5EIFtsb2dfQXV0aG9ySURdPSIgJiBBdXRob3JJRCANCg0KCQlzdHJTUUw9c3RyU1FMICYgSUlmKGFyeTEoMCksYXJ5MigwKSwiIikNCgkJc3RyU1FMPXN0clNRTCAmIElJZihhcnkxKDEpLElJZihzdHJTUUw9IiIsIiAiLCIsIikgJiBhcnkyKDEpLCIiKQ0KCQlzdHJTUUw9c3RyU1FMICYgSUlmKGFyeTEoMiksSUlmKHN0clNRTD0iIiwiICIsIiwiKSAmIGFyeTIoMiksIiIpDQoJCURpbSBvYmpSUyxpLGlzQm9vbA0KCQlpPTANCgkJSWYgWkNfTVNTUUxfRU5BQkxFIFRoZW4NCgkJCVNldCBvYmpSUz1vYmpDb25uLkV4ZWN1dGUoc3RyU1FMKQ0KCQkJaXNCb29sPShOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpDQoJCUVsc2UNCgkJCWlzQm9vbD1UcnVlDQoJCUVuZCBJZg0KCQkNCgkJSWYgaXNCb29sIFRoZW4NCg0KCQkJSWYgYXJ5MSgwKSBUaGVuIA0KCQkJCQ0KCQkJCUlmIE5vdCBaQ19NU1NRTF9FTkFCTEUgVGhlbiBTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKGFyeTMoMCkpDQoJCQkJQ29tbU51bXM9b2JqUnMoImNvbW1fY291bnQiKQ0KCQkJCW9iakNvbm4uRXhlY3V0ZSgiVVBEQVRFIFtibG9nX0FydGljbGVdIFNFVCBbbG9nX0NvbW1OdW1zXT0iJiBDb21tTnVtcyAmIiBXSEVSRSBbbG9nX0lEXSA9IiAmIElEKQ0KCQkJCQ0KCQkJRW5kIElmDQoJCQkNCgkJCUlmIGFyeTEoMSkgVGhlbg0KCQkJDQoJCQkJSWYgTm90IFpDX01TU1FMX0VOQUJMRSBUaGVuIFNldCBvYmpSUz1vYmpDb25uLkV4ZWN1dGUoYXJ5MygxKSkNCgkJCQlDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX1VOQ0FURUdPUklaRURfQ09VTlQiLDEpDQoJCQkJQ2F0ZWdvcnlzKENhdGVJRCkuUmVDb3VudD1vYmpScygiY2F0ZV9jb3VudCIpDQoJCQkJSWYgQ2F0ZUlEPTAgVGhlbg0KCQkJCQlDYWxsIEJsb2dDb25maWcuV3JpdGUoIlpDX1VOQ0FURUdPUklaRURfQ09VTlQiLENhdGVnb3J5cyhDYXRlSUQpLlJlQ291bnQpDQoJCQkJRWxzZQ0KCQkJCQlvYmpDb25uLkV4ZWN1dGUoIlVQREFURSBbYmxvZ19DYXRlZ29yeV0gU0VUIFtjYXRlX0NvdW50XT0iJkNhdGVnb3J5cyhDYXRlSUQpLlJlQ291bnQmIiBXSEVSRSBbY2F0ZV9JRF0gPSIgJiBDYXRlSUQpDQoJCQkJRW5kIElmDQoJCQkJQ2F0ZWdvcnlzKENhdGVJRCkuQ291bnQ9Q2F0ZWdvcnlzKENhdGVJRCkuUmVDb3VudA0KCQkJCSfljp/liIbnsbvorqHmlbDvvI0xDQoJCQkJRGltIENhdGVfRXhJRDpDYXRlX0V4SUQ9Q2F0ZWdvcnlzKENhdGVJRCkuRXhJRA0KCQkJCUlmIENhdGVfRXhJRDw+LTEgVGhlbg0KCQkJCQlDYXRlZ29yeXMoQ2F0ZV9FeElEKS5SZUNvdW50PUNhdGVnb3J5cyhDYXRlX0V4SUQpLkNvdW50LTENCgkJCQkJSWYgQ2F0ZV9FeElEPTAgVGhlbg0KCQkJCQkJQ2FsbCBCbG9nQ29uZmlnLldyaXRlKCJaQ19VTkNBVEVHT1JJWkVEX0NPVU5UIixDYXRlZ29yeXMoQ2F0ZV9FeElEKS5SZUNvdW50KQ0KCQkJCQlFbHNlDQoJCQkJCQlvYmpDb25uLkV4ZWN1dGUoIlVQREFURSBbYmxvZ19DYXRlZ29yeV0gU0VUIFtjYXRlX0NvdW50XT0iJkNhdGVnb3J5cyhDYXRlX0V4SUQpLlJlQ291bnQmIiBXSEVSRSBbY2F0ZV9JRF0gPSIgJiBDYXRlX0V4SUQpDQoJCQkJCUVuZCBJZg0KCQkJCQlDYXRlZ29yeXMoQ2F0ZV9FeElEKS5Db3VudD1DYXRlZ29yeXMoQ2F0ZV9FeElEKS5SZUNvdW50DQoJCQkJRW5kIElmIA0KCQkJCUJsb2dDb25maWcuU2F2ZQ0KCQkJCQ0KCQkJRW5kIElmDQoJCQkNCgkJCUlmIGFyeTEoMikgVGhlbg0KCQkJDQoJCQkJSWYgTm90IFpDX01TU1FMX0VOQUJMRSBUaGVuIFNldCBvYmpSUz1vYmpDb25uLkV4ZWN1dGUoYXJ5MygyKSkNCgkJCQlVc2VycyhBdXRob3JJRCkuUmVDb3VudD1vYmpScygiYXV0aG9yX2NvdW50IikNCgkJCQlvYmpDb25uLkV4ZWN1dGUoIlVQREFURSBbYmxvZ19NZW1iZXJdIFNFVCBbbWVtX1Bvc3RMb2dzXT0iJlVzZXJzKEF1dGhvcklEKS5SZUNvdW50JiIgV0hFUkUgW21lbV9JRF0gPSIgJiBBdXRob3JJRCkNCgkJCQlVc2VycyhBdXRob3JJRCkuQ291bnQ9VXNlcnMoQXV0aG9ySUQpLlJlQ291bnQNCgkJCQkn5Y6f55So5oi36K6h5pWw77yNMQ0KCQkJCURpbSBVc2VyX0V4SUQ6VXNlcl9FeElEPVVzZXJzKEF1dGhvcklEKS5FeElEDQoJCQkJSWYgVXNlcl9FeElEPD4tMSBUaGVuDQoJCQkJDQoJCQkJCVVzZXJzKFVzZXJfRXhJRCkuUmVDb3VudD1Vc2VycyhVc2VyX0V4SUQpLkNvdW50LTENCgkJCQkJb2JqQ29ubi5FeGVjdXRlKCJVUERBVEUgW2Jsb2dfTWVtYmVyXSBTRVQgW21lbV9Qb3N0TG9nc109IiZVc2VycyhVc2VyX0V4SUQpLlJlQ291bnQmIiBXSEVSRSBbbWVtX0lEXSA9IiAmIFVzZXJfRXhJRCkNCgkJCQkJVXNlcnMoVXNlcl9FeElEKS5Db3VudD1Vc2VycyhVc2VyX0V4SUQpLlJlQ291bnQNCgkJCQkJDQoJCQkJRW5kIElmIA0KCQkJCQ0KCQkJRW5kIElmDQoJCQkNCgkJRW5kIElmDQoNCgkJb2JqUnMuQ2xvc2UNCgkJU2V0IG9ialJzPU5vdGhpbmcNCg0KCQknRnVsbFVybD1SZXBsYWNlKFVybCxCbG9nSG9zdCwiPCNaQ19CTE9HX0hPU1QjPiIpDQoJCSdvYmpDb25uLkV4ZWN1dGUoIlVQREFURSBbYmxvZ19BcnRpY2xlXSBTRVQgW2xvZ19GdWxsVXJsXT0nIiZGdWxsVXJsJiInIFdIRVJFIFtsb2dfSURdID0iICYgSUQpDQoNCgkJU3RhdGlzdGljPVRydWUNCg0KCUVuZCBGdW5jdGlvbg0KDQoNCglGdW5jdGlvbiBTZXRWYXIoVGVtcGxhdGVUYWcsVGVtcGxhdGVWYWx1ZSkNCg0KCQlJZiBJc0VtcHR5KGh0bWwpIFRoZW4gaHRtbD1UZW1wbGF0ZQ0KDQoJCWh0bWw9UmVwbGFjZShodG1sLCI8IyIgJiBUZW1wbGF0ZVRhZyAmICIjPiIsVGVtcGxhdGVWYWx1ZSkNCg0KCUVuZCBGdW5jdGlvbg0KDQoNCglGdW5jdGlvbiBTYXZlKCkNCg0KCQkncGx1Z2luIG5vZGUNCgkJYkFjdGlvbl9QbHVnaW5fVEFydGljbGVfU2F2ZV9CZWdpbj1GYWxzZQ0KCQlGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZV9TYXZlX0JlZ2luIGluIEFjdGlvbl9QbHVnaW5fVEFydGljbGVfU2F2ZV9CZWdpbg0KCQkJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fVEFydGljbGVfU2F2ZV9CZWdpbikgVGhlbiBDYWxsIEV4ZWN1dGUoc0FjdGlvbl9QbHVnaW5fVEFydGljbGVfU2F2ZV9CZWdpbikNCgkJCUlmIGJBY3Rpb25fUGx1Z2luX1RBcnRpY2xlX1NhdmVfQmVnaW49VHJ1ZSBUaGVuIEV4aXQgRnVuY3Rpb24NCgkJTmV4dA0KDQoJCUlmIFpDX1BPU1RfU1RBVElDX01PREU8PiJTVEFUSUMiIFRoZW4gRXhpdCBGdW5jdGlvbg0KDQoJCUlmIE5vdChMZXZlbD4yKSBUaGVuIFNhdmU9VHJ1ZTpFeGl0IEZ1bmN0aW9uDQoNCgkJRGltIG9ialN0cmVhbQ0KDQoJCWh0bWw9VHJhbnNmZXJIVE1MKGh0bWwsIltuby1hc3BdIikNCg0KCQlJZiBaQ19TVEFUSUNfVFlQRT0iYXNwIiBUaGVuDQoJCQlodG1sPSI8IiYiJUAgQ09ERVBBR0U9NjUwMDEgJSImIj4iICYgaHRtbA0KCQlFbmQgSWYNCg0KCQlDYWxsIENyZWF0RGlyZWN0b3J5QnlDdXN0b21EaXJlY3RvcnlXaXRoRnVsbEJsb2dQYXRoKEZ1bGxQYXRoKQ0KDQoJCUNhbGwgU2F2ZVRvRmlsZShGdWxsUGF0aCxodG1sLCJ1dGYtOCIsRmFsc2UpDQoNCgkJU2F2ZT1UcnVlDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJUHVibGljIEZ1bmN0aW9uIERlbEZpbGUoKQ0KDQoJCUNhbGwgRGVsVG9GaWxlKEZ1bGxQYXRoKQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCVB1YmxpYyBGdW5jdGlvbiBEZWwoKQ0KDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UQXJ0aWNsZV9EZWwoSUQsVGFnLENhdGVJRCxUaXRsZSxJbnRybyxDb250ZW50LExldmVsLEF1dGhvcklELFBvc3RUaW1lLENvbW1OdW1zLFZpZXdOdW1zLFRyYWNrQmFja051bXMsQWxpYXMsSXN0b3AsVGVtcGxhdGVOYW1lLEZ1bGxVcmwsRlR5cGUsTWV0YVN0cmluZykNCg0KCQlDYWxsIERlbEZpbGUoKQ0KDQoJCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoSUQsImludCIsMCkNCgkJSWYgKElEPTApIFRoZW4gRGVsPUZhbHNlOkV4aXQgRnVuY3Rpb24NCg0KCQlvYmpDb25uLkV4ZWN1dGUoIkRFTEVURSBGUk9NIFtibG9nX0FydGljbGVdIFdIRVJFIFtsb2dfSURdID0iICYgSUQpDQoJCW9iakNvbm4uRXhlY3V0ZSgiREVMRVRFIEZST00gW2Jsb2dfQ29tbWVudF0gV0hFUkUgW2xvZ19JRF0gPSIgJiBJRCkNCgkJb2JqQ29ubi5FeGVjdXRlKCJERUxFVEUgRlJPTSBbYmxvZ19UcmFja0JhY2tdIFdIRVJFIFtsb2dfSURdID0iICYgSUQpDQoNCgkJRGVsPVRydWUNCg0KCUVuZCBGdW5jdGlvbg0KDQoNCg0KCUZ1bmN0aW9uIFNhdmVDYWNoZSgpDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCUZ1bmN0aW9uIExvYWRDYWNoZSgpDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCVByaXZhdGUgU3ViIENsYXNzX0luaXRpYWxpemUoKQ0KCQlQb3N0VGltZT1HZXRUaW1lKE5vdygpKQ0KCQlQb3N0VGltZT1ZZWFyKFBvc3RUaW1lKSAmICItIiAmIE1vbnRoKFBvc3RUaW1lKSAmICItIiAmIERheShQb3N0VGltZSkgJiAiICIgJiBIb3VyKFBvc3RUaW1lKSAmICI6IiAmIE1pbnV0ZShQb3N0VGltZSkgJiAiOiIgJiBTZWNvbmQoUG9zdFRpbWUpDQoJCUlEPTANCgkJQ2F0ZUlEPTANCgkJQXV0aG9ySUQ9MA0KCQlMZXZlbD00J+m7mOiupOS4uuaZrumAmg0KCQlUaXRsZT1aQ19NU0cwOTkNCgkJSVA9R2V0UmVhbGx5SVANCg0KCQlJc0R5bmFtaWNMb2FkU2lsZGJhcj1UcnVlDQoNCgkJRnRlbXBsYXRlPUVtcHR5DQoJCUZUeXBlPVpDX1BPU1RfVFlQRV9BUlRJQ0xFDQoNCgkJU2V0IE1ldGE9TmV3IFRNZXRhDQoNCglFbmQgU3ViDQoNCg0KRW5kIENsYXNzDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIOWumuS5iVRBcnRpY2xlTGlzdOexuw0KJyDovpPlhaXvvJogICAg5pegDQonIOi/lOWbnu+8miAgICDml6ANCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkNsYXNzIFRBcnRpY2xlTGlzdA0KDQoJUHVibGljIFRpdGxlDQoNCglQdWJsaWMgVGVtcGxhdGVfUGFnZUJhcg0KCVB1YmxpYyBUZW1wbGF0ZV9QYWdlQmFyX05leHQNCglQdWJsaWMgVGVtcGxhdGVfUGFnZUJhcl9QcmV2aW91cw0KCVB1YmxpYyBUZW1wbGF0ZV9DYWxlbmRhcg0KDQoJUHVibGljIFRlbXBsYXRlVGFnc19BcnRpY2xlTGlzdF9BdXRob3JfSUQNCglQdWJsaWMgVGVtcGxhdGVUYWdzX0FydGljbGVMaXN0X1RhZ3NfSUQNCglQdWJsaWMgVGVtcGxhdGVUYWdzX0FydGljbGVMaXN0X0NhdGVnb3J5X0lEDQoJUHVibGljIFRlbXBsYXRlVGFnc19BcnRpY2xlTGlzdF9EYXRlX1Nob3J0RGF0ZQ0KCVB1YmxpYyBUZW1wbGF0ZVRhZ3NfQXJ0aWNsZUxpc3RfRGF0ZV9ZZWFyDQoJUHVibGljIFRlbXBsYXRlVGFnc19BcnRpY2xlTGlzdF9EYXRlX01vbnRoDQoJUHVibGljIFRlbXBsYXRlVGFnc19BcnRpY2xlTGlzdF9EYXRlX0RheQ0KCVB1YmxpYyBUZW1wbGF0ZVRhZ3NfQXJ0aWNsZUxpc3RfUGFnZV9Ob3cNCglQdWJsaWMgVGVtcGxhdGVUYWdzX0FydGljbGVMaXN0X1BhZ2VfQWxsDQoNCglQdWJsaWMgaHRtbA0KCVB1YmxpYyBzdWJodG1sDQoJUHVibGljIHN1Ymh0bWxfVGVtcGxhdGVOYW1lDQoNCglQdWJsaWMgSXNEeW5hbWljTG9hZFNpbGRiYXINCglQdWJsaWMgTGlzdFR5cGUNCg0KCVByaXZhdGUgRnRlbXBsYXRlDQoJUHVibGljIFByb3BlcnR5IExldCBUZW1wbGF0ZShzdHJGaWxlTmFtZSkNCgkJRnRlbXBsYXRlPUdldFRlbXBsYXRlKCJURU1QTEFURV8iICYgc3RyRmlsZU5hbWUpDQoJRW5kIFByb3BlcnR5DQoJUHVibGljIFByb3BlcnR5IEdldCBUZW1wbGF0ZQ0KCQlJZiBGdGVtcGxhdGU9IiIgVGhlbg0KCQkJRnRlbXBsYXRlPUdldFRlbXBsYXRlKCJURU1QTEFURV9ERUZBVUxUIikNCgkJRW5kIElmDQoNCgkJVGVtcGxhdGUgPSBGdGVtcGxhdGUNCglFbmQgUHJvcGVydHkNCg0KDQoJUHJpdmF0ZSBGZnVsbHJlZ2V4DQoJUHVibGljIFByb3BlcnR5IExldCBGdWxsUmVnZXgocykNCgkJRmZ1bGxyZWdleD1zDQoJRW5kIFByb3BlcnR5DQoJUHVibGljIFByb3BlcnR5IEdldCBGdWxsUmVnZXgNCgkJSWYgRmZ1bGxyZWdleDw+IiIgVGhlbiANCgkJCUZ1bGxSZWdleD1GZnVsbHJlZ2V4DQoJCUVsc2UNCgkJCUZ1bGxSZWdleD1aQ19ERUZBVUxUX1JFR0VYDQoJCUVuZCBJZg0KCUVuZCBQcm9wZXJ0eQ0KDQoNCglQdWJsaWMgVXJsDQoJUHJpdmF0ZSBNaXhVcmwNCg0KDQoJUHVibGljIFByb3BlcnR5IEdldCBIdG1sVGl0bGUNCgkJSHRtbFRpdGxlPVRyYW5zZmVySFRNTChUaXRsZSwiW2h0bWwtamFwYW5dW2h0bWwtZm9ybWF0XSIpDQoJRW5kIFByb3BlcnR5DQoNCg0KCVB1YmxpYyBGdW5jdGlvbiBFeHBvcnQoaW50UGFnZSxhbnlDYXRlLGFueUF1dGhvcixkdG1EYXRlLGFueVRhZyxpbnRUeXBlKQ0KDQoJCSdwbHVnaW4gbm9kZQ0KCQliQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZUxpc3RfRXhwb3J0X0JlZ2luPUZhbHNlDQoJCUZvciBFYWNoIHNBY3Rpb25fUGx1Z2luX1RBcnRpY2xlTGlzdF9FeHBvcnRfQmVnaW4gaW4gQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZUxpc3RfRXhwb3J0X0JlZ2luDQoJCQlJZiBOb3QgSXNFbXB0eShzQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZUxpc3RfRXhwb3J0X0JlZ2luKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZUxpc3RfRXhwb3J0X0JlZ2luKQ0KCQkJSWYgYkFjdGlvbl9QbHVnaW5fVEFydGljbGVMaXN0X0V4cG9ydF9CZWdpbj1UcnVlIFRoZW4gRXhpdCBGdW5jdGlvbg0KCQlOZXh0DQoNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RBcnRpY2xlTGlzdF9FeHBvcnQoaW50UGFnZSxhbnlDYXRlLGFueUF1dGhvcixkdG1EYXRlLGFueVRhZyxpbnRUeXBlKQ0KDQoJCUxpc3RUeXBlPSJERUZBVUxUIg0KCQlVcmwgPVBhcnNlQ3VzdG9tRGlyZWN0b3J5Rm9yVXJsKEZ1bGxSZWdleCxaQ19TVEFUSUNfRElSRUNUT1JZLCIiLCIiLCIiLCIiLCIiLCIiLCIiLCIiKQ0KCQlNaXhVcmw9UGFyc2VDdXN0b21EaXJlY3RvcnlGb3JVcmwoInslaG9zdCV9L2NhdGFsb2cuYXNwIixaQ19TVEFUSUNfRElSRUNUT1JZLCIiLCIiLCIiLCIiLCIiLCIiLCIiLCIiKQ0KDQoJCURpbSBhcnlBcnRpY2xlDQoJCURpbSBhcnlBcnRpY2xlTGlzdCgpDQoJCURpbSAgVGVtcGxhdGVfQXJ0aWNsZV9Jc3RvcA0KDQoJCQ0KCQkncGx1Z2luIG5vZGUNCgkJRGltIGksaixrLGwscyx0DQoJCURpbSBvYmpSUw0KCQlEaW0gaW50UGFnZUNvdW50DQoJCURpbSBvYmpBcnRpY2xlDQoJCURpbSB1dCx1ZCxkZCxkdCx0dCx0ZA0KCQlEaW0gaW50Q2F0ZSxpbnRBdXRob3IsaW50VGFnDQoNCgkJQ2FsbCBDaGVja1BhcmFtZXRlcihpbnRQYWdlLCJpbnQiLDEpDQoJCVRpdGxlPVpDX0JMT0dfU1VCVElUTEUNCg0KCQlTZXQgb2JqUlM9U2VydmVyLkNyZWF0ZU9iamVjdCgiQURPREIuUmVjb3Jkc2V0IikNCgkJb2JqUlMuQ3Vyc29yVHlwZSA9IGFkT3BlbktleXNldA0KCQlvYmpSUy5Mb2NrVHlwZSA9IGFkTG9ja1JlYWRPbmx5DQoJCW9ialJTLkFjdGl2ZUNvbm5lY3Rpb249b2JqQ29ubg0KDQoJCVNldCBkdCA9IENyZWF0ZU9iamVjdCgiU2NyaXB0aW5nLkRpY3Rpb25hcnkiKQ0KCQlTZXQgZGQgPSBDcmVhdGVPYmplY3QoIlNjcmlwdGluZy5EaWN0aW9uYXJ5IikNCg0KCQknLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCgkJJ29udG9wDQoJCW9ialJTLlNvdXJjZT0iU0VMRUNUIFtsb2dfSURdLFtsb2dfVGFnXSxbbG9nX0NhdGVJRF0sW2xvZ19UaXRsZV0sW2xvZ19JbnRyb10sW2xvZ19Db250ZW50XSxbbG9nX0xldmVsXSxbbG9nX0F1dGhvcklEXSxbbG9nX1Bvc3RUaW1lXSxbbG9nX0NvbW1OdW1zXSxbbG9nX1ZpZXdOdW1zXSxbbG9nX1RyYWNrQmFja051bXNdLFtsb2dfVXJsXSxbbG9nX0lzdG9wXSxbbG9nX1RlbXBsYXRlXSxbbG9nX0Z1bGxVcmxdLFtsb2dfVHlwZV0sW2xvZ19NZXRhXSBGUk9NIFtibG9nX0FydGljbGVdIFdIRVJFIChbbG9nX1R5cGVdPTApIEFuZCAoW2xvZ19JRF0+MCkgQU5EIChbbG9nX0lzdG9wXTw+MCkgQU5EIChbbG9nX0xldmVsXT4xKSINCgkJb2JqUlMuU291cmNlPW9ialJTLlNvdXJjZSAmICJPUkRFUiBCWSBbbG9nX1Bvc3RUaW1lXSBERVNDLFtsb2dfSURdIERFU0MiDQoJCW9ialJTLk9wZW4oKQ0KCQlJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoJCQlvYmpSUy5QYWdlU2l6ZSA9IFpDX0RJU1BMQVlfQ09VTlQNCgkJCWludFBhZ2VDb3VudD1vYmpSUy5QYWdlQ291bnQNCgkJCW9ialJTLkFic29sdXRlUGFnZSA9IDENCg0KCQkJRm9yIGkgPSAxIFRvIG9ialJTLlBhZ2VTaXplDQoNCgkJCQlTZXQgb2JqQXJ0aWNsZT1OZXcgVEFydGljbGUNCgkJCQlJZiBvYmpBcnRpY2xlLkxvYWRJbmZvQnlBcnJheShBcnJheShvYmpSUygwKSxvYmpSUygxKSxvYmpSUygyKSxvYmpSUygzKSxvYmpSUyg0KSxvYmpSUyg1KSxvYmpSUyg2KSxvYmpSUyg3KSxvYmpSUyg4KSxvYmpSUyg5KSxvYmpSUygxMCksb2JqUlMoMTEpLG9ialJTKDEyKSxvYmpSUygxMyksb2JqUlMoMTQpLG9ialJTKDE1KSxvYmpSUygxNiksb2JqUlMoMTcpKSkgVGhlbg0KCQkJCQl1dD11dCAmICIsIiAmIG9ialJzKDcpDQoJCQkJCXR0PXR0ICYgb2JqUnMoMSkNCgkJCQkJZHQuQWRkIENMbmcob2JqUnMoMCkpLCBvYmpBcnRpY2xlDQoJCQkJRW5kIElmDQoJCQkJU2V0IG9iakFydGljbGU9Tm90aGluZw0KDQoJCQkJb2JqUlMuTW92ZU5leHQNCgkJCQlJZiBvYmpSUy5FT0YgVGhlbiBFeGl0IEZvcg0KDQoJCQlOZXh0DQoNCgkJRW5kIElmDQoJCW9ialJTLkNsb3NlKCkNCgkJJy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQoNCg0KCQlvYmpSUy5Tb3VyY2U9IlNFTEVDVCBbbG9nX0lEXSxbbG9nX1RhZ10sW2xvZ19DYXRlSURdLFtsb2dfVGl0bGVdLFtsb2dfSW50cm9dLFtsb2dfQ29udGVudF0sW2xvZ19MZXZlbF0sW2xvZ19BdXRob3JJRF0sW2xvZ19Qb3N0VGltZV0sW2xvZ19Db21tTnVtc10sW2xvZ19WaWV3TnVtc10sW2xvZ19UcmFja0JhY2tOdW1zXSxbbG9nX1VybF0sW2xvZ19Jc3RvcF0sW2xvZ19UZW1wbGF0ZV0sW2xvZ19GdWxsVXJsXSxbbG9nX1R5cGVdLFtsb2dfTWV0YV0gRlJPTSBbYmxvZ19BcnRpY2xlXSBXSEVSRSAoW2xvZ19UeXBlXT0wKSBBTkQgKFtsb2dfTGV2ZWxdPjEpIg0KDQoJCUlmIGFueUF1dGhvcjw+IiIgVGhlbg0KDQoJCQlMaXN0VHlwZT0iVVNFUiINCg0KCQkJSWYgSW5TdHIoWkNfVVNFUl9SRUdFWCwieyVhbGlhcyV9Iik+MCBUaGVuDQoJCQkJaT1HZXRBdXRob3JCeUFsaWFzKGFueUF1dGhvcikNCgkJCQlJZiBpPS0xIFRoZW4NCgkJCQkJaT1HZXRBdXRob3JCeU5hbWUoYW55QXV0aG9yKQ0KCQkJCUVuZCBJZg0KCQkJRWxzZUlmIEluU3RyKFpDX1VTRVJfUkVHRVgsInslbmFtZSV9Iik+MCBUaGVuDQoJCQkJaT1HZXRBdXRob3JCeU5hbWUoQXV0aG9yKQ0KCQkJRWxzZQ0KCQkJCWk9YW55QXV0aG9yDQoJCQlFbmQgSWYNCg0KCQkJQ2FsbCBDaGVja1BhcmFtZXRlcihpLCJpbnQiLEVtcHR5KQ0KDQoJCQlpbnRBdXRob3I9aQ0KDQoJCQlvYmpSUy5Tb3VyY2U9b2JqUlMuU291cmNlICYgIkFORChbbG9nX0F1dGhvcklEXT0iJmkmIikiDQoNCgkJCUlmIENoZWNrQXV0aG9yQnlJRChpKSBUaGVuDQoJCQkJQ2FsbCBHZXRVc2Vyc2J5VXNlcklETGlzdChpKQ0KCQkJCVRpdGxlPVVzZXJzKGkpLk5hbWUNCgkJCQlUZW1wbGF0ZVRhZ3NfQXJ0aWNsZUxpc3RfQXV0aG9yX0lEPVVzZXJzKGkpLklEDQoJCQkJSWYgSXNFbXB0eShodG1sKT1UcnVlIFRoZW4gaHRtbD1Vc2VycyhpKS5UZW1wbGF0ZQ0KCQkJCVVybCA9UGFyc2VDdXN0b21EaXJlY3RvcnlGb3JVcmwoVXNlcnMoaSkuRnVsbFJlZ2V4LFpDX1NUQVRJQ19ESVJFQ1RPUlksIiIsIiIsIiIsIiIsIiIsVXNlcnMoaSkuSUQsVXNlcnMoaSkuTmFtZSxVc2VycyhpKS5TdGF0aWNOYW1lKQ0KCQkJCU1peFVybD1QYXJzZUN1c3RvbURpcmVjdG9yeUZvclVybCgieyVob3N0JX0vY2F0YWxvZy5hc3A/YXV0aD17JWlkJX0iLFpDX1NUQVRJQ19ESVJFQ1RPUlksIiIsIiIsIiIsIiIsIiIsVXNlcnMoaSkuSUQsVXNlcnMoaSkuTmFtZSxVc2VycyhpKS5TdGF0aWNOYW1lKQ0KCQkJRW5kIElmDQoJCUVuZCBpZg0KCQlJZiBhbnlDYXRlPD4iIiBUaGVuDQoNCgkJCUxpc3RUeXBlPSJDQVRFR09SWSINCg0KCQkJSWYgSW5TdHIoWkNfQ0FURUdPUllfUkVHRVgsInslYWxpYXMlfSIpPjAgVGhlbg0KCQkJCWk9R2V0Q2F0ZUJ5QWxpYXMoYW55Q2F0ZSkNCgkJCQlJZiBpPS0xIFRoZW4NCgkJCQkJaT1HZXRDYXRlQnlOYW1lKGFueUNhdGUpDQoJCQkJRW5kIElmDQoJCQlFbHNlSWYgSW5TdHIoWkNfQ0FURUdPUllfUkVHRVgsInslbmFtZSV9Iik+MCBUaGVuIA0KCQkJCWk9R2V0Q2F0ZUJ5TmFtZShhbnlDYXRlKQ0KCQkJRWxzZQ0KCQkJCWk9YW55Q2F0ZQ0KCQkJRW5kIElmDQoNCgkJCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoaSwiaW50IixFbXB0eSkNCg0KCQkJaW50Q2F0ZT1pDQoNCgkJCUlmIGk9MCBUaGVuDQoJCQkJb2JqUlMuU291cmNlPW9ialJTLlNvdXJjZSAmICJBTkQoW2xvZ19DYXRlSURdPTApIg0KCQkJRWxzZQ0KCQkJCURpbSBzdHJTdWJDYXRlSUQNCgkJCQlzdHJTdWJDYXRlSUQ9Sm9pbihHZXRTdWJDYXRlSUQoaSxUcnVlKSwiLCIpDQoJCQkJb2JqUlMuU291cmNlPW9ialJTLlNvdXJjZSAmICJBTkQoW2xvZ19DYXRlSURdSU4oIiZzdHJTdWJDYXRlSUQmIikpIg0KCQkJRW5kIElmDQoNCgkJCUlmIENoZWNrQ2F0ZUJ5SUQoaSkgVGhlbg0KCQkJCVRpdGxlPUNhdGVnb3J5cyhpKS5OYW1lDQoJCQkJVGVtcGxhdGVUYWdzX0FydGljbGVMaXN0X0NhdGVnb3J5X0lEPUNhdGVnb3J5cyhpKS5JRA0KCQkJCUlmIElzRW1wdHkoaHRtbCk9VHJ1ZSBUaGVuIGh0bWw9Q2F0ZWdvcnlzKGkpLlRlbXBsYXRlDQoJCQkJVXJsID1QYXJzZUN1c3RvbURpcmVjdG9yeUZvclVybChDYXRlZ29yeXMoaSkuRnVsbFJlZ2V4LFpDX1NUQVRJQ19ESVJFQ1RPUlksIiIsIiIsIiIsIiIsIiIsQ2F0ZWdvcnlzKGkpLklELENhdGVnb3J5cyhpKS5OYW1lLENhdGVnb3J5cyhpKS5TdGF0aWNOYW1lKQ0KCQkJCU1peFVybCA9UGFyc2VDdXN0b21EaXJlY3RvcnlGb3JVcmwoInslaG9zdCV9L2NhdGFsb2cuYXNwP2NhdGU9eyVpZCV9IixaQ19TVEFUSUNfRElSRUNUT1JZLCIiLCIiLCIiLCIiLCIiLENhdGVnb3J5cyhpKS5JRCxDYXRlZ29yeXMoaSkuTmFtZSxDYXRlZ29yeXMoaSkuU3RhdGljTmFtZSkNCgkJCUVuZCBJZg0KCQlFbmQgaWYNCgkJSWYgSXNEYXRlKGR0bURhdGUpIFRoZW4NCg0KCQkJTGlzdFR5cGU9IkRBVEUiDQoNCgkJCURpbSB5DQoJCQlEaW0gbQ0KCQkJRGltIGQNCgkJCURpbSBueQ0KCQkJRGltIG5tDQoNCgkJCXk9WWVhcihkdG1EYXRlKQ0KCQkJbT1Nb250aChkdG1EYXRlKQ0KCQkJZD1EYXkoZHRtRGF0ZSkNCg0KCQkJSWYgTm90IExlbihDU3RyKGR0bURhdGUpKT43IFRoZW4NCgkJCQlkPSIiDQoJCQlFbmQgSWYNCg0KCQkJVXJsID1VcmxieURhdGUoeSxtLGQpDQoJCQlNaXhVcmwgPVVybGJ5RGF0ZUF1dG8oeSxtLGQpDQoNCgkJCVRlbXBsYXRlVGFnc19BcnRpY2xlTGlzdF9EYXRlX1Nob3J0RGF0ZT1kdG1EYXRlDQoJCQlUZW1wbGF0ZVRhZ3NfQXJ0aWNsZUxpc3RfRGF0ZV9ZZWFyPXkNCgkJCVRlbXBsYXRlVGFnc19BcnRpY2xlTGlzdF9EYXRlX01vbnRoPW0NCgkJCVRlbXBsYXRlVGFnc19BcnRpY2xlTGlzdF9EYXRlX0RheT1kDQoNCgkJCW55PXkNCgkJCW5tPW0rMQ0KCQkJSWYgbT0xMiBUaGVuIG55PW55KzE6bm09MQ0KDQoJCQlJZiBMZW4oQ1N0cihkdG1EYXRlKSk+NyBUaGVuDQoJCQkJb2JqUlMuU291cmNlPW9ialJTLlNvdXJjZSAmICJBTkQoWWVhcihbbG9nX1Bvc3RUaW1lXSk9IiZ5JiIpIEFORChNb250aChbbG9nX1Bvc3RUaW1lXSk9IiZtJiIpIEFORChEYXkoW2xvZ19Qb3N0VGltZV0pPSImZCYiKSINCgkJCUVsc2UNCgkJCQlvYmpSUy5Tb3VyY2U9b2JqUlMuU291cmNlICYgIkFORChZZWFyKFtsb2dfUG9zdFRpbWVdKT0iJnkmIikgQU5EKE1vbnRoKFtsb2dfUG9zdFRpbWVdKT0iJm0mIikiDQoJCQlFbmQgSWYNCg0KCQkJVGVtcGxhdGVfQ2FsZW5kYXI9IjxzY3JpcHQgc3JjPSIiPCNaQ19CTE9HX0hPU1QjPnpiX3N5c3RlbS9mdW5jdGlvbi9jX2h0bWxfanMuYXNwP2RhdGU9IiZkdG1EYXRlJiIiIiB0eXBlPSIidGV4dC9qYXZhc2NyaXB0IiI+PC9zY3JpcHQ+Ig0KDQoJCQlJZiBJc0VtcHR5KGh0bWwpPVRydWUgVGhlbiBodG1sPUdldFRlbXBsYXRlKCJURU1QTEFURV9DQVRBTE9HIikNCg0KCQkJVGl0bGU9WWVhcihkdG1EYXRlKSAmICIgIiAmIFpWQV9Nb250aChNb250aChkdG1EYXRlKSkgJiBJSUYoTGVuKENTdHIoZHRtRGF0ZSkpPjcsIiAiICYgRGF5KGR0bURhdGUpLCIiKQ0KCQlFbmQgSWYNCgkJSWYgYW55VGFnPD4iIiBUaGVuDQoNCgkJCUxpc3RUeXBlPSJUQUdTIg0KDQoNCgkJCUlmIEluU3RyKFpDX1RBR1NfUkVHRVgsInslYWxpYXMlfSIpPjAgVGhlbg0KCQkJCUlmIENoZWNrVGFnQnlJbnRybyhhbnlUYWcpIFRoZW4NCgkJCQkJaT1HZXRUYWdCeUludHJvKGFueVRhZykNCgkJCQlFbHNlDQoJCQkJCUlmIENoZWNrVGFnQnlOYW1lKGFueVRhZykgVGhlbiBpPUdldFRhZ0J5TmFtZShhbnlUYWcpDQoJCQkJRW5kIElmDQoJCQlFbHNlSWYgSW5TdHIoWkNfVEFHU19SRUdFWCwieyVpZCV9Iik+MCBUaGVuDQoJCQkJaT1DTG5nKGFueVRhZykNCgkJCUVsc2UNCgkJCQlJZiBDaGVja1RhZ0J5TmFtZShhbnlUYWcpIFRoZW4gaT1HZXRUYWdCeU5hbWUoYW55VGFnKQ0KCQkJRW5kIElmDQoNCgkJCW9ialJTLlNvdXJjZT1vYmpSUy5Tb3VyY2UgJiAiQU5EKFtsb2dfVGFnXSBMSUtFICcleyIgJiBpICYgIn0lJykiDQoNCgkJCWludFRhZz1pDQoNCgkJCUlmIENoZWNrVGFnQnlJRChpKSBUaGVuDQoJCQkJQ2FsbCBHZXRUYWdzYnlUYWdJRExpc3QoInsiJmkmIn0iKQ0KDQoJCQkJVGl0bGU9VGFncyhpKS5OYW1lDQoJCQkJVGVtcGxhdGVUYWdzX0FydGljbGVMaXN0X1RhZ3NfSUQ9VGFncyhpKS5JRA0KCQkJCUlmIElzRW1wdHkoaHRtbCk9VHJ1ZSBUaGVuIGh0bWw9VGFncyhpKS5UZW1wbGF0ZQ0KCQkJCVVybCA9UGFyc2VDdXN0b21EaXJlY3RvcnlGb3JVcmwoVGFncyhpKS5GdWxsUmVnZXgsWkNfU1RBVElDX0RJUkVDVE9SWSwiIiwiIiwiIiwiIiwiIixUYWdzKGkpLklELFRhZ3MoaSkuTmFtZSxUYWdzKGkpLkVuY29kZU5hbWUpDQoJCQkJTWl4VXJsID1QYXJzZUN1c3RvbURpcmVjdG9yeUZvclVybCgieyVob3N0JX0vY2F0YWxvZy5hc3A/dGFncz17JWFsaWFzJX0iLFpDX1NUQVRJQ19ESVJFQ1RPUlksIiIsIiIsIiIsIiIsIiIsVGFncyhpKS5JRCxUYWdzKGkpLk5hbWUsVGFncyhpKS5FbmNvZGVOYW1lKQ0KCQkJRW5kIElmDQoJCUVuZCBJZg0KDQoNCgkJSWYgTGlzdFR5cGU9IkRFRkFVTFQiIFRoZW4gb2JqUlMuU291cmNlPW9ialJTLlNvdXJjZSAmICIgQU5EIChbbG9nX0lzdG9wXT0wKSAiDQoNCg0KCQlvYmpSUy5Tb3VyY2U9b2JqUlMuU291cmNlICYgIk9SREVSIEJZIFtsb2dfUG9zdFRpbWVdIERFU0MsW2xvZ19JRF0gREVTQyINCgkJb2JqUlMuT3BlbigpDQoNCgkJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KCQkJb2JqUlMuUGFnZVNpemUgPSBaQ19ESVNQTEFZX0NPVU5UDQoJCQlpbnRQYWdlQ291bnQ9b2JqUlMuUGFnZUNvdW50DQoJCQlvYmpSUy5BYnNvbHV0ZVBhZ2UgPSBpbnRQYWdlDQoNCgkJCUZvciBpID0gMSBUbyBvYmpSUy5QYWdlU2l6ZQ0KDQoJCQkJSWYgaW50UGFnZT5pbnRQYWdlQ291bnQgVGhlbiBFeGl0IEZvcg0KDQoJCQkJU2V0IG9iakFydGljbGU9TmV3IFRBcnRpY2xlDQoJCQkJSWYgb2JqQXJ0aWNsZS5Mb2FkSW5mb0J5QXJyYXkoQXJyYXkob2JqUlMoMCksb2JqUlMoMSksb2JqUlMoMiksb2JqUlMoMyksb2JqUlMoNCksb2JqUlMoNSksb2JqUlMoNiksb2JqUlMoNyksb2JqUlMoOCksb2JqUlMoOSksb2JqUlMoMTApLG9ialJTKDExKSxvYmpSUygxMiksb2JqUlMoMTMpLG9ialJTKDE0KSxvYmpSUygxNSksb2JqUlMoMTYpLG9ialJTKDE3KSkpIFRoZW4NCgkJCQkJdWQ9dWQgJiAiLCIgJiBvYmpScyg3KQ0KCQkJCQl0ZD10ZCAmIG9ialJzKDEpDQoJCQkJCWRkLkFkZCBDTG5nKG9ialJzKDApKSwgb2JqQXJ0aWNsZQ0KCQkJCUVuZCBJZg0KCQkJCVNldCBvYmpBcnRpY2xlPU5vdGhpbmcNCg0KCQkJCW9ialJTLk1vdmVOZXh0DQoJCQkJSWYgb2JqUlMuRU9GIFRoZW4gRXhpdCBGb3INCg0KCQkJTmV4dA0KDQoJCUVuZCBJZg0KDQoJCW9ialJTLkNsb3NlKCkNCgkJU2V0IG9ialJTPU5vdGhpbmcNCg0KDQoJCUlmIElzRW1wdHkoaHRtbCk9VHJ1ZSBUaGVuDQoJCQlJZiBpbnRQYWdlPjEgQW5kIFpDX0RFRkFVTFRfUEFHRVNfVEVNUExBVEU8PiIiIFRoZW4NCgkJCQlodG1sPUdldFRlbXBsYXRlKCJURU1QTEFURV8iICYgWkNfREVGQVVMVF9QQUdFU19URU1QTEFURSkNCgkJCUVsc2UNCgkJCQlodG1sPVRlbXBsYXRlDQoJCQlFbmQgSWYNCgkJRW5kIElmDQoNCgkJQ2FsbCBHZXRUYWdzYnlUYWdJRExpc3QodHQgJiB0ZCkNCg0KCQlDYWxsIEdldFVzZXJzYnlVc2VySURMaXN0KHV0ICYgIiwiICYgdWQpDQoNCg0KDQoJCVJlRGltIGFyeUFydGljbGVMaXN0KC0xKQ0KCQlGb3IgaT0wIFRvIGR0LkNvdW50LTENCgkJCWo9ZHQuS2V5cw0KCQkJUmVEaW0gUHJlc2VydmUgYXJ5QXJ0aWNsZUxpc3QoaSkNCgkJCVNldCBvYmpBcnRpY2xlPWR0Lkl0ZW0oaihpKSkNCgkJCW9iakFydGljbGUuaHRtbD1odG1sDQoJCQlJZiBvYmpBcnRpY2xlLkV4cG9ydChaQ19ESVNQTEFZX01PREVfT05UT1ApPSBUcnVlIFRoZW4NCgkJCQlhcnlBcnRpY2xlTGlzdChpKT1vYmpBcnRpY2xlLnN1Ymh0bWwNCgkJCUVuZCBJZg0KCQlOZXh0DQoJCVRlbXBsYXRlX0FydGljbGVfSXN0b3A9Sm9pbihhcnlBcnRpY2xlTGlzdCkNCg0KDQoJCURpbSBSRSAsTWF0Y2gsTWF0Y2hlcw0KCQlSZURpbSBhcnlBcnRpY2xlTGlzdCgtMSkNCgkJSWYgZGQuQ291bnQ+MCBUSGVuDQoJCQlGb3IgaT0wIFRvIGRkLkNvdW50LTENCgkJCQlqPWRkLktleXMNCgkJCQlSZURpbSBQcmVzZXJ2ZSBhcnlBcnRpY2xlTGlzdChpKQ0KCQkJCVNldCBvYmpBcnRpY2xlPWRkLkl0ZW0oaihpKSkNCgkJCQlvYmpBcnRpY2xlLmh0bWw9aHRtbA0KCQkJCUlmIG9iakFydGljbGUuRXhwb3J0KGludFR5cGUpPSBUcnVlIFRoZW4NCgkJCQkJYXJ5QXJ0aWNsZUxpc3QoaSk9b2JqQXJ0aWNsZS5zdWJodG1sDQoJCQkJRW5kIElmDQoJCQkJc3ViaHRtbF9UZW1wbGF0ZU5hbWU9b2JqQXJ0aWNsZS5zdWJodG1sX1RlbXBsYXRlTmFtZQ0KCQkJTmV4dA0KCQlFbHNlDQoJCQlTZXQgUkUgPSBOZXcgUmVnRXhwIA0KCQkJCVJFLlBhdHRlcm4gPSAiXDxcI3RlbXBsYXRlXDooYXJ0aWNsZVwtKFthLXowLTldKikoW1wtYS16MC05XSopKVwjXD4iDQoJCQkJUkUuSWdub3JlQ2FzZSA9IFRydWUgDQoJCQkJUkUuR2xvYmFsID0gVHJ1ZSANCgkJCQlTZXQgTWF0Y2hlcyA9IFJFLkV4ZWN1dGUoaHRtbCkgDQoJCQkJRm9yIEVhY2ggTWF0Y2ggaW4gTWF0Y2hlcw0KCQkJCQlJZiBJc0VtcHR5KHN1Ymh0bWxfVGVtcGxhdGVOYW1lKSBUaGVuIHN1Ymh0bWxfVGVtcGxhdGVOYW1lPSJ0ZW1wbGF0ZToiJk1hdGNoLlN1Yk1hdGNoZXMoMCkmIiINCgkJCQkJRXhpdCBGb3INCgkJCQlOZXh0DQoJCQkJU2V0IE1hdGNoZXMgPSBOb3RoaW5nDQoJCQlTZXQgUkUgPSBOb3RoaW5nDQoJCUVuZCBJZg0KCQlzdWJodG1sPUpvaW4oYXJ5QXJ0aWNsZUxpc3QpDQoNCg0KCQlJZiBMaXN0VHlwZT0iREVGQVVMVCIgVGhlbiBzdWJodG1sPVRlbXBsYXRlX0FydGljbGVfSXN0b3AgJiBzdWJodG1sDQoNCg0KCQlUZW1wbGF0ZVRhZ3NfQXJ0aWNsZUxpc3RfUGFnZV9Ob3c9aW50UGFnZQ0KCQlUZW1wbGF0ZVRhZ3NfQXJ0aWNsZUxpc3RfUGFnZV9BbGw9aW50UGFnZUNvdW50DQoNCg0KCQlDYWxsIEV4cG9ydEJhcihpbnRQYWdlLGludFBhZ2VDb3VudCkNCg0KDQoJCURpbSBhcnlUZW1wbGF0ZVN1Yk5hbWUoKQ0KCQlEaW0gYXJ5VGVtcGxhdGVTdWJWYWx1ZSgpDQoNCg0KCQlSZURpbSBhcnlUZW1wbGF0ZVN1Yk5hbWUoIDQ3KQ0KCQlSZURpbSBhcnlUZW1wbGF0ZVN1YlZhbHVlKDQ3KQ0KDQoJCWFyeVRlbXBsYXRlU3ViTmFtZSggIDEpPXN1Ymh0bWxfVGVtcGxhdGVOYW1lDQoJCWFyeVRlbXBsYXRlU3ViVmFsdWUoIDEpPXN1Ymh0bWwNCgkJYXJ5VGVtcGxhdGVTdWJOYW1lKCAgMik9InRlbXBsYXRlOnBhZ2ViYXIiDQoJCWFyeVRlbXBsYXRlU3ViVmFsdWUoIDIpPVRyYW5zZmVySFRNTChUZW1wbGF0ZV9QYWdlQmFyLCJbYW50aS16Y19ibG9nX2hvc3RdIikNCgkJYXJ5VGVtcGxhdGVTdWJOYW1lKCAgMyk9InRlbXBsYXRlOnBhZ2ViYXJfbmV4dCINCgkJYXJ5VGVtcGxhdGVTdWJWYWx1ZSggMyk9VHJhbnNmZXJIVE1MKFRlbXBsYXRlX1BhZ2VCYXJfTmV4dCwiW2FudGktemNfYmxvZ19ob3N0XSIpDQoJCWFyeVRlbXBsYXRlU3ViTmFtZSggIDQpPSJ0ZW1wbGF0ZTpwYWdlYmFyX3ByZXZpb3VzIg0KCQlhcnlUZW1wbGF0ZVN1YlZhbHVlKCA0KT1UcmFuc2ZlckhUTUwoVGVtcGxhdGVfUGFnZUJhcl9QcmV2aW91cywiW2FudGktemNfYmxvZ19ob3N0XSIpDQoNCgkJYXJ5VGVtcGxhdGVTdWJOYW1lKCAgNik9ImFydGljbGVsaXN0L2RhdGUveWVhciINCgkJYXJ5VGVtcGxhdGVTdWJWYWx1ZSggNik9VGVtcGxhdGVUYWdzX0FydGljbGVMaXN0X0RhdGVfWWVhcg0KCQlhcnlUZW1wbGF0ZVN1Yk5hbWUoICA3KT0iYXJ0aWNsZWxpc3QvZGF0ZS9tb250aCINCgkJYXJ5VGVtcGxhdGVTdWJWYWx1ZSggNyk9VGVtcGxhdGVUYWdzX0FydGljbGVMaXN0X0RhdGVfTW9udGgNCgkJYXJ5VGVtcGxhdGVTdWJOYW1lKCAgOSk9ImFydGljbGVsaXN0L2RhdGUvZGF5Ig0KCQlhcnlUZW1wbGF0ZVN1YlZhbHVlKCA5KT1UZW1wbGF0ZVRhZ3NfQXJ0aWNsZUxpc3RfRGF0ZV9EYXkNCgkJYXJ5VGVtcGxhdGVTdWJOYW1lKCAxMCk9ImFydGljbGVsaXN0L2RhdGUvc2hvcnRkYXRlIg0KCQlhcnlUZW1wbGF0ZVN1YlZhbHVlKDEwKT1UZW1wbGF0ZVRhZ3NfQXJ0aWNsZUxpc3RfRGF0ZV9TaG9ydERhdGUNCgkJYXJ5VGVtcGxhdGVTdWJOYW1lKCAxMSk9ImFydGljbGVsaXN0L3BhZ2Uvbm93Ig0KCQlhcnlUZW1wbGF0ZVN1YlZhbHVlKDExKT1UZW1wbGF0ZVRhZ3NfQXJ0aWNsZUxpc3RfUGFnZV9Ob3cNCgkJYXJ5VGVtcGxhdGVTdWJOYW1lKCAxMik9ImFydGljbGVsaXN0L3BhZ2UvYWxsIg0KCQlhcnlUZW1wbGF0ZVN1YlZhbHVlKDEyKT1UZW1wbGF0ZVRhZ3NfQXJ0aWNsZUxpc3RfUGFnZV9BbGwNCgkJYXJ5VGVtcGxhdGVTdWJOYW1lKCAxMyk9ImFydGljbGVsaXN0L3BhZ2UvY291bnQiDQoJCWFyeVRlbXBsYXRlU3ViVmFsdWUoMTMpPVpDX0RJU1BMQVlfQ09VTlQNCg0KDQoNCgkJCWFyeVRlbXBsYXRlU3ViTmFtZSggMTQpPSJhcnRpY2xlbGlzdC9jYXRlZ29yeS9pZCINCgkJCWFyeVRlbXBsYXRlU3ViTmFtZSggMTUpPSJhcnRpY2xlbGlzdC9jYXRlZ29yeS9uYW1lIg0KCQkJYXJ5VGVtcGxhdGVTdWJOYW1lKCAxNik9ImFydGljbGVsaXN0L2NhdGVnb3J5L29yZGVyIg0KCQkJYXJ5VGVtcGxhdGVTdWJOYW1lKCAxNyk9ImFydGljbGVsaXN0L2NhdGVnb3J5L2NvdW50Ig0KCQkJYXJ5VGVtcGxhdGVTdWJOYW1lKCAxOCk9ImFydGljbGVsaXN0L2NhdGVnb3J5L3VybCINCgkJCWFyeVRlbXBsYXRlU3ViTmFtZSggMTkpPSJhcnRpY2xlbGlzdC9jYXRlZ29yeS9zdGF0aWNuYW1lIg0KDQoJCQlhcnlUZW1wbGF0ZVN1Yk5hbWUoIDIwKT0iYXJ0aWNsZWxpc3QvY2F0ZWdvcnkvcGFyZW50L2lkIg0KCQkJYXJ5VGVtcGxhdGVTdWJOYW1lKCAyMSk9ImFydGljbGVsaXN0L2NhdGVnb3J5L3BhcmVudC9uYW1lIg0KCQkJYXJ5VGVtcGxhdGVTdWJOYW1lKCAyMik9ImFydGljbGVsaXN0L2NhdGVnb3J5L3BhcmVudC9vcmRlciINCgkJCWFyeVRlbXBsYXRlU3ViTmFtZSggMjMpPSJhcnRpY2xlbGlzdC9jYXRlZ29yeS9wYXJlbnQvY291bnQiDQoJCQlhcnlUZW1wbGF0ZVN1Yk5hbWUoIDI0KT0iYXJ0aWNsZWxpc3QvY2F0ZWdvcnkvcGFyZW50L3VybCINCgkJCWFyeVRlbXBsYXRlU3ViTmFtZSggMjUpPSJhcnRpY2xlbGlzdC9jYXRlZ29yeS9wYXJlbnQvc3RhdGljbmFtZSINCg0KDQoJCUlmIExpc3RUeXBlPSJDQVRFR09SWSIgVGhlbg0KCQkJYXJ5VGVtcGxhdGVTdWJWYWx1ZSgxNCk9Q2F0ZWdvcnlzKGludENhdGUpLklEDQoJCQlhcnlUZW1wbGF0ZVN1YlZhbHVlKDE1KT1DYXRlZ29yeXMoaW50Q2F0ZSkuSHRtbE5hbWUNCgkJCWFyeVRlbXBsYXRlU3ViVmFsdWUoMTYpPUNhdGVnb3J5cyhpbnRDYXRlKS5PcmRlcg0KCQkJYXJ5VGVtcGxhdGVTdWJWYWx1ZSgxNyk9Q2F0ZWdvcnlzKGludENhdGUpLkNvdW50DQoJCQlhcnlUZW1wbGF0ZVN1YlZhbHVlKDE4KT1UcmFuc2ZlckhUTUwoQ2F0ZWdvcnlzKGludENhdGUpLkh0bWxVcmwsIlthbnRpLXpjX2Jsb2dfaG9zdF0iKQ0KCQkJYXJ5VGVtcGxhdGVTdWJWYWx1ZSgxOSk9Q2F0ZWdvcnlzKGludENhdGUpLlN0YXRpY05hbWUNCg0KCQkJSWYgQ2F0ZWdvcnlzKGludENhdGUpLlBhcmVudElEPD4wIFRoZW4NCgkJCWFyeVRlbXBsYXRlU3ViVmFsdWUoMjApPUNhdGVnb3J5cyhDYXRlZ29yeXMoaW50Q2F0ZSkuUGFyZW50SUQpLklEDQoJCQlhcnlUZW1wbGF0ZVN1YlZhbHVlKDIxKT1DYXRlZ29yeXMoQ2F0ZWdvcnlzKGludENhdGUpLlBhcmVudElEKS5IdG1sTmFtZQ0KCQkJYXJ5VGVtcGxhdGVTdWJWYWx1ZSgyMik9Q2F0ZWdvcnlzKENhdGVnb3J5cyhpbnRDYXRlKS5QYXJlbnRJRCkuT3JkZXINCgkJCWFyeVRlbXBsYXRlU3ViVmFsdWUoMjMpPUNhdGVnb3J5cyhDYXRlZ29yeXMoaW50Q2F0ZSkuUGFyZW50SUQpLkNvdW50DQoJCQlhcnlUZW1wbGF0ZVN1YlZhbHVlKDI0KT1UcmFuc2ZlckhUTUwoQ2F0ZWdvcnlzKENhdGVnb3J5cyhpbnRDYXRlKS5QYXJlbnRJRCkuSHRtbFVybCwiW2FudGktemNfYmxvZ19ob3N0XSIpDQoJCQlhcnlUZW1wbGF0ZVN1YlZhbHVlKDI1KT1DYXRlZ29yeXMoQ2F0ZWdvcnlzKGludENhdGUpLlBhcmVudElEKS5TdGF0aWNOYW1lDQoJCQlFbmQgSWYNCgkJRW5kIElmDQoNCgkJCWFyeVRlbXBsYXRlU3ViTmFtZSggMjYpPSJhcnRpY2xlbGlzdC9hdXRob3IvaWQiDQoJCQlhcnlUZW1wbGF0ZVN1Yk5hbWUoIDI3KT0iYXJ0aWNsZWxpc3QvYXV0aG9yL25hbWUiDQoJCQlhcnlUZW1wbGF0ZVN1Yk5hbWUoIDI4KT0iYXJ0aWNsZWxpc3QvYXV0aG9yL2xldmVsIg0KCQkJYXJ5VGVtcGxhdGVTdWJOYW1lKCAyOSk9ImFydGljbGVsaXN0L2F1dGhvci9lbWFpbCINCgkJCWFyeVRlbXBsYXRlU3ViTmFtZSggMzApPSJhcnRpY2xlbGlzdC9hdXRob3IvaG9tZXBhZ2UiDQoJCQlhcnlUZW1wbGF0ZVN1Yk5hbWUoIDMxKT0iYXJ0aWNsZWxpc3QvYXV0aG9yL2NvdW50Ig0KCQkJYXJ5VGVtcGxhdGVTdWJOYW1lKCAzMik9ImFydGljbGVsaXN0L2F1dGhvci91cmwiDQoJCQlhcnlUZW1wbGF0ZVN1Yk5hbWUoIDMzKT0iYXJ0aWNsZWxpc3QvYXV0aG9yL3N0YXRpY25hbWUiDQoJCQlhcnlUZW1wbGF0ZVN1Yk5hbWUoIDM0KT0iYXJ0aWNsZWxpc3QvYXV0aG9yL2ludHJvIg0KCQkJYXJ5VGVtcGxhdGVTdWJOYW1lKCAzNSk9ImFydGljbGVsaXN0L2F1dGhvci9hdmF0YXIiDQoJCQlhcnlUZW1wbGF0ZVN1Yk5hbWUoIDM2KT0iYXJ0aWNsZWxpc3QvYXV0aG9yL2xldmVsbmFtZSINCg0KCQlJZiBMaXN0VHlwZT0iVVNFUiIgVGhlbg0KCQkJYXJ5VGVtcGxhdGVTdWJWYWx1ZSgyNik9VXNlcnMoaW50QXV0aG9yKS5JRA0KCQkJYXJ5VGVtcGxhdGVTdWJWYWx1ZSgyNyk9VXNlcnMoaW50QXV0aG9yKS5GaXJzdE5hbWUNCgkJCWFyeVRlbXBsYXRlU3ViVmFsdWUoMjgpPVVzZXJzKGludEF1dGhvcikuTGV2ZWwNCgkJCWFyeVRlbXBsYXRlU3ViVmFsdWUoMjkpPVVzZXJzKGludEF1dGhvcikuRW1haWwNCgkJCWFyeVRlbXBsYXRlU3ViVmFsdWUoMzApPVVzZXJzKGludEF1dGhvcikuSG9tZVBhZ2UNCgkJCWFyeVRlbXBsYXRlU3ViVmFsdWUoMzEpPVVzZXJzKGludEF1dGhvcikuQ291bnQNCgkJCWFyeVRlbXBsYXRlU3ViVmFsdWUoMzIpPVRyYW5zZmVySFRNTChVc2VycyhpbnRBdXRob3IpLkh0bWxVcmwsIlthbnRpLXpjX2Jsb2dfaG9zdF0iKQ0KCQkJYXJ5VGVtcGxhdGVTdWJWYWx1ZSgzMyk9VXNlcnMoaW50QXV0aG9yKS5TdGF0aWNOYW1lDQoJCQlhcnlUZW1wbGF0ZVN1YlZhbHVlKDM0KT1Vc2VycyhpbnRBdXRob3IpLkludHJvDQoJCQlhcnlUZW1wbGF0ZVN1YlZhbHVlKDM1KT1Vc2VycyhpbnRBdXRob3IpLkF2YXRhcg0KCQkJYXJ5VGVtcGxhdGVTdWJWYWx1ZSgzNik9VXNlcnMoaW50QXV0aG9yKS5MZXZlbE5hbWUNCgkJRW5kIElmDQoNCgkJCWFyeVRlbXBsYXRlU3ViTmFtZSggMzcpPSJhcnRpY2xlbGlzdC90YWcvaWQiDQoJCQlhcnlUZW1wbGF0ZVN1Yk5hbWUoIDM4KT0iYXJ0aWNsZWxpc3QvdGFnL25hbWUiDQoJCQlhcnlUZW1wbGF0ZVN1Yk5hbWUoIDM5KT0iYXJ0aWNsZWxpc3QvdGFnL2ludHJvIg0KCQkJYXJ5VGVtcGxhdGVTdWJOYW1lKCA0MCk9ImFydGljbGVsaXN0L3RhZy9jb3VudCINCgkJCWFyeVRlbXBsYXRlU3ViTmFtZSggNDEpPSJhcnRpY2xlbGlzdC90YWcvdXJsIg0KCQkJYXJ5VGVtcGxhdGVTdWJOYW1lKCA0Mik9ImFydGljbGVsaXN0L3RhZy9lbmNvZGVuYW1lIg0KDQoJCUlmIExpc3RUeXBlPSJUQUdTIiBUaGVuDQoJCQlhcnlUZW1wbGF0ZVN1YlZhbHVlKDM3KT1UYWdzKGludFRhZykuSUQNCgkJCWFyeVRlbXBsYXRlU3ViVmFsdWUoMzgpPVRhZ3MoaW50VGFnKS5IdG1sTmFtZQ0KCQkJYXJ5VGVtcGxhdGVTdWJWYWx1ZSgzOSk9VGFncyhpbnRUYWcpLkh0bWxJbnRybw0KCQkJYXJ5VGVtcGxhdGVTdWJWYWx1ZSg0MCk9VGFncyhpbnRUYWcpLkNvdW50DQoJCQlhcnlUZW1wbGF0ZVN1YlZhbHVlKDQxKT1UYWdzKGludFRhZykuSHRtbFVybA0KCQkJYXJ5VGVtcGxhdGVTdWJWYWx1ZSg0Mik9VGFncyhpbnRUYWcpLkVuY29kZU5hbWUNCgkJRW5kIElmDQoNCgkJYXJ5VGVtcGxhdGVTdWJOYW1lKCA0Myk9InRlbXBsYXRlOnNpZGViYXIiDQoJCWFyeVRlbXBsYXRlU3ViVmFsdWUoNDMpPUdldFRlbXBsYXRlKCJDQUNIRV9TSURFQkFSIikNCgkJYXJ5VGVtcGxhdGVTdWJOYW1lKCA0NCk9InRlbXBsYXRlOnNpZGViYXIyIg0KCQlhcnlUZW1wbGF0ZVN1YlZhbHVlKDQ0KT1HZXRUZW1wbGF0ZSgiQ0FDSEVfU0lERUJBUjIiKQ0KCQlhcnlUZW1wbGF0ZVN1Yk5hbWUoIDQ1KT0idGVtcGxhdGU6c2lkZWJhcjMiDQoJCWFyeVRlbXBsYXRlU3ViVmFsdWUoNDUpPUdldFRlbXBsYXRlKCJDQUNIRV9TSURFQkFSMyIpDQoJCWFyeVRlbXBsYXRlU3ViTmFtZSggNDYpPSJ0ZW1wbGF0ZTpzaWRlYmFyNCINCgkJYXJ5VGVtcGxhdGVTdWJWYWx1ZSg0Nik9R2V0VGVtcGxhdGUoIkNBQ0hFX1NJREVCQVI0IikNCgkJYXJ5VGVtcGxhdGVTdWJOYW1lKCA0Nyk9InRlbXBsYXRlOnNpZGViYXI1Ig0KCQlhcnlUZW1wbGF0ZVN1YlZhbHVlKDQ3KT1HZXRUZW1wbGF0ZSgiQ0FDSEVfU0lERUJBUjUiKQ0KDQoNCgkJJ3BsdWdpbiBub2RlDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UQXJ0aWNsZUxpc3RfRXhwb3J0X1RlbXBsYXRlVGFncyhhcnlUZW1wbGF0ZVN1Yk5hbWUsYXJ5VGVtcGxhdGVTdWJWYWx1ZSkNCg0KCQlqPVVCb3VuZChhcnlUZW1wbGF0ZVN1Yk5hbWUpDQoJCUZvciBpPTAgdG8gag0KCQkJaHRtbD1SZXBsYWNlKGh0bWwsIjwjIiAmIGFyeVRlbXBsYXRlU3ViTmFtZShpKSAmICIjPiIsYXJ5VGVtcGxhdGVTdWJWYWx1ZShpKSkNCgkJTmV4dA0KDQoNCg0KCQlEaW0gZGENCgkJU2V0IGRhPUNyZWF0ZU9iamVjdCgiU2NyaXB0aW5nLkRpY3Rpb25hcnkiKQ0KDQoJCVNldCBSRSA9IE5ldyBSZWdFeHAgDQoJCVJFLklnbm9yZUNhc2UgPSBUcnVlIA0KCQlSRS5HbG9iYWwgPSBUcnVlIA0KDQoJCUlmIENhdGVnb3J5cyhpbnRDYXRlKS5QYXJlbnRJRD0wIFRoZW4NCgkJCVJFLlBhdHRlcm4gPSAiPCN0ZW1wbGF0ZTphcnRpY2xlbGlzdF9jYXRlZ29yeV9wYXJlbnQ6YmVnaW4jPigufFxuKSo8I3RlbXBsYXRlOmFydGljbGVsaXN0X2NhdGVnb3J5X3BhcmVudDplbmQjPiINCgkJCWh0bWwgPSBSRS5SZXBsYWNlKGh0bWwsICIiKQ0KCQlFbHNlDQoJCQlodG1sPVJlcGxhY2UoaHRtbCwiPCN0ZW1wbGF0ZTphcnRpY2xlbGlzdF9jYXRlZ29yeV9wYXJlbnQ6YmVnaW4jPiIsIiIpDQoJCQlodG1sPVJlcGxhY2UoaHRtbCwiPCN0ZW1wbGF0ZTphcnRpY2xlbGlzdF9jYXRlZ29yeV9wYXJlbnQ6ZW5kIz4iLCIiKQ0KCQlFbmQgSWYNCgkJU2V0IFJFID0gTm90aGluZw0KDQoNCgkJU2V0IFJFID0gTmV3IFJlZ0V4cCANCgkJUkUuUGF0dGVybiA9ICI8I2FydGljbGVsaXN0LygoY2F0ZWdvcnkvbWV0YXxhdXRob3IvbWV0YSkvKFthLXowLTlfXXsxLH0pKSM+Ig0KCQlSRS5JZ25vcmVDYXNlID0gVHJ1ZSANCgkJUkUuR2xvYmFsID0gVHJ1ZSANCgkJU2V0IE1hdGNoZXMgPSBSRS5FeGVjdXRlKGh0bWwpIA0KCQlGb3IgRWFjaCBNYXRjaCBpbiBNYXRjaGVzDQoJCQlzPU1hdGNoLlN1Yk1hdGNoZXMoMCkNCgkJCUlmIGRhLkV4aXN0cyhzKT1GYWxzZSBUaGVuIGRhLmFkZCBzLHMNCgkJTmV4dA0KCQlTZXQgTWF0Y2hlcyA9IE5vdGhpbmcNCgkJU2V0IFJFID0gTm90aGluZw0KDQoJCXM9ZGEuSXRlbXMNCgkJRm9yIHQgPSAwIFRvIGRhLkNvdW50IC0xDQoJCQlJZiBJblN0cihzKHQpLCJjYXRlZ29yeS9tZXRhLyIpPjAgVGhlbg0KCQkJCXModCk9UmVwbGFjZShzKHQpLCJjYXRlZ29yeS9tZXRhLyIsIiIpDQoJCQkJSWYgTGlzdFR5cGU9IkNBVEVHT1JZIiBUaGVuDQoJCQkJCWh0bWwgPSBSZXBsYWNlKGh0bWwsIjwjYXJ0aWNsZWxpc3QvY2F0ZWdvcnkvbWV0YS8iICYgcyh0KSAmICIjPiIsQ2F0ZWdvcnlzKGludENhdGUpLk1ldGEuR2V0VmFsdWUocyh0KSkgKQ0KCQkJCUVsc2UNCgkJCQkJaHRtbCA9IFJlcGxhY2UoaHRtbCwiPCNhcnRpY2xlbGlzdC9jYXRlZ29yeS9tZXRhLyIgJiBzKHQpICYgIiM+IiwiIikNCgkJCQlFbmQgSWYNCgkJCUVsc2VJZiBJblN0cihzKHQpLCJhdXRob3IvbWV0YS8iKT4wIFRoZW4gDQoJCQkJcyh0KT1SZXBsYWNlKHModCksImF1dGhvci9tZXRhLyIsIiIpDQoJCQkJSWYgTGlzdFR5cGU9IlVTRVIiIFRoZW4NCgkJCQkJaHRtbCA9IFJlcGxhY2UoaHRtbCwiPCNhcnRpY2xlbGlzdC9hdXRob3IvbWV0YS8iICYgcyh0KSAmICIjPiIsVXNlcnMoaW50QXV0aG9yKS5NZXRhLkdldFZhbHVlKHModCkpICkNCgkJCQlFbHNlDQoJCQkJCWh0bWwgPSBSZXBsYWNlKGh0bWwsIjwjYXJ0aWNsZWxpc3QvYXV0aG9yL21ldGEvIiAmIHModCkgJiAiIz4iLCIiKQ0KCQkJCUVuZCBJZg0KCQkJRW5kIElmDQoJCU5leHQNCg0KCQlVcmw9UmVwbGFjZShSZXBsYWNlKFVybCwiLy8iLCIvIiksIjovIiwiOi8vIiwxLDEpDQoNCgkJRXhwb3J0PVRydWUNCg0KCQkncGx1Z2luIG5vZGUNCgkJYkFjdGlvbl9QbHVnaW5fVEFydGljbGVMaXN0X0V4cG9ydF9FbmQ9RmFsc2UNCgkJRm9yIEVhY2ggc0FjdGlvbl9QbHVnaW5fVEFydGljbGVMaXN0X0V4cG9ydF9FbmQgaW4gQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZUxpc3RfRXhwb3J0X0VuZA0KCQkJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fVEFydGljbGVMaXN0X0V4cG9ydF9FbmQpIFRoZW4gQ2FsbCBFeGVjdXRlKHNBY3Rpb25fUGx1Z2luX1RBcnRpY2xlTGlzdF9FeHBvcnRfRW5kKQ0KCQkJSWYgYkFjdGlvbl9QbHVnaW5fVEFydGljbGVMaXN0X0V4cG9ydF9FbmQ9VHJ1ZSBUaGVuIEV4aXQgRnVuY3Rpb24NCgkJTmV4dA0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KDQoJUHVibGljIEZ1bmN0aW9uIEJ1aWxkKCkNCg0KCQlEaW0gaSxqDQoNCgkJJ3BsdWdpbiBub2RlDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UQXJ0aWNsZUxpc3RfQnVpbGRfVGVtcGxhdGUoaHRtbCkNCg0KCQlEaW0gYXJ5VGVtcGxhdGVUYWdzTmFtZQ0KCQlEaW0gYXJ5VGVtcGxhdGVUYWdzVmFsdWUNCg0KCQlUZW1wbGF0ZVRhZ3NEaWMuSXRlbSgiQmxvZ1RpdGxlIik9SHRtbFRpdGxlDQoJCVRlbXBsYXRlVGFnc0RpYy5JdGVtKCJaQ19CTE9HX0hPU1QiKT1CbG9nSG9zdA0KDQoJCUlmIFRlbXBsYXRlX0NhbGVuZGFyPSIiIFRoZW4gVGVtcGxhdGVfQ2FsZW5kYXI9IjxzY3JpcHQgc3JjPSIiPCNaQ19CTE9HX0hPU1QjPnpiX3N5c3RlbS9mdW5jdGlvbi9jX2h0bWxfanMuYXNwP2RhdGU9bm93IiIgdHlwZT0iInRleHQvamF2YXNjcmlwdCIiPjwvc2NyaXB0PiINCg0KCQlJZiBaQ19NVUxUSV9ET01BSU5fU1VQUE9SVD1UcnVlIEFuZCBaQ19QRVJNQU5FTlRfRE9NQUlOX0VOQUJMRT1GYWxzZSBUaGVuDQoJCQlEaW0geCx5DQoJCQl4PUNTdHIoUmVwbGFjZShVcmwsQmxvZ0hvc3QsIiIpKQ0KCQkJeD1SZXBsYWNlKHgsIi8vLy8vIiwiLyIpOng9UmVwbGFjZSh4LCIvLy8vIiwiLyIpOng9UmVwbGFjZSh4LCIvLy8iLCIvIik6eD1SZXBsYWNlKHgsIi8vIiwiLyIpDQoJCQlGb3IgaT0xIFRvIFVCb3VuZChTcGxpdCh4LCIvIikpDQoJCQkJeT15ICYgIi4uLyINCgkJCU5leHQNCgkJCUlmIHk9IiIgVGhlbiB5PSIuLyINCgkJCVRlbXBsYXRlVGFnc0RpYy5JdGVtKCJaQ19CTE9HX0hPU1QiKT15DQoJCUVuZCBJZg0KDQoJCWFyeVRlbXBsYXRlVGFnc05hbWU9VGVtcGxhdGVUYWdzRGljLktleXMNCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWU9VGVtcGxhdGVUYWdzRGljLkl0ZW1zDQoNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RBcnRpY2xlTGlzdF9CdWlsZF9UZW1wbGF0ZVRhZ3MoYXJ5VGVtcGxhdGVUYWdzTmFtZSxhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSkNCg0KCQlEaW0gcyx0DQoJCWo9VUJvdW5kKGFyeVRlbXBsYXRlVGFnc05hbWUpDQoJCUZvciBpPTEgdG8gag0KCQkJSWYgKEluU3RyKGFyeVRlbXBsYXRlVGFnc05hbWUoaSksIkNBQ0hFX0lOQ0xVREVfIik+MCkgQW5kIChSaWdodChhcnlUZW1wbGF0ZVRhZ3NOYW1lKGkpLDUpPD4iX0hUTUwiKSBBbmQgKFJpZ2h0KGFyeVRlbXBsYXRlVGFnc05hbWUoaSksMyk8PiJfSlMiKSBUaGVuDQoJCQkJcz1zICYgYXJ5VGVtcGxhdGVUYWdzTmFtZShpKSAmICJ8Ig0KCQkJRW5kIElmDQoJCQlJZiAoIjwjIiAmIGFyeVRlbXBsYXRlVGFnc05hbWUoaSkgJiAiIz4iPSI8I0NBQ0hFX0lOQ0xVREVfQ0FMRU5EQVIjPiIpIE9yICgiPCMiICYgYXJ5VGVtcGxhdGVUYWdzTmFtZShpKSAmICIjPiI9IjwjQ0FDSEVfSU5DTFVERV9DQUxFTkRBUl9KUyM+IikgT3IgKCI8IyIgJiBhcnlUZW1wbGF0ZVRhZ3NOYW1lKGkpICYgIiM+Ij0iPCNDQUNIRV9JTkNMVURFX0NBTEVOREFSX05PVyM+IikgVGhlbg0KCQkJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKGkpPVRlbXBsYXRlX0NhbGVuZGFyDQoJCQlFbmQgSWYNCgkJTmV4dA0KDQoJCUlmIElzRHluYW1pY0xvYWRTaWxkYmFyPVRydWUgVGhlbg0KCQkJRm9yIEVhY2ggdCBJbiBTcGxpdChzLCJ8IikNCgkJCQlJZiB0PSIiIFRoZW4gRXhpdCBGb3INCgkJCQlJZiB0PD4iQ0FDSEVfSU5DTFVERV9OQVZCQVIiIFRoZW4NCgkJCQkJaHRtbD1SZXBsYWNlKGh0bWwsIjwjIiZ0JiIjPiIsIjwjIiZ0JiJfSlMjPiIpDQoJCQkJRW5kIElmDQoJCQlOZXh0DQoJCUVuZCBJZg0KDQoJCWo9VUJvdW5kKGFyeVRlbXBsYXRlVGFnc05hbWUpDQoJCUZvciBpPTEgdG8gag0KCQkJaHRtbD1SZXBsYWNlKGh0bWwsIjwjIiAmIGFyeVRlbXBsYXRlVGFnc05hbWUoaSkgJiAiIz4iLGFyeVRlbXBsYXRlVGFnc1ZhbHVlKGkpKQ0KCQlOZXh0DQoJCWh0bWw9UmVwbGFjZShodG1sLCI8IyIgJiBhcnlUZW1wbGF0ZVRhZ3NOYW1lKDApICYgIiM+IixhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSgwKSkNCg0KCQkncGx1Z2luIG5vZGUNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RBcnRpY2xlTGlzdF9CdWlsZF9UZW1wbGF0ZV9TdWNjZWVkKGh0bWwpDQoNCgkJQnVpbGQ9VHJ1ZQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCVB1YmxpYyBGdW5jdGlvbiBFeHBvcnRCYXIoaW50Tm93UGFnZSxpbnRBbGxQYWdlKQ0KDQoJCSdwbHVnaW4gbm9kZQ0KCQliQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZUxpc3RfRXhwb3J0QmFyX0JlZ2luPUZhbHNlDQoJCUZvciBFYWNoIHNBY3Rpb25fUGx1Z2luX1RBcnRpY2xlTGlzdF9FeHBvcnRCYXJfQmVnaW4gaW4gQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZUxpc3RfRXhwb3J0QmFyX0JlZ2luDQoJCQlJZiBOb3QgSXNFbXB0eShzQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZUxpc3RfRXhwb3J0QmFyX0JlZ2luKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZUxpc3RfRXhwb3J0QmFyX0JlZ2luKQ0KCQkJSWYgYkFjdGlvbl9QbHVnaW5fVEFydGljbGVMaXN0X0V4cG9ydEJhcl9CZWdpbj1UcnVlIFRoZW4gRXhpdCBGdW5jdGlvbg0KCQlOZXh0DQoNCgkJRGltIGkNCgkJRGltIHMNCgkJRGltIHQNCgkJRGltIHN0clBhZ2VCYXINCg0KCQl0PVVybA0KDQoJCURpbSBRdWVyeVNwbGl0DQoJCVF1ZXJ5U3BsaXQ9SUlmKEluU3RyKHQsIj8iKT4wLCImIiwiPyIpDQoNCgkJJ0lmIExpc3RUeXBlPSJDQVRFR09SWSIgT3IgTGlzdFR5cGU9IlVTRVIiIE9yIExpc3RUeXBlPSJEQVRFIiBPciBMaXN0VHlwZT0iVEFHUyIgVGhlbg0KCQkJSWYgWkNfU1RBVElDX01PREU9IkFDVElWRSIgVGhlbg0KCQkJCXQ9dCAmIFF1ZXJ5U3BsaXQgJiAicGFnZT0lbiINCgkJCUVuZCBJZg0KCQkJSWYgWkNfU1RBVElDX01PREU9IlJFV1JJVEUiIFRoZW4NCgkJCQlJZiBJblN0cih0LCIvZGVmYXVsdC5odG1sIik+MCBUaGVuDQoJCQkJCUlmIExpc3RUeXBlPSJERUZBVUxUIiBUaGVuIA0KCQkJCQkJdD1SZXBsYWNlKHQsIi9kZWZhdWx0Lmh0bWwiLCIvZGVmYXVsdF8lbi5odG1sIikNCgkJCQkJRWxzZSANCgkJCQkJCXQ9UmVwbGFjZSh0LCIvZGVmYXVsdC5odG1sIiwiXyVuL2RlZmF1bHQuaHRtbCIpDQoJCQkJCUVuZCBJZiANCgkJCQlFbHNlDQoJCQkJCXQ9UmVwbGFjZSh0LCIuaHRtbCIsIl8lbi5odG1sIikNCgkJCQlFbmQgSWYNCgkJCUVuZCBJZg0KCQkJSWYgWkNfU1RBVElDX01PREU9Ik1JWCIgVGhlbg0KCQkJCXQ9TWl4VXJsDQoJCQkJdD10ICYgUXVlcnlTcGxpdCAmICJwYWdlPSVuIg0KCQkJRW5kIElmDQoJCSdFbmQgSWYNCg0KCQlJZiBpbnRBbGxQYWdlPjAgVGhlbg0KCQkJRGltIGEsYg0KDQoJCQlzPVJlcGxhY2UodCwiJW4iLDEpDQoJCQlJZiBMaXN0VHlwZT0iREVGQVVMVCIgVGhlbiBzPUJsb2dIb3N0DQoJCQlJZiAoTGlzdFR5cGU9IkNBVEVHT1JZIiBPciBMaXN0VHlwZT0iVVNFUiIgT3IgTGlzdFR5cGU9IkRBVEUiIE9yIExpc3RUeXBlPSJUQUdTIikgVGhlbiBzPVVybA0KCQkJSWYgWkNfU1RBVElDX01PREU9IlJFV1JJVEUiIFRoZW4gcz1SZXBsYWNlKHMsIi9kZWZhdWx0Lmh0bWwiLCIvIikNCg0KCQkJc3RyUGFnZUJhcj1HZXRUZW1wbGF0ZSgiVEVNUExBVEVfQl9QQUdFQkFSIikNCgkJCXN0clBhZ2VCYXI9UmVwbGFjZShzdHJQYWdlQmFyLCI8I3BhZ2ViYXIvcGFnZS91cmwjPiIscykNCgkJCXN0clBhZ2VCYXI9UmVwbGFjZShzdHJQYWdlQmFyLCI8I3BhZ2ViYXIvcGFnZS9udW1iZXIjPiIsIjxzcGFuIGNsYXNzPSIicGFnZSBmaXJzdC1wYWdlIiI+IiZaQ19NU0cyMzUmIjwvc3Bhbj4iKQ0KCQkJVGVtcGxhdGVfUGFnZUJhcj1UZW1wbGF0ZV9QYWdlQmFyICYgc3RyUGFnZUJhcg0KDQoJCQlJZiBpbnRBbGxQYWdlPlpDX1BBR0VCQVJfQ09VTlQgVGhlbg0KCQkJCWE9aW50Tm93UGFnZQ0KCQkJCWI9aW50Tm93UGFnZStaQ19QQUdFQkFSX0NPVU5ULTENCgkJCQlJZiBhPlpDX1BBR0VCQVJfQ09VTlQgVGhlbiBhPWEtMTpiPWItMQ0KCQkJCUlmIGI+aW50QWxsUGFnZSBUaGVuIGI9aW50QWxsUGFnZTphPWludEFsbFBhZ2UtWkNfUEFHRUJBUl9DT1VOVCsxDQoJCQlFbHNlDQoJCQkJYT0xOmI9aW50QWxsUGFnZQ0KCQkJRW5kIElmDQoJCQlGb3IgaT1hIHRvIGINCg0KCQkJCXM9UmVwbGFjZSh0LCIlbiIsaSkNCgkJCQlJZiBMaXN0VHlwZT0iREVGQVVMVCIgQW5kIGk9MSBUaGVuIHM9QmxvZ0hvc3QNCgkJCQlJZiAoTGlzdFR5cGU9IkNBVEVHT1JZIiBPciBMaXN0VHlwZT0iVVNFUiIgT3IgTGlzdFR5cGU9IkRBVEUiIE9yIExpc3RUeXBlPSJUQUdTIikgQW5kIGk9MSBUaGVuIHM9VXJsDQoJCQkJSWYgWkNfU1RBVElDX01PREU9IlJFV1JJVEUiIFRoZW4gcz1SZXBsYWNlKHMsIi9kZWZhdWx0Lmh0bWwiLCIvIikNCg0KCQkJCXN0clBhZ2VCYXI9R2V0VGVtcGxhdGUoIlRFTVBMQVRFX0JfUEFHRUJBUiIpDQoJCQkJSWYgaT1pbnROb3dQYWdlIHRoZW4NCgkJCQkJVGVtcGxhdGVfUGFnZUJhcj1UZW1wbGF0ZV9QYWdlQmFyICYgIjxzcGFuIGNsYXNzPSIicGFnZSBub3ctcGFnZSIiPiIgJiBpICYgIjwvc3Bhbj4iDQoJCQkJRWxzZQ0KCQkJCQlzdHJQYWdlQmFyPVJlcGxhY2Uoc3RyUGFnZUJhciwiPCNwYWdlYmFyL3BhZ2UvdXJsIz4iLHMpDQoJCQkJCXN0clBhZ2VCYXI9UmVwbGFjZShzdHJQYWdlQmFyLCI8I3BhZ2ViYXIvcGFnZS9udW1iZXIjPiIsIjxzcGFuIGNsYXNzPSIicGFnZSIiPiImaSYiPC9zcGFuPiIpDQoJCQkJCVRlbXBsYXRlX1BhZ2VCYXI9VGVtcGxhdGVfUGFnZUJhciAmIHN0clBhZ2VCYXINCgkJCQlFbmQgSWYNCg0KCQkJTmV4dA0KDQoJCQlzPVJlcGxhY2UodCwiJW4iLGludEFsbFBhZ2UpDQoJCQlJZiBMaXN0VHlwZT0iREVGQVVMVCIgQW5kIGludEFsbFBhZ2U9MSBUaGVuIHM9QmxvZ0hvc3QNCgkJCUlmIChMaXN0VHlwZT0iQ0FURUdPUlkiIE9yIExpc3RUeXBlPSJVU0VSIiBPciBMaXN0VHlwZT0iREFURSIgT3IgTGlzdFR5cGU9IlRBR1MiKSBBbmQgaW50QWxsUGFnZT0xIFRoZW4gcz1VcmwNCgkJCUlmIFpDX1NUQVRJQ19NT0RFPSJSRVdSSVRFIiBUaGVuIHM9UmVwbGFjZShzLCIvZGVmYXVsdC5odG1sIiwiLyIpDQoNCgkJCXN0clBhZ2VCYXI9R2V0VGVtcGxhdGUoIlRFTVBMQVRFX0JfUEFHRUJBUiIpDQoJCQlzdHJQYWdlQmFyPVJlcGxhY2Uoc3RyUGFnZUJhciwiPCNwYWdlYmFyL3BhZ2UvdXJsIz4iLHMpDQoJCQlzdHJQYWdlQmFyPVJlcGxhY2Uoc3RyUGFnZUJhciwiPCNwYWdlYmFyL3BhZ2UvbnVtYmVyIz4iLCI8c3BhbiBjbGFzcz0iInBhZ2UgbGFzdC1wYWdlIiI+IiZaQ19NU0cyMzYmIjwvc3Bhbj4iKQ0KCQkJVGVtcGxhdGVfUGFnZUJhcj1UZW1wbGF0ZV9QYWdlQmFyICYgc3RyUGFnZUJhcg0KDQoJCQlJZiBpbnROb3dQYWdlPTEgVGhlbg0KCQkJCVRlbXBsYXRlX1BhZ2VCYXJfUHJldmlvdXM9IiINCgkJCUVsc2UNCgkJCQlzPVJlcGxhY2UodCwiJW4iLGludE5vd1BhZ2UtMSkNCg0KCQkJCUlmIExpc3RUeXBlPSJERUZBVUxUIiBBbmQgaW50Tm93UGFnZS0xPTEgVGhlbiBzPUJsb2dIb3N0DQoJCQkJSWYgKExpc3RUeXBlPSJDQVRFR09SWSIgT3IgTGlzdFR5cGU9IlVTRVIiIE9yIExpc3RUeXBlPSJEQVRFIiBPciBMaXN0VHlwZT0iVEFHUyIpIEFuZCBpbnROb3dQYWdlLTE9MSBUaGVuIHM9VXJsDQoJCQkJSWYgWkNfU1RBVElDX01PREU9IlJFV1JJVEUiIFRoZW4gcz1SZXBsYWNlKHMsIi9kZWZhdWx0Lmh0bWwiLCIvIikNCg0KCQkJCVRlbXBsYXRlX1BhZ2VCYXJfUHJldmlvdXM9IjxzcGFuIGNsYXNzPSIicGFnZWJhci1wcmV2aW91cyIiPjxhIGhyZWY9IiIiJiBzICYiIiI+PHNwYW4+IiZaQ19NU0cxNTYmIjwvc3Bhbj48L2E+PC9zcGFuPiINCg0KCQkJRW5kIElmDQoNCgkJCUlmIGludE5vd1BhZ2U9aW50QWxsUGFnZSBUaGVuDQoJCQkJVGVtcGxhdGVfUGFnZUJhcl9OZXh0PSIiDQoJCQlFbHNlDQoJCQkJcz1SZXBsYWNlKHQsIiVuIixpbnROb3dQYWdlKzEpDQoJCQkJSWYgWkNfU1RBVElDX01PREU9IlJFV1JJVEUiIFRoZW4gcz1SZXBsYWNlKHMsIi9kZWZhdWx0Lmh0bWwiLCIvIikNCgkJCQlUZW1wbGF0ZV9QYWdlQmFyX05leHQ9IjxzcGFuIGNsYXNzPSIicGFnZWJhci1uZXh0IiI+PGEgaHJlZj0iIiImIHMgJiIiIj48c3Bhbj4iJlpDX01TRzE1NSYiPC9zcGFuPjwvYT48L3NwYW4+Ig0KCQkJRW5kIElmDQoNCgkJRW5kIElmDQoNCgkJRXhwb3J0QmFyPVRydWUNCg0KCQkncGx1Z2luIG5vZGUNCgkJYkFjdGlvbl9QbHVnaW5fVEFydGljbGVMaXN0X0V4cG9ydEJhcl9FbmQ9RmFsc2UNCgkJRm9yIEVhY2ggc0FjdGlvbl9QbHVnaW5fVEFydGljbGVMaXN0X0V4cG9ydEJhcl9FbmQgaW4gQWN0aW9uX1BsdWdpbl9UQXJ0aWNsZUxpc3RfRXhwb3J0QmFyX0VuZA0KCQkJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fVEFydGljbGVMaXN0X0V4cG9ydEJhcl9FbmQpIFRoZW4gQ2FsbCBFeGVjdXRlKHNBY3Rpb25fUGx1Z2luX1RBcnRpY2xlTGlzdF9FeHBvcnRCYXJfRW5kKQ0KCQkJSWYgYkFjdGlvbl9QbHVnaW5fVEFydGljbGVMaXN0X0V4cG9ydEJhcl9FbmQ9VHJ1ZSBUaGVuIEV4aXQgRnVuY3Rpb24NCgkJTmV4dA0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCUZ1bmN0aW9uIFNldFZhcihUZW1wbGF0ZVRhZyxUZW1wbGF0ZVZhbHVlKQ0KDQoJCUlmIElzRW1wdHkoaHRtbCkgVGhlbiBodG1sPVRlbXBsYXRlDQoNCgkJaHRtbD1SZXBsYWNlKGh0bWwsIjwjIiAmIFRlbXBsYXRlVGFnICYgIiM+IixUZW1wbGF0ZVZhbHVlKQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCUZ1bmN0aW9uIFNhdmUoKQ0KDQoJCWh0bWw9VHJhbnNmZXJIVE1MKGh0bWwsIltuby1hc3BdIikNCgkJSWYgWkNfU1RBVElDX1RZUEU9ImFzcCIgVGhlbg0KCQkJaHRtbD0iPCImIiVAIENPREVQQUdFPTY1MDAxICUiJiI+IiAmIGh0bWwNCgkJRW5kIElmDQoNCgkJQ2FsbCBDcmVhdERpcmVjdG9yeUJ5Q3VzdG9tRGlyZWN0b3J5V2l0aEZ1bGxCbG9nUGF0aChGdWxsUGF0aCkNCg0KCQlDYWxsIFNhdmVUb0ZpbGUoRnVsbFBhdGgsaHRtbCwidXRmLTgiLEZhbHNlKQ0KDQoJCVNhdmU9VHJ1ZQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCUZ1bmN0aW9uIFNhdmVDYWNoZSgpDQoJRW5kIEZ1bmN0aW9uDQoNCglGdW5jdGlvbiBMb2FkQ2FjaGUoKQ0KCUVuZCBGdW5jdGlvbg0KDQoNCglQcml2YXRlIFN1YiBDbGFzc19Jbml0aWFsaXplKCkNCg0KCQlJc0R5bmFtaWNMb2FkU2lsZGJhcj1GYWxzZQ0KCQlMaXN0VHlwZT0iREVGQVVMVCInQ0FURUdPUlknVVNFUidEQVRFJ1RBR1MNCgkJJ2lzQ2F0YWxvZz1GYWxzZQ0KDQoJRW5kIFN1Yg0KDQpFbmQgQ2xhc3MNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAg5a6a5LmJVFVzZXLnsbsNCicg6L6T5YWl77yaICAgIOaXoA0KJyDov5Tlm57vvJogICAg5pegDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpDbGFzcyBUVXNlcg0KDQoJUHVibGljIElEDQoJUHVibGljIExldmVsDQoJUHVibGljIE5hbWUNCglQdWJsaWMgUGFzc3dvcmQNCglQdWJsaWMgQWxpYXMNCg0KCVB1YmxpYyBTZXgNCglQdWJsaWMgRW1haWwNCglQdWJsaWMgTVNODQoJUHVibGljIFFRDQoJUHVibGljIEhvbWVQYWdlDQoJUHVibGljIEludHJvDQoNCglQdWJsaWMgQ291bnQNCg0KCVB1YmxpYyBMYXN0VmlzaXRUaW1lDQoJUHVibGljIExhc3RWaXNpdElQDQoNCglQdWJsaWMgTWV0YQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBNZXRhU3RyaW5nDQoJCU1ldGFTdHJpbmc9TWV0YS5TYXZlU3RyaW5nDQoJRW5kIFByb3BlcnR5DQoJUHVibGljIFByb3BlcnR5IExldCBNZXRhU3RyaW5nKHMpDQoJCU1ldGEuTG9hZFN0cmluZz1zDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgaHRtbA0KDQoJUHVibGljIFByb3BlcnR5IEdldCBMZXZlbE5hbWUNCgkJTGV2ZWxOYW1lPVpWQV9Vc2VyX0xldmVsX05hbWUoTGV2ZWwpDQoJRW5kIFByb3BlcnR5DQoNCglQcml2YXRlIEZmdWxscmVnZXgNCglQdWJsaWMgUHJvcGVydHkgTGV0IEZ1bGxSZWdleChzKQ0KCQlGZnVsbHJlZ2V4PXMNCglFbmQgUHJvcGVydHkNCglQdWJsaWMgUHJvcGVydHkgR2V0IEZ1bGxSZWdleA0KCQlJZiBGZnVsbHJlZ2V4PD4iIiBUaGVuIA0KCQkJRnVsbFJlZ2V4PUZmdWxscmVnZXgNCgkJRWxzZQ0KCQkJRnVsbFJlZ2V4PVpDX1VTRVJfUkVHRVgNCgkJRW5kIElmDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgRnVsbFVybA0KCVB1YmxpYyBUZW1wbGF0ZU5hbWUNCg0KDQoJUHJpdmF0ZSBGdGVtcGxhdGUNCglQdWJsaWMgUHJvcGVydHkgTGV0IFRlbXBsYXRlKHN0ckZpbGVOYW1lKQ0KCQlGdGVtcGxhdGU9R2V0VGVtcGxhdGUoIlRFTVBMQVRFXyIgJiBzdHJGaWxlTmFtZSkNCglFbmQgUHJvcGVydHkNCglQdWJsaWMgUHJvcGVydHkgR2V0IFRlbXBsYXRlDQoJCUlmIEZ0ZW1wbGF0ZTw+IiIgVGhlbg0KCQkJVGVtcGxhdGUgPSBGdGVtcGxhdGUNCgkJCUV4aXQgUHJvcGVydHkNCgkJRWxzZQ0KCQkJSWYgVGVtcGxhdGVOYW1lPD4iIiBUaGVuDQoJCQkJRGltIHMNCgkJCQlzPUdldFRlbXBsYXRlKCJURU1QTEFURV8iICZUZW1wbGF0ZU5hbWUpDQoJCQkJSWYgczw+IiIgVGhlbg0KCQkJCQlGdGVtcGxhdGUgPSBzDQoJCQkJRWxzZQ0KCQkJCQlGdGVtcGxhdGU9R2V0VGVtcGxhdGUoIlRFTVBMQVRFX0NBVEFMT0ciKQ0KCQkJCUVuZCBJZg0KCQkJRWxzZQ0KCQkJCUZ0ZW1wbGF0ZT1HZXRUZW1wbGF0ZSgiVEVNUExBVEVfQ0FUQUxPRyIpDQoJCQlFbmQgSWYNCgkJCVRlbXBsYXRlID0gRnRlbXBsYXRlDQoJCUVuZCBJZg0KCUVuZCBQcm9wZXJ0eQ0KDQoNCglQdWJsaWMgRnVuY3Rpb24gR2V0RGVmYXVsdFRlbXBsYXRlTmFtZQ0KCQlJZiBUZW1wbGF0ZU5hbWU8PiIiIFRoZW4NCgkJCUdldERlZmF1bHRUZW1wbGF0ZU5hbWU9VGVtcGxhdGVOYW1lDQoJCUVsc2UNCgkJCUdldERlZmF1bHRUZW1wbGF0ZU5hbWU9IkNBVEFMT0ciDQoJCUVuZCBJZg0KCUVuZCBGdW5jdGlvbg0KDQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IEZ1bGxQYXRoDQoJCUZ1bGxQYXRoPVBhcnNlQ3VzdG9tRGlyZWN0b3J5Rm9yUGF0aChGdWxsUmVnZXgsWkNfU1RBVElDX0RJUkVDVE9SWSwiIiwiIiwiIiwiIiwiIixJRCxOYW1lLFN0YXRpY05hbWUpDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IFVybA0KDQoJCSdwbHVnaW4gbm9kZQ0KCQliQWN0aW9uX1BsdWdpbl9UVXNlcl9Vcmw9RmFsc2UNCgkJRm9yIEVhY2ggc0FjdGlvbl9QbHVnaW5fVFVzZXJfVXJsIGluIEFjdGlvbl9QbHVnaW5fVFVzZXJfVXJsDQoJCQlJZiBOb3QgSXNFbXB0eShzQWN0aW9uX1BsdWdpbl9UVXNlcl9VcmwpIFRoZW4gQ2FsbCBFeGVjdXRlKHNBY3Rpb25fUGx1Z2luX1RVc2VyX1VybCkNCgkJCUlmIGJBY3Rpb25fUGx1Z2luX1RVc2VyX1VybD1UcnVlIFRoZW4gRXhpdCBQcm9wZXJ0eQ0KCQlOZXh0DQoNCgkJVXJsID1QYXJzZUN1c3RvbURpcmVjdG9yeUZvclVybChGdWxsUmVnZXgsWkNfU1RBVElDX0RJUkVDVE9SWSwiIiwiIiwiIiwiIiwiIixJRCxOYW1lLFN0YXRpY05hbWUpDQoJCUlmIFJpZ2h0KFVybCwxMik9ImRlZmF1bHQuaHRtbCIgVGhlbiBVcmw9TGVmdChVcmwsTGVuKFVybCktMTIpDQoNCgkJVXJsPVJlcGxhY2UoUmVwbGFjZShVcmwsIi8vIiwiLyIpLCI6LyIsIjovLyIsMSwxKQ0KDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UVXNlcl9VcmwoVXJsKQ0KDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IEZpcnN0TmFtZQ0KCQlGaXJzdE5hbWU9SUlmKExldmVsPTUsTmFtZSxJSWYoQWxpYXM9IiIsTmFtZSxBbGlhcykpDQoJRW5kIFByb3BlcnR5DQoNCglQcml2YXRlIEZ1bmN0aW9uIEdldEF2YXRhcg0KCSAgSWYgTm90IElzT2JqZWN0KFB1YmxpY09iakZTTykgVGhlbiBTZXQgUHVibGljT2JqRlNPPVNlcnZlci5DcmVhdGVPYmplY3QoIlNjcmlwdGluZy5GaWxlU3lzdGVtT2JqZWN0IikNCgkgIElmIChQdWJsaWNPYmpGU08uRmlsZUV4aXN0cyhCbG9nUGF0aCAmICJ6Yl91c2Vycy9hdmF0YXIvIiZJRCYiLnBuZyIpKSBUaGVuDQoJCUdldEF2YXRhcj1CbG9nSG9zdCAmICJ6Yl91c2Vycy9hdmF0YXIvIiZJRCYiLnBuZyINCgkgIEVsc2UNCgkJR2V0QXZhdGFyPUJsb2dIb3N0ICYgInpiX3VzZXJzL2F2YXRhci8wLnBuZyINCgkgIEVuZCBJZg0KCUVuZCBGdW5jdGlvbg0KDQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IEF2YXRhcg0KDQoJCUF2YXRhcj1HZXRBdmF0YXINCgkJDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IEh0bWxVcmwNCgkJSHRtbFVybD1UcmFuc2ZlckhUTUwoVXJsLCJbaHRtbC1mb3JtYXRdIikNCglFbmQgUHJvcGVydHkNCg0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgUnNzVXJsDQoJCVJzc1VybCA9IEJsb2dIb3N0ICYgImZlZWQuYXNwP2F1dGg9IiAmIElEDQoJRW5kIFByb3BlcnR5DQoNCg0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgU3RhdGljTmFtZQ0KCQlJZiBJc051bGwoQWxpYXMpIE9yIElzRW1wdHkoQWxpYXMpIE9yIEFsaWFzPSIiIFRoZW4NCgkJCVN0YXRpY05hbWUgPSBOYW1lDQoJCUVsc2UNCgkJCVN0YXRpY05hbWUgPSBBbGlhcw0KCQlFbmQgSWYNCglFbmQgUHJvcGVydHkNCg0KDQoJUHJpdmF0ZSBGRW1haWxNRDUNCglQdWJsaWMgUHJvcGVydHkgR2V0IEVtYWlsTUQ1DQoJCUlmIEZFbWFpbE1ENT0iIiBUaGVuDQoJCQlJZiBFbWFpbD0iIiBPciBJc051bGwoRW1haWwpPVRydWUgVGhlbg0KCQkJCUZFbWFpbE1ENT0iIg0KCQkJRWxzZQ0KCQkJCUZFbWFpbE1ENT1NRDUoRW1haWwpDQoJCQlFbmQgSWYNCgkJRW5kIElmDQoJCUVtYWlsTUQ1PUZFbWFpbE1ENQ0KCUVuZCBQcm9wZXJ0eQ0KDQoNCglQcml2YXRlIEZMb2dpblR5cGUNCglQdWJsaWMgUHJvcGVydHkgTGV0IExvZ2luVHlwZShzdHJMb2dpblR5cGUpDQoJCQlGTG9naW5UeXBlPXN0ckxvZ2luVHlwZQ0KCUVuZCBQcm9wZXJ0eQ0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgTG9naW5UeXBlDQoJCQlMb2dpblR5cGUgPSBGTG9naW5UeXBlDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUmVDb3VudA0KCVB1YmxpYyBFeElEDQoNCg0KCVByaXZhdGUgRkd1aWQNCglQdWJsaWMgUHJvcGVydHkgR2V0IEd1aWQNCgkJSWYgRkd1aWQ9IiIgVGhlbg0KCQkJRkd1aWQ9Um5kR3VpZCgpDQoJCQlJZiBJRD4wIFRoZW4NCgkJCQlGR3VpZD1vYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBbbWVtX0d1aWRdIEZST00gW2Jsb2dfTWVtYmVyXSBXSEVSRSBbbWVtX0lEXT0iJklEKSgwKQ0KCQkJRW5kIElmDQoJCUVuZCBJZg0KCQlHdWlkPUZHdWlkDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgRnVuY3Rpb24gQ3JlYXRlUGFzc3dvcmRCeU9yaWdpbmFsKE9yaWdpbmFQYXNzd29yZCkNCgkJQ3JlYXRlUGFzc3dvcmRCeU9yaWdpbmFsPU1ENShNRDUoT3JpZ2luYVBhc3N3b3JkKSAmIEd1aWQpDQoJRW5kIEZ1bmN0aW9uDQoNCglQdWJsaWMgRnVuY3Rpb24gR2V0UGFzc3dvcmRCeU9yaWdpbmFsKE9yaWdpbmFQYXNzd29yZCkNCg0KCQlEaW0gb2JqUlMNCgkJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFttZW1fR3VpZF0gRlJPTSBbYmxvZ19NZW1iZXJdIFdIRVJFIFttZW1fTmFtZV09JyImTmFtZSAmICInIiApDQoJCUlmIChOb3Qgb2JqUlMuQm9mKSBBbmQgKE5vdCBvYmpSUy5Fb2YpIFRoZW4NCgkJCUdldFBhc3N3b3JkQnlPcmlnaW5hbD1NRDUoTUQ1KE9yaWdpbmFQYXNzd29yZCkgJiBvYmpSUygibWVtX0d1aWQiKSkNCgkJRW5kIElmDQoNCgkJb2JqUlMuQ2xvc2UNCgkJU2V0IG9ialJTPU5vdGhpbmcNCg0KCUVuZCBGdW5jdGlvbg0KDQoNCglQdWJsaWMgRnVuY3Rpb24gR2V0UGFzc3dvcmRCeU1ENShNZDVQYXNzd29yZCkNCg0KCQlEaW0gb2JqUlMNCgkJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFttZW1fR3VpZF0gRlJPTSBbYmxvZ19NZW1iZXJdIFdIRVJFIFttZW1fTmFtZV09JyImTmFtZSAmICInIiApDQoJCUlmIChOb3Qgb2JqUlMuQm9mKSBBbmQgKE5vdCBvYmpSUy5Fb2YpIFRoZW4NCgkJCUdldFBhc3N3b3JkQnlNRDU9TUQ1KE1kNVBhc3N3b3JkICYgb2JqUlMoIm1lbV9HdWlkIikpDQoJCUVuZCBJZg0KDQoJCW9ialJTLkNsb3NlDQoJCVNldCBvYmpSUz1Ob3RoaW5nDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJUHVibGljIEZ1bmN0aW9uIFZlcmlmeSgpDQoJCURpbSBzdHJVc2VyTmFtZQ0KCQlEaW0gc3RyUGFzc1dvcmQNCg0KCQlJZiBMb2dpblR5cGU9IkNvb2tpZXMiIFRoZW4NCgkJCXN0clBhc3NXb3JkPVJlcXVlc3QuQ29va2llcygicGFzc3dvcmQiKQ0KCQkJSWYgKHN0clBhc3NXb3JkPSIiKSBUaGVuIEV4aXQgRnVuY3Rpb24NCgkJCXN0clVzZXJOYW1lPXZic3VuZXNjYXBlKFJlcXVlc3QuQ29va2llcygidXNlcm5hbWUiKSkNCgkJCUlmIChzdHJVc2VyTmFtZT0iIikgVGhlbiBFeGl0IEZ1bmN0aW9uDQoJCUVsc2VJZiBMb2dpblR5cGU9IkZvcm0iIFRoZW4NCgkJCXN0clBhc3NXb3JkPVJlcXVlc3QuRm9ybSgicGFzc3dvcmQiKQ0KCQkJSWYgKHN0clBhc3NXb3JkPSIiKSBUaGVuIEV4aXQgRnVuY3Rpb24NCgkJCXN0clVzZXJOYW1lPVJlcXVlc3QuRm9ybSgidXNlcm5hbWUiKQ0KCQkJSWYgKHN0clVzZXJOYW1lPSIiKSBUaGVuIEV4aXQgRnVuY3Rpb24NCgkJRWxzZUlmIExvZ2luVHlwZT0iUXVlcnlTdHJpbmciIFRoZW4NCgkJCXN0clBhc3NXb3JkPVJlcXVlc3QuUXVlcnlTdHJpbmcoInBhc3N3b3JkIikNCgkJCUlmIChzdHJQYXNzV29yZD0iIikgVGhlbiBFeGl0IEZ1bmN0aW9uDQoJCQlzdHJVc2VyTmFtZT1SZXF1ZXN0LlF1ZXJ5U3RyaW5nKCJ1c2VybmFtZSIpDQoJCQlJZiAoc3RyVXNlck5hbWU9IiIpIFRoZW4gRXhpdCBGdW5jdGlvbg0KCQlFbHNlSWYgTG9naW5UeXBlPSJTZWxmIiBUaGVuDQoJCQlzdHJQYXNzV29yZD1QYXNzd29yZA0KCQkJSWYgKHN0clBhc3NXb3JkPSIiKSBUaGVuIEV4aXQgRnVuY3Rpb24NCgkJCXN0clVzZXJOYW1lPU5hbWUNCgkJCUlmIChzdHJVc2VyTmFtZT0iIikgVGhlbiBFeGl0IEZ1bmN0aW9uDQoJCUVsc2UNCgkJCUV4aXQgRnVuY3Rpb24NCgkJRW5kIElmDQoNCg0KCQlJZiBTZXNzaW9uKFpDX0JMT0dfQ0xTSUQgJiAicXVpY2tsb2dpbiIpPU1ENShNb250aChOb3cpICYgRGF5KE5vdykgJiBaQ19CTE9HX0NMU0lEICYgc3RyVXNlck5hbWUgJiBzdHJQYXNzV29yZCkgVGhlbg0KCQkJSWYgTG9hZEluZm9ieUFycmF5KEFwcGxpY2F0aW9uKFpDX0JMT0dfQ0xTSUQgJiAiUVVJQ0tMT0dJTl9JRCIgJiBTZXNzaW9uKFpDX0JMT0dfQ0xTSUQgJiAicXVpY2tsb2dpbl9pZCIpKSkgVGhlbg0KCQkJCVZlcmlmeT1UcnVlDQoJCQkJRXhpdCBGdW5jdGlvbg0KCQkJRW5kIElmDQoJCUVuZCBJZg0KDQoJCSfmoKHmo4ANCgkJJ0lmIExlbihzdHJVc2VyTmFtZSkgPlpDX1VTRVJOQU1FX01BWCBUaGVuIENhbGwgU2hvd0Vycm9yKDcpDQoJCSdJZiBMZW4oc3RyUGFzc1dvcmQpPD4zMiBUaGVuIENhbGwgU2hvd0Vycm9yKDU1KQ0KCQknSWYgTm90IENoZWNrUmVnRXhwKHN0clVzZXJOYW1lLCJbdXNlcm5hbWVdIikgVGhlbiBDYWxsIFNob3dFcnJvcig3KQ0KDQoJCXN0clVzZXJOYW1lPUZpbHRlclNRTChzdHJVc2VyTmFtZSkNCgkJc3RyUGFzc1dvcmQ9RmlsdGVyU1FMKHN0clBhc3NXb3JkKQ0KDQoJCURpbSBvYmpSUw0KCQlTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgKiBGUk9NIFtibG9nX01lbWJlcl0gV0hFUkUgW21lbV9OYW1lXT0nIiZzdHJVc2VyTmFtZSAmICInIikNCgkJSWYgKE5vdCBvYmpSUy5Cb2YpIEFuZCAoTm90IG9ialJTLkVvZikgVGhlbg0KDQoJCQlJZiBTdHJDb21wKHN0clBhc3NXb3JkLG9ialJTKCJtZW1fUGFzc3dvcmQiKSk9MCBUaGVuDQoNCgkJCQlDYWxsIExvYWRJbmZvYnlJRChvYmpSUygibWVtX0lEIikpDQoNCgkJCQlTZXNzaW9uKFpDX0JMT0dfQ0xTSUQgJiAicXVpY2tsb2dpbiIpPU1ENShNb250aChOb3cpICYgRGF5KE5vdykgJiBaQ19CTE9HX0NMU0lEICYgc3RyVXNlck5hbWUgJiBzdHJQYXNzV29yZCkNCgkJCQlTZXNzaW9uKFpDX0JMT0dfQ0xTSUQgJiAicXVpY2tsb2dpbl9pZCIpPUlEDQoJCQkJQXBwbGljYXRpb24uTG9jaw0KCQkJCUFwcGxpY2F0aW9uKFpDX0JMT0dfQ0xTSUQgJiAiUVVJQ0tMT0dJTl9JRCIgJiBJRCk9QXJyYXkoSUQsTmFtZSxMZXZlbCxQYXNzd29yZCxFbWFpbCxIb21lUGFnZSxDb3VudCxBbGlhcyxUZW1wbGF0ZU5hbWUsRnVsbFVybCxJbnRybyxNZXRhU3RyaW5nKQ0KCQkJCUFwcGxpY2F0aW9uLlVuTG9jaw0KDQoJCQkJVmVyaWZ5PVRydWUNCgkJCUVsc2UNCgkJCQknSWYgTG9naW5UeXBlPSJDb29raWVzIiBUaGVuIFJlc3BvbnNlLkNvb2tpZXMoInBhc3N3b3JkIik9IiINCgkJCUVuZCBJZg0KCQlFbHNlDQoJCQknSWYgTG9naW5UeXBlPSJDb29raWVzIiBUaGVuIFJlc3BvbnNlLkNvb2tpZXMoInBhc3N3b3JkIik9IiINCgkJRW5kIElmDQoNCgkJb2JqUlMuQ2xvc2UNCgkJU2V0IG9ialJTPU5vdGhpbmcNCg0KCUVuZCBGdW5jdGlvbg0KDQoNCglGdW5jdGlvbiBMb2FkSW5mb2J5SUQodXNlcl9JRCkNCg0KCQlDYWxsIENoZWNrUGFyYW1ldGVyKHVzZXJfSUQsImludCIsMCkNCg0KCQlEaW0gb2JqUlMNCgkJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFttZW1fSURdLFttZW1fTmFtZV0sW21lbV9MZXZlbF0sW21lbV9QYXNzd29yZF0sW21lbV9FbWFpbF0sW21lbV9Ib21lUGFnZV0sW21lbV9Qb3N0TG9nc10sW21lbV9JbnRyb10sW21lbV9UZW1wbGF0ZV0sW21lbV9GdWxsVXJsXSxbbWVtX1VybF0sW21lbV9NZXRhXSBGUk9NIFtibG9nX01lbWJlcl0gV0hFUkUgW21lbV9JRF09IiAmIHVzZXJfSUQpDQoJCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCg0KCQkJSUQ9b2JqUlMoIm1lbV9JRCIpDQoJCQlOYW1lPW9ialJTKCJtZW1fTmFtZSIpDQoJCQlMZXZlbD1vYmpSUygibWVtX0xldmVsIikNCgkJCVBhc3N3b3JkPW9ialJTKCJtZW1fUGFzc3dvcmQiKQ0KCQkJRW1haWw9b2JqUlMoIm1lbV9FbWFpbCIpDQoJCQlIb21lUGFnZT1vYmpSUygibWVtX0hvbWVQYWdlIikNCgkJCUNvdW50PW9ialJTKCJtZW1fUG9zdExvZ3MiKQ0KCQkJQWxpYXM9b2JqUlMoIm1lbV9VcmwiKQ0KCQkJVGVtcGxhdGVOYW1lPW9ialJTKCJtZW1fVGVtcGxhdGUiKQ0KCQkJRnVsbFVybD1vYmpSUygibWVtX0Z1bGxVcmwiKQ0KCQkJSW50cm89b2JqUlMoIm1lbV9JbnRybyIpDQoJCQlNZXRhU3RyaW5nPW9ialJTKCJtZW1fTWV0YSIpDQoNCgkJCUlmIElzTnVsbChFbWFpbCkgT3IgSXNFbXB0eShFbWFpbCkgT3IgTGVuKEVtYWlsKT0wIFRoZW4gRW1haWw9Im51bGxAbnVsbC5jb20iDQoJCQlJZiBJc051bGwoSG9tZVBhZ2UpIFRoZW4gSG9tZVBhZ2U9IiINCgkJCUlmIElzTnVsbChBbGlhcykgVGhlbiBBbGlhcz0iIg0KCQkJSWYgSXNOdWxsKFRlbXBsYXRlTmFtZSkgVGhlbiBUZW1wbGF0ZU5hbWU9IiINCg0KCQkJTG9hZEluZm9ieUlEPVRydWUNCgkJRW5kIElmDQoNCgkJb2JqUlMuQ2xvc2UNCgkJU2V0IG9ialJTPU5vdGhpbmcNCg0KDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UVXNlcl9Mb2FkSW5mb2J5SUQoSUQsTmFtZSxMZXZlbCxQYXNzd29yZCxFbWFpbCxIb21lUGFnZSxDb3VudCxBbGlhcyxUZW1wbGF0ZU5hbWUsRnVsbFVybCxJbnRybyxNZXRhU3RyaW5nKQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCVB1YmxpYyBGdW5jdGlvbiBMb2FkSW5mb0J5QXJyYXkoYXJ5VXNlckluZm8pDQoNCgkJSWYgSXNBcnJheShhcnlVc2VySW5mbyk9VHJ1ZSBUaGVuDQoNCgkJCUlEPWFyeVVzZXJJbmZvKDApDQoJCQlOYW1lPWFyeVVzZXJJbmZvKDEpDQoJCQlMZXZlbD1hcnlVc2VySW5mbygyKQ0KCQkJUGFzc3dvcmQ9YXJ5VXNlckluZm8oMykNCgkJCUVtYWlsPWFyeVVzZXJJbmZvKDQpDQoJCQlIb21lUGFnZT1hcnlVc2VySW5mbyg1KQ0KCQkJQ291bnQ9YXJ5VXNlckluZm8oNikNCgkJCUFsaWFzPWFyeVVzZXJJbmZvKDcpDQoJCQlUZW1wbGF0ZU5hbWU9YXJ5VXNlckluZm8oOCkNCgkJCUZ1bGxVcmw9YXJ5VXNlckluZm8oOSkNCgkJCUludHJvPWFyeVVzZXJJbmZvKDEwKQ0KCQkJTWV0YVN0cmluZz1hcnlVc2VySW5mbygxMSkNCg0KCQkJSWYgSXNOdWxsKEVtYWlsKSBPciBJc0VtcHR5KEVtYWlsKSBPciBMZW4oRW1haWwpPTAgVGhlbiBFbWFpbD0iYUBiLmNvbSINCgkJCUlmIElzTnVsbChIb21lUGFnZSkgVGhlbiBIb21lUGFnZT0iIg0KCQkJSWYgSXNOdWxsKEFsaWFzKSBUaGVuIEFsaWFzPSIiDQoJCQlJZiBJc051bGwoVGVtcGxhdGVOYW1lKSBUaGVuIFRlbXBsYXRlTmFtZT0iIg0KDQoJCQlMb2FkSW5mb0J5QXJyYXk9VHJ1ZQkJDQoNCgkJRW5kIElmDQoNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RVc2VyX0xvYWRJbmZvQnlBcnJheShJRCxOYW1lLExldmVsLFBhc3N3b3JkLEVtYWlsLEhvbWVQYWdlLENvdW50LEFsaWFzLFRlbXBsYXRlTmFtZSxGdWxsVXJsLEludHJvLE1ldGFTdHJpbmcpDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJRnVuY3Rpb24gRWRpdChjdXJyZW50VXNlcikNCg0KCQlDYWxsIEZpbHRlcl9QbHVnaW5fVFVzZXJfRWRpdChJRCxOYW1lLExldmVsLFBhc3N3b3JkLEVtYWlsLEhvbWVQYWdlLENvdW50LEFsaWFzLFRlbXBsYXRlTmFtZSxGdWxsVXJsLEludHJvLE1ldGFTdHJpbmcsY3VycmVudFVzZXIpDQoNCgkJQ2FsbCBDaGVja1BhcmFtZXRlcihJRCwiaW50IiwwKQ0KCQlDYWxsIENoZWNrUGFyYW1ldGVyKExldmVsLCJpbnQiLDApDQoNCgkJSWYgKChMZXZlbDwxKSBPciAoTGV2ZWw+NSkpIFRoZW4gQ2FsbCBTaG93RXJyb3IoMTYpDQoJCUlmIChOYW1lPSIiKSBUaGVuIENhbGwgU2hvd0Vycm9yKDcpDQoJCUlmIExlbihOYW1lKSA+WkNfVVNFUk5BTUVfTUFYIFRoZW4gQ2FsbCBTaG93RXJyb3IoNykNCgkJSWYgTm90IENoZWNrUmVnRXhwKE5hbWUsIlt1c2VybmFtZV0iKSBUaGVuIENhbGwgU2hvd0Vycm9yKDcpDQoNCgkJRW1haWw9RmlsdGVyU1FMKEVtYWlsKQ0KCQlIb21lUGFnZT1GaWx0ZXJTUUwoSG9tZVBhZ2UpDQoNCgkJRW1haWw9VHJhbnNmZXJIVE1MKEVtYWlsLCJbaHRtbC1mb3JtYXRdIikNCgkJSG9tZVBhZ2U9VHJhbnNmZXJIVE1MKEhvbWVQYWdlLCJbaHRtbC1mb3JtYXRdIikNCg0KCQlBbGlhcz1UcmFuc2ZlckhUTUwoQWxpYXMsIltkaXJlY3RvcnkmZmlsZV0iKQ0KCQlJZiBMZWZ0KEFsaWFzLDEpPSIvIiBUaGVuIEFsaWFzPVJpZ2h0KEFsaWFzLExlbihBbGlhcyktMSkNCgkJSWYgUmlnaHQoQWxpYXMsMSk9Ii8iIFRoZW4gQWxpYXM9TGVmdChBbGlhcyxMZW4oQWxpYXMpLTEpDQoJCUFsaWFzPUZpbHRlclNRTChBbGlhcykNCg0KCQlUZW1wbGF0ZU5hbWU9VUNhc2UoRmlsdGVyU1FMKFRlbXBsYXRlTmFtZSkpDQoJCUlmIFRlbXBsYXRlTmFtZT0iQ0FUQUxPRyIgVGhlbiBUZW1wbGF0ZU5hbWU9IiINCg0KCQlJZiBMZW4oRW1haWwpPTAgVGhlbiBDYWxsIFNob3dFcnJvcigyOSkNCgkJSWYgTGVuKEVtYWlsKT5aQ19FTUFJTF9NQVggVGhlbiBDYWxsIFNob3dFcnJvcigyOSkNCgkJSWYgTGVuKEhvbWVQYWdlKT5aQ19IT01FUEFHRV9NQVggVGhlbiBDYWxsIFNob3dFcnJvcigyOSkNCg0KCQlJZiBOb3QgQ2hlY2tSZWdFeHAoRW1haWwsIltlbWFpbF0iKSBUaGVuIENhbGwgU2hvd0Vycm9yKDI5KQ0KCQlJRiBMZW4oSG9tZVBhZ2UpPjAgVGhlbg0KCQkJSWYgTm90IENoZWNrUmVnRXhwKEhvbWVQYWdlLCJbaG9tZXBhZ2VdIikgVGhlbiBDYWxsIFNob3dFcnJvcigzMCkNCgkJRW5kIElmDQoNCgkJSW50cm89RmlsdGVyU1FMKEludHJvKQ0KDQoJCUlmIElEPTAgVGhlbg0KDQoJCQlJZiBMZXZlbCA8PSBjdXJyZW50VXNlci5MZXZlbCBUaGVuIFNob3dFcnJvcig2KQ0KCQkJSWYgTGVuKFBhc3NXb3JkKTw+MzIgVGhlbiBDYWxsIFNob3dFcnJvcig1NSkNCg0KCQkJRGltIG9ialJTMg0KCQkJU2V0IG9ialJTMiA9IG9iakNvbm4uZXhlY3V0ZSAoIlNFTEVDVCBbbWVtX2lkXSBGUk9NIFtibG9nX01lbWJlcl0gV0hFUkUgW21lbV9OYW1lXT0nIiAmIE5hbWUgJiAiJyAiKQ0KCQkJSWYgKE5vdCBvYmpSUzIuYm9mKSBBbmQgKE5vdCBvYmpSUzIuZW9mKSBUaGVuDQoJCQkJQ2FsbCBTaG93RXJyb3IoNjIpDQoJCQlFbmQgSWYNCgkJCVNldCBvYmpSUzI9Tm90aGluZw0KDQoJCQlvYmpDb25uLkV4ZWN1dGUoIklOU0VSVCBJTlRPIFtibG9nX01lbWJlcl0oW21lbV9MZXZlbF0sW21lbV9OYW1lXSxbbWVtX1Bhc3NXb3JkXSxbbWVtX0VtYWlsXSxbbWVtX0hvbWVQYWdlXSxbbWVtX1VybF0sW21lbV9HdWlkXSxbbWVtX0ludHJvXSxbbWVtX1RlbXBsYXRlXSxbbWVtX01ldGFdKSBWQUxVRVMgKCImTGV2ZWwmIiwnIiZOYW1lJiInLCciJlBhc3NXb3JkJiInLCciJkVtYWlsJiInLCciJkhvbWVQYWdlJiInLCciJkFsaWFzJiInLCciJkd1aWQmIicsJyImSW50cm8mIicsJyImVGVtcGxhdGVOYW1lJiInLCciJk1ldGFTdHJpbmcmIicpIikNCgkJCQ0KCQkJRGltIG9ialJTDQoJCQlTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgTUFYKFttZW1fSURdKSBGUk9NIFtibG9nX01lbWJlcl0iKQ0KCQkJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KCQkJCUlEPW9ialJTKDApDQoJCQlFbmQgSWYNCgkJCVNldCBvYmpSUz1Ob3RoaW5nDQoNCgkJRWxzZQ0KDQoJCQlJZiAoSUQ9Y3VycmVudFVzZXIuSUQpIEFuZCAoTGV2ZWwgPD4gY3VycmVudFVzZXIuTGV2ZWwpIFRoZW4gU2hvd0Vycm9yKDYpDQoJCQlJZiAoSUQ8PmN1cnJlbnRVc2VyLklEKSBBbmQgKExldmVsIDw9IGN1cnJlbnRVc2VyLkxldmVsKSBUaGVuIFNob3dFcnJvcig2KQ0KDQoJCQlJZiBJRD4wIFRoZW4NCgkJCQlEaW0gb2JqUlMzDQoJCQkJU2V0IG9ialJTMyA9IG9iakNvbm4uZXhlY3V0ZSAoIlNFTEVDVCBbbWVtX2lkXSBGUk9NIFtibG9nX01lbWJlcl0gV0hFUkUgW21lbV9OYW1lXT0nIiAmIE5hbWUgJiAiJyBBTkQgW21lbV9JRF08PiIgJiBJRCkNCgkJCQlJZiAoTm90IG9ialJTMy5ib2YpIEFuZCAoTm90IG9ialJTMy5lb2YpIFRoZW4NCgkJCQkJQ2FsbCBTaG93RXJyb3IoNjIpDQoJCQkJRW5kIElmDQoJCQkJU2V0IG9ialJTMz1Ob3RoaW5nDQoJCQlFbmQgSWYNCg0KDQoJCQlEaW0gdGFyZ2V0VXNlcg0KCQkJU2V0IHRhcmdldFVzZXI9TmV3IFRVc2VyDQoJCQlJZiB0YXJnZXRVc2VyLkxvYWRJbmZvYnlJRChJRCkgVGhlbg0KDQoJCQkJSWYgTGVuKFBhc3NXb3JkKT0wIFRoZW4NCgkJCQkJUGFzc1dvcmQ9dGFyZ2V0VXNlci5QYXNzV29yZA0KCQkJCUVuZCBJZg0KDQoJCQkJSWYgTGVuKFBhc3NXb3JkKTw+MzIgVGhlbiBDYWxsIFNob3dFcnJvcig1NSkNCg0KCQkJCW9iakNvbm4uRXhlY3V0ZSgiVVBEQVRFIFtibG9nX01lbWJlcl0gU0VUIFttZW1fTGV2ZWxdPSImTGV2ZWwmIixbbWVtX05hbWVdPSciJk5hbWUmIicsW21lbV9QYXNzV29yZF09JyImUGFzc1dvcmQmIicsW21lbV9FbWFpbF09JyImRW1haWwmIicsW21lbV9Ib21lUGFnZV09JyImSG9tZVBhZ2UmIicsW21lbV9VcmxdPSciJkFsaWFzJiInLFttZW1fSW50cm9dPSciJkludHJvJiInLFttZW1fVGVtcGxhdGVdPSciJlRlbXBsYXRlTmFtZSYiJyxbbWVtX01ldGFdPSciJk1ldGFTdHJpbmcmIicgV0hFUkUgW21lbV9JRF09IiZJRCkNCg0KCQkJCUlmIE5hbWUgPD4gdGFyZ2V0VXNlci5OYW1lIFRoZW4NCgkJCQkJb2JqQ29ubi5FeGVjdXRlKCJVUERBVEUgW2Jsb2dfQ29tbWVudF0gU0VUIFtjb21tX0F1dGhvcl09JyImTmFtZSYiJyBXSEVSRSBbY29tbV9BdXRob3JJRF09IiZJRCkNCgkJCQlFbmQgSWYNCgkJCQlJZiBFbWFpbCA8PiB0YXJnZXRVc2VyLkVtYWlsIFRoZW4NCgkJCQkJb2JqQ29ubi5FeGVjdXRlKCJVUERBVEUgW2Jsb2dfQ29tbWVudF0gU0VUIFtjb21tX0VtYWlsXT0nIiZFbWFpbCYiJyBXSEVSRSBbY29tbV9BdXRob3JJRF09IiZJRCkNCgkJCQlFbmQgSWYNCg0KCQkJRW5kIElmDQoJCQkNCgkJCURpbSB0bXBDbHNJRA0KCQkJdG1wQ2xzSUQ9TUQ1KEJsb2dQYXRoICYgWkNfQkxPR19DTFNJRF9PUklHSU5BTCkNCgkJCUFwcGxpY2F0aW9uLkxvY2sNCgkJCUFwcGxpY2F0aW9uKHRtcENsc0lEICYgIlFVSUNLTE9HSU5fSUQiICYgU2Vzc2lvbih0bXBDbHNJRCAmICJxdWlja2xvZ2luX2lkIikpPUVtcHR5DQoJCQlBcHBsaWNhdGlvbih0bXBDbHNJRCAmICJRVUlDS0xPR0lOX0lEIiAmIElEKT1FbXB0eQ0KCQkJQXBwbGljYXRpb24uVW5Mb2NrDQoJCQlTZXNzaW9uKHRtcENsc0lEICYgInF1aWNrbG9naW4iKT1FbXB0eQ0KCQkJU2Vzc2lvbih0bXBDbHNJRCAmICJxdWlja2xvZ2luX2lkIik9RW1wdHkNCg0KDQoJCUVuZCBJZg0KDQoJCUVkaXQ9VHJ1ZQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCUZ1bmN0aW9uIFJlZ2lzdGVyKCkNCg0KCQlEaW0gY3VycmVudFVzZXINCgkJU2V0IGN1cnJlbnRVc2VyPUJsb2dVc2VyDQoNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RVc2VyX1JlZ2lzdGVyKElELE5hbWUsTGV2ZWwsUGFzc3dvcmQsRW1haWwsSG9tZVBhZ2UsQ291bnQsQWxpYXMsVGVtcGxhdGVOYW1lLEZ1bGxVcmwsSW50cm8sTWV0YVN0cmluZyxjdXJyZW50VXNlcikNCg0KCQlDYWxsIENoZWNrUGFyYW1ldGVyKElELCJpbnQiLDApDQoJCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoTGV2ZWwsImludCIsMCkNCg0KCQlQYXNzV29yZD1NRDUoUGFzc3dvcmQgJiBHdWlkKQ0KDQoJCUlmIChMZXZlbDw9MSkgVGhlbiBDYWxsIFNob3dFcnJvcigxNikNCgkJSWYgKE5hbWU9IiIpIFRoZW4gQ2FsbCBTaG93RXJyb3IoNykNCgkJSWYgTGVuKE5hbWUpID5aQ19VU0VSTkFNRV9NQVggVGhlbiBDYWxsIFNob3dFcnJvcig3KQ0KCQlJZiBOb3QgQ2hlY2tSZWdFeHAoTmFtZSwiW3VzZXJuYW1lXSIpIFRoZW4gQ2FsbCBTaG93RXJyb3IoNykNCg0KCQlFbWFpbD1GaWx0ZXJTUUwoRW1haWwpDQoJCUhvbWVQYWdlPUZpbHRlclNRTChIb21lUGFnZSkNCg0KCQlFbWFpbD1UcmFuc2ZlckhUTUwoRW1haWwsIltodG1sLWZvcm1hdF0iKQ0KCQlIb21lUGFnZT1UcmFuc2ZlckhUTUwoSG9tZVBhZ2UsIltodG1sLWZvcm1hdF0iKQ0KDQoJCUFsaWFzPVRyYW5zZmVySFRNTChBbGlhcywiW2RpcmVjdG9yeSZmaWxlXSIpDQoJCUlmIExlZnQoQWxpYXMsMSk9Ii8iIFRoZW4gQWxpYXM9UmlnaHQoQWxpYXMsTGVuKEFsaWFzKS0xKQ0KCQlJZiBSaWdodChBbGlhcywxKT0iLyIgVGhlbiBBbGlhcz1MZWZ0KEFsaWFzLExlbihBbGlhcyktMSkNCgkJQWxpYXM9RmlsdGVyU1FMKEFsaWFzKQ0KDQoJCVRlbXBsYXRlTmFtZT1VQ2FzZShGaWx0ZXJTUUwoVGVtcGxhdGVOYW1lKSkNCgkJSWYgVGVtcGxhdGVOYW1lPSJDQVRBTE9HIiBUaGVuIFRlbXBsYXRlTmFtZT0iIg0KDQoJCUlmIExlbihFbWFpbCk9MCBUaGVuIENhbGwgU2hvd0Vycm9yKDI5KQ0KCQlJZiBMZW4oRW1haWwpPlpDX0VNQUlMX01BWCBUaGVuIENhbGwgU2hvd0Vycm9yKDI5KQ0KCQlJZiBMZW4oSG9tZVBhZ2UpPlpDX0hPTUVQQUdFX01BWCBUaGVuIENhbGwgU2hvd0Vycm9yKDI5KQ0KDQoJCUlmIE5vdCBDaGVja1JlZ0V4cChFbWFpbCwiW2VtYWlsXSIpIFRoZW4gQ2FsbCBTaG93RXJyb3IoMzApDQoJCUlGIExlbihIb21lUGFnZSk+MCBUaGVuDQoJCQlJZiBOb3QgQ2hlY2tSZWdFeHAoSG9tZVBhZ2UsIltob21lcGFnZV0iKSBUaGVuIENhbGwgU2hvd0Vycm9yKDMwKQ0KCQlFbmQgSWYNCg0KDQoJCUlmIElEPTAgVGhlbg0KDQoJCQlJZiBMZXZlbCA8PSAxIFRoZW4gU2hvd0Vycm9yKDYpDQoJCQlJZiBMZW4oUGFzc1dvcmQpPD4zMiBUaGVuIENhbGwgU2hvd0Vycm9yKDU1KQ0KDQoJCQlEaW0gb2JqUlMyDQoJCQlTZXQgb2JqUlMyID0gb2JqQ29ubi5leGVjdXRlICgiU0VMRUNUIFttZW1faWRdIEZST00gW2Jsb2dfTWVtYmVyXSBXSEVSRSBbbWVtX05hbWVdPSciICYgTmFtZSAmICInICIpDQoJCQlJZiAoTm90IG9ialJTMi5ib2YpIEFuZCAoTm90IG9ialJTMi5lb2YpIFRoZW4NCgkJCQlDYWxsIFNob3dFcnJvcig2MikNCgkJCUVuZCBJZg0KCQkJU2V0IG9ialJTMj1Ob3RoaW5nDQoNCgkJCW9iakNvbm4uRXhlY3V0ZSgiSU5TRVJUIElOVE8gW2Jsb2dfTWVtYmVyXShbbWVtX0xldmVsXSxbbWVtX05hbWVdLFttZW1fUGFzc1dvcmRdLFttZW1fRW1haWxdLFttZW1fSG9tZVBhZ2VdLFttZW1fVXJsXSxbbWVtX0d1aWRdLFttZW1fSW50cm9dLFttZW1fTWV0YV0pIFZBTFVFUyAoIiZMZXZlbCYiLCciJk5hbWUmIicsJyImUGFzc1dvcmQmIicsJyImRW1haWwmIicsJyImSG9tZVBhZ2UmIicsJyImQWxpYXMmIicsJyImR3VpZCYiJywnIiZJbnRybyYiJywnIiZNZXRhU3RyaW5nJiInKSIpDQoNCgkJCURpbSBvYmpSUw0KCQkJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIE1BWChbbWVtX0lEXSkgRlJPTSBbYmxvZ19NZW1iZXJdIikNCgkJCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCgkJCQlJRD1vYmpSUygwKQ0KCQkJRW5kIElmDQoJCQlTZXQgb2JqUlM9Tm90aGluZw0KDQoJCQlSZWdpc3Rlcj1UcnVlDQoNCgkJRW5kIElmDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJRnVuY3Rpb24gRGVsKGN1cnJlbnRVc2VyKQ0KDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UVXNlcl9EZWwoSUQsTmFtZSxMZXZlbCxQYXNzd29yZCxFbWFpbCxIb21lUGFnZSxDb3VudCxBbGlhcyxUZW1wbGF0ZU5hbWUsRnVsbFVybCxJbnRybyxNZXRhU3RyaW5nLGN1cnJlbnRVc2VyKQ0KDQoJCURpbSBvYmpSUw0KCQlEaW0gb2JqVXBMb2FkRmlsZQ0KDQoJCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoSUQsImludCIsMCkNCgkJQ2FsbCBDaGVja1BhcmFtZXRlcihMZXZlbCwiaW50IiwwKQ0KDQoJCURpbSB0YXJnZXRVc2VyDQoJCVNldCB0YXJnZXRVc2VyPU5ldyBUVXNlcg0KCQlJZiB0YXJnZXRVc2VyLkxvYWRJbmZvYnlJRChJRCkgVGhlbg0KCQkJSWYgdGFyZ2V0VXNlci5MZXZlbDw9IGN1cnJlbnRVc2VyLkxldmVsIFRoZW4gU2hvd0Vycm9yKDYpDQoJCQlJZiBjdXJyZW50VXNlci5JRCA9IHRhcmdldFVzZXIuSUQgVGhlbiBTaG93RXJyb3IoMTcpDQoJCUVsc2UNCgkJCUV4aXQgRnVuY3Rpb24NCgkJRW5kIElmDQoNCgkJb2JqQ29ubi5FeGVjdXRlKCJERUxFVEUgRlJPTSBbYmxvZ19BcnRpY2xlXSBXSEVSRSBbbG9nX0F1dGhvcklEXSA9IiAmIElEKQ0KCQlvYmpDb25uLkV4ZWN1dGUoIkRFTEVURSBGUk9NIFtibG9nX0NvbW1lbnRdIFdIRVJFIFtjb21tX0F1dGhvcklEXSA9IiAmIElEKQ0KCQlvYmpDb25uLkV4ZWN1dGUoIkRFTEVURSBGUk9NIFtibG9nX01lbWJlcl0gV0hFUkUgW21lbV9JRF0gPSIgJiBJRCkNCg0KCQlTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgdWxfaWQgRlJPTSBbYmxvZ19VcExvYWRdIFdIRVJFIFt1bF9BdXRob3JJRF0gPSIgJiBJRCkNCgkJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KCQkJRG8gV2hpbGUgTm90IG9ialJTLmVvZg0KCQkJCVNldCBvYmpVcExvYWRGaWxlPU5ldyBUVXBMb2FkRmlsZQ0KCQkJCUlmIG9ialVwTG9hZEZpbGUuTG9hZEluZm9CeUlEKG9ialJTKCJ1bF9JRCIpKSBUaGVuIG9ialVwTG9hZEZpbGUuRGVsDQoJCQkJU2V0IG9ialVwTG9hZEZpbGU9Tm90aGluZw0KCQkJCW9ialJTLk1vdmVOZXh0DQoJCQlMb29wDQoJCUVuZCBJZg0KCQlvYmpSUy5DbG9zZQ0KCQlTZXQgb2JqUlM9Tm90aGluZw0KDQoJCW9iakNvbm4uRXhlY3V0ZSgiREVMRVRFIEZST00gW2Jsb2dfVXBMb2FkXSBXSEVSRSBbdWxfQXV0aG9ySURdID0iICYgSUQpDQoNCgkJRGVsPVRydWUNCg0KCUVuZCBGdW5jdGlvbg0KDQoJRnVuY3Rpb24gR2V0SURieU5hbWUobikNCg0KCQluPUZpbHRlclNRTChuKQ0KDQoJCURpbSBvYmpSUw0KCQlTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgW21lbV9JRF0gRlJPTSBbYmxvZ19NZW1iZXJdIFdIRVJFIFttZW1fTmFtZV09JyImIG4gJiAiJyIpDQoJCUlmIChOb3Qgb2JqUlMuQm9mKSBBbmQgKE5vdCBvYmpSUy5Fb2YpIFRoZW4NCgkJCUdldElEYnlOYW1lPUNMbmcob2JqUlMoIm1lbV9JRCIpKQ0KCQlFbmQgSWYNCg0KCUVuZCBGdW5jdGlvbg0KDQoNCglQcml2YXRlIFN1YiBDbGFzc19Jbml0aWFsaXplKCkNCg0KCQlMZXZlbD01DQoJCUlEPTANCgkJTmFtZT1aQ19NU0cwMTgNCg0KCQlTZXg9MA0KCQlFbWFpbD0iIg0KCQlNU049IiINCgkJUVE9IiINCgkJSG9tZVBhZ2U9IiINCgkJSW50cm89IiINCg0KCQlMb2dpblR5cGU9IkNvb2tpZXMiDQoNCgkJUmVDb3VudD0wDQoJCUV4SUQ9LTENCg0KCQlTZXQgTWV0YT1OZXcgVE1ldGENCg0KCUVuZCBTdWINCg0KDQpFbmQgQ2xhc3MNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAg5a6a5LmJVENvbW1lbnTnsbsNCicg6L6T5YWl77yaICAgIOaXoA0KJyDov5Tlm57vvJogICAg5pegDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpDbGFzcyBUQ29tbWVudA0KDQoJUHVibGljIElEDQoJUHVibGljIGxvZ19JRA0KCVB1YmxpYyBQYXJlbnRJRA0KCQ0KCVB1YmxpYyBBdXRob3JJRA0KCVB1YmxpYyBBdXRob3INCglQdWJsaWMgQ29udGVudA0KCVB1YmxpYyBFbWFpbA0KCVB1YmxpYyBIb21lUGFnZQ0KDQoJUHVibGljIFBvc3RUaW1lDQoJUHVibGljIElQDQoJUHVibGljIEFnZW50DQoNCglQdWJsaWMgUmVwbHkNCglQdWJsaWMgTGFzdFJlcGx5SVANCglQdWJsaWMgTGFzdFJlcGx5VGltZQ0KDQoJUHVibGljIENvdW50DQoJUHVibGljIElzQ2hlY2sNCglQdWJsaWMgTWV0YQ0KDQoJUHVibGljIElzVGhyb3cgJ+atpOWAvOS4ulRydWXml7Ys57O757uf5LiN5Lya5L+d5a2Y55qELOS8muebtOaOpeaJlOWHuuWOuy4NCg0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgTWV0YVN0cmluZw0KCQlNZXRhU3RyaW5nPU1ldGEuU2F2ZVN0cmluZw0KCUVuZCBQcm9wZXJ0eQ0KCVB1YmxpYyBQcm9wZXJ0eSBMZXQgTWV0YVN0cmluZyhzKQ0KCQlNZXRhLkxvYWRTdHJpbmc9cw0KCUVuZCBQcm9wZXJ0eQ0KDQoNCglQcml2YXRlIEZBdmF0YXINCglQdWJsaWMgUHJvcGVydHkgR2V0IEF2YXRhcg0KCQkncGx1Z2luIG5vZGUNCgkJYkFjdGlvbl9QbHVnaW5fVENvbW1lbnRfQXZhdGFyPUZhbHNlDQoJCUZvciBFYWNoIHNBY3Rpb25fUGx1Z2luX1RDb21tZW50X0F2YXRhciBpbiBBY3Rpb25fUGx1Z2luX1RDb21tZW50X0F2YXRhcg0KCQkJSWYgTm90IElzRW1wdHkoc0FjdGlvbl9QbHVnaW5fVENvbW1lbnRfQXZhdGFyKSBUaGVuIENhbGwgRXhlY3V0ZShzQWN0aW9uX1BsdWdpbl9UQ29tbWVudF9BdmF0YXIpDQoJCQlJZiBiQWN0aW9uX1BsdWdpbl9UQ29tbWVudF9BdmF0YXI9VHJ1ZSBUaGVuIEV4aXQgUHJvcGVydHkNCgkJTmV4dA0KDQoJCUlmIEZBdmF0YXI9IiIgVGhlbiBGQXZhdGFyPVVzZXJzKEF1dGhvcklEKS5BdmF0YXINCg0KCQlBdmF0YXI9RkF2YXRhcg0KDQoJRW5kIFByb3BlcnR5DQoNCg0KCVB1YmxpYyBodG1sDQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IEhvbWVQYWdlRm9yQW50aVNwYW0NCgkJSG9tZVBhZ2VGb3JBbnRpU3BhbT1VUkxFbmNvZGVGb3JBbnRpU3BhbShIb21lUGFnZSkNCglFbmQgUHJvcGVydHkNCg0KDQoJUHVibGljIFByb3BlcnR5IEdldCBTYWZlRW1haWwNCgkJRGltIHMNCgkJSWYgRW1haWw9IiIgVGhlbiBzPSJudWxsQG51bGwuY29tIg0KCQlTYWZlRW1haWw9UmVwbGFjZShzLCJAIiwiW0FUXSIpDQoJRW5kIFByb3BlcnR5DQoNCg0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgRW1haWxNRDUNCgkJSWYgQXV0aG9ySUQ+MCBUaGVuDQoJCQlFbWFpbE1ENT1Vc2VycyhBdXRob3JJRCkuRW1haWxNRDUNCgkJRWxzZQ0KCQkJSWYgRW1haWw9IiIgT3IgSXNOdWxsKEVtYWlsKT1UcnVlIFRoZW4NCgkJCQlFbWFpbE1ENT0iIg0KCQkJRWxzZQ0KCQkJCUVtYWlsTUQ1PU1ENShFbWFpbCkNCgkJCUVuZCBJZg0KCQlFbmQgSWYNCglFbmQgUHJvcGVydHkNCg0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgRmlyc3RDb250YWN0DQoJCUlmIExlbihIb21lUGFnZSk+MCBUaGVuDQoJCQlGaXJzdENvbnRhY3Q9SG9tZVBhZ2VGb3JBbnRpU3BhbQ0KCQlFbHNlDQoJCQlGaXJzdENvbnRhY3Q9Im1haWx0bzoiICYgU2FmZUVtYWlsDQoJCUVuZCBJZg0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBIdG1sQ29udGVudA0KCQknSHRtbENvbnRlbnQ9VHJhbnNmZXJIVE1MKFVCQkNvZGUoQ29udGVudCwiW2ZvbnRdW2ZhY2VdIiksIltlbnRlcl1bbm9mb2xsb3ddIikNCgkJSHRtbENvbnRlbnQ9VHJhbnNmZXJIVE1MKFVCQkNvZGUoQ29udGVudCAmIFJlcGx5LCJbbGlua11bbGluay1hbnRpc3BhbV1bZm9udF1bZmFjZV1bdHlwZXNldF0iKSwiW2VudGVyXVtub2ZvbGxvd10iKQ0KCUVuZCBQcm9wZXJ0eQ0KDQoNCglQdWJsaWMgRnVuY3Rpb24gUG9zdCgpDQoNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RDb21tZW50X1Bvc3QoSUQsbG9nX0lELEF1dGhvcklELEF1dGhvcixDb250ZW50LEVtYWlsLEhvbWVQYWdlLFBvc3RUaW1lLElQLEFnZW50LFJlcGx5LExhc3RSZXBseUlQLExhc3RSZXBseVRpbWUsUGFyZW50SUQsSXNDaGVjayxNZXRhU3RyaW5nKQ0KDQoJCUlmIElzVGhyb3c9VHJ1ZSBUaGVuIFBvc3Q9VHJ1ZTpFeGl0IEZ1bmN0aW9uDQoNCgkJSWYgSVA9IiIgVGhlbg0KCQkJSVA9R2V0UmVhbGx5SVAoKQ0KCQkJQWdlbnQ9UmVxdWVzdC5TZXJ2ZXJWYXJpYWJsZXMoIkhUVFBfVVNFUl9BR0VOVCIpDQoJCUVuZCBJZg0KCQkNCgkJSWYgTGVuKEhvbWVQYWdlKT4wIFRoZW4NCgkJCUlmIEluU3RyKEhvbWVQYWdlLCJodHRwOi8vIik9MCBUaGVuIEhvbWVQYWdlPSJodHRwOi8vIiAmIEhvbWVQYWdlDQoJCUVuZCBJZg0KDQoJCSfmo4Dmn6Xlj4LmlbANCgkJQ2FsbCBDaGVja1BhcmFtZXRlcihsb2dfSUQsImludCIsMCkNCgkJQ2FsbCBDaGVja1BhcmFtZXRlcihBdXRob3JJRCwiaW50IiwwKQ0KCQlDYWxsIENoZWNrUGFyYW1ldGVyKFBvc3RUaW1lLCJkdG0iLEdldFRpbWUoTm93KCkpKQ0KCQlDYWxsIENoZWNrUGFyYW1ldGVyKFBhcmVudElELCJpbnQiLDApDQoJCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoSXNDaGVjaywiYm9vbCIsRmFsc2UpDQoNCgkJSWYgUGFyZW50SUQ9IiIgVGhlbiBQYXJlbnRJRD0wDQoJCUF1dGhvcj1GaWx0ZXJTUUwoQXV0aG9yKQ0KCQlDb250ZW50PUZpbHRlclNRTChDb250ZW50KQ0KCQlFbWFpbD1GaWx0ZXJTUUwoRW1haWwpDQoJCUhvbWVQYWdlPUZpbHRlclNRTChIb21lUGFnZSkNCg0KCQlQb3N0VGltZT1GaWx0ZXJTUUwoUG9zdFRpbWUpDQoJCUlQPUZpbHRlclNRTChJUCkNCgkJQWdlbnQ9RmlsdGVyU1FMKEFnZW50KQ0KDQoJCVJlcGx5PUZpbHRlclNRTChSZXBseSkNCgkJTGFzdFJlcGx5SVA9RmlsdGVyU1FMKExhc3RSZXBseUlQKQ0KDQoJCSfkvZzogIXkuI3og73kuLrnqboNCgkJSWYgTGVuKEF1dGhvcik9MCBUaGVuIENhbGwgIFNob3dFcnJvcigxNSkNCgkJJ0lmIExlbihDb250ZW50KT0wIFRoZW4gQ2FsbCAgU2hvd0Vycm9yKDQ2KQ0KCQknSWYgTGVuKENvbnRlbnQpPlpDX0NPTlRFTlRfTUFYIFRoZW4gQ2FsbCAgU2hvd0Vycm9yKDQ2KQ0KDQoJCUF1dGhvcj1UcmFuc2ZlckhUTUwoQXV0aG9yLCJbaHRtbC1mb3JtYXRdIikNCgkJRW1haWw9VHJhbnNmZXJIVE1MKEVtYWlsLCJbaHRtbC1mb3JtYXRdIikNCgkJSG9tZVBhZ2U9VHJhbnNmZXJIVE1MKEhvbWVQYWdlLCJbaHRtbC1mb3JtYXRdIikNCgkJQ29udGVudD1UcmFuc2ZlckhUTUwoQ29udGVudCwiW2h0bWwtZm9ybWF0XSIpDQoNCgkJSWYgTGVuKEF1dGhvcik+WkNfVVNFUk5BTUVfTUFYIFRoZW4gQ2FsbCAgU2hvd0Vycm9yKDE1KQ0KCQlJZiBMZW4oRW1haWwpPlpDX0VNQUlMX01BWCBUaGVuIENhbGwgIFNob3dFcnJvcigyOSkNCgkJSWYgTGVuKEhvbWVQYWdlKT5aQ19IT01FUEFHRV9NQVggVGhlbiBDYWxsICBTaG93RXJyb3IoMzApDQoNCgkJSWYgTm90IENoZWNrUmVnRXhwKEF1dGhvciwiW3VzZXJuYW1lXSIpIFRoZW4gQ2FsbCAgU2hvd0Vycm9yKDE1KQ0KDQoJCUlGIExlbihFbWFpbCk+MCBUaGVuDQoJCQlJZiBOb3QgQ2hlY2tSZWdFeHAoRW1haWwsIltlbWFpbF0iKSBUaGVuIENhbGwgIFNob3dFcnJvcigyOSkNCgkJRW5kIElmDQoNCgkJSUYgTGVuKEhvbWVQYWdlKT4wIFRoZW4NCgkJCUlmIE5vdCBDaGVja1JlZ0V4cChIb21lUGFnZSwiW2hvbWVwYWdlXSIpIFRoZW4gQ2FsbCAgU2hvd0Vycm9yKDMwKQ0KCQlFbmQgSWYNCg0KCQlEaW0gb2JqUlMNCgkJRGltIHN0clNwYW1JUA0KCQlEaW0gc3RyU3BhbUNvbnRlbnQNCg0KCQlTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgW2NvbW1fSVBdLFtjb21tX0NvbnRlbnRdIEZST00gW2Jsb2dfQ29tbWVudF0gV0hFUkUgW2NvbW1fSURdPSAoIFNFTEVDVCBNQVgoY29tbV9JRCkgRlJPTSBbYmxvZ19Db21tZW50XSApIikNCg0KCQlJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoJCQlzdHJTcGFtSVA9b2JqUlMoImNvbW1fSVAiKQ0KCQkJc3RyU3BhbUNvbnRlbnQ9b2JqUlMoImNvbW1fQ29udGVudCIpDQoJCUVuZCBJZg0KDQoJCUlmIElzRGF0ZShMYXN0UmVwbHlUaW1lKT1GYWxzZSBUaGVuIExhc3RSZXBseVRpbWU9R2V0VGltZShOb3coKSkNCg0KCQlvYmpSUy5DbG9zZQ0KCQlTZXQgb2JqUlM9Tm90aGluZw0KDQoJCUlmIChJRD0wKSBBbmQgKHN0clNwYW1JUD1JUCkgQW5kIChzdHJTcGFtQ29udGVudD1Db250ZW50KSBUaGVuDQoJCQlDYWxsIFNob3dFcnJvcigzOSkNCgkJRW5kIElmDQoNCgkJSWYgSUQ9MCBUaGVuDQoJCQlvYmpDb25uLkV4ZWN1dGUoIklOU0VSVCBJTlRPIFtibG9nX0NvbW1lbnRdKFtsb2dfSURdLFtjb21tX0F1dGhvcklEXSxbY29tbV9BdXRob3JdLFtjb21tX0NvbnRlbnRdLFtjb21tX0VtYWlsXSxbY29tbV9Ib21lUGFnZV0sW2NvbW1fSVBdLFtjb21tX1Bvc3RUaW1lXSxbY29tbV9BZ2VudF0sW2NvbW1fUmVwbHldLFtjb21tX0xhc3RSZXBseUlQXSxbY29tbV9MYXN0UmVwbHlUaW1lXSxbY29tbV9QYXJlbnRJRF0sW2NvbW1fSXNDaGVja10sW2NvbW1fTWV0YV0pIFZBTFVFUyAoIiZsb2dfSUQmIiwiJkF1dGhvcklEJiIsJyImQXV0aG9yJiInLCciJkNvbnRlbnQmIicsJyImRW1haWwmIicsJyImSG9tZVBhZ2UmIicsJyImSVAmIicsJyImUG9zdFRpbWUmIicsJyImQWdlbnQmIicsJyImUmVwbHkmIicsJyImTGFzdFJlcGx5SVAmIicsJyImTGFzdFJlcGx5VGltZSYiJywnIiZQYXJlbnRJRCYiJywiJkNMbmcoSXNDaGVjaykmIiwnIiZNZXRhU3RyaW5nJiInKSIpDQoJCQlTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgTUFYKFtjb21tX0lEXSkgRlJPTSBbYmxvZ19Db21tZW50XSIpDQoJCQlJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoJCQkJSUQ9b2JqUlMoMCkNCgkJCUVuZCBJZg0KCQkJU2V0IG9ialJTPU5vdGhpbmcNCgkJRWxzZQ0KCQkJb2JqQ29ubi5FeGVjdXRlKCJVUERBVEUgW2Jsb2dfQ29tbWVudF0gU0VUIFtsb2dfSURdPSImbG9nX0lEJiIsIFtjb21tX0F1dGhvcklEXT0iJkF1dGhvcklEJiIsW2NvbW1fQXV0aG9yXT0nIiZBdXRob3ImIicsW2NvbW1fQ29udGVudF09JyImQ29udGVudCYiJyxbY29tbV9FbWFpbF09JyImRW1haWwmIicsW2NvbW1fSG9tZVBhZ2VdPSciJkhvbWVQYWdlJiInLFtjb21tX0lQXT0nIiZJUCYiJyxbY29tbV9Qb3N0VGltZV09JyImUG9zdFRpbWUmIicsW2NvbW1fQWdlbnRdPSciJkFnZW50JiInLFtjb21tX1JlcGx5XT0nIiZSZXBseSYiJyxbY29tbV9MYXN0UmVwbHlJUF09JyImTGFzdFJlcGx5SVAmIicsW2NvbW1fTGFzdFJlcGx5VGltZV09JyImTGFzdFJlcGx5VGltZSYiJyxbY29tbV9QYXJlbnRJRF09JyImUGFyZW50SUQmIicsW2NvbW1fSXNDaGVja109IiZDTG5nKElzQ2hlY2spJiIsW2NvbW1fTWV0YV09JyImTWV0YVN0cmluZyYiJyBXSEVSRSBbY29tbV9JRF0gPSIgJiBJRCkNCgkJRW5kIElmDQoNCgkJUG9zdD1UcnVlDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJUHVibGljIEZ1bmN0aW9uIERlbCgpDQoNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RDb21tZW50X0RlbChJRCxsb2dfSUQsQXV0aG9ySUQsQXV0aG9yLENvbnRlbnQsRW1haWwsSG9tZVBhZ2UsUG9zdFRpbWUsSVAsQWdlbnQsUmVwbHksTGFzdFJlcGx5SVAsTGFzdFJlcGx5VGltZSxQYXJlbnRJRCxJc0NoZWNrLE1ldGFTdHJpbmcpDQoNCgkJQ2FsbCBDaGVja1BhcmFtZXRlcihJRCwiaW50IiwwKQ0KCQlJZiAoSUQ9MCkgVGhlbiBEZWw9RmFsc2U6RXhpdCBGdW5jdGlvbg0KCQlvYmpDb25uLkV4ZWN1dGUoIkRFTEVURSBGUk9NIFtibG9nX0NvbW1lbnRdIFdIRVJFIFtjb21tX0lEXSA9IiAmIElEKQ0KCQlEZWw9VHJ1ZQ0KCUVuZCBGdW5jdGlvbg0KDQoNCglQdWJsaWMgRnVuY3Rpb24gTG9hZEluZm9CeUlEKGNvbW1fSUQpDQoNCgkJQ2FsbCBDaGVja1BhcmFtZXRlcihjb21tX0lELCJpbnQiLDApDQoNCgkJRGltIG9ialJTDQoJCVNldCBvYmpSUz1vYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBbY29tbV9JRF0sW2xvZ19JRF0sW2NvbW1fQXV0aG9ySURdLFtjb21tX0F1dGhvcl0sW2NvbW1fQ29udGVudF0sW2NvbW1fRW1haWxdLFtjb21tX0hvbWVQYWdlXSxbY29tbV9Qb3N0VGltZV0sW2NvbW1fSVBdLFtjb21tX0FnZW50XSxbY29tbV9SZXBseV0sW2NvbW1fTGFzdFJlcGx5SVBdLFtjb21tX0xhc3RSZXBseVRpbWVdLFtjb21tX1BhcmVudElEXSxbY29tbV9Jc0NoZWNrXSxbY29tbV9NZXRhXSBGUk9NIFtibG9nX0NvbW1lbnRdIFdIRVJFIFtjb21tX0lEXT0iICYgY29tbV9JRCkNCg0KCQlJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoNCgkJCUlEPW9ialJTKCJjb21tX0lEIikNCgkJCWxvZ19JRD1vYmpSUygibG9nX0lEIikNCgkJCUF1dGhvcklEPW9ialJTKCJjb21tX0F1dGhvcklEIikNCgkJCUF1dGhvcj1vYmpSUygiY29tbV9BdXRob3IiKQ0KCQkJQ29udGVudD1vYmpSUygiY29tbV9Db250ZW50IikNCgkJCUVtYWlsPW9ialJTKCJjb21tX0VtYWlsIikNCgkJCUhvbWVQYWdlPW9ialJTKCJjb21tX0hvbWVQYWdlIikNCgkJCVBvc3RUaW1lPW9ialJTKCJjb21tX1Bvc3RUaW1lIikNCgkJCUlQPW9ialJTKCJjb21tX0lQIikNCgkJCUFnZW50PW9ialJTKCJjb21tX0FnZW50IikNCgkJCVJlcGx5PW9ialJTKCJjb21tX1JlcGx5IikNCgkJCUxhc3RSZXBseUlQPW9ialJTKCJjb21tX0xhc3RSZXBseUlQIikNCgkJCUxhc3RSZXBseVRpbWU9b2JqUlMoImNvbW1fTGFzdFJlcGx5VGltZSIpDQoJCQlQYXJlbnRJRD1vYmpSUygiY29tbV9QYXJlbnRJRCIpDQoJCQlJc0NoZWNrPW9ialJTKCJjb21tX0lzQ2hlY2siKQ0KCQkJTWV0YVN0cmluZz1vYmpSUygiY29tbV9NZXRhIikNCg0KCQkJTG9hZEluZm9CeUlEPVRydWUNCg0KCQlFbmQgSWYNCg0KCQlvYmpSUy5DbG9zZQ0KCQlTZXQgb2JqUlM9Tm90aGluZw0KDQoJCUlmIElzTnVsbChIb21lUGFnZSkgVGhlbiBIb21lUGFnZT0iIg0KDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UQ29tbWVudF9Mb2FkSW5mb0J5SUQoSUQsbG9nX0lELEF1dGhvcklELEF1dGhvcixDb250ZW50LEVtYWlsLEhvbWVQYWdlLFBvc3RUaW1lLElQLEFnZW50LFJlcGx5LExhc3RSZXBseUlQLExhc3RSZXBseVRpbWUsUGFyZW50SUQsSXNDaGVjayxNZXRhU3RyaW5nKQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCVB1YmxpYyBGdW5jdGlvbiBMb2FkSW5mb0J5QXJyYXkoYXJ5Q29tbUluZm8pDQoNCgkJSWYgSXNBcnJheShhcnlDb21tSW5mbyk9VHJ1ZSBUaGVuDQoJCQlJRD1hcnlDb21tSW5mbygwKQ0KCQkJbG9nX0lEPWFyeUNvbW1JbmZvKDEpDQoJCQlBdXRob3JJRD1hcnlDb21tSW5mbygyKQ0KCQkJQXV0aG9yPWFyeUNvbW1JbmZvKDMpDQoJCQlDb250ZW50PWFyeUNvbW1JbmZvKDQpDQoJCQlFbWFpbD1hcnlDb21tSW5mbyg1KQ0KCQkJSG9tZVBhZ2U9YXJ5Q29tbUluZm8oNikNCgkJCVBvc3RUaW1lPWFyeUNvbW1JbmZvKDcpDQoJCQlJUD1hcnlDb21tSW5mbyg4KQ0KCQkJQWdlbnQ9YXJ5Q29tbUluZm8oOSkNCgkJCVJlcGx5PWFyeUNvbW1JbmZvKDEwKQ0KCQkJTGFzdFJlcGx5SVA9YXJ5Q29tbUluZm8oMTEpDQoJCQlMYXN0UmVwbHlUaW1lPWFyeUNvbW1JbmZvKDEyKQ0KCQkJUGFyZW50SUQ9YXJ5Q29tbUluZm8oMTMpDQoJCQlJc0NoZWNrPWFyeUNvbW1JbmZvKDE0KQ0KCQkJTWV0YVN0cmluZz1hcnlDb21tSW5mbygxNSkNCg0KCQlFbmQgSWYNCg0KCQlJZiBJc051bGwoSG9tZVBhZ2UpIFRoZW4gSG9tZVBhZ2U9IiINCg0KCQlMb2FkSW5mb0J5QXJyYXk9VHJ1ZQ0KDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UQ29tbWVudF9Mb2FkSW5mb0J5QXJyYXkoSUQsbG9nX0lELEF1dGhvcklELEF1dGhvcixDb250ZW50LEVtYWlsLEhvbWVQYWdlLFBvc3RUaW1lLElQLEFnZW50LFJlcGx5LExhc3RSZXBseUlQLExhc3RSZXBseVRpbWUsUGFyZW50SUQsSXNDaGVjayxNZXRhU3RyaW5nKQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCVB1YmxpYyBGdW5jdGlvbiBNYWtlVGVtcGxhdGUoc3RyQykNCg0KCQlEaW0gaHRtbCxpLGoNCgkJaHRtbD1zdHJDDQoNCgkJJ3BsdWdpbiBub2RlDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UQ29tbWVudF9NYWtlVGVtcGxhdGVfVGVtcGxhdGUoaHRtbCkNCg0KCQlEaW0gYXJ5VGVtcGxhdGVUYWdzTmFtZSgpDQoJCURpbSBhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSgpDQoNCgkJUmVEaW0gYXJ5VGVtcGxhdGVUYWdzTmFtZSgyNykNCgkJUmVEaW0gYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMjcpDQoNCgkJSWYgUGFyZW50SUQ9IiIgVGhlbiBQYXJlbnRJRD0wDQoNCgkJRGltIHMNCgkJSWYgQXV0aG9ySUQ+MCBUaGVuIA0KCQkJQ2FsbCBHZXRVc2Vyc2J5VXNlcklETGlzdChBdXRob3JJRCkNCgkJCUlmIFVzZXJzKEF1dGhvcklEKS5BbGlhcz0iIiBUaGVuDQoJCQkJcz1Vc2VycyhBdXRob3JJRCkuTmFtZQ0KCQkJRWxzZQ0KCQkJCXM9VXNlcnMoQXV0aG9ySUQpLkFsaWFzDQoJCQlFbmQgSWYNCgkJRWxzZQ0KCQkJcz1BdXRob3INCgkJRW5kIElmDQoNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSggIDEpPSJhcnRpY2xlL2NvbW1lbnQvaWQiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKCAxKT1JRA0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKCAgMik9ImFydGljbGUvY29tbWVudC9uYW1lIg0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSggMik9cw0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKCAgMyk9ImFydGljbGUvY29tbWVudC91cmwiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKCAzKT1Ib21lUGFnZQ0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKCAgNCk9ImFydGljbGUvY29tbWVudC91cmxlbmNvZGVyIg0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSggNCk9VHJhbnNmZXJIVE1MKEhvbWVQYWdlRm9yQW50aVNwYW0sIlthbnRpLXpjX2Jsb2dfaG9zdF0iKQ0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKCAgNSk9ImFydGljbGUvY29tbWVudC9lbWFpbCINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoIDUpPVNhZmVFbWFpbA0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKCAgNik9ImFydGljbGUvY29tbWVudC9wb3N0dGltZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoIDYpPVBvc3RUaW1lDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoICA3KT0iYXJ0aWNsZS9jb21tZW50L2NvbnRlbnQiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKCA3KT1IdG1sQ29udGVudCAmICI8IS0tcmV2IiZpZCYiLS0+IiAmICI8YSBzdHlsZT0iImRpc3BsYXk6bm9uZTsiIiBpZD0iIkFqYXhDb21tZW50RW5kIiZpZCYiIiI+PC9hPiINCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSggIDgpPSJhcnRpY2xlL2NvbW1lbnQvY291bnQiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKCA4KT0iPCEtLShjb3VudC0tPiImIENvdW50ICYiPCEtLWNvdW50KS0tPiINCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSggIDkpPSJhcnRpY2xlL2NvbW1lbnQvYXV0aG9yaWQiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKCA5KT1BdXRob3JJRA0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKCAxMCk9ImFydGljbGUvY29tbWVudC9maXJzdGNvbnRhY3QiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDEwKT1UcmFuc2ZlckhUTUwoRmlyc3RDb250YWN0LCJbYW50aS16Y19ibG9nX2hvc3RdIikNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSggMTEpPSJhcnRpY2xlL2NvbW1lbnQvZW1haWxtZDUiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDExKT1FbWFpbE1ENQ0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKCAxMik9ImFydGljbGUvY29tbWVudC9wYXJlbnRpZCINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMTIpPVBhcmVudElEDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoIDEzKT0iYXJ0aWNsZS9jb21tZW50L2F2YXRhciINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMTMpPUF2YXRhcg0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKCAxNCk9ImFydGljbGUvY29tbWVudC9wb3N0dGltZS9sb25nZGF0ZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMTQpPUZvcm1hdERhdGVUaW1lKFBvc3RUaW1lLHZiTG9uZ0RhdGUpDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoIDE1KT0iYXJ0aWNsZS9jb21tZW50L3Bvc3R0aW1lL3Nob3J0ZGF0ZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMTUpPUZvcm1hdERhdGVUaW1lKFBvc3RUaW1lLHZiU2hvcnREYXRlKQ0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKCAxNik9ImFydGljbGUvY29tbWVudC9wb3N0dGltZS9sb25ndGltZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMTYpPUZvcm1hdERhdGVUaW1lKFBvc3RUaW1lLHZiTG9uZ1RpbWUpDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoIDE3KT0iYXJ0aWNsZS9jb21tZW50L3Bvc3R0aW1lL3Nob3J0dGltZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMTcpPUZvcm1hdERhdGVUaW1lKFBvc3RUaW1lLHZiU2hvcnRUaW1lKQ0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKCAxOCk9ImFydGljbGUvY29tbWVudC9wb3N0dGltZS95ZWFyIg0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSgxOCk9WWVhcihQb3N0VGltZSkNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSggMTkpPSJhcnRpY2xlL2NvbW1lbnQvcG9zdHRpbWUvbW9udGgiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDE5KT1SaWdodCgiMCImTW9udGgoUG9zdFRpbWUpLDIpDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoIDIwKT0iYXJ0aWNsZS9jb21tZW50L3Bvc3R0aW1lL21vbnRobmFtZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMjApPVpWQV9Nb250aChNb250aChQb3N0VGltZSkpDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoIDIxKT0iYXJ0aWNsZS9jb21tZW50L3Bvc3R0aW1lL2RheSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMjEpPVJpZ2h0KCIwIiZEYXkoUG9zdFRpbWUpLDIpDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoIDIyKT0iYXJ0aWNsZS9jb21tZW50L3Bvc3R0aW1lL3dlZWtkYXkiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKDIyKT1XZWVrZGF5KFBvc3RUaW1lKQ0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKCAyMyk9ImFydGljbGUvY29tbWVudC9wb3N0dGltZS93ZWVrZGF5bmFtZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMjMpPVpWQV9XZWVrKFdlZWtkYXkoUG9zdFRpbWUpKQ0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKCAyNCk9ImFydGljbGUvY29tbWVudC9wb3N0dGltZS9ob3VyIg0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSgyNCk9UmlnaHQoIjAiJkhvdXIoUG9zdFRpbWUpLDIpDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoIDI1KT0iYXJ0aWNsZS9jb21tZW50L3Bvc3R0aW1lL21pbnV0ZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMjUpPVJpZ2h0KCIwIiZNaW51dGUoUG9zdFRpbWUpLDIpDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoIDI2KT0iYXJ0aWNsZS9jb21tZW50L3Bvc3R0aW1lL3NlY29uZCINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoMjYpPVJpZ2h0KCIwIiZTZWNvbmQoUG9zdFRpbWUpLDIpDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoIDI3KT0iYXJ0aWNsZS9jb21tZW50L2FnZW50Ig0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSgyNyk9QWdlbnQNCg0KCQkncGx1Z2luIG5vZGUNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RDb21tZW50X01ha2VUZW1wbGF0ZV9UZW1wbGF0ZVRhZ3MoYXJ5VGVtcGxhdGVUYWdzTmFtZSxhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSkNCg0KCQlqPVVCb3VuZChhcnlUZW1wbGF0ZVRhZ3NOYW1lKQ0KCQlGb3IgaT0xIHRvIGoNCgkJCWh0bWw9UmVwbGFjZShodG1sLCI8IyIgJiBhcnlUZW1wbGF0ZVRhZ3NOYW1lKGkpICYgIiM+IixhcnlUZW1wbGF0ZVRhZ3NWYWx1ZShpKSkNCgkJTmV4dA0KDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UQ29tbWVudF9NYWtlVGVtcGxhdGVfVGVtcGxhdGVfU3VjY2VlZChodG1sKQ0KDQoJCU1ha2VUZW1wbGF0ZT1odG1sDQoNCglFbmQgRnVuY3Rpb24NCg0KCVByaXZhdGUgU3ViIENsYXNzX0luaXRpYWxpemUoKQ0KDQoJCUlEPTANCgkJbG9nX0lEPTANCgkJQXV0aG9ySUQ9MA0KCQlTZXQgTWV0YT1OZXcgVE1ldGENCg0KCUVuZCBTdWINCg0KRW5kIENsYXNzDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIOWumuS5iVRUcmFja0JhY2vnsbsNCicg6L6T5YWl77yaICAgIOaXoA0KJyDov5Tlm57vvJogICAg5pegDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpDbGFzcyBUVHJhY2tCYWNrDQoNCglQdWJsaWMgSUQNCglQdWJsaWMgbG9nX0lEDQoNCglQdWJsaWMgVVJMDQoJUHVibGljIFRpdGxlDQoJUHVibGljIEJsb2cNCglQdWJsaWMgRXhjZXJwdA0KDQoJUHVibGljIFBvc3RUaW1lDQoJUHVibGljIElQDQoJUHVibGljIEFnZW50DQoNCglQdWJsaWMgQ291bnQNCglQdWJsaWMgTWV0YQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBNZXRhU3RyaW5nDQoJCU1ldGFTdHJpbmc9TWV0YS5TYXZlU3RyaW5nDQoJRW5kIFByb3BlcnR5DQoJUHVibGljIFByb3BlcnR5IExldCBNZXRhU3RyaW5nKHMpDQoJCU1ldGEuTG9hZFN0cmluZz1zDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgaHRtbA0KDQoJUHVibGljIFByb3BlcnR5IEdldCBVcmxGb3JBbnRpU3BhbQ0KCQlVcmxGb3JBbnRpU3BhbT1VUkxFbmNvZGVGb3JBbnRpU3BhbShVcmwpDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IEh0bWxFeGNlcnB0DQoJCUh0bWxFeGNlcnB0PVRyYW5zZmVySFRNTChFeGNlcnB0LCJbZW50ZXJdIikNCglFbmQgUHJvcGVydHkNCg0KCVB1YmxpYyBUYlhNTA0KDQoJUHJpdmF0ZSBGdW5jdGlvbiBSZXR1cm5UYlhNTChzdHJNc2cpDQoNCgkJRGltIHN0clhNTA0KDQoJCXN0clhNTD0iPD94bWwgdmVyc2lvbj0iIjEuMCIiIGVuY29kaW5nPSIiVVRGLTgiIiBzdGFuZGFsb25lPSIieWVzIiI/PjxyZXNwb25zZT48ZXJyb3I+JWU8L2Vycm9yPjxtZXNzYWdlPiVtPC9tZXNzYWdlPjwvcmVzcG9uc2U+Ig0KDQoJCUlmIHN0ck1zZz0idW5kaXNjb3ZlcmVkIiBUaGVuJ+acquWPkeeOsOebuOW6lElEDQoJCQlzdHJYTUw9UmVwbGFjZShzdHJYTUwsIiVlIiwiMSIpDQoJCQlzdHJYTUw9UmVwbGFjZShzdHJYTUwsIiVtIixzdHJNc2cpDQoJCUVsc2VJZiBzdHJNc2c9InJlcGV0aXRpb24iIFRoZW4n6YeN5aSNUElORw0KCQkJc3RyWE1MPVJlcGxhY2Uoc3RyWE1MLCIlZSIsIjEiKQ0KCQkJc3RyWE1MPVJlcGxhY2Uoc3RyWE1MLCIlbSIsc3RyTXNnKQ0KCQlFbHNlaWYgc3RyTXNnPSJpbnZhbGlkIHBhcmFtZXRlciIgVGhlbifpnZ7ms5Xlj4LmlbANCgkJCXN0clhNTD1SZXBsYWNlKHN0clhNTCwiJWUiLCIxIikNCgkJCXN0clhNTD1SZXBsYWNlKHN0clhNTCwiJW0iLHN0ck1zZykNCgkJRWxzZWlmIHN0ck1zZz0ibm9uZSBkYXRhIiBUaGVuJ+aXoOaVsOaNrg0KCQkJc3RyWE1MPVJlcGxhY2Uoc3RyWE1MLCIlZSIsIjEiKQ0KCQkJc3RyWE1MPVJlcGxhY2Uoc3RyWE1MLCIlbSIsc3RyTXNnKQ0KCQlFbHNlJ1BJTkcg5oiQ5YqfDQoJCQlzdHJYTUw9UmVwbGFjZShzdHJYTUwsIiVlIiwiMCIpDQoJCQlzdHJYTUw9UmVwbGFjZShzdHJYTUwsIiVtIixzdHJNc2cpDQoJCUVuZCBJZg0KDQoJCVRiWE1MPXN0clhNTA0KDQoJCSdSZXNwb25zZS5Db250ZW50VHlwZSA9ICJ0ZXh0L2h0bWwiDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJUHVibGljIEZ1bmN0aW9uIFBvc3QoKQ0KDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UVHJhY2tCYWNrX1Bvc3QoSUQsbG9nX0lELFVSTCxUaXRsZSxCbG9nLEV4Y2VycHQsUG9zdFRpbWUsSVAsQWdlbnQsTWV0YVN0cmluZykNCg0KCQlEaW0gb2JqUlMNCg0KCQknQ2FsbCBSZXR1cm5UYlhNTCgidW5kaXNjb3ZlcmVkIik6RXhpdCBGdW5jdGlvbg0KCQlDYWxsIENoZWNrUGFyYW1ldGVyKGxvZ19JRCwiaW50IiwwKQ0KDQoJCUlmIElzRGF0ZShQb3N0VGltZSk9RmFsc2UgVGhlbiBQb3N0VGltZT1HZXRUaW1lKE5vdygpKQ0KCQlJUD1HZXRSZWFsbHlJUCgpDQoJCUFnZW50PVJlcXVlc3QuU2VydmVyVmFyaWFibGVzKCJIVFRQX1VTRVJfQUdFTlQiKQ0KDQoJCUlQPUZpbHRlclNRTChJUCkNCgkJQWdlbnQ9RmlsdGVyU1FMKEFnZW50KQ0KDQoJCVVSTD1GaWx0ZXJTUUwoVVJMKQ0KCQlUaXRsZT1GaWx0ZXJTUUwoVGl0bGUpDQoJCUJsb2c9RmlsdGVyU1FMKEJsb2cpDQoJCUV4Y2VycHQ9RmlsdGVyU1FMKEV4Y2VycHQpDQoNCgkJQmxvZz1UcmFuc2ZlckhUTUwoQmxvZywiW2h0bWwtZm9ybWF0XSIpDQoJCVRpdGxlPVRyYW5zZmVySFRNTChUaXRsZSwiW2h0bWwtZm9ybWF0XSIpDQoJCUV4Y2VycHQ9VHJhbnNmZXJIVE1MKEV4Y2VycHQsIltodG1sLWZvcm1hdF1bbm9odG1sXSIpDQoJCVVSTD1UcmFuc2ZlckhUTUwoVVJMLCJbaHRtbC1mb3JtYXRdIikNCg0KCQknbG9nX0lE5LiN6IO95Li6MA0KCQlJZiAobG9nX0lEPTApIFRoZW4gQ2FsbCBSZXR1cm5UYlhNTCgiaW52YWxpZCBwYXJhbWV0ZXIiKTpQb3N0PUZhbHNlOkV4aXQgRnVuY3Rpb24NCgkJSWYgTGVuKFVSTCk9MCBUaGVuIENhbGwgUmV0dXJuVGJYTUwoIm5vbmUgZGF0YSIpOlBvc3Q9RmFsc2U6RXhpdCBGdW5jdGlvbg0KCQlJZiBMZW4oVVJMKT5aQ19IT01FUEFHRV9NQVggVGhlbiBDYWxsIFJldHVyblRiWE1MKCJ1cmwgaXMgbG9uZyIpOlBvc3Q9RmFsc2U6RXhpdCBGdW5jdGlvbg0KDQoJCUlmIExlbihCbG9nKT5aQ19FTUFJTF9NQVggVGhlbiBDYWxsIFJldHVyblRiWE1MKCJuYW1lIGlzIGxvbmciKTpQb3N0PUZhbHNlOkV4aXQgRnVuY3Rpb24NCgkJSWYgTGVuKEJsb2cpPTAgVGhlbiBCbG9nPSJVbmtub3ciDQoJCUlmIExlbihFeGNlcnB0KT0wIFRoZW4gRXhjZXJwdD0iIg0KCQlJZiBMZW4oRXhjZXJwdCk+WkNfQVJUSUNMRV9FWENFUlBUX01BWCBUaGVuIEV4Y2VycHQ9TGVmdChFeGNlcnB0LFpDX0FSVElDTEVfRVhDRVJQVF9NQVgpJiIuLi4iDQoJCUlmIExlbihUaXRsZSk+WkNfSE9NRVBBR0VfTUFYIFRoZW4gQ2FsbCBSZXR1cm5UYlhNTCgidGl0bGUgaXMgbG9uZyIpOlBvc3Q9RmFsc2U6RXhpdCBGdW5jdGlvbg0KCQlJZiBMZW4oVGl0bGUpPTAgVGhlbiBUaXRsZT1VUkwNCg0KDQoJJ+ajgOafpUlE5piv5ZCm5a2Y5ZyoDQoJCSdTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgKiBGUk9NIFtibG9nX0FydGljbGVdIFdIRVJFIFtsb2dfSURdPSIgJiBsb2dfSUQpDQoJCSdJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoJCSdFbHNlDQoJCScJb2JqUlMuY2xvc2UNCgkJJwlDYWxsIHJldHVyblRiWE1MKCJ1bmRpc2NvdmVyZWQiKQ0KCQknCUV4aXQgRnVuY3Rpb24NCgkJJ0VuZCBJZg0KCQknb2JqUlMuQ2xvc2UNCgkJJ1NldCBvYmpSUz1Ob3RoaW5nDQoNCgkn5qOA5p+l5piv5ZCm5beyVELov4cNCgkJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUICogRlJPTSBbYmxvZ19UcmFja0JhY2tdIFdIRVJFIFtsb2dfSURdPSIgJiBsb2dfSUQgJiAiIGFuZCBbdGJfdXJsXT0nIiAmIFVSTCAmICInIikNCgkJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KCQkJb2JqUlMuY2xvc2UNCgkJCUNhbGwgcmV0dXJuVGJYTUwoInJlcGV0aXRpb24iKQ0KCQkJRXhpdCBGdW5jdGlvbg0KCQlFbmQgSWYNCgkJb2JqUlMuQ2xvc2UNCgkJU2V0IG9ialJTPU5vdGhpbmcNCg0KCSfmjqXmlLZUQg0KDQoJCUlmIElEPTAgVGhlbg0KCQkJb2JqQ29ubi5FeGVjdXRlKCJJTlNFUlQgSU5UTyBbYmxvZ19UcmFja0JhY2tdKFtsb2dfSURdLFt0Yl9VUkxdLFt0Yl9UaXRsZV0sW3RiX0Jsb2ddLFt0Yl9FeGNlcnB0XSxbdGJfUG9zdFRpbWVdLFt0Yl9JUF0sW3RiX0FnZW50XSxbdGJfTWV0YV0pIFZBTFVFUyAoIiZsb2dfSUQmIiwnIiZVUkwmIicsJyImVGl0bGUmIicsJyImQmxvZyYiJywnIiZFeGNlcnB0JiInLCciJlBvc3RUaW1lJiInLCciJklQJiInLCciJkFnZW50JiInLCciJk1ldGFTdHJpbmcmIicpIikNCgkJRWxzZQ0KCQkJb2JqQ29ubi5FeGVjdXRlKCJVUERBVEUgW2Jsb2dfVHJhY2tCYWNrXSBTRVQgW2xvZ19JRF09IiZsb2dfSUQmIiwgW3RiX1VSTF09JyImVVJMJiInLFt0Yl9FeGNlcnB0XT0nIiZFeGNlcnB0JiInLFt0Yl9UaXRsZV09JyImVGl0bGUmIicsW3RiX0Jsb2ddPSciJkJsb2cmIicsW3RiX0lQXT0nIiZJUCYiJyxbdGJfUG9zdFRpbWVdPSciJlBvc3RUaW1lJiInLFt0Yl9BZ2VudF09JyImQWdlbnQmIicsW3RiX01ldGFdPSciJk1ldGFTdHJpbmcmIicgV0hFUkUgW3RiX0lEXSA9IiAmIElEKQ0KCQlFbmQgSWYNCgkJQ2FsbCByZXR1cm5UYlhNTCgic3VjY2VlZCIpDQoNCgkJUG9zdD1UcnVlDQoNCglFbmQgRnVuY3Rpb24NCg0KCVB1YmxpYyBGdW5jdGlvbiBEZWwoKQ0KDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UVHJhY2tCYWNrX0RlbChJRCxsb2dfSUQsVVJMLFRpdGxlLEJsb2csRXhjZXJwdCxQb3N0VGltZSxJUCxBZ2VudCxNZXRhU3RyaW5nKQ0KDQoJCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoSUQsImludCIsMCkNCgkJSWYgKElEPTApIFRoZW4gRGVsPUZhbHNlOkV4aXQgRnVuY3Rpb24NCgkJb2JqQ29ubi5FeGVjdXRlKCJERUxFVEUgRlJPTSBbYmxvZ19UcmFja0JhY2tdIFdIRVJFIFt0Yl9JRF0gPSIgJiBJRCkNCgkJRGVsPVRydWUNCglFbmQgRnVuY3Rpb24NCg0KDQoJRnVuY3Rpb24gU2VuZChzdHJBZGRyZXNzKQ0KDQoJCURpbSBzdHJTZW5kVEINCgkJc3RyU2VuZFRCID0gInRpdGxlPSIgJiBTZXJ2ZXIuVVJMRW5jb2RlKFRpdGxlKSAmICImdXJsPSIgJiBTZXJ2ZXIuVVJMRW5jb2RlKFVSTCkgJiAiJmV4Y2VycHQ9IiAmIFNlcnZlci5VUkxFbmNvZGUoRXhjZXJwdCkgJiAiJmJsb2dfbmFtZT0iICYgU2VydmVyLlVSTEVuY29kZShCbG9nKQ0KDQoJCURpbSBvYmpQaW5nDQoJCVNldCBvYmpQaW5nID0gU2VydmVyLkNyZWF0ZU9iamVjdCgiTVNYTUwyLlNlcnZlclhNTEhUVFAiKQ0KCQlvYmpQaW5nLlNldFRpbWVPdXRzIDEwMDAwLCAxMDAwMCwgMTAwMDAsIDEwMDAwDQoNCgkJb2JqUGluZy5vcGVuICJQT1NUIixzdHJBZGRyZXNzLEZhbHNlDQoNCgkJb2JqUGluZy5zZXRSZXF1ZXN0SGVhZGVyICJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIg0KCQlvYmpQaW5nLnNlbmQgc3RyU2VuZFRCDQoJCSdSZXNwb25zZS5Db250ZW50VHlwZSA9ICJ0ZXh0L3htbCINCgkJJ1Jlc3BvbnNlLkNsZWFyDQoJCSdSZXNwb25zZS5Xcml0ZSBvYmpQaW5nLnJlc3BvbnNlWE1MLnhtbA0KCQlTZXQgb2JqUGluZyA9IE5vdGhpbmcNCgkJU2VuZD1UcnVlDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJUHVibGljIEZ1bmN0aW9uIExvYWRJbmZvQnlJRCh0Yl9JRCkNCg0KCQlDYWxsIENoZWNrUGFyYW1ldGVyKHRiX0lELCJpbnQiLDApDQoNCgkJRGltIG9ialJTDQoJCVNldCBvYmpSUz1vYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBbdGJfSURdLFtsb2dfSURdLFt0Yl9VUkxdLFt0Yl9UaXRsZV0sW3RiX0Jsb2ddLFt0Yl9FeGNlcnB0XSxbdGJfUG9zdFRpbWVdLFt0Yl9JUF0sW3RiX0FnZW50XSxbdGJfTWV0YV0gRlJPTSBbYmxvZ19UcmFja0JhY2tdIFdIRVJFIFt0Yl9JRF09IiAmIHRiX0lEKQ0KDQoJCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCg0KCQkJSUQ9b2JqUlMoInRiX0lEIikNCgkJCWxvZ19JRD1vYmpSUygibG9nX0lEIikNCgkJCVVSTD1vYmpSUygidGJfVVJMIikNCgkJCVRpdGxlPW9ialJTKCJ0Yl9UaXRsZSIpDQoJCQlCbG9nPW9ialJTKCJ0Yl9CbG9nIikNCgkJCUV4Y2VycHQ9b2JqUlMoInRiX0V4Y2VycHQiKQ0KCQkJUG9zdFRpbWU9b2JqUlMoInRiX1Bvc3RUaW1lIikNCgkJCUlQPW9ialJTKCJ0Yl9JUCIpDQoJCQlBZ2VudD1vYmpSUygidGJfQWdlbnQiKQ0KCQkJTWV0YVN0cmluZz1vYmpSUygidGJfTWV0YSIpDQoNCgkJCUxvYWRJbmZvQnlJRD1UcnVlDQoNCgkJRW5kIElmDQoNCgkJb2JqUlMuQ2xvc2UNCgkJU2V0IG9ialJTPU5vdGhpbmcNCg0KCQlJZiBJc051bGwoRXhjZXJwdCkgVGhlbiBFeGNlcnB0PSIiDQoNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RUcmFja0JhY2tfTG9hZEluZm9CeUlEKElELGxvZ19JRCxVUkwsVGl0bGUsQmxvZyxFeGNlcnB0LFBvc3RUaW1lLElQLEFnZW50LE1ldGFTdHJpbmcpDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJUHVibGljIEZ1bmN0aW9uIExvYWRJbmZvQnlBcnJheShhcnlUYkluZm8pDQoNCgkJSWYgSXNBcnJheShhcnlUYkluZm8pPVRydWUgVGhlbg0KDQoJCQlJRD1hcnlUYkluZm8oMCkNCgkJCWxvZ19JRD1hcnlUYkluZm8oMSkNCgkJCVVSTD1hcnlUYkluZm8oMikNCgkJCVRpdGxlPWFyeVRiSW5mbygzKQ0KCQkJQmxvZz1hcnlUYkluZm8oNCkNCgkJCUV4Y2VycHQ9YXJ5VGJJbmZvKDUpDQoJCQlQb3N0VGltZT1hcnlUYkluZm8oNikNCgkJCUlQPWFyeVRiSW5mbyg3KQ0KCQkJQWdlbnQ9YXJ5VGJJbmZvKDgpDQoJCQlNZXRhU3RyaW5nPWFyeVRiSW5mbyg5KQ0KDQoJCUVuZCBJZg0KDQoJCUlmIElzTnVsbChFeGNlcnB0KSBUaGVuIEV4Y2VycHQ9IiINCg0KCQlMb2FkSW5mb0J5QXJyYXk9VHJ1ZQ0KDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UVHJhY2tCYWNrX0xvYWRJbmZvQnlBcnJheShJRCxsb2dfSUQsVVJMLFRpdGxlLEJsb2csRXhjZXJwdCxQb3N0VGltZSxJUCxBZ2VudCxNZXRhU3RyaW5nKQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCVB1YmxpYyBGdW5jdGlvbiBNYWtlVGVtcGxhdGUoc3RyVCkNCg0KCQlEaW0gaHRtbCxpLGoNCgkJaHRtbD1zdHJUDQoNCgkJJ3BsdWdpbiBub2RlDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UVHJhY2tCYWNrX01ha2VUZW1wbGF0ZV9UZW1wbGF0ZShodG1sKQ0KDQoJCURpbSBhcnlUZW1wbGF0ZVRhZ3NOYW1lKCkNCgkJRGltIGFyeVRlbXBsYXRlVGFnc1ZhbHVlKCkNCg0KCQlSZURpbSBhcnlUZW1wbGF0ZVRhZ3NOYW1lKDcpDQoJCVJlRGltIGFyeVRlbXBsYXRlVGFnc1ZhbHVlKDcpDQoNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSggIDEpPSJhcnRpY2xlL3RyYWNrYmFjay9pZCINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoIDEpPUlEDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoICAyKT0iYXJ0aWNsZS90cmFja2JhY2svbmFtZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoIDIpPUJsb2cNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSggIDMpPSJhcnRpY2xlL3RyYWNrYmFjay91cmwiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKCAzKT1UcmFuc2ZlckhUTUwoVXJsRm9yQW50aVNwYW0sIlthbnRpLXpjX2Jsb2dfaG9zdF0iKQ0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKCAgNCk9ImFydGljbGUvdHJhY2tiYWNrL3RpdGxlIg0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSggNCk9VGl0bGUNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSggIDUpPSJhcnRpY2xlL3RyYWNrYmFjay9wb3N0dGltZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoIDUpPVBvc3RUaW1lDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoICA2KT0iYXJ0aWNsZS90cmFja2JhY2svY29udGVudCINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoIDYpPUh0bWxFeGNlcnB0DQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoICA3KT0iYXJ0aWNsZS90cmFja2JhY2svY291bnQiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKCA3KT1Db3VudA0KDQoJCSdwbHVnaW4gbm9kZQ0KCQlDYWxsIEZpbHRlcl9QbHVnaW5fVFRyYWNrQmFja19NYWtlVGVtcGxhdGVfVGVtcGxhdGVUYWdzKGFyeVRlbXBsYXRlVGFnc05hbWUsYXJ5VGVtcGxhdGVUYWdzVmFsdWUpDQoNCgkJaj1VQm91bmQoYXJ5VGVtcGxhdGVUYWdzTmFtZSkNCgkJRm9yIGk9MSB0byBqDQoJCQlodG1sPVJlcGxhY2UoaHRtbCwiPCMiICYgYXJ5VGVtcGxhdGVUYWdzTmFtZShpKSAmICIjPiIsYXJ5VGVtcGxhdGVUYWdzVmFsdWUoaSkpDQoJCU5leHQNCg0KCQlNYWtlVGVtcGxhdGU9aHRtbA0KDQoJRW5kIEZ1bmN0aW9uDQoNCglQcml2YXRlIFN1YiBDbGFzc19Jbml0aWFsaXplKCkNCg0KCQlTZXQgTWV0YT1OZXcgVE1ldGENCg0KCUVuZCBTdWINCg0KDQpFbmQgQ2xhc3MNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAg5a6a5LmJVFVwTG9hZEZpbGXnsbsNCicg6L6T5YWl77yaICAgIOaXoA0KJyDov5Tlm57vvJogICAg5pegDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpDbGFzcyBUVXBMb2FkRmlsZQ0KDQoJUHVibGljIElEDQoJUHVibGljIEF1dGhvcklEDQoNCglQdWJsaWMgRmlsZVNpemUNCglQdWJsaWMgRmlsZU5hbWUNCglQdWJsaWMgUG9zdFRpbWUNCglQdWJsaWMgU3RyZWFtDQoJUHVibGljIERpckJ5VGltZQ0KCVB1YmxpYyBGaWxlSW50cm8NCglQdWJsaWMgUXVvdGUNCg0KCVB1YmxpYyBNZXRhDQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IE1ldGFTdHJpbmcNCgkJTWV0YVN0cmluZz1NZXRhLlNhdmVTdHJpbmcNCglFbmQgUHJvcGVydHkNCglQdWJsaWMgUHJvcGVydHkgTGV0IE1ldGFTdHJpbmcocykNCgkJTWV0YS5Mb2FkU3RyaW5nPXMNCglFbmQgUHJvcGVydHkNCg0KCVB1YmxpYyBodG1sDQoNCglQdWJsaWMgQXV0b05hbWUNCglQdWJsaWMgRnVsbFBhdGgNCglQdWJsaWMgSXNNYW51YWwNCg0KCVB1YmxpYyBGdW5jdGlvbiBMb2FkSW5mb0J5SUQodWxfSUQpDQoNCgkJQ2FsbCBDaGVja1BhcmFtZXRlcih1bF9JRCwiaW50IiwwKQ0KDQoJCURpbSBvYmpSUw0KCQlTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgW3VsX0lEXSxbdWxfQXV0aG9ySURdLFt1bF9GaWxlU2l6ZV0sW3VsX0ZpbGVOYW1lXSxbdWxfUG9zdFRpbWVdLFt1bF9GaWxlSW50cm9dLFt1bF9EaXJCeVRpbWVdLFt1bF9RdW90ZV0sW3VsX01ldGFdIEZST00gW2Jsb2dfVXBMb2FkXSBXSEVSRSBbdWxfSURdPSIgJiB1bF9JRCkNCg0KCQlJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoNCgkJCUlEPW9ialJTKCJ1bF9JRCIpDQoJCQlBdXRob3JJRD1vYmpSUygidWxfQXV0aG9ySUQiKQ0KCQkJRmlsZVNpemU9b2JqUlMoInVsX0ZpbGVTaXplIikNCgkJCUZpbGVOYW1lPW9ialJTKCJ1bF9GaWxlTmFtZSIpDQoJCQlQb3N0VGltZT1vYmpSUygidWxfUG9zdFRpbWUiKQ0KCQkJRmlsZUludHJvPW9ialJTKCJ1bF9GaWxlSW50cm8iKQ0KCQkJRGlyQnlUaW1lPW9ialJTKCJ1bF9EaXJCeVRpbWUiKQ0KCQkJUXVvdGU9b2JqUlMoInVsX1F1b3RlIikNCgkJCU1ldGFTdHJpbmc9b2JqUlMoInVsX01ldGEiKQ0KDQoJCQknSWYgSXNOdWxsKERpckJ5VGltZSkgT3IgRGlyQnlUaW1lPSIiIFRoZW4gRGlyQnlUaW1lPUZhbHNlDQoNCgkJCUxvYWRJbmZvYnlJRD1UcnVlDQoNCgkJRW5kIElmDQoNCgkJb2JqUlMuQ2xvc2UNCgkJU2V0IG9ialJTPU5vdGhpbmcNCg0KCQlDYWxsIEZpbHRlcl9QbHVnaW5fVFVwTG9hZEZpbGVfTG9hZEluZm9CeUlEKElELEF1dGhvcklELEZpbGVTaXplLEZpbGVOYW1lLFBvc3RUaW1lLEZpbGVJbnRybyxEaXJCeVRpbWUsUXVvdGUsTWV0YSkNCg0KCUVuZCBGdW5jdGlvbg0KDQoNCglQdWJsaWMgRnVuY3Rpb24gTG9hZEluZm9CeUFycmF5KGFyeVVMSW5mbykNCg0KCQlJZiBJc0FycmF5KGFyeVVMSW5mbyk9VHJ1ZSBUaGVuDQoNCgkJCUlEPWFyeVVMSW5mbygwKQ0KCQkJQXV0aG9ySUQ9YXJ5VUxJbmZvKDEpDQoJCQlGaWxlU2l6ZT1hcnlVTEluZm8oMikNCgkJCUZpbGVOYW1lPWFyeVVMSW5mbygzKQ0KCQkJUG9zdFRpbWU9YXJ5VUxJbmZvKDQpDQoJCQlGaWxlSW50cm89YXJ5VUxJbmZvKDUpDQoJCQlEaXJCeVRpbWU9YXJ5VUxJbmZvKDYpDQoJCQlRdW90ZT1hcnlVTEluZm8oNykNCgkJCU1ldGFTdHJpbmc9YXJ5VUxJbmZvKDgpDQoNCgkJRW5kIElmDQoNCgkJTG9hZEluZm9CeUFycmF5PVRydWUNCg0KCQlDYWxsIEZpbHRlcl9QbHVnaW5fVFVwTG9hZEZpbGVfTG9hZEluZm9CeUFycmF5KElELEF1dGhvcklELEZpbGVTaXplLEZpbGVOYW1lLFBvc3RUaW1lLEZpbGVJbnRybyxEaXJCeVRpbWUsUXVvdGUsTWV0YSkNCg0KCUVuZCBGdW5jdGlvbg0KDQoNCglQdWJsaWMgRnVuY3Rpb24gVXBMb2FkX0Zvcm0oKQ0KDQoJCURpbSBpLGoNCgkJRGltIHgseSx6DQoJCURpbSBpbnRGb3JtU2l6ZQ0KCQlEaW0gYmluRm9ybURhdGENCgkJRGltIHN0ckZpbGVOYW1lDQoNCgkJRGltIHMsdA0KDQoJCWludEZvcm1TaXplID0gUmVxdWVzdC5Ub3RhbEJ5dGVzDQoJCWJpbkZvcm1EYXRhID0gUmVxdWVzdC5CaW5hcnlSZWFkKGludEZvcm1TaXplKQ0KDQoJCWk9MA0KCQlpPUluc3RyQihiaW5Gb3JtRGF0YSxDaHJCKDEzKSZDaHJCKDEwKSZDaHJCKDEzKSZDaHJCKDEwKSkNCgkJSWYgaT4wIFRoZW4gaT1pKzMNCgkJdD1JbnN0ckIoYmluRm9ybURhdGEsQ2hyQigxMykmQ2hyQigxMCkpDQoJCXM9TWlkYihiaW5Gb3JtRGF0YSwxLHQpDQoJCXQ9SW5zdHJCKGJpbkZvcm1EYXRhLENockIoMTMpJkNockIoMTApJnMpDQoJCWo9dA0KDQoJCUlmIExlbihSZXF1ZXN0LlF1ZXJ5U3RyaW5nKCJmaWxlbmFtZSIpKT4wIFRoZW4NCgkJCXN0ckZpbGVOYW1lPVJlcXVlc3QuUXVlcnlTdHJpbmcoImZpbGVuYW1lIikNCgkJRWxzZQ0KCQkJeD1JbnN0ckIoYmluRm9ybURhdGEsQ2hyQigmSDY2KSZDaHJCKCZINjkpJkNockIoJkg2QykmQ2hyQigmSDY1KSZDaHJCKCZINkUpJkNockIoJkg2MSkmQ2hyQigmSDZEKSZDaHJCKCZINjUpJkNockIoJkgzRCkmQ2hyQigmSDIyKSkNCgkJCXk9SW5zdHJCKHgrMTEsYmluRm9ybURhdGEsQ2hyQigmSDIyKSkNCgkJCUZvciB6PTEgdG8geS14LTEwDQoJCQkJc3RyRmlsZU5hbWU9c3RyRmlsZU5hbWUgJiBDaHIoQXNjQihNaWRCKGJpbkZvcm1EYXRhLHgreis5LDEpKSkNCgkJCU5leHQNCgkJRW5kIElmDQoNCgkJRGltIG9ialN0cmVhbVVwDQoJCVNldCBvYmpTdHJlYW1VcCA9IFNlcnZlci5DcmVhdGVPYmplY3QoIkFET0RCLlN0cmVhbSIpDQoNCgkJV2l0aCBvYmpTdHJlYW1VcA0KCQkJLlR5cGUgPSBhZFR5cGVCaW5hcnkNCgkJCS5Nb2RlID0gYWRNb2RlUmVhZFdyaXRlDQoJCQkuT3Blbg0KCQkJLlBvc2l0aW9uID0gMA0KCQkJLldyaXRlIGJpbkZvcm1EYXRhDQoJCQkuUG9zaXRpb24gPSBpDQoJCQlTdHJlYW09LlJlYWQoai1pLTEpDQoJCQkuQ2xvc2UNCgkJRW5kIFdpdGgNCg0KCQlGaWxlTmFtZT1zdHJGaWxlTmFtZQ0KCQlGaWxlU2l6ZT1MZW5CKFN0cmVhbSkNCg0KCQlVcExvYWRfRm9ybT1UcnVlDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJUHVibGljIEZ1bmN0aW9uIFVwTG9hZCgpDQoNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RVcExvYWRGaWxlX1VwTG9hZChJRCxBdXRob3JJRCxGaWxlU2l6ZSxGaWxlTmFtZSxQb3N0VGltZSxGaWxlSW50cm8sRGlyQnlUaW1lLFF1b3RlLE1ldGEpDQoNCgkJRGlyQnlUaW1lPVRydWUNCg0KCQlJZiBJc01hbnVhbD1GYWxzZSBUaGVuDQoJCQlDYWxsIFVwTG9hZF9Gb3JtKCkNCgkJRW5kIElmDQoNCgkJSWYgSW5TdHJSZXYoRmlsZU5hbWUsIlwiKT4wIFRoZW4NCgkJCUZpbGVOYW1lPU1pZChGaWxlTmFtZSxJblN0clJldihGaWxlTmFtZSwiXCIpKzEpDQoJCUVuZCBJZg0KDQoJCUlmIEluU3RyUmV2KEZpbGVOYW1lLCIvIik+MCBUaGVuDQoJCQlGaWxlTmFtZT1NaWQoRmlsZU5hbWUsSW5TdHJSZXYoRmlsZU5hbWUsIi8iKSsxKQ0KCQlFbmQgSWYNCg0KCQlGaWxlTmFtZT1UcmFuc2ZlckhUTUwoRmlsZU5hbWUsIltmaWxlbmFtZV0iKQ0KDQoJCSfotoXlh7rnsbvlnovpmZDliLYNCgkJSWYgTm90IENoZWNrUmVnRXhwKExDYXNlKEZpbGVOYW1lKSwiXC4oIiYgWkNfVVBMT0FEX0ZJTEVUWVBFICYiKSQiKSBUaGVuIENhbGwgU2hvd0Vycm9yKDI2KQ0KDQoJCSfotoXlh7rlpKflsI/pmZDliLYNCgkJSWYgRmlsZVNpemU+WkNfVVBMT0FEX0ZJTEVTSVpFIFRoZW4gQ2FsbCBTaG93RXJyb3IoMjcpDQoNCgkJRmlsZU5hbWU9RmlsdGVyU1FMKEZpbGVOYW1lKQ0KDQoJCUlmIEF1dG9OYW1lPVRydWUgVGhlbg0KCQkJUmFuZG9taXplDQoJCQlGaWxlTmFtZT1ZZWFyKEdldFRpbWUoTm93KCkpKSAmIFJpZ2h0KCIwIiZNb250aChHZXRUaW1lKE5vdygpKSksMikgJiBSaWdodCgiMCImRGF5KEdldFRpbWUoTm93KCkpKSwyKSAmIFJpZ2h0KCIwIiZIb3VyKEdldFRpbWUoTm93KCkpKSwyKSAmIFJpZ2h0KCIwIiZNaW51dGUoR2V0VGltZShOb3coKSkpLDIpICYgUmlnaHQoIjAiJlNlY29uZChHZXRUaW1lKE5vdygpKSksMikgJiBJbnQoOSAqIFJuZCkgJiBJbnQoOSAqIFJuZCkgJiBJbnQoOSAqIFJuZCkgJiBJbnQoOSAqIFJuZCkgJiBSaWdodChGaWxlTmFtZSxMZW4oRmlsZU5hbWUpLUluU3RyUmV2KEZpbGVOYW1lLCIuIikrMSkNCgkJRW5kIElmDQoNCgkJRmlsZUludHJvPUZpbHRlclNRTChGaWxlSW50cm8pDQoNCgkJRGltIG9ialJTDQoJCVNldCBvYmpSUz1vYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCAqIEZST00gW2Jsb2dfVXBMb2FkXSBXSEVSRSBbdWxfRmlsZU5hbWVdID0gJyIgJiBGaWxlTmFtZSAmICInIikNCg0KCQlJZiBMZW4oRmlsZU5hbWUpPjI1NSBUaGVuIEZpbGVOYW1lPVJpZ2h0KEZpbGVOYW1lLDI1NSkNCgkJUG9zdFRpbWU9R2V0VGltZShOb3coKSkNCg0KCQlvYmpDb25uLkV4ZWN1dGUoIklOU0VSVCBJTlRPIFtibG9nX1VwTG9hZF0oW3VsX0F1dGhvcklEXSxbdWxfRmlsZVNpemVdLFt1bF9GaWxlTmFtZV0sW3VsX1Bvc3RUaW1lXSxbdWxfRmlsZUludHJvXSxbdWxfRGlyQnlUaW1lXSxbdWxfUXVvdGVdLFt1bF9NZXRhXSkgVkFMVUVTICgiJiBBdXRob3JJRCAmIiwiJiBGaWxlU2l6ZSAmIiwnIiYgRmlsZU5hbWUgJiInLCciJiBQb3N0VGltZSAmIicsJyImRmlsZUludHJvJiInLCImQ0xuZyhEaXJCeVRpbWUpJiIsJyImUXVvdGUmIicsJyImTWV0YVN0cmluZyYiJykiKQ0KDQoJCURpbSBzdHJVUExPQURESVINCg0KCQlzdHJVUExPQURESVIgPSBaQ19VUExPQURfRElSRUNUT1JZJiIvIiZZZWFyKEdldFRpbWUoTm93KCkpKSYiLyImTW9udGgoR2V0VGltZShOb3coKSkpDQoNCgkJQ2FsbCBDcmVhdERpcmVjdG9yeUJ5Q3VzdG9tRGlyZWN0b3J5KHN0clVQTE9BRERJUikNCg0KCQlGdWxsUGF0aD1CbG9nUGF0aCAmIHN0clVQTE9BRERJUiAmIi8iICYgRmlsZU5hbWUNCg0KDQoJCUlmIElzTWFudWFsPUZhbHNlIFRoZW4NCgkJCUNhbGwgU2F2ZUZpbGUoKQ0KCQlFbmQgSWYNCg0KDQoJCVVwTG9hZD1UcnVlDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJUHVibGljIEZ1bmN0aW9uIFNhdmVGaWxlKCkNCg0KCQlEaW0gb2JqU3RyZWFtRmlsZQ0KCQlTZXQgb2JqU3RyZWFtRmlsZSA9IFNlcnZlci5DcmVhdGVPYmplY3QoIkFET0RCLlN0cmVhbSIpDQoNCgkJb2JqU3RyZWFtRmlsZS5UeXBlID0gYWRUeXBlQmluYXJ5DQoJCW9ialN0cmVhbUZpbGUuTW9kZSA9IGFkTW9kZVJlYWRXcml0ZQ0KCQlvYmpTdHJlYW1GaWxlLk9wZW4NCgkJb2JqU3RyZWFtRmlsZS5Xcml0ZSBTdHJlYW0NCg0KCQlvYmpTdHJlYW1GaWxlLlNhdmVUb0ZpbGUgRnVsbFBhdGgsYWRTYXZlQ3JlYXRlT3ZlcldyaXRlDQoJCW9ialN0cmVhbUZpbGUuQ2xvc2UNCg0KCQlTYXZlRmlsZT1UcnVlDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoNCglQdWJsaWMgRnVuY3Rpb24gRGVsKCkNCg0KCQlDYWxsIEZpbHRlcl9QbHVnaW5fVFVwTG9hZEZpbGVfRGVsKElELEF1dGhvcklELEZpbGVTaXplLEZpbGVOYW1lLFBvc3RUaW1lLEZpbGVJbnRybyxEaXJCeVRpbWUsUXVvdGUsTWV0YSkNCg0KCQlDYWxsIENoZWNrUGFyYW1ldGVyKElELCJpbnQiLDApDQoNCgkJRGltIG9ialJTLHN0ckZpbGVQYXRoDQoNCgkJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUICogRlJPTSBbYmxvZ19VcExvYWRdIFdIRVJFIFt1bF9JRF0gPSAiICYgSUQpDQoNCgkJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KDQoNCgkJCXN0ckZpbGVQYXRoID0gQmxvZ1BhdGggJiBaQ19VUExPQURfRElSRUNUT1JZICYiLyIgJiBvYmpSUygidWxfRmlsZU5hbWUiKQ0KCQkJQ2FsbCBEZWxUb0ZpbGUoc3RyRmlsZVBhdGgpDQoNCg0KCQkJc3RyRmlsZVBhdGggPSBCbG9nUGF0aCAmIFpDX1VQTE9BRF9ESVJFQ1RPUlkgJiAiLyIgJiBZZWFyKG9ialJTKCJ1bF9Qb3N0VGltZSIpKSAmICIvIiAmIE1vbnRoKG9ialJTKCJ1bF9Qb3N0VGltZSIpKSAmIi8iICYgb2JqUlMoInVsX0ZpbGVOYW1lIikNCgkJCUNhbGwgRGVsVG9GaWxlKHN0ckZpbGVQYXRoKQ0KDQoJCQlvYmpDb25uLkV4ZWN1dGUoIkRFTEVURSBGUk9NIFtibG9nX1VwTG9hZF0gV0hFUkUgW3VsX0lEXSA9IiAmIElEKQ0KDQoJCUVsc2UNCg0KCQkJRXhpdCBGdW5jdGlvbg0KDQoJCUVuZCBJZg0KDQoJCW9ialJTLkNsb3NlDQoJCVNldCBvYmpSUz1Ob3RoaW5nDQoNCgkJRGVsPVRydWUNCg0KCUVuZCBGdW5jdGlvbg0KDQoJUHVibGljIFByb3BlcnR5IEdldCBGdWxsVXJsDQoNCgkJRGltIHN0clVQTE9BRERJUg0KDQoJCXN0clVQTE9BRERJUiA9IFpDX1VQTE9BRF9ESVJFQ1RPUlkmIi8iJlllYXIoR2V0VGltZShOb3coKSkpJiIvIiZNb250aChHZXRUaW1lKE5vdygpKSkNCg0KCQlGdWxsVXJsPUJsb2dIb3N0ICYgc3RyVVBMT0FERElSICYgIi8iICYgRmlsZU5hbWUNCg0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHJpdmF0ZSBTdWIgQ2xhc3NfSW5pdGlhbGl6ZSgpDQoNCgkJSUQ9MA0KCQlBdXRob3JJRD0wDQoJCVNldCBNZXRhPU5ldyBUTWV0YQ0KCQlBdXRvTmFtZT1GYWxzZQ0KCQlJc01hbnVhbD1GYWxzZQ0KCQkNCg0KCUVuZCBTdWINCg0KDQpFbmQgQ2xhc3MNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAg5a6a5LmJVFRhZ+exuw0KJyDovpPlhaXvvJogICAg5pegDQonIOi/lOWbnu+8miAgICDml6ANCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkNsYXNzIFRUYWcNCg0KCVB1YmxpYyBJRA0KCVB1YmxpYyBOYW1lDQoJUHVibGljIEludHJvDQoJUHVibGljIE9yZGVyDQoJUHVibGljIENvdW50DQoJUHVibGljIEFsaWFzDQoJUHVibGljIFBhcmVudElEDQoJUHVibGljIEZ1bGxVcmwNCglQdWJsaWMgTWV0YQ0KCVB1YmxpYyBUZW1wbGF0ZU5hbWUNCg0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgTWV0YVN0cmluZw0KCQlNZXRhU3RyaW5nPU1ldGEuU2F2ZVN0cmluZw0KCUVuZCBQcm9wZXJ0eQ0KCVB1YmxpYyBQcm9wZXJ0eSBMZXQgTWV0YVN0cmluZyhzKQ0KCQlNZXRhLkxvYWRTdHJpbmc9cw0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIGh0bWwNCg0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgRW5jb2RlTmFtZQ0KCQlFbmNvZGVOYW1lID0gU2VydmVyLlVSTEVuY29kZShOYW1lKQ0KCUVuZCBQcm9wZXJ0eQ0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgRW5jb2RlSW50cm8NCgkJRW5jb2RlSW50cm8gPSBTZXJ2ZXIuVVJMRW5jb2RlKEludHJvKQ0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHJpdmF0ZSBGdGVtcGxhdGUNCglQdWJsaWMgUHJvcGVydHkgTGV0IFRlbXBsYXRlKHN0ckZpbGVOYW1lKQ0KCQlGdGVtcGxhdGU9R2V0VGVtcGxhdGUoIlRFTVBMQVRFXyIgJiBzdHJGaWxlTmFtZSkNCglFbmQgUHJvcGVydHkNCglQdWJsaWMgUHJvcGVydHkgR2V0IFRlbXBsYXRlDQoJCUlmIEZ0ZW1wbGF0ZTw+IiIgVGhlbg0KCQkJVGVtcGxhdGUgPSBGdGVtcGxhdGUNCgkJCUV4aXQgUHJvcGVydHkNCgkJRWxzZQ0KCQkJSWYgVGVtcGxhdGVOYW1lPD4iIiBUaGVuDQoJCQkJRGltIHMNCgkJCQlzPUdldFRlbXBsYXRlKCJURU1QTEFURV8iICZUZW1wbGF0ZU5hbWUpDQoJCQkJSWYgczw+IiIgVGhlbg0KCQkJCQlGdGVtcGxhdGUgPSBzDQoJCQkJRWxzZQ0KCQkJCQlGdGVtcGxhdGU9R2V0VGVtcGxhdGUoIlRFTVBMQVRFX0NBVEFMT0ciKQ0KCQkJCUVuZCBJZg0KCQkJRWxzZQ0KCQkJCUZ0ZW1wbGF0ZT1HZXRUZW1wbGF0ZSgiVEVNUExBVEVfQ0FUQUxPRyIpDQoJCQlFbmQgSWYNCgkJCVRlbXBsYXRlID0gRnRlbXBsYXRlDQoJCUVuZCBJZg0KCUVuZCBQcm9wZXJ0eQ0KDQoNCglQdWJsaWMgRnVuY3Rpb24gR2V0RGVmYXVsdFRlbXBsYXRlTmFtZQ0KCQlJZiBUZW1wbGF0ZU5hbWU8PiIiIFRoZW4NCgkJCUdldERlZmF1bHRUZW1wbGF0ZU5hbWU9VGVtcGxhdGVOYW1lDQoJCUVsc2UNCgkJCUdldERlZmF1bHRUZW1wbGF0ZU5hbWU9IkNBVEFMT0ciDQoJCUVuZCBJZg0KCUVuZCBGdW5jdGlvbg0KDQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IEZ1bGxQYXRoDQoJCUZ1bGxQYXRoPVBhcnNlQ3VzdG9tRGlyZWN0b3J5Rm9yUGF0aChGdWxsUmVnZXgsWkNfU1RBVElDX0RJUkVDVE9SWSwiIiwiIiwiIiwiIiwiIixJRCxOYW1lLFN0YXRpY05hbWUpDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IFVybA0KDQoJCSdwbHVnaW4gbm9kZQ0KCQliQWN0aW9uX1BsdWdpbl9UVGFnX1VybD1GYWxzZQ0KCQlGb3IgRWFjaCBzQWN0aW9uX1BsdWdpbl9UVGFnX1VybCBpbiBBY3Rpb25fUGx1Z2luX1RUYWdfVXJsDQoJCQlJZiBOb3QgSXNFbXB0eShzQWN0aW9uX1BsdWdpbl9UVGFnX1VybCkgVGhlbiBDYWxsIEV4ZWN1dGUoc0FjdGlvbl9QbHVnaW5fVFRhZ19VcmwpDQoJCQlJZiBiQWN0aW9uX1BsdWdpbl9UVGFnX1VybD1UcnVlIFRoZW4gRXhpdCBQcm9wZXJ0eQ0KCQlOZXh0DQoNCgkJVXJsID1QYXJzZUN1c3RvbURpcmVjdG9yeUZvclVybChGdWxsUmVnZXgsWkNfU1RBVElDX0RJUkVDVE9SWSwiIiwiIiwiIiwiIiwiIixJRCxFbmNvZGVOYW1lLFN0YXRpY0VuY29kZU5hbWUpDQoJCUlmIFJpZ2h0KFVybCwxMik9ImRlZmF1bHQuaHRtbCIgVGhlbiBVcmw9TGVmdChVcmwsTGVuKFVybCktMTIpDQoNCgkJVXJsPVJlcGxhY2UoUmVwbGFjZShVcmwsIi8vIiwiLyIpLCI6LyIsIjovLyIsMSwxKQ0KDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UVGFnX1VybChVcmwpDQoNCglFbmQgUHJvcGVydHkNCg0KDQoJUHVibGljIFByb3BlcnR5IEdldCBTdGF0aWNOYW1lDQoJCUlmIElzTnVsbChJbnRybykgT3IgSXNFbXB0eShJbnRybykgT3IgSW50cm89IiIgVGhlbg0KCQkJU3RhdGljTmFtZSA9IE5hbWUNCgkJRWxzZQ0KCQkJU3RhdGljTmFtZSA9IEludHJvDQoJCUVuZCBJZg0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBTdGF0aWNFbmNvZGVOYW1lDQoJCUlmIElzTnVsbChJbnRybykgT3IgSXNFbXB0eShJbnRybykgT3IgSW50cm89IiIgVGhlbg0KCQkJU3RhdGljRW5jb2RlTmFtZSA9IEVuY29kZU5hbWUNCgkJRWxzZQ0KCQkJU3RhdGljRW5jb2RlTmFtZSA9IEVuY29kZUludHJvDQoJCUVuZCBJZg0KCUVuZCBQcm9wZXJ0eQ0KDQoNCglQcml2YXRlIEZmdWxscmVnZXgNCglQdWJsaWMgUHJvcGVydHkgTGV0IEZ1bGxSZWdleChzKQ0KCQlGZnVsbHJlZ2V4PXMNCglFbmQgUHJvcGVydHkNCglQdWJsaWMgUHJvcGVydHkgR2V0IEZ1bGxSZWdleA0KCQlJZiBGZnVsbHJlZ2V4PD4iIiBUaGVuIA0KCQkJRnVsbFJlZ2V4PUZmdWxscmVnZXgNCgkJRWxzZQ0KCQkJRnVsbFJlZ2V4PVpDX1RBR1NfUkVHRVgNCgkJRW5kIElmDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IEh0bWxVcmwNCgkJSHRtbFVybD1UcmFuc2ZlckhUTUwoVXJsLCJbaHRtbC1mb3JtYXRdIikNCglFbmQgUHJvcGVydHkNCg0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgSHRtbEludHJvDQoJCUh0bWxJbnRybz1UcmFuc2ZlckhUTUwoSW50cm8sIltodG1sLWZvcm1hdF0iKQ0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBIdG1sTmFtZQ0KCQlIdG1sTmFtZT1UcmFuc2ZlckhUTUwoTmFtZSwiW2h0bWwtZm9ybWF0XSIpDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IFJzc1VybA0KCQlSc3NVcmwgPSBCbG9nSG9zdCAmICJmZWVkLmFzcD90YWdzPSIgJiBJRA0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIFJlQ291bnQNCg0KCVB1YmxpYyBGdW5jdGlvbiBQb3N0KCkNCg0KCQlDYWxsIEZpbHRlcl9QbHVnaW5fVFRhZ19Qb3N0KElELE5hbWUsSW50cm8sT3JkZXIsQ291bnQsUGFyZW50SUQsQWxpYXMsVGVtcGxhdGVOYW1lLEZ1bGxVcmwsTWV0YVN0cmluZykNCg0KCQlDYWxsIENoZWNrUGFyYW1ldGVyKElELCJpbnQiLDApDQoJCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoT3JkZXIsImludCIsMCkNCgkJQ2FsbCBDaGVja1BhcmFtZXRlcihQYXJlbnRJRCwiaW50IiwwKQ0KDQoJCU5hbWU9RmlsdGVyU1FMKE5hbWUpDQoJCU5hbWU9VHJhbnNmZXJIVE1MKE5hbWUsIltub3JtYWxuYW1lXSIpDQoJCUlmIExlbihOYW1lKT0wIFRoZW4gUG9zdD1GYWxzZTpFeGl0IEZ1bmN0aW9uDQoNCgkJSW50cm89RmlsdGVyU1FMKEludHJvKQ0KCQlBbGlhcz1GaWx0ZXJTUUwoQWxpYXMpDQoJCSdJbnRybz1UcmFuc2ZlckhUTUwoSW50cm8sIltodG1sLWZvcm1hdF0iKQ0KDQoJCVRlbXBsYXRlTmFtZT1VQ2FzZShGaWx0ZXJTUUwoVGVtcGxhdGVOYW1lKSkNCgkJSWYgVGVtcGxhdGVOYW1lPSJDQVRBTE9HIiBUaGVuIFRlbXBsYXRlTmFtZT0iIg0KDQoJCUlmIElEPTAgVGhlbg0KCQkJb2JqQ29ubi5FeGVjdXRlKCJJTlNFUlQgSU5UTyBbYmxvZ19UYWddKFt0YWdfTmFtZV0sW3RhZ19PcmRlcl0sW3RhZ19JbnRyb10sW3RhZ19QYXJlbnRJRF0sW3RhZ19VUkxdLFt0YWdfVGVtcGxhdGVdLFt0YWdfTWV0YV0pIFZBTFVFUyAoJyImTmFtZSYiJywiJk9yZGVyJiIsJyImSW50cm8mIicsIiZQYXJlbnRJRCYiLCciJkFsaWFzJiInLCciJlRlbXBsYXRlTmFtZSYiJywnIiZNZXRhU3RyaW5nJiInKSIpDQoJCQlEaW0gb2JqUlMNCgkJCVNldCBvYmpSUz1vYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBNQVgoW3RhZ19JRF0pIEZST00gW2Jsb2dfVGFnXSIpDQoJCQlJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoJCQkJSUQ9b2JqUlMoMCkNCgkJCUVuZCBJZg0KCQkJU2V0IG9ialJTPU5vdGhpbmcNCgkJRWxzZQ0KCQkJb2JqQ29ubi5FeGVjdXRlKCJVUERBVEUgW2Jsb2dfVGFnXSBTRVQgW3RhZ19OYW1lXT0nIiZOYW1lJiInLFt0YWdfT3JkZXJdPSImT3JkZXImIixbdGFnX0ludHJvXT0nIiZJbnRybyYiJyxbdGFnX1BhcmVudElEXT0iJlBhcmVudElEJiIsW3RhZ19VUkxdPSciJkFsaWFzJiInLFt0YWdfVGVtcGxhdGVdPSciJlRlbXBsYXRlTmFtZSYiJyxbdGFnX01ldGFdPSciJk1ldGFTdHJpbmcmIicgV0hFUkUgW3RhZ19JRF0gPSIgJiBJRCkNCgkJRW5kIElmDQoNCgkJUG9zdD1UcnVlDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJUHVibGljIEZ1bmN0aW9uIExvYWRJbmZvQnlJRCh0YWdfSUQpDQoNCgkJQ2FsbCBDaGVja1BhcmFtZXRlcih0YWdfSUQsImludCIsMCkNCg0KCQlEaW0gb2JqUlMNCgkJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFt0YWdfSURdLFt0YWdfTmFtZV0sW3RhZ19JbnRyb10sW3RhZ19PcmRlcl0sW3RhZ19Db3VudF0sW3RhZ19QYXJlbnRJRF0sW3RhZ19VUkxdLFt0YWdfVGVtcGxhdGVdLFt0YWdfRnVsbFVybF0sW3RhZ19NZXRhXSBGUk9NIFtibG9nX1RhZ10gV0hFUkUgW3RhZ19JRF09IiAmIHRhZ19JRCkNCg0KCQlJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoNCgkJCUlEPW9ialJTKCJ0YWdfSUQiKQ0KCQkJTmFtZT1vYmpSUygidGFnX05hbWUiKQ0KCQkJSW50cm89b2JqUlMoInRhZ19JbnRybyIpDQoJCQlPcmRlcj1vYmpSUygidGFnX09yZGVyIikNCgkJCUNvdW50PW9ialJTKCJ0YWdfQ291bnQiKQ0KCQkJUGFyZW50SUQ9b2JqUlMoInRhZ19QYXJlbnRJRCIpDQoJCQlBbGlhcz1vYmpSUygidGFnX1VSTCIpDQoJCQlUZW1wbGF0ZU5hbWU9b2JqUlMoInRhZ19UZW1wbGF0ZSIpDQoJCQlGdWxsVXJsPW9ialJTKCJ0YWdfRnVsbFVybCIpDQoJCQlNZXRhU3RyaW5nPW9ialJTKCJ0YWdfTWV0YSIpDQoNCgkJCUxvYWRJbmZvQnlJRD1UcnVlDQoNCgkJRW5kIElmDQoNCgkJb2JqUlMuQ2xvc2UNCgkJU2V0IG9ialJTPU5vdGhpbmcNCg0KCQlJZiBJc051bGwoSW50cm8pIFRoZW4gSW50cm89IiINCg0KCQlDYWxsIEZpbHRlcl9QbHVnaW5fVFRhZ19Mb2FkSW5mb0J5SUQoSUQsTmFtZSxJbnRybyxPcmRlcixDb3VudCxQYXJlbnRJRCxBbGlhcyxUZW1wbGF0ZU5hbWUsRnVsbFVybCxNZXRhU3RyaW5nKQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCglQdWJsaWMgRnVuY3Rpb24gTG9hZEluZm9CeUFycmF5KGFyeVRhZ0luZm8pDQoNCgkJSWYgSXNBcnJheShhcnlUYWdJbmZvKT1UcnVlIFRoZW4NCgkJCUlEPWFyeVRhZ0luZm8oMCkNCgkJCU5hbWU9YXJ5VGFnSW5mbygxKQ0KCQkJSW50cm89YXJ5VGFnSW5mbygyKQ0KCQkJT3JkZXI9YXJ5VGFnSW5mbygzKQ0KCQkJQ291bnQ9YXJ5VGFnSW5mbyg0KQ0KCQkJUGFyZW50SUQ9YXJ5VGFnSW5mbyg1KQ0KCQkJQWxpYXM9YXJ5VGFnSW5mbyg2KQ0KCQkJVGVtcGxhdGVOYW1lPWFyeVRhZ0luZm8oNykNCgkJCUZ1bGxVcmw9YXJ5VGFnSW5mbyg4KQ0KCQkJTWV0YVN0cmluZz1hcnlUYWdJbmZvKDkpDQoJCUVuZCBJZg0KDQoJCUlmIElzTnVsbChJbnRybykgVGhlbiBJbnRybz0iIg0KCQlJZiBJc051bGwoQWxpYXMpIFRoZW4gQWxpYXM9IiINCg0KCQlMb2FkSW5mb0J5QXJyYXk9VHJ1ZQ0KDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UVGFnX0xvYWRJbmZvQnlBcnJheShJRCxOYW1lLEludHJvLE9yZGVyLENvdW50LFBhcmVudElELEFsaWFzLFRlbXBsYXRlTmFtZSxGdWxsVXJsLE1ldGFTdHJpbmcpDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJUHVibGljIEZ1bmN0aW9uIERlbCgpDQoNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RUYWdfRGVsKElELE5hbWUsSW50cm8sT3JkZXIsQ291bnQsUGFyZW50SUQsQWxpYXMsVGVtcGxhdGVOYW1lLEZ1bGxVcmwsTWV0YVN0cmluZykNCg0KCQlDYWxsIENoZWNrUGFyYW1ldGVyKElELCJpbnQiLDApDQoJCUlmIChJRD0wKSBUaGVuIERlbD1GYWxzZTpFeGl0IEZ1bmN0aW9uDQoNCgkJRGltIHMNCgkJRGltIGkNCgkJRGltIG9ialJTDQoNCgkJU2V0IG9ialJTPVNlcnZlci5DcmVhdGVPYmplY3QoIkFET0RCLlJlY29yZHNldCIpDQoJCW9ialJTLkN1cnNvclR5cGUgPSBhZE9wZW5LZXlzZXQNCgkJb2JqUlMuTG9ja1R5cGUgPSBhZExvY2tSZWFkT25seQ0KCQlvYmpSUy5BY3RpdmVDb25uZWN0aW9uPW9iakNvbm4NCgkJb2JqUlMuU291cmNlPSIiDQoNCgkJb2JqUlMuT3BlbigiU0VMRUNUIFtsb2dfSURdLFtsb2dfdGFnXSBGUk9NIFtibG9nX0FydGljbGVdIFdIRVJFIFtsb2dfVGFnXSBMSUtFICcleyIgJiBJRCAmICJ9JSciKQ0KDQoJCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCgkJCURvIFdoaWxlIE5vdCBvYmpSUy5lb2YNCgkJCQlpPW9ialJTKCJsb2dfSUQiKQ0KCQkJCXM9b2JqUlMoImxvZ190YWciKQ0KCQkJCXM9UmVwbGFjZShzLCJ7IiYgSUQgJiJ9IiwiIikNCgkJCQlvYmpDb25uLkV4ZWN1dGUoIlVQREFURSBbYmxvZ19BcnRpY2xlXSBTRVQgW2xvZ190YWddPSciJiBzICYiJyBXSEVSRSBbbG9nX0lEXSA9IiAmIGkpDQoJCQkJb2JqUlMuTW92ZU5leHQNCgkJCUxvb3ANCgkJRW5kIElmDQoJCW9ialJTLkNsb3NlDQoNCgkJb2JqQ29ubi5FeGVjdXRlKCJERUxFVEUgRlJPTSBbYmxvZ19UYWddIFdIRVJFIFt0YWdfSURdID0iICYgSUQpDQoJCURlbD1UcnVlDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCVB1YmxpYyBGdW5jdGlvbiBNYWtlVGVtcGxhdGUocykNCg0KCQlEaW0gaHRtbCxpLGoNCgkJaHRtbD1zDQoNCgkJJ3BsdWdpbiBub2RlDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UVGFnX01ha2VUZW1wbGF0ZV9UZW1wbGF0ZShodG1sKQ0KDQoJCURpbSBhcnlUZW1wbGF0ZVRhZ3NOYW1lKCkNCgkJRGltIGFyeVRlbXBsYXRlVGFnc1ZhbHVlKCkNCg0KCQlSZURpbSBhcnlUZW1wbGF0ZVRhZ3NOYW1lKDcpDQoJCVJlRGltIGFyeVRlbXBsYXRlVGFnc1ZhbHVlKDcpDQoNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSggIDEpPSJhcnRpY2xlL3RhZy9pZCINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoIDEpPUlEDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoICAyKT0iYXJ0aWNsZS90YWcvbmFtZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoIDIpPUh0bWxOYW1lDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoICAzKT0iYXJ0aWNsZS90YWcvaW50cm8iDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKCAzKT1IdG1sSW50cm8NCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSggIDQpPSJhcnRpY2xlL3RhZy9jb3VudCINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoIDQpPUNvdW50DQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoICA1KT0iYXJ0aWNsZS90YWcvdXJsIg0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSggNSk9SHRtbFVybA0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKCAgNik9ImFydGljbGUvdGFnL2VuY29kZW5hbWUiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKCA2KT1FbmNvZGVOYW1lDQoNCgkJJ3BsdWdpbiBub2RlDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9UVGFnX01ha2VUZW1wbGF0ZV9UZW1wbGF0ZVRhZ3MoYXJ5VGVtcGxhdGVUYWdzTmFtZSxhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSkNCg0KCQlqPVVCb3VuZChhcnlUZW1wbGF0ZVRhZ3NOYW1lKQ0KCQlGb3IgaT0xIHRvIGoNCgkJCUlmIElzTnVsbChhcnlUZW1wbGF0ZVRhZ3NWYWx1ZShpKSk9RmFsc2UgVGhlbg0KCQkJCWh0bWw9UmVwbGFjZShodG1sLCI8IyIgJiBhcnlUZW1wbGF0ZVRhZ3NOYW1lKGkpICYgIiM+IixhcnlUZW1wbGF0ZVRhZ3NWYWx1ZShpKSkNCgkJCUVsc2UNCgkJCQlodG1sPVJlcGxhY2UoaHRtbCwiPCMiICYgYXJ5VGVtcGxhdGVUYWdzTmFtZShpKSAmICIjPiIsIiIpDQoJCQlFbmQgSWYNCgkJTmV4dA0KDQoJCU1ha2VUZW1wbGF0ZT1odG1sDQoNCglFbmQgRnVuY3Rpb24NCg0KCVByaXZhdGUgU3ViIENsYXNzX0luaXRpYWxpemUoKQ0KDQoJCUlEPTANCgkJT3JkZXI9MA0KCQlQYXJlbnRJRD0wDQoJCUNvdW50PTANCgkJUmVDb3VudD0wDQoNCgkJU2V0IE1ldGE9TmV3IFRNZXRhDQoNCglFbmQgU3ViDQoNCg0KRW5kIENsYXNzDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIOWumuS5iVRLZXlXb3Jk57G7DQonIOi+k+WFpe+8miAgICDml6ANCicg6L+U5Zue77yaICAgIOaXoA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KQ2xhc3MgVEtleVdvcmQNCg0KCVB1YmxpYyBJRA0KCVB1YmxpYyBOYW1lDQoJUHVibGljIEludHJvDQoJUHVibGljIFVybA0KDQoJUHVibGljIEZ1bmN0aW9uIFBvc3QoKQ0KDQoJCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoSUQsImludCIsMCkNCg0KCQlOYW1lPUZpbHRlclNRTChOYW1lKQ0KCQlOYW1lPVRyYW5zZmVySFRNTChOYW1lLCJbbm9ybWFsbmFtZV0iKQ0KDQoJCUlmIExlbihOYW1lKT0wIFRoZW4gUG9zdD1GYWxzZTpFeGl0IEZ1bmN0aW9uDQoNCgkJSW50cm89RmlsdGVyU1FMKEludHJvKQ0KCQlJbnRybz1UcmFuc2ZlckhUTUwoSW50cm8sIltodG1sLWZvcm1hdF0iKQ0KDQoJCVVybD1GaWx0ZXJTUUwoVXJsKQ0KCQlJZiBMZW4oVXJsKT0wIFRoZW4gUG9zdD1GYWxzZTpFeGl0IEZ1bmN0aW9uDQoJCUlmIE5vdCBDaGVja1JlZ0V4cChVcmwsIltob21lcGFnZV0iKSBUaGVuIENhbGwgIFNob3dFcnJvcigzMCkNCg0KCQlJZiBJRD0wIFRoZW4NCgkJCW9iakNvbm4uRXhlY3V0ZSgiSU5TRVJUIElOVE8gW2Jsb2dfS2V5d29yZF0oW2tleV9OYW1lXSxba2V5X1VSTF0sW2tleV9JbnRyb10pIFZBTFVFUyAoJyImTmFtZSYiJywnIiZVcmwmIicsJyImSW50cm8mIicpIikNCgkJRWxzZQ0KCQkJb2JqQ29ubi5FeGVjdXRlKCJVUERBVEUgW2Jsb2dfS2V5d29yZF0gU0VUIFtrZXlfTmFtZV09JyImTmFtZSYiJyxba2V5X1VSTF09JyImVXJsJiInLFtrZXlfSW50cm9dPSciJkludHJvJiInIFdIRVJFIFtrZXlfSURdID0iICYgSUQpDQoJCUVuZCBJZg0KDQoJCVBvc3Q9VHJ1ZQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCVB1YmxpYyBGdW5jdGlvbiBMb2FkSW5mb0J5SUQoa2V5X0lEKQ0KDQoJCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoa2V5X0lELCJpbnQiLDApDQoNCgkJRGltIG9ialJTDQoJCVNldCBvYmpSUz1vYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBba2V5X0lEXSxba2V5X05hbWVdLFtrZXlfSW50cm9dLFtrZXlfVXJsXSBGUk9NIFtibG9nX0tleXdvcmRdIFdIRVJFIFtrZXlfSURdPSIgJiBrZXlfSUQpDQoNCgkJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KDQoJCQlJRD1vYmpSUygia2V5X0lEIikNCgkJCU5hbWU9b2JqUlMoImtleV9OYW1lIikNCgkJCUludHJvPW9ialJTKCJrZXlfSW50cm8iKQ0KCQkJVXJsPW9ialJTKCJrZXlfVXJsIikNCg0KCQkJTG9hZEluZm9CeUlEPVRydWUNCg0KCQlFbmQgSWYNCg0KCQlvYmpSUy5DbG9zZQ0KCQlTZXQgb2JqUlM9Tm90aGluZw0KDQoJCUlmIElzTnVsbChJbnRybykgVGhlbiBJbnRybz0iIg0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCVB1YmxpYyBGdW5jdGlvbiBMb2FkSW5mb0J5QXJyYXkoYXJ5S2V5V29yZEluZm8pDQoNCgkJSWYgSXNBcnJheShhcnlLZXl3b3JkSW5mbyk9VHJ1ZSBUaGVuDQoNCgkJCUlEPWFyeUtleVdvcmRJbmZvKDApDQoJCQlOYW1lPWFyeUtleVdvcmRJbmZvKDEpDQoJCQlJbnRybz1hcnlLZXlXb3JkSW5mbygyKQ0KCQkJVXJsPWFyeUtleVdvcmRJbmZvKDMpDQoNCgkJRW5kIElmDQoNCgkJSWYgSXNOdWxsKEludHJvKSBUaGVuIEludHJvPSIiDQoNCgkJTG9hZEluZm9CeUFycmF5PVRydWUNCg0KCUVuZCBGdW5jdGlvbg0KDQoNCglQdWJsaWMgRnVuY3Rpb24gRGVsKCkNCg0KCQlDYWxsIENoZWNrUGFyYW1ldGVyKElELCJpbnQiLDApDQoJCUlmIChJRD0wKSBUaGVuIERlbD1GYWxzZTpFeGl0IEZ1bmN0aW9uDQoNCgkJb2JqQ29ubi5FeGVjdXRlKCJERUxFVEUgRlJPTSBbYmxvZ19LZXl3b3JkXSBXSEVSRSBba2V5X0lEXSA9IiAmIElEKQ0KCQlEZWw9VHJ1ZQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KRW5kIENsYXNzDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIOWumuS5iVRSc3MyRXhwb3J057G7IE5ld+eJiA0KJyDovpPlhaXvvJogICAg5pegDQonIOi/lOWbnu+8miAgICDml6ANCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkNsYXNzIFROZXdSc3MyRXhwb3J0DQoNCglQdWJsaWMgVGltZVpvbmUNCg0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgeG1sDQoJCXhtbCA9IG9ialhNTGRvYy54bWwNCglFbmQgUHJvcGVydHkNCg0KCXB1YmxpYyBGc3RyV2ViTGluaw0KCXB1YmxpYyBGc3RyQXV0aG9yDQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IFdlYkxpbmsNCgkJV2ViTGluayA9IEZzdHJXZWJMaW5rDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgTGV0IFdlYkxpbmsoc3RyV2ViTGluaykNCgkJRnN0cldlYkxpbmsgPSBzdHJXZWJMaW5rDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IEF1dGhvcg0KCQlBdXRob3IgPSBGc3RyQXV0aG9yDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgTGV0IEF1dGhvcihzdHJBdXRob3IpDQoJCUZzdHJBdXRob3IgPSBzdHJBdXRob3INCglFbmQgUHJvcGVydHkNCg0KCVByaXZhdGUgb2JqWE1MZG9jDQoNCglQcml2YXRlIG9ialhNTHJzcw0KDQoJUHJpdmF0ZSBvYmpYTUxjaGFubmVsDQoNCg0KCVB1YmxpYyBGdW5jdGlvbiBBZGRDaGFubmVsQXR0cmlidXRlKHRpdGxlLHZhbHVlKQ0KDQoJCURpbSBvYmpYTUxpdGVtDQoJCVNldCBvYmpYTUxpdGVtID0gb2JqWE1MZG9jLmNyZWF0ZUVsZW1lbnQodGl0bGUpDQoNCgkJSWYgdGl0bGU9InB1YkRhdGUiIFRoZW4gdmFsdWU9UGFyc2VEYXRlRm9yUkZDODIyKHZhbHVlKQ0KDQoJCW9ialhNTGl0ZW0udGV4dD12YWx1ZQ0KCQlvYmpYTUxjaGFubmVsLkFwcGVuZENoaWxkKG9ialhNTGl0ZW0pDQoNCgkJQWRkQ2hhbm5lbEF0dHJpYnV0ZT1UcnVlDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJUHVibGljIEZ1bmN0aW9uIEFkZEl0ZW0odGl0bGUsYXV0aG9yLGxpbmsscHViRGF0ZSxndWlkLGRlc2NyaXB0aW9uLGNhdGVnb3J5LGNvbW1lbnRzLHdmd19jb21tZW50LHdmd19jb21tZW50UnNzLHRyYWNrYmFja19waW5nKQ0KDQoJCURpbSBvYmpYTUxpdGVtDQoJCVNldCBvYmpYTUxpdGVtID0gb2JqWE1MZG9jLmNyZWF0ZUVsZW1lbnQoIml0ZW0iKQ0KCQlEaW0gb2JqWE1MY2RhdGENCg0KCQlJZihMZW4odGl0bGUpPjApIFRoZW4NCgkJCW9ialhNTGl0ZW0uQXBwZW5kQ2hpbGQob2JqWE1MZG9jLmNyZWF0ZUVsZW1lbnQoInRpdGxlIikpDQoJCQlvYmpYTUxpdGVtLnNlbGVjdFNpbmdsZU5vZGUoInRpdGxlIikudGV4dD10aXRsZQ0KCQlFbmQgSWYNCgkJSWYoTGVuKGF1dGhvcik+MCkgVGhlbg0KCQkJb2JqWE1MaXRlbS5BcHBlbmRDaGlsZChvYmpYTUxkb2MuY3JlYXRlRWxlbWVudCgiYXV0aG9yIikpDQoJCQlvYmpYTUxpdGVtLnNlbGVjdFNpbmdsZU5vZGUoImF1dGhvciIpLnRleHQ9YXV0aG9yDQoJCUVuZCBJZg0KCQlJZihMZW4obGluayk+MCkgVGhlbg0KCQkJb2JqWE1MaXRlbS5BcHBlbmRDaGlsZChvYmpYTUxkb2MuY3JlYXRlRWxlbWVudCgibGluayIpKQ0KCQkJb2JqWE1MaXRlbS5zZWxlY3RTaW5nbGVOb2RlKCJsaW5rIikudGV4dD1saW5rDQoJCUVuZCBJZg0KCQlJZihMZW4ocHViRGF0ZSk+MCkgVGhlbg0KCQkJb2JqWE1MaXRlbS5BcHBlbmRDaGlsZChvYmpYTUxkb2MuY3JlYXRlRWxlbWVudCgicHViRGF0ZSIpKQ0KCQkJb2JqWE1MaXRlbS5zZWxlY3RTaW5nbGVOb2RlKCJwdWJEYXRlIikudGV4dD1QYXJzZURhdGVGb3JSRkM4MjIocHViRGF0ZSkNCgkJRW5kIElmDQoJCUlmKExlbihndWlkKT4wKSBUaGVuDQoJCQlvYmpYTUxpdGVtLkFwcGVuZENoaWxkKG9ialhNTGRvYy5jcmVhdGVFbGVtZW50KCJndWlkIikpDQoJCQlvYmpYTUxpdGVtLnNlbGVjdFNpbmdsZU5vZGUoImd1aWQiKS50ZXh0PWd1aWQNCgkJRW5kIElmDQoJCUlmKExlbihkZXNjcmlwdGlvbik+MCkgVGhlbg0KDQoJCQlvYmpYTUxpdGVtLkFwcGVuZENoaWxkKG9ialhNTGRvYy5jcmVhdGVFbGVtZW50KCJkZXNjcmlwdGlvbiIpKQ0KCQkJU2V0IG9ialhNTGNkYXRhID0gb2JqWE1MZG9jLmNyZWF0ZU5vZGUoImNkYXRhc2VjdGlvbiIsICIiLCIiKQ0KCQkJb2JqWE1MY2RhdGEuTm9kZVZhbHVlPWRlc2NyaXB0aW9uDQoJCQlvYmpYTUxpdGVtLnNlbGVjdFNpbmdsZU5vZGUoImRlc2NyaXB0aW9uIikuQXBwZW5kQ2hpbGQob2JqWE1MY2RhdGEpDQoNCgkJCVNldCBvYmpYTUxjZGF0YSA9IE5vdGhpbmcNCg0KCQlFbmQgSWYNCgkJSWYoTGVuKGNhdGVnb3J5KT4wKSBUaGVuDQoJCQlvYmpYTUxpdGVtLkFwcGVuZENoaWxkKG9ialhNTGRvYy5jcmVhdGVFbGVtZW50KCJjYXRlZ29yeSIpKQ0KCQkJb2JqWE1MaXRlbS5zZWxlY3RTaW5nbGVOb2RlKCJjYXRlZ29yeSIpLnRleHQ9Y2F0ZWdvcnkNCgkJRW5kIElmDQoNCgkJSWYoTGVuKGNvbW1lbnRzKT4wKSBUaGVuDQoJCQlvYmpYTUxpdGVtLkFwcGVuZENoaWxkKG9ialhNTGRvYy5jcmVhdGVFbGVtZW50KCJjb21tZW50cyIpKQ0KCQkJb2JqWE1MaXRlbS5zZWxlY3RTaW5nbGVOb2RlKCJjb21tZW50cyIpLnRleHQ9Y29tbWVudHMNCgkJRW5kIElmDQoJCSdJZihMZW4od2Z3X2NvbW1lbnQpPjApIFRoZW4NCgkJJwlvYmpYTUxpdGVtLkFwcGVuZENoaWxkKG9ialhNTGRvYy5jcmVhdGVFbGVtZW50KCJ3Znc6Y29tbWVudCIpKQ0KCQknCW9ialhNTGl0ZW0uc2VsZWN0U2luZ2xlTm9kZSgid2Z3OmNvbW1lbnQiKS50ZXh0PXdmd19jb21tZW50DQoJCSdFbmQgSWYNCgkJSWYoTGVuKHdmd19jb21tZW50UnNzKT4wKSBUaGVuDQoJCQlvYmpYTUxpdGVtLkFwcGVuZENoaWxkKG9ialhNTGRvYy5jcmVhdGVFbGVtZW50KCJ3Znc6Y29tbWVudFJzcyIpKQ0KCQkJb2JqWE1MaXRlbS5zZWxlY3RTaW5nbGVOb2RlKCJ3Znc6Y29tbWVudFJzcyIpLnRleHQ9d2Z3X2NvbW1lbnRSc3MNCgkJRW5kIElmDQoJCSdJZihMZW4odHJhY2tiYWNrX3BpbmcpPjApIFRoZW4NCgkJJwlvYmpYTUxpdGVtLkFwcGVuZENoaWxkKG9ialhNTGRvYy5jcmVhdGVFbGVtZW50KCJ0cmFja2JhY2s6cGluZyIpKQ0KCQknCW9ialhNTGl0ZW0uc2VsZWN0U2luZ2xlTm9kZSgidHJhY2tiYWNrOnBpbmciKS50ZXh0PXRyYWNrYmFja19waW5nDQoJCSdFbmQgSWYNCg0KCQlvYmpYTUxjaGFubmVsLkFwcGVuZENoaWxkKG9ialhNTGl0ZW0pDQoNCgkJQWRkSXRlbT1UcnVlDQoNCglFbmQgRnVuY3Rpb24NCg0KCVB1YmxpYyBGdW5jdGlvbiBFeGVjdXRlKCkNCg0KCQknUmVzcG9uc2UuQ29udGVudFR5cGUgPSAidGV4dC9odG1sIg0KCQlSZXNwb25zZS5Db250ZW50VHlwZSA9ICJ0ZXh0L3htbCINCgkJUmVzcG9uc2UuQ2xlYXINCgkJUmVzcG9uc2UuV3JpdGUgeG1sDQoNCgkJRXhlY3V0ZT1UcnVlDQoNCglFbmQgRnVuY3Rpb24NCg0KCVB1YmxpYyBGdW5jdGlvbiBTYXZlVG9GaWxlKHN0ckZpbGVOYW1lKQ0KCQlPbiBFcnJvciBSZXN1bWUgTmV4dA0KCQlvYmpYTUxkb2Muc2F2ZShzdHJGaWxlTmFtZSkNCg0KCQlTYXZlVG9GaWxlPVRydWUNCgkJRXJyLkNsZWFyDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCUZ1bmN0aW9uIFBhcnNlRGF0ZUZvclJGQzgyMihkdG1EYXRlKQ0KDQoJCURpbSBkdG1EYXksIGR0bVdlZWtEYXksIGR0bU1vbnRoLCBkdG1ZZWFyDQoJCURpbSBkdG1Ib3VycywgZHRtTWludXRlcywgZHRtU2Vjb25kcw0KDQoJCVNlbGVjdCBDYXNlIFdlZWtEYXkoZHRtRGF0ZSkNCgkJCUNhc2UgMTpkdG1XZWVrRGF5PSJTdW4iDQoJCQlDYXNlIDI6ZHRtV2Vla0RheT0iTW9uIg0KCQkJQ2FzZSAzOmR0bVdlZWtEYXk9IlR1ZSINCgkJCUNhc2UgNDpkdG1XZWVrRGF5PSJXZWQiDQoJCQlDYXNlIDU6ZHRtV2Vla0RheT0iVGh1Ig0KCQkJQ2FzZSA2OmR0bVdlZWtEYXk9IkZyaSINCgkJCUNhc2UgNzpkdG1XZWVrRGF5PSJTYXQiDQoJCUVuZCBTZWxlY3QNCg0KCQlTZWxlY3QgQ2FzZSBNb250aChkdG1EYXRlKQ0KCQkJQ2FzZSAxOmR0bU1vbnRoPSJKYW4iDQoJCQlDYXNlIDI6ZHRtTW9udGg9IkZlYiINCgkJCUNhc2UgMzpkdG1Nb250aD0iTWFyIg0KCQkJQ2FzZSA0OmR0bU1vbnRoPSJBcHIiDQoJCQlDYXNlIDU6ZHRtTW9udGg9Ik1heSINCgkJCUNhc2UgNjpkdG1Nb250aD0iSnVuIg0KCQkJQ2FzZSA3OmR0bU1vbnRoPSJKdWwiDQoJCQlDYXNlIDg6ZHRtTW9udGg9IkF1ZyINCgkJCUNhc2UgOTpkdG1Nb250aD0iU2VwIg0KCQkJQ2FzZSAxMDpkdG1Nb250aD0iT2N0Ig0KCQkJQ2FzZSAxMTpkdG1Nb250aD0iTm92Ig0KCQkJQ2FzZSAxMjpkdG1Nb250aD0iRGVjIg0KCQlFbmQgU2VsZWN0DQoNCgkJZHRtWWVhciA9IFllYXIoZHRtRGF0ZSkNCgkJZHRtRGF5ID0gUmlnaHQoIjAwIiAmIERheShkdG1EYXRlKSwyKQ0KDQoJCWR0bUhvdXJzID0gUmlnaHQoIjAwIiAmIEhvdXIoZHRtRGF0ZSksMikNCgkJZHRtTWludXRlcyA9IFJpZ2h0KCIwMCIgJiBNaW51dGUoZHRtRGF0ZSksMikNCgkJZHRtU2Vjb25kcyA9IFJpZ2h0KCIwMCIgJiBTZWNvbmQoZHRtRGF0ZSksMikNCg0KCQlQYXJzZURhdGVGb3JSRkM4MjIgPSBkdG1XZWVrRGF5ICYgIiwgIiAmIGR0bURheSAmIiAiICYgZHRtTW9udGggJiAiICIgJiBkdG1ZZWFyICYgIiAiICYgZHRtSG91cnMgJiAiOiIgJiBkdG1NaW51dGVzICYgIjoiICYgZHRtU2Vjb25kcyAmIElJRihDTG5nKFRpbWVab25lKT0wLCIiLCIgIiAmIFRpbWVab25lKQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCgknIOexu+WIneWni+WMlg0KCVByaXZhdGUgU3ViIENsYXNzX0luaXRpYWxpemUoKQ0KDQoJCU9uIEVycm9yIFJlc3VtZSBOZXh0DQoNCgkJJ+WvuW9ialhNTGRvY+i/m+ihjOWIneWni+WMlu+8jOWmguS4jeiDveW7uuWvueixoeWImeaKpemUmQ0KCQlTZXQgb2JqWE1MZG9jID1TZXJ2ZXIuQ3JlYXRlT2JqZWN0KCJNaWNyb3NvZnQuWE1MRE9NIikNCg0KCQlJZiBFcnIuTnVtYmVyPD4wIFRoZW4NCg0KCQlFbmQgSWYNCg0KCQlEaW0gb2JqUEkNCg0KCQknU2V0IG9ialBJID0gb2JqWE1MZG9jLmNyZWF0ZVByb2Nlc3NpbmdJbnN0cnVjdGlvbigieG1sLXN0eWxlc2hlZXQiLCJ0eXBlPSIidGV4dC9jc3MiIiBocmVmPSIiemJfc3lzdGVtL2Nzcy9yc3MuY3NzIiIiKQ0KCQknb2JqWE1MZG9jLmluc2VydEJlZm9yZSBvYmpQSSwgb2JqWE1MZG9jLmNoaWxkTm9kZXMoMCkNCgkJJ1NldCBvYmpQSSA9IE5vdGhpbmcNCg0KCQknU2V0IG9ialBJID0gb2JqWE1MZG9jLmNyZWF0ZVByb2Nlc3NpbmdJbnN0cnVjdGlvbigieG1sLXN0eWxlc2hlZXQiLCJ0eXBlPSIidGV4dC94c2wiIiBocmVmPSIiemJfc3lzdGVtL2Nzcy9yc3MueHNsdCIiIikNCgkJJ29ialhNTGRvYy5pbnNlcnRCZWZvcmUgb2JqUEksIG9ialhNTGRvYy5jaGlsZE5vZGVzKDApDQoJCSdTZXQgb2JqUEkgPSBOb3RoaW5nDQoNCgkJU2V0IG9ialBJID0gb2JqWE1MZG9jLmNyZWF0ZVByb2Nlc3NpbmdJbnN0cnVjdGlvbigieG1sIiwidmVyc2lvbj0iIjEuMCIiIGVuY29kaW5nPSIiVVRGLTgiIiBzdGFuZGFsb25lPSIieWVzIiIiKQ0KCQlvYmpYTUxkb2MuaW5zZXJ0QmVmb3JlIG9ialBJLCBvYmpYTUxkb2MuY2hpbGROb2RlcygwKQ0KCQlTZXQgb2JqUEkgPSBOb3RoaW5nDQoNCgkJU2V0IG9ialhNTHJzcyA9IG9ialhNTGRvYy5jcmVhdGVFbGVtZW50KCJyc3MiKQ0KDQoJCVNldCBvYmpYTUxjaGFubmVsID0gb2JqWE1MZG9jLmNyZWF0ZUVsZW1lbnQoImNoYW5uZWwiKQ0KDQoNCgkJb2JqWE1McnNzLkFwcGVuZENoaWxkKG9ialhNTGNoYW5uZWwpDQoJCW9ialhNTGRvYy5BcHBlbmRDaGlsZChvYmpYTUxyc3MpDQoNCgkJb2JqWE1McnNzLnNldEF0dHJpYnV0ZSAidmVyc2lvbiIsIjIuMCINCgkJb2JqWE1McnNzLnNldEF0dHJpYnV0ZSAieG1sbnM6ZGMiLCJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyINCgkJb2JqWE1McnNzLnNldEF0dHJpYnV0ZSAieG1sbnM6dHJhY2tiYWNrIiwiaHR0cDovL21hZHNraWxscy5jb20vcHVibGljL3htbC9yc3MvbW9kdWxlL3RyYWNrYmFjay8iDQoJCW9ialhNTHJzcy5zZXRBdHRyaWJ1dGUgInhtbG5zOndmdyIsImh0dHA6Ly93ZWxsZm9ybWVkd2ViLm9yZy9Db21tZW50QVBJLyINCgkJb2JqWE1McnNzLnNldEF0dHJpYnV0ZSAieG1sbnM6c2xhc2giLCJodHRwOi8vcHVybC5vcmcvcnNzLzEuMC9tb2R1bGVzL3NsYXNoLyINCg0KDQoJRW5kIFN1Yg0KDQoJJyDnsbvph4rmlL4NCglQcml2YXRlIFN1YiBDbGFzc19UZXJtaW5hdGUoKQ0KDQoJCVNldCBvYmpYTUxyc3MgPSBOb3RoaW5nDQoJCVNldCBvYmpYTUxkb2MgID0gTm90aGluZw0KDQoJRW5kIFN1Yg0KDQpFbmQgQ2xhc3MNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAg5a6a5LmJVE1ldGENCicg6L6T5YWl77yaICAgIOaXoA0KJyDov5Tlm57vvJogICAg5pegDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpEaW0gbWV0YV9zcGxpdF9zdHJpbmdfMQ0KRGltIG1ldGFfc3BsaXRfc3RyaW5nXzINCm1ldGFfc3BsaXRfc3RyaW5nXzE9Q2hyKDEpDQptZXRhX3NwbGl0X3N0cmluZ18yPUNocigyKQ0KQ2xhc3MgVE1ldGENCg0KCVB1YmxpYyBOYW1lcygpDQoJUHVibGljIFZhbHVlcygpDQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IENvdW50DQoJCUNvdW50ID0gVUJvdW5kKG5hbWVzKQ0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHJpdmF0ZSBGdW5jdGlvbiBTYXZlKCkNCg0KCQlEaW0gbix2DQoJCUlmIFVCb3VuZChuYW1lcyk+MCBUaGVuDQoNCgkJCSduPUpvaW4oTmFtZXMsIjwvbmFtZT48bmFtZT4iKQ0KCQkJJ249IjxuYW1lPiImbiYiPC9uYW1lPiINCgkJCSd2PUpvaW4oVmFsdWVzLCI8L3ZhbHVlPjx2YWx1ZT4iKQ0KCQkJJ3Y9Ijx2YWx1ZT4iJnYmIjwvdmFsdWU+Ig0KCQkJJ1NhdmU9IjxuYW1lcz4iJm4mIjwvbmFtZXM+IiAmICI8dmFsdWVzPiImdiYiPC92YWx1ZXM+Ig0KCQkJJ1NhdmU9Ijx4bWw+IiAmIFNhdmUgJiAiPC94bWw+Ig0KDQoJCQluPUpvaW4oTmFtZXMsbWV0YV9zcGxpdF9zdHJpbmdfMSkNCgkJCXY9Sm9pbihWYWx1ZXMsbWV0YV9zcGxpdF9zdHJpbmdfMSkNCg0KCQkJU2F2ZT1Kb2luKEFycmF5KG4sdiksbWV0YV9zcGxpdF9zdHJpbmdfMikNCg0KCQlFbmQgSWYNCg0KCUVuZCBGdW5jdGlvbg0KDQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IFNhdmVTdHJpbmcNCgkJU2F2ZVN0cmluZyA9IFNhdmUoKQ0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIFByb3BlcnR5IExldCBMb2FkU3RyaW5nKHMpDQoJCUNhbGwgTG9hZChzKQ0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHJpdmF0ZSBGdW5jdGlvbiBMb2FkKHMpDQoNCgkJSWYgSXNOdWxsKHMpPVRydWUgVGhlbiBFeGl0IEZ1bmN0aW9uDQoJCUlmIElzRW1wdHkocyk9VHJ1ZSBUaGVuIEV4aXQgRnVuY3Rpb24NCg0KCQlEaW0geCxuLHYNCgkJeD1TcGxpdChzLG1ldGFfc3BsaXRfc3RyaW5nXzIpDQoNCgkJSWYgVUJvdW5kKHgpPD4xIFRoZW4gRXhpdCBGdW5jdGlvbg0KDQoJCW49U3BsaXQoeCgwKSxtZXRhX3NwbGl0X3N0cmluZ18xKQ0KCQl2PVNwbGl0KHgoMSksbWV0YV9zcGxpdF9zdHJpbmdfMSkNCg0KCQlEaW0gaQ0KCQlSZURpbSBOYW1lcyhVQm91bmQobikpDQoJCVJlRGltIFZhbHVlcyhVQm91bmQobikpDQoJCUZvciBpPTAgVG8gVUJvdW5kKG4pDQoJCQlOYW1lcyhpKT1uKGkpDQoJCQlWYWx1ZXMoaSk9dihpKQ0KCQlOZXh0DQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJUHJpdmF0ZSBGdW5jdGlvbiBMb2FkQnlBcnJheShuLHYpDQoNCgkJRGltIGkNCgkJUmVEaW0gTmFtZXMoVUJvdW5kKG4pKQ0KCQlSZURpbSBWYWx1ZXMoVUJvdW5kKG4pKQ0KCQlGb3IgaT0wIFRvIFVCb3VuZChuKQ0KCQkJTmFtZXMoaSk9bihpKQ0KCQkJVmFsdWVzKGkpPXYoaSkNCgkJTmV4dA0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCVB1YmxpYyBGdW5jdGlvbiBTZXRWYWx1ZShuYW1lLHZhbHVlKQ0KDQoJCW5hbWU9VHJpbShuYW1lKQ0KDQoJCUlmIElzRW1wdHkobmFtZSkgT3IgSXNOdWxsKG5hbWUpIFRoZW4gRXhpdCBGdW5jdGlvbg0KDQoJCW5hbWU9UmVwbGFjZShuYW1lLG1ldGFfc3BsaXRfc3RyaW5nXzEsIiIpDQoJCW5hbWU9UmVwbGFjZShuYW1lLG1ldGFfc3BsaXRfc3RyaW5nXzIsIiIpDQoNCgkJSWYgSXNOdWxsKHZhbHVlKT1UcnVlIFRoZW4gdmFsdWU9IiINCg0KCQlEaW0gbixpDQoJCWk9MA0KCQlGb3IgRWFjaCBuIEluIG5hbWVzDQoJCQlJZiBMQ2FzZShuKT1MQ2FzZShuYW1lKSBUaGVuDQoJCQkJdmFsdWVzKGkpPXZic2VzY2FwZSh2YWx1ZSkNCgkJCQknSWYgdmFsdWVzKGkpPSJ1bmRlZmluZWQiIFRoZW4gdmFsdWVzKGkpPSIiDQoJCQkJRXhpdCBmdW5jdGlvbg0KCQkJRW5kIElmDQoJCQlpPWkrMQ0KCQlOZXh0DQoNCgkJaT1VQm91bmQobmFtZXMpDQoNCgkJUmVEaW0gUHJlc2VydmUgTmFtZXMoaSsxKQ0KCQlSZURpbSBQcmVzZXJ2ZSBWYWx1ZXMoaSsxKQ0KDQoJCU5hbWVzKGkrMSk9bmFtZQ0KCQlWYWx1ZXMoaSsxKT12YnNlc2NhcGUodmFsdWUpDQoJCSdJZiB2YWx1ZXMoaSsxKT0idW5kZWZpbmVkIiBUaGVuIHZhbHVlcyhpKzEpPSIiDQoNCglFbmQgRnVuY3Rpb24NCg0KCVB1YmxpYyBGdW5jdGlvbiBHZXRWYWx1ZShuYW1lKQ0KDQoJCURpbSBuLGkNCgkJaT0wDQoJCUZvciBFYWNoIG4gSW4gbmFtZXMNCg0KCQkJSWYgTENhc2Uobik9TENhc2UobmFtZSkgVGhlbg0KCQkJCUdldFZhbHVlID0gdmJzdW5lc2NhcGUodmFsdWVzKGkpKQ0KCQkJCUV4aXQgZnVuY3Rpb24NCgkJCUVuZCBJZg0KCQkJaT1pKzENCgkJTmV4dA0KDQoJCUdldFZhbHVlID0gRW1wdHkNCglFbmQgRnVuY3Rpb24NCg0KCVB1YmxpYyBGdW5jdGlvbiBSZW1vdmUobmFtZSkNCg0KCQlEaW0gbigpDQoJCURpbSB2KCkNCgkJRGltIGINCg0KCQlSZURpbSBuKFVCb3VuZChuYW1lcykpDQoJCVJlRGltIHYoVUJvdW5kKG5hbWVzKSkNCg0KCQlEaW0gaSxqDQoJCWo9MA0KCQlGb3IgaT0wIFRvIFVCb3VuZChuYW1lcykNCgkJCUlmIExDYXNlKG5hbWVzKGkpKT1MQ2FzZShuYW1lKSBUaGVuDQoJCQkJYj1UcnVlDQoJCQlFbHNlDQoJCQkJbihqKT1uYW1lcyhpKQ0KCQkJCXYoaik9dmFsdWVzKGkpDQoJCQkJaj1qKzENCgkJCUVuZCBJZg0KCQlOZXh0DQoNCgkJSWYgYj1UcnVlIFRoZW4NCg0KCQkJUmVEaW0gbmFtZXMoai0xKQ0KCQkJUmVEaW0gdmFsdWVzKGotMSkNCg0KCQkJRm9yIGk9MCBUbyBqLTENCgkJCQluYW1lcyhpKT1uKGkpDQoJCQkJdmFsdWVzKGkpPXYoaSkNCgkJCU5leHQNCg0KCQlFbmQgSWYNCg0KCUVuZCBGdW5jdGlvbg0KDQoJUHVibGljIEZ1bmN0aW9uIEV4aXN0cyhuYW1lKQ0KDQoJCUlmIE5hbWU9IiIgVGhlbiBFeGl0IEZ1bmN0aW9uDQoNCgkJRGltIHMNCgkJRm9yIEVhY2ggcyBJbiBuYW1lcw0KCQkJSWYgTENhc2Uocyk9TENhc2UobmFtZSkgVGhlbg0KCQkJCUV4aXN0cz1UcnVlDQoJCQkJRXhpdCBGdW5jdGlvbg0KCQkJRW5kIElmDQoJCU5leHQNCg0KCQlFeGlzdHM9RmFsc2UNCg0KCUVuZCBGdW5jdGlvbg0KDQoJUHJpdmF0ZSBTdWIgQ2xhc3NfSW5pdGlhbGl6ZSgpDQoNCgkJUmVEaW0gTmFtZXMoMCkNCgkJUmVEaW0gVmFsdWVzKDApDQoNCglFbmQgU3ViDQoNCkVuZCBDbGFzcw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQoNCg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICDlrprkuYlUQ29uZmlnDQonIOi+k+WFpe+8miAgICDml6ANCicg6L+U5Zue77yaICAgIOaXoA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KQ2xhc3MgVENvbmZpZw0KDQoJUHJpdmF0ZSBOYW1lDQoNCglQdWJsaWMgTWV0YQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBDb3VudA0KCQlDb3VudCA9IE1ldGEuQ291bnQNCglFbmQgUHJvcGVydHkNCg0KCVB1YmxpYyBGdW5jdGlvbiBTYXZlKCkNCg0KCQlEaW0gbixzDQoJCW49RmlsdGVyU1FMKE5hbWUpDQoJCXM9RmlsdGVyU1FMKE1ldGEuU2F2ZVN0cmluZykNCg0KCQlEaW0gb2JqUlMNCgkJU2V0IG9ialJTPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFtjb25mX05hbWVdIEZST00gW2Jsb2dfQ29uZmlnXSBXSEVSRSBbY29uZl9OYW1lXT0nIiZuJiInIiApDQoJCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCgkJCW9iakNvbm4uRXhlY3V0ZSgiVVBEQVRFIFtibG9nX0NvbmZpZ10gU0VUIFtjb25mX1ZhbHVlXT0nIiZzJiInIFdIRVJFIFtjb25mX05hbWVdPSciJm4mIiciKQ0KCQlFbHNlDQoJCQlvYmpDb25uLkV4ZWN1dGUoIklOU0VSVCBJTlRPIFtibG9nX0NvbmZpZ10oW2NvbmZfTmFtZV0sW2NvbmZfVmFsdWVdKSBWQUxVRVMgKCciJm4mIicsJyImcyYiJykiKQ0KCQlFbmQgSWYNCgkJU2V0IG9ialJTPU5vdGhpbmcNCg0KCUVuZCBGdW5jdGlvbg0KDQoJUHVibGljIEZ1bmN0aW9uIERlbGV0ZQ0KDQoJCW9iakNvbm4uRXhlY3V0ZSgiREVMRVRFIEZST00gW2Jsb2dfQ29uZmlnXSBXSEVSRSBbY29uZl9OYW1lXT0nIiZOYW1lJiInIikNCg0KCUVuZCBGdW5jdGlvbg0KDQoJUHVibGljIEZ1bmN0aW9uIExvYWQoY29uZmlnbmFtZSkNCg0KCQlDYWxsIEdldENvbmZpZ3MoKQ0KDQoJCU5hbWU9Y29uZmlnbmFtZQ0KDQoJCURpbSBzDQoJCUZvciBFYWNoIHMgSW4gQ29uZmlnTWV0YXMuTmFtZXMNCgkJCUlmIExDYXNlKHMpPUxDYXNlKE5hbWUpIFRoZW4NCgkJCQlNZXRhLkxvYWRTdHJpbmc9Q29uZmlnTWV0YXMuR2V0VmFsdWUoTmFtZSkNCgkJCUVuZCBJZg0KCQlOZXh0DQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJUHVibGljIEZ1bmN0aW9uIFdyaXRlKG5hbWUsdmFsdWUpDQoJCUlmIFR5cGVOYW1lKHZhbHVlKT0iQm9vbGVhbiIgQW5kIFVDYXNlKHZhbHVlKT1VQ2FzZSgidHJ1ZSIpIFRoZW4gdmFsdWU9IlRydWUiDQoJCUlmIFR5cGVOYW1lKHZhbHVlKT0iQm9vbGVhbiIgQW5kICBVQ2FzZSh2YWx1ZSk9VUNhc2UoImZhbHNlIikgVGhlbiB2YWx1ZT0iRmFsc2UiDQoJCVdyaXRlPU1ldGEuU2V0VmFsdWUobmFtZSx2YWx1ZSkNCg0KCUVuZCBGdW5jdGlvbg0KDQoJUHVibGljIEZ1bmN0aW9uIFJlYWQobmFtZSkNCg0KCQlSZWFkPU1ldGEuR2V0VmFsdWUobmFtZSkNCg0KCUVuZCBGdW5jdGlvbg0KDQoJUHVibGljIEZ1bmN0aW9uIFJlbW92ZShuYW1lKQ0KDQoJCVJlbW92ZT1NZXRhLlJlbW92ZShuYW1lKQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCVB1YmxpYyBGdW5jdGlvbiBFeGlzdHMobmFtZSkNCg0KCQlFeGlzdHM9TWV0YS5FeGlzdHMobmFtZSkNCg0KCUVuZCBGdW5jdGlvbg0KDQoNCglQcml2YXRlIFN1YiBDbGFzc19Jbml0aWFsaXplKCkNCg0KCQlOYW1lPUVtcHR5DQoNCgkJU2V0IE1ldGE9TmV3IFRNZXRhDQoNCglFbmQgU3ViDQoNCkVuZCBDbGFzcw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICDlrprkuYnmqKHlnZflip/og73nsbsNCicg6L6T5YWl77yaICAgIOaXoA0KJyDov5Tlm57vvJogICAg5pegDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpDbGFzcyBURnVuY3Rpb24NCg0KCVB1YmxpYyBJRA0KCVB1YmxpYyBOYW1lDQoJUHVibGljIEZpbGVOYW1lDQoJUHVibGljIE9yZGVyDQoJUHVibGljIENvbnRlbnQNCglQdWJsaWMgSXNIaWRkZW4NCglQdWJsaWMgU2lkZWJhcklEDQoJUHVibGljIEh0bWxJRA0KCVB1YmxpYyBGdHlwZSAnZGl2IG9yIHVsDQoJUHVibGljIE1heExpDQoJUHVibGljIE1ldGENCglQdWJsaWMgU291cmNlDQoJUHVibGljIFZpZXdUeXBlDQoJUHVibGljIEluRGF0YUJhc2UNCglQdWJsaWMgSXNIaWRlVGl0bGUNCg0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgSXNEaXNwbGF5DQoJCUlzRGlzcGxheT1Ob3QgSXNIaWRkZW4NCglFbmQgUHJvcGVydHkNCg0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgSXNTeXN0ZW0NCgkJSWYgU291cmNlPSJzeXN0ZW0iIFRoZW4NCgkJCUlzU3lzdGVtPVRydWUNCgkJRWxzZQ0KCQkJSXNTeXN0ZW09RmFsc2UNCgkJRW5kIElmDQoJRW5kIFByb3BlcnR5DQoJUHVibGljIFByb3BlcnR5IExldCBJc1N5c3RlbShzKQ0KCQlJZiBzPVRydWUgVGhlbg0KCQkJU291cmNlPSJzeXN0ZW0iDQoJCUVuZCBJZg0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBJc1VzZXJzDQoJCUlmIFNvdXJjZT0idXNlcnMiIFRoZW4NCgkJCUlzVXNlcnM9VHJ1ZQ0KCQlFbHNlDQoJCQlJc1VzZXJzPUZhbHNlDQoJCUVuZCBJZg0KCUVuZCBQcm9wZXJ0eQ0KCVB1YmxpYyBQcm9wZXJ0eSBMZXQgSXNVc2VycyhzKQ0KCQlJZiBzPVRydWUgVGhlbg0KCQkJU291cmNlPSJ1c2VycyINCgkJRW5kIElmDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IElzUGx1Z2luDQoJCUlmIEluU3RyKFNvdXJjZSwicGx1Z2luXyIpPjAgVGhlbg0KCQkJSXNQbHVnaW49VHJ1ZQ0KCQlFbHNlDQoJCQlJc1BsdWdpbj1GYWxzZQ0KCQlFbmQgSWYNCglFbmQgUHJvcGVydHkNCglQdWJsaWMgUHJvcGVydHkgTGV0IElzUGx1Z2luKHMpDQoJCVNvdXJjZT0icGx1Z2luXyImcw0KCUVuZCBQcm9wZXJ0eQ0KCQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBJc1RoZW1lDQoJCUlmIEluU3RyKFNvdXJjZSwidGhlbWVfIik+MCBUaGVuDQoJCQlJc1RoZW1lPVRydWUNCgkJRWxzZQ0KCQkJSXNUaGVtZT1GYWxzZQ0KCQlFbmQgSWYNCglFbmQgUHJvcGVydHkNCglQdWJsaWMgUHJvcGVydHkgTGV0IElzVGhlbWUocykNCgkJU291cmNlPSJ0aGVtZV8iJnMNCglFbmQgUHJvcGVydHkNCg0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgU291cmNlVHlwZQ0KCQlJZiBTb3VyY2U9InN5c3RlbSIgVGhlbg0KCQkJU291cmNlVHlwZT0ic3lzdGVtIg0KCQlFbmQgSWYNCgkJSWYgU291cmNlPSJ1c2VycyIgVGhlbg0KCQkJU291cmNlVHlwZT0idXNlcnMiDQoJCUVuZCBJZg0KCQlJZiBJblN0cihTb3VyY2UsInBsdWdpbl8iKT4wIFRoZW4NCgkJCVNvdXJjZVR5cGU9InBsdWdpbiINCgkJRW5kIElmDQoJCUlmIEluU3RyKFNvdXJjZSwidGhlbWVfIik+MCBUaGVuDQoJCQlTb3VyY2VUeXBlPSJ0aGVtZSINCgkJRW5kIElmDQoJCUlmIFNvdXJjZT0ib3RoZXIiIFRoZW4NCgkJCVNvdXJjZVR5cGU9Im90aGVyIg0KCQlFbmQgSWYNCglFbmQgUHJvcGVydHkNCg0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgSXNPdGhlcg0KCQlJZiBTb3VyY2U9Im90aGVyIiBUaGVuDQoJCQlJc090aGVyPVRydWUNCgkJRWxzZQ0KCQkJSXNPdGhlcj1GYWxzZQ0KCQlFbmQgSWYNCglFbmQgUHJvcGVydHkNCglQdWJsaWMgUHJvcGVydHkgTGV0IElzT3RoZXIocykNCgkJSWYgcz1UcnVlIFRoZW4NCgkJCVNvdXJjZT0ib3RoZXIiDQoJCUVuZCBJZg0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBBcHBOYW1lDQoJCUlmIFNvdXJjZVR5cGU9InBsdWdpbiIgVGhlbg0KCQkJQXBwTmFtZT1SaWdodChTb3VyY2UsTGVuKFNvdXJjZSktTGVuKCJwbHVnaW5fIikpDQoJCUVsc2VJZiBTb3VyY2VUeXBlPSJ0aGVtZSIgVGhlbg0KCQkJQXBwTmFtZT1SaWdodChTb3VyY2UsTGVuKFNvdXJjZSktTGVuKCJ0aGVtZV8iKSkNCgkJRWxzZQ0KCQkJQXBwTmFtZT0iIg0KCQlFbmQgSWYNCglFbmQgUHJvcGVydHkNCg0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgTWV0YVN0cmluZw0KCQlNZXRhU3RyaW5nPU1ldGEuU2F2ZVN0cmluZw0KCUVuZCBQcm9wZXJ0eQ0KCVB1YmxpYyBQcm9wZXJ0eSBMZXQgTWV0YVN0cmluZyhzKQ0KCQlNZXRhLkxvYWRTdHJpbmc9cw0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIEZ1bmN0aW9uIFBvc3QoKQ0KDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9URnVuY3Rpb25fUG9zdChJRCxOYW1lLEZpbGVOYW1lLE9yZGVyLENvbnRlbnQsSXNIaWRkZW4sU2lkZWJhcklELEh0bWxJRCxGdHlwZSxNYXhMaSxTb3VyY2UsVmlld1R5cGUsSXNIaWRlVGl0bGUsTWV0YVN0cmluZykNCg0KCQlDYWxsIENoZWNrUGFyYW1ldGVyKElELCJpbnQiLDApDQoJCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoT3JkZXIsImludCIsMCkNCgkJQ2FsbCBDaGVja1BhcmFtZXRlcihTaWRlYmFySUQsImludCIsMSkNCgkJQ2FsbCBDaGVja1BhcmFtZXRlcihJc0hpZGRlbiwiYm9vbCIsRmFsc2UpDQoJCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoSXNIaWRlVGl0bGUsImJvb2wiLEZhbHNlKQ0KCQlDYWxsIENoZWNrUGFyYW1ldGVyKE1heExpLCJpbnQiLDApDQoNCgkJTmFtZT1GaWx0ZXJTUUwoTmFtZSkNCgkJRmlsZU5hbWU9VHJhbnNmZXJIVE1MKExDYXNlKEZpbHRlclNRTChGaWxlTmFtZSkpLCJbZGVsc3BhY2VdW2ZpbGVuYW1lXVtub3JtYWxuYW1lXSIpDQoJCUZpbGVOYW1lPVJlcGxhY2UoRmlsZU5hbWUsIi4iLCIiKQ0KCQlIdG1sSUQ9VHJhbnNmZXJIVE1MKEZpbHRlclNRTChIdG1sSUQpLCJbZGVsc3BhY2VdW2ZpbGVuYW1lXSIpDQoJCVNvdXJjZT1GaWx0ZXJTUUwoU291cmNlKQ0KCQlWaWV3VHlwZT1GaWx0ZXJTUUwoVmlld1R5cGUpDQoNCgkJSWYgTmFtZT0iIiBUaGVuDQoJCQlOYW1lPSJGdW5jdGlvbiINCgkJRW5kIElmDQoNCgkJSWYgRmlsZU5hbWU9IiIgVGhlbg0KCQkJSWYgSUQ9MCBUaGVuDQoJCQkJRmlsZU5hbWU9ImZ1bmN0aW9uIiYgR2V0TmV3SUQNCgkJCUVsc2UNCgkJCQlGaWxlTmFtZT0iZnVuY3Rpb24iICYgSUQNCgkJCUVuZCBJZg0KCQlFbmQgSWYNCg0KCQlJZiBIdG1sSUQ9IiIgVGhlbg0KCQkJSWYgSUQ9MCBUaGVuIA0KCQkJCUh0bWxJRD0iZGl2RnVuY3Rpb24iICYgR2V0TmV3SUQNCgkJCUVsc2UNCgkJCQlIdG1sSUQ9ImRpdkZ1bmN0aW9uIiAmIElEDQoJCQlFbmQgSWYNCgkJRW5kIElmDQoNCgkJSWYgT3JkZXI9MCBUaGVuDQoJCQlPcmRlcj1HZXROZXdPcmRlcg0KCQlFbmQgSWYNCg0KCQlJZiBTb3VyY2U9IiIgVGhlbg0KCQkJU291cmNlPSJ1c2VycyINCgkJRW5kIElmDQoNCgkJTmFtZT1MZWZ0KE5hbWUsNTApDQoJCUZpbGVOYW1lPUxlZnQoRmlsZU5hbWUsNTApDQoJCUh0bWxJRD1MZWZ0KEh0bWxJRCw1MCkNCg0KCQlJZiBGdHlwZTw+ImRpdiIgQW5kIEZ0eXBlPD4idWwiIFRoZW4gRnR5cGU9ImRpdiINCg0KCQlEaW0gc0NvbnRlbnQNCgkJc0NvbnRlbnQ9Q29udGVudA0KCQlDb250ZW50PUZpbHRlclNRTChDb250ZW50KQ0KCQlDb250ZW50PVRyYW5zZmVySFRNTChDb250ZW50LCJbYW50aS16Y19ibG9nX2hvc3RdIikNCg0KCQkNCgkJSWYgSUQ9MCBPciAoSW5EYXRhQmFzZT1GYWxzZSBBbmQgU291cmNlPD4ib3RoZXIiKSBUaGVuDQoJCQlvYmpDb25uLkV4ZWN1dGUoIklOU0VSVCBJTlRPIFtibG9nX0Z1bmN0aW9uXShbZm5fTmFtZV0sW2ZuX0ZpbGVOYW1lXSxbZm5fT3JkZXJdLFtmbl9Db250ZW50XSxbZm5fSXNIaWRkZW5dLFtmbl9TaWRlYmFySURdLFtmbl9IdG1sSURdLFtmbl9GdHlwZV0sW2ZuX01heExpXSxbZm5fU291cmNlXSxbZm5fVmlld1R5cGVdLFtmbl9Jc0hpZGVUaXRsZV0sW2ZuX01ldGFdKSBWQUxVRVMgKCciJk5hbWUmIicsJyImRmlsZU5hbWUmIicsIiZPcmRlciYiLCciJkNvbnRlbnQmIicsIiZDTG5nKElzSGlkZGVuKSYiLCImU2lkZWJhcklEJiIsJyImSHRtbElEJiInLCciJkZ0eXBlJiInLCImTWF4TGkmIiwnIiZTb3VyY2UmIicsJyImVmlld1R5cGUmIicsIiZDTG5nKElzSGlkZVRpdGxlKSYiLCciJk1ldGFTdHJpbmcmIicpIikNCg0KCQkJRGltIG9ialJTDQoJCQlTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgTUFYKFtmbl9JRF0pIEZST00gW2Jsb2dfRnVuY3Rpb25dIikNCgkJCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCgkJCQlJRD1vYmpSUygwKQ0KCQkJCUluRGF0YUJhc2U9VHJ1ZQ0KCQkJRW5kIElmDQoNCgkJRWxzZQ0KCQkJSWYgSW5EYXRhQmFzZSBUaGVuDQoJCQkJb2JqQ29ubi5FeGVjdXRlKCJVUERBVEUgW2Jsb2dfRnVuY3Rpb25dIFNFVCBbZm5fTmFtZV09JyImTmFtZSYiJyxbZm5fRmlsZU5hbWVdPSciJkZpbGVOYW1lJiInLFtmbl9PcmRlcl09IiZPcmRlciYiLFtmbl9Db250ZW50XT0nIiZDb250ZW50JiInLFtmbl9Jc0hpZGRlbl09IiZDTG5nKElzSGlkZGVuKSYiLFtmbl9TaWRlYmFySURdPSImU2lkZWJhcklEJiIsW2ZuX0h0bWxJRF09JyImSHRtbElEJiInLFtmbl9GdHlwZV09JyImRnR5cGUmIicsW2ZuX01heExpXT0iJk1heExpJiIsW2ZuX1NvdXJjZV09JyImU291cmNlJiInLFtmbl9WaWV3VHlwZV09JyImVmlld1R5cGUmIicsW2ZuX0lzSGlkZVRpdGxlXT0iJkNMbmcoSXNIaWRlVGl0bGUpJiIsW2ZuX01ldGFdPSciJk1ldGFTdHJpbmcmIicgV0hFUkUgW2ZuX0lEXSA9IiAmIElEKQ0KCQkJRW5kIElmCQkNCgkJRW5kIElmDQoNCgkJQ29udGVudD1zQ29udGVudA0KDQoJCVBvc3Q9VHJ1ZQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCVB1YmxpYyBGdW5jdGlvbiBMb2FkSW5mb0J5SUQoZm5fSUQpDQoNCgkJQ2FsbCBDaGVja1BhcmFtZXRlcihmbl9JRCwiaW50IiwwKQ0KDQoJCURpbSBvYmpSUw0KCQlTZXQgb2JqUlM9b2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgW2ZuX0lEXSxbZm5fTmFtZV0sW2ZuX0ZpbGVOYW1lXSxbZm5fT3JkZXJdLFtmbl9Db250ZW50XSxbZm5fSXNIaWRkZW5dLFtmbl9TaWRlYmFySURdLFtmbl9IdG1sSURdLFtmbl9GdHlwZV0sW2ZuX01heExpXSxbZm5fU291cmNlXSxbZm5fVmlld1R5cGVdLFtmbl9Jc0hpZGVUaXRsZV0sW2ZuX01ldGFdIEZST00gW2Jsb2dfRnVuY3Rpb25dIFdIRVJFIFtmbl9JRF09IiAmIGZuX0lEKQ0KDQoJCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCg0KCQkJSUQ9b2JqUlMoImZuX0lEIikNCgkJCU5hbWU9b2JqUlMoImZuX05hbWUiKQ0KCQkJRmlsZU5hbWU9b2JqUlMoImZuX0ZpbGVOYW1lIikNCgkJCU9yZGVyPW9ialJTKCJmbl9PcmRlciIpDQoJCQlDb250ZW50PW9ialJTKCJmbl9Db250ZW50IikNCgkJCUlzSGlkZGVuPW9ialJTKCJmbl9Jc0hpZGRlbiIpDQoJCQlTaWRlYmFySUQ9b2JqUlMoImZuX1NpZGViYXJJRCIpDQoJCQlIdG1sSUQ9b2JqUlMoImZuX0h0bWxJRCIpDQoJCQlGdHlwZT1vYmpSUygiZm5fRnR5cGUiKQ0KCQkJTWF4TGk9b2JqUlMoImZuX01heExpIikNCgkJCVNvdXJjZT1vYmpSUygiZm5fU291cmNlIikNCgkJCVZpZXdUeXBlPW9ialJTKCJmbl9WaWV3VHlwZSIpDQoJCQlJc0hpZGVUaXRsZT1vYmpSUygiZm5fSXNIaWRlVGl0bGUiKQ0KCQkJTWV0YVN0cmluZz1vYmpSUygiZm5fTWV0YSIpDQoNCgkJCUxvYWRJbmZvQnlJRD1UcnVlDQoJCQlJbkRhdGFCYXNlPVRydWUNCg0KCQlFbmQgSWYNCg0KCQlvYmpSUy5DbG9zZQ0KCQlTZXQgb2JqUlM9Tm90aGluZw0KDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9URnVuY3Rpb25fTG9hZEluZm9CeUlEKElELE5hbWUsRmlsZU5hbWUsT3JkZXIsQ29udGVudCxJc0hpZGRlbixTaWRlYmFySUQsSHRtbElELEZ0eXBlLE1heExpLFNvdXJjZSxWaWV3VHlwZSxJc0hpZGVUaXRsZSxNZXRhU3RyaW5nKQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KDQoJUHVibGljIEZ1bmN0aW9uIExvYWRJbmZvQnlBcnJheShhcnlDYXRlSW5mbykNCg0KCQlJZiBJc0FycmF5KGFyeUNhdGVJbmZvKT1UcnVlIFRoZW4NCgkJCUlEPWFyeUNhdGVJbmZvKDApDQoJCQlOYW1lPWFyeUNhdGVJbmZvKDEpDQoJCQlGaWxlTmFtZT1hcnlDYXRlSW5mbygyKQ0KCQkJT3JkZXI9YXJ5Q2F0ZUluZm8oMykNCgkJCUNvbnRlbnQ9YXJ5Q2F0ZUluZm8oNCkNCgkJCUlzSGlkZGVuPWFyeUNhdGVJbmZvKDUpDQoJCQlTaWRlYmFySUQ9YXJ5Q2F0ZUluZm8oNikNCgkJCUh0bWxJRD1hcnlDYXRlSW5mbyg3KQ0KCQkJRnR5cGU9YXJ5Q2F0ZUluZm8oOCkNCgkJCU1heExpPWFyeUNhdGVJbmZvKDkpDQoJCQlTb3VyY2U9YXJ5Q2F0ZUluZm8oMTApDQoJCQlWaWV3VHlwZT1hcnlDYXRlSW5mbygxMSkNCgkJCUlzSGlkZVRpdGxlPWFyeUNhdGVJbmZvKDEyKQ0KCQkJTWV0YVN0cmluZz1hcnlDYXRlSW5mbygxMykNCgkJRW5kIElmDQoNCgkJTG9hZEluZm9CeUFycmF5PVRydWUNCgkJSW5EYXRhQmFzZT1UcnVlDQoNCgkJQ2FsbCBGaWx0ZXJfUGx1Z2luX1RGdW5jdGlvbl9Mb2FkSW5mb0J5QXJyYXkoSUQsTmFtZSxGaWxlTmFtZSxPcmRlcixDb250ZW50LElzSGlkZGVuLFNpZGViYXJJRCxIdG1sSUQsRnR5cGUsTWF4TGksU291cmNlLFZpZXdUeXBlLElzSGlkZVRpdGxlLE1ldGFTdHJpbmcpDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJUHVibGljIEZ1bmN0aW9uIEdldE5ld0lEKCkNCg0KCQlHZXROZXdJRD1DTG5nKG9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIFRPUCAxIFtmbl9JRF0gRlJPTSBbYmxvZ19GdW5jdGlvbl0gT1JERVIgQlkgW2ZuX0lEXSBERVNDIikoMCkpKzENCg0KCUVuZCBGdW5jdGlvbg0KDQoNCglQdWJsaWMgRnVuY3Rpb24gR2V0TmV3T3JkZXIoKQ0KDQoJCUdldE5ld09yZGVyPUNMbmcob2JqQ29ubi5FeGVjdXRlKCJTRUxFQ1QgVE9QIDEgW2ZuX09yZGVyXSBGUk9NIFtibG9nX0Z1bmN0aW9uXSBPUkRFUiBCWSBbZm5fT3JkZXJdIERFU0MiKSgwKSkrMQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCVB1YmxpYyBGdW5jdGlvbiBJblNpZGViYXJzKG51bSkNCgkJSWYgbnVtPTEgVGhlbiBJblNpZGViYXJzPUluU2lkZWJhcg0KCQlJZiBudW09MiBUaGVuIEluU2lkZWJhcnM9SW5TaWRlYmFyMg0KCQlJZiBudW09MyBUaGVuIEluU2lkZWJhcnM9SW5TaWRlYmFyMw0KCQlJZiBudW09NCBUaGVuIEluU2lkZWJhcnM9SW5TaWRlYmFyNA0KCQlJZiBudW09NSBUaGVuIEluU2lkZWJhcnM9SW5TaWRlYmFyNQ0KCUVuZCBGdW5jdGlvbg0KDQoNCglQdWJsaWMgRnVuY3Rpb24gSW5TaWRlYmFyKCkNCgkJSWYgU2lkZWJhcklEPS0xIFRoZW4gSW5TaWRlYmFyPUZhbHNlOkV4aXQgRnVuY3Rpb24NCgkJSW5TaWRlYmFyPShSb3VuZChSaWdodChTaWRlYmFySUQsMSkvMSk9MSkNCglFbmQgRnVuY3Rpb24NCg0KCVB1YmxpYyBGdW5jdGlvbiBJblNpZGViYXIyKCkNCgkJSWYgU2lkZWJhcklEPS0xIFRoZW4gSW5TaWRlYmFyMj1GYWxzZTpFeGl0IEZ1bmN0aW9uDQoJCUluU2lkZWJhcjI9KFJvdW5kKFJpZ2h0KFNpZGViYXJJRCwyKS8xMSk9MSkNCglFbmQgRnVuY3Rpb24NCg0KCVB1YmxpYyBGdW5jdGlvbiBJblNpZGViYXIzKCkNCgkJSWYgU2lkZWJhcklEPS0xIFRoZW4gSW5TaWRlYmFyMz1GYWxzZTpFeGl0IEZ1bmN0aW9uDQoJCUluU2lkZWJhcjM9KFJvdW5kKFJpZ2h0KFNpZGViYXJJRCwzKS8xMTEpPTEpDQoJRW5kIEZ1bmN0aW9uDQoNCglQdWJsaWMgRnVuY3Rpb24gSW5TaWRlYmFyNCgpDQoJCUlmIFNpZGViYXJJRD0tMSBUaGVuIEluU2lkZWJhcjQ9RmFsc2U6RXhpdCBGdW5jdGlvbg0KCQlJblNpZGViYXI0PShSb3VuZChSaWdodChTaWRlYmFySUQsNCkvMTExMSk9MSkNCglFbmQgRnVuY3Rpb24NCg0KCVB1YmxpYyBGdW5jdGlvbiBJblNpZGViYXI1KCkNCgkJSWYgU2lkZWJhcklEPS0xIFRoZW4gSW5TaWRlYmFyNT1GYWxzZTpFeGl0IEZ1bmN0aW9uDQoJCUluU2lkZWJhcjU9KFJvdW5kKFJpZ2h0KFNpZGViYXJJRCw1KS8xMTExMSk9MSkNCglFbmQgRnVuY3Rpb24NCg0KDQoNCglQdWJsaWMgRnVuY3Rpb24gTWFrZVRlbXBsYXRlKHN0ckZ1bmN0aW9uKQ0KDQoJCURpbSBodG1sLGksaixzLFJFDQoJCWh0bWw9c3RyRnVuY3Rpb24NCg0KCQlTZXQgUkUgPSBOZXcgUmVnRXhwIA0KCQlSRS5JZ25vcmVDYXNlID0gVHJ1ZSANCgkJUkUuR2xvYmFsID0gVHJ1ZSANCg0KCQlJZiBJc0hpZGVUaXRsZT1UcnVlIFRoZW4gDQoJCQlSRS5QYXR0ZXJuID0gIjwjdGVtcGxhdGU6ZnVuY3Rpb25fdGl0bGU6YmVnaW4jPigufFxuKSo8I3RlbXBsYXRlOmZ1bmN0aW9uX3RpdGxlOmVuZCM+Ig0KCQkJaHRtbCA9IFJFLlJlcGxhY2UoaHRtbCwgIiIpDQoJCUVsc2UNCgkJCWh0bWw9UmVwbGFjZShodG1sLCI8I3RlbXBsYXRlOmZ1bmN0aW9uX3RpdGxlOmJlZ2luIz4iLCIiKQ0KCQkJaHRtbD1SZXBsYWNlKGh0bWwsIjwjdGVtcGxhdGU6ZnVuY3Rpb25fdGl0bGU6ZW5kIz4iLCIiKQ0KCQlFbmQgSWYNCg0KCQlJZiBGdHlwZT0iZGl2IiBUaGVuDQoJCQlzPSI8ZGl2PjwjQ0FDSEVfSU5DTFVERV8iICYgVUNhc2UoRmlsZU5hbWUpICYgIiM+PC9kaXY+Ig0KCQkJSWYgVmlld1R5cGU9ImpzIiBUaGVuDQoJCQkJcz0iPGRpdj48I0NBQ0hFX0lOQ0xVREVfIiAmIFVDYXNlKEZpbGVOYW1lKSAmICJfSlMjPjwvZGl2PiINCgkJCUVuZCBJZg0KCQkJSWYgVmlld1R5cGU9Imh0bWwiIFRoZW4NCgkJCQlzPSI8ZGl2PjwjQ0FDSEVfSU5DTFVERV8iICYgVUNhc2UoRmlsZU5hbWUpICYgIl9IVE1MIz48L2Rpdj4iDQoJCQlFbmQgSWYNCgkJRW5kIElmDQoNCgkJSWYgRnR5cGU9InVsIiBUaGVuDQoJCQlzPSI8dWw+PCNDQUNIRV9JTkNMVURFXyIgJiBVQ2FzZShGaWxlTmFtZSkgJiAiIz48L3VsPiINCgkJCUlmIFZpZXdUeXBlPSJqcyIgVGhlbg0KCQkJCXM9Ijx1bD48I0NBQ0hFX0lOQ0xVREVfIiAmIFVDYXNlKEZpbGVOYW1lKSAmICJfSlMjPjwvdWw+Ig0KCQkJRW5kIElmDQoJCQlJZiBWaWV3VHlwZT0iaHRtbCIgVGhlbg0KCQkJCXM9Ijx1bD48I0NBQ0hFX0lOQ0xVREVfIiAmIFVDYXNlKEZpbGVOYW1lKSAmICJfSFRNTCM+PC91bD4iDQoJCQlFbmQgSWYNCgkJRW5kIElmDQoNCgkJJ3BsdWdpbiBub2RlDQoNCg0KCQlEaW0gYXJ5VGVtcGxhdGVUYWdzTmFtZSgpDQoJCURpbSBhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSgpDQoNCgkJUmVEaW0gYXJ5VGVtcGxhdGVUYWdzTmFtZSg1KQ0KCQlSZURpbSBhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSg1KQ0KDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoICAxKT0iZnVuY3Rpb24vaWQiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKCAxKT1JRA0KCQlhcnlUZW1wbGF0ZVRhZ3NOYW1lKCAgMik9ImZ1bmN0aW9uL25hbWUiDQoJCWFyeVRlbXBsYXRlVGFnc1ZhbHVlKCAyKT1OYW1lDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoICAzKT0iZnVuY3Rpb24vaHRtbGlkIg0KCQlhcnlUZW1wbGF0ZVRhZ3NWYWx1ZSggMyk9SHRtbElEDQoJCWFyeVRlbXBsYXRlVGFnc05hbWUoICA0KT0iZnVuY3Rpb24vY29udGVudCINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoIDQpPXMNCgkJYXJ5VGVtcGxhdGVUYWdzTmFtZSggIDUpPSJmdW5jdGlvbi9maWxlbmFtZSINCgkJYXJ5VGVtcGxhdGVUYWdzVmFsdWUoIDUpPUZpbGVOYW1lDQoNCg0KCQkncGx1Z2luIG5vZGUNCg0KDQoJCWo9VUJvdW5kKGFyeVRlbXBsYXRlVGFnc05hbWUpDQoJCUZvciBpPTEgdG8gag0KCQkJaHRtbD1SZXBsYWNlKGh0bWwsIjwjIiAmIGFyeVRlbXBsYXRlVGFnc05hbWUoaSkgJiAiIz4iLGFyeVRlbXBsYXRlVGFnc1ZhbHVlKGkpKQ0KCQlOZXh0DQoNCgkJTWFrZVRlbXBsYXRlPWh0bWwNCg0KCUVuZCBGdW5jdGlvbg0KDQoNCglQdWJsaWMgRnVuY3Rpb24gU2F2ZSgpDQoNCgkJQ2FsbCBQb3N0KCkNCgkJQ2FsbCBTYXZlRmlsZSgpDQoNCgkJU2F2ZT1UcnVlDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJUHVibGljIEZ1bmN0aW9uIFNhdmVGaWxlKCkNCg0KCQlJZiBGdHlwZT0idWwiIEFuZCBNYXhMaT4wIFRoZW4NCgkJCURpbSBpLGIsag0KCQkJYj1TcGxpdChDb250ZW50LCI8L2xpPiIpDQoJCQlJZiBVQm91bmQoYik+MCB0aGVuDQoJCQkJRm9yIGk9MCBUbyBVQm91bmQoYiktMQ0KCQkJCQlqPWorMQ0KCQkJCQliKGkpPWIoaSkgJiAiPC9saT4iDQoJCQkJCUlmIGo+TWF4bGkgVGhlbg0KCQkJCQkJYihpKT0iIg0KCQkJCQlFbmQgSWYNCgkJCQlOZXh0DQoJCQkJQ29udGVudD1Kb2luKGIsIiIpDQoJCQlFbmQgaWYNCgkJRW5kIElmDQoNCgkJSWYgSXNIaWRkZW49VHJ1ZSBUSGVuDQoJCQlDb250ZW50PSIiDQoJCUVsc2UNCgkJCUNvbnRlbnQ9VHJhbnNmZXJIVE1MKENvbnRlbnQsIlthbnRpLXpjX2Jsb2dfaG9zdF0iKQ0KCQlFbmQgSWYNCg0KCQlDYWxsIFNhdmVUb0ZpbGUoQmxvZ1BhdGggJiAiemJfdXNlcnMvaW5jbHVkZS8iJkZpbGVOYW1lJiIuYXNwIixDb250ZW50LCJ1dGYtOCIsRmFsc2UpDQoNCgkJU2F2ZUZpbGU9VHJ1ZQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KCVB1YmxpYyBGdW5jdGlvbiBEZWwoKQ0KDQoJCUNhbGwgRmlsdGVyX1BsdWdpbl9URnVuY3Rpb25fRGVsKElELE5hbWUsRmlsZU5hbWUsT3JkZXIsQ29udGVudCxJc0hpZGRlbixTaWRlYmFySUQsSHRtbElELEZ0eXBlLE1heExpLFNvdXJjZSxWaWV3VHlwZSxJc0hpZGVUaXRsZSxNZXRhU3RyaW5nKQ0KDQoJCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoSUQsImludCIsMCkNCg0KCQlJZiAoSUQ9MCkgVGhlbiBEZWw9RmFsc2U6RXhpdCBGdW5jdGlvbg0KDQoJCW9iakNvbm4uRXhlY3V0ZSgiREVMRVRFIEZST00gW2Jsb2dfRnVuY3Rpb25dIFdIRVJFIFtmbl9JRF0gPSIgJiBJRCkNCgkJDQoJCUluRGF0YUJhc2U9RmFsc2UNCg0KCQlDYWxsIERlbEZpbGUoKQ0KDQoJCURlbD1UcnVlDQoNCglFbmQgRnVuY3Rpb24NCg0KDQoJUHVibGljIEZ1bmN0aW9uIERlbEZpbGUoKQ0KDQoJCUNhbGwgRGVsVG9GaWxlKEJsb2dQYXRoICYgInpiX3VzZXJzL2luY2x1ZGUvIiAmIEZpbGVOYW1lICYgIi5hc3AiKQ0KDQoJRW5kIEZ1bmN0aW9uDQoNCg0KDQoJUHJpdmF0ZSBTdWIgQ2xhc3NfSW5pdGlhbGl6ZSgpDQoJCUlEPTANCgkJRnR5cGU9ImRpdiINCgkJU2lkZWJhcklEPTENCgkJSXNIaWRkZW49RmFsc2UNCgkJSXNIaWRlVGl0bGU9RmFsc2UNCgkJTWF4TGk9MA0KCQlTb3VyY2U9InVzZXJzIg0KCQlJbkRhdGFCYXNlPUZhbHNlDQoJCVNldCBNZXRhPU5ldyBUTWV0YQ0KCUVuZCBTdWINCg0KDQpFbmQgQ2xhc3MNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyAgICAgICAgICAgICAgICAgICAgICAgIFRDb3VudGVyDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpDbGFzcyBUQ291bnRlcg0KDQoJUHVibGljIElEDQoJUHVibGljIElQDQoJUHVibGljIEFnZW50DQoJUHVibGljIENvbnRlbnQNCglQdWJsaWMgVXNlcklEDQoJUHVibGljIFBvc3RUaW1lDQoJUHVibGljIFBvc3REYXRhDQoJUHVibGljIFVSTA0KCVB1YmxpYyBSZWZlcmVyDQoJUHVibGljIEFsbFJlcXVlc3RIZWFkZXINCglQdWJsaWMgTmFtZQ0KDQoJUHVibGljIEZ1bmN0aW9uIExvYWRJbmZvQnlJZChuaWQpDQoJCUNhbGwgQ2hlY2tQYXJhbWV0ZXIobmlkLCJpbnQiLDApDQoJCURpbSBzdHJTUUwNCgkJc3RyU1FMPSJTRUxFQ1QgW2NvdW5fSURdLFtjb3VuX0lQXSxbY291bl9BZ2VudF0sW2NvdW5fUmVmZXJdLFtjb3VuX1Bvc3RUaW1lXSxbY291bl9Db250ZW50XSxbY291bl9Vc2VySURdLFtjb3VuX1Bvc3REYXRhXSxbY291bl9VUkxdLFtjb3VuX0FsbFJlcXVlc3RIZWFkZXJdLFtjb3VuX2xvZ05hbWVdIEZST00gW2Jsb2dfQ291bnRlcl0gV0hFUkUgW2NvdW5fSURdPSImbmlkDQoJCURpbSBvYmpScw0KCQlTZXQgb2JqUnM9b2JqQ29ubi5FeGVjdXRlKHN0cnNxbCkNCgkJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KCQkJSUQ9b2JqUnMoMCkNCgkJCUlQPXZic3VuZXNjYXBlKG9ialJzKDEpKQ0KCQkJQWdlbnQ9dmJzdW5lc2NhcGUob2JqUnMoMikpDQoJCQlSZWZlcmVyPXZic3VuZXNjYXBlKG9ialJzKDMpKQ0KCQkJUG9zdFRpbWU9b2JqUnMoNCkNCgkJCUNvbnRlbnQ9dmJzdW5lc2NhcGUob2JqUnMoNSkpDQoJCQlVc2VySUQ9b2JqUnMoNikNCgkJCVBvc3REYXRhPXZic3VuZXNjYXBlKG9ialJzKDcpKQ0KCQkJVVJMPXZic3VuZXNjYXBlKG9ialJzKDgpKQ0KCQkJQWxsUmVxdWVzdEhlYWRlcj12YnN1bmVzY2FwZShvYmpScyg5KSkNCgkJCU5hbWU9dmJzdW5lc2NhcGUob2JqUnMoMTApKQ0KCQkJTG9hZEluZm9CeUlkPVRydWUNCgkJRW5kIElmDQoJRW5kIEZ1bmN0aW9uDQoJDQoJUHVibGljIEZ1bmN0aW9uIExvYWRJbmZvQnlBcnJheShvYmpScykNCg0KCQlJZiBJc0FycmF5KG9ialJzKT1UcnVlIFRoZW4NCg0KCQkJSUQ9b2JqUnMoMCkNCgkJCUlQPXZic3VuZXNjYXBlKG9ialJzKDEpKQ0KCQkJQWdlbnQ9dmJzdW5lc2NhcGUob2JqUnMoMikpDQoJCQlSZWZlcmVyPXZic3VuZXNjYXBlKG9ialJzKDMpKQ0KCQkJUG9zdFRpbWU9b2JqUnMoNCkNCgkJCUNvbnRlbnQ9dmJzdW5lc2NhcGUob2JqUnMoNSkpDQoJCQlVc2VySUQ9b2JqUnMoNikNCgkJCVBvc3REYXRhPXZic3VuZXNjYXBlKG9ialJzKDcpKQ0KCQkJVVJMPXZic3VuZXNjYXBlKG9ialJzKDgpKQ0KCQkJQWxsUmVxdWVzdEhlYWRlcj12YnN1bmVzY2FwZShvYmpScyg5KSkNCgkJCVBvc3RUaW1lID0gWWVhcihQb3N0VGltZSkgJiAiLSIgJiBNb250aChQb3N0VGltZSkgJiAiLSIgJiBEYXkoUG9zdFRpbWUpICYgIiAiICYgSG91cihQb3N0VGltZSkgJiAiOiIgJiBNaW51dGUoUG9zdFRpbWUpICYgIjoiICYgU2Vjb25kKFBvc3RUaW1lKQ0KCQkJTmFtZT12YnN1bmVzY2FwZShvYmpScygxMCkpDQoJCQlMb2FkSW5mb0J5QXJyYXk9VHJ1ZQ0KCQlFbmQgSWYNCg0KDQoJRW5kIEZ1bmN0aW9uDQoNCglQdWJsaWMgRnVuY3Rpb24gQWRkKGIsYykNCgkJSVA9R2V0UmVhbGx5SVAoKQ0KCQlBZ2VudD1SZXF1ZXN0LlNlcnZlclZhcmlhYmxlcygiSFRUUF9VU0VSX0FHRU5UIikNCgkJUmVmZXJlcj1SZXF1ZXN0LlNlcnZlclZhcmlhYmxlcygiSFRUUF9SRUZFUkVSIikNCgkJUG9zdFRpbWU9Rm9ybWF0RGF0ZVRpbWUoTm93KQ0KCQlDb250ZW50PWMNCgkJVXNlcklEPUJsb2dVc2VyLklEDQoJCVBvc3REYXRhPUlJZihJSWYoSW5TdHIoTENhc2UoUmVxdWVzdC5TZXJ2ZXJWYXJpYWJsZXMoIkNPTlRFTlRfVFlQRSIpKSwibXVsdGlwYXJ0L2Zvcm0tZGF0YSIpPjAsVHJ1ZSxGYWxzZSksIkJpbmFyeSBQb3N0RGF0YSIsUmVxdWVzdC5Gb3JtKQ0KCQlVUkw9R2V0VXJsDQoJCU5hbWU9Yg0KCQlBbGxSZXF1ZXN0SGVhZGVyPVJlcXVlc3QuU2VydmVyVmFyaWFibGVzKCJBTExfSFRUUCIpDQoJCURpbSBqLGssaSxtDQoJCWo9QXJyYXkoSVAsQWdlbnQsUmVmZXJlcixQb3N0VGltZSxDb250ZW50LFVzZXJJRCxQb3N0RGF0YSxVUkwsQWxsUmVxdWVzdEhlYWRlcixOYW1lKQ0KCQlrPUFycmF5KCJjb3VuX0lQIiwiY291bl9BZ2VudCIsImNvdW5fUmVmZXIiLCJjb3VuX1Bvc3RUaW1lIiwiY291bl9Db250ZW50IiwiY291bl9Vc2VySUQiLCJjb3VuX1Bvc3REYXRhIiwiY291bl9VUkwiLCJjb3VuX0FsbFJlcXVlc3RIZWFkZXIiLCJjb3VuX2xvZ05hbWUiKQ0KCQltPSJJTlNFUlQgSU5UTyBbYmxvZ19Db3VudGVyXSgiDQoJCUZvciBpPTAgVG8gVWJvdW5kKGspLTENCgkJCW09bSYiWyImayhpKSYiXSwiDQoJCU5leHQNCgkJbT1tJiJbIiZrKGkpJiJdKSBWQUxVRVMoIg0KCQlGb3IgaT0wIFRvIFVib3VuZChqKS0xDQoJCQltPW0mIiciJklJZihpPTMgb3IgaT01LGooaSksdmJzZXNjYXBlKGooaSkpKSYiJywiDQoJCU5leHQNCgkJbT1tJiInIiZ2YnNlc2NhcGUoaihpKSkmIiciDQoJCW09bSYiKSINCgkJb2JqQ29ubi5FeGVjdXRlIG0NCgkJDQoJCUlEPW9iakNvbm4uRXhlY3V0ZSgiU0VMRUNUIE1BWChbY291bl9JRF0pIEZST00gW2Jsb2dfQ291bnRlcl0iKSgwKQ0KCUVuZCBGdW5jdGlvbg0KCQ0KCVB1YmxpYyBGdW5jdGlvbiBHZXRVcmwNCgkJR2V0VXJsPVJlcXVlc3QuU2VydmVyVmFyaWFibGVzKCJIVFRQX01FVEhPRCIpJiI6ICINCgkJR2V0VXJsPUdldFVybCZJSWYoTENhc2UoUmVxdWVzdC5TZXJ2ZXJWYXJpYWJsZXMoIkhUVFBTIikpPSJvZmYiLCJodHRwOi8vIiwiaHR0cHM6Ly8iKQ0KCQlHZXRVcmw9R2V0VXJsICYgUmVxdWVzdC5TZXJ2ZXJWYXJpYWJsZXMoIlNFUlZFUl9OQU1FIikgDQoJCUdldFVybD1JSWYoUmVxdWVzdC5TZXJ2ZXJWYXJpYWJsZXMoIlNFUlZFUl9QT1JUIik8PjgwLEdldFVybCYiOiImUmVxdWVzdC5TZXJ2ZXJWYXJpYWJsZXMoIlNFUlZFUl9QT1JUIiksR2V0VXJsKQ0KCQlHZXRVcmw9R2V0VXJsJlJlcXVlc3QuU2VydmVyVmFyaWFibGVzKCJVUkwiKSANCgkJR2V0VXJsPUlJZihUcmltKFJlcXVlc3QuUXVlcnlTdHJpbmcpPD4iIixHZXRVcmwmIj8iJlRyaW0oUmVxdWVzdC5RdWVyeVN0cmluZyksR2V0VXJsKSANCglFbmQgRnVuY3Rpb24NCg0KCUZ1bmN0aW9uIERlbE9sZChpbnRlcnZhbCwgb2xkKQ0KCQlJZiBaQ19NU1NRTF9FTkFCTEUgVGhlbg0KCQkJb2JqQ29ubi5FeGVjdXRlKCJERUxFVEUgRlJPTSBbYmxvZ19Db3VudGVyXSBXSEVSRSBEQVRFRElGRigiJmludGVydmFsJiIsW2NvdW5fUG9zdFRpbWVdLGdldGRhdGUoKSk+IiZvbGQpDQoJCUVsc2UNCgkJCW9iakNvbm4uRXhlY3V0ZSgiREVMRVRFIEZST00gW2Jsb2dfQ291bnRlcl0gV0hFUkUgREFURURJRkYoJyImaW50ZXJ2YWwmIicsW2NvdW5fUG9zdFRpbWVdLG5vdygpKT4iJm9sZCkNCgkJRW5kIElmDQoJRW5kIEZ1bmN0aW9uDQpFbmQgQ2xhc3MNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQonLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KJyoqKioqKioqKioqKioqICDpo47lo7AgQVNQIOaXoOe7hOS7tuS4iuS8oOexuyBWMi4xMSAgKioqKioqKioqKioqKg0KJ+S9nOiAhe+8mumjjuWjsA0KJ+e9keerme+8mmh0dHA6Ly93d3cuZm9uc2hlbi5jb20NCifpgq7ku7bvvJp3ZWJtYXN0ZXJAZm9uc2hlbi5jb20NCifniYjmnYPvvJrniYjmnYPlhajkvZMs5rqQ5Luj56CB5YWs5byALOWQhOenjeeUqOmAlOWdh+WPr+WFjei0ueS9v+eUqA0KJ+WFtuS7lu+8muacieeojeS9nOaUueWKqA0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCictLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQpDbGFzcyBVcExvYWRDbGFzcw0KDQoJUHJpdmF0ZSBtX1RvdGFsU2l6ZSxtX01heFNpemUsbV9GaWxlVHlwZSxtX1NhdmVQYXRoLG1fQXV0b1NhdmUsbV9FcnJvcixtX0NoYXJzZXQNCglQcml2YXRlIG1fZGljRm9ybSxtX2JpbkZvcm0sbV9iaW5JdGVtLG1fc3RyRGF0ZSxtX2xuZ1RpbWUNCglQdWJsaWMJRm9ybUl0ZW0sRmlsZUl0ZW0NCg0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgVmVyc2lvbg0KCQlWZXJzaW9uPSJGb25zaGVuIEFTUCBVcExvYWRDbGFzcyBWZXJzaW9uIDIuMTEiDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IEVycm9yDQoJCUVycm9yPW1fRXJyb3INCglFbmQgUHJvcGVydHkNCg0KCVB1YmxpYyBQcm9wZXJ0eSBHZXQgQ2hhcnNldA0KCQlDaGFyc2V0PW1fQ2hhcnNldA0KCUVuZCBQcm9wZXJ0eQ0KCVB1YmxpYyBQcm9wZXJ0eSBMZXQgQ2hhcnNldChzdHJDaGFyc2V0KQ0KCQltX0NoYXJzZXQ9c3RyQ2hhcnNldA0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBUb3RhbFNpemUNCgkJVG90YWxTaXplPW1fVG90YWxTaXplDQoJRW5kIFByb3BlcnR5DQoJUHVibGljIFByb3BlcnR5IExldCBUb3RhbFNpemUobG5nU2l6ZSkNCgkJaWYgaXNOdW1lcmljKGxuZ1NpemUpIHRoZW4gbV9Ub3RhbFNpemU9Q2xuZyhsbmdTaXplKQ0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBNYXhTaXplDQoJCU1heFNpemU9bV9NYXhTaXplDQoJRW5kIFByb3BlcnR5DQoJUHVibGljIFByb3BlcnR5IExldCBNYXhTaXplKGxuZ1NpemUpDQoJCWlmIGlzTnVtZXJpYyhsbmdTaXplKSB0aGVuIG1fTWF4U2l6ZT1DbG5nKGxuZ1NpemUpDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IEZpbGVUeXBlDQoJCUZpbGVUeXBlPW1fRmlsZVR5cGUNCglFbmQgUHJvcGVydHkNCglQdWJsaWMgUHJvcGVydHkgTGV0IEZpbGVUeXBlKHN0clR5cGUpDQoJCW1fRmlsZVR5cGU9c3RyVHlwZQ0KCUVuZCBQcm9wZXJ0eQ0KDQoJUHVibGljIFByb3BlcnR5IEdldCBTYXZlUGF0aA0KCQlTYXZlUGF0aD1tX1NhdmVQYXRoDQoJRW5kIFByb3BlcnR5DQoJUHVibGljIFByb3BlcnR5IExldCBTYXZlUGF0aChzdHJQYXRoKQ0KCQltX1NhdmVQYXRoPVJlcGxhY2Uoc3RyUGF0aCxjaHIoMCksIiIpDQoJRW5kIFByb3BlcnR5DQoNCglQdWJsaWMgUHJvcGVydHkgR2V0IEF1dG9TYXZlDQoJCUF1dG9TYXZlPW1fQXV0b1NhdmUNCglFbmQgUHJvcGVydHkNCglQdWJsaWMgUHJvcGVydHkgTGV0IEF1dG9TYXZlKGJ5VmFsIEZsYWcpDQoJCXNlbGVjdCBjYXNlIEZsYWcNCgkJCWNhc2UgMCwxLDI6IG1fQXV0b1NhdmU9RmxhZw0KCQllbmQgc2VsZWN0DQoJRW5kIFByb3BlcnR5DQoNCglQcml2YXRlIFN1YiBDbGFzc19Jbml0aWFsaXplDQoJCW1fRXJyb3IJICAgPSAtMQ0KCQltX0NoYXJzZXQgID0gImdiMjMxMiINCgkJbV9Ub3RhbFNpemU9IDANCgkJbV9NYXhTaXplICA9IDE1MzYwMA0KCQltX0ZpbGVUeXBlID0gImpwZy9naWYiDQoJCW1fU2F2ZVBhdGggPSAiIg0KCQltX0F1dG9TYXZlID0gMA0KCQlEaW0gZHRtTm93IDogZHRtTm93ID0gRGF0ZSgpDQoJCW1fc3RyRGF0ZSAgPSBZZWFyKGR0bU5vdykmUmlnaHQoIjAiJk1vbnRoKGR0bU5vdyksMikmUmlnaHQoIjAiJkRheShkdG1Ob3cpLDIpDQoJCW1fbG5nVGltZSAgPSBDbG5nKFRpbWVyKCkqMTAwMCkNCgkJU2V0IG1fYmluRm9ybSA9IFNlcnZlci5DcmVhdGVPYmplY3QoIkFET0RCLlN0cmVhbSIpDQoJCVNldCBtX2Jpbkl0ZW0gPSBTZXJ2ZXIuQ3JlYXRlT2JqZWN0KCJBRE9EQi5TdHJlYW0iKQ0KCQlTZXQgbV9kaWNGb3JtID0gU2VydmVyLkNyZWF0ZU9iamVjdCgiU2NyaXB0aW5nLkRpY3Rpb25hcnkiKQ0KCQltX2RpY0Zvcm0uQ29tcGFyZU1vZGUgPSAxDQoJRW5kIFN1Yg0KDQoJUHJpdmF0ZSBTdWIgQ2xhc3NfVGVybWluYXRlDQoJCW1fZGljRm9ybS5SZW1vdmVBbGwNCgkJU2V0IG1fZGljRm9ybSA9IG5vdGhpbmcNCgkJU2V0IG1fYmluSXRlbSA9IG5vdGhpbmcNCgkJbV9iaW5Gb3JtLkNsb3NlKCkNCgkJU2V0IG1fYmluRm9ybSA9IG5vdGhpbmcNCglFbmQgU3ViDQoNCglQdWJsaWMgRnVuY3Rpb24gT3BlbigpDQoJCU9wZW4gPSAwDQoJCWlmIG1fRXJyb3I9LTEgdGhlbg0KCQkJbV9FcnJvcj0wDQoJCWVsc2UNCgkJCUV4aXQgRnVuY3Rpb24NCgkJZW5kIGlmDQoJCURpbSBsbmdSZXF1ZXN0U2l6ZSA6IGxuZ1JlcXVlc3RTaXplPVJlcXVlc3QuVG90YWxCeXRlcw0KCQlpZiBtX1RvdGFsU2l6ZT4wIGFuZCBsbmdSZXF1ZXN0U2l6ZT5tX1RvdGFsU2l6ZSB0aGVuDQoJCQltX0Vycm9yPTUNCgkJCUV4aXQgRnVuY3Rpb24NCgkJZWxzZWlmIGxuZ1JlcXVlc3RTaXplPDEgdGhlbg0KCQkJbV9FcnJvcj00DQoJCQlFeGl0IEZ1bmN0aW9uDQoJCWVuZCBpZg0KDQoJCURpbSBsbmdDaHVua0J5dGUgOiBsbmdDaHVua0J5dGUgPSAxMDI0MDANCgkJRGltIGxuZ1JlYWRTaXplIDogbG5nUmVhZFNpemUgPSAwDQoJCW1fYmluRm9ybS5UeXBlID0gMQ0KCQltX2JpbkZvcm0uT3BlbigpDQoJCWRvDQoJCQltX2JpbkZvcm0uV3JpdGUgUmVxdWVzdC5CaW5hcnlSZWFkKGxuZ0NodW5rQnl0ZSkNCgkJCWxuZ1JlYWRTaXplPWxuZ1JlYWRTaXplK2xuZ0NodW5rQnl0ZQ0KCQkJaWYgIGxuZ1JlYWRTaXplID49IGxuZ1JlcXVlc3RTaXplIHRoZW4gZXhpdCBkbw0KCQlsb29wCQkNCgkJbV9iaW5Gb3JtLlBvc2l0aW9uPTANCgkJRGltIGJpblJlcXVlc3REYXRhIDogYmluUmVxdWVzdERhdGE9bV9iaW5Gb3JtLlJlYWQoKQ0KDQoJCURpbSBiQ3JMZixzdHJTZXBhcmF0b3IsaW50U2VwYXJhdG9yDQoJCWJDckxmPUNockIoMTMpJkNockIoMTApDQoJCWludFNlcGFyYXRvcj1JbnN0ckIoMSxiaW5SZXF1ZXN0RGF0YSxiQ3JMZiktMQ0KCQlzdHJTZXBhcmF0b3I9TGVmdEIoYmluUmVxdWVzdERhdGEsaW50U2VwYXJhdG9yKQ0KDQoJCURpbSBzdHJJdGVtLHN0ckluYW0sc3RyRnR5cCxzdHJQdXJpLHN0ckZuYW0sc3RyRmV4dCxsbmdGc2l6DQoJCUNvbnN0IHN0clNwbGl0PSInIiI+Ig0KCQlEaW0gc3RyRm9ybUl0ZW0sc3RyRmlsZUl0ZW0saW50VGVtcCxzdHJUZW1wDQoJCURpbSBwX3N0YXJ0IDogcF9zdGFydD1pbnRTZXBhcmF0b3IrMg0KCQlEaW0gcF9lbmQNCgkJRG8NCgkJCXBfZW5kID0gSW5TdHJCKHBfc3RhcnQsYmluUmVxdWVzdERhdGEsYkNyTGYmYkNyTGYpLTENCgkJCW1fYmluSXRlbS5UeXBlPTENCgkJCW1fYmluSXRlbS5PcGVuKCkNCgkJCW1fYmluRm9ybS5Qb3NpdGlvbj1wX3N0YXJ0DQoJCQltX2JpbkZvcm0uQ29weVRvIG1fYmluSXRlbSxwX2VuZC1wX3N0YXJ0DQoJCQltX2Jpbkl0ZW0uUG9zaXRpb249MA0KCQkJbV9iaW5JdGVtLlR5cGU9Mg0KCQkJbV9iaW5JdGVtLkNoYXJzZXQ9bV9DaGFyc2V0DQoJCQlzdHJJdGVtID0gbV9iaW5JdGVtLlJlYWRUZXh0KCkNCgkJCW1fYmluSXRlbS5DbG9zZSgpDQoJCQlpbnRUZW1wPUluc3RyKDM5LHN0ckl0ZW0sIiIiIikNCgkJCXN0ckluYW09TWlkKHN0ckl0ZW0sMzksaW50VGVtcC0zOSkNCg0KCQkJcF9zdGFydCA9IHBfZW5kICsgNA0KCQkJcF9lbmQgPSBJblN0ckIocF9zdGFydCxiaW5SZXF1ZXN0RGF0YSxzdHJTZXBhcmF0b3IpLTENCgkJCW1fYmluSXRlbS5UeXBlPTENCgkJCW1fYmluSXRlbS5PcGVuKCkNCgkJCW1fYmluRm9ybS5Qb3NpdGlvbj1wX3N0YXJ0DQoJCQlsbmdGc2l6PXBfZW5kLXBfc3RhcnQtMg0KCQkJbV9iaW5Gb3JtLkNvcHlUbyBtX2Jpbkl0ZW0sbG5nRnNpeg0KDQoNCgkJCWlmIEluc3RyKGludFRlbXAsc3RySXRlbSwiZmlsZW5hbWU9IiIiKTw+MCB0aGVuDQoJCQlpZiBub3QgbV9kaWNGb3JtLkV4aXN0cyhzdHJJbmFtJiJfRnJvbSIpIHRoZW4NCgkJCQlzdHJGaWxlSXRlbT1zdHJGaWxlSXRlbSZzdHJTcGxpdCZzdHJJbmFtDQoJCQkJaWYgbV9iaW5JdGVtLlNpemU8PjAgdGhlbg0KCQkJCQlpbnRUZW1wPWludFRlbXArMTMNCgkJCQkJc3RyRnR5cD1NaWQoc3RySXRlbSxJbnN0cihpbnRUZW1wLHN0ckl0ZW0sIkNvbnRlbnQtVHlwZTogIikrMTQpDQoJCQkJCXN0clB1cmk9TWlkKHN0ckl0ZW0saW50VGVtcCxJbnN0cihpbnRUZW1wLHN0ckl0ZW0sIiIiIiktaW50VGVtcCkNCgkJCQkJaW50VGVtcD1JbnN0clJldihzdHJQdXJpLCJcIikNCgkJCQkJc3RyRm5hbT1NaWQoc3RyUHVyaSxpbnRUZW1wKzEpDQoJCQkJCW1fZGljRm9ybS5BZGQgc3RySW5hbSYiX1R5cGUiLHN0ckZ0eXANCgkJCQkJbV9kaWNGb3JtLkFkZCBzdHJJbmFtJiJfTmFtZSIsc3RyRm5hbQ0KCQkJCQltX2RpY0Zvcm0uQWRkIHN0ckluYW0mIl9QYXRoIixMZWZ0KHN0clB1cmksaW50VGVtcCkNCgkJCQkJbV9kaWNGb3JtLkFkZCBzdHJJbmFtJiJfU2l6ZSIsbG5nRnNpeg0KCQkJCQlpZiBJbnN0cihzdHJGbmFtLCIuIik8PjAgdGhlbg0KCQkJCQkJc3RyRmV4dD1NaWQoc3RyRm5hbSxJbnN0clJldihzdHJGbmFtLCIuIikrMSkNCgkJCQkJZWxzZQ0KCQkJCQkJc3RyRmV4dD0iIg0KCQkJCQllbmQgaWYNCg0KCQkJCQlzZWxlY3QgY2FzZSBzdHJGdHlwDQoJCQkJCWNhc2UgImltYWdlL2pwZWciLCJpbWFnZS9wanBlZyIsImltYWdlL2pwZyINCgkJCQkJCWlmIExjYXNlKHN0ckZleHQpPD4ianBnIiB0aGVuIHN0ckZleHQ9ImpwZyINCgkJCQkJCW1fYmluSXRlbS5Qb3NpdGlvbj0zDQoJCQkJCQlkbyB3aGlsZSBub3QgbV9iaW5JdGVtLkVPUw0KCQkJCQkJCWRvDQoJCQkJCQkJCWludFRlbXAgPSBBc2NiKG1fYmluSXRlbS5SZWFkKDEpKQ0KCQkJCQkJCWxvb3Agd2hpbGUgaW50VGVtcCA9IDI1NSBhbmQgbm90IG1fYmluSXRlbS5FT1MNCgkJCQkJCQlpZiBpbnRUZW1wIDwgMTkyIG9yIGludFRlbXAgPiAxOTUgdGhlbg0KCQkJCQkJCQltX2Jpbkl0ZW0ucmVhZChCaW4yVmFsKG1fYmluSXRlbS5SZWFkKDIpKS0yKQ0KCQkJCQkJCWVsc2UNCgkJCQkJCQkJRXhpdCBkbw0KCQkJCQkJCWVuZCBpZg0KCQkJCQkJCWRvDQoJCQkJCQkJCWludFRlbXAgPSBBc2NiKG1fYmluSXRlbS5SZWFkKDEpKQ0KCQkJCQkJCWxvb3Agd2hpbGUgaW50VGVtcCA8IDI1NSBhbmQgbm90IG1fYmluSXRlbS5FT1MNCgkJCQkJCWxvb3ANCgkJCQkJCW1fYmluSXRlbS5SZWFkKDMpDQoJCQkJCQltX2RpY0Zvcm0uQWRkIHN0ckluYW0mIl9IZWlnaHQiLEJpbjJWYWwobV9iaW5JdGVtLlJlYWQoMikpDQoJCQkJCQltX2RpY0Zvcm0uQWRkIHN0ckluYW0mIl9XaWR0aCIsQmluMlZhbChtX2Jpbkl0ZW0uUmVhZCgyKSkNCgkJCQkJY2FzZSAiaW1hZ2UvZ2lmIg0KCQkJCQkJaWYgTGNhc2Uoc3RyRmV4dCk8PiJnaWYiIHRoZW4gc3RyRmV4dD0iZ2lmIg0KCQkJCQkJbV9iaW5JdGVtLlBvc2l0aW9uPTYNCgkJCQkJCW1fZGljRm9ybS5BZGQgc3RySW5hbSYiX1dpZHRoIixCaW5WYWwyKG1fYmluSXRlbS5SZWFkKDIpKQ0KCQkJCQkJbV9kaWNGb3JtLkFkZCBzdHJJbmFtJiJfSGVpZ2h0IixCaW5WYWwyKG1fYmluSXRlbS5SZWFkKDIpKQ0KCQkJCQljYXNlICJpbWFnZS9wbmciDQoJCQkJCQlpZiBMY2FzZShzdHJGZXh0KTw+InBuZyIgdGhlbiBzdHJGZXh0PSJwbmciDQoJCQkJCQltX2Jpbkl0ZW0uUG9zaXRpb249MTgNCgkJCQkJCW1fZGljRm9ybS5BZGQgc3RySW5hbSYiX1dpZHRoIixCaW4yVmFsKG1fYmluSXRlbS5SZWFkKDIpKQ0KCQkJCQkJbV9iaW5JdGVtLlJlYWQoMikNCgkJCQkJCW1fZGljRm9ybS5BZGQgc3RySW5hbSYiX0hlaWdodCIsQmluMlZhbChtX2Jpbkl0ZW0uUmVhZCgyKSkNCgkJCQkJY2FzZSAiaW1hZ2UvYm1wIg0KCQkJCQkJaWYgTGNhc2Uoc3RyRmV4dCk8PiJibXAiIHRoZW4gc3RyRmV4dD0iYm1wIg0KCQkJCQkJbV9iaW5JdGVtLlBvc2l0aW9uPTE4DQoJCQkJCQltX2RpY0Zvcm0uQWRkIHN0ckluYW0mIl9XaWR0aCIsQmluVmFsMihtX2Jpbkl0ZW0uUmVhZCg0KSkNCgkJCQkJCW1fZGljRm9ybS5BZGQgc3RySW5hbSYiX0hlaWdodCIsQmluVmFsMihtX2Jpbkl0ZW0uUmVhZCg0KSkNCgkJCQkJY2FzZSAiYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2giDQoJCQkJCQlpZiBMY2FzZShzdHJGZXh0KTw+InN3ZiIgdGhlbiBzdHJGZXh0PSJzd2YiDQoJCQkJCQltX2Jpbkl0ZW0uUG9zaXRpb249MA0KCQkJCQkJaWYgQXNjYihtX2Jpbkl0ZW0uUmVhZCgxKSk9NzAgdGhlbg0KCQkJCQkJCW1fYmluSXRlbS5Qb3NpdGlvbj04DQoJCQkJCQkJc3RyVGVtcCA9IE51bTJTdHIoQXNjYihtX2Jpbkl0ZW0uUmVhZCgxKSksIDIgLDgpDQoJCQkJCQkJaW50VGVtcCA9IFN0cjJOdW0oTGVmdChzdHJUZW1wLCA1KSwgMikNCgkJCQkJCQlzdHJUZW1wID0gTWlkKHN0clRlbXAsIDYpDQoJCQkJCQkJd2hpbGUgKExlbihzdHJUZW1wKSA8IGludFRlbXAgKiA0KQ0KCQkJCQkJCQlzdHJUZW1wID0gc3RyVGVtcCAmIE51bTJTdHIoQXNjYihtX2Jpbkl0ZW0uUmVhZCgxKSksIDIgLDgpDQoJCQkJCQkJd2VuZA0KCQkJCQkJCW1fZGljRm9ybS5BZGQgc3RySW5hbSYiX1dpZHRoIiwgSW50KEFicyhTdHIyTnVtKE1pZChzdHJUZW1wLCBpbnRUZW1wICsgMSwgaW50VGVtcCksIDIpIC0gU3RyMk51bShNaWQoc3RyVGVtcCwgMSwgaW50VGVtcCksIDIpKSAvIDIwKQ0KCQkJCQkJCW1fZGljRm9ybS5BZGQgc3RySW5hbSYiX0hlaWdodCIsSW50KEFicyhTdHIyTnVtKE1pZChzdHJUZW1wLCAzICogaW50VGVtcCArIDEsIGludFRlbXApLCAyKSAtIFN0cjJOdW0oTWlkKHN0clRlbXAsIDIgKiBpbnRUZW1wICsgMSwgaW50VGVtcCksIDIpKSAvIDIwKQ0KCQkJCQkJZW5kIGlmDQoJCQkJCWVuZCBzZWxlY3QNCg0KCQkJCQltX2RpY0Zvcm0uQWRkIHN0ckluYW0mIl9FeHQiLHN0ckZleHQNCgkJCQkJbV9kaWNGb3JtLkFkZCBzdHJJbmFtJiJfRnJvbSIscF9zdGFydA0KCQkJCQlpZiBtX0F1dG9TYXZlPD4yIHRoZW4NCgkJCQkJCWludFRlbXA9R2V0RmVycihsbmdGc2l6LHN0ckZleHQpDQoJCQkJCQltX2RpY0Zvcm0uQWRkIHN0ckluYW0mIl9FcnIiLGludFRlbXANCgkJCQkJCWlmIGludFRlbXA9MCB0aGVuDQoJCQkJCQkJaWYgbV9BdXRvU2F2ZT0wIHRoZW4NCgkJCQkJCQkJc3RyRm5hbT1HZXRUaW1lU3RyKCkNCgkJCQkJCQkJaWYgc3RyRmV4dDw+IiIgdGhlbiBzdHJGbmFtPXN0ckZuYW0mIi4iJnN0ckZleHQNCgkJCQkJCQllbmQgaWYNCgkJCQkJCQltX2Jpbkl0ZW0uU2F2ZVRvRmlsZSBtX1NhdmVQYXRoJnN0ckZuYW0sMg0KCQkJCQkJCW1fZGljRm9ybS5BZGQgc3RySW5hbSxzdHJGbmFtDQoJCQkJCQllbmQgaWYNCgkJCQkJZW5kIGlmDQoJCQkJZWxzZQ0KCQkJCQltX2RpY0Zvcm0uQWRkIHN0ckluYW0mIl9FcnIiLC0xDQoJCQkJZW5kIGlmDQoJCQllbmQgaWYNCgkJCWVsc2UNCgkJCQltX2Jpbkl0ZW0uUG9zaXRpb249MA0KCQkJCW1fYmluSXRlbS5UeXBlPTINCgkJCQltX2Jpbkl0ZW0uQ2hhcnNldD1tX0NoYXJzZXQNCgkJCQlzdHJUZW1wPW1fYmluSXRlbS5SZWFkVGV4dA0KCQkJCWlmIG1fZGljRm9ybS5FeGlzdHMoc3RySW5hbSkgdGhlbg0KCQkJCQltX2RpY0Zvcm0oc3RySW5hbSkgPSBtX2RpY0Zvcm0oc3RySW5hbSkmIiwiJnN0clRlbXANCgkJCQllbHNlDQoJCQkJCXN0ckZvcm1JdGVtPXN0ckZvcm1JdGVtJnN0clNwbGl0JnN0ckluYW0NCgkJCQkJbV9kaWNGb3JtLkFkZCBzdHJJbmFtLHN0clRlbXANCgkJCQllbmQgaWYNCgkJCWVuZCBpZg0KDQoJCQltX2Jpbkl0ZW0uQ2xvc2UoKQ0KCQkJcF9zdGFydCA9IHBfZW5kK2ludFNlcGFyYXRvcisyDQoJCWxvb3AgVW50aWwgcF9zdGFydCszPmxuZ1JlcXVlc3RTaXplDQoJCUZvcm1JdGVtPVNwbGl0KHN0ckZvcm1JdGVtLHN0clNwbGl0KQ0KCQlGaWxlSXRlbT1TcGxpdChzdHJGaWxlSXRlbSxzdHJTcGxpdCkNCgkJDQoJCU9wZW4gPSBsbmdSZXF1ZXN0U2l6ZQ0KCUVuZCBGdW5jdGlvbg0KDQoJUHJpdmF0ZSBGdW5jdGlvbiBHZXRUaW1lU3RyKCkNCgkJbV9sbmdUaW1lPW1fbG5nVGltZSsxDQoJCUdldFRpbWVTdHI9bV9zdHJEYXRlJlJpZ2h0KCIwMDAwMDAwMCImbV9sbmdUaW1lLDgpDQoJRW5kIEZ1bmN0aW9uDQoNCglQcml2YXRlIEZ1bmN0aW9uIEdldEZlcnIobG5nRnNpeixzdHJGZXh0KQ0KCQlkaW0gaW50RmVycg0KCQlpbnRGZXJyPTANCgkJaWYgbG5nRnNpej5tX01heFNpemUgYW5kIG1fTWF4U2l6ZT4wIHRoZW4NCgkJCWlmIG1fRXJyb3I9MCBvciBtX0Vycm9yPTIgdGhlbiBtX0Vycm9yPW1fRXJyb3IrMQ0KCQkJaW50RmVycj1pbnRGZXJyKzENCgkJZW5kIGlmDQoJCWlmIEluc3RyKDEsTENhc2UoIi8iJm1fRmlsZVR5cGUmIi8iKSxMQ2FzZSgiLyImc3RyRmV4dCYiLyIpKT0wIGFuZCBtX0ZpbGVUeXBlPD4iIiB0aGVuDQoJCQlpZiBtX0Vycm9yPDIgdGhlbiBtX0Vycm9yPW1fRXJyb3IrMg0KCQkJaW50RmVycj1pbnRGZXJyKzINCgkJZW5kIGlmDQoJCUdldEZlcnI9aW50RmVycg0KCUVuZCBGdW5jdGlvbg0KDQoJUHVibGljIEZ1bmN0aW9uIFNhdmUoSXRlbSxzdHJGbmFtKQ0KCQlTYXZlPWZhbHNlDQoJCWlmIG1fZGljRm9ybS5FeGlzdHMoSXRlbSYiX0Zyb20iKSB0aGVuDQoJCQlkaW0gaW50RmVycixzdHJGZXh0DQoJCQlzdHJGZXh0PW1fZGljRm9ybShJdGVtJiJfRXh0IikNCgkJCWludEZlcnI9R2V0RmVycihtX2RpY0Zvcm0oSXRlbSYiX1NpemUiKSxzdHJGZXh0KQ0KCQkJaWYgbV9kaWNGb3JtLkV4aXN0cyhJdGVtJiJfRXJyIikgdGhlbg0KCQkJCWlmIGludEZlcnI9MCB0aGVuDQoJCQkJCW1fZGljRm9ybShJdGVtJiJfRXJyIik9MA0KCQkJCWVuZCBpZg0KCQkJZWxzZQ0KCQkJCW1fZGljRm9ybS5BZGQgSXRlbSYiX0VyciIsaW50RmVycg0KCQkJZW5kIGlmDQoJCQlpZiBpbnRGZXJyPD4wIHRoZW4gRXhpdCBGdW5jdGlvbg0KCQkJaWYgVmFyVHlwZShzdHJGbmFtKT0yIHRoZW4NCgkJCQlzZWxlY3QgY2FzZSBzdHJGbmFtDQoJCQkJCWNhc2UgMDpzdHJGbmFtPUdldFRpbWVTdHIoKQ0KCQkJCQkJaWYgc3RyRmV4dDw+IiIgdGhlbiBzdHJGbmFtPXN0ckZuYW0mIi4iJnN0ckZleHQNCgkJCQkJY2FzZSAxOnN0ckZuYW09bV9kaWNGb3JtKEl0ZW0mIl9OYW1lIikNCgkJCQllbmQgc2VsZWN0DQoJCQllbmQgaWYNCgkJCW1fYmluSXRlbS5UeXBlID0gMQ0KCQkJbV9iaW5JdGVtLk9wZW4NCgkJCW1fYmluRm9ybS5Qb3NpdGlvbiA9IG1fZGljRm9ybShJdGVtJiJfRnJvbSIpDQoJCQltX2JpbkZvcm0uQ29weVRvIG1fYmluSXRlbSxtX2RpY0Zvcm0oSXRlbSYiX1NpemUiKQ0KCQkJbV9iaW5JdGVtLlNhdmVUb0ZpbGUgbV9TYXZlUGF0aCZzdHJGbmFtLDINCgkJCW1fYmluSXRlbS5DbG9zZSgpDQoJCQlpZiBtX2RpY0Zvcm0uRXhpc3RzKEl0ZW0pIHRoZW4NCgkJCQltX2RpY0Zvcm0oSXRlbSk9c3RyRm5hbQ0KCQkJZWxzZQ0KCQkJCW1fZGljRm9ybS5BZGQgSXRlbSxzdHJGbmFtDQoJCQllbmQgaWYNCgkJCVNhdmU9dHJ1ZQ0KCQllbmQgaWYNCglFbmQgRnVuY3Rpb24NCg0KCVB1YmxpYyBGdW5jdGlvbiBHZXREYXRhKEl0ZW0pDQoJCUdldERhdGE9IiINCgkJaWYgbV9kaWNGb3JtLkV4aXN0cyhJdGVtJiJfRnJvbSIpIHRoZW4NCgkJCWlmIEdldEZlcnIobV9kaWNGb3JtKEl0ZW0mIl9TaXplIiksbV9kaWNGb3JtKEl0ZW0mIl9FeHQiKSk8PjAgdGhlbiBFeGl0IEZ1bmN0aW9uDQoJCQltX2JpbkZvcm0uUG9zaXRpb24gPSBtX2RpY0Zvcm0oSXRlbSYiX0Zyb20iKQ0KCQkJR2V0RGF0YSA9IG1fYmluRm9ybS5SZWFkKG1fZGljRm9ybShJdGVtJiJfU2l6ZSIpKQ0KCQllbmQgaWYNCglFbmQgRnVuY3Rpb24NCg0KCVB1YmxpYyBGdW5jdGlvbiBGb3JtKEl0ZW0pDQoJCWlmIG1fZGljRm9ybS5FeGlzdHMoSXRlbSkgdGhlbg0KCQkJRm9ybT1tX2RpY0Zvcm0oSXRlbSkNCgkJZWxzZQ0KCQkJRm9ybT0iIg0KCQllbmQgaWYNCglFbmQgRnVuY3Rpb24NCg0KCVByaXZhdGUgRnVuY3Rpb24gQmluVmFsMihiaW4pDQoJCWRpbSBsbmdWYWx1ZSxpDQoJCWxuZ1ZhbHVlPTANCgkJZm9yIGkgPSBsZW5iKGJpbikgdG8gMSBzdGVwIC0xDQoJCQlsbmdWYWx1ZSA9IGxuZ1ZhbHVlICoyNTYgKyBBc2NiKG1pZGIoYmluLGksMSkpDQoJTmV4dA0KCQlCaW5WYWwyPWxuZ1ZhbHVlDQoJRW5kIEZ1bmN0aW9uDQoNCglQcml2YXRlIEZ1bmN0aW9uIEJpbjJWYWwoYmluKQ0KCQlkaW0gbG5nVmFsdWUsaQ0KCQlsbmdWYWx1ZT0wDQoJCWZvciBpID0gMSB0byBsZW5iKGJpbikNCgkJCWxuZ1ZhbHVlID0gbG5nVmFsdWUgKjI1NiArIEFzY2IobWlkYihiaW4saSwxKSkNCglOZXh0DQoJCUJpbjJWYWw9bG5nVmFsdWUNCglFbmQgRnVuY3Rpb24NCg0KCVByaXZhdGUgRnVuY3Rpb24gTnVtMlN0cihudW0sIGJhc2UsIGxlbnMpDQoJCURpbSByZXQsaQ0KCQlyZXQgPSAiIg0KCQl3aGlsZShudW0gPj0gYmFzZSkNCgkJCWkgICA9IG51bSBNb2QgYmFzZQ0KCQkJcmV0ID0gaSAmIHJldA0KCQkJbnVtID0gKG51bSAtIGkpIC8gYmFzZQ0KCQl3ZW5kDQoJCU51bTJTdHIgPSBSaWdodChTdHJpbmcobGVucywgIjAiKSAmIG51bSAmIHJldCwgbGVucykNCglFbmQgRnVuY3Rpb24NCg0KCVByaXZhdGUgRnVuY3Rpb24gU3RyMk51bShzdHIsIGJhc2UpDQoJCURpbSByZXQsIGkNCgkJcmV0ID0gMCANCgkJZm9yIGkgPSAxIHRvIExlbihzdHIpDQoJCQlyZXQgPSByZXQgKiBiYXNlICsgQ2ludChNaWQoc3RyLCBpLCAxKSkNCglOZXh0DQoJCVN0cjJOdW0gPSByZXQNCglFbmQgRnVuY3Rpb24NCglQdWJsaWMgRnVuY3Rpb24gRXJyb3IySW5mbyhJdGVtKQ0KCQlTZWxlY3QgQ2FzZSBtX2RpY0Zvcm0oSXRlbSYiX0VyciIpDQoJCQljYXNlIC0xOkVycm9yMkluZm8gPSAi5LiK5Lyg5rKh5pyJ5byA5aeLIg0KCQkJY2FzZSAwOiBFcnJvcjJJbmZvID0gIlNVQ0NFU1MiDQoJCQljYXNlIDE6IEVycm9yMkluZm8gPSAi5paH5Lu25Zug5aSn5LqOICImbV9NYXhTaXplJiLlrZfoioIg6ICM5pyq6KKr5L+d5a2Y44CCIg0KCQkJY2FzZSAyOiBFcnJvcjJJbmZvID0gIuaWh+S7tuWboOaJqeWxleWQjeS4jeespuWQiOiAjOacquiiq+S/neWtmOOAgiINCgkJCWNhc2UgMzogRXJyb3IySW5mbyA9ICLmlofku7blm6Dov4flpKfkuJTkuI3nrKblkIjmianlsZXlkI3jgIIiDQoJCQljYXNlIDQ6IEVycm9yMkluZm8gPSAi5byC5bi477yM5LiN5a2Y5Zyo5LiK5Lyg44CCIg0KCQkJY2FzZSA1OiBFcnJvcjJJbmZvID0gIuS4iuS8oOW3sue7j+WPlua2iO+8jOivt+ajgOafpeaAu+S4iui9veaVsOaNruaYr+WQpuWwj+S6jiAiJm1fVG90YWxTaXplJiIg44CCIg0KCQlFbmQgU2VsZWN0DQoJRW5kIEZ1bmN0aW9uDQoNCkVuZCBDbGFzcw0KJT4=</file>
	<file name='zb_system\FUNCTION\c_system_manage.asp' crc32='7BACA643'  dt:dt='bin.base64'>77u/PCUNCicvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQonLy8gICAgICAgICAgICAgIFotQmxvZw0KJy8vIOS9nCAgICDogIU6ICAgIOacseeFiih6eC5hc2QpMjAwOC01LTMwDQonLy8g54mI5p2D5omA5pyJOiAgICBSYWluYm93U29mdCBTdHVkaW8NCicvLyDmioDmnK/mlK/mjIE6ICAgIHJhaW5ib3dzb2Z0QDE2My5jb20NCicvLyDnqIvluo/lkI3np7A6DQonLy8g56iL5bqP54mI5pysOg0KJy8vIOWNleWFg+WQjeensDogICAgY19zeXN0ZW1fbWFuYWdlLmFzcA0KJy8vIOW8gOWni+aXtumXtDogICAgMjAwNS4wMi4xMQ0KJy8vIOacgOWQjuS/ruaUuToNCicvLyDlpIcgICAg5rOoOg0KJy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEV4cG9ydFBhZ2VCYXIoUGFnZU5vdyxQYWdlQWxsLFBhZ2VMZW5ndGgsVXJsKQ0KDQpJZiBQYWdlQWxsPTAgVGhlbg0KCUV4aXQgRnVuY3Rpb24NCkVuZCBpZg0KDQpEaW0gcw0KRGltIGkNCg0KJ0RpbSBQYWdlTm93DQonRGltIFBhZ2VBbGwNCidEaW0gUGFnZUxlbmd0aA0KRGltIFBhZ2VGcmlzdA0KRGltIFBhZ2VMYXN0DQpEaW0gUGFnZVByZXZpb3VzDQpEaW0gUGFnZU5leHQNCkRpbSBQYWdlQmVnaW4NCkRpbSBQYWdlRW5kDQoNClBhZ2VGcmlzdCA9IDENClBhZ2VMYXN0ID0gUGFnZUFsbA0KDQpQYWdlQmVnaW4gPSBQYWdlTm93DQpQYWdlRW5kID0gUGFnZUJlZ2luICsgUGFnZUxlbmd0aCAtIDENCg0KSWYgUGFnZUVuZCA+IFBhZ2VBbGwgVGhlbg0KCVBhZ2VFbmQgPSBQYWdlQWxsDQoJUGFnZUJlZ2luID0gUGFnZUFsbCAtIFBhZ2VMZW5ndGggKyAxDQoJSWYgUGFnZUJlZ2luIDwgMSBUaGVuDQoJCVBhZ2VCZWdpbiA9IDENCglFbmQgSWYNCkVuZCBJZg0KDQpzPXMgJiI8YSBocmVmPSciJlVybCAmIFBhZ2VGcmlzdCAmIic+IiYgIiZsdDsmbHQ7IiAmIjwvYT4gIg0KDQpGb3IgaT1QYWdlQmVnaW4gVG8gUGFnZUVuZA0KCUlmIGk9UGFnZU5vdyBUaGVuDQoJCXM9cyAmIjxzcGFuPiImIFJlcGxhY2UoWkNfTVNHMDM2LCIlcyIsaSkgJiI8L3NwYW4+ICINCglFbHNlDQoJCXM9cyAmIjxhIGhyZWY9JyImVXJsICYgaSAgJiInPiImIFJlcGxhY2UoWkNfTVNHMDM2LCIlcyIsaSkgJiI8L2E+ICINCglFbmQgSWYNCk5leHQNCg0Kcz1zICYiPGEgaHJlZj0nIiZVcmwgJiBQYWdlTGFzdCAgJiInPiImICImZ3Q7Jmd0OyIgJiI8L2E+ICINCg0KRXhwb3J0UGFnZUJhcj1zDQoNCkVuZCBGdW5jdGlvbg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgTWFuYWdlciBBcnRpY2xlcw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gRXhwb3J0QXJ0aWNsZUxpc3QoaW50UGFnZSxpbnRDYXRlLGludExldmVsLGJvbElzdG9wLGludFRpdGxlKQ0KDQonQ2FsbCBBZGRfUmVzcG9uc2VfUGx1Z2luKCJSZXNwb25zZV9QbHVnaW5fQXJ0aWNsZU1uZ19TdWJNZW51IixNYWtlU3ViTWVudShaQ19NU0cxNjggJiAiIiwiLi4vY21kLmFzcD9hY3Q9QXJ0aWNsZUVkdCZhbXA7d2ViZWRpdD0iICYgWkNfQkxPR19XRUJFRElULCJtLWxlZnQiLEZhbHNlKSkNCg0KCURpbSBpDQoJRGltIG9ialJTDQoJRGltIHN0clNRTA0KCURpbSBzdHJQYWdlDQoJRGltIGludFBhZ2VBbGwNCg0KCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoaW50UGFnZSwiaW50IiwxKQ0KCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoaW50Q2F0ZSwiaW50IiwtMSkNCglDYWxsIENoZWNrUGFyYW1ldGVyKGludExldmVsLCJpbnQiLC0xKQ0KCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoYm9sSXN0b3AsImJvb2wiLEZhbHNlKQ0KCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoaW50VGl0bGUsInNxbCIsLTEpDQoJaW50VGl0bGU9dmJzdW5lc2NhcGUoaW50VGl0bGUpDQoJaW50VGl0bGU9RmlsdGVyU1FMKGludFRpdGxlKQ0KDQoJUmVzcG9uc2UuV3JpdGUgIjxkaXYgY2xhc3M9IiJkaXZIZWFkZXIiIj4iICYgWkNfTVNHMDY3ICYgIjwvZGl2PiINCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iIlN1Yk1lbnUiIj4iICYgUmVzcG9uc2VfUGx1Z2luX0FydGljbGVNbmdfU3ViTWVudSAmICI8L2Rpdj4iDQoJUmVzcG9uc2UuV3JpdGUgIjxkaXYgaWQ9IiJkaXZNYWluMiIiPiINCg0KDQoNCglSZXNwb25zZS5Xcml0ZSAiPGZvcm0gY2xhc3M9IiJzZWFyY2giIiBpZD0iImVkaXQiIiBtZXRob2Q9IiJwb3N0IiIgYWN0aW9uPSIiLi4vYWRtaW4vYWRtaW4uYXNwP2FjdD1BcnRpY2xlTW5nIiI+Ig0KDQoJUmVzcG9uc2UuV3JpdGUgIjxwPiImWkNfTVNHMTU4JiI6Jm5ic3A7Jm5ic3A7Ig0KDQoJUmVzcG9uc2UuV3JpdGUgWkNfTVNHMDEyJiIgPHNlbGVjdCBjbGFzcz0iImVkaXQiIiBzaXplPSIiMSIiIGlkPSIiY2F0ZSIiIG5hbWU9IiJjYXRlIiIgc3R5bGU9IiJ3aWR0aDoxMDBweDsiIiA+PG9wdGlvbiB2YWx1ZT0iIi0xIiI+IiZaQ19NU0cxNTcmIjwvb3B0aW9uPiAiDQoNCglEaW0gYXJ5Q2F0ZUluT3JkZXIgOiBhcnlDYXRlSW5PcmRlcj1HZXRDYXRlZ29yeU9yZGVyKCkNCglEaW0gbSxuDQoJSWYgSXNBcnJheShhcnlDYXRlSW5PcmRlcikgVGhlbg0KCUZvciBtPUxCb3VuZChhcnlDYXRlSW5PcmRlcikrMSBUbyBVYm91bmQoYXJ5Q2F0ZUluT3JkZXIpDQoJCUlmIENhdGVnb3J5cyhhcnlDYXRlSW5PcmRlcihtKSkuUGFyZW50SUQ9MCBUaGVuDQoJCQlSZXNwb25zZS5Xcml0ZSAiPG9wdGlvbiB2YWx1ZT0iIiImQ2F0ZWdvcnlzKGFyeUNhdGVJbk9yZGVyKG0pKS5JRCYiIiI+IiZUcmFuc2ZlckhUTUwoIENhdGVnb3J5cyhhcnlDYXRlSW5PcmRlcihtKSkuTmFtZSwiW2h0bWwtZm9ybWF0XSIpJiI8L29wdGlvbj4iDQoNCgkJCUZvciBuPTAgVG8gVUJvdW5kKGFyeUNhdGVJbk9yZGVyKQ0KCQkJCUlmIENhdGVnb3J5cyhhcnlDYXRlSW5PcmRlcihuKSkuUGFyZW50SUQ9Q2F0ZWdvcnlzKGFyeUNhdGVJbk9yZGVyKG0pKS5JRCBUaGVuDQoJCQkJCVJlc3BvbnNlLldyaXRlICI8b3B0aW9uIHZhbHVlPSIiIiZDYXRlZ29yeXMoYXJ5Q2F0ZUluT3JkZXIobikpLklEJiIiIj7ilJQiJlRyYW5zZmVySFRNTCggQ2F0ZWdvcnlzKGFyeUNhdGVJbk9yZGVyKG4pKS5OYW1lLCJbaHRtbC1mb3JtYXRdIikmIjwvb3B0aW9uPiINCgkJCQlFbmQgSWYNCgkJCU5leHQNCgkJRW5kIElmDQoJTmV4dA0KCUVuZCBJZg0KCVJlc3BvbnNlLldyaXRlICI8L3NlbGVjdD4mbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiDQoNCglSZXNwb25zZS5Xcml0ZSBaQ19NU0cwNjEmIiA8c2VsZWN0IGNsYXNzPSIiZWRpdCIiIHNpemU9IiIxIiIgaWQ9IiJsZXZlbCIiIG5hbWU9IiJsZXZlbCIiIHN0eWxlPSIid2lkdGg6ODBweDsiIiA+PG9wdGlvbiB2YWx1ZT0iIi0xIiI+IiZaQ19NU0cxNTcmIjwvb3B0aW9uPiAiDQoNCglGb3IgaT1MQm91bmQoWlZBX0FydGljbGVfTGV2ZWxfTmFtZSkrMSB0byBVYm91bmQoWlZBX0FydGljbGVfTGV2ZWxfTmFtZSkNCgkJCVJlc3BvbnNlLldyaXRlICI8b3B0aW9uIHZhbHVlPSIiIiZpJiIiIiAiDQoJCQlSZXNwb25zZS5Xcml0ZSAiPiImWlZBX0FydGljbGVfTGV2ZWxfTmFtZShpKSYiPC9vcHRpb24+Ig0KCU5leHQNCglSZXNwb25zZS5Xcml0ZSAiPC9zZWxlY3Q+Ig0KDQoJUmVzcG9uc2UuV3JpdGUgIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOzxsYWJlbD48aW5wdXQgdHlwZT0iImNoZWNrYm94IiIgbmFtZT0iImlzdG9wIiIgaWQ9IiJpc3RvcCIiIHZhbHVlPSIiVHJ1ZSIiLz4mbmJzcDsiJlpDX01TRzA1MSYiPC9sYWJlbD4iDQoNCglSZXNwb25zZS5Xcml0ZSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7PGlucHV0IGlkPSIidGl0bGUiIiBuYW1lPSIidGl0bGUiIiBzdHlsZT0iIndpZHRoOjI1MHB4OyIiIHR5cGU9IiJ0ZXh0IiIgdmFsdWU9IiIiIiAvPiAiDQoJUmVzcG9uc2UuV3JpdGUgIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOzxpbnB1dCB0eXBlPSIic3VibWl0IiIgY2xhc3M9IiJidXR0b24iIiB2YWx1ZT0iIiImWkNfTVNHMDg3JiIiIi8+Ig0KDQoJUmVzcG9uc2UuV3JpdGUgIjwvcD48L2Zvcm0+Ig0KDQoJU2V0IG9ialJTPVNlcnZlci5DcmVhdGVPYmplY3QoIkFET0RCLlJlY29yZHNldCIpDQoJb2JqUlMuQ3Vyc29yVHlwZSA9IGFkT3BlbktleXNldA0KCW9ialJTLkxvY2tUeXBlID0gYWRMb2NrUmVhZE9ubHkNCglvYmpSUy5BY3RpdmVDb25uZWN0aW9uPW9iakNvbm4NCglvYmpSUy5Tb3VyY2U9IiINCg0KCXN0clNRTD0iV0hFUkUgKFtsb2dfVHlwZV09MCkgQU5EIChbbG9nX0xldmVsXT4wKSBBTkQgKDE9MSkgIg0KDQoJSWYgQ2hlY2tSaWdodHMoIlJvb3QiKT1GYWxzZSBBbmQgQ2hlY2tSaWdodHMoIkFydGljbGVBbGwiKT1GYWxzZSBUaGVuIHN0clNRTD0gc3RyU1FMICYgIkFORCBbbG9nX0F1dGhvcklEXSA9ICIgJiBCbG9nVXNlci5JRA0KDQoJSWYgaW50Q2F0ZTw+LTEgVGhlbg0KCQlEaW0gc3RyU3ViQ2F0ZUlEIDogc3RyU3ViQ2F0ZUlEPUpvaW4oR2V0U3ViQ2F0ZUlEKGludENhdGUsVHJ1ZSksIiwiKQ0KCQlzdHJTUUw9IHN0clNRTCAmICIgQU5EIFtsb2dfQ2F0ZUlEXSBJTiAoIiAmIHN0clN1YkNhdGVJRCAmICIpIg0KCUVuZCBJZg0KDQoJSWYgaW50TGV2ZWw8Pi0xIFRoZW4NCgkJc3RyU1FMPSBzdHJTUUwgJiAiIEFORCBbbG9nX0xldmVsXSA9ICIgJiBpbnRMZXZlbA0KCUVuZCBJZg0KDQoJSWYgYm9sSXN0b3A9VHJ1ZSBUaGVuDQoJCXN0clNRTD0gc3RyU1FMICYgIiBBTkQgW2xvZ19Jc1RvcF0gPD4gMCINCglFbmQgSWYNCg0KCUlmIGludFRpdGxlPD4iLTEiIFRoZW4NCgkJSWYgWkNfTVNTUUxfRU5BQkxFPUZhbHNlIFRoZW4NCgkJCXN0clNRTCA9IHN0clNRTCAmICJBTkQgKCAoSW5TdHIoMSxMQ2FzZShbbG9nX1RpdGxlXSksTENhc2UoJyIgJiBpbnRUaXRsZSAmIicpLDApPD4wKSBPUiAoSW5TdHIoMSxMQ2FzZShbbG9nX0ludHJvXSksTENhc2UoJyIgJiBpbnRUaXRsZSAmIicpLDApPD4wKSBPUiAoSW5TdHIoMSxMQ2FzZShbbG9nX0NvbnRlbnRdKSxMQ2FzZSgnIiAmIGludFRpdGxlICYiJyksMCk8PjApICkiDQoJCUVsc2UNCgkJCXN0clNRTCA9IHN0clNRTCAmICJBTkQgKCAoQ0hBUklOREVYKCciICYgaW50VGl0bGUgJiInLFtsb2dfVGl0bGVdKTw+MCkgT1IgKENIQVJJTkRFWCgnIiAmIGludFRpdGxlICYiJyxbbG9nX0ludHJvXSk8PjApIE9SIChDSEFSSU5ERVgoJyIgJiBpbnRUaXRsZSAmIicsW2xvZ19Db250ZW50XSk8PjApICkiDQoJCUVuZCBJZg0KCUVuZCBJZg0KDQoJUmVzcG9uc2UuV3JpdGUgIjx0YWJsZSBib3JkZXI9IiIxIiIgd2lkdGg9IiIxMDAlIiIgY2VsbHNwYWNpbmc9IiIwIiIgY2VsbHBhZGRpbmc9IiIwIiIgY2xhc3M9IiJ0YWJsZUJvcmRlciB0YWJsZUJvcmRlci10aGNlbnRlciIiPiINCglSZXNwb25zZS5Xcml0ZSAiPHRyPjx0aCB3aWR0aD0iIjUlIiI+IiYgWkNfTVNHMDc2ICYiPC90aD48dGggd2lkdGg9IiIxNCUiIj4iJiBaQ19NU0cwMTIgJiI8L3RoPjx0aCB3aWR0aD0iIjEyJSIiPiImIFpDX01TRzAwMyAmIjwvdGg+PHRoPiImIFpDX01TRzA2MCAmIjwvdGg+PHRoIHdpZHRoPSIiMTQlIiI+IiYgWkNfTVNHMDc1ICYiPC90aD48dGggd2lkdGg9IiI2JSIiPiImIFpDX01TRzAxMyAmIjwvdGg+PHRoIHdpZHRoPSIiOSUiIj4iJiBaQ19NU0cwNjEgJiI8L3RoPjx0aCB3aWR0aD0iIjEyJSIiPjwvdGg+PC90cj4iDQoNCglvYmpSUy5PcGVuKCJTRUxFQ1QgKiBGUk9NIFtibG9nX0FydGljbGVdICImIHN0clNRTCAmIiBPUkRFUiBCWSBbbG9nX1Bvc3RUaW1lXSBERVNDIikNCglvYmpSUy5QYWdlU2l6ZT1aQ19NQU5BR0VfQ09VTlQNCglJZiBvYmpSUy5QYWdlQ291bnQ+MCBUaGVuIG9ialJTLkFic29sdXRlUGFnZSA9IGludFBhZ2UNCglpbnRQYWdlQWxsPW9ialJTLlBhZ2VDb3VudA0KDQoJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KDQoJCUZvciBpPTEgdG8gb2JqUlMuUGFnZVNpemUNCg0KCQkJUmVzcG9uc2UuV3JpdGUgIjx0cj4iDQoNCgkJCVJlc3BvbnNlLldyaXRlICI8dGQ+IiAmIG9ialJTKCJsb2dfSUQiKSAmICI8L3RkPiINCg0KCQkJRGltIENhdGVnb3J5DQoJCQlGb3IgRWFjaCBDYXRlZ29yeSBpbiBDYXRlZ29yeXMNCgkJCQlJZiBJc09iamVjdChDYXRlZ29yeSkgVGhlbg0KCQkJCQlJZiBDYXRlZ29yeS5JRD1vYmpSUygibG9nX0NhdGVJRCIpIFRoZW4NCgkJCQkJCVJlc3BvbnNlLldyaXRlICI8dGQ+Ig0KCQkJCQkJSWYgTm90IENhdGVnb3J5LlBhcmVudElEPTAgVGhlbg0KCQkJCQkJZW5kIGlmDQoJCQkJCQlSZXNwb25zZS5Xcml0ZSBDYXRlZ29yeS5OYW1lDQoJCQkJCQlSZXNwb25zZS5Xcml0ZSAiPC90ZD4iDQoJCQkJCUVuZCBJZg0KCQkJCUVuZCBJZg0KCQkJTmV4dA0KDQoJCQlDYWxsIEdldFVzZXJzYnlVc2VySURMaXN0KG9ialJTKCJsb2dfQXV0aG9ySUQiKSkNCgkJCURpbSBVc2VyDQoJCQlGb3IgRWFjaCBVc2VyIGluIFVzZXJzDQoJCQkJSWYgSXNPYmplY3QoVXNlcikgVGhlbg0KCQkJCQlJZiBVc2VyLklEPW9ialJTKCJsb2dfQXV0aG9ySUQiKSBUaGVuDQoJCQkJCQlSZXNwb25zZS5Xcml0ZSAiPHRkPiIgJiBVc2VyLk5hbWUgJiAiPC90ZD4iDQoJCQkJCUVuZCBJZg0KCQkJCUVuZCBJZg0KCQkJTmV4dA0KDQoJCQlSZXNwb25zZS5Xcml0ZSAiPHRkPjxkaXYgc3R5bGU9J292ZXJmbG93OmhpZGRlbjtoZWlnaHQ6MS41ZW07Jz48YSBocmVmPSIiIiZJSWYob2JqUnMoImxvZ19MZXZlbCIpPTEsIi4uL2NtZC5hc3A/YWN0PUFydGljbGVFZHQmYW1wO3dlYmVkaXQ9IiYgWkNfQkxPR19XRUJFRElUICYiJmFtcDtpZD0iICYgb2JqUlMoImxvZ19JRCIpLCIuLi8uLi92aWV3LmFzcD9uYXY9IiAmIG9ialJTKCJsb2dfSUQiKSkgJiAiIiIgdGl0bGU9IiIiJiBSZXBsYWNlKG9ialJTKCJsb2dfVGl0bGUiKSwiIiIiLCIiKSAmIiIiIHRhcmdldD0iIl9ibGFuayIiPiIgJiBvYmpSUygibG9nX1RpdGxlIikgJiAiPC9hPjwvZGl2PjwvdGQ+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIjx0ZD4iICYgRm9ybWF0RGF0ZVRpbWUob2JqUlMoImxvZ19Qb3N0VGltZSIpLHZiU2hvcnREYXRlKSAmICI8L3RkPiINCgkJCVJlc3BvbnNlLldyaXRlICI8dGQ+IiAmIG9ialJTKCJsb2dfQ29tbU51bXMiKSAmICI8L3RkPiINCgkJCVJlc3BvbnNlLldyaXRlICI8dGQ+IiAmIFpWQV9BcnRpY2xlX0xldmVsX05hbWUob2JqUlMoImxvZ19MZXZlbCIpKSAmICI8L3RkPiINCgkJCVJlc3BvbnNlLldyaXRlICI8dGQgYWxpZ249IiJjZW50ZXIiIj48YSBocmVmPSIiLi4vY21kLmFzcD9hY3Q9QXJ0aWNsZUVkdCZhbXA7d2ViZWRpdD0iJiBaQ19CTE9HX1dFQkVESVQgJiImYW1wO2lkPSIgJiBvYmpSUygibG9nX0lEIikgJiAiIiI+PGltZyBzcmM9IiIuLi9pbWFnZS9hZG1pbi9wYWdlX2VkaXQucG5nIiIgYWx0PSIiIiAmIFpDX01TRzEwMCAmICIiIiB0aXRsZT0iIiIgJiBaQ19NU0cxMDAgJiAiIiIgd2lkdGg9IiIxNiIiIC8+PC9hPiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyINCgkJCVJlc3BvbnNlLldyaXRlICI8YSBvbmNsaWNrPSdyZXR1cm4gd2luZG93LmNvbmZpcm0oIiIiJiBaQ19NU0cwNTggJiIiIik7JyBocmVmPSIiLi4vY21kLmFzcD9hY3Q9QXJ0aWNsZURlbCZhbXA7aWQ9IiAmIG9ialJTKCJsb2dfSUQiKSAmICIiIj48aW1nIHNyYz0iIi4uL2ltYWdlL2FkbWluL2RlbGV0ZS5wbmciIiBhbHQ9IiIiICYgWkNfTVNHMDYzICYgIiIiIHRpdGxlPSIiIiAmIFpDX01TRzA2MyAmICIiIiB3aWR0aD0iIjE2IiIgLz48L2E+PC90ZD4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiPC90cj4iDQoNCgkJCW9ialJTLk1vdmVOZXh0DQoJCQlJZiBvYmpSUy5lb2YgVGhlbiBFeGl0IEZvcg0KDQoJCU5leHQNCg0KCUVuZCBJZg0KDQoJUmVzcG9uc2UuV3JpdGUgIjwvdGFibGU+Ig0KDQoJSWYgIGludFBhZ2VBbGw+MSBUaGVuIA0KCQlzdHJQYWdlPUV4cG9ydFBhZ2VCYXIoaW50UGFnZSxpbnRQYWdlQWxsLFpDX1BBR0VCQVJfQ09VTlQsIi4uL2FkbWluL2FkbWluLmFzcD9hY3Q9QXJ0aWNsZU1uZyZhbXA7Y2F0ZT0iJlJlUXVlc3QoImNhdGUiKSYiJmFtcDtsZXZlbD0iJlJlUXVlc3QoImxldmVsIikmIiZhbXA7dGl0bGU9IiZFc2NhcGUoUmVRdWVzdCgidGl0bGUiKSkgJiAiJmFtcDtwYWdlPSIpDQoNCgkJUmVzcG9uc2UuV3JpdGUgIjxoci8+PHAgY2xhc3M9IiJwYWdlYmFyIiI+IiAmIFpDX01TRzA0MiAmICI6ICIgJiBzdHJQYWdlICYgIjwvcD4iDQoJRW5kIElmIA0KDQoJUmVzcG9uc2UuV3JpdGUgIjwvZGl2PiINCg0KCVJlc3BvbnNlLldyaXRlICI8c2NyaXB0IHR5cGU9IiJ0ZXh0L2phdmFzY3JpcHQiIj5BY3RpdmVMZWZ0TWVudSgiImFBcnRpY2xlTW5nIiIpOzwvc2NyaXB0PiINCg0KCW9ialJTLkNsb3NlDQoJU2V0IG9ialJTPU5vdGhpbmcNCg0KCUV4cG9ydEFydGljbGVMaXN0PVRydWUNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIE1hbmFnZXIgU2luZ2xlUGFnZXMNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEV4cG9ydFBhZ2VMaXN0KGludFBhZ2UsaW50Q2F0ZSxpbnRMZXZlbCxpbnRUaXRsZSkNCg0KQ2FsbCBBZGRfUmVzcG9uc2VfUGx1Z2luKCJSZXNwb25zZV9QbHVnaW5fQXJ0aWNsZU1uZ19TdWJNZW51IixNYWtlU3ViTWVudShaQ19NU0cxMTMgJiAiIiwiLi4vY21kLmFzcD9hY3Q9QXJ0aWNsZUVkdCZhbXA7dHlwZT1QYWdlJmFtcDt3ZWJlZGl0PSIgJiBaQ19CTE9HX1dFQkVESVQsIm0tbGVmdCIsRmFsc2UpKQ0KDQoJRGltIGkNCglEaW0gb2JqUlMNCglEaW0gc3RyU1FMDQoJRGltIHN0clBhZ2UNCglEaW0gaW50UGFnZUFsbA0KDQoJQ2FsbCBDaGVja1BhcmFtZXRlcihpbnRQYWdlLCJpbnQiLDEpDQoJQ2FsbCBDaGVja1BhcmFtZXRlcihpbnRDYXRlLCJpbnQiLC0xKQ0KCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoaW50TGV2ZWwsImludCIsLTEpDQoJQ2FsbCBDaGVja1BhcmFtZXRlcihpbnRUaXRsZSwic3FsIiwtMSkNCglpbnRUaXRsZT12YnN1bmVzY2FwZShpbnRUaXRsZSkNCglpbnRUaXRsZT1GaWx0ZXJTUUwoaW50VGl0bGUpDQoNCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iImRpdkhlYWRlciIiPiIgJiBaQ19NU0cxMTEgJiAiPC9kaXY+Ig0KCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIiU3ViTWVudSIiPiIgJiBSZXNwb25zZV9QbHVnaW5fQXJ0aWNsZU1uZ19TdWJNZW51ICYgIjwvZGl2PiINCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBpZD0iImRpdk1haW4yIiI+Ig0KDQoNCg0KCVJlc3BvbnNlLldyaXRlICI8Zm9ybSBjbGFzcz0iInNlYXJjaCIiIGlkPSIiZWRpdCIiIG1ldGhvZD0iInBvc3QiIiBhY3Rpb249IiIuLi9hZG1pbi9hZG1pbi5hc3A/YWN0PUFydGljbGVNbmcmYW1wO3R5cGU9UGFnZSIiPiINCg0KCVJlc3BvbnNlLldyaXRlICI8cD4iJlJFUExBQ0UoWkNfTVNHMTU4LFpDX01TRzA0OCxaQ19NU0cxNjApJiI6Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Ig0KDQoJUmVzcG9uc2UuV3JpdGUgWkNfTVNHMDYxJiIgPHNlbGVjdCBjbGFzcz0iImVkaXQiIiBzaXplPSIiMSIiIGlkPSIibGV2ZWwiIiBuYW1lPSIibGV2ZWwiIiBzdHlsZT0iIndpZHRoOjgwcHg7IiIgPjxvcHRpb24gdmFsdWU9IiItMSIiPiImWkNfTVNHMTU3JiI8L29wdGlvbj4gIg0KDQoJRm9yIGk9TEJvdW5kKFpWQV9BcnRpY2xlX0xldmVsX05hbWUpKzEgdG8gVWJvdW5kKFpWQV9BcnRpY2xlX0xldmVsX05hbWUpDQoJCQlSZXNwb25zZS5Xcml0ZSAiPG9wdGlvbiB2YWx1ZT0iIiImaSYiIiIgIg0KCQkJUmVzcG9uc2UuV3JpdGUgIj4iJlJlcGxhY2UoWlZBX0FydGljbGVfTGV2ZWxfTmFtZShpKSxaQ19NU0cwNDgsWkNfTVNHMTYwKSAmIjwvb3B0aW9uPiINCglOZXh0DQoJUmVzcG9uc2UuV3JpdGUgIjwvc2VsZWN0PiINCg0KCVJlc3BvbnNlLldyaXRlICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDs8aW5wdXQgaWQ9IiJ0aXRsZSIiIG5hbWU9IiJ0aXRsZSIiIHN0eWxlPSIid2lkdGg6MjUwcHg7IiIgdHlwZT0iInRleHQiIiB2YWx1ZT0iIiIiIC8+ICINCglSZXNwb25zZS5Xcml0ZSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7PGlucHV0IHR5cGU9IiJzdWJtaXQiIiBjbGFzcz0iImJ1dHRvbiIiIHZhbHVlPSIiIiZaQ19NU0cwODcmIiIiLz4iDQoNCglSZXNwb25zZS5Xcml0ZSAiPC9wPjwvZm9ybT4iDQoNCg0KDQoJU2V0IG9ialJTPVNlcnZlci5DcmVhdGVPYmplY3QoIkFET0RCLlJlY29yZHNldCIpDQoJb2JqUlMuQ3Vyc29yVHlwZSA9IGFkT3BlbktleXNldA0KCW9ialJTLkxvY2tUeXBlID0gYWRMb2NrUmVhZE9ubHkNCglvYmpSUy5BY3RpdmVDb25uZWN0aW9uPW9iakNvbm4NCglvYmpSUy5Tb3VyY2U9IiINCg0KCXN0clNRTD0iV0hFUkUgKFtsb2dfVHlwZV09MSkgQU5EIChbbG9nX0xldmVsXT4wKSBBTkQgKDE9MSkgIg0KDQoJSWYgQ2hlY2tSaWdodHMoIlJvb3QiKT1GYWxzZSBBbmQgQ2hlY2tSaWdodHMoIkFydGljbGVBbGwiKT1GYWxzZSBUaGVuIHN0clNRTD0gc3RyU1FMICYgIkFORCBbbG9nX0F1dGhvcklEXSA9ICIgJiBCbG9nVXNlci5JRA0KDQoJSWYgaW50Q2F0ZTw+LTEgVGhlbg0KCQlEaW0gc3RyU3ViQ2F0ZUlEIDogc3RyU3ViQ2F0ZUlEPUpvaW4oR2V0U3ViQ2F0ZUlEKGludENhdGUsVHJ1ZSksIiwiKQ0KCQlzdHJTUUw9IHN0clNRTCAmICIgQU5EIFtsb2dfQ2F0ZUlEXSBJTiAoIiAmIHN0clN1YkNhdGVJRCAmICIpIg0KCUVuZCBJZg0KDQoJSWYgaW50TGV2ZWw8Pi0xIFRoZW4NCgkJc3RyU1FMPSBzdHJTUUwgJiAiIEFORCBbbG9nX0xldmVsXSA9ICIgJiBpbnRMZXZlbA0KCUVuZCBJZg0KDQoJSWYgaW50VGl0bGU8PiItMSIgVGhlbg0KCQlJZiBaQ19NU1NRTF9FTkFCTEU9RmFsc2UgVGhlbg0KCQkJc3RyU1FMID0gc3RyU1FMICYgIkFORCAoIChJblN0cigxLExDYXNlKFtsb2dfVGl0bGVdKSxMQ2FzZSgnIiAmIGludFRpdGxlICYiJyksMCk8PjApIE9SIChJblN0cigxLExDYXNlKFtsb2dfSW50cm9dKSxMQ2FzZSgnIiAmIGludFRpdGxlICYiJyksMCk8PjApIE9SIChJblN0cigxLExDYXNlKFtsb2dfQ29udGVudF0pLExDYXNlKCciICYgaW50VGl0bGUgJiInKSwwKTw+MCkgKSINCgkJRWxzZQ0KCQkJc3RyU1FMID0gc3RyU1FMICYgIkFORCAoIChDSEFSSU5ERVgoJyIgJiBpbnRUaXRsZSAmIicsW2xvZ19UaXRsZV0pPD4wKSBPUiAoQ0hBUklOREVYKCciICYgaW50VGl0bGUgJiInLFtsb2dfSW50cm9dKTw+MCkgT1IgKENIQVJJTkRFWCgnIiAmIGludFRpdGxlICYiJyxbbG9nX0NvbnRlbnRdKTw+MCkgKSINCgkJRW5kIElmDQoJRW5kIElmDQoNCglSZXNwb25zZS5Xcml0ZSAiPHRhYmxlIGJvcmRlcj0iIjEiIiB3aWR0aD0iIjEwMCUiIiBjZWxsc3BhY2luZz0iIjAiIiBjZWxscGFkZGluZz0iIjAiIiAgY2xhc3M9IiJ0YWJsZUJvcmRlciB0YWJsZUJvcmRlci10aGNlbnRlciIiPiINCglSZXNwb25zZS5Xcml0ZSAiPHRyPjx0aCB3aWR0aD0nNSUnPiImIFpDX01TRzA3NiAmIjwvdGg+PHRoIHdpZHRoPScxNCUnPiImIFpDX01TRzAwMyAmIjwvdGg+PHRoPiImIFpDX01TRzA2MCAmIjwvdGg+PHRoIHdpZHRoPScxNCUnPiImIFpDX01TRzA3NSAmIjwvdGg+PHRoIHdpZHRoPSIiNiUiIj4iJiBaQ19NU0cwMTMgJiI8L3RoPjx0aCB3aWR0aD0iIjklIiI+IiYgWkNfTVNHMDYxICYiPC90aD48dGggd2lkdGg9IiIxMiUiIj48L3RoPjwvdHI+Ig0KDQoJb2JqUlMuT3BlbigiU0VMRUNUICogRlJPTSBbYmxvZ19BcnRpY2xlXSAiJiBzdHJTUUwgJiIgT1JERVIgQlkgW2xvZ19Qb3N0VGltZV0gREVTQyIpDQoJb2JqUlMuUGFnZVNpemU9WkNfTUFOQUdFX0NPVU5UDQoJSWYgb2JqUlMuUGFnZUNvdW50PjAgVGhlbiBvYmpSUy5BYnNvbHV0ZVBhZ2UgPSBpbnRQYWdlDQoJaW50UGFnZUFsbD1vYmpSUy5QYWdlQ291bnQNCg0KCUlmIChOb3Qgb2JqUlMuYm9mKSBBbmQgKE5vdCBvYmpSUy5lb2YpIFRoZW4NCg0KCQlGb3IgaT0xIHRvIG9ialJTLlBhZ2VTaXplDQoNCgkJCVJlc3BvbnNlLldyaXRlICI8dHI+Ig0KDQoJCQlSZXNwb25zZS5Xcml0ZSAiPHRkPiIgJiBvYmpSUygibG9nX0lEIikgJiAiPC90ZD4iDQoNCgkJCUNhbGwgR2V0VXNlcnNieVVzZXJJRExpc3Qob2JqUlMoImxvZ19BdXRob3JJRCIpKQ0KCQkJRGltIFVzZXINCgkJCUZvciBFYWNoIFVzZXIgaW4gVXNlcnMNCgkJCQlJZiBJc09iamVjdChVc2VyKSBUaGVuDQoJCQkJCUlmIFVzZXIuSUQ9b2JqUlMoImxvZ19BdXRob3JJRCIpIFRoZW4NCgkJCQkJCVJlc3BvbnNlLldyaXRlICI8dGQ+IiAmIFVzZXIuTmFtZSAmICI8L3RkPiINCgkJCQkJRW5kIElmDQoJCQkJRW5kIElmDQoJCQlOZXh0DQoNCgkJCVJlc3BvbnNlLldyaXRlICI8dGQ+PGRpdiBzdHlsZT0nb3ZlcmZsb3c6aGlkZGVuO2hlaWdodDoxLjVlbTsnPjxhIGhyZWY9IiIuLi8uLi92aWV3LmFzcD9uYXY9IiAmIG9ialJTKCJsb2dfSUQiKSAmICIiIiB0aXRsZT0iIiImIFJlcGxhY2Uob2JqUlMoImxvZ19UaXRsZSIpLCIiIiIsIiIpICYiIiIgdGFyZ2V0PSIiX2JsYW5rIiI+IiAmIG9ialJTKCJsb2dfVGl0bGUiKSAmICI8L2E+PC9kaXY+PC90ZD4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiPHRkPiIgJiBGb3JtYXREYXRlVGltZShvYmpSUygibG9nX1Bvc3RUaW1lIiksdmJTaG9ydERhdGUpICYgIjwvdGQ+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIjx0ZD4iICYgb2JqUlMoImxvZ19Db21tTnVtcyIpICYgIjwvdGQ+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIjx0ZD4iICYgWlZBX0FydGljbGVfTGV2ZWxfTmFtZShvYmpSUygibG9nX0xldmVsIikpICYgIjwvdGQ+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIjx0ZCBhbGlnbj0iImNlbnRlciIiPjxhIGhyZWY9IiIuLi9jbWQuYXNwP2FjdD1BcnRpY2xlRWR0JmFtcDt0eXBlPVBhZ2UmYW1wO3dlYmVkaXQ9IiYgWkNfQkxPR19XRUJFRElUICYiJmFtcDtpZD0iICYgb2JqUlMoImxvZ19JRCIpICYgIiIiPjxpbWcgc3JjPSIiLi4vaW1hZ2UvYWRtaW4vcGFnZV9lZGl0LnBuZyIiIGFsdD0iIiIgJiBaQ19NU0cxMDAgJiAiIiIgdGl0bGU9IiIiICYgWkNfTVNHMTAwICYgIiIiIHdpZHRoPSIiMTYiIiAvPjwvYT4mbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiDQoJCQlSZXNwb25zZS5Xcml0ZSAiPGEgb25jbGljaz0ncmV0dXJuIHdpbmRvdy5jb25maXJtKCIiIiYgWkNfTVNHMDU4ICYiIiIpOycgaHJlZj0iIi4uL2NtZC5hc3A/YWN0PUFydGljbGVEZWwmYW1wO3R5cGU9UGFnZSZhbXA7aWQ9IiAmIG9ialJTKCJsb2dfSUQiKSAmICIiIj48aW1nIHNyYz0iIi4uL2ltYWdlL2FkbWluL2RlbGV0ZS5wbmciIiBhbHQ9IiIiICYgWkNfTVNHMDYzICYgIiIiIHRpdGxlPSIiIiAmIFpDX01TRzA2MyAmICIiIiB3aWR0aD0iIjE2IiIgLz48L2E+PC90ZD4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiPC90cj4iDQoNCgkJCW9ialJTLk1vdmVOZXh0DQoJCQlJZiBvYmpSUy5lb2YgVGhlbiBFeGl0IEZvcg0KDQoJCU5leHQNCg0KCUVuZCBJZg0KDQoJUmVzcG9uc2UuV3JpdGUgIjwvdGFibGU+Ig0KDQoJSWYgIGludFBhZ2VBbGw+MSBUaGVuIA0KCQlzdHJQYWdlPUV4cG9ydFBhZ2VCYXIoaW50UGFnZSxpbnRQYWdlQWxsLFpDX1BBR0VCQVJfQ09VTlQsIi4uL2FkbWluL2FkbWluLmFzcD9hY3Q9QXJ0aWNsZU1uZyZhbXA7dHlwZT1QYWdlJmFtcDtjYXRlPSImUmVRdWVzdCgiY2F0ZSIpJiImYW1wO2xldmVsPSImUmVRdWVzdCgibGV2ZWwiKSYiJmFtcDt0aXRsZT0iJkVzY2FwZShSZVF1ZXN0KCJ0aXRsZSIpKSAmICImYW1wO3BhZ2U9IikNCgkJUmVzcG9uc2UuV3JpdGUgIjxoci8+PHAgY2xhc3M9IiJwYWdlYmFyIiI+IiAmIFpDX01TRzA0MiAmICI6ICIgJiBzdHJQYWdlICYgIjwvcD4iDQoJRW5kIElmIA0KDQoJUmVzcG9uc2UuV3JpdGUgIjwvZGl2PiINCg0KCVJlc3BvbnNlLldyaXRlICI8c2NyaXB0IHR5cGU9IiJ0ZXh0L2phdmFzY3JpcHQiIj5BY3RpdmVMZWZ0TWVudSgiImFQYWdlTW5nIiIpOzwvc2NyaXB0PiINCg0KCW9ialJTLkNsb3NlDQoJU2V0IG9ialJTPU5vdGhpbmcNCg0KCUV4cG9ydFBhZ2VMaXN0PVRydWUNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIE1hbmFnZXIgQ2F0ZWdvcnlzDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBFeHBvcnRDYXRlZ29yeUxpc3QoaW50UGFnZSkNCg0KCUNhbGwgQWRkX1Jlc3BvbnNlX1BsdWdpbigiUmVzcG9uc2VfUGx1Z2luX0NhdGVnb3J5TW5nX1N1Yk1lbnUiLE1ha2VTdWJNZW51KFpDX01TRzA3NyAmICIiLCIuLi9jbWQuYXNwP2FjdD1DYXRlZ29yeUVkdCIsIm0tbGVmdCIsRmFsc2UpKQ0KDQoJRGltIGksag0KDQoJUmVzcG9uc2UuV3JpdGUgIjxkaXYgY2xhc3M9IiJkaXZIZWFkZXIiIj4iICYgWkNfTVNHMDY2ICYgIjwvZGl2PiINCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iIlN1Yk1lbnUiIj4iICYgUmVzcG9uc2VfUGx1Z2luX0NhdGVnb3J5TW5nX1N1Yk1lbnUgJiAiPC9kaXY+Ig0KCVJlc3BvbnNlLldyaXRlICI8ZGl2IGlkPSIiZGl2TWFpbjIiIj4iDQoNCg0KCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoaW50UGFnZSwiaW50IiwxKQ0KJ+KInw0KDQoJUmVzcG9uc2UuV3JpdGUgIjx0YWJsZSBib3JkZXI9IiIxIiIgd2lkdGg9IiIxMDAlIiIgY2VsbHNwYWNpbmc9IiIwIiIgY2VsbHBhZGRpbmc9IiIwIiIgY2xhc3M9J3RhYmxlQm9yZGVyIHRhYmxlQm9yZGVyLXRoY2VudGVyJz4iDQoJUmVzcG9uc2UuV3JpdGUgIjx0cj48dGggd2lkdGg9IiI1JSIiPjwvdGg+PHRoIHdpZHRoPSIiMTAlIiI+IiYgWkNfTVNHMDc2ICYiPC90aD48dGggd2lkdGg9IiIxMCUiIj4iJiBaQ19NU0cwNzkgJiI8L3RoPjx0aD4iJiBaQ19NU0cwMDEgJiI8L3RoPjx0aD4iJiBaQ19NU0cxNDcgJiI8L3RoPjx0aCB3aWR0aD0iIjE0JSIiPjwvdGg+PC90cj4iDQoNCg0KCVJlc3BvbnNlLldyaXRlICI8dHI+PHRkIGFsaWduPSIiY2VudGVyIiI+PGltZyB3aWR0aD0iIjE2IiIgc3JjPSIiLi4vaW1hZ2UvYWRtaW4vZm9sZGVyLnBuZyIiIGFsdD0iIiIiIC8+PC90ZD4iDQoJUmVzcG9uc2UuV3JpdGUgIjx0ZD4iICYgQ2F0ZWdvcnlzKDApLklEICYgIjwvdGQ+Ig0KCVJlc3BvbnNlLldyaXRlICI8dGQ+IiAmIENhdGVnb3J5cygwKS5PcmRlciAmICI8L3RkPiINCglSZXNwb25zZS5Xcml0ZSAiPHRkPjxhIGhyZWY9IiIiJiBDYXRlZ29yeXMoMCkuVXJsICYiIiIgIHRhcmdldD0iIl9ibGFuayIiPiIgJiBDYXRlZ29yeXMoMCkuTmFtZSAmICI8L2E+PC90ZD4iDQoJUmVzcG9uc2UuV3JpdGUgIjx0ZD4iICYgQ2F0ZWdvcnlzKDApLkFsaWFzICYgIjwvdGQ+Ig0KCVJlc3BvbnNlLldyaXRlICI8dGQgYWxpZ249IiJjZW50ZXIiIj48YSBocmVmPSIiLi4vY21kLmFzcD9hY3Q9Q2F0ZWdvcnlFZHQmYW1wO2lkPSImIENhdGVnb3J5cygwKS5JRCAmIiIiPjxpbWcgc3JjPSIiLi4vaW1hZ2UvYWRtaW4vZm9sZGVyX2VkaXQucG5nIiIgYWx0PSIiIiAmIFpDX01TRzA3OCAmICIiIiB0aXRsZT0iIiIgJiBaQ19NU0cwNzggJiAiIiIgd2lkdGg9IiIxNiIiIC8+PC9hPjwvdGQ+Ig0KCVJlc3BvbnNlLldyaXRlICI8L3RyPiINCg0KDQoNCg0KCURpbSBhcnlDYXRlSW5PcmRlcg0KCWFyeUNhdGVJbk9yZGVyPUdldENhdGVnb3J5T3JkZXIoKQ0KDQoJSWYgSXNBcnJheShhcnlDYXRlSW5PcmRlcikgVGhlbg0KCUZvciBpPUxCb3VuZChhcnlDYXRlSW5PcmRlcikrMSBUbyBVYm91bmQoYXJ5Q2F0ZUluT3JkZXIpDQoNCgkJSWYgQ2F0ZWdvcnlzKGFyeUNhdGVJbk9yZGVyKGkpKS5QYXJlbnRJRD0wIFRoZW4NCg0KCQkJUmVzcG9uc2UuV3JpdGUgIjx0cj48dGQgYWxpZ249IiJjZW50ZXIiIj48aW1nIHdpZHRoPSIiMTYiIiBzcmM9IiIuLi9pbWFnZS9hZG1pbi9mb2xkZXIucG5nIiIgYWx0PSIiIiIgLz48L3RkPiINCgkJCVJlc3BvbnNlLldyaXRlICI8dGQ+IiAmIENhdGVnb3J5cyhhcnlDYXRlSW5PcmRlcihpKSkuSUQgJiAiPC90ZD4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiPHRkPiIgJiBDYXRlZ29yeXMoYXJ5Q2F0ZUluT3JkZXIoaSkpLk9yZGVyICYgIjwvdGQ+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIjx0ZD48YSBocmVmPSIiIiYgQ2F0ZWdvcnlzKGFyeUNhdGVJbk9yZGVyKGkpKS5VcmwgJiIiIiAgdGFyZ2V0PSIiX2JsYW5rIiI+IiAmIENhdGVnb3J5cyhhcnlDYXRlSW5PcmRlcihpKSkuTmFtZSAmICI8L2E+PC90ZD4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiPHRkPiIgJiBDYXRlZ29yeXMoYXJ5Q2F0ZUluT3JkZXIoaSkpLkFsaWFzICYgIjwvdGQ+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIjx0ZCBhbGlnbj0iImNlbnRlciIiPjxhIGhyZWY9IiIuLi9jbWQuYXNwP2FjdD1DYXRlZ29yeUVkdCZhbXA7aWQ9IiYgQ2F0ZWdvcnlzKGFyeUNhdGVJbk9yZGVyKGkpKS5JRCAmIiIiPjxpbWcgc3JjPSIiLi4vaW1hZ2UvYWRtaW4vZm9sZGVyX2VkaXQucG5nIiIgYWx0PSIiIiAmIFpDX01TRzA3OCAmICIiIiB0aXRsZT0iIiIgJiBaQ19NU0cwNzggJiAiIiIgd2lkdGg9IiIxNiIiIC8+PC9hPiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOzxhIG9uY2xpY2s9J3JldHVybiB3aW5kb3cuY29uZmlybSgiIiImIFpDX01TRzA1OCAmIiIiKTsnIGhyZWY9IiIuLi9jbWQuYXNwP2FjdD1DYXRlZ29yeURlbCZhbXA7aWQ9IiYgQ2F0ZWdvcnlzKGFyeUNhdGVJbk9yZGVyKGkpKS5JRCAmIiIiPjxpbWcgc3JjPSIiLi4vaW1hZ2UvYWRtaW4vZGVsZXRlLnBuZyIiIGFsdD0iIiIgJiBaQ19NU0cwNjMgJiAiIiIgdGl0bGU9IiIiICYgWkNfTVNHMDYzICYgIiIiIHdpZHRoPSIiMTYiIiAvPjwvYT48L3RkPiINCgkJCVJlc3BvbnNlLldyaXRlICI8L3RyPiINCg0KCQkJRm9yIGo9MSBUbyBVQm91bmQoYXJ5Q2F0ZUluT3JkZXIpDQoNCgkJCQlJZiBDYXRlZ29yeXMoYXJ5Q2F0ZUluT3JkZXIoaikpLlBhcmVudElEPUNhdGVnb3J5cyhhcnlDYXRlSW5PcmRlcihpKSkuSUQgVGhlbg0KCQkJCQlSZXNwb25zZS5Xcml0ZSAiPHRyPjx0ZCBhbGlnbj0iImNlbnRlciIiPjxpbWcgd2lkdGg9IiIxNiIiIHNyYz0iIi4uL2ltYWdlL2FkbWluL2Fycm93X3R1cm5fcmlnaHQucG5nIiIgYWx0PSIiIiIgLz48L3RkPiINCgkJCQkJUmVzcG9uc2UuV3JpdGUgIjx0ZD4iICYgQ2F0ZWdvcnlzKGFyeUNhdGVJbk9yZGVyKGopKS5JRCAmICI8L3RkPiINCgkJCQkJUmVzcG9uc2UuV3JpdGUgIjx0ZD4iICYgQ2F0ZWdvcnlzKGFyeUNhdGVJbk9yZGVyKGopKS5PcmRlciAmICI8L3RkPiINCgkJCQkJUmVzcG9uc2UuV3JpdGUgIjx0ZD48YSBocmVmPSIiIiYgQ2F0ZWdvcnlzKGFyeUNhdGVJbk9yZGVyKGopKS5VcmwgJiIiIiAgdGFyZ2V0PSIiX2JsYW5rIiI+IiAmIENhdGVnb3J5cyhhcnlDYXRlSW5PcmRlcihqKSkuTmFtZSAmICI8L2E+PC90ZD4iDQoJCQkJCVJlc3BvbnNlLldyaXRlICI8dGQ+IiAmIENhdGVnb3J5cyhhcnlDYXRlSW5PcmRlcihqKSkuQWxpYXMgJiAiPC90ZD4iDQoJCQkJCVJlc3BvbnNlLldyaXRlICI8dGQgYWxpZ249IiJjZW50ZXIiIj48YSBocmVmPSIiLi4vY21kLmFzcD9hY3Q9Q2F0ZWdvcnlFZHQmYW1wO2lkPSImIENhdGVnb3J5cyhhcnlDYXRlSW5PcmRlcihqKSkuSUQgJiIiIj48aW1nIHNyYz0iIi4uL2ltYWdlL2FkbWluL2ZvbGRlcl9lZGl0LnBuZyIiIGFsdD0iIiIgJiBaQ19NU0cwNzggJiAiIiIgdGl0bGU9IiIiICYgWkNfTVNHMDc4ICYgIiIiIHdpZHRoPSIiMTYiIiAvPjwvYT4mbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDs8YSBvbmNsaWNrPSdyZXR1cm4gd2luZG93LmNvbmZpcm0oIiIiJiBaQ19NU0cwNTggJiIiIik7JyBocmVmPSIiLi4vY21kLmFzcD9hY3Q9Q2F0ZWdvcnlEZWwmYW1wO2lkPSImIENhdGVnb3J5cyhhcnlDYXRlSW5PcmRlcihqKSkuSUQgJiIiIj48aW1nIHNyYz0iIi4uL2ltYWdlL2FkbWluL2RlbGV0ZS5wbmciIiBhbHQ9IiIiICYgWkNfTVNHMDYzICYgIiIiIHRpdGxlPSIiIiAmIFpDX01TRzA2MyAmICIiIiB3aWR0aD0iIjE2IiIgLz48L2E+PC90ZD4iDQoJCQkJCVJlc3BvbnNlLldyaXRlICI8L3RyPiINCgkJCQlFbmQgSWYNCg0KCQkJTmV4dA0KDQoJCUVuZCBJZg0KDQoJTmV4dA0KCUVuZCBJZg0KDQoJUmVzcG9uc2UuV3JpdGUgIjwvdGFibGU+Ig0KDQoJUmVzcG9uc2UuV3JpdGUgIjxwPiZuYnNwOzwvcD4iDQoJUmVzcG9uc2UuV3JpdGUgIjwvZGl2PiINCg0KCVJlc3BvbnNlLldyaXRlICI8c2NyaXB0IHR5cGU9IiJ0ZXh0L2phdmFzY3JpcHQiIj5BY3RpdmVMZWZ0TWVudSgiImFDYXRlZ29yeU1uZyIiKTs8L3NjcmlwdD4iDQoNCglFeHBvcnRDYXRlZ29yeUxpc3Q9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgTWFuYWdlciBDb21tZW50cw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gRXhwb3J0Q29tbWVudExpc3QoaW50UGFnZSxpbnRDb250ZW50LGlzQ2hlY2spDQoNCg0KDQoJRGltIEFydERpYw0KDQoJU2V0IEFydERpYz1DcmVhdGVPYmplY3QoIlNjcmlwdGluZy5EaWN0aW9uYXJ5IikNCg0KCURpbSBpDQoJRGltIG9ialJTDQoJRGltIHN0clNRTA0KCURpbSBzdHJQYWdlDQoJRGltIGludFBhZ2VBbGwNCg0KCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoaW50UGFnZSwiaW50IiwxKQ0KCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoaXNDaGVjaywiYm9vbCIsRmFsc2UpDQoJaW50Q29udGVudD1GaWx0ZXJTUUwoaW50Q29udGVudCkNCg0KCVNldCBvYmpSUz1TZXJ2ZXIuQ3JlYXRlT2JqZWN0KCJBRE9EQi5SZWNvcmRzZXQiKQ0KCW9ialJTLkN1cnNvclR5cGUgPSBhZE9wZW5LZXlzZXQNCglvYmpSUy5Mb2NrVHlwZSA9IGFkTG9ja1JlYWRPbmx5DQoJb2JqUlMuQWN0aXZlQ29ubmVjdGlvbj1vYmpDb25uDQoJb2JqUlMuU291cmNlPSIiDQoJDQoJQ2FsbCBBZGRfUmVzcG9uc2VfUGx1Z2luKCJSZXNwb25zZV9QbHVnaW5fQ29tbWVudE1uZ19TdWJNZW51IixNYWtlU3ViTWVudShaQ19NU0cwOTcsImFkbWluLmFzcD9hY3Q9Q29tbWVudE1uZyZhbXA7cGFnZT0iLCJtLWxlZnQiICYgSUlmKGlzQ2hlY2ssIiIsIiBtLW5vdyIpLEZhbHNlKSkNCglEaW0gb2JqUlMxDQoJU2V0IG9ialJTMT1vYmpDb25uLkV4ZWN1dGUoIlNFTEVDVCBDT1VOVChbY29tbV9JRF0pIEZST00gW2Jsb2dfQ29tbWVudF0gV0hFUkUgW2NvbW1faXNDaGVja109LTEgT3IgW2NvbW1faXNDaGVja109MSIgJiBJSWYoQ2hlY2tSaWdodHMoIlJvb3QiKSwiIiwiIEFuZCBbY29tbV9BdXRob3JJRF09IiAmIEJsb2dVc2VyLklEKSkNCg0KCURpbSBzdHJ0bXByZXNwb25zZQ0KCXN0cnRtcHJlc3BvbnNlPVpDX01TRzEwNA0KCUlmIChOb3Qgb2JqUlMxLmJvZikgQW5kIChOb3Qgb2JqUlMxLmVvZikgVGhlbg0KCQlzdHJ0bXByZXNwb25zZT1zdHJ0bXByZXNwb25zZSYiICgiJm9ialJTMSgwKSYiKSINCglFbmQgSWYNCglTZXQgb2JqUnMxPU5vdGhpbmcNCgkNCglDYWxsIEFkZF9SZXNwb25zZV9QbHVnaW4oIlJlc3BvbnNlX1BsdWdpbl9Db21tZW50TW5nX1N1Yk1lbnUiLE1ha2VTdWJNZW51KHN0cnRtcHJlc3BvbnNlLCJhZG1pbi5hc3A/YWN0PUNvbW1lbnRNbmcmYW1wO2lzQ2hlY2s9VHJ1ZSIsIm0tbGVmdCIgJiBJSWYoaXNDaGVjaywiIG0tbm93IiwiIiksRmFsc2UpKQ0KCQ0KCUlmIGlzQ2hlY2sgVGhlbg0KCQlzdHJTUUw9c3RyU1FMJiIgV0hFUkUgIChbbG9nX0lEXT4wKSBBTkQgKFtjb21tX2lzQ2hlY2tdPD4wKSAiDQoJRWxzZQ0KCQlzdHJTUUw9c3RyU1FMJiIgV0hFUkUgIChbbG9nX0lEXT4wKSBBTkQgKFtjb21tX2lzQ2hlY2tdPTApICINCglFbmQgSWYNCgkNCglJZiBDaGVja1JpZ2h0cygiUm9vdCIpPUZhbHNlIEFuZCBDaGVja1JpZ2h0cygiQ29tbWVudEFsbCIpPUZhbHNlIFRoZW4NCgkJc3RyU1FMPXN0clNRTCAmICJBTkQoIChbY29tbV9BdXRob3JJRF0gPSAiICYgQmxvZ1VzZXIuSUQgJiAiICkgT1IgKChTRUxFQ1QgW2xvZ19BdXRob3JJRF0gRlJPTSBbYmxvZ19BcnRpY2xlXSBXSEVSRSBbYmxvZ19BcnRpY2xlXS5bbG9nX0lEXT1bYmxvZ19Db21tZW50XS5bbG9nX0lEXSk9IiAmIEJsb2dVc2VyLklEICYgIiApKSAiDQoJRW5kIElmDQoNCglJZiBUcmltKGludENvbnRlbnQpPD4iIiBUaGVuDQoJCXN0clNRTD1zdHJTUUwgJiAiIEFORCAoIChbY29tbV9BdXRob3JdIExJS0UgJyUiICYgaW50Q29udGVudCAmICIlJykgT1IgKFtjb21tX0NvbnRlbnRdIExJS0UgJyUiICYgaW50Q29udGVudCAmICIlJykgT1IgKFtjb21tX0hvbWVQYWdlXSBMSUtFICclIiAmIGludENvbnRlbnQgJiAiJScpICkgIg0KCUVuZCBJZg0KDQoJUmVzcG9uc2UuV3JpdGUgIjxkaXYgY2xhc3M9IiJkaXZIZWFkZXIiIj4iICYgWkNfTVNHMDY4ICYgIjwvZGl2PiINCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iIlN1Yk1lbnUiIj4iICYgUmVzcG9uc2VfUGx1Z2luX0NvbW1lbnRNbmdfU3ViTWVudSAmICI8L2Rpdj4iDQoJUmVzcG9uc2UuV3JpdGUgIjxkaXYgaWQ9IiJkaXZNYWluMiIiPiINCg0KDQoJUmVzcG9uc2UuV3JpdGUgIjxmb3JtIGNsYXNzPSIic2VhcmNoIiIgaWQ9IiJlZGl0IiIgbWV0aG9kPSIicG9zdCIiIGFjdGlvbj0iIi4uL2FkbWluL2FkbWluLmFzcD9hY3Q9Q29tbWVudE1uZyZhbXA7aXNDaGVjaz0iJmlzQ2hlY2smIiIiPiINCglSZXNwb25zZS5Xcml0ZSAiPHA+IiZaQ19NU0cyMzQmIjombmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiDQoNCglSZXNwb25zZS5Xcml0ZSAiPGlucHV0IGlkPSIiaW50Q29udGVudCIiIG5hbWU9IiJpbnRDb250ZW50IiIgc3R5bGU9IiJ3aWR0aDoyNTBweDsiIiB0eXBlPSIidGV4dCIiIHZhbHVlPSIiIiIgLz4gIg0KCVJlc3BvbnNlLldyaXRlICI8aW5wdXQgdHlwZT0iInN1Ym1pdCIiIGNsYXNzPSIiYnV0dG9uIiIgdmFsdWU9IiIiJlpDX01TRzA4NyYiIiIvPiINCg0KCVJlc3BvbnNlLldyaXRlICI8L3A+PC9mb3JtPiINCg0KCVJlc3BvbnNlLldyaXRlICI8dGFibGUgYm9yZGVyPSIiMSIiIHdpZHRoPSIiMTAwJSIiIGNlbGxzcGFjaW5nPSIiMCIiIGNlbGxwYWRkaW5nPSIiMCIiIGNsYXNzPSIidGFibGVCb3JkZXIgdGFibGVCb3JkZXItdGhjZW50ZXIiIj4iDQoJUmVzcG9uc2UuV3JpdGUgIjx0cj48dGggd2lkdGg9IiI1JSIiPiImIFpDX01TRzA3NiAmIjwvdGg+PHRoIHdpZHRoPSIiNiUiIj4iJlpDX01TRzE1MiYiPC90aD48dGggd2lkdGg9JzEwJSc+IiYgWkNfTVNHMDAzICYiPC90aD48dGg+IiYgWkNfTVNHMDU1ICYiPC90aD48dGggd2lkdGg9IiIxNSUiIj4iJiBaQ19NU0cwNDggJiI8L3RoPjx0aCB3aWR0aD0nMTglJz48L3RoPjx0aCB3aWR0aD0nNSUnICBhbGlnbj0nY2VudGVyJz48YSBocmVmPScnIG9uY2xpY2s9J0JhdGNoU2VsZWN0QWxsKCk7cmV0dXJuIGZhbHNlJz4iJiBaQ19NU0cyMjkgJiI8L2E+PC90aD48L3RyPiInDQoNCglvYmpSUy5PcGVuKCJTRUxFQ1QgKiBGUk9NIFtibG9nX0NvbW1lbnRdICImIHN0clNRTCAmIiBPUkRFUiBCWSBbY29tbV9JRF0gREVTQyIpDQoNCg0KCW9ialJTLlBhZ2VTaXplPVpDX01BTkFHRV9DT1VOVA0KCUlmIG9ialJTLlBhZ2VDb3VudD4wIFRoZW4gb2JqUlMuQWJzb2x1dGVQYWdlID0gaW50UGFnZQ0KCWludFBhZ2VBbGw9b2JqUlMuUGFnZUNvdW50DQoNCglJZiAoTm90IG9ialJTLmJvZikgQW5kIChOb3Qgb2JqUlMuZW9mKSBUaGVuDQoNCgkJRm9yIGk9MSB0byBvYmpSUy5QYWdlU2l6ZQ0KCQkJRGltIG9iakFydGljbGUNCgkJCVNldCBvYmpBcnRpY2xlPU5ldyBUQXJ0aWNsZQ0KCQkJSWYgQXJ0RGljLkV4aXN0cyhDTG5nKG9ialJzKCJsb2dfSUQiKSkpPUZhbHNlIFRoZW4NCgkJCQlvYmpBcnRpY2xlLkxvYWRJbmZvQnlJZCBvYmpScygibG9nX0lEIikNCgkJCQlBcnREaWMuQWRkIENMbmcob2JqUnMoImxvZ19JRCIpKSwgb2JqQXJ0aWNsZQ0KCQkJRWxzZQ0KCQkJCVNldCBvYmpBcnRpY2xlPUFydERpYy5JdGVtKENMbmcob2JqUnMoImxvZ19JRCIpKSkNCgkJCUVuZCBJZg0KDQoJCQlSZXNwb25zZS5Xcml0ZSAiPHRyPiINCgkJCVJlc3BvbnNlLldyaXRlICI8dGQ+IiAmIG9ialJTKCJjb21tX0lEIikgJiAiPC90ZD4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiPHRkPiImSUlGKG9ialJzKCJjb21tX1BhcmVudElEIik+MCxvYmpScygiY29tbV9QYXJlbnRJRCIpLCIiKSYiPC90ZD4iDQoJCQlJZiBUcmltKG9ialJTKCJjb21tX0VtYWlsIikpPSIiIFRoZW4NCgkJCVJlc3BvbnNlLldyaXRlICI8dGQ+IiYgb2JqUlMoImNvbW1fQXV0aG9yIikgJiAiPC90ZD4iDQoJCQlFbHNlDQoJCQlSZXNwb25zZS5Xcml0ZSAiPHRkPjxhIGhyZWY9IiJtYWlsdG86IiYgb2JqUlMoImNvbW1fRW1haWwiKSAmIiIiPiIgJiBvYmpSUygiY29tbV9BdXRob3IiKSAmICI8L2E+PC90ZD4iDQoJCQlFbmQgSWYNCg0KCQkJUmVzcG9uc2UuV3JpdGUgIjx0ZD48YSBocmVmPSIiIiZvYmpBcnRpY2xlLlVSTCYiI2NtdCImb2JqUlMoImNvbW1fSUQiKSYiIiIgdGFyZ2V0PSIiX2JsYW5rIiI+PGltZyBzcmM9IiIuLi9pbWFnZS9hZG1pbi9jb21tZW50LnBuZyIiIGFsdD0iIiIgJiBaQ19NU0cyMTImICIgQCAiICYgb2JqQXJ0aWNsZS5IdG1sVGl0bGUgJiAiIiIgdGl0bGU9IiIiICYgWkNfTVNHMjEyJiAiIEAgIiAmIG9iakFydGljbGUuSHRtbFRpdGxlICYgIiIiIHdpZHRoPSIiMTYiIiAvPjwvYT48YSBpZD0iIm15bGluayImb2JqUlMoImNvbW1fSUQiKSYiIiIgaHJlZj0iIiRkaXYiJm9ialJTKCJjb21tX0lEIikmInRpcD93aWR0aD00MDAiIiBjbGFzcz0iImJldHRlclRpcCIiIHRpdGxlPSIiIiZaQ19NU0cwNTUmIiIiPiIgJiBMZWZ0KG9ialJTKCJjb21tX0NvbnRlbnQiKSwzMCkgJiAiPC9hPjxkaXYgaWQ9IiJkaXYiJm9ialJTKCJjb21tX0lEIikmInRpcCIiIHN0eWxlPSIiZGlzcGxheTpub25lOyIiPjxwPiImIG9ialJTKCJjb21tX0NvbnRlbnQiKSAmIjwvcD48YnIvPjxwPiIgJiBaQ19NU0cwODAgJiAiIDogIiAmb2JqUlMoImNvbW1fSVAiKSAmICI8L3A+PHA+IiAmIFpDX01TRzA3NSAmICIgOiAiICZvYmpSUygiY29tbV9Qb3N0VGltZSIpICYgIjwvcD48L2Rpdj48L3RkPiINCgkJCVJlc3BvbnNlLldyaXRlICI8dGQ+PGRpdiBzdHlsZT0nb3ZlcmZsb3c6aGlkZGVuO2hlaWdodDoxLjVlbTsnPiImIExlZnQob2JqQXJ0aWNsZS5IdG1sVGl0bGUsMTgpICYiPC9kaXY+PC90ZD4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiPHRkIGFsaWduPSIiY2VudGVyIiI+PGEgaHJlZj0iIi4uL2NtZC5hc3A/YWN0PUNvbW1lbnRFZHQmYW1wO2lkPSIgJiBvYmpSUygiY29tbV9JRCIpICYiJmFtcDtyZXZpZD0iJm9ialJzKCJjb21tX0lEIikmIiZhbXA7bG9nX2lkPSImIG9ialJTKCJsb2dfSUQiKSAmIiIiPjxpbWcgc3JjPSIiLi4vaW1hZ2UvYWRtaW4vY29tbWVudHMucG5nIiIgYWx0PSIiIiAmIFpDX01TRzE0OSAmICIiIiB0aXRsZT0iIiIgJiBaQ19NU0cxNDkgJiAiIiIgd2lkdGg9IiIxNiIiIC8+PC9hPiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOzxhIGhyZWY9IiIuLi9jbWQuYXNwP2FjdD1Db21tZW50RWR0JmFtcDtpZD0iICYgb2JqUlMoImNvbW1fSUQiKSAmICImYW1wO2xvZ19pZD0iJiBvYmpSUygibG9nX0lEIikgJiImYW1wO3JldmlkPTAiIj48aW1nIHNyYz0iIi4uL2ltYWdlL2FkbWluL2NvbW1lbnRfZWRpdC5wbmciIiBhbHQ9IiIiICYgWkNfTVNHMDc4ICYgIiIiIHRpdGxlPSIiIiAmIFpDX01TRzA3OCAmICIiIiB3aWR0aD0iIjE2IiIgLz48L2E+Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7PGEgaHJlZj0iIi4uL2NtZC5hc3A/YWN0PUNvbW1lbnREZWwmYW1wO2lkPSIgJiBvYmpSUygiY29tbV9JRCIpICAmIiIiIG9uY2xpY2s9J3JldHVybiB3aW5kb3cuY29uZmlybSgiIiImIFpDX01TRzA1OCAmIiIiKTsnPjxpbWcgc3JjPSIiLi4vaW1hZ2UvYWRtaW4vZGVsZXRlLnBuZyIiIGFsdD0iIiIgJiBaQ19NU0cwNjMgJiAiIiIgdGl0bGU9IiIiICYgWkNfTVNHMDYzICYgIiIiIHdpZHRoPSIiMTYiIiAvPjwvYT4iDQoJCQkNCgkJCVJlc3BvbnNlLldyaXRlIElJZihDaGVja1JpZ2h0cygiUm9vdCIpLCImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDs8YSBocmVmPSIiLi4vY21kLmFzcD9hY3Q9Q29tbWVudEF1ZGl0JmFtcDtpZD0iJm9ialJzKCJjb21tX0lEIikmIiIiPjxpbWcgc3JjPSIiLi4vaW1hZ2UvYWRtaW4vIiZJSWYoaXNDaGVjaywib2sucG5nIiwibWludXMtc2hpZWxkLnBuZyIpJiIiIiBhbHQ9IiIiJklJZihpc0NoZWNrLFpDX01TRzA5MSxaQ19NU0cwOTIpJiIiIiB0aXRsZT0iIiImSUlmKGlzQ2hlY2ssWkNfTVNHMDkxLFpDX01TRzA5MikmIiIiIHdpZHRoPSIiMTYiIi8+PC9hPiIsIiIpDQoJCQlSZXNwb25zZS5Xcml0ZSAiPC90ZD4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiPHRkIGFsaWduPSIiY2VudGVyIiIgPjxpbnB1dCB0eXBlPSIiY2hlY2tib3giIiBpZD0iImVkdERlbCImb2JqUlMoImNvbW1fSUQiKSYiIiIgbmFtZT0iImVkdERlbCIiIHZhbHVlPSIiIiZvYmpSUygiY29tbV9JRCIpJiIiIi8+PC90ZD4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiPC90cj4iDQoNCgkJCW9ialJTLk1vdmVOZXh0DQoJCQlJZiBvYmpSUy5lb2YgVGhlbiBFeGl0IEZvcg0KDQoJCQlTZXQgb2JqQXJ0aWNsZT1Ob1RoaW5nDQoNCgkJTmV4dA0KCVNldCBvYmpBcnRpY2xlPU5vdGhpbmcNCglFbmQgSWYNCg0KCVJlc3BvbnNlLldyaXRlICI8L3RhYmxlPiINCg0KDQoJUmVzcG9uc2UuV3JpdGUgIjxmb3JtIGlkPSIiZnJtQmF0Y2giIiBzdHlsZT0iImZsb2F0OmxlZnQ7IiIgbWV0aG9kPSIicG9zdCIiIGFjdGlvbj0iIi4uL2NtZC5hc3A/YWN0PUNvbW1lbnREZWxCYXRjaCIiPjxpbnB1dCB0eXBlPSIiaGlkZGVuIiIgaWQ9IiJlZHRCYXRjaCIiIG5hbWU9IiJlZHRCYXRjaCIiIHZhbHVlPSIiIiIvPjxpbnB1dCBjbGFzcz0iImJ1dHRvbiIiIHR5cGU9IiJzdWJtaXQiIiBvbmNsaWNrPSdCYXRjaERlbGV0ZUFsbCgiImVkdEJhdGNoIiIpO2lmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCIiZWR0QmF0Y2giIikudmFsdWUpe3JldHVybiB3aW5kb3cuY29uZmlybSgiIiImIFpDX01TRzA1OCAmIiIiKTt9ZWxzZXtyZXR1cm4gZmFsc2V9JyB2YWx1ZT0iIiImWkNfTVNHMjI4JiIiIiBpZD0iImJ0blBvc3QiIi8+Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7PC9mb3JtPiIgJiB2YkNybGYNCgkNCglSZXNwb25zZS5Xcml0ZSBJSWYoQ2hlY2tSaWdodHMoIlJvb3QiKSwiPGZvcm0gaWQ9IiJmcm1CYXRjaDIiIiBzdHlsZT0iImZsb2F0OmxlZnQ7IiIgbWV0aG9kPSIicG9zdCIiIGFjdGlvbj0iIi4uL2NtZC5hc3A/YWN0PUNvbW1lbnRBdWRpdCIiPjxpbnB1dCB0eXBlPSIiaGlkZGVuIiIgaWQ9IiJlZHRCYXRjaDIiIiBuYW1lPSIiZWR0QmF0Y2giIiB2YWx1ZT0iIiIiLz48aW5wdXQgY2xhc3M9IiJidXR0b24iIiB0eXBlPSIic3VibWl0IiIgb25jbGljaz0nQmF0Y2hEZWxldGVBbGwoIiJlZHRCYXRjaDIiIik7aWYoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIiJlZHRCYXRjaDIiIikudmFsdWUpe3JldHVybiB3aW5kb3cuY29uZmlybSgiIiImIFpDX01TRzA1OCAmIiIiKTt9ZWxzZXtyZXR1cm4gZmFsc2V9JyB2YWx1ZT0iIiImSUlmKGlzQ2hlY2ssWkNfTVNHMTc0LFpDX01TRzE3NykmIiIiIGlkPSIiYnRuUG9zdDIiIi8+Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IiZJSWYoaXNDaGVjaywiPGlucHV0IGNsYXNzPSIiYnV0dG9uIiIgdHlwZT0iInN1Ym1pdCIiIG9uY2xpY2s9J2lmKHdpbmRvdy5jb25maXJtKCIiIiYgWkNfTVNHMDU4ICYiIiIpKXtkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiImVkdEJhdGNoMiIiKS52YWx1ZT0iImRlbGFsbCIifWVsc2V7cmV0dXJuIGZhbHNlfScgdmFsdWU9IiIiJlpDX01TRzIyMiYiIiIgaWQ9IiJidG5Qb3N0MyIiLz4iLCIiKSAmIjwvZm9ybT4iLCIiKSAmdmJDcmxmDQoNCglSZXNwb25zZS5Xcml0ZSAiPGhyLz48ZGl2IGNsYXNzPSIiY2xlYXIiIj48L2Rpdj4iDQoNCglJZiAgaW50UGFnZUFsbD4xIFRoZW4gDQoJCXN0clBhZ2U9RXhwb3J0UGFnZUJhcihpbnRQYWdlLGludFBhZ2VBbGwsWkNfUEFHRUJBUl9DT1VOVCwiYWRtaW4uYXNwP2FjdD1Db21tZW50TW5nJmFtcDtpc0NoZWNrPSImaXNDaGVjayYiJmFtcDtwYWdlPSIpDQoJCVJlc3BvbnNlLldyaXRlICI8cCBjbGFzcz0iInBhZ2ViYXIiIj4iICYgWkNfTVNHMDQyICYgIjogIiAmIHN0clBhZ2UgJiAiPC9wPiINCglFbmQgSWYgDQoNCglSZXNwb25zZS5Xcml0ZSAiPC9kaXY+Ig0KDQoJb2JqUlMuQ2xvc2UNCglTZXQgb2JqUlM9Tm90aGluZw0KDQoJUmVzcG9uc2UuV3JpdGUgIjxzY3JpcHQgdHlwZT0iInRleHQvamF2YXNjcmlwdCIiPkFjdGl2ZUxlZnRNZW51KCIiYUNvbW1lbnRNbmciIik7PC9zY3JpcHQ+Ig0KDQoJRXhwb3J0Q29tbWVudExpc3Q9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgTWFuYWdlciBUcmFja0JhY2tzDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBFeHBvcnRUcmFja0JhY2tMaXN0KGludFBhZ2UpDQoNCg0KCUV4cG9ydFRyYWNrQmFja0xpc3Q9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgTWFuYWdlciBVc2Vycw0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gRXhwb3J0VXNlckxpc3QoaW50UGFnZSkNCglJZiBDaGVja1JpZ2h0cygiVXNlckNydCIpPVRydWUgVGhlbg0KCQlDYWxsIEFkZF9SZXNwb25zZV9QbHVnaW4oIlJlc3BvbnNlX1BsdWdpbl9Vc2VyTW5nX1N1Yk1lbnUiLE1ha2VTdWJNZW51KFpDX01TRzEyNyAmICIiLCJlZGl0X3VzZXIuYXNwIiwibS1sZWZ0IixGYWxzZSkpDQoJRW5kIElmCQ0KCQ0KCURpbSBpDQoJRGltIG9ialJTDQoJRGltIHN0clNRTA0KCURpbSBzdHJQYWdlDQoJRGltIGludFBhZ2VBbGwNCg0KCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoaW50UGFnZSwiaW50IiwxKQ0KDQoJUmVzcG9uc2UuV3JpdGUgIjxkaXYgY2xhc3M9IiJkaXZIZWFkZXIiIj4iICYgWkNfTVNHMDcwICYgIjwvZGl2PiINCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iIlN1Yk1lbnUiIj4iICYgUmVzcG9uc2VfUGx1Z2luX1VzZXJNbmdfU3ViTWVudSAmICI8L2Rpdj4iDQoJUmVzcG9uc2UuV3JpdGUgIjxkaXYgaWQ9IiJkaXZNYWluMiIiPiINCg0KDQoNCg0KCVNldCBvYmpSUz1TZXJ2ZXIuQ3JlYXRlT2JqZWN0KCJBRE9EQi5SZWNvcmRzZXQiKQ0KCW9ialJTLkN1cnNvclR5cGUgPSBhZE9wZW5LZXlzZXQNCglvYmpSUy5Mb2NrVHlwZSA9IGFkTG9ja1JlYWRPbmx5DQoJb2JqUlMuQWN0aXZlQ29ubmVjdGlvbj1vYmpDb25uDQoJb2JqUlMuU291cmNlPSIiDQoNCglJZiBDaGVja1JpZ2h0cygiUm9vdCIpPUZhbHNlIFRoZW4gc3RyU1FMPSJXSEVSRSBbbWVtX0lEXSA9ICIgJiBCbG9nVXNlci5JRA0KDQoJb2JqUlMuT3BlbigiU0VMRUNUICogRlJPTSBbYmxvZ19NZW1iZXJdICIgJiBzdHJTUUwgJiAiIE9SREVSIEJZIFttZW1fSURdIEFTQyIpDQoNCglvYmpSUy5QYWdlU2l6ZT1aQ19NQU5BR0VfQ09VTlQNCglJZiBvYmpSUy5QYWdlQ291bnQ+MCBUaGVuIG9ialJTLkFic29sdXRlUGFnZSA9IGludFBhZ2UNCglpbnRQYWdlQWxsPW9ialJTLlBhZ2VDb3VudA0KDQoJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KDQoJCVJlc3BvbnNlLldyaXRlICI8dGFibGUgYm9yZGVyPSIiMSIiIHdpZHRoPSIiMTAwJSIiIGNlbGxzcGFjaW5nPSIiMCIiIGNlbGxwYWRkaW5nPSIiMCIiIGNsYXNzPSIidGFibGVCb3JkZXIgdGFibGVCb3JkZXItdGhjZW50ZXIiIj4iDQoJCVJlc3BvbnNlLldyaXRlICI8dHI+PHRoIHdpZHRoPSc1JSc+IiYgWkNfTVNHMDc2ICYiPC90aD48dGggd2lkdGg9JzEwJSc+PC90aD48dGg+IiYgWkNfTVNHMDAzICYiPC90aD48dGg+IiYgWkNfTVNHMTQ3ICYiPC90aD48dGggd2lkdGg9JzEwJSc+IiYgWkNfTVNHMDgyICYiPC90aD48dGggd2lkdGg9JzEwJSc+IiYgWkNfTVNHMTI0ICYiPC90aD48dGggd2lkdGg9JzE0JSc+PC90aD48L3RyPiINCg0KCQlGb3IgaT0xIHRvIG9ialJTLlBhZ2VTaXplDQoNCgkJCVJlc3BvbnNlLldyaXRlICI8dHI+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIjx0ZD4iICYgb2JqUlMoIm1lbV9JRCIpICYgIjwvdGQ+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIjx0ZD4iICYgWlZBX1VzZXJfTGV2ZWxfTmFtZShvYmpSUygibWVtX0xldmVsIikpICYgIjwvdGQ+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIjx0ZD4iICYgb2JqUlMoIm1lbV9OYW1lIikgJiAiPC90ZD4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiPHRkPiIgJiBvYmpSUygibWVtX1VybCIpICYgIjwvdGQ+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIjx0ZD4iICYgb2JqUlMoIm1lbV9Qb3N0TG9ncyIpICYgIjwvdGQ+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIjx0ZD4iICYgb2JqUlMoIm1lbV9Qb3N0Q29tbXMiKSAmICI8L3RkPiINCg0KCQkJUmVzcG9uc2UuV3JpdGUgIjx0ZCBhbGlnbj0iImNlbnRlciIiPjxhIGhyZWY9IiIuLi9jbWQuYXNwP2FjdD1Vc2VyRWR0JmFtcDtpZD0iJiBvYmpSUygibWVtX0lEIikgJiIiIj48aW1nIHNyYz0iIi4uL2ltYWdlL2FkbWluL3VzZXJfZWRpdC5wbmciIiBhbHQ9IiIiICYgWkNfTVNHMDc4ICYgIiIiIHRpdGxlPSIiIiAmIFpDX01TRzA3OCAmICIiIiB3aWR0aD0iIjE2IiIgLz48L2E+Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7PGEgb25jbGljaz0ncmV0dXJuIHdpbmRvdy5jb25maXJtKCIiIiYgWkNfTVNHMDU4ICYiIiIpOycgaHJlZj0iIi4uL2NtZC5hc3A/YWN0PVVzZXJEZWwmYW1wO2lkPSImIG9ialJTKCJtZW1fSUQiKSAmIiIiPjxpbWcgc3JjPSIiLi4vaW1hZ2UvYWRtaW4vZGVsZXRlLnBuZyIiIGFsdD0iIiIgJiBaQ19NU0cwNjMgJiAiIiIgdGl0bGU9IiIiICYgWkNfTVNHMDYzICYgIiIiIHdpZHRoPSIiMTYiIiAvPjwvYT48L3RkPiINCg0KCQkJUmVzcG9uc2UuV3JpdGUgIjwvdHI+Ig0KDQoJCQlvYmpSUy5Nb3ZlTmV4dA0KCQkJSWYgb2JqUlMuZW9mIFRoZW4gRXhpdCBGb3INCg0KCQlOZXh0DQoNCgkJUmVzcG9uc2UuV3JpdGUgIjwvdGFibGU+Ig0KDQoJRW5kIElmDQoJDQoJUmVzcG9uc2UuV3JpdGUgIjxwPiImIFpDX01TRzE4OSAmIjwvcD4iDQoNCglJZiAgaW50UGFnZUFsbD4xIFRoZW4gDQoJCXN0clBhZ2U9RXhwb3J0UGFnZUJhcihpbnRQYWdlLGludFBhZ2VBbGwsWkNfUEFHRUJBUl9DT1VOVCwiYWRtaW4uYXNwP2FjdD1Vc2VyTW5nJmFtcDtwYWdlPSIpDQoJCVJlc3BvbnNlLldyaXRlICI8aHIvPjxwIGNsYXNzPSIicGFnZWJhciIiPiIgJiBaQ19NU0cwNDIgJiAiOiAiICYgc3RyUGFnZSAmICI8L3A+Ig0KCUVuZCBJZiANCg0KCVJlc3BvbnNlLldyaXRlICI8L2Rpdj4iDQoNCglvYmpSUy5DbG9zZQ0KCVNldCBvYmpSUz1Ob3RoaW5nDQoNCglSZXNwb25zZS5Xcml0ZSAiPHNjcmlwdCB0eXBlPSIidGV4dC9qYXZhc2NyaXB0IiI+QWN0aXZlTGVmdE1lbnUoIiJhVXNlck1uZyIiKTs8L3NjcmlwdD4iDQoNCglFeHBvcnRVc2VyTGlzdD1UcnVlDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBNYW5hZ2VyIEZpbGVzDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBFeHBvcnRGaWxlTGlzdChpbnRQYWdlKQ0KDQoJRGltIGkNCglEaW0gb2JqUlMNCglEaW0gc3RyU1FMDQoJRGltIHN0clBhZ2UNCglEaW0gaW50UGFnZUFsbA0KDQoJQ2FsbCBDaGVja1BhcmFtZXRlcihpbnRQYWdlLCJpbnQiLDEpDQoNCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iImRpdkhlYWRlciIiPiIgJiBaQ19NU0cwNzEgJiAiPC9kaXY+Ig0KCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIiU3ViTWVudSIiPiIgJiBSZXNwb25zZV9QbHVnaW5fRmlsZU1uZ19TdWJNZW51ICYgIjwvZGl2PiINCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBpZD0iImRpdk1haW4yIiI+Ig0KDQoNCg0KCVJlc3BvbnNlLldyaXRlICI8Zm9ybSBjbGFzcz0iInNlYXJjaCIiIG5hbWU9IiJlZGl0IiIgaWQ9IiJlZGl0IiIgbWV0aG9kPSIicG9zdCIiIGVuY3R5cGU9IiJtdWx0aXBhcnQvZm9ybS1kYXRhIiIgYWN0aW9uPSIiLi4vY21kLmFzcD9hY3Q9RmlsZVVwbG9hZCIiPiINCglSZXNwb25zZS5Xcml0ZSAiPHA+IiYgWkNfTVNHMTA4ICYiOiA8L3A+Ig0KCVJlc3BvbnNlLldyaXRlICI8cD48aW5wdXQgdHlwZT0iImZpbGUiIiBpZD0iImVkdEZpbGVMb2FkIiIgbmFtZT0iImVkdEZpbGVMb2FkIiIgc2l6ZT0iIjQwIiIgLz4mbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDs8aW5wdXQgdHlwZT0iInN1Ym1pdCIiIGNsYXNzPSIiYnV0dG9uIiIgdmFsdWU9IiIiJiBaQ19NU0cwODcgJiIiIiBuYW1lPSIiQjEiIiBvbmNsaWNrPSdkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiImVkaXQiIikuYWN0aW9uPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCIiZWRpdCIiKS5hY3Rpb24rIiImYW1wO2ZpbGVuYW1lPSIiK2VzY2FwZShlZHRGaWxlTG9hZC52YWx1ZSknIC8+Jm5ic3A7Jm5ic3A7PGlucHV0IGNsYXNzPSIiYnV0dG9uIiIgdHlwZT0iInJlc2V0IiIgdmFsdWU9IiIiJiBaQ19NU0cwODggJiIiIiBuYW1lPSIiQjIiIiAvPiINCglSZXNwb25zZS5Xcml0ZSAiJm5ic3A7PGlucHV0IHR5cGU9IiJjaGVja2JveCIiIG9uY2xpY2s9J2lmKHRoaXMuY2hlY2tlZD09dHJ1ZSl7ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIiJlZGl0IiIpLmFjdGlvbj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiImVkaXQiIikuYWN0aW9uKyIiJmFtcDthdXRvbmFtZT0xIiI7fWVsc2V7ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIiJlZGl0IiIpLmFjdGlvbj0iIi4uL2NtZC5hc3A/YWN0PUZpbGVVcGxvYWQiIjt9O1NldENvb2tpZSgiImNoa0F1dG9GaWxlTmFtZSIiLHRoaXMuY2hlY2tlZCwzNjUpOycgaWQ9IiJjaGtBdXRvTmFtZSIiLz48bGFiZWwgZm9yPSIiY2hrQXV0b05hbWUiIj4iJiBaQ19NU0cxMzEgJiI8L2xhYmVsPjwvcD48L2Zvcm0+Ig0KDQoJU2V0IG9ialJTPVNlcnZlci5DcmVhdGVPYmplY3QoIkFET0RCLlJlY29yZHNldCIpDQoJb2JqUlMuQ3Vyc29yVHlwZSA9IGFkT3BlbktleXNldA0KCW9ialJTLkxvY2tUeXBlID0gYWRMb2NrUmVhZE9ubHkNCglvYmpSUy5BY3RpdmVDb25uZWN0aW9uPW9iakNvbm4NCglvYmpSUy5Tb3VyY2U9IiINCg0KCUlmIENoZWNrUmlnaHRzKCJSb290Iik9RmFsc2UgQW5kIENoZWNrUmlnaHRzKCJGaWxlQWxsIik9RmFsc2UgVGhlbiBzdHJTUUw9IldIRVJFIFt1bF9BdXRob3JJRF0gPSAiICYgQmxvZ1VzZXIuSUQNCg0KCVJlc3BvbnNlLldyaXRlICI8dGFibGUgYm9yZGVyPSIiMSIiIHdpZHRoPSIiMTAwJSIiIGNlbGxzcGFjaW5nPSIiMCIiIGNlbGxwYWRkaW5nPSIiMCIiIGNsYXNzPSIidGFibGVCb3JkZXIgdGFibGVCb3JkZXItdGhjZW50ZXIiIj4iDQoJUmVzcG9uc2UuV3JpdGUgIjx0cj48dGggd2lkdGg9JzUlJz4iJiBaQ19NU0cwNzYgJiI8L3RoPjx0aCB3aWR0aD0nMTAlJz4iJiBaQ19NU0cwMDMgJiI8L3RoPjx0aCB3aWR0aD0nJz4iJiBaQ19NU0cwMDEgJiI8L3RoPjx0aCB3aWR0aD0nMTIlJz4iJiBaQ19NU0cwNDEgJiI8L3RoPjx0aCB3aWR0aD0nMTIlJz4iJiBaQ19NU0cwNzUgJiI8L3RoPjx0aCB3aWR0aD0nNSUnPjwvdGg+PHRoIHdpZHRoPSc1JSc+PGEgaHJlZj0nJyBvbmNsaWNrPSdCYXRjaFNlbGVjdEFsbCgpO3JldHVybiBmYWxzZSc+IiYgWkNfTVNHMjI5ICYiPC9hPjwvdGg+PC90cj4iDQoNCglvYmpSUy5PcGVuKCJTRUxFQ1QgKiBGUk9NIFtibG9nX1VwTG9hZF0gIiAmIHN0clNRTCAmICIgT1JERVIgQlkgW3VsX1Bvc3RUaW1lXSBERVNDIikNCglvYmpSUy5QYWdlU2l6ZT1aQ19NQU5BR0VfQ09VTlQNCglJZiBvYmpSUy5QYWdlQ291bnQ+MCBUaGVuIG9ialJTLkFic29sdXRlUGFnZSA9IGludFBhZ2UNCglpbnRQYWdlQWxsPW9ialJTLlBhZ2VDb3VudA0KDQoJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KDQoJCUZvciBpPTEgdG8gb2JqUlMuUGFnZVNpemUNCg0KCQkJUmVzcG9uc2UuV3JpdGUgIjx0cj48dGQ+IiZvYmpSUygidWxfSUQiKSYiPC90ZD4iDQoNCgkJCUNhbGwgR2V0VXNlcnNieVVzZXJJRExpc3Qob2JqUlMoInVsX0F1dGhvcklEIikpDQoJCQlEaW0gVXNlcg0KCQkJRm9yIEVhY2ggVXNlciBpbiBVc2Vycw0KCQkJCUlmIElzT2JqZWN0KFVzZXIpIFRoZW4NCgkJCQkJSWYgVXNlci5JRD1vYmpSUygidWxfQXV0aG9ySUQiKSBUaGVuDQoJCQkJCQlSZXNwb25zZS5Xcml0ZSAiPHRkPiIgJiBVc2VyLk5hbWUgJiAiPC90ZD4iDQoJCQkJCUVuZCBJZg0KCQkJCUVuZCBJZg0KCQkJTmV4dA0KDQoJCQlSZXNwb25zZS5Xcml0ZSAiPHRkPjxhIGhyZWY9JyImIEJsb2dIb3N0ICYgWkNfVVBMT0FEX0RJUkVDVE9SWSAmIi8iJlllYXIob2JqUlMoInVsX1Bvc3RUaW1lIikpICYgIi8iICYgTW9udGgob2JqUlMoInVsX1Bvc3RUaW1lIikpICYgIi8iJlNlcnZlci5VUkxFbmNvZGUob2JqUlMoInVsX0ZpbGVOYW1lIikpJiInIHRhcmdldD0nX2JsYW5rJz4iJlllYXIob2JqUlMoInVsX1Bvc3RUaW1lIikpICYgIi8iICYgTW9udGgob2JqUlMoInVsX1Bvc3RUaW1lIikpICYgIi8iICZvYmpSUygidWxfRmlsZU5hbWUiKSYiPC9hPjwvdGQ+Ig0KDQoJCQlSZXNwb25zZS5Xcml0ZSAiPHRkPiImb2JqUlMoInVsX0ZpbGVTaXplIikmIjwvdGQ+PHRkPiImRm9ybWF0RGF0ZVRpbWUob2JqUlMoInVsX1Bvc3RUaW1lIiksIDIpJiI8L3RkPiINCgkJCVJlc3BvbnNlLldyaXRlICI8dGQgYWxpZ249IiJjZW50ZXIiIj48YSBocmVmPScuLi9jbWQuYXNwP2FjdD1GaWxlRGVsJmFtcDtpZD0iJlNlcnZlci5VUkxFbmNvZGUob2JqUlMoInVsX0lEIikpJiInIG9uY2xpY2s9J3JldHVybiB3aW5kb3cuY29uZmlybSgiIiImIFpDX01TRzA1OCAmIiIiKTsnPjxpbWcgc3JjPSIiLi4vaW1hZ2UvYWRtaW4vZGVsZXRlLnBuZyIiIGFsdD0iIiIgJiBaQ19NU0cwNjMgJiAiIiIgdGl0bGU9IiIiICYgWkNfTVNHMDYzICYgIiIiIHdpZHRoPSIiMTYiIiAvPjwvYT48L3RkPiINCgkJCVJlc3BvbnNlLldyaXRlICI8dGQgYWxpZ249IiJjZW50ZXIiIiA+PGlucHV0IHR5cGU9IiJjaGVja2JveCIiIG5hbWU9IiJlZHREZWwiIiBpZD0iImVkdERlbCImb2JqUlMoInVsX0lEIikmIiIiIHZhbHVlPSIiIiZvYmpSUygidWxfSUQiKSYiIiIvPjwvdGQ+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIjwvdHI+Ig0KDQoJCQlvYmpSUy5Nb3ZlTmV4dA0KCQkJSWYgb2JqUlMuZW9mIFRoZW4gRXhpdCBGb3INCg0KCQlOZXh0DQoNCglFbmQgSWYNCg0KCVJlc3BvbnNlLldyaXRlICI8L3RhYmxlPiINCg0KCVJlc3BvbnNlLldyaXRlICI8Zm9ybSBpZD0iImZybUJhdGNoIiIgbWV0aG9kPSIicG9zdCIiIGFjdGlvbj0iIi4uL2NtZC5hc3A/YWN0PUZpbGVEZWxCYXRjaCIiPjxpbnB1dCB0eXBlPSIiaGlkZGVuIiIgaWQ9IiJlZHRCYXRjaCIiIG5hbWU9IiJlZHRCYXRjaCIiIHZhbHVlPSIiIiIvPjxpbnB1dCBjbGFzcz0iImJ1dHRvbiIiIHR5cGU9IiJzdWJtaXQiIiBvbmNsaWNrPSdCYXRjaERlbGV0ZUFsbCgiImVkdEJhdGNoIiIpO2lmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCIiZWR0QmF0Y2giIikudmFsdWUpe3JldHVybiB3aW5kb3cuY29uZmlybSgiIiImIFpDX01TRzA1OCAmIiIiKTt9ZWxzZXtyZXR1cm4gZmFsc2V9JyB2YWx1ZT0iIiImWkNfTVNHMjI4JiIiIiBpZD0iImJ0blBvc3QiIi8+PC9mb3JtPiIgJiB2YkNybGYNCg0KCUlmICBpbnRQYWdlQWxsPjEgVGhlbg0KCQlzdHJQYWdlPUV4cG9ydFBhZ2VCYXIoaW50UGFnZSxpbnRQYWdlQWxsLFpDX1BBR0VCQVJfQ09VTlQsImFkbWluLmFzcD9hY3Q9RmlsZU1uZyZhbXA7cGFnZT0iKQ0KCQlSZXNwb25zZS5Xcml0ZSAiPGhyLz48cCBjbGFzcz0iInBhZ2ViYXIiIj4iICYgWkNfTVNHMDQyICYgIjogIiAmIHN0clBhZ2UgJiAiPC9wPiINCglFbmQgSWYgDQoNCglSZXNwb25zZS5Xcml0ZSAiPC9kaXY+PHNjcmlwdCB0eXBlPSIidGV4dC9qYXZhc2NyaXB0IiI+aWYoR2V0Q29va2llKCIiY2hrQXV0b0ZpbGVOYW1lIiIpPT0iInRydWUiIil7ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIiJjaGtBdXRvTmFtZSIiKS5jaGVja2VkPXRydWU7ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIiJlZGl0IiIpLmFjdGlvbj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiImVkaXQiIikuYWN0aW9uK1N0cmluZy5mcm9tQ2hhckNvZGUoMzgpKyIiYXV0b25hbWU9MSIiO307PC9zY3JpcHQ+Ig0KCW9ialJTLkNsb3NlDQoJU2V0IG9ialJTPU5vdGhpbmcNCg0KCVJlc3BvbnNlLldyaXRlICI8c2NyaXB0IHR5cGU9IiJ0ZXh0L2phdmFzY3JpcHQiIj5BY3RpdmVMZWZ0TWVudSgiImFGaWxlTW5nIiIpOzwvc2NyaXB0PiINCg0KCUV4cG9ydEZpbGVMaXN0PVRydWUNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIE1hbmFnZSBTZXR0aW5nDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBFeHBvcnRNYW5hZ2VMaXN0KCkNCg0KCUV4cG9ydE1hbmFnZUxpc3Q9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgTWFuYWdlciBLZXlXb3JkDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBFeHBvcnRLZXlXb3JkTGlzdChpbnRQYWdlKQ0KDQoJRXhwb3J0S2V5V29yZExpc3Q9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJogICAgTWFuYWdlciBUYWcNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEV4cG9ydFRhZ0xpc3QoaW50UGFnZSkNCglDYWxsIEFkZF9SZXNwb25zZV9QbHVnaW4oIlJlc3BvbnNlX1BsdWdpbl9UYWdNbmdfU3ViTWVudSIsTWFrZVN1Yk1lbnUoWkNfTVNHMTM2ICYgIiIsIi4uL2NtZC5hc3A/YWN0PVRhZ0VkdCIsIm0tbGVmdCIsRmFsc2UpKQ0KDQoJRGltIGkNCglEaW0gb2JqUlMNCglEaW0gc3RyUGFnZQ0KCURpbSBpbnRQYWdlQWxsDQoNCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iImRpdkhlYWRlciIiPiIgJiBaQ19NU0cxNDEgJiAiPC9kaXY+Ig0KCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIiU3ViTWVudSIiPiIgJiBSZXNwb25zZV9QbHVnaW5fVGFnTW5nX1N1Yk1lbnUgJiAiPC9kaXY+Ig0KCVJlc3BvbnNlLldyaXRlICI8ZGl2IGlkPSIiZGl2TWFpbjIiIj4iDQoNCg0KDQoNCg0KCUNhbGwgQ2hlY2tQYXJhbWV0ZXIoaW50UGFnZSwiaW50IiwxKQ0KDQoJU2V0IG9ialJTPVNlcnZlci5DcmVhdGVPYmplY3QoIkFET0RCLlJlY29yZHNldCIpDQoJb2JqUlMuQ3Vyc29yVHlwZSA9IGFkT3BlbktleXNldA0KCW9ialJTLkxvY2tUeXBlID0gYWRMb2NrUmVhZE9ubHkNCglvYmpSUy5BY3RpdmVDb25uZWN0aW9uPW9iakNvbm4NCglvYmpSUy5Tb3VyY2U9IiINCg0KCW9ialJTLk9wZW4oIlNFTEVDVCAqIEZST00gW2Jsb2dfVGFnXSBPUkRFUiBCWSBbdGFnX05hbWVdIEFTQyIpDQoNCglvYmpSUy5QYWdlU2l6ZT1aQ19NQU5BR0VfQ09VTlQNCglJZiBvYmpSUy5QYWdlQ291bnQ+MCBUaGVuIG9ialJTLkFic29sdXRlUGFnZSA9IGludFBhZ2UNCglpbnRQYWdlQWxsPW9ialJTLlBhZ2VDb3VudA0KDQoJUmVzcG9uc2UuV3JpdGUgIjx0YWJsZSBib3JkZXI9IiIxIiIgd2lkdGg9IiIxMDAlIiIgY2VsbHNwYWNpbmc9IiIwIiIgY2VsbHBhZGRpbmc9IiIwIiIgY2xhc3M9IiJ0YWJsZUJvcmRlciB0YWJsZUJvcmRlci10aGNlbnRlciIiPiINCglSZXNwb25zZS5Xcml0ZSAiPHRyPjx0aCB3aWR0aD0iIjglIiI+IiYgWkNfTVNHMDc2ICYiPC90aD48dGg+IiYgWkNfTVNHMDAxICYiPC90aD48dGg+IiYgWkNfTVNHMDE2ICYiPC90aD48dGggd2lkdGg9IiIxNCUiIj48L3RoPjwvdHI+Ig0KDQoJSWYgKE5vdCBvYmpSUy5ib2YpIEFuZCAoTm90IG9ialJTLmVvZikgVGhlbg0KDQoJCUZvciBpPTEgdG8gb2JqUlMuUGFnZVNpemUNCg0KCQkJUmVzcG9uc2UuV3JpdGUgIjx0cj4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiPHRkPiIgJiBvYmpSUygidGFnX0lEIikgJiAiPC90ZD4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiPHRkPiIgJiBvYmpSUygidGFnX05hbWUiKSAmICI8L3RkPiINCgkJCUlmIElzTnVsbChvYmpSUygidGFnX0ludHJvIikpPVRydWUgVGhlbg0KCQkJCVJlc3BvbnNlLldyaXRlICI8dGQ+PC90ZD4iDQoJCQlFbHNlDQoJCQkJUmVzcG9uc2UuV3JpdGUgIjx0ZD4iICYgVHJhbnNmZXJIVE1MKG9ialJTKCJ0YWdfSW50cm8iKSwiW2h0bWwtZm9ybWF0XSIpICYgIjwvdGQ+Ig0KCQkJRW5kIElmDQoJCQlSZXNwb25zZS5Xcml0ZSAiPHRkIGFsaWduPSIiY2VudGVyIiI+PGEgaHJlZj0iIi4uL2NtZC5hc3A/YWN0PVRhZ0VkdCZhbXA7aWQ9IiYgb2JqUlMoInRhZ19JRCIpICYiIiI+PGltZyBzcmM9IiIuLi9pbWFnZS9hZG1pbi90YWdfYmx1ZV9lZGl0LnBuZyIiIGFsdD0iIiIgJiBaQ19NU0cwNzggJiAiIiIgdGl0bGU9IiIiICYgWkNfTVNHMDc4ICYgIiIiIHdpZHRoPSIiMTYiIiAvPjwvYT4mbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDs8YSBvbmNsaWNrPSdyZXR1cm4gd2luZG93LmNvbmZpcm0oIiIiJiBaQ19NU0cwNTggJiIiIik7JyBocmVmPSIiLi4vY21kLmFzcD9hY3Q9VGFnRGVsJmFtcDtpZD0iJiBvYmpSUygidGFnX0lEIikgJiIiIj48aW1nIHNyYz0iIi4uL2ltYWdlL2FkbWluL2RlbGV0ZS5wbmciIiBhbHQ9IiIiICYgWkNfTVNHMDYzICYgIiIiIHRpdGxlPSIiIiAmIFpDX01TRzA2MyAmICIiIiB3aWR0aD0iIjE2IiIgLz48L2E+PC90ZD4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiPC90cj4iDQoNCgkJCW9ialJTLk1vdmVOZXh0DQoJCQlJZiBvYmpSUy5lb2YgVGhlbiBFeGl0IEZvcg0KDQoJCU5leHQNCg0KCUVuZCBJZg0KDQoJUmVzcG9uc2UuV3JpdGUgIjwvdGFibGU+Ig0KDQoJSWYgIGludFBhZ2VBbGw+MSBUaGVuDQoJCXN0clBhZ2U9RXhwb3J0UGFnZUJhcihpbnRQYWdlLGludFBhZ2VBbGwsWkNfUEFHRUJBUl9DT1VOVCwiYWRtaW4uYXNwP2FjdD1UYWdNbmcmYW1wO3BhZ2U9IikNCgkJUmVzcG9uc2UuV3JpdGUgIjxoci8+PHAgY2xhc3M9IiJwYWdlYmFyIiI+IiAmIFpDX01TRzA0MiAmICI6ICIgJiBzdHJQYWdlICYgIjwvcD4iDQoJRW5kIElmIA0KDQoJUmVzcG9uc2UuV3JpdGUgIjwvZGl2PiINCg0KCW9ialJTLkNsb3NlDQoJU2V0IG9ialJTPU5vdGhpbmcNCg0KCVJlc3BvbnNlLldyaXRlICI8c2NyaXB0IHR5cGU9IiJ0ZXh0L2phdmFzY3JpcHQiIj5BY3RpdmVMZWZ0TWVudSgiImFUYWdNbmciIik7PC9zY3JpcHQ+Ig0KDQoJRXhwb3J0VGFnTGlzdD1UcnVlDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQonIOebrueahO+8miAgICBNYW5hZ2VyIFBsdWdpbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KRnVuY3Rpb24gRXhwb3J0UGx1Z2luTW5nKCkNCg0KCU9uIEVycm9yIFJlc3VtZSBOZXh0DQoNCglEaW0gYXJ5UExfRW5hYmxlKCkNCglEaW0gYXJ5UExfRGlzYWJsZSgpDQoNCglSZURpbSBhcnlQTF9FbmFibGUoMCkNCglSZURpbSBhcnlQTF9EaXNhYmxlKDApDQoNCglEaW0gYXJ5UEwNCglhcnlQTD1TcGxpdChaQ19VU0lOR19QTFVHSU5fTElTVCwifCIpDQoNCglEaW0gaSxqLHMsdCxtLG4NCg0KCUlmIFpDX1VTSU5HX1BMVUdJTl9MSVNUPD4iIiBUaGVuDQoJCWk9VUJvdW5kKGFyeVBMKQ0KCUVsc2UNCgkJaT0wDQoJRW5kIElmDQoNCglSZURpbSBhcnlQTF9FbmFibGUoaSkNCg0KDQoJRGltIGYsIGYxLCBmYw0KCUlmIE5vdCBJc09iamVjdChQdWJsaWNPYmpGU08pIFRoZW4gU2V0IFB1YmxpY09iakZTTz1TZXJ2ZXIuQ3JlYXRlT2JqZWN0KCJTY3JpcHRpbmcuRmlsZVN5c3RlbU9iamVjdCIpDQoNCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iImRpdkhlYWRlciIiPiIgJiBaQ19NU0cxMDcgJiAiPC9kaXY+Ig0KCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIiU3ViTWVudSIiPiIgJiBSZXNwb25zZV9QbHVnaW5fUGx1Z0luTW5nX1N1Yk1lbnUgJiAiPC9kaXY+Ig0KCVJlc3BvbnNlLldyaXRlICI8ZGl2IGlkPSIiZGl2TWFpbjIiIj4iDQoNCg0KDQoNCglSZXNwb25zZS5Xcml0ZSAiPHRhYmxlIGJvcmRlcj0iIjEiIiB3aWR0aD0iIjEwMCUiIiBjZWxsc3BhY2luZz0iIjAiIiBjZWxscGFkZGluZz0iIjAiIiBjbGFzcz0iInRhYmxlQm9yZGVyIHRhYmxlQm9yZGVyLXRoY2VudGVyIiI+Ig0KCVJlc3BvbnNlLldyaXRlICI8dHI+PHRoIHdpZHRoPSIiNTBweCIiPjwvdGg+PC90aD48dGg+IiYgWkNfTVNHMDAxICYiPC90aD48dGggd2lkdGg9IiIxMiUiIj4iJiBaQ19NU0cxMjggJiI8L3RoPjx0aCB3aWR0aD0iIjEyJSIiPiImIFpDX01TRzE1MSAmIjwvdGg+PHRoIHdpZHRoPSIiMTQlIiI+PC90aD48L3RyPiINCg0KCURpbSBvYmpYbWxGaWxlLHN0clhtbEZpbGUNCg0KDQoNCglzdHJYbWxGaWxlID1CbG9nUGF0aCAmICJ6Yl91c2Vycy90aGVtZS8iICYgWkNfQkxPR19USEVNRSAmICIvIiAmICJ0aGVtZS54bWwiDQoNCglTZXQgb2JqWG1sRmlsZT1TZXJ2ZXIuQ3JlYXRlT2JqZWN0KCJNaWNyb3NvZnQuWE1MRE9NIikNCglvYmpYbWxGaWxlLmFzeW5jID0gRmFsc2UNCglvYmpYbWxGaWxlLlZhbGlkYXRlT25QYXJzZT1GYWxzZQ0KCW9ialhtbEZpbGUubG9hZChzdHJYbWxGaWxlKQ0KCUlmIG9ialhtbEZpbGUucmVhZHlTdGF0ZT00IFRoZW4NCgkJSWYgb2JqWG1sRmlsZS5wYXJzZUVycm9yLmVycm9yQ29kZSA8PiAwIFRoZW4NCgkJRWxzZQ0KDQoJCQlJZiBDTG5nKG9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoInBsdWdpbi9sZXZlbCIpLnRleHQpPjAgVGhlbg0KDQoJCQkJSWYgRXJyLk51bWJlcj0wIFRoZW4NCg0KCQkJCQlSZXNwb25zZS5Xcml0ZSAiPHRyPiINCgkJCQkJUmVzcG9uc2UuV3JpdGUgIjx0ZCBhbGlnbj0nY2VudGVyJz48aW1nIGFsdD0nJyB3aWR0aD0nMzInIHNyYz0nIiZCbG9nSG9zdCAmICJ6Yl91c2Vycy90aGVtZS8iJiBaQ19CTE9HX1RIRU1FICYiL1NjcmVlblNob3QucG5nJyBzdHlsZT0nbWFyZ2luOjJweDsnLz48L3RkPiINCgkJCQkJJ1Jlc3BvbnNlLldyaXRlICI8dGQ+IiYgIjAiICYiPC90ZD4iDQoJCQkJCVJlc3BvbnNlLldyaXRlICI8dGQ+PGEgaWQ9IiJteWxpbmsiJkxlZnQobWQ1KG9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoImlkIikudGV4dCksNikmIiIiIGhyZWY9IiIkZGl2IiZMZWZ0KG1kNShvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJpZCIpLnRleHQpLDYpJiJ0aXA/d2lkdGg9MzAwIiIgY2xhc3M9IiJiZXR0ZXJUaXAiIiB0aXRsZT0iIiRjb250ZW50IiI+IiAmICIiICYgb2JqWG1sRmlsZS5kb2N1bWVudEVsZW1lbnQuc2VsZWN0U2luZ2xlTm9kZSgibmFtZSIpLnRleHQgJiAiICgiJiBaQ19NU0cxOTkgJiIpJm5ic3A7Jm5ic3A7Jm5ic3A7IiAmIG9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoInZlcnNpb24iKS50ZXh0ICAmICI8L2E+PGRpdiBpZD0iImRpdiImTGVmdChtZDUob2JqWG1sRmlsZS5kb2N1bWVudEVsZW1lbnQuc2VsZWN0U2luZ2xlTm9kZSgiaWQiKS50ZXh0KSw2KSYidGlwIiIgc3R5bGU9IiJkaXNwbGF5Om5vbmU7IiI+IiZvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJub3RlIikudGV4dCYiPC9kaXY+PC90ZD4iDQoJCQkJCVJlc3BvbnNlLldyaXRlICI8dGQ+IiAmICI8YSB0YXJnZXQ9IiJfYmxhbmsiIiBocmVmPSIiIiAmIG9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoImF1dGhvci91cmwiKS50ZXh0ICYgIiIiPiImIG9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoImF1dGhvci9uYW1lIikudGV4dCAmICI8L3RkPiINCgkJCQkJJ1Jlc3BvbnNlLldyaXRlICI8dGQ+IiAmIG9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoInZlcnNpb24iKS50ZXh0ICYgIjwvdGQ+Ig0KCQkJCQlSZXNwb25zZS5Xcml0ZSAiPHRkPiImIG9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoIm1vZGlmaWVkIikudGV4dCAmIjwvdGQ+Ig0KCQkJCQlSZXNwb25zZS5Xcml0ZSAiPHRkIGFsaWduPSdjZW50ZXInPiINCgkJCQkJSWYgQmxvZ1VzZXIuTGV2ZWw8PUNMbmcob2JqWG1sRmlsZS5kb2N1bWVudEVsZW1lbnQuc2VsZWN0U2luZ2xlTm9kZSgicGx1Z2luL2xldmVsIikudGV4dCkgVGhlbg0KCQkJCQkJSWYgUHVibGljT2JqRlNPLkZpbGVFeGlzdHMoQmxvZ1BhdGggJiAiemJfdXNlcnMvdGhlbWUvIiAmIFpDX0JMT0dfVEhFTUUgJiAiL3BsdWdpbi8iICYgb2JqWG1sRmlsZS5kb2N1bWVudEVsZW1lbnQuc2VsZWN0U2luZ2xlTm9kZSgicGx1Z2luL3BhdGgiKS50ZXh0KSBUaGVuDQoJCQkJCQkJUmVzcG9uc2UuV3JpdGUgIjxhIGhyZWY9IiIuLi8uLi9aQl9VU0VSUy90aGVtZS8iICYgWkNfQkxPR19USEVNRSAmICIvcGx1Z2luLyIgJiBvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJwbHVnaW4vcGF0aCIpLnRleHQgJiIiIj48aW1nIHdpZHRoPScxNicgdGl0bGU9JyImWkNfTVNHMDIyJiInIGFsdD0nIiZaQ19NU0cwMjImIicgc3JjPScuLi9JTUFHRS9BRE1JTi9zZXR0aW5nX3Rvb2xzLnBuZycvPjwvYT4iDQoJCQkJCQlFbmQgSWYNCgkJCQkJRW5kIElmDQoJCQkJCVJlc3BvbnNlLldyaXRlICI8L3RkPiINCgkJCQkJUmVzcG9uc2UuV3JpdGUgIjwvdHI+Ig0KDQoJCQkJRW5kIElmDQoNCgkJCUVuZCBJZg0KDQoJCUVuZCBJZg0KCUVuZCBJZg0KCVNldCBvYmpYbWxGaWxlPU5vdGhpbmcNCg0KCVNldCBmID0gUHVibGljT2JqRlNPLkdldEZvbGRlcihCbG9nUGF0aCAmICJ6Yl91c2Vycy9wbHVnaW4vIikNCglTZXQgZmMgPSBmLlN1YkZvbGRlcnMNCglGb3IgRWFjaCBmMSBpbiBmYw0KDQoJCXM9IiINCg0KCQlJZiBQdWJsaWNPYmpGU08uRmlsZUV4aXN0cyhCbG9nUGF0aCAmICJ6Yl91c2Vycy9wbHVnaW4vIiAmIGYxLm5hbWUgJiAiLyIgJiAicGx1Z2luLnhtbCIpIFRoZW4NCg0KCQkJc3RyWG1sRmlsZSA9QmxvZ1BhdGggJiAiemJfdXNlcnMvcGx1Z2luLyIgJiBmMS5uYW1lICYgIi8iICYgInBsdWdpbi54bWwiDQoNCgkJCVNldCBvYmpYbWxGaWxlPVNlcnZlci5DcmVhdGVPYmplY3QoIk1pY3Jvc29mdC5YTUxET00iKQ0KCQkJb2JqWG1sRmlsZS5hc3luYyA9IEZhbHNlDQoJCQlvYmpYbWxGaWxlLlZhbGlkYXRlT25QYXJzZT1GYWxzZQ0KCQkJb2JqWG1sRmlsZS5sb2FkKHN0clhtbEZpbGUpDQoJCQlJZiBvYmpYbWxGaWxlLnJlYWR5U3RhdGU9NCBUaGVuDQoJCQkJSWYgb2JqWG1sRmlsZS5wYXJzZUVycm9yLmVycm9yQ29kZSA8PiAwIFRoZW4NCgkJCQlFbHNlDQoJCQkJCSdJZiBCbG9nVXNlci5MZXZlbDw9Q0xuZyhvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJsZXZlbCIpLnRleHQpIFRoZW4NCg0KCQkJSWYgQ2hlY2tQbHVnaW5TdGF0ZShvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJpZCIpLnRleHQpIFRoZW4NCgkJCQlGb3Igaj0wIFRvIFVCb3VuZChhcnlQTCkNCgkJCQkJSWYgVUNhc2UoYXJ5UEwoaikpPVVDYXNlKG9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoImlkIikudGV4dCkgVGhlbg0KCQkJCQkJbj1qDQoJCQkJCQlFeGl0IEZvcg0KCQkJCQlFbmQgSWYNCgkJCQlOZXh0DQoJCQkJbT1uKzENCgkJCUVsc2UNCgkJCQltPSIiDQoJCQlFbmQgSWYNCg0KDQoJCQlzPXMgJiAiPHRyPiINCg0KCQkJSWYgQ2hlY2tQbHVnaW5TdGF0ZShvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJpZCIpLnRleHQpIFRoZW4NCgkJCQlzPXMgJiAiPHRkIGFsaWduPSdjZW50ZXInIGNsYXNzPSdwbHVnaW4gcGx1Z2luLW9uJz4iDQoJCQlFbHNlDQoJCQkJcz1zICYgIjx0ZCBhbGlnbj0nY2VudGVyJyBjbGFzcz0ncGx1Z2luJz4iDQoJCQlFbmQgSWYNCg0KCQkJSWYgQ2hlY2tQbHVnaW5TdGF0ZShvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJpZCIpLnRleHQpIFRoZW4NCg0KCQkJCUlmIFB1YmxpY09iakZTTy5GaWxlRXhpc3RzKEJsb2dQYXRoICYgInpiX3VzZXJzL3BsdWdpbi8iICYgZjEubmFtZSAmICIvIiAmICJsb2dvLnBuZyIpIFRoZW4NCgkJCQkJcz1zICYgIjxpbWcgYWx0PScnIHdpZHRoPSczMicgc3JjPSciJkJsb2dIb3N0ICYgInpiX3VzZXJzL3BsdWdpbi8iICYgZjEubmFtZSAmICIvIiAmICJsb2dvLnBuZyImIicvIHN0eWxlPSdtYXJnaW46MnB4Oyc+Ig0KCQkJCUVsc2UNCgkJCQkJcz1zICYgIjxpbWcgYWx0PScnIHdpZHRoPSczMicgc3JjPScuLi9JTUFHRS9BRE1JTi9hcHAtbG9nby5wbmcnLyBzdHlsZT0nbWFyZ2luOjJweDsnPiINCgkJCQlFbmQgSWYNCgkJCUVsc2UNCgkJCQlJZiBQdWJsaWNPYmpGU08uRmlsZUV4aXN0cyhCbG9nUGF0aCAmICJ6Yl91c2Vycy9wbHVnaW4vIiAmIGYxLm5hbWUgJiAiLyIgJiAibG9nby5wbmciKSBUaGVuDQoJCQkJCXM9cyAmICI8aW1nIHN0eWxlPSIib3BhY2l0eTowLjIiIiBhbHQ9Jycgd2lkdGg9JzMyJyBzcmM9JyImQmxvZ0hvc3QgJiAiemJfdXNlcnMvcGx1Z2luLyIgJiBmMS5uYW1lICYgIi8iICYgImxvZ28ucG5nIiYiJy8gc3R5bGU9J21hcmdpbjoycHg7Jz4iDQoJCQkJRWxzZQ0KCQkJCQlzPXMgJiAiPGltZyBzdHlsZT0iIm9wYWNpdHk6MC4yIiIgYWx0PScnIHdpZHRoPSczMicgc3JjPScuLi9JTUFHRS9BRE1JTi9hcHAtbG9nby5wbmcnLyBzdHlsZT0nbWFyZ2luOjJweDsnPiINCgkJCQlFbmQgSWYNCgkJCUVuZCBJZg0KDQoJCQlzPXMgJiAiPHN0cm9uZyBzdHlsZT0nZGlzcGxheTpub25lOyc+IiYgU2VydmVyLlVSTEVuY29kZShvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJpZCIpLnRleHQpICYiPC9zdHJvbmc+Ig0KDQoJCQlzPXMgJiAiPC90ZD4iDQoNCgkJCSdzPXMgJiAiPHRkPiImIG0gJiI8L3RkPiINCgkJCXM9cyAmICI8dGQ+PGEgaWQ9IiJteWxpbmsiJkxlZnQobWQ1KG9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoImlkIikudGV4dCksNikmIiIiIGhyZWY9IiIkZGl2IiZvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJpZCIpLnRleHQmInRpcD93aWR0aD0zMDAiIiBjbGFzcz0iImJldHRlclRpcCIiIHRpdGxlPSIiJGNvbnRlbnQiIj4iICYgIiIgJiBvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJuYW1lIikudGV4dCAmICImbmJzcDsmbmJzcDsmbmJzcDsiICYgb2JqWG1sRmlsZS5kb2N1bWVudEVsZW1lbnQuc2VsZWN0U2luZ2xlTm9kZSgidmVyc2lvbiIpLnRleHQgJiAiPC9hPjxkaXYgaWQ9IiJkaXYiJm9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoImlkIikudGV4dCYidGlwIiIgc3R5bGU9IiJkaXNwbGF5Om5vbmU7IiI+IiZvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJub3RlIikudGV4dCYiPC9kaXY+PC90ZD4iDQoJCQlzPXMgJiAiPHRkPiIgJiAiPGEgdGFyZ2V0PSIiX2JsYW5rIiIgaHJlZj0iIiIgJiBvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJhdXRob3IvdXJsIikudGV4dCAmICIiIj4iJiBvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJhdXRob3IvbmFtZSIpLnRleHQgJiAiPC9hPjwvdGQ+Ig0KCQkJJ3M9cyAmICI8dGQ+IiAmIG9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoInZlcnNpb24iKS50ZXh0ICYgIjwvdGQ+Ig0KCQkJcz1zICYgIjx0ZD4iJiBvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJtb2RpZmllZCIpLnRleHQgJiI8L3RkPiINCg0KCQkJCXM9cyAmICI8dGQgYWxpZ249J2NlbnRlcic+Ig0KCQkJSWYgQ2hlY2tQbHVnaW5TdGF0ZShvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJpZCIpLnRleHQpIFRoZW4NCgkJCQlJZiBDaGVja1JpZ2h0cygiUGx1Z0luRGlzYWJsZSIpPVRydWUgVGhlbg0KCQkJCQlzPXMgJiAiPGEgaHJlZj0iIi4uL2NtZC5hc3A/YWN0PVBsdWdJbkRpc2FibGUmYW1wO25hbWU9IiYgU2VydmVyLlVSTEVuY29kZShvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJpZCIpLnRleHQpICYiIiI+PGltZyB3aWR0aD0nMTYnIHRpdGxlPSciJlpDX01TRzIwMyYiJyBhbHQ9JyImWkNfTVNHMjAzJiInIHNyYz0nLi4vSU1BR0UvQURNSU4vY29udHJvbC1wb3dlci5wbmcnLz48L2E+Ig0KCQkJCUVsc2UNCg0KCQkJCUVuZCBJZg0KCQkJRWxzZQ0KCQkJCUlmIENoZWNrUmlnaHRzKCJQbHVnSW5BY3RpdmUiKT1UcnVlIFRoZW4NCgkJCQkJcz1zICYgIjxhIGhyZWY9IiIuLi9jbWQuYXNwP2FjdD1QbHVnSW5BY3RpdmUmYW1wO25hbWU9IiYgU2VydmVyLlVSTEVuY29kZShvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJpZCIpLnRleHQpICYiIiI+PGltZyB3aWR0aD0nMTYnIHRpdGxlPSciJlpDX01TRzIwMiYiJyBhbHQ9JyImWkNfTVNHMjAyJiInIHNyYz0nLi4vSU1BR0UvQURNSU4vY29udHJvbC1wb3dlci1vZmYucG5nJy8+PC9hPiINCgkJCQlFbHNlDQoJCQkJRW5kIElmDQoJCQlFbmQgSWYNCg0KCQkJSWYgQ2hlY2tQbHVnaW5TdGF0ZShvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJpZCIpLnRleHQpIFRoZW4NCgkJCQlJZiBCbG9nVXNlci5MZXZlbDw9Q0xuZyhvYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJsZXZlbCIpLnRleHQpIFRoZW4NCgkJCQkJSWYgUHVibGljT2JqRlNPLkZpbGVFeGlzdHMoQmxvZ1BhdGggJiAiemJfdXNlcnMvcGx1Z2luLyIgJiBmMS5uYW1lICYgIi8iICYgb2JqWG1sRmlsZS5kb2N1bWVudEVsZW1lbnQuc2VsZWN0U2luZ2xlTm9kZSgicGF0aCIpLnRleHQpIFRoZW4NCgkJCQkJCXM9cyAmICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDs8YSBocmVmPSIiLi4vLi4vWkJfVVNFUlMvcGx1Z2luLyIgJiBmMS5uYW1lICYgIi8iICYgb2JqWG1sRmlsZS5kb2N1bWVudEVsZW1lbnQuc2VsZWN0U2luZ2xlTm9kZSgicGF0aCIpLnRleHQgJiIiIj48aW1nIHdpZHRoPScxNicgdGl0bGU9JyImWkNfTVNHMDIyJiInIGFsdD0nIiZaQ19NU0cwMjImIicgc3JjPScuLi9JTUFHRS9BRE1JTi9zZXR0aW5nX3Rvb2xzLnBuZycvPjwvYT4iDQoJCQkJCUVuZCBJZg0KCQkJCUVuZCBJZg0KCQkJRWxzZQ0KCQkJRW5kIElmDQoJCQlzPXMgJiAiPC90ZD4iDQoNCgkJCXM9cyAmICI8L3RyPiINCg0KDQoJCQlJZiBDaGVja1BsdWdpblN0YXRlKG9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoImlkIikudGV4dCkgVGhlbg0KDQoJCQkJJ2o9VUJvdW5kKGFyeVBMX0VuYWJsZSkNCgkJCQknUmVEaW0gUHJlc2VydmUgYXJ5UExfRW5hYmxlKGorMSkNCgkJCQlhcnlQTF9FbmFibGUobik9cw0KCQkJRWxzZQ0KCQkJCWo9VUJvdW5kKGFyeVBMX0Rpc2FibGUpDQoJCQkJUmVEaW0gUHJlc2VydmUgYXJ5UExfRGlzYWJsZShqKzEpDQoJCQkJYXJ5UExfRGlzYWJsZShqKT1zDQoJCQlFbmQgSWYNCg0KCQkJCUVuZCBJZg0KCQkJRW5kIElmDQoJCQlTZXQgb2JqWG1sRmlsZT1Ob3RoaW5nDQoJCUVuZCBJZg0KCU5leHQNCg0KCVJlc3BvbnNlLldyaXRlIEpvaW4oYXJ5UExfRW5hYmxlKQ0KDQoJUmVzcG9uc2UuV3JpdGUgSm9pbihhcnlQTF9EaXNhYmxlKQ0KDQoJUmVzcG9uc2UuV3JpdGUgIjwvdGFibGU+Ig0KCQ0KCVJlc3BvbnNlLldyaXRlICI8L2Rpdj4iDQoNCiU+DQoNCjwlDQoNCglFcnIuQ2xlYXINCg0KCVJlc3BvbnNlLldyaXRlICI8c2NyaXB0IHR5cGU9IiJ0ZXh0L2phdmFzY3JpcHQiIj5BY3RpdmVMZWZ0TWVudSgiImFQbHVnSW5NbmciIik7PC9zY3JpcHQ+Ig0KDQoJRXhwb3J0UGx1Z2luTW5nPVRydWUNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBFeHBvcnRTaXRlSW5mbygpDQoNCglEaW0gcyxrDQoNCg0KCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIiZGl2SGVhZGVyIiI+IiAmIFpDX01TRzE1OSAmICI8L2Rpdj4iDQoJUmVzcG9uc2UuV3JpdGUgIjxkaXYgY2xhc3M9IiJTdWJNZW51IiI+IiAmIFJlc3BvbnNlX1BsdWdpbl9TaXRlSW5mb19TdWJNZW51ICYgIjwvZGl2PiINCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBpZD0iImRpdk1haW4yIiI+Ig0KCQ0KCQ0KCUlmIEJsb2dVc2VyLkxldmVsPDQgVGhlbiANCgkJcz1zICYgIjx0YWJsZSBib3JkZXI9IiIwIiIgY2VsbHNwYWNpbmc9IiIwIiIgY2VsbHBhZGRpbmc9IiIwIiIgYWxpZ249IiJjZW50ZXIiIiB3aWR0aD0iIjEwMCUiIiBjbGFzcz0iInRhYmxlQm9yZGVyIiIgaWQ9IiJ0YlN0YXRpc3RpYyIiPjx0cj48dGggaGVpZ2h0PSIiMzIiIiBjb2xzcGFuPSIiNCIiICBhbGlnbj0iImNlbnRlciIiPiZuYnNwOyImWkNfTVNHMTY3JiImbmJzcDs8YSBocmVmPSIiamF2YXNjcmlwdDpzdGF0aXN0aWMoJz9yZWxvYWQnKTsiIj5bIiZaQ19NU0cyMjUmWkNfTVNHMjgxJiJdPC9hPiA8aW1nIGlkPSIic3RhdGxvYWRpbmciIiBzdHlsZT0iImRpc3BsYXk6bm9uZSIiIHNyYz0iIi4uL2ltYWdlL2FkbWluL2xvYWRpbmcuZ2lmIiI+PC90aD48L3RyPjx0cj48dGQ+PC90ZD48L3RyPjwvdGFibGU+Ig0KCUVuZCBJZg0KCUlmIExlbihaQ19VUERBVEVfSU5GT19VUkwpPjAgVGhlbg0KCQlzPXMgJiAiPHRhYmxlIGJvcmRlcj0iIjAiIiBjZWxsc3BhY2luZz0iIjAiIiBjZWxscGFkZGluZz0iIjAiIiBhbGlnbj0iImNlbnRlciIiIHdpZHRoPSIiMTAwJSIiIGNsYXNzPSIidGFibGVCb3JkZXIiIj48dHI+PHRoIGhlaWdodD0iIjMyIiIgY29sc3Bhbj0iIjQiIiBhbGlnbj0iImNlbnRlciIiPiZuYnNwOyImWkNfTVNHMTY0JiImbmJzcDs8YSBocmVmPSIiamF2YXNjcmlwdDp1cGRhdGVpbmZvKCc/cmVsb2FkJyk7IiI+WyImWkNfTVNHMjI1JiJdPC9hPiA8aW1nIGlkPSIiaW5mb2xvYWRpbmciIiBzdHlsZT0iImRpc3BsYXk6bm9uZSIiIHNyYz0iIi4uL2ltYWdlL2FkbWluL2xvYWRpbmcuZ2lmIiI+PC90aD48L3RyPjx0cj48dGQgaGVpZ2h0PSIiMjUiIiBjb2xzcGFuPSIiNCIiIGlkPSIidGRVcGRhdGVJbmZvIiI+Jm5ic3A7PC90ZD48L3RyPjwvdGFibGU+Ig0KCUVuZCBJZg0KCWsgPSBMb2FkRnJvbUZpbGUoQmxvZ1BhdGggJiAiemJfc3lzdGVtXGRlZmVuZFx0aGFua3MuaHRtbCIsInV0Zi04IikNCglrID0gUmVwbGFjZShrLCJ7JVpDX01TRzMwMyV9IixaQ19NU0czMDMpDQoJayA9IFJlcGxhY2UoaywieyVaQ19NU0czMDQlfSIsWkNfTVNHMzA0KQ0KCWsgPSBSZXBsYWNlKGssInslWkNfTVNHMzA1JX0iLFpDX01TRzMwNSkNCglrID0gUmVwbGFjZShrLCJ7JVpDX01TRzMwNiV9IixaQ19NU0czMDYpDQoJayA9IFJlcGxhY2UoaywieyVaQ19NU0czMDclfSIsWkNfTVNHMzA3KQ0KCWsgPSBSZXBsYWNlKGssInslWkNfTVNHMzA4JX0iLFpDX01TRzMwOCkNCglzID0gcyAmIGsNCglSZXNwb25zZS5Xcml0ZSBzDQoJUmVzcG9uc2UuV3JpdGUgUmVzcG9uc2VfUGx1Z2luX0FkbWluX1NpdGVJbmZvDQoJUmVzcG9uc2UuV3JpdGUgIjwvZGl2PiINCg0KCVJlc3BvbnNlLldyaXRlICI8c2NyaXB0IHR5cGU9IiJ0ZXh0L2phdmFzY3JpcHQiIj5zdGF0aXN0aWMoIiIiIik7dXBkYXRlaW5mbygiIiIiKTs8L3NjcmlwdD4iDQoJUmVzcG9uc2UuV3JpdGUgIjxzY3JpcHQgdHlwZT0iInRleHQvamF2YXNjcmlwdCIiPkFjdGl2ZUxlZnRNZW51KCIiYVNpdGVJbmZvIiIpOzwvc2NyaXB0PiINCglSZXNwb25zZS5Xcml0ZSAiPHNjcmlwdCB0eXBlPSIidGV4dC9qYXZhc2NyaXB0IiI+QWN0aXZlVG9wTWVudSgiInRvcG1lbnUxIiIpOzwvc2NyaXB0PiINCg0KCUV4cG9ydFNpdGVJbmZvPVRydWUNCg0KCUVyci5DbGVhcg0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEV4cG9ydEZpbGVSZUJ1aWxkQXNrKCkNCg0KCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIiZGl2SGVhZGVyMiIiPiIgJiBaQ19NU0cwNzMgJiAiPC9kaXY+Ig0KCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIiU3ViTWVudSIiPiIgJiBSZXNwb25zZV9QbHVnaW5fQXNrRmlsZVJlQnVpbGRfU3ViTWVudSAmICI8L2Rpdj4iDQoJUmVzcG9uc2UuV3JpdGUgIjxkaXYgaWQ9IiJkaXZNYWluMiIiPiINCg0KCVJlc3BvbnNlLldyaXRlICI8Zm9ybSBpZD0iImVkaXQiIiBuYW1lPSIiZWRpdCIiIG1ldGhvZD0iInBvc3QiIiBhY3Rpb249IiIuLi9jbWQuYXNwP2FjdD1GaWxlUmVCdWlsZCIiPiIgJiB2YkNybGYNCglSZXNwb25zZS5Xcml0ZSAiPHA+IiYgWkNfTVNHMTEyICYiPC9wPiIgJiB2YkNybGYNCg0KCVJlc3BvbnNlLldyaXRlICI8cD48aW5wdXQgY2xhc3M9IiJidXR0b24iIiB0eXBlPSIic3VibWl0IiIgdmFsdWU9IiIiJlpDX01TRzA4NyYiIiIgaWQ9IiJidG5Qb3N0IiIvPiINCg0KCVJlc3BvbnNlLldyaXRlICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDs8aW5wdXQgc3R5bGU9IiJkaXNwbGF5Om5vbmU7IiIgY2xhc3M9IiJidXR0b24iIiB0eXBlPSIiYnV0dG9uIiIgb25jbGljaz0nJCh0aGlzKS5wcm9wKHtkaXNhYmxlZDogdHJ1ZX0pO0JhdGNoQ2FuY2VsKCknIHZhbHVlPSIiIiZaQ19NU0cyNjQmIiIiLz4iDQoNCglSZXNwb25zZS5Xcml0ZSAiPHNjcmlwdCB0eXBlPSIidGV4dC9qYXZhc2NyaXB0IiI+aWYod2luZG93LndlYmtpdE5vdGlmaWNhdGlvbnMmJighd2luZG93LndlYmtpdE5vdGlmaWNhdGlvbnMuY2hlY2tQZXJtaXNzaW9uKCkgPT0gMCkpe2RvY3VtZW50LndyaXRlKCcmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDs8aW5wdXQgY2xhc3M9IiJidXR0b24iIiBvbmNsaWNrPSIid2luZG93LndlYmtpdE5vdGlmaWNhdGlvbnMucmVxdWVzdFBlcm1pc3Npb24oKTtyZXR1cm4gZmFsc2U7IiIgdHlwZT0iImJ1dHRvbiIiIHZhbHVlPSIiIiZaQ19NU0cyNjMmIiIiLz4nKX08L3NjcmlwdD4iCQ0KDQoJUmVzcG9uc2UuV3JpdGUgIjwvcD4iICYgdmJDcmxmDQoJUmVzcG9uc2UuV3JpdGUgIjwvZm9ybT4iIA0KDQoJUmVzcG9uc2UuV3JpdGUgIjwvZGl2PiINCg0KDQoNCglSZXNwb25zZS5Xcml0ZSAiPHNjcmlwdCB0eXBlPSIidGV4dC9qYXZhc2NyaXB0IiI+QWN0aXZlTGVmdE1lbnUoIiJhQXNrRmlsZVJlQnVpbGQiIik7PC9zY3JpcHQ+Ig0KCVJlc3BvbnNlLldyaXRlICI8c2NyaXB0IHR5cGU9IiJ0ZXh0L2phdmFzY3JpcHQiIj5BY3RpdmVUb3BNZW51KCIidG9wbWVudTMiIik7PC9zY3JpcHQ+Ig0KDQoJUmVzcG9uc2UuV3JpdGUgIjxzY3JpcHQgdHlwZT0iInRleHQvamF2YXNjcmlwdCIiPmZ1bmN0aW9uIEJhdGNoQmVnaW4oKXskKCIiaW5wdXRbdHlwZT0nc3VibWl0J10iIikucHJvcCh7ZGlzYWJsZWQ6IHRydWV9KTskKCIiaW5wdXRbdHlwZT0nYnV0dG9uJ10iIikuc2hvdygpO307PC9zY3JpcHQ+Ig0KCVJlc3BvbnNlLldyaXRlICI8c2NyaXB0IHR5cGU9IiJ0ZXh0L2phdmFzY3JpcHQiIj5mdW5jdGlvbiBCYXRjaEVuZCgpeyQoIiJpbnB1dFt0eXBlPSdzdWJtaXQnXSIiKS5wcm9wKHtkaXNhYmxlZDogZmFsc2V9KTskKCIiaW5wdXRbdHlwZT0nYnV0dG9uJ10iIikuaGlkZSgpO307PC9zY3JpcHQ+Ig0KDQoJRXhwb3J0RmlsZVJlQnVpbGRBc2s9VHJ1ZQ0KDQpFbmQgRnVuY3Rpb24NCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCg0KDQoNCg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KJyDnm67nmoTvvJoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkZ1bmN0aW9uIEV4cG9ydFRoZW1lTW5nKCkNCg0KCU9uIEVycm9yIFJlc3VtZSBOZXh0DQoNCglEaW0gQ3VycmVudFRoZW1lDQoJRGltIEN1cnJlbnRTdHlsZQ0KDQoJQ3VycmVudFRoZW1lPVpDX0JMT0dfVEhFTUUNCglDdXJyZW50U3R5bGU9WkNfQkxPR19DU1MNCg0KCURpbSBUaGVtZV9JZA0KCURpbSBUaGVtZV9OYW1lDQoJRGltIFRoZW1lX1VybA0KCURpbSBUaGVtZV9Ob3RlDQoJRGltIFRoZW1lX0Rlc2NyaXB0aW9uDQoJRGltIFRoZW1lX1B1YmRhdGUNCglEaW0gVGhlbWVfTW9kaWZpZWQNCglEaW0gVGhlbWVfU291cmNlX05hbWUNCglEaW0gVGhlbWVfU291cmNlX1VybA0KCURpbSBUaGVtZV9BdXRob3JfTmFtZQ0KCURpbSBUaGVtZV9BdXRob3JfVXJsDQoJRGltIFRoZW1lX1NjcmVlblNob3QNCglEaW0gVGhlbWVfU3R5bGVfTmFtZQ0KCURpbSBpLGoNCglEaW0gYXJ5RmlsZUxpc3QNCg0KCUlmIFJlcXVlc3QuUXVlcnlTdHJpbmcoImluc3RhbGxlZCIpPD4iIiBUaGVuDQoNCgkJQ2FsbCBJbnN0YWxsUGx1Z2luKFJlcXVlc3QuUXVlcnlTdHJpbmcoImluc3RhbGxlZCIpKQ0KDQoJRW5kIElmDQoNCg0KCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIiZGl2SGVhZGVyIiI+IiAmIFpDX01TRzIyMyAmICI8L2Rpdj4iDQoJUmVzcG9uc2UuV3JpdGUgIjxkaXYgY2xhc3M9IiJTdWJNZW51IiI+IiAmIFJlc3BvbnNlX1BsdWdpbl9UaGVtZU1uZ19TdWJNZW51ICYgIjwvZGl2PiINCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBpZD0iImRpdk1haW4yIiI+Ig0KDQoNCg0KCVJlc3BvbnNlLldyaXRlICI8Zm9ybSBpZD0iImZybVRoZW1lIiIgbWV0aG9kPSIicG9zdCIiIGFjdGlvbj0iIi4uL2NtZC5hc3A/YWN0PVRoZW1lU2F2IiI+Ig0KDQoJRGltIG9ialhtbEZpbGUsc3RyWG1sRmlsZQ0KCURpbSBmLCBmMSwgZmMsIHMNCgkNCglJZiBOb3QgSXNPYmplY3QoUHVibGljT2JqRlNPKSBUaGVuIFNldCBQdWJsaWNPYmpGU089U2VydmVyLkNyZWF0ZU9iamVjdCgiU2NyaXB0aW5nLkZpbGVTeXN0ZW1PYmplY3QiKQ0KCQ0KCVNldCBmID0gUHVibGljT2JqRlNPLkdldEZvbGRlcihCbG9nUGF0aCAmICJ6Yl91c2Vycy90aGVtZSIgJiAiLyIpDQoJU2V0IGZjID0gZi5TdWJGb2xkZXJzDQoJRm9yIEVhY2ggZjEgaW4gZmMNCg0KCQlJZiBQdWJsaWNPYmpGU08uRmlsZUV4aXN0cyhCbG9nUGF0aCAmICJ6Yl91c2Vycy90aGVtZSIgJiAiLyIgJiBmMS5uYW1lICYgIi8iICYgInRoZW1lLnhtbCIpIFRoZW4NCg0KCQkJc3RyWG1sRmlsZSA9QmxvZ1BhdGggJiAiemJfdXNlcnMvdGhlbWUiICYgIi8iICYgZjEubmFtZSAmICIvIiAmICJ0aGVtZS54bWwiDQoNCgkJCVNldCBvYmpYbWxGaWxlPVNlcnZlci5DcmVhdGVPYmplY3QoIk1pY3Jvc29mdC5YTUxET00iKQ0KCQkJb2JqWG1sRmlsZS5hc3luYyA9IEZhbHNlDQoJCQlvYmpYbWxGaWxlLlZhbGlkYXRlT25QYXJzZT1GYWxzZQ0KCQkJb2JqWG1sRmlsZS5sb2FkKHN0clhtbEZpbGUpDQoJCQlJZiBvYmpYbWxGaWxlLnJlYWR5U3RhdGU9NCBUaGVuDQoJCQkJSWYgb2JqWG1sRmlsZS5wYXJzZUVycm9yLmVycm9yQ29kZSA8PiAwIFRoZW4NCgkJCQlFbHNlDQoNCgkJCQkJVGhlbWVfSWQ9IiINCgkJCQkJVGhlbWVfTmFtZT0iIg0KCQkJCQlUaGVtZV9Vcmw9IiINCgkJCQkJVGhlbWVfTm90ZT0iIg0KCQkJCQlUaGVtZV9EZXNjcmlwdGlvbj0iIg0KCQkJCQlUaGVtZV9QdWJkYXRlPSIiDQoJCQkJCVRoZW1lX01vZGlmaWVkPSIiDQoJCQkJCVRoZW1lX1NvdXJjZV9OYW1lPSIiDQoJCQkJCVRoZW1lX1NvdXJjZV9Vcmw9IiINCgkJCQkJVGhlbWVfQXV0aG9yX05hbWU9IiINCgkJCQkJVGhlbWVfQXV0aG9yX1VybD0iIg0KCQkJCQlUaGVtZV9TY3JlZW5TaG90PSIiDQoJCQkJCVRoZW1lX1N0eWxlX05hbWU9IiINCg0KCQkJCQlUaGVtZV9Tb3VyY2VfTmFtZT1vYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJzb3VyY2UvbmFtZSIpLnRleHQNCgkJCQkJVGhlbWVfU291cmNlX1VybD1vYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJzb3VyY2UvdXJsIikudGV4dA0KDQoJCQkJCVRoZW1lX0F1dGhvcl9OYW1lPW9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoImF1dGhvci9uYW1lIikudGV4dA0KCQkJCQlUaGVtZV9BdXRob3JfVXJsPW9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoImF1dGhvci91cmwiKS50ZXh0DQoNCgkJCQkJSWYgVGhlbWVfQXV0aG9yX05hbWU9IiIgVGhlbg0KCQkJCQkJVGhlbWVfQXV0aG9yX05hbWU9VGhlbWVfU291cmNlX05hbWUNCgkJCQkJCVRoZW1lX0F1dGhvcl9Vcmw9VGhlbWVfU291cmNlX1VybA0KCQkJCQlFbmQgSWYNCg0KDQoJCQkJCSdUaGVtZV9JZD1mMS5uYW1lDQoJCQkJCVRoZW1lX0lkPW9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoImlkIikudGV4dA0KCQkJCQlUaGVtZV9OYW1lPW9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoIm5hbWUiKS50ZXh0DQoJCQkJCVRoZW1lX1VybD1vYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJ1cmwiKS50ZXh0DQoJCQkJCVRoZW1lX05vdGU9b2JqWG1sRmlsZS5kb2N1bWVudEVsZW1lbnQuc2VsZWN0U2luZ2xlTm9kZSgibm90ZSIpLnRleHQNCgkJCQkJVGhlbWVfUHViZGF0ZT1vYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJwdWJkYXRlIikudGV4dA0KCQkJCQlUaGVtZV9Nb2RpZmllZD1vYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJtb2RpZmllZCIpLnRleHQNCg0KCQkJCQlUaGVtZV9EZXNjcmlwdGlvbj1vYmpYbWxGaWxlLmRvY3VtZW50RWxlbWVudC5zZWxlY3RTaW5nbGVOb2RlKCJkZXNjcmlwdGlvbiIpLnRleHQNCg0KCQkJCQlUaGVtZV9TY3JlZW5TaG90PSIuLi8uLi96Yl91c2Vycy90aGVtZSIgJiIvIiAmIFRoZW1lX0lkICYgIi8iICYgInNjcmVlbnNob3QucG5nIg0KDQoNCg0KDQoJCUlmIFVDYXNlKFRoZW1lX0lkKT1VQ2FzZShDdXJyZW50VGhlbWUpIFRoZW4NCgkJCVJlc3BvbnNlLldyaXRlICI8ZGl2IGlkPSIidGhlbWUtIiZUaGVtZV9JZCYiIiIgY2xhc3M9IiJ0aGVtZSB0aGVtZS1ub3ciIj4iDQoJCUVsc2UNCgkJCVJlc3BvbnNlLldyaXRlICI8ZGl2IGlkPSIidGhlbWUtIiZUaGVtZV9JZCYiIiIgY2xhc3M9IiJ0aGVtZSB0aGVtZS1vdGhlciIiPiINCgkJRW5kIElmDQoNCgkJSWYgVUNhc2UoVGhlbWVfSWQpIDw+IFVDYXNlKGYxLm5hbWUpIFRoZW4NCgkJCVJlc3BvbnNlLldyaXRlICI8ZGl2IHN0eWxlPSIiY29sb3I6cmVkOyIiPklEIEVycm9yISBTaG91bGQgYmUgIiI8c3Ryb25nPiImIGYxLm5hbWUgJiI8L3N0cm9uZz4iIiEhPC9kaXY+Ig0KCQlFbHNlDQoJCQlSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iInRoZW1lLW5hbWUiIj48aW1nIHdpZHRoPScxNicgdGl0bGU9JycgYWx0PScnIHNyYz0nLi4vSU1BR0UvQURNSU4vbGF5b3V0LnBuZycvPiA8YSAgdGFyZ2V0PSIiX2JsYW5rIiIgaHJlZj0iIiImVGhlbWVfVXJsJiIiIiAgdGl0bGU9IiIiIj4iICYgIjxzdHJvbmcgc3R5bGU9J2Rpc3BsYXk6bm9uZTsnPiIgJiBTZXJ2ZXIuVVJMRW5jb2RlKFRoZW1lX0lkKSAmICI8L3N0cm9uZz48Yj4iICYgVGhlbWVfTmFtZSAmICI8L2I+IiAmICI8L2E+Ig0KCQkJSWYgVUNhc2UoVGhlbWVfSWQpPVVDYXNlKEN1cnJlbnRUaGVtZSkgVGhlbg0KCQkJCUlmIFB1YmxpY09iakZTTy5GaWxlRXhpc3RzKEJsb2dQYXRoICYgInpiX3VzZXJzL3RoZW1lLyIgJiBaQ19CTE9HX1RIRU1FICYgIi9wbHVnaW4vIiAmIG9ialhtbEZpbGUuZG9jdW1lbnRFbGVtZW50LnNlbGVjdFNpbmdsZU5vZGUoInBsdWdpbi9wYXRoIikudGV4dCkgVGhlbg0KCQkJCQlSZXNwb25zZS5Xcml0ZSAiPGlucHV0IHR5cGU9IiJidXR0b24iIiBjbGFzcz0iInRoZW1lLWNvbmZpZyBidXR0b24iIiB2YWx1ZT0iIiImWkNfTVNHMjc4JiIiIiBvbmNsaWNrPSIibG9jYXRpb24uaHJlZj0nIiZCbG9nSG9zdCYiemJfdXNlcnMvdGhlbWUvIiZaQ19CTE9HX1RIRU1FJiIvcGx1Z2luLyImb2JqWG1sRmlsZS5kb2N1bWVudEVsZW1lbnQuc2VsZWN0U2luZ2xlTm9kZSgicGx1Z2luL3BhdGgiKS50ZXh0JiInIiI+Ig0KCQkJCUVuZCBJZg0KCQkJRW5kIElmDQoJCQlSZXNwb25zZS5Xcml0ZSAiPC9kaXY+Ig0KCQlFbmQgSWYNCg0KDQoJCVJlc3BvbnNlLldyaXRlICI8ZGl2PjxhIGlkPSIibXlsaW5rIiZMZWZ0KG1kNShUaGVtZV9JZCksNikmIiIiIGhyZWY9IiIkZGl2IiZMZWZ0KG1kNShUaGVtZV9JZCksNikmInRpcD93aWR0aD0zMjAiIiBjbGFzcz0iImJldHRlclRpcCIiIHRpdGxlPSIiIiZUaGVtZV9OYW1lJiIiIiAiDQoJCUlmIFVDYXNlKFRoZW1lX0lkKTw+VUNhc2UoQ3VycmVudFRoZW1lKSBUaGVuIFJlc3BvbnNlLldyaXRlICIgb25jbGljaz0nJCgiIiNlZHRaQ19CTE9HX1RIRU1FIiIpLnZhbCgiIiImVGhlbWVfSWQmIiIiKTskKCIiI2VkdFpDX0JMT0dfQ1NTIiIpLnZhbCgkKCIiI2NhdGUiJkxlZnQobWQ1KFRoZW1lX0lkKSw2KSYiIiIpLnZhbCgpKTskKCIiI2ZybVRoZW1lIiIpLnN1Ym1pdCgpOyciDQoJCVJlc3BvbnNlLldyaXRlICI+PGltZyBzcmM9IiIiICYgVGhlbWVfU2NyZWVuU2hvdCAmICIiIiBhbHQ9IiJTY3JlZW5TaG90IiIgd2lkdGg9IiIyMDAiIiBoZWlnaHQ9IiIxNTAiIiAvPjwvYT48L2Rpdj4iDQoNCgkJUmVzcG9uc2UuV3JpdGUgIjxkaXYgaWQ9IiJkaXYiJkxlZnQobWQ1KFRoZW1lX0lkKSw2KSYidGlwIiIgc3R5bGU9IiJkaXNwbGF5Om5vbmU7IiI+Ig0KCQlSZXNwb25zZS5Xcml0ZSAiPHRhYmxlIGJvcmRlcj0iIjAiIiBjZWxsc3BhY2luZz0iIjAiIiBjZWxscGFkZGluZz0iIjAiIiBhbGlnbj0iImNlbnRlciIiIHdpZHRoPSIiMTAwJSIiIGNsYXNzPSIidGFibGVCb3JkZXIiIj48dGJvZHk+Ig0KCQlSZXNwb25zZS5Xcml0ZSAiPHRyPjx0aCBjb2xzcGFuPSIiMiIiPklEIDogIiAmIFRoZW1lX0lkICYgIjwvdGg+PC90cj4iDQoJCVJlc3BvbnNlLldyaXRlICI8dHI+PHRkIHdpZHRoPSIiNjBweCIiPiImWkNfTVNHMTI4JiI8L3RkPjx0ZD4iICYgVGhlbWVfQXV0aG9yX05hbWUgJiI8L3RkPjwvdHI+Ig0KCQlSZXNwb25zZS5Xcml0ZSAiPHRyPjx0ZD4iJlpDX01TRzA1NCYiPC90ZD48dGQ+IiAmIFRoZW1lX0F1dGhvcl9VcmwgJiAiPC90ZD48L3RyPiINCgkJUmVzcG9uc2UuV3JpdGUgIjx0cj48dGQ+IiZaQ19NU0cxOTcmIjwvdGQ+PHRkPiIgJiBUaGVtZV9Tb3VyY2VfTmFtZSAmICI8L3RkPjwvdHI+Ig0KCQlSZXNwb25zZS5Xcml0ZSAiPHRyPjx0ZD4iJlpDX01TRzA1NCYiPC90ZD48dGQ+IiAmIFRoZW1lX1NvdXJjZV9VcmwgJiAiPC90ZD48L3RyPiINCgkJUmVzcG9uc2UuV3JpdGUgIjx0cj48dGQ+IiZaQ19NU0cwMTEmIjwvdGQ+PHRkPiIgJiBUaGVtZV9QdWJkYXRlICYgIjwvdGQ+PC90cj4iDQoJCVJlc3BvbnNlLldyaXRlICI8dHI+PHRkPiImWkNfTVNHMTUxJiI8L3RkPjx0ZD4iICYgVGhlbWVfTW9kaWZpZWQgJiAiPC90ZD48L3RyPiINCgkJUmVzcG9uc2UuV3JpdGUgIjx0cj48dGQ+IiZaQ19NU0cxOTgmIjwvdGQ+PHRkPiIgJiBUcmFuc2ZlckhUTUwoVGhlbWVfRGVzY3JpcHRpb24sIltlbnRlcl0iKSAmICI8L3RyPiINCgkJUmVzcG9uc2UuV3JpdGUgIjwvdGJvZHk+PC90YWJsZT4iDQoJCVJlc3BvbnNlLldyaXRlICI8L2Rpdj4iDQoNCicJCUlmIFRoZW1lX1VybD0iIiBUaGVuDQonCQkJUmVzcG9uc2UuV3JpdGUgIjxwPiImWkNfTVNHMDAxJiI6IiAmIFRoZW1lX05hbWUgJiAiPC9wPiINCicJCUVsc2UNCicJCQlSZXNwb25zZS5Xcml0ZSAiPHA+IiZaQ19NU0cwMDEmIjo8YSB0YXJnZXQ9IiJfYmxhbmsiIiBocmVmPSIiIiAmIFRoZW1lX1VybCAmICIiIj4iICYgVGhlbWVfTmFtZSAmICI8L2E+PC9wPiINCicJCUVuZCBJZg0KDQoJCUlmIFRoZW1lX0F1dGhvcl9Vcmw9IiIgVGhlbg0KCQkJUmVzcG9uc2UuV3JpdGUgIjxkaXYgY2xhc3M9IiJ0aGVtZS1hdXRob3IiIj4iJlpDX01TRzEyOCYiOiAiICYgVGhlbWVfQXV0aG9yX05hbWUgJiAiPC9kaXY+Ig0KCQlFbHNlDQoJCQlSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iInRoZW1lLWF1dGhvciIiPiImWkNfTVNHMTI4JiI6IDxhIHRhcmdldD0iIl9ibGFuayIiIGhyZWY9IiIiICYgVGhlbWVfQXV0aG9yX1VybCAmICIiIj4iICYgVGhlbWVfQXV0aG9yX05hbWUgJiAiPC9hPjwvZGl2PiINCgkJRW5kIElmDQoNCg0KJwkJUmVzcG9uc2UuV3JpdGUgIjxwPiImWkNfTVNHMDExJiI6IiAmIFRoZW1lX1B1YmRhdGUgJiAiPC9wPiINCicJCVJlc3BvbnNlLldyaXRlICI8cCBzdHlsZT0naGVpZ2h0OjEuMGVtOyc+IiZaQ19NU0cwMTYmIjoiICYgVGhlbWVfTm90ZSAmICI8L3A+Ig0KCQlSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iInRoZW1lLXN0eWxlIiI+IiZaQ19NU0cxOTYmIjogIiAmICI8c2VsZWN0IGNsYXNzPSIiZWRpdCIiIHNpemU9IiIxIiIgaWQ9IiJjYXRlIiZMZWZ0KG1kNShUaGVtZV9JZCksNikmIiIiIG5hbWU9IiJjYXRlIiZMZWZ0KG1kNShUaGVtZV9JZCksNikmIiIiIHN0eWxlPSIid2lkdGg6MTEwcHg7IiIgb25jaGFuZ2U9IiJkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWR0WkNfQkxPR19USEVNRScpLnZhbHVlPSciJlRoZW1lX0lkJiInO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZHRaQ19CTE9HX0NTUycpLnZhbHVlPXRoaXMub3B0aW9uc1t0aGlzLnNlbGVjdGVkSW5kZXhdLnZhbHVlIiI+Ig0KDQoNCgkJYXJ5RmlsZUxpc3Q9TG9hZEluY2x1ZGVGaWxlcygiemJfdXNlcnNcdGhlbWUiICYgIi8iICYgVGhlbWVfSWQgJiAiL3N0eWxlIikNCg0KCQlJZiBJc0FycmF5KGFyeUZpbGVMaXN0KSBUaGVuDQoJCQlqPVVCb3VuZChhcnlGaWxlTGlzdCkNCgkJCUZvciBpPTEgdG8gag0KCQkJCUlmIChJblN0cihhcnlGaWxlTGlzdChpKSwiLmNzcyIpPjApIE9yIChJblN0cihhcnlGaWxlTGlzdChpKSwiLmFzcCIpKSBUaGVuDQoJCQkJCVRoZW1lX1N0eWxlX05hbWU9UmVwbGFjZShhcnlGaWxlTGlzdChpKSwiLmNzcyIsIiIpDQoJCQkJCVRoZW1lX1N0eWxlX05hbWU9UmVwbGFjZShUaGVtZV9TdHlsZV9OYW1lLCIuYXNwIiwiIikNCgkJCQkJSWYgVGhlbWVfSWQ9Q3VycmVudFRoZW1lIEFuZCBUaGVtZV9TdHlsZV9OYW1lPUN1cnJlbnRTdHlsZSBUaGVuDQoJCQkJCQlSZXNwb25zZS5Xcml0ZSAiIDxvcHRpb24gc2VsZWN0ZWQ9IiJzZWxlY3RlZCIiIHZhbHVlPSIiIiYgVGhlbWVfU3R5bGVfTmFtZSAmIiIiPiImYXJ5RmlsZUxpc3QoaSkmIjwvb3B0aW9uPiAiDQoJCQkJCUVsc2UNCgkJCQkJCUlmIGo9MSBUaGVuDQoJCQkJCQkJUmVzcG9uc2UuV3JpdGUgIiA8b3B0aW9uIHZhbHVlPSIiIiYgVGhlbWVfU3R5bGVfTmFtZSAmIiIiPiImYXJ5RmlsZUxpc3QoaSkmIjwvb3B0aW9uPiAiDQoJCQkJCQlFbHNlSWYgTENhc2UoVGhlbWVfU3R5bGVfTmFtZSk9InN0eWxlIiBUaGVuDQoJCQkJCQkJUmVzcG9uc2UuV3JpdGUgIiA8b3B0aW9uIHZhbHVlPSIiIiYgVGhlbWVfU3R5bGVfTmFtZSAmIiIiPiImYXJ5RmlsZUxpc3QoaSkmIjwvb3B0aW9uPiAiDQoJCQkJCQlFbHNlSWYgTENhc2UoVGhlbWVfU3R5bGVfTmFtZSk9TENhc2UoVGhlbWVfSWQpIFRoZW4NCgkJCQkJCQlSZXNwb25zZS5Xcml0ZSAiIDxvcHRpb24gdmFsdWU9IiIiJiBUaGVtZV9TdHlsZV9OYW1lICYiIiI+IiZhcnlGaWxlTGlzdChpKSYiPC9vcHRpb24+ICINCgkJCQkJCUVsc2UNCgkJCQkJCQlJZiBpPTEgVGhlbg0KCQkJCQkJCQlSZXNwb25zZS5Xcml0ZSAiIDxvcHRpb24gIHZhbHVlPSIiIiYgVGhlbWVfU3R5bGVfTmFtZSAmIiIiPiImYXJ5RmlsZUxpc3QoaSkmIjwvb3B0aW9uPiAiDQoJCQkJCQkJRWxzZQ0KCQkJCQkJCQlSZXNwb25zZS5Xcml0ZSAiIDxvcHRpb24gdmFsdWU9IiIiJiBUaGVtZV9TdHlsZV9OYW1lICYiIiI+IiZhcnlGaWxlTGlzdChpKSYiPC9vcHRpb24+ICINCgkJCQkJCQlFbmQgSWYNCgkJCQkJCUVuZCBJZg0KCQkJCQlFbmQgSWYNCgkJCQlFbmQgSWYNCgkJCU5leHQNCgkJRW5kIElmDQoNCgkJUmVzcG9uc2UuV3JpdGUgIjwvc2VsZWN0PiINCgkJUmVzcG9uc2UuV3JpdGUgIjxpbnB1dCB0eXBlPSIiYnV0dG9uIiIgY2xhc3M9IiJ0aGVtZS1hY3RpdmF0ZSBidXR0b24iIiB2YWx1ZT0iIiImWkNfTVNHMjAyJiIiIiBvbmNsaWNrPSdpZighZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIiJjYXRlIiZMZWZ0KG1kNShUaGVtZV9JZCksNikmIiIiKS52YWx1ZSl7cmV0dXJuIGZhbHNlO31lbHNleyQoIiIjZWR0WkNfQkxPR19USEVNRSIiKS52YWwoIiIiJlRoZW1lX0lkJiIiIik7JCgiIiNlZHRaQ19CTE9HX0NTUyIiKS52YWwoJCgiIiNjYXRlIiZMZWZ0KG1kNShUaGVtZV9JZCksNikmIiIiKS52YWwoKSk7fTskKCIiI2ZybVRoZW1lIiIpLnN1Ym1pdCgpJz48L2Rpdj4iDQoNCg0KCQlSZXNwb25zZS5Xcml0ZSAiPC9kaXY+Ig0KDQoNCg0KCQkJCUVuZCBJZg0KCQkJU2V0IG9ialhtbEZpbGU9Tm90aGluZw0KCQkJRW5kIElmDQoNCgkJRW5kIElmDQoNCglOZXh0DQoNCgkJUmVzcG9uc2UuV3JpdGUgIjxpbnB1dCB0eXBlPSIiaGlkZGVuIiIgbmFtZT0iImVkdFpDX0JMT0dfQ1NTIiIgaWQ9IiJlZHRaQ19CTE9HX0NTUyIiIHZhbHVlPSIiIiIgLz4iDQoJCVJlc3BvbnNlLldyaXRlICI8aW5wdXQgdHlwZT0iImhpZGRlbiIiIG5hbWU9IiJlZHRaQ19CTE9HX1RIRU1FIiIgaWQ9IiJlZHRaQ19CTE9HX1RIRU1FIiIgdmFsdWU9IiIiIiAvPiINCg0KDQoJUmVzcG9uc2UuV3JpdGUgIjwvZm9ybT4iDQoJUmVzcG9uc2UuV3JpdGUgIjwvZGl2PiINCglFcnIuQ2xlYXINCg0KCVJlc3BvbnNlLldyaXRlICI8c2NyaXB0IHR5cGU9IiJ0ZXh0L2phdmFzY3JpcHQiIj5BY3RpdmVMZWZ0TWVudSgiImFUaGVtZU1uZyIiKTs8L3NjcmlwdD4iDQoNCglFeHBvcnRUaGVtZU1uZz1UcnVlDQoNCkVuZCBGdW5jdGlvbg0KJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KDQoNCg0KDQoNCicqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCicg55uu55qE77yaICAgIE1hbmFnZXIgVGFnDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpGdW5jdGlvbiBFeHBvcnRGdW5jdGlvbkxpc3QoKQ0KDQoJQ2FsbCBHZXRGdW5jdGlvbigpDQoNCglDYWxsIEFkZF9SZXNwb25zZV9QbHVnaW4oIlJlc3BvbnNlX1BsdWdpbl9GdW5jdGlvbk1uZ19TdWJNZW51IixNYWtlU3ViTWVudShaQ19NU0cxNDIgJiAiIiwiLi4vY21kLmFzcD9hY3Q9RnVuY3Rpb25FZHQiLCJtLWxlZnQiLEZhbHNlKSkNCg0KQ2FsbCBBZGRfUmVzcG9uc2VfUGx1Z2luKCJSZXNwb25zZV9QbHVnaW5fRnVuY3Rpb25NbmdfU3ViTWVudSIsTWFrZVN1Yk1lbnUoWkNfTVNHMDUyICYgIiIsIi4uL2NtZC5hc3A/YWN0PUZ1bmN0aW9uRWR0JmFtcDtpZD0iJkZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKCJuYXZiYXIiKSkuSUQsIm0tbGVmdCIsRmFsc2UpKQ0KQ2FsbCBBZGRfUmVzcG9uc2VfUGx1Z2luKCJSZXNwb25zZV9QbHVnaW5fRnVuY3Rpb25NbmdfU3ViTWVudSIsTWFrZVN1Yk1lbnUoWkNfTVNHMDMwICYgIiIsIi4uL2NtZC5hc3A/YWN0PUZ1bmN0aW9uRWR0JmFtcDtpZD0iJkZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKCJmYXZvcml0ZSIpKS5JRCwibS1sZWZ0IixGYWxzZSkpDQpDYWxsIEFkZF9SZXNwb25zZV9QbHVnaW4oIlJlc3BvbnNlX1BsdWdpbl9GdW5jdGlvbk1uZ19TdWJNZW51IixNYWtlU3ViTWVudShaQ19NU0cwMzEgJiAiIiwiLi4vY21kLmFzcD9hY3Q9RnVuY3Rpb25FZHQmYW1wO2lkPSImRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUoImxpbmsiKSkuSUQsIm0tbGVmdCIsRmFsc2UpKQ0KQ2FsbCBBZGRfUmVzcG9uc2VfUGx1Z2luKCJSZXNwb25zZV9QbHVnaW5fRnVuY3Rpb25NbmdfU3ViTWVudSIsTWFrZVN1Yk1lbnUoWkNfTVNHMDM5ICYgIiIsIi4uL2NtZC5hc3A/YWN0PUZ1bmN0aW9uRWR0JmFtcDtpZD0iJkZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKCJtaXNjIikpLklELCJtLWxlZnQiLEZhbHNlKSkNCg0KDQoJRGltIGksaixzLHQNCglEaW0gYSxiLGMsZCxlLGYNCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iImRpdkhlYWRlciIiPiIgJiBaQ19NU0cwMDcgJiAiPC9kaXY+Ig0KCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIiU3ViTWVudSIiPiIgJiBSZXNwb25zZV9QbHVnaW5fRnVuY3Rpb25NbmdfU3ViTWVudSAmICI8L2Rpdj4iDQoJUmVzcG9uc2UuV3JpdGUgIjxkaXYgaWQ9IiJkaXZNYWluMiIiPiINCgknd2lkZ2V0LWxpc3QgYmVnaW4NCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iIndpZGdldC1sZWZ0IiI+Ig0KCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIid2lkZ2V0LWxpc3QiIj4iDQoNCglSZXNwb25zZS5Xcml0ZSAiPHNjcmlwdCB0eXBlPSIidGV4dC9qYXZhc2NyaXB0IiI+Ig0KCVJlc3BvbnNlLldyaXRlICJ2YXIgZnVuY3Rpb25zID0geyINCgkJRm9yIGk9TEJvdW5kKEZ1bmN0aW9ucykrMSBUbyBVYm91bmQoRnVuY3Rpb25zKQ0KCQkJSWYgSXNPYmplY3QoRnVuY3Rpb25zKGkpKSBUaGVuDQoJCQkJUmVzcG9uc2UuV3JpdGUgIiciJkZ1bmN0aW9ucyhpKS5GaWxlTmFtZSYiJyA6ICciJkZ1bmN0aW9ucyhpKS5Tb3VyY2VUeXBlJiInIg0KCQkJCUlmIGk8PlVib3VuZChGdW5jdGlvbnMpIFRoZW4gUmVzcG9uc2UuV3JpdGUgIiwiDQoJCQlFbmQgSWYNCgkJTmV4dA0KCVJlc3BvbnNlLldyaXRlICJ9OyINCglSZXNwb25zZS5Xcml0ZSAiPC9zY3JpcHQ+Ig0KDQoJUmVzcG9uc2UuV3JpdGUgIjxkaXYgY2xhc3M9IiJ3aWRnZXQtbGlzdC1oZWFkZXIiIj4iICYgWkNfTVNHMjc3ICYgIjwvZGl2PiINCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iIndpZGdldC1saXN0LW5vdGUiIj4iJlpDX01TRzE0NSYiPC9kaXY+IiAmIHZiQ3JsZg0KCUZvciBpPUxCb3VuZChGdW5jdGlvbnMpKzEgVG8gVWJvdW5kKEZ1bmN0aW9ucykNCgkJSWYgSXNPYmplY3QoRnVuY3Rpb25zKGkpKSBUaGVuDQoJCUlmIEZ1bmN0aW9ucyhpKS5Jc1N5c3RlbSBUaGVuDQoJCQlSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iIndpZGdldCB3aWRnZXRfaXNoaWRkZW5fIiZMQ2FzZShGdW5jdGlvbnMoaSkuSXNIaWRkZW4pJiIgd2lkZ2V0X3NvdXJjZV8iJiBGdW5jdGlvbnMoaSkuU291cmNlVHlwZSAmIiB3aWRnZXRfaWRfIiAmIEZ1bmN0aW9ucyhpKS5GaWxlTmFtZSAmICIiIj4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiCTxkaXYgY2xhc3M9IiJ3aWRnZXQtdGl0bGUiIj48aW1nIGNsYXNzPSIibW9yZS1hY3Rpb24iIiB3aWR0aD0iIjE2IiIgc3JjPSIiLi4vaW1hZ2UvYWRtaW4vYnJpY2sucG5nIiIgYWx0PSIiIiIgLz4iJiBUcmFuc2ZlckhUTUwoRnVuY3Rpb25zKGkpLk5hbWUsIltodG1sLWZvcm1hdF0iKQ0KDQoJCQlSZXNwb25zZS5Xcml0ZSAiCTxzcGFuIGNsYXNzPSIid2lkZ2V0LWFjdGlvbiIiPjxhIGhyZWY9IiIuLi9jbWQuYXNwP2FjdD1GdW5jdGlvbkVkdCZhbXA7aWQ9IiZGdW5jdGlvbnMoaSkuSUQmIiIiPjxpbWcgY2xhc3M9IiJlZGl0LWFjdGlvbiIiIHNyYz0iIi4uL2ltYWdlL2FkbWluL2JyaWNrX2VkaXQucG5nIiIgYWx0PSIiIiAmIFpDX01TRzA3OCAmICIiIiB0aXRsZT0iIiIgJiBaQ19NU0cwNzggJiAiIiIgd2lkdGg9IiIxNiIiIC8+PC9hPiINCg0KCQkJUmVzcG9uc2UuV3JpdGUgIgk8L3NwYW4+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIgk8L2Rpdj4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiCTxkaXYgY2xhc3M9IiJmdW5pZCIiIHN0eWxlPSIiZGlzcGxheTpub25lIiI+IiYgRnVuY3Rpb25zKGkpLkZpbGVOYW1lICYiPC9kaXY+IgkNCgkJCVJlc3BvbnNlLldyaXRlICI8L2Rpdj4iDQoJCUVuZCBJZg0KCQlFbmQgSWYNCglOZXh0DQoNCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iIndpZGdldC1saXN0LWhlYWRlciIiPiIgJiBaQ19NU0cyODYgJiAiPC9kaXY+Ig0KCUZvciBpPUxCb3VuZChGdW5jdGlvbnMpKzEgVG8gVWJvdW5kKEZ1bmN0aW9ucykNCgkJSWYgSXNPYmplY3QoRnVuY3Rpb25zKGkpKSBUaGVuDQoJCUlmIEZ1bmN0aW9ucyhpKS5Jc1VzZXJzIFRoZW4NCgkJCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIid2lkZ2V0IHdpZGdldF9pc2hpZGRlbl8iJkxDYXNlKEZ1bmN0aW9ucyhpKS5Jc0hpZGRlbikmIiB3aWRnZXRfc291cmNlXyImIEZ1bmN0aW9ucyhpKS5Tb3VyY2VUeXBlICYiIHdpZGdldF9pZF8iICYgRnVuY3Rpb25zKGkpLkZpbGVOYW1lICYgIiIiPiINCgkJCVJlc3BvbnNlLldyaXRlICIJPGRpdiBjbGFzcz0iIndpZGdldC10aXRsZSIiPjxpbWcgY2xhc3M9IiJtb3JlLWFjdGlvbiIiIHdpZHRoPSIiMTYiIiBzcmM9IiIuLi9pbWFnZS9hZG1pbi9icmljay5wbmciIiBhbHQ9IiIiIiAvPiImIFRyYW5zZmVySFRNTChGdW5jdGlvbnMoaSkuTmFtZSwiW2h0bWwtZm9ybWF0XSIpDQoNCgkJCVJlc3BvbnNlLldyaXRlICIJPHNwYW4gY2xhc3M9IiJ3aWRnZXQtYWN0aW9uIiI+PGEgaHJlZj0iIi4uL2NtZC5hc3A/YWN0PUZ1bmN0aW9uRWR0JmFtcDtpZD0iJkZ1bmN0aW9ucyhpKS5JRCYiIiI+PGltZyBjbGFzcz0iImVkaXQtYWN0aW9uIiIgc3JjPSIiLi4vaW1hZ2UvYWRtaW4vYnJpY2tfZWRpdC5wbmciIiBhbHQ9IiIiICYgWkNfTVNHMDc4ICYgIiIiIHRpdGxlPSIiIiAmIFpDX01TRzA3OCAmICIiIiB3aWR0aD0iIjE2IiIgLz48L2E+Ig0KDQoJCQlSZXNwb25zZS5Xcml0ZSAiJm5ic3A7PGEgb25jbGljaz0ncmV0dXJuIHdpbmRvdy5jb25maXJtKCIiIiYgWkNfTVNHMDU4ICYiIiIpOycgaHJlZj0iIi4uL2NtZC5hc3A/YWN0PUZ1bmN0aW9uRGVsJmFtcDtpZD0iJiBGdW5jdGlvbnMoaSkuSUQgJiIiIj48aW1nIHNyYz0iIi4uL2ltYWdlL2FkbWluL2RlbGV0ZS5wbmciIiBhbHQ9IiIiICYgWkNfTVNHMDYzICYgIiIiIHRpdGxlPSIiIiAmIFpDX01TRzA2MyAmICIiIiB3aWR0aD0iIjE2IiIgLz48L2E+Ig0KDQoJCQlSZXNwb25zZS5Xcml0ZSAiCTwvc3Bhbj4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiCTwvZGl2PiINCgkJCVJlc3BvbnNlLldyaXRlICIJPGRpdiBjbGFzcz0iImZ1bmlkIiIgc3R5bGU9IiJkaXNwbGF5Om5vbmUiIj4iJiBGdW5jdGlvbnMoaSkuRmlsZU5hbWUgJiI8L2Rpdj4iCQ0KCQkJUmVzcG9uc2UuV3JpdGUgIjwvZGl2PiINCgkJRW5kIElmDQoJCUVuZCBJZg0KCU5leHQNCg0KCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIid2lkZ2V0LWxpc3QtaGVhZGVyIiI+IiAmIFpDX01TRzI4NyAmICI8L2Rpdj4iDQoJRm9yIGk9TEJvdW5kKEZ1bmN0aW9ucykrMSBUbyBVYm91bmQoRnVuY3Rpb25zKQ0KCQlJZiBJc09iamVjdChGdW5jdGlvbnMoaSkpIFRoZW4NCgkJSWYgRnVuY3Rpb25zKGkpLklzVGhlbWUgVGhlbg0KCQkJUmVzcG9uc2UuV3JpdGUgIjxkaXYgY2xhc3M9IiJ3aWRnZXQgd2lkZ2V0X2lzaGlkZGVuXyImTENhc2UoRnVuY3Rpb25zKGkpLklzSGlkZGVuKSYiIHdpZGdldF9zb3VyY2VfIiYgRnVuY3Rpb25zKGkpLlNvdXJjZVR5cGUgJiIgd2lkZ2V0X2lkXyIgJiBGdW5jdGlvbnMoaSkuRmlsZU5hbWUgJiAiIiI+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIgk8ZGl2IGNsYXNzPSIid2lkZ2V0LXRpdGxlIiI+PGltZyBjbGFzcz0iIm1vcmUtYWN0aW9uIiIgd2lkdGg9IiIxNiIiIHNyYz0iIi4uL2ltYWdlL2FkbWluL2JyaWNrLnBuZyIiIGFsdD0iIiIiIC8+IiYgVHJhbnNmZXJIVE1MKEZ1bmN0aW9ucyhpKS5OYW1lLCJbaHRtbC1mb3JtYXRdIikNCg0KCQkJUmVzcG9uc2UuV3JpdGUgIgk8c3BhbiBjbGFzcz0iIndpZGdldC1hY3Rpb24iIj48YSBocmVmPSIiLi4vY21kLmFzcD9hY3Q9RnVuY3Rpb25FZHQmYW1wO2lkPSImRnVuY3Rpb25zKGkpLklEJiIiIj48aW1nIGNsYXNzPSIiZWRpdC1hY3Rpb24iIiBzcmM9IiIuLi9pbWFnZS9hZG1pbi9icmlja19lZGl0LnBuZyIiIGFsdD0iIiIgJiBaQ19NU0cwNzggJiAiIiIgdGl0bGU9IiIiICYgWkNfTVNHMDc4ICYgIiIiIHdpZHRoPSIiMTYiIiAvPjwvYT4iDQoNCgkJCSdJZiBGdW5jdGlvbnMoaSkuQXBwTmFtZTw+WkNfQkxPR19USEVNRSBUaGVuDQoJCQkJUmVzcG9uc2UuV3JpdGUgIiZuYnNwOzxhIG9uY2xpY2s9J3JldHVybiB3aW5kb3cuY29uZmlybSgiIiImIFpDX01TRzA1OCAmIiIiKTsnIGhyZWY9IiIuLi9jbWQuYXNwP2FjdD1GdW5jdGlvbkRlbCZhbXA7aWQ9IiYgRnVuY3Rpb25zKGkpLklEICYiIiI+PGltZyBzcmM9IiIuLi9pbWFnZS9hZG1pbi9kZWxldGUucG5nIiIgYWx0PSIiIiAmIFpDX01TRzA2MyAmICIiIiB0aXRsZT0iIiIgJiBaQ19NU0cwNjMgJiAiIiIgd2lkdGg9IiIxNiIiIC8+PC9hPiINCgkJCSdFbmQgSWYNCg0KCQkJUmVzcG9uc2UuV3JpdGUgIgk8L3NwYW4+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIgk8L2Rpdj4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiCTxkaXYgY2xhc3M9IiJmdW5pZCIiIHN0eWxlPSIiZGlzcGxheTpub25lIiI+IiYgRnVuY3Rpb25zKGkpLkZpbGVOYW1lICYiPC9kaXY+IgkNCgkJCVJlc3BvbnNlLldyaXRlICI8L2Rpdj4iDQoJCUVuZCBJZg0KCQlFbmQgSWYNCglOZXh0DQoJUmVzcG9uc2UuV3JpdGUgIjxkaXYgY2xhc3M9IiJ3aWRnZXQtbGlzdC1oZWFkZXIiIj4iICYgWkNfTVNHMjg4ICYgIjwvZGl2PiINCglGb3IgaT1MQm91bmQoRnVuY3Rpb25zKSsxIFRvIFVib3VuZChGdW5jdGlvbnMpDQoJCUlmIElzT2JqZWN0KEZ1bmN0aW9ucyhpKSkgVGhlbg0KCQlJZiBGdW5jdGlvbnMoaSkuSXNQbHVnaW4gVGhlbg0KCQkJUmVzcG9uc2UuV3JpdGUgIjxkaXYgY2xhc3M9IiJ3aWRnZXQgd2lkZ2V0X2lzaGlkZGVuXyImTENhc2UoRnVuY3Rpb25zKGkpLklzSGlkZGVuKSYiIHdpZGdldF9zb3VyY2VfIiYgRnVuY3Rpb25zKGkpLlNvdXJjZVR5cGUgJiIgd2lkZ2V0X2lkXyIgJiBGdW5jdGlvbnMoaSkuRmlsZU5hbWUgJiAiIiI+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIgk8ZGl2IGNsYXNzPSIid2lkZ2V0LXRpdGxlIiI+PGltZyBjbGFzcz0iIm1vcmUtYWN0aW9uIiIgd2lkdGg9IiIxNiIiIHNyYz0iIi4uL2ltYWdlL2FkbWluL2JyaWNrLnBuZyIiIGFsdD0iIiIiIC8+IiYgVHJhbnNmZXJIVE1MKEZ1bmN0aW9ucyhpKS5OYW1lLCJbaHRtbC1mb3JtYXRdIikNCg0KCQkJUmVzcG9uc2UuV3JpdGUgIgk8c3BhbiBjbGFzcz0iIndpZGdldC1hY3Rpb24iIj48YSBocmVmPSIiLi4vY21kLmFzcD9hY3Q9RnVuY3Rpb25FZHQmYW1wO2lkPSImRnVuY3Rpb25zKGkpLklEJiIiIj48aW1nIGNsYXNzPSIiZWRpdC1hY3Rpb24iIiBzcmM9IiIuLi9pbWFnZS9hZG1pbi9icmlja19lZGl0LnBuZyIiIGFsdD0iIiIgJiBaQ19NU0cwNzggJiAiIiIgdGl0bGU9IiIiICYgWkNfTVNHMDc4ICYgIiIiIHdpZHRoPSIiMTYiIiAvPjwvYT4iDQoJCQkNCgkJCUlmIE5vdCBDaGVja1BsdWdpblN0YXRlKEZ1bmN0aW9ucyhpKS5BcHBOYW1lKSBUaGVuDQoJCQkJUmVzcG9uc2UuV3JpdGUgIiZuYnNwOzxhIG9uY2xpY2s9J3JldHVybiB3aW5kb3cuY29uZmlybSgiIiImIFpDX01TRzA1OCAmIiIiKTsnIGhyZWY9IiIuLi9jbWQuYXNwP2FjdD1GdW5jdGlvbkRlbCZhbXA7aWQ9IiYgRnVuY3Rpb25zKGkpLklEICYiIiI+PGltZyBzcmM9IiIuLi9pbWFnZS9hZG1pbi9kZWxldGUucG5nIiIgYWx0PSIiIiAmIFpDX01TRzA2MyAmICIiIiB0aXRsZT0iIiIgJiBaQ19NU0cwNjMgJiAiIiIgd2lkdGg9IiIxNiIiIC8+PC9hPiINCgkJCUVuZCBJZg0KDQoJCQlSZXNwb25zZS5Xcml0ZSAiCTwvc3Bhbj4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiCTwvZGl2PiINCgkJCVJlc3BvbnNlLldyaXRlICIJPGRpdiBjbGFzcz0iImZ1bmlkIiIgc3R5bGU9IiJkaXNwbGF5Om5vbmUiIj4iJiBGdW5jdGlvbnMoaSkuRmlsZU5hbWUgJiI8L2Rpdj4iCQ0KCQkJUmVzcG9uc2UuV3JpdGUgIjwvZGl2PiINCgkJRW5kIElmDQoJCUVuZCBJZg0KCU5leHQNCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iIndpZGdldC1saXN0LWhlYWRlciIiPiIgJiBaQ19NU0cyODkgJiAiPC9kaXY+Ig0KCUZvciBpPUxCb3VuZChGdW5jdGlvbnMpKzEgVG8gVWJvdW5kKEZ1bmN0aW9ucykNCgkJSWYgSXNPYmplY3QoRnVuY3Rpb25zKGkpKSBUaGVuDQoJCUlmIEZ1bmN0aW9ucyhpKS5Jc090aGVyIFRoZW4NCgkJCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIid2lkZ2V0IHdpZGdldF9pc2hpZGRlbl8iJkxDYXNlKEZ1bmN0aW9ucyhpKS5Jc0hpZGRlbikmIiB3aWRnZXRfc291cmNlXyImIEZ1bmN0aW9ucyhpKS5Tb3VyY2VUeXBlICYiIHdpZGdldF9pZF8iICYgRnVuY3Rpb25zKGkpLkZpbGVOYW1lICYgIiIiPiINCgkJCVJlc3BvbnNlLldyaXRlICIJPGRpdiBjbGFzcz0iIndpZGdldC10aXRsZSIiPjxpbWcgY2xhc3M9IiJtb3JlLWFjdGlvbiIiIHdpZHRoPSIiMTYiIiBzcmM9IiIuLi9pbWFnZS9hZG1pbi9icmljay5wbmciIiBhbHQ9IiIiIiAvPiImIFRyYW5zZmVySFRNTChGdW5jdGlvbnMoaSkuTmFtZSwiW2h0bWwtZm9ybWF0XSIpDQoNCgkJCVJlc3BvbnNlLldyaXRlICIJPC9kaXY+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIgk8ZGl2IGNsYXNzPSIiZnVuaWQiIiBzdHlsZT0iImRpc3BsYXk6bm9uZSIiPiImIEZ1bmN0aW9ucyhpKS5GaWxlTmFtZSAmIjwvZGl2PiIJDQoJCQlSZXNwb25zZS5Xcml0ZSAiPC9kaXY+Ig0KCQlFbmQgSWYNCgkJRW5kIElmDQoJTmV4dA0KDQoJUmVzcG9uc2UuV3JpdGUgIjxoci8+PGZvcm0gaWQ9IiJmcm1CYXRjaCIiIG1ldGhvZD0iInBvc3QiIiBhY3Rpb249IiIuLi9jbWQuYXNwP2FjdD1GdW5jdGlvbk1uZyIiIHN0eWxlPSIicG9zaXRpb246IGFic29sdXRlOyIiPiINCglSZXNwb25zZS5Xcml0ZSAiPGlucHV0IHR5cGU9IiJoaWRkZW4iIiBpZD0iImVkdFNpZGViYXIiIiBuYW1lPSIiZWR0U2lkZWJhciIiIHZhbHVlPSIiIiZaQ19TSURFQkFSX09SREVSJiIiIi8+Ig0KCVJlc3BvbnNlLldyaXRlICI8aW5wdXQgdHlwZT0iImhpZGRlbiIiIGlkPSIiZWR0U2lkZWJhcjIiIiBuYW1lPSIiZWR0U2lkZWJhcjIiIiB2YWx1ZT0iIiImWkNfU0lERUJBUl9PUkRFUjImIiIiLz4iDQoJUmVzcG9uc2UuV3JpdGUgIjxpbnB1dCB0eXBlPSIiaGlkZGVuIiIgaWQ9IiJlZHRTaWRlYmFyMyIiIG5hbWU9IiJlZHRTaWRlYmFyMyIiIHZhbHVlPSIiIiZaQ19TSURFQkFSX09SREVSMyYiIiIvPiINCglSZXNwb25zZS5Xcml0ZSAiPGlucHV0IHR5cGU9IiJoaWRkZW4iIiBpZD0iImVkdFNpZGViYXI0IiIgbmFtZT0iImVkdFNpZGViYXI0IiIgdmFsdWU9IiIiJlpDX1NJREVCQVJfT1JERVI0JiIiIi8+Ig0KCVJlc3BvbnNlLldyaXRlICI8aW5wdXQgdHlwZT0iImhpZGRlbiIiIGlkPSIiZWR0U2lkZWJhcjUiIiBuYW1lPSIiZWR0U2lkZWJhcjUiIiB2YWx1ZT0iIiImWkNfU0lERUJBUl9PUkRFUjUmIiIiLz4iDQoNCglSZXNwb25zZS5Xcml0ZSAiPC9mb3JtPiIgJiB2YkNybGYNCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iImNsZWFyIiI+PC9kaXY+PC9kaXY+Ig0KCVJlc3BvbnNlLldyaXRlICI8L2Rpdj4iDQoJJ3dpZGdldC1saXN0IGVuZA0KDQoJJ3NpZGVyYmFyLWxpc3QgYmVnaW4NCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iInNpZGVyYmFyLWxpc3QiIj4iDQoJUmVzcG9uc2UuV3JpdGUgIjxkaXYgY2xhc3M9IiJzaWRlcmJhci1kcm9wIiIgaWQ9IiJzaWRlcmJhciIiPjxkaXYgY2xhc3M9IiJzaWRlcmJhci1oZWFkZXIiIj4iJlpDX01TRzI5MCYiJm5ic3A7PGltZyBjbGFzcz0iInJvbGwiIiBzcmM9IiIuLi9pbWFnZS9hZG1pbi9sb2FkaW5nLmdpZiIiIHdpZHRoPSIiMTYiIiBhbHQ9IiIiIiAvPjxzcGFuIGNsYXNzPSIidWktaWNvbiB1aS1pY29uLXRyaWFuZ2xlLTEtcyIiPjwvc3Bhbj48L2Rpdj48ZGl2ICBjbGFzcz0iInNpZGVyYmFyLXNvcnQtbGlzdCIiID4iDQoJdD1TcGxpdChaQ19TSURFQkFSX09SREVSLCI6IikJDQoJUmVzcG9uc2UuV3JpdGUgIjxkaXYgY2xhc3M9IiJzaWRlcmJhci1ub3RlIiIgPiImUmVwbGFjZShaQ19NU0cyOTUsIiVuIixVQm91bmQodCkrMSkmIjwvZGl2PiINCglGb3IgRWFjaCBzIEluIHQNCgkJSWYgRnVuY3Rpb25NZXRhcy5FeGlzdHMocyk9VHJ1ZSBUaGVuDQoNCgkJCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIid2lkZ2V0IHdpZGdldF9pc2hpZGRlbl8iJkxDYXNlKEZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKHMpKS5Jc0hpZGRlbikmIiB3aWRnZXRfc291cmNlXyImIEZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKHMpKS5Tb3VyY2VUeXBlICYiIHdpZGdldF9pZF8iICYgRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUocykpLkZpbGVOYW1lICYgIiIiPiINCgkJCVJlc3BvbnNlLldyaXRlICIJPGRpdiBjbGFzcz0iIndpZGdldC10aXRsZSIiPjxpbWcgY2xhc3M9IiJtb3JlLWFjdGlvbiIiIHdpZHRoPSIiMTYiIiBzcmM9IiIuLi9pbWFnZS9hZG1pbi9icmljay5wbmciIiBhbHQ9IiIiIiAvPiImIEZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKHMpKS5OYW1lIA0KCQkJUmVzcG9uc2UuV3JpdGUgIgk8L2Rpdj4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiCTxkaXYgY2xhc3M9IiJmdW5pZCIiIHN0eWxlPSIiZGlzcGxheTpub25lIiI+IiYgRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUocykpLkZpbGVOYW1lICYiPC9kaXY+IgkNCgkJCVJlc3BvbnNlLldyaXRlICI8L2Rpdj4iDQoNCgkJRWxzZQ0KDQoJCQlSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iIndpZGdldCB3aWRnZXRfc291cmNlX290aGVyICIgJiBzICYgIiIiPiINCgkJCVJlc3BvbnNlLldyaXRlICIJPGRpdiBjbGFzcz0iIndpZGdldC10aXRsZSIiPjxpbWcgY2xhc3M9IiJtb3JlLWFjdGlvbiIiIHdpZHRoPSIiMTYiIiBzcmM9IiIuLi9pbWFnZS9hZG1pbi9icmljay5wbmciIiBhbHQ9IiIiIiAvPiImIHMNCgkJCVJlc3BvbnNlLldyaXRlICIJPC9kaXY+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIgk8ZGl2IGNsYXNzPSIiZnVuaWQiIiBzdHlsZT0iImRpc3BsYXk6bm9uZSIiPiImIHMgJiI8L2Rpdj4iCQ0KCQkJUmVzcG9uc2UuV3JpdGUgIjwvZGl2PiINCg0KDQoJCUVuZCBJZg0KCU5leHQNCglSZXNwb25zZS5Xcml0ZSAiPC9kaXY+PC9kaXY+Ig0KDQoJUmVzcG9uc2UuV3JpdGUgIjxkaXYgY2xhc3M9IiJzaWRlcmJhci1kcm9wIiIgaWQ9IiJzaWRlcmJhcjIiIj48ZGl2IGNsYXNzPSIic2lkZXJiYXItaGVhZGVyIiI+IiZaQ19NU0cyOTEmIiZuYnNwOzxpbWcgY2xhc3M9IiJyb2xsIiIgc3JjPSIiLi4vaW1hZ2UvYWRtaW4vbG9hZGluZy5naWYiIiB3aWR0aD0iIjE2IiIgYWx0PSIiIiIgLz48c3BhbiBjbGFzcz0iInVpLWljb24gdWktaWNvbi10cmlhbmdsZS0xLXMiIj48L3NwYW4+PC9kaXY+PGRpdiAgY2xhc3M9IiJzaWRlcmJhci1zb3J0LWxpc3QiIiA+Ig0KCXQ9U3BsaXQoWkNfU0lERUJBUl9PUkRFUjIsIjoiKQ0KCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIic2lkZXJiYXItbm90ZSIiID4iJlJlcGxhY2UoWkNfTVNHMjk1LCIlbiIsVUJvdW5kKHQpKzEpJiI8L2Rpdj4iDQoJRm9yIEVhY2ggcyBJbiB0DQoJCUlmIEZ1bmN0aW9uTWV0YXMuRXhpc3RzKHMpPVRydWUgVGhlbg0KDQoJCQlSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iIndpZGdldCB3aWRnZXRfaXNoaWRkZW5fIiZMQ2FzZShGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZShzKSkuSXNIaWRkZW4pJiIgd2lkZ2V0X3NvdXJjZV8iJiBGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZShzKSkuU291cmNlVHlwZSAmIiB3aWRnZXRfaWRfIiAmIEZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKHMpKS5GaWxlTmFtZSAmICIiIj4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiCTxkaXYgY2xhc3M9IiJ3aWRnZXQtdGl0bGUiIj48aW1nIGNsYXNzPSIibW9yZS1hY3Rpb24iIiB3aWR0aD0iIjE2IiIgc3JjPSIiLi4vaW1hZ2UvYWRtaW4vYnJpY2sucG5nIiIgYWx0PSIiIiIgLz4iJiBGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZShzKSkuTmFtZSANCgkJCVJlc3BvbnNlLldyaXRlICIJPC9kaXY+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIgk8ZGl2IGNsYXNzPSIiZnVuaWQiIiBzdHlsZT0iImRpc3BsYXk6bm9uZSIiPiImIEZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKHMpKS5GaWxlTmFtZSAmIjwvZGl2PiIJDQoJCQlSZXNwb25zZS5Xcml0ZSAiPC9kaXY+Ig0KDQoJCUVsc2UNCg0KCQkJUmVzcG9uc2UuV3JpdGUgIjxkaXYgY2xhc3M9IiJ3aWRnZXQgd2lkZ2V0X3NvdXJjZV9vdGhlciAiICYgcyAmICIiIj4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiCTxkaXYgY2xhc3M9IiJ3aWRnZXQtdGl0bGUiIj48aW1nIGNsYXNzPSIibW9yZS1hY3Rpb24iIiB3aWR0aD0iIjE2IiIgc3JjPSIiLi4vaW1hZ2UvYWRtaW4vYnJpY2sucG5nIiIgYWx0PSIiIiIgLz4iJiBzDQoJCQlSZXNwb25zZS5Xcml0ZSAiCTwvZGl2PiINCgkJCVJlc3BvbnNlLldyaXRlICIJPGRpdiBjbGFzcz0iImZ1bmlkIiIgc3R5bGU9IiJkaXNwbGF5Om5vbmUiIj4iJiBzICYiPC9kaXY+IgkNCgkJCVJlc3BvbnNlLldyaXRlICI8L2Rpdj4iDQoNCg0KCQlFbmQgSWYNCglOZXh0DQoJUmVzcG9uc2UuV3JpdGUgIjwvZGl2PjwvZGl2PiINCg0KCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIic2lkZXJiYXItZHJvcCIiIGlkPSIic2lkZXJiYXIzIiI+PGRpdiBjbGFzcz0iInNpZGVyYmFyLWhlYWRlciIiPiImWkNfTVNHMjkyJiImbmJzcDs8aW1nIGNsYXNzPSIicm9sbCIiIHNyYz0iIi4uL2ltYWdlL2FkbWluL2xvYWRpbmcuZ2lmIiIgd2lkdGg9IiIxNiIiIGFsdD0iIiIiIC8+PHNwYW4gY2xhc3M9IiJ1aS1pY29uIHVpLWljb24tdHJpYW5nbGUtMS1zIiI+PC9zcGFuPjwvZGl2PjxkaXYgIGNsYXNzPSIic2lkZXJiYXItc29ydC1saXN0IiIgPiINCgl0PVNwbGl0KFpDX1NJREVCQVJfT1JERVIzLCI6IikNCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iInNpZGVyYmFyLW5vdGUiIiA+IiZSZXBsYWNlKFpDX01TRzI5NSwiJW4iLFVCb3VuZCh0KSsxKSYiPC9kaXY+Ig0KCUZvciBFYWNoIHMgSW4gdA0KCQlJZiBGdW5jdGlvbk1ldGFzLkV4aXN0cyhzKT1UcnVlIFRoZW4NCg0KCQkJUmVzcG9uc2UuV3JpdGUgIjxkaXYgY2xhc3M9IiJ3aWRnZXQgd2lkZ2V0X2lzaGlkZGVuXyImTENhc2UoRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUocykpLklzSGlkZGVuKSYiIHdpZGdldF9zb3VyY2VfIiYgRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUocykpLlNvdXJjZVR5cGUgJiIgd2lkZ2V0X2lkXyIgJiBGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZShzKSkuRmlsZU5hbWUgJiAiIiI+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIgk8ZGl2IGNsYXNzPSIid2lkZ2V0LXRpdGxlIiI+PGltZyBjbGFzcz0iIm1vcmUtYWN0aW9uIiIgd2lkdGg9IiIxNiIiIHNyYz0iIi4uL2ltYWdlL2FkbWluL2JyaWNrLnBuZyIiIGFsdD0iIiIiIC8+IiYgRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUocykpLk5hbWUgDQoJCQlSZXNwb25zZS5Xcml0ZSAiCTwvZGl2PiINCgkJCVJlc3BvbnNlLldyaXRlICIJPGRpdiBjbGFzcz0iImZ1bmlkIiIgc3R5bGU9IiJkaXNwbGF5Om5vbmUiIj4iJiBGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZShzKSkuRmlsZU5hbWUgJiI8L2Rpdj4iCQ0KCQkJUmVzcG9uc2UuV3JpdGUgIjwvZGl2PiINCg0KCQlFbHNlDQoNCgkJCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIid2lkZ2V0IHdpZGdldF9zb3VyY2Vfb3RoZXIgIiAmIHMgJiAiIiI+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIgk8ZGl2IGNsYXNzPSIid2lkZ2V0LXRpdGxlIiI+PGltZyBjbGFzcz0iIm1vcmUtYWN0aW9uIiIgd2lkdGg9IiIxNiIiIHNyYz0iIi4uL2ltYWdlL2FkbWluL2JyaWNrLnBuZyIiIGFsdD0iIiIiIC8+IiYgcw0KCQkJUmVzcG9uc2UuV3JpdGUgIgk8L2Rpdj4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiCTxkaXYgY2xhc3M9IiJmdW5pZCIiIHN0eWxlPSIiZGlzcGxheTpub25lIiI+IiYgcyAmIjwvZGl2PiIJDQoJCQlSZXNwb25zZS5Xcml0ZSAiPC9kaXY+Ig0KDQoNCgkJRW5kIElmDQoJTmV4dA0KCVJlc3BvbnNlLldyaXRlICI8L2Rpdj48L2Rpdj4iDQoNCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iInNpZGVyYmFyLWRyb3AiIiBpZD0iInNpZGVyYmFyNCIiPjxkaXYgY2xhc3M9IiJzaWRlcmJhci1oZWFkZXIiIj4iJlpDX01TRzI5MyYiJm5ic3A7PGltZyBjbGFzcz0iInJvbGwiIiBzcmM9IiIuLi9pbWFnZS9hZG1pbi9sb2FkaW5nLmdpZiIiIHdpZHRoPSIiMTYiIiBhbHQ9IiIiIiAvPjxzcGFuIGNsYXNzPSIidWktaWNvbiB1aS1pY29uLXRyaWFuZ2xlLTEtcyIiPjwvc3Bhbj48L2Rpdj48ZGl2ICBjbGFzcz0iInNpZGVyYmFyLXNvcnQtbGlzdCIiID4iDQoJdD1TcGxpdChaQ19TSURFQkFSX09SREVSNCwiOiIpDQoJUmVzcG9uc2UuV3JpdGUgIjxkaXYgY2xhc3M9IiJzaWRlcmJhci1ub3RlIiIgPiImUmVwbGFjZShaQ19NU0cyOTUsIiVuIixVQm91bmQodCkrMSkmIjwvZGl2PiINCglGb3IgRWFjaCBzIEluIHQNCgkJSWYgRnVuY3Rpb25NZXRhcy5FeGlzdHMocyk9VHJ1ZSBUaGVuDQoNCgkJCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIid2lkZ2V0IHdpZGdldF9pc2hpZGRlbl8iJkxDYXNlKEZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKHMpKS5Jc0hpZGRlbikmIiB3aWRnZXRfc291cmNlXyImIEZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKHMpKS5Tb3VyY2VUeXBlICYiIHdpZGdldF9pZF8iICYgRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUocykpLkZpbGVOYW1lICYgIiIiPiINCgkJCVJlc3BvbnNlLldyaXRlICIJPGRpdiBjbGFzcz0iIndpZGdldC10aXRsZSIiPjxpbWcgY2xhc3M9IiJtb3JlLWFjdGlvbiIiIHdpZHRoPSIiMTYiIiBzcmM9IiIuLi9pbWFnZS9hZG1pbi9icmljay5wbmciIiBhbHQ9IiIiIiAvPiImIEZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKHMpKS5OYW1lIA0KCQkJUmVzcG9uc2UuV3JpdGUgIgk8L2Rpdj4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiCTxkaXYgY2xhc3M9IiJmdW5pZCIiIHN0eWxlPSIiZGlzcGxheTpub25lIiI+IiYgRnVuY3Rpb25zKEZ1bmN0aW9uTWV0YXMuR2V0VmFsdWUocykpLkZpbGVOYW1lICYiPC9kaXY+IgkNCgkJCVJlc3BvbnNlLldyaXRlICI8L2Rpdj4iDQoNCgkJRWxzZQ0KDQoJCQlSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iIndpZGdldCB3aWRnZXRfc291cmNlX290aGVyICIgJiBzICYgIiIiPiINCgkJCVJlc3BvbnNlLldyaXRlICIJPGRpdiBjbGFzcz0iIndpZGdldC10aXRsZSIiPjxpbWcgY2xhc3M9IiJtb3JlLWFjdGlvbiIiIHdpZHRoPSIiMTYiIiBzcmM9IiIuLi9pbWFnZS9hZG1pbi9icmljay5wbmciIiBhbHQ9IiIiIiAvPiImIHMNCgkJCVJlc3BvbnNlLldyaXRlICIJPC9kaXY+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIgk8ZGl2IGNsYXNzPSIiZnVuaWQiIiBzdHlsZT0iImRpc3BsYXk6bm9uZSIiPiImIHMgJiI8L2Rpdj4iCQ0KCQkJUmVzcG9uc2UuV3JpdGUgIjwvZGl2PiINCg0KDQoJCUVuZCBJZg0KCU5leHQNCglSZXNwb25zZS5Xcml0ZSAiPC9kaXY+PC9kaXY+Ig0KDQoJUmVzcG9uc2UuV3JpdGUgIjxkaXYgY2xhc3M9IiJzaWRlcmJhci1kcm9wIiIgaWQ9IiJzaWRlcmJhcjUiIj48ZGl2IGNsYXNzPSIic2lkZXJiYXItaGVhZGVyIiI+IiZaQ19NU0cyOTQmIiZuYnNwOzxpbWcgY2xhc3M9IiJyb2xsIiIgc3JjPSIiLi4vaW1hZ2UvYWRtaW4vbG9hZGluZy5naWYiIiB3aWR0aD0iIjE2IiIgYWx0PSIiIiIgLz48c3BhbiBjbGFzcz0iInVpLWljb24gdWktaWNvbi10cmlhbmdsZS0xLXMiIj48L3NwYW4+PC9kaXY+PGRpdiAgY2xhc3M9IiJzaWRlcmJhci1zb3J0LWxpc3QiIiA+Ig0KCXQ9U3BsaXQoWkNfU0lERUJBUl9PUkRFUjUsIjoiKQ0KCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIic2lkZXJiYXItbm90ZSIiID4iJlJlcGxhY2UoWkNfTVNHMjk1LCIlbiIsVUJvdW5kKHQpKzEpJiI8L2Rpdj4iDQoJRm9yIEVhY2ggcyBJbiB0DQoJCUlmIEZ1bmN0aW9uTWV0YXMuRXhpc3RzKHMpPVRydWUgVGhlbg0KDQoJCQlSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iIndpZGdldCB3aWRnZXRfaXNoaWRkZW5fIiZMQ2FzZShGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZShzKSkuSXNIaWRkZW4pJiIgd2lkZ2V0X3NvdXJjZV8iJiBGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZShzKSkuU291cmNlVHlwZSAmIiB3aWRnZXRfaWRfIiAmIEZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKHMpKS5GaWxlTmFtZSAmICIiIj4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiCTxkaXYgY2xhc3M9IiJ3aWRnZXQtdGl0bGUiIj48aW1nIGNsYXNzPSIibW9yZS1hY3Rpb24iIiB3aWR0aD0iIjE2IiIgc3JjPSIiLi4vaW1hZ2UvYWRtaW4vYnJpY2sucG5nIiIgYWx0PSIiIiIgLz4iJiBGdW5jdGlvbnMoRnVuY3Rpb25NZXRhcy5HZXRWYWx1ZShzKSkuTmFtZSANCgkJCVJlc3BvbnNlLldyaXRlICIJPC9kaXY+Ig0KCQkJUmVzcG9uc2UuV3JpdGUgIgk8ZGl2IGNsYXNzPSIiZnVuaWQiIiBzdHlsZT0iImRpc3BsYXk6bm9uZSIiPiImIEZ1bmN0aW9ucyhGdW5jdGlvbk1ldGFzLkdldFZhbHVlKHMpKS5GaWxlTmFtZSAmIjwvZGl2PiIJDQoJCQlSZXNwb25zZS5Xcml0ZSAiPC9kaXY+Ig0KDQoJCUVsc2UNCg0KCQkJUmVzcG9uc2UuV3JpdGUgIjxkaXYgY2xhc3M9IiJ3aWRnZXQgd2lkZ2V0X3NvdXJjZV9vdGhlciAiICYgcyAmICIiIj4iDQoJCQlSZXNwb25zZS5Xcml0ZSAiCTxkaXYgY2xhc3M9IiJ3aWRnZXQtdGl0bGUiIj48aW1nIGNsYXNzPSIibW9yZS1hY3Rpb24iIiB3aWR0aD0iIjE2IiIgc3JjPSIiLi4vaW1hZ2UvYWRtaW4vYnJpY2sucG5nIiIgYWx0PSIiIiIgLz4iJiBzDQoJCQlSZXNwb25zZS5Xcml0ZSAiCTwvZGl2PiINCgkJCVJlc3BvbnNlLldyaXRlICIJPGRpdiBjbGFzcz0iImZ1bmlkIiIgc3R5bGU9IiJkaXNwbGF5Om5vbmUiIj4iJiBzICYiPC9kaXY+IgkNCgkJCVJlc3BvbnNlLldyaXRlICI8L2Rpdj4iDQoNCg0KCQlFbmQgSWYNCglOZXh0DQoJUmVzcG9uc2UuV3JpdGUgIjwvZGl2PjwvZGl2PiINCg0KCVJlc3BvbnNlLldyaXRlICI8ZGl2IGNsYXNzPSIiY2xlYXIiIj48L2Rpdj48L2Rpdj4iDQoJJ3NpZGVyYmFyLWxpc3QgZW5kDQoNCglSZXNwb25zZS5Xcml0ZSAiPGRpdiBjbGFzcz0iImNsZWFyIiI+PC9kaXY+Ig0KDQoJUmVzcG9uc2UuV3JpdGUgIjwvZGl2PiINCg0KCVJlc3BvbnNlLldyaXRlICI8c2NyaXB0IHR5cGU9IiJ0ZXh0L2phdmFzY3JpcHQiIj5BY3RpdmVMZWZ0TWVudSgiImFGdW5jdGlvbk1uZyIiKTs8L3NjcmlwdD4iDQoNCiU+DQo8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+DQoJJChmdW5jdGlvbigpIHsNCg0KCQlmdW5jdGlvbiBzb3J0RnVuY3Rpb24oKXsNCgkJCXZhciBzMT0iIjsNCgkJCSQoIiNzaWRlcmJhciIpLmZpbmQoImRpdi5mdW5pZCIpLmVhY2goZnVuY3Rpb24oaSl7DQoJCQkgICBzMSArPSAkKHRoaXMpLmh0bWwoKSArIjoiOw0KCQkJIH0pOw0KDQoJCQkgdmFyIHMyPSIiOw0KCQkJJCgiI3NpZGVyYmFyMiIpLmZpbmQoImRpdi5mdW5pZCIpLmVhY2goZnVuY3Rpb24oaSl7DQoJCQkgICBzMiArPSAkKHRoaXMpLmh0bWwoKSArIjoiOw0KCQkJIH0pOw0KDQoJCQkgdmFyIHMzPSIiOw0KCQkJJCgiI3NpZGVyYmFyMyIpLmZpbmQoImRpdi5mdW5pZCIpLmVhY2goZnVuY3Rpb24oaSl7DQoJCQkgICBzMyArPSAkKHRoaXMpLmh0bWwoKSArIjoiOw0KCQkJIH0pOw0KDQoJCQkgdmFyIHM0PSIiOw0KCQkJJCgiI3NpZGVyYmFyNCIpLmZpbmQoImRpdi5mdW5pZCIpLmVhY2goZnVuY3Rpb24oaSl7DQoJCQkgICBzNCArPSAkKHRoaXMpLmh0bWwoKSArIjoiOw0KCQkJIH0pOw0KDQoJCQkgdmFyIHM1PSIiOw0KCQkJJCgiI3NpZGVyYmFyNSIpLmZpbmQoImRpdi5mdW5pZCIpLmVhY2goZnVuY3Rpb24oaSl7DQoJCQkgICBzNSArPSAkKHRoaXMpLmh0bWwoKSArIjoiOw0KCQkJIH0pOw0KDQoJCQkkKCIjZWR0U2lkZWJhciIgKS52YWwoczEpOw0KCQkJJCgiI2VkdFNpZGViYXIyIikudmFsKHMyKTsNCgkJCSQoIiNlZHRTaWRlYmFyMyIpLnZhbChzMyk7DQoJCQkkKCIjZWR0U2lkZWJhcjQiKS52YWwoczQpOw0KCQkJJCgiI2VkdFNpZGViYXI1IikudmFsKHM1KTsNCg0KDQoJCQkkLnBvc3QoJCgiI2ZybUJhdGNoIikuYXR0cigiYWN0aW9uIiksDQoJCQkJew0KCQkJCSJlZHRTaWRlYmFyIjogczEsDQoJCQkJImVkdFNpZGViYXIyIjogczIsDQoJCQkJImVkdFNpZGViYXIzIjogczMsDQoJCQkJImVkdFNpZGViYXI0IjogczQsDQoJCQkJImVkdFNpZGViYXI1IjogczUNCgkJCQl9LA0KCQkJICAgZnVuY3Rpb24oZGF0YSl7DQoJCQkJIC8vYWxlcnQoIkRhdGEgTG9hZGVkOiAiICsgZGF0YSk7DQoJCQkgICB9KTsNCg0KCQl9Ow0KDQoJCXZhciB0Ow0KCQlmdW5jdGlvbiBoaWRlV2lkZ2V0KGl0ZW0pew0KCQkJCWl0ZW0uZmluZCgiLnVpLWljb24iKS5yZW1vdmVDbGFzcygidWktaWNvbi10cmlhbmdsZS0xLXMiKS5hZGRDbGFzcygidWktaWNvbi10cmlhbmdsZS0xLXciKTsNCgkJCQl0PWl0ZW0ubmV4dCgpOw0KCQkJCXQuZmluZCgiLndpZGdldCIpLmhpZGUoImZhc3QiKS5lbmQoKS5zaG93KCk7DQoJCQkJdC5maW5kKCIuc2lkZXJiYXItbm90ZT5zcGFuIikudGV4dCh0LmZpbmQoIi53aWRnZXQiKS5sZW5ndGgpOw0KCQl9DQoJCWZ1bmN0aW9uIHNob3dXaWRnZXQoaXRlbSl7DQoJCQkJaXRlbS5maW5kKCIudWktaWNvbiIpLnJlbW92ZUNsYXNzKCJ1aS1pY29uLXRyaWFuZ2xlLTEtdyIpLmFkZENsYXNzKCJ1aS1pY29uLXRyaWFuZ2xlLTEtcyIpOw0KCQkJCXQ9aXRlbS5uZXh0KCk7DQoJCQkJdC5maW5kKCIud2lkZ2V0Iikuc2hvdygiZmFzdCIpOw0KCQkJCXQuZmluZCgiLnNpZGVyYmFyLW5vdGU+c3BhbiIpLnRleHQodC5maW5kKCIud2lkZ2V0IikubGVuZ3RoKTsNCgkJfQ0KDQoJCSQoIi5zaWRlcmJhci1oZWFkZXIiKS50b2dnbGUoIGZ1bmN0aW9uICgpIHsNCgkJCQloaWRlV2lkZ2V0KCQodGhpcykpOw0KCQkJICB9LA0KCQkJICBmdW5jdGlvbiAoKSB7DQoJCQkJc2hvd1dpZGdldCgkKHRoaXMpKTsNCgkJCSAgfSk7DQoNCiAJCSQoICIuc2lkZXJiYXItc29ydC1saXN0IiApLnNvcnRhYmxlKHsNCiAJCQlpdGVtczonLndpZGdldCcsDQoJCQlzdGFydDpmdW5jdGlvbihldmVudCwgdWkpew0KCQkJCXNob3dXaWRnZXQodWkuaXRlbS5wYXJlbnQoKS5wcmV2KCkpOw0KCQkJCSB2YXIgYz11aS5pdGVtLmZpbmQoIi5mdW5pZCIpLmh0bWwoKTsNCgkJCQkgaWYodWkuaXRlbS5wYXJlbnQoKS5maW5kKCIud2lkZ2V0OmNvbnRhaW5zKCIrYysiKSIpLmxlbmd0aD4xKXsNCgkJCQkJdWkuaXRlbS5yZW1vdmUoKTsNCgkJCQkgfTsNCgkJCX0gLAkJCQ0KCQkJc3RvcDpmdW5jdGlvbihldmVudCwgdWkpeyQodGhpcykucGFyZW50KCkuZmluZCgiLnJvbGwiKS5zaG93KCJzbG93Iik7c29ydEZ1bmN0aW9uKCk7JCh0aGlzKS5wYXJlbnQoKS5maW5kKCIucm9sbCIpLmhpZGUoInNsb3ciKTsNCgkJCQlzaG93V2lkZ2V0KCQodGhpcykucGFyZW50KCkucHJldigpKTsNCgkJCX0NCiAJCX0pLmRpc2FibGVTZWxlY3Rpb24oKTsgDQoNCgkJJCggIi53aWRnZXQtbGlzdD4ud2lkZ2V0IiApLmRyYWdnYWJsZSh7DQogICAgICAgICAgICBjb25uZWN0VG9Tb3J0YWJsZTogIi5zaWRlcmJhci1zb3J0LWxpc3QiLA0KICAgICAgICAgICAgcmV2ZXJ0OiAiaW52YWxpZCIsIA0KICAgICAgICAgICAgY29udGFpbm1lbnQ6ICJkb2N1bWVudCIsDQogICAgICAgICAgICBoZWxwZXI6ICJjbG9uZSIsDQogICAgICAgICAgICBjdXJzb3I6ICJtb3ZlIg0KICAgICAgICB9KS5kaXNhYmxlU2VsZWN0aW9uKCk7DQoNCgkJJCggIi53aWRnZXQtbGlzdCIgKS5kcm9wcGFibGUoew0KCQkJYWNjZXB0OiIuc2lkZXJiYXItc29ydC1saXN0Pi53aWRnZXQiLA0KICAgICAgICAgICAgZHJvcDogZnVuY3Rpb24oIGV2ZW50LCB1aSApIHsNCiAgICAgICAgICAgIAl1aS5kcmFnZ2FibGUucmVtb3ZlKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KDQp9KTsNCg0KPC9zY3JpcHQ+DQo8JQ0KDQoJRXhwb3J0RnVuY3Rpb25MaXN0PVRydWUNCg0KRW5kIEZ1bmN0aW9uDQonKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCiU+</file>
	<file name='zb_system\IMAGE\ADMIN\delete.png' crc32='550ABE3'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAJdSURBVDjLpZP7S1NhGMf9W7YfogSJboSEUVCY8zJ31trcps6zTI9bLGJpjp1hmkGNxVz4Q6ildtXKXzJNbJRaRmrXoeWx8tJOTWptnrNryre5YCYuI3rh+8vL+/m8PA/PkwIg5X+y5mJWrxfOUBXm91QZM6UluUmthntHqplxUml2lciF6wrmdHriI0Wx3xw2hAediLwZRWRkCPzdDswaSvGqkGCfq8VEUsEyPF1O8Qu3O7A09RbRvjuIttsRbT6HHzebsDjcB4/JgFFlNv9MnkmsEszodIIY7Oaut2OJcSF68Qx8dgv8tmqEL1gQaaARtp5A+N4NzB0lMXxon/uxbI8gIYjB9HytGYuusfiPIQcN71kjgnW6VeFOkgh3XcHLvAwMSDPohOADdYQJdF1FtLMZPmslvhZJk2ahkgRvq4HHUoWHRDqTEDDl2mDkfheiDgt8pw340/EocuClCuFvboQzb0cwIZgki4KhzlaE6w0InipbVzBfqoK/qRH94i0rgokSFeO11iBkp8EdV8cfJo0yD75aE2ZNRvSJ0lZKcBXLaUYmQrCzDT6tDN5SyRqYlWeDLZAg0H4JQ+Jt6M3atNLE10VSwQsN4Z6r0CBwqzXesHmV+BeoyAUri8EyMfi2FowXS5dhd7doo2DVII0V5BAjigP89GEVAtda8b2ehodU4rNaAW+dGfzlFkyo89GTlcrHYCLpKD+V7yeeHNzLjkp24Uu1Ed6G8/F8qjqGRzlbl2H2dzjpMg1KdwsHxOlmJ7GTeZC/nesXbeZ6c9OYnuxUc3fmBuFft/Ff8xMd0s65SXIb/gAAAABJRU5ErkJggg==</file>
	<file name='zb_system\IMAGE\COMMON\accessories_32.png' crc32='79CF6366'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAItJREFUeNpiYBgFIx0w4pJgYWc3AFLzgdiAQjsuAHHin58/L2CTZMZheQOQWg7EElTwJMiMDCYWFsZ/f/8ewBsCVPQ10aHBTCNfkxUaIzwXAKPgPz0tBqYDsN1MAx0CLKS6mGiDiQzRoRMCxPqM1JBiGs0FoyXRaBoYLQlHS8LRXDBaEo2CgQYAAQYAWaw3VbZ2wvAAAAAASUVORK5CYII=</file>
	<file name='zb_system\IMAGE\COMMON\article_1.png' crc32='5A3CD889'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAFxJREFUeNpiYKAh+I+G3wOxAakGoPNJNgTdgPn4DCHkZHQ5ipz8H58B/4lw8n9iXcCAwxCiXYDL30S5AJ88nM1CpEGMuExlIUUxNgvIcQEjpS7A64X/DPQGAAEGAA4wMYjNL6EaAAAAAElFTkSuQmCC</file>
	<file name='zb_system\IMAGE\COMMON\article_2.png' crc32='46B7035F'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAACKSURBVHjapJPRDcMwCESPyAt0k2zcFbpBRnI2eP1pK0ICVuqTkGVAuuOMDdAMlqJGiC5pPXdBFlzcO7D6fKXALnIvSdtBSWDwiGyxJkC3JcfeJTEvl1yYSMLyTMYRIHN7wMc4f3rskh6hV61w34rRfmgDD6on1UhBtaFTCmxWQTnC7a/Z/mX+4j0AQjvttrmAAE0AAAAASUVORK5CYII=</file>
	<file name='zb_system\IMAGE\COMMON\article_32.png' crc32='34843753'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJtJREFUeNrslksKwCAMRE3x/lfwqCkIBRdN8zMNrQ64ED95TEawlC29UDBaNkAoxFVAAtiyAcLb8QTQsiBGh0wQ3oC5g+lNOXcuLeUhABoIMwA11wZsOoA25dNbUJQQYQBSiOkt0D7RWwAgNo5r1JwTMPd2VcNFIHBQrCP7d1OFmbBY/h8HwFkDl88ALJ+B774CfAMg3YGtU4ABAD6noEiP1vdIAAAAAElFTkSuQmCC</file>
	<file name='zb_system\IMAGE\COMMON\category_32.png' crc32='AE8FC055'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAG1JREFUeNpiYBgFo2AU4ACs7BwNQPyfAG6g1B5GHJYLAKn3xBjw++cPRkocwITN58RaDlX/nwTcgDcESPE5uYDSEBt+gBFbnNIzCpgGOgRGHTDqgFEHjDpg1AGD0gGNNLSvkWEUjIJRgAYAAgwAgVAkyrt5ox0AAAAASUVORK5CYII=</file>
	<file name='zb_system\IMAGE\COMMON\comments_32.png' crc32='6F7E157A'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAC9UlEQVR42tWWa4hNYRSG1zlHLuOW5K7knkJIcknK7QcpJZeEkAj5gSThj0RyiePXSLmWEUkoEZJLlB9CRERuZYpxaYZhxhzv21qb3Zm99zl7zxdZ9dTpnO/s9e71re9dX0r+caT+NwEtwUAwHPQEnUFjUAlegrvgOngL6lwK6A6WgumgK2gUsi4HqsFVkAUXCwkpJKApWAVWgza+9d/BJ3vTKqtCW9DF/sN1teAsWGHrYgvgw46CMbau2h54CtwE70CNbz1FtLbtmQWmiG7ZczAVPIgjoAM4DwZZ4kNgK3hVcLP+RF+wzYRQxFjwuhgB3N/TYLIlXAiuiO5v3OCzNoL19swZktcTQQIWgX3gBZgEniRI7I8MOCi6LRNEGzRUQAm4DzqB8eBWA5N70c2ey/5ZECVgouje7xHtfpdxCfQA/cHXMAGbwRowBDx0LCBrb99b9AQFCigDo0Ef0fPtMraD5aJGVhEm4CQYJdoDruMcGCrqqt/CBJSC+aAd+OIwOd+aRnRb9GT9PtL5AmaLuh+d64yj5MyxFywDi8H+/B/90RHcA0/BOFHPb2jMs6R0QW7BxygBjE1gg2jX8kTUSLKgCy4BO+zzHHA8qDz50UrUMOjdZVa2ypjJ2WhbRMd3GuwWnaj17DxsGDUD10SHESnGE5qAYVbymaKT8Keoqa0VHc/1ImocHwBzQT/RnmBkrCI8JVVWWt6KeoHBoL2t4ZuWg3XgsERcSlIR39OSR4iaUrkl85wyHSH8PTgCdoE3hcoWJoDlewY+gAGiF42dVl66GBuzxKiwRBw2l8EFE1FUhAmYBk6Idu0dsFLUTG6I7u9n0T7x7JqCaiVBBAlgM/ECMlK0iTJWCVYgK45nRNiFpNTe6JHodeyYaB84jyABvPfzTsiR+ViSG1FiAS1EjYSdzuPDocSmcj2eQwUweM6bmwBvDW8x9PFEzRZXAM88jyKH0Q/Rjs+YIFYi5/tvzoczAQzPbOp8a9O+RH4BfiHOBPyV+AWC2qUhIp2nygAAAABJRU5ErkJggg==</file>
	<file name='zb_system\IMAGE\COMMON\home_32.png' crc32='98F8FA4'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAIdJREFUeNrsljEOwCAMA2nV/3/BT6ULI6VOMMkSSywgcRdAQGuVyl4wWhq8j4ZMeLjEDB4mgQkQURIr0HEJBnBMwjKxXOJvQnz0SSQYODPmkrDA5RIeuFQCTrhnq0yPDAO3HFbZ9Xv8WvbAaYmLEOibBSwZd/aP5hFW5lqp9BUogRKoVF4BBgCdS6FaWR5m5wAAAABJRU5ErkJggg==</file>
	<file name='zb_system\IMAGE\COMMON\link_32.png' crc32='999B7CA1'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAFRJREFUeNpiYBjpgJEEtf+pYAYGYBroEBh1wKgDyAH/8eSI0SgYeg5goVKaILuEHNIh8H/EJ0JGSmvCYZMLRtsDo2lgtCQcLQlHc8HQLglHAUCAAQDv/wdE/7lqWQAAAABJRU5ErkJggg==</file>
	<file name='zb_system\IMAGE\COMMON\new_1.png' crc32='DC47767F'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAEUSURBVHjaxNO9K8VhFAfwzw/dInkZFJNBWSmTsutmY/U/MDFIycBEkf/CYiKLTUrdzJJBNpJblLj0WI7r+t2X5Q5OPS/nPM/5dp7v9zxZSkk71qFN64Isy+7QXxMvYxo9uG2WnFKKiVekmvGMcVxhqiangAPs5wHKOYBHjKKCB0wGwELNnb2UUksOKriPdRBr4W/FeWeVgwZWQDdm4nkruIkKBjCH01Yq9OEEw1jCNcYC6B3H+Pplsp6DCuaxjEVsRny3mQp5gHMUcYadiG23kjEPsBoJP/4GJtCbB+howv4FRoLxIko4CmIblPG3kUrRlbNYx2XEP3LdKqVUlfEJn7F/w2GUPBSJL9GddT8v+/ff+D0AbhB6BgdApJgAAAAASUVORK5CYII=</file>
	<file name='zb_system\IMAGE\COMMON\new_2.png' crc32='8332E39D'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAARxJREFUeNrE0zFrwkAUwPHESkEpaoeCLjoIDl0sdfITFOcOfgzBQQcRnOokovgtutjF0sVNhIJ0LqVD6aYWgwpFbUn/By8Qj5oWHDz45cjL3eXy3sW0bdvYp/mMPZtf+jeEXXELWQTx6rmC+gQs7e02QwpPyMgY5RgdtJ2Y88DSFpgggQ3GuJBx164xLRXzysEG79KfoiL3N/L8SF1MqYKl5WCOS3xiiRJecI4I7vCA7107COEeURTwjKQstEJPTfbawRfyiGOKFKpoovhbFfQkDpBDHw2J1V3VMP6qQlkmOK2GNE70BXw7sj9ETDKewwhdBP5zkEYI4wpVPEp8LfGtHThH+UMSZ0jpbpHGGdZYYKbep2/APPjf+CPAAGxOSTWo3OwnAAAAAElFTkSuQmCC</file>
	<file name='zb_system\IMAGE\COMMON\new_32.png' crc32='5EE1A0CC'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAPhJREFUeNrsltENAiEMhtE4wI3gBt4IjnAj6ESM0JEYgRG4DfBMeoYQwJZr44M0aXKEwv+l9CjGDPt3OyXfsWPNYTsfWAvS2YhET+OBAQsaABQIoMb2ArQ2hsJ60ACobQyVPT6xF8EamjPhdfMnjh9aRbi723xKxEMBSPwIameeiqfVD9JFSBGPnN81Mr2VdqBWfi+AuLj5tTgHYNYQpwJ4jF1wfJcSpwLYTNBJiRtm+sOXK3bSAMjT3xJ3GgC2cN4Bx0smHjUA9vT7TDRtRo54ZbMBfKMDWpzn9Aw2gCWKsgGor+J3X79h2q+Sr+eeZ7mRBBg27CXAACGpOXPR8p7kAAAAAElFTkSuQmCC</file>
	<file name='zb_system\IMAGE\COMMON\page_1.png' crc32='470BAE08'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAGFJREFUeNpiYKAR+I8Fg4ABpQa8J8UQEJiPZsB/fIbgcvJ8JD4GYCHggv1A7IhkATJgJMYFyE6ej0WeKANwGYLhDIJORFPHSCgMsDkTw1AmSlMcxQawkKGHcXB5gWIAEGAACvMuTbd+tEEAAAAASUVORK5CYII=</file>
	<file name='zb_system\IMAGE\COMMON\page_2.png' crc32='4E6461C8'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAB6SURBVHjazFJBDsAgCCuLD/ILe6lP2ZP2hO7iNqJgiO6wJo1RoCmIkMQKNuedBgEgRwU8HJ0IyRELX6CeJ8l85+jkFqiJRd07poDlXc1FQ9oWLAfacjHiIQFPBCQhag9si/YXP/HRDKwNk9U9wOcCaaJG/tuCzAhcAwDv4u5msvut/gAAAABJRU5ErkJggg==</file>
	<file name='zb_system\IMAGE\COMMON\page_32.png' crc32='D4B972A5'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAItJREFUeNrs1kESgCAIBVBpvP8VOCptXWSA8qWZYMad6etraWt/L3L0FcCY7QK+HEcPKMY29udsgCCSGCO2AI4jZolxVNQaAr7WT7ucMwDygvAkuAVYQYQDvAgIwIOAAawIKMCCUE8uTUkLX9X0eeRpaKq++J8IuxekJ1CAAvQDc1AtQQE+Dai6BRgAGlO5Ju8n5pkAAAAASUVORK5CYII=</file>
	<file name='zb_system\IMAGE\COMMON\plugin_32.png' crc32='F93BDEE5'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAA50lEQVR42mNkGGDAOJQdwAfEUUC8EojfD4QDyoC4E4irgLh9IBzwnxrmjDqAHI2yQKwMxPuRxByB+B0QX6K1A+SB+CYQs+OQTwDihdR0QBIQN0B9TSr4CMRLgLgIiH+R4wAzID5BRiihA5AHGslxwH8G6gFGkiVwOICY0CBJ32gIDLkQGHUAXR1AF0CKAwjVfmTVjqMOGHUAKQ5IA+KZQJwOxLPIkKfYASAQAsQbgfg3mfIUOUAciKWB+CkQvyRDnmIHCELxewbsPSFC8hQ7gBOKv0MxqfIUO4AJqh6U2v+RIU+xA2gCADdtPiH08TNPAAAAAElFTkSuQmCC</file>
	<file name='zb_system\IMAGE\COMMON\setting_32.png' crc32='922EFD75'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAONJREFUeNrsV8sNwyAMpVUHyQiMwCZls6iT0E3ICN2AcvABVXxsbAJSY+kdEhPbMn62o9S/y43xbZCwdZ+dgVYAVsBHt40d0rwn7zQ8e9Cl8KDTDRsk5yEx4DJOS3AFG+iUhUGwvRmQAPsahjh/VALYKrp3xCviSM4+I0yHrazoznus1Y+WSL9lFDGpBnyBWlhxhT7R7O0iFEJSmTwLjhFnKQF8ZgyjX2ZgZeMGNqUIl6Lh9EakGuPXgTMDsIjz5FlQo5Kp9H0uheeP4yUXklNXsiWWUsxKnR0u1LX8+jO65CvAAJleI8al+vFRAAAAAElFTkSuQmCC</file>
	<file name='zb_system\IMAGE\COMMON\tags_1.png' crc32='89E4FB6A'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAACdSURBVHjapJNBCsJADEVfvYfgVvB43qJ1U+s9Kwoiot9NFmFIpykTCBMyySPJZDpJNIkD9MAMPOyczVfPNUAPyPTrbAFDBvCy4BtwAibgtwbxgCfwAfZ2dwDea5V4wN2CJuAIXIsKQkjUggpbNcjSEDM6lADMuQUySmLnWjoDl5ZF2lJJ2EIWEg4xC1l8xgykukg1GU3D+XWt3/k/ADmBs+FVZJXvAAAAAElFTkSuQmCC</file>
	<file name='zb_system\IMAGE\COMMON\tags_2.png' crc32='8A471921'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAACiSURBVHjapJNBCgIxDEV/vYfgVvBsrrzF1M043nNEQUT0uUnRKRnNOB9KftPwSdIkAZqDxQdvJPWSzmZ7830HIKDhjQdDZItxTyFXCz4CG6ADnhGRQi7AHVjafQXcIpkUcrKgDlgDhyqDUZG6BCrOLxGviRHkWkDmnIIWGMzBTtJ+8iQ5nc3/lhAVcZsYFRn9xoiIO0gpsI2t2a33mOau82sANUB3GTzy44UAAAAASUVORK5CYII=</file>
	<file name='zb_system\IMAGE\COMMON\tag_32.png' crc32='E7B78C4B'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ5JREFUeNrsltENgCAMRIkTOQKj6GTnBqzmBsiHX6Si1DYXok3uC8I9KJSG8IccKMo3AtPcDaLH3BxCY24KIS2ciuKp5A0hmdfhClEvFoU50TodU2NsV25k0Z6ERQpepaN1CedOcxVEdhLYAI8h8EN8EuKqEK1F2yiNifvPCaa5JQSY6aB2TdS+kdo5g/lEwawTYBYrMCsmzXzsOAQYALVTiXroQzwfAAAAAElFTkSuQmCC</file>
	<file name='zb_system\IMAGE\COMMON\themes_1.png' crc32='94EAEAAD'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAE1JREFUeNpiYKAQMELp/xTqJ8sAsB4WbIKk2MxEaRhQbAALLqeRa8B/NMP+EwoDFhyS//G46j9Vw2DwxQK2xPSf6GRJaVL+zzAQACDAAM6KDR7FGHBBAAAAAElFTkSuQmCC</file>
	<file name='zb_system\IMAGE\COMMON\themes_2.png' crc32='6B06C584'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAABcSURBVHjazJLBCgAhCEQ1/P9ffnuJJaJadPaQl5BofM7kgCkV/ayqeIxN8jEjgSVJ3mHNxJIFYodWFWAS48uD2FxyoOJXD+5LYfWZUGL0DAHKCl714AEAAP//AwBQdg0ynJflxgAAAABJRU5ErkJggg==</file>
	<file name='zb_system\IMAGE\COMMON\themes_32.png' crc32='B1E92421'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAGRJREFUeNrslsEKACAIQzP8/19e14LACsLS7eTN8ZjDUrJLuhkeu6s3ATWo3NBA+kkCtzIxJetOgAZoQHdTm4oADDII0QO64RyHWQHPkAZo4NsmXP2MEJaA1XASNgNIdQVUE2AACEcKSEaLLiIAAAAASUVORK5CYII=</file>
	<file name='zb_system\IMAGE\COMMON\user_32.png' crc32='A7C4D9C9'  dt:dt='bin.base64'>iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABEUlEQVR42mNkGGDAOJQdoAHENUBsC8Q3gTgPiG/Q0wFLgDgaib8UiGPo6YCHQCyHxL8JDRW6OWATEPsOZAjA0oALEO8B4hYGOqcBEFBGYt8lxwByHXAEiK3RxP4D8TwgzgHiH7RyAAsQH8BiOTLoAuJyWjmgDIg7CagBhUQWEM+gtgO4gPgZEPMTofYMEJvSIgT+E6nuNxCzDaQDiDabVg4A5QJOWjjgMRDLEKFuBRBH0sIBxIYC0eYOSQfcB2IFPPIXgNiQlg4AgX949JJkJrkO+I9mBjp/1AGjDhj+DoA1PkEWL8XCp7kD9JEsvISFT3MHKCBZ+BALn+YOEESy8AMWPs0dwIxk4T8sfJo7gGoAALmPRCFD7TXwAAAAAElFTkSuQmCC</file>
	<file name='zb_users\LANGUAGE\SimpChinese.asp' crc32='E649180E'  dt:dt='bin.base64'>PCUNCic8bGFuZ3VhZ2U+566A5YyW5a2XPC9sYW5ndWFnZT4NCidUaGUgc2Vjb25kIGxpbmUgb2YgdGhpcyBmaWxlIGlzIHRoZSBuYW1lIG9mIHRoZSBsYW5ndWFnZQ0KDQoNCidUaGUgZGVmYXVsdCBsYW5ndWFnZSBvZiB1RWRpdG9yDQonVGhlIGxhbmd1YWdlIGZpbGVzIHdpbGwgYmUgbG9hZGVkIGZyb20gdWUtbGFuZ1xaQ19FRElUT1JMQU5HIGJ5IGVkaXRvci4NCkRpbSBaQ19FRElUT1JMQU5HDQpaQ19FRElUT1JMQU5HPSJ6aC1jbiINCg0KJ0N1c3RvbSBJbmZvcm1hdGlvbg0KJ0Rvbid0IGRlbGV0ZSAlcyBhbmQgKCkNClpDX01TRzAwMT0i5ZCN56ewIg0KWkNfTVNHMDAyPSLlr4bnoIEiDQpaQ19NU0cwMDM9IueUqOaIt+WQjSINClpDX01TRzAwND0i5L+d5a2YIg0KWkNfTVNHMDA1PSLlvZPliY3nlKjmiLciDQpaQ19NU0cwMDY9IuWumOaWuee9keermSINClpDX01TRzAwNz0i5qih5Z2X566h55CGIg0KWkNfTVNHMDA4PSLkvqfmoI8iDQpaQ19NU0cwMDk9IueUqOaIt+eZu+W9lSINClpDX01TRzAxMD0i55So5oi35ZCNLOWvhueggeS4jeiDveS4uuepuiINClpDX01TRzAxMT0i5Y+R5biDIg0KWkNfTVNHMDEyPSLliIbnsbsiDQpaQ19NU0cwMTM9IuivhOiuuiINClpDX01TRzAxND0i5byV55SoIg0KWkNfTVNHMDE1PSLmn6XnnIsiDQpaQ19NU0cwMTY9IuaRmOimgSINClpDX01TRzAxNz0i5pi+56S6Ig0KWkNfTVNHMDE4PSLmnaXlrr4iDQpaQ19NU0cwMTk9Iui2hee6p+euoeeQhiVz55m75b2VJXPpqozor4Houqvku70lc+azqOmUgCVz5ZCO5Y+w566h55CGJXPlj5Hooajor4Torrolc+afpeeci+adg+mZkCVz5p+l55yLUlNT6L6T5Ye6JXPmibnph4/mk43kvZwlc+e0ouW8lemHjeW7uiVz5paH56ug6YeN5bu6JXPnrqHnkIbmlofnq6Alc+e8lui+keaWh+eroCVz5Y+R5biD5paH56ugJXPliKDpmaTmlofnq6Alc+euoeeQhuWIhuexuyVz5L+u5pS55YiG57G7JXPliKDpmaTliIbnsbslc+euoeeQhuivhOiuuiVz5Yig6Zmk6K+E6K66JXPnrqHnkIbnlKjmiLclc+e8lui+keeUqOaItyVz5Yib5bu655So5oi3JXPkv67mlLnnlKjmiLclc+WIoOmZpOeUqOaItyVz6ZmE5Lu2566h55CGJXPpmYTku7bkuIrkvKAlc+mZhOS7tuWIoOmZpCVz56uZ5YaF5pCc57SiJXNUYWfnrqHnkIYlc1RhZ+e8lui+kSVzVGFn5L+d5a2YJXNUYWfliKDpmaQlc+e9keermeiuvue9riVz572R56uZ6K6+572u5L+d5a2YJXPmj5Lku7bnrqHnkIYlc+S+p+agj+aooeWdl+euoeeQhiVz5omA5pyJ5paH5Lu2566h55CGJXPmiYDmnInor4TorrrnrqHnkIYlc+aJgOaciemZhOS7tueuoeeQhiVzIiANClpDX01TRzAyMD0i6YCA5Ye655m75b2VIg0KWkNfTVNHMDIxPSLmn6XnnIvmnYPpmZAiDQpaQ19NU0cwMjI9IueuoeeQhiINClpDX01TRzAyMz0i5oKo5aW9LCVzIg0KWkNfTVNHMDI0PSLlj5HooajnlZnoqIAiDQpaQ19NU0cwMjU9IuaOp+WItumdouadvyInQ29udHJvbFBhbmVsDQpaQ19NU0cwMjY9Iue9keermeWIhuexuyInQ2F0ZWdvcmllcw0KWkNfTVNHMDI3PSLmnIDmlrDnlZnoqIAiJ0NvbW1lbnRzDQpaQ19NU0cwMjg9IuaWh+eroOW9kuahoyInQXJjaGl2ZXMNClpDX01TRzAyOT0i56uZ54K557uf6K6hIidCbG9nIFN0YXRpc3RpY3MNClpDX01TRzAzMD0i572R56uZ5pS26JePIidGYXZvcml0ZXMNClpDX01TRzAzMT0i5Y+L5oOF6ZO+5o6lIidMaW5rYWdlDQpaQ19NU0cwMzI9IuacgOi/keWPkeihqCInUHJldmlvdXMNClpDX01TRzAzMz0i5ZCN56ew5LiN6IO95Li656m6Ig0KWkNfTVNHMDM0PSLlkI3np7DmiJbpgq7nrrEs572R5Z2A5qC85byP5LiN5a+5Ig0KWkNfTVNHMDM1PSLnlZnoqIDkuI3og73kuLrnqbrmiJbov4fplb8iDQpaQ19NU0cwMzY9IiVzIg0KWkNfTVNHMDM3PSJVQkLmoIfnrb4iDQpaQ19NU0cwMzg9IuWvhueggeS4jeiDveWwj+S6jjjkvY0iDQpaQ19NU0cwMzk9IuWbvuagh+axh+mbhiInTWlzYw0KWkNfTVNHMDQwPSLil47mrKLov47lj4LkuI7orqjorrrvvIzor7flnKjov5nph4zlj5HooajmgqjnmoTnnIvms5XjgIHkuqTmtYHmgqjnmoTop4LngrnjgIIiDQpaQ19NU0cwNDE9IuWkp+WwjyINClpDX01TRzA0Mj0i5YiG6aG1Ig0KWkNfTVNHMDQzPSLnp4Hkurrmlofnq6DvvIznmbvlvZXnirbmgIHkuIvmlrnlj6/mn6XnnIvjgIIiDQpaQ19NU0cwNDQ9Ii0iDQpaQ19NU0cwNDU9IumUmeivr+aPkOekuiINClpDX01TRzA0Nj0i5Yqg5YWl5a+86Iiq5qCP6I+c5Y2VIg0KWkNfTVNHMDQ3PSLmlofnq6DnvJbovpEiDQpaQ19NU0cwNDg9IuaWh+eroCINClpDX01TRzA0OT0i6K6w5L2P5oiRLOS4i+asoeWbnuWkjeaXtuS4jeeUqOmHjeaWsOi+k+WFpeS4quS6uuS/oeaBryINClpDX01TRzA1MD0i5pel5Y6GIidDYWxlbmRhcg0KWkNfTVNHMDUxPSLnva7pobYiDQpaQ19NU0cwNTI9IuWvvOiIquagj+iPnOWNlSInTmF2aWdhdGlvbg0KWkNfTVNHMDUzPSLpgq7nrrEiDQpaQ19NU0cwNTQ9Iue9keermemTvuaOpSINClpDX01TRzA1NT0i5q2j5paHIg0KWkNfTVNHMDU2PSLnlZnoqIDmnIDplb/lrZfmlbAiDQpaQ19NU0cwNTc9IuaYvuekulVCQuihqOaDhT4+Ig0KWkNfTVNHMDU4PSLljZXlh7vigJznoa7lrprigJ3nu6fnu63jgILljZXlh7vigJzlj5bmtojigJ3lgZzmraLjgIIiDQpaQ19NU0cwNTk9IuacquWIhuexuyINClpDX01TRzA2MD0i5qCH6aKYIg0KWkNfTVNHMDYxPSLnsbvlnosiDQpaQ19NU0cwNjI9IuaXpeacnyINClpDX01TRzA2Mz0i5Yig6ZmkIg0KWkNfTVNHMDY0PSLkvKDpgIHlvJXnlKgiDQpaQ19NU0cwNjU9Iui/lOWbnue9keermSINClpDX01TRzA2Nj0i5YiG57G7566h55CGIg0KWkNfTVNHMDY3PSLmlofnq6DnrqHnkIYiDQpaQ19NU0cwNjg9IuivhOiuuueuoeeQhiINClpDX01TRzA2OT0i5byV55So566h55CGIg0KWkNfTVNHMDcwPSLnlKjmiLfnrqHnkIYiDQpaQ19NU0cwNzE9IumZhOS7tueuoeeQhiINClpDX01TRzA3Mj0i57Si5byV6YeN5bu6Ig0KWkNfTVNHMDczPSLmlofku7bph43lu7oiDQpaQ19NU0cwNzQ9IuS4jeaMh+Wumue7meS+p+agjyINClpDX01TRzA3NT0i5pe26Ze0Ig0KWkNfTVNHMDc2PSJJRCINClpDX01TRzA3Nz0i5paw5bu65YiG57G7Ig0KWkNfTVNHMDc4PSLnvJbovpEiDQpaQ19NU0cwNzk9IuaOkuW6jyINClpDX01TRzA4MD0iSVAiDQpaQ19NU0cwODE9IlVSTCINClpDX01TRzA4Mj0i5paH56ug5oC75pWwIg0KWkNfTVNHMDgzPSLlvZPliY3moLflvI8iDQpaQ19NU0cwODQ9IuW9k+WJjeivreiogCINClpDX01TRzA4NT0iU2VhcmNoIifmkJzntKINClpDX01TRzA4Nj0i5pCc57SiJXPvvIzlhbHmib7liLAlc+S4que7k+aenCINClpDX01TRzA4Nz0i5o+Q5LqkIg0KWkNfTVNHMDg4PSLph43nva4iDQpaQ19NU0cwODk9IumqjOivgSINClpDX01TRzA5MD0i5YaF5a65Ig0KWkNfTVNHMDkxPSLpgJrov4flrqHmoLgiDQpaQ19NU0cwOTI9IuWKoOWFpeWuoeaguCINClpDX01TRzA5Mz0i572R56uZ55qE5qCH6aKYIg0KWkNfTVNHMDk0PSLnvZHnq5nnmoTlrZDmoIfpopgiDQpaQ19NU0cwOTU9IuWbnuWkjeivhOiuuklEIg0KWkNfTVNHMDk2PSJCTE9H54mI5p2D6K+05piOKOWPr+S7peaUvue9ruWkh+ahiOWPt+WSjOe7n+iuoeS7o+eggSzmlK/mjIFIVE1M5Luj56CBLOWPr+eUqCcmbHQ7YnIvJmd0OyfmoIfnrb7mjaLooYwpIg0KWkNfTVNHMDk3PSLmraPluLjor4TorrrnrqHnkIYiDQpaQ19NU0cwOTg9IumUmeivr+WOn+WboCINClpDX01TRzA5OT0i5pyq5ZG95ZCN5paH56ugIg0KWkNfTVNHMTAwPSLlj6/op4bnvJbovpEiDQpaQ19NU0cxMDE9IlVCQue8lui+kSINClpDX01TRzEwMj0i5qOA5rWL5YiwJXPlpIfku73nmoTmlbDmja7ov5jmnKrkvb/nlKghIg0KWkNfTVNHMTAzPSLmkq3mlL4v6ZqQ6JePIOWqkuS9kyINClpDX01TRzEwND0i5b6F5a6h5qC46K+E6K66566h55CGIg0KWkNfTVNHMTA1PSLln7rnoYDorr7nva4iDQpaQ19NU0cxMDY9IumrmOe6p+iuvue9riINClpDX01TRzEwNz0i5o+S5Lu2566h55CGIg0KWkNfTVNHMTA4PSLkuIrkvKDlm77niYfjgIHlvbHpn7Plj4rlhbblroPnsbvlnovnmoTmlofku7YiDQpaQ19NU0cxMDk9IiDmk43kvZzmraPlnKjov5vooYzkuK0s6K+356iN5YCZLi4uIg0KWkNfTVNHMTEwPSLmibnph4/mk43kvZwiDQpaQ19NU0cxMTE9IumhtemdoueuoeeQhiINClpDX01TRzExMj0i5aaC5p6c5L2g5pu05o2i5LqG5Li76aKY5qih5p2/5oiW5L+u5pS55LqG5p+Q5Lqb5b+F6ZyA5paH5Lu26YeN5bu65omN6IO955Sf5pWI55qE572R56uZ6K6+572uLOivt+S9v+eUqCfmlofku7bph43lu7on5Yqf6IO9Ljxici8+PGJyLz7ph43lu7rmiYDmnInml6Xlv5flj6/og73pnIDopoHlvojplb/ml7bpl7Qs6K+354K55Ye7J+aPkOS6pCfmjInpkq7miafooYwuIg0KWkNfTVNHMTEzPSLmlrDlu7rpobXpnaIiDQpaQ19NU0cxMTQ9IuS/neWtmOaIkeeahOeZu+W9leS/oeaBryINClpDX01TRzExNT0i5YiG57G75LiN6IO95Li656m6Ig0KWkNfTVNHMTE2PSLmraPmlofkuI3og73kuLrnqboiDQpaQ19NU0cxMTc9IuaVsOaNruiOt+WPluS4rSINClpDX01TRzExOD0i5ZCN56ew5LiN6IO95Li656m6Ig0KWkNfTVNHMTE5PSLlr4bnoIHkuI3og73kuLrnqboiDQpaQ19NU0cxMjA9IumCrueuseS4jeiDveS4uuepuiINClpDX01TRzEyMT0i5re75Yqg5paw5pel5b+XIg0KWkNfTVNHMTIyPSLmt7vliqDmlrDliIbnsbsiDQpaQ19NU0cxMjM9Iua3u+WKoOaWsOeUqOaItyINClpDX01TRzEyND0i6K+E6K665oC75pWwIg0KWkNfTVNHMTI1PSLpobXpnaLmgLvmlbAiDQpaQ19NU0cxMjY9Iue9keermeWcsOWdgCjpu5jorqToh6rliqjor7vlj5blvZPliY3nvZHlnYAs5aaC5p6c57O757uf55qE6K+G5Yir5Yqf6IO95Ye6546w6Zeu6aKYLOaIluaYr+mcgOimgeWbuuWMlue9keermeWfn+WQjSzor7fngrnplIHlrprmjInpkq7lkI7ovpPlhaXnvZHlnYDlubbmj5DkuqTkv53lrZguKSINClpDX01TRzEyNz0i5paw5bu655So5oi3Ig0KWkNfTVNHMTI4PSLkvZzogIUiJ0F1dGhvcnMNClpDX01TRzEyOT0i5rWP6KeI5oC75pWwIg0KWkNfTVNHMTMwPSLmtY/op4giDQpaQ19NU0cxMzE9IuiHquWKqOWRveWQjeS4iuS8oOaWh+S7tiINClpDX01TRzEzMj0i6aaW6aG15Y+K5YiG57G76aG157+76aG15p2h5pWw6YePIg0KWkNfTVNHMTMzPSLmsqHmnInlpIfku73lhoXlrrkiDQpaQ19NU0cxMzQ9Iua3u+WKoFRhZ3MiDQpaQ19NU0cxMzU9IuaWsOW7uuWFs+mUruWtlyINClpDX01TRzEzNj0i5paw5bu6VGFncyINClpDX01TRzEzNz0iSUTlgLzmmK9odG1s6aG16Z2i5ZSv5LiA55qELOivt+S4jeimgeS4juWFtuWug+aooeWdl+eahElE6YeN5aSNLOW7uuiuruS7pWZu5oiWZGl25Li65YmN57yA5Yqg5paH5Lu25ZCNLiINClpDX01TRzEzOD0iVGFncyINClpDX01TRzEzOT0i5pi+56S65bi455SoVGFncyINClpDX01TRzE0MD0i5Li6MOWImeS4jemZkOWItkxJ55qE6L6T5Ye66aG55pWwIg0KWkNfTVNHMTQxPSJUYWdz566h55CGIg0KWkNfTVNHMTQyPSLmlrDlu7rmqKHlnZciDQpaQ19NU0cxNDM9IlVM5YaFTEnnmoTmnIDlpKfooYzmlbAiDQpaQ19NU0cxNDQ9IuaooeWdl+e8lui+kSINClpDX01TRzE0NT0i6K+35ouW5Yqo6ZyA6KaB55qE5qih5Z2X5Yiw5Y+z5L6n5Yy65Z+f5oyH5a6a5L6n5qCP44CC5L6n5qCP5Lit55qE5qih5Z2X5Y+v5o6S5bqP77yM5Lmf5Y+v5ouW6Iez5bem5L6n5Yy65Z+f56e76Zmk44CCIg0KWkNfTVNHMTQ2PSLCqyDkuIrkuIDnr4ciDQpaQ19NU0cxNDc9IuWIq+WQjSINClpDX01TRzE0OD0i5LiL5LiA56+HIMK7Ig0KWkNfTVNHMTQ5PSLlm57lpI0iDQpaQ19NU0cxNTA9IuW9k+WJjeeJiOacrCINClpDX01TRzE1MT0i5pyA5ZCO5pu05pawIg0KWkNfTVNHMTUyPSLlm57lpI1JRCINClpDX01TRzE1Mz0i5byV6IeqIg0KWkNfTVNHMTU0PSLmnIDov5HlvJXnlKgiDQpaQ19NU0cxNTU9IuabtOaXqeeahOaWh+eroCDCuyINClpDX01TRzE1Nj0iwqsg5LmL5ZCO55qE5paH56ugIg0KWkNfTVNHMTU3PSLku7vmhI8iDQpaQ19NU0cxNTg9IuaQnOe0ouaWh+eroCINClpDX01TRzE1OT0i5L+h5oGv5pGY6KaBIg0KWkNfTVNHMTYwPSLpobXpnaIiDQpaQ19NU0cxNjE9Iumhtemdoue8lui+kSINClpDX01TRzE2Mj0i5YiG57G75oC75pWwIg0KWkNfTVNHMTYzPSJUYWdz5oC75pWwIg0KWkNfTVNHMTY0PSLmnIDmlrDliqjmgIHkv6Hmga8iDQpaQ19NU0cxNjU9Iuato+WcqOiOt+WPluS4re+8jOivt+eojeWAmeOAgiINClpDX01TRzE2Nj0i55So5oi35oC75pWwIg0KWkNfTVNHMTY3PSLnq5nlhoXnu5/orqHmkZjopoEiDQpaQ19NU0cxNjg9IuaWsOW7uuaWh+eroCINClpDX01TRzE2OT0i5oC76K6h6ICX5pe2JW7np5IiDQpaQ19NU0cxNzA9IuaWh+S7tuWQjSINClpDX01TRzE3MT0i5pel5b+X6aG16Z2i5pi+56S66K+E6K6655qE5pWw6YePKOiuvuS4ujDliJnor4TorrrkuI3liIbpobUs5YWo6YOo6L6T5Ye65Zyo5ZCM5LiA6aG1LikiDQpaQ19NU0cxNzI9IuWkh+S7veS4juabtOaWsCINClpDX01TRzE3Mz0i5YWo5bGA6K6+572uIg0KWkNfTVNHMTc0PSLmiYDpgInpobnnm67pgJrov4flrqHmoLgiDQpaQ19NU0cxNzU9IkJMT0fnlKjmiLfmiYDlnKjnmoTml7bljLoiDQpaQ19NU0cxNzY9IkJMT0cg6aG16Z2i6K+t6KiAIg0KWkNfTVNHMTc3PSLmiYDpgInpobnnm67liqDlhaXlrqHmoLgiDQpaQ19NU0cxNzg9IuaWh+eroOWtmOaUvuebruW9lSINClpDX01TRzE3OT0i5q2k55uu5b2V5LiL5paH56ug55qE6buY6K6k5qih5p2/Ig0KWkNfTVNHMTgwPSLml6AiDQpaQ19NU0cxODE9IuWNleasoemHjeW7uuaWh+S7tuaVsOebriINClpDX01TRzE4Mj0i5Y2V5qyh6YeN5bu65paH5Lu25ZCO55qE6Ze06ZqU56eS5pWwIg0KWkNfTVNHMTgzPSLlhYHorrjkuIrkvKDmlofku7bnmoTnsbvlnoso5LulfOWBmuS4uuWIhumalCkiDQpaQ19NU0cxODQ9IuS4iuS8oOaWh+S7tueahOacgOWkp+Wtl+iKguaVsCINClpDX01TRzE4NT0i5Y+R6KGo6K+E6K665pe25ZCv55So6aqM6K+B56CBIg0KWkNfTVNHMTg2PSLpobXpnaLorr7nva4iDQpaQ19NU0cxODc9Ium7mOiupOaooeadvyINClpDX01TRzE4OD0i5qih5p2/Ig0KWkNfTVNHMTg5PSIg5o+Q56S6OuWIoOmZpOeUqOaIt+S8muWwhuivpeeUqOaIt+aJgOacieeahOaWh+eroOWSjOivhOiuuuWPiumZhOS7tuWFqOmDqOWIoOmZpOOAgiINClpDX01TRzE5MD0i6aaW6aG15Y+K5YiG57G76aG15pi+56S65paH56ug55qE5pWw6YePIg0KWkNfTVNHMTkxPSLnrqHnkIbpobXmmL7npLrorrDlvZXnmoTmlbDph48iDQpaQ19NU0cxOTI9IsKrIOS4iuS4gOmhteivhOiuuiINClpDX01TRzE5Mz0i5LiL5LiA6aG16K+E6K66IMK7Ig0KWkNfTVNHMTk0PSLnv7vpobXmnaHnmoTmnaHnm67mlbDph48iDQpaQ19NU0cxOTU9IueItuWIhuexuyINClpDX01TRzE5Nj0i5qC35byPIg0KWkNfTVNHMTk3PSLljp/kvZwiDQpaQ19NU0cxOTg9IueugOS7iyINClpDX01TRzE5OT0i5Li76aKY6Ieq5bim5o+S5Lu2Ig0KWkNfTVNHMjAwPSLmiYvliqjnlJ/miJDmkZjopoEiDQpaQ19NU0cyMDE9IueKtuaAgSINClpDX01TRzIwMj0i5ZCv55SoIg0KWkNfTVNHMjAzPSLlgZznlKgiDQpaQ19NU0cyMDQ9IuW9k+WJjeS4u+mimCINClpDX01TRzIwNT0iIg0KWkNfTVNHMjA2PSLkuLvmnLrmnI3liqHlmajmiYDlnKjnmoTml7bljLoiDQpaQ19NU0cyMDc9Iui/lOWbnua6kOWcsOWdgCINClpDX01TRzIwOD0i6YCX5Y+35YiG5YmyIg0KWkNfTVNHMjA5PSLlkK/nlKjljZXml6Xlv5fpobXpnaLliY3lkI7mlofnq6Dlr7zoiKoiDQpaQ19NU0cyMTA9IuaWh+S7tueuoeeQhiINClpDX01TRzIxMT0i55WZ6KiA5YiX6KGoIg0KWkNfTVNHMjEyPSLmn6XnnIvor4TorroiDQpaQ19NU0cyMTM9IummlumhtSINClpDX01TRzIxND0i5YiG57G75p+l55yLIg0KWkNfTVNHMjE1PSLor4Torrrorr7nva4iDQpaQ19NU0cyMTY9IuWcqOato+aWh+aPkuWFpeWIhumalOespiZxdW90OyZsdDtociBjbGFzcz0mcXVvdDttb3JlJnF1b3Q7IC8mZ3Q7JnF1b3Q75Y+v5Lul6K6p57O757uf6K+G5Yir5pGY6KaB5YaF5a6544CC5aaC6ZyA5Y+m5aSW5oyH5a6a5pGY6KaB5YaF5a6577yM6K+354K55Ye7ICINClpDX01TRzIxNz0iIg0KWkNfTVNHMjE4PSIiDQpaQ19NU0cyMTk9IiINClpDX01TRzIyMD0iIg0KWkNfTVNHMjIxPSIiDQpaQ19NU0cyMjI9IuWIoOmZpOWFqOmDqOacquWuoeaguOivhOiuuiINClpDX01TRzIyMz0i5Li76aKY566h55CGIg0KWkNfTVNHMjI0PSLopoHmn6Xor6LnmoTlhoXlrrkiDQpaQ19NU0cyMjU9IuabtOaWsCINClpDX01TRzIyNj0i5ZCv55SoUlNT55qE5YWo5paH6L6T5Ye6Ig0KWkNfTVNHMjI3PSLmibnph4/mk43kvZzlt7LlrozmiJAuIg0KWkNfTVNHMjI4PSLliKDpmaTmiYDpgInpobnnm64iDQpaQ19NU0cyMjk9IuWFqOmAiSINClpDX01TRzIzMD0i5pel5b+X6aG16Z2i55u45YWz5paH56ug55qE5pWw6YePKOiuvuS4ujDliJnkuI3ovpPlh7rnm7jlhbPmlofnq6DlhoXlrrkpIg0KWkNfTVNHMjMxPSLnm7jlhbPmlofnq6AiDQpaQ19NU0cyMzI9IueCueWHu+i/memHjOiOt+WPluivpeaXpeW/l+eahFRyYWNrQmFja+W8leeUqOWcsOWdgCINClpDX01TRzIzMz0iJXnlubQiDQpaQ19NU0cyMzQ9IuaQnOe0ouespuWQiOadoeS7tueahOivhOiuuiINClpDX01TRzIzNT0iJmxhcXVvOyINClpDX01TRzIzNj0iJnJhcXVvOyINClpDX01TRzIzNz0i56Gu6K6k5a+G56CBIg0KWkNfTVNHMjM4PSLmlofku7blpKflsI8iDQpaQ19NU0cyMzk9IuWbnuS4iue6p+ebruW9lSINClpDX01TRzI0MD0i5b2T5YmN6Lev5b6EIg0KWkNfTVNHMjQxPSJUYWdz57yW6L6RIg0KWkNfTVNHMjQyPSLnlKjmiLfnvJbovpEiDQpaQ19NU0cyNDM9IuWIhuexu+e8lui+kSINClpDX01TRzI0ND0i55WZ6KiA57yW6L6RIg0KWkNfTVNHMjQ1PSLlkI7lj7DpppbpobUiDQpaQ19NU0cyNDY9IuaWh+S7tue8lui+kSINClpDX01TRzI0Nz0i572R56uZ6K6+572uIg0KWkNfTVNHMjQ4PSLlkI7lj7DnrqHnkIYiDQpaQ19NU0cyNDk9Iuetiee6pyINClpDX01TRzI1MD0i5q2j5Zyo5L+d5a2YIg0KWkNfTVNHMjUxPSLnp5LlkI7oh6rliqjkv53lrZgiDQpaQ19NU0cyNTI9IuaBouWkjSINClpDX01TRzI1Mz0i5bey5oGi5aSNIg0KWkNfTVNHMjU0PSLov5nlsIbopobnm5bkvaDljp/mnInnmoTlhoXlrrnvvIHnu6fnu63vvJ8iDQpaQ19NU0cyNTU9IumdmeaAgeWMluiuvue9riINClpDX01TRzI1Nj0i5peg5YaF5a65Ig0KWkNfTVNHMjU3PSJaLUJsb2fmj5DnpLoiDQpaQ19NU0cyNTg9IuiHquWKqOS/neWtmOaIkOWKnyINClpDX01TRzI1OT0i6YeN5bu66aaW6aG157yT5a2Y5paH5Lu2Ig0KWkNfTVNHMjYwPSLnmbvlvZUiDQpaQ19NU0cyNjE9IiDmj5DnpLo6J+acquWIhuexuyfliIbnsbvmmK/ns7vnu5/pu5jorqTliqDlhaXnmoTliIbnsbss5LiN6IO95Yig6ZmkO+acquaMh+WumuWIhuexu+eahOaWh+eroOmDveW9kuWFpSfmnKrliIbnsbsn5LiLLOivpeWIhuexu+S4i+ayoeacieaWh+eroOeahOivneWwhuS4jeaYvuekuuWcqOWJjeWPsOWIhuexu+WIl+ihqOS4rS4iDQpaQ19NU0cyNjI9IuWFs+mXreivhOiuuuWKn+iDvSINClpDX01TRzI2Mz0i5ZCv55SoQ2hyb21l5o6o6YCB6YCa55+lIg0KWkNfTVNHMjY0PSLlj5bmtogiDQpaQ19NU0cyNjU9IuWbnuWkjeivpeeVmeiogCINClpDX01TRzI2Nj0iIOaTjeS9nOaIkOWKny4iDQpaQ19NU0cyNjc9IiDmk43kvZzlpLHotKUuIg0KWkNfTVNHMjY4PSIg5o+Q56S6OumcgOimgei/m+ihjCdb57Si5byV6YeN5bu6XScuIg0KWkNfTVNHMjY5PSIg5o+Q56S6OumcgOimgei/m+ihjCc8YSBocmVmPSIiJXUiIj7mlofku7bph43lu7o8L2E+Jy4iDQpaQ19NU0cyNzA9IuaJgOWxnuaWh+eroCINClpDX01TRzI3MT0i5ZCv55So6K+E6K665YCS5bqP6L6T5Ye6Ig0KWkNfTVNHMjcyPSLor4TorrrnvJbovpEiDQpaQ19NU0cyNzM9IiDkuYvliY3nmoTmibnph4/mk43kvZzov5jmnKrlhajpg6jmiafooYws6K+354K55Ye7IiI8YSBocmVmPScjJz7nu6fnu608L2E+IiLmiafooYzlrozmiYDmnInnmoTmk43kvZwuIg0KWkNfTVNHMjc0PSLmmL7npLrmkJzntKLmlofnq6DnmoTmlbDph48iDQpaQ19NU0cyNzU9IuWPkeW4g+S6jiINClpDX01TRzI3Nj0i5q2j5Zyo5Li65oKo5Yqg6L2957yW6L6R5ZmoIg0KWkNfTVNHMjc3PSLns7vnu5/mqKHlnZciDQpaQ19NU0cyNzg9IumFjee9riINClpDX01TRzI3OT0i5L6n5qCP5Yqg6L295pa55byPIg0KWkNfTVNHMjgwPSLoh6rliqgiDQpaQ19NU0cyODE9Iue8k+WtmCINClpDX01TRzI4Mj0i5pyq5ZCv55SoLOaXoOazleWQr+eUqOatpOW6lOeUqC4iDQpaQ19NU0cyODM9IuivpeW6lOeUqOaXoOazleiiq+WBnOeUqCzlpoLmnpzopoHlgZznlKjor7flhYjlgZznlKjov5nkupvlupTnlKg6Ig0KWkNfTVNHMjg0PSLor6XlupTnlKjml6Dms5Xooqvlronoo4Us6L+Z5Lqb5bqU55So5LiO5a6D5Yay56qBOiINClpDX01TRzI4NT0i6K+l5bqU55So5Y+v6IO95LiO6L+Z5Lqb5bqU55So5Yay56qBLOivt+WFs+azqOS9nOiAheWumOaWuee9keermToiDQpaQ19NU0cyODY9IueUqOaIt+iHquWumuS5ieaooeWdlyINClpDX01TRzI4Nz0i5Li76aKY6Ieq5bim5qih5Z2XIg0KWkNfTVNHMjg4PSLmj5Lku7bliJvlu7rmqKHlnZciDQpaQ19NU0cyODk9IueijueJh+aooeWdlyINClpDX01TRzI5MD0i6buY6K6k5L6n5qCPIg0KWkNfTVNHMjkxPSLkvqfmoI8yIg0KWkNfTVNHMjkyPSLkvqfmoI8zIg0KWkNfTVNHMjkzPSLkvqfmoI80Ig0KWkNfTVNHMjk0PSLkvqfmoI81Ig0KWkNfTVNHMjk1PSLlhoXlkKs8c3Bhbj4lbjwvc3Bhbj7kuKrmqKHlnZciDQpaQ19NU0cyOTY9IuaJi+WKqOS/ruaUueW5tumUgeWumue9keermeWcsOWdgCINClpDX01TRzI5Nz0i6Ieq5Yqo6K+G5Yir572R56uZ5Zyw5Z2AIg0KWkNfTVNHMjk4PSLpmpDol4/mqKHlnZfmoIfpopgiDQpaQ19NU0cyOTk9IuivpeaooeWdl+WcqOaooeeJiOS4reeahOeLrOeri+iwg+eUqOagh+etvuS4ujoiDQpaQ19NU0czMDA9IuivreiogOWMhSjpg6jliIbmqKHmnb/lkozmj5Lku7blj6/og73kvp3nhLbmmL7npLrlhbblroPnmoTor63oqIDjgIIpIg0KWkNfTVNHMzAxPSLmiZPlvIDku6PnoIHpq5jkuq4o57O757uf6Ieq5bim57yW6L6R5Zmo5L2/55SoU3ludGF4SGlnaExpZ2h0ZXLku6PnoIHpq5jkuq7lupPvvIzkvb/nlKjlhbblroPnvJbovpHlmajlj6/og73kuI3lkIwpIg0KWkNfTVNHMzAyPSLmgqjlvZPliY3nmoTnvJbovpHlhoXlrrnov5jmnKrkv53lrZjvvIEiDQpaQ19NU0czMDM9IlotQmxvZ+e9keermeWSjOeoi+W6j+W8gOWPkSINClpDX01TRzMwND0i56iL5bqPIg0KWkNfTVNHMzA1PSLorr7orqEiDQpaQ19NU0czMDY9IuaUr+aMgSINClpDX01TRzMwNz0i5oSf6LCiIg0KWkNfTVNHMzA4PSLnrYnmnIvlj4siDQoNCg0KDQoNCg0KDQoNCidBcnRpY2xlIExldmVsDQpaVkFfQXJ0aWNsZV9MZXZlbF9OYW1lKDApPSLml6AiDQpaVkFfQXJ0aWNsZV9MZXZlbF9OYW1lKDEpPSLojYnnqL8iDQpaVkFfQXJ0aWNsZV9MZXZlbF9OYW1lKDIpPSLnp4HkurrmtY/op4giDQpaVkFfQXJ0aWNsZV9MZXZlbF9OYW1lKDMpPSLnpoHmraLor4TorroiDQpaVkFfQXJ0aWNsZV9MZXZlbF9OYW1lKDQpPSLmma7pgJoiDQoNCg0KDQoNCidVc2VyIExldmVsDQpaVkFfVXNlcl9MZXZlbF9OYW1lKDEpPSLnrqHnkIblkZgiDQpaVkFfVXNlcl9MZXZlbF9OYW1lKDIpPSLnvZHnq5nnvJbovpEiDQpaVkFfVXNlcl9MZXZlbF9OYW1lKDMpPSLkvZzogIUiDQpaVkFfVXNlcl9MZXZlbF9OYW1lKDQpPSLor4TorrrogIUiDQpaVkFfVXNlcl9MZXZlbF9OYW1lKDUpPSLmuLjlrqIiDQoNCg0KDQoNCidKYW51YXJ5LCBGZWJydWFyeS4uLg0KWlZBX01vbnRoKDEpID0i5LiA5pyIIg0KWlZBX01vbnRoKDIpID0i5LqM5pyIIg0KWlZBX01vbnRoKDMpID0i5LiJ5pyIIg0KWlZBX01vbnRoKDQpID0i5Zub5pyIIg0KWlZBX01vbnRoKDUpID0i5LqU5pyIIg0KWlZBX01vbnRoKDYpID0i5YWt5pyIIg0KWlZBX01vbnRoKDcpID0i5LiD5pyIIg0KWlZBX01vbnRoKDgpID0i5YWr5pyIIg0KWlZBX01vbnRoKDkpID0i5Lmd5pyIIg0KWlZBX01vbnRoKDEwKT0i5Y2B5pyIIg0KWlZBX01vbnRoKDExKT0i5Y2B5LiA5pyIIg0KWlZBX01vbnRoKDEyKT0i5Y2B5LqM5pyIIg0KDQoNCidKYW4uLCBGZWIuIC4uLg0KWlZBX01vbnRoX0FiYnIoMSkgPSIx5pyIIg0KWlZBX01vbnRoX0FiYnIoMikgPSIy5pyIIg0KWlZBX01vbnRoX0FiYnIoMykgPSIz5pyIIg0KWlZBX01vbnRoX0FiYnIoNCkgPSI05pyIIg0KWlZBX01vbnRoX0FiYnIoNSkgPSI15pyIIg0KWlZBX01vbnRoX0FiYnIoNikgPSI25pyIIg0KWlZBX01vbnRoX0FiYnIoNykgPSI35pyIIg0KWlZBX01vbnRoX0FiYnIoOCkgPSI45pyIIg0KWlZBX01vbnRoX0FiYnIoOSkgPSI55pyIIg0KWlZBX01vbnRoX0FiYnIoMTApPSIxMOaciCINClpWQV9Nb250aF9BYmJyKDExKT0iMTHmnIgiDQpaVkFfTW9udGhfQWJicigxMik9IjEy5pyIIg0KDQoNCidTdW5kYXksIE1vbmRheS4uDQpaVkFfV2VlaygxKT0i5pif5pyf5pelIg0KWlZBX1dlZWsoMik9IuaYn+acn+S4gCINClpWQV9XZWVrKDMpPSLmmJ/mnJ/kuowiDQpaVkFfV2Vlayg0KT0i5pif5pyf5LiJIg0KWlZBX1dlZWsoNSk9IuaYn+acn+WbmyINClpWQV9XZWVrKDYpPSLmmJ/mnJ/kupQiDQpaVkFfV2Vlayg3KT0i5pif5pyf5YWtIg0KDQoNCidTdW4uLCBNb24uIC4uLg0KWlZBX1dlZWtfQWJicigxKT0i5pelIg0KWlZBX1dlZWtfQWJicigyKT0i5LiAIg0KWlZBX1dlZWtfQWJicigzKT0i5LqMIg0KWlZBX1dlZWtfQWJicig0KT0i5LiJIg0KWlZBX1dlZWtfQWJicig1KT0i5ZubIg0KWlZBX1dlZWtfQWJicig2KT0i5LqUIg0KWlZBX1dlZWtfQWJicig3KT0i5YWtIg0KDQoNCidDdXN0b20gRXJyb3IgSW5mb3JtYXRpb24NClpWQV9FcnJvck1zZygwKT0i5pyq55+l6ZSZ6K+vIg0KWlZBX0Vycm9yTXNnKDEpPSLmnKrnn6Xlkb3ku6QiDQpaVkFfRXJyb3JNc2coMik9IuacquafpeivouWIsOebuOWFs+mhtemdoiINClpWQV9FcnJvck1zZygzKT0i5Y+C5pWw5o+Q5Lqk6ZSZ6K+vIg0KWlZBX0Vycm9yTXNnKDQpPSLmlbDmja7lupPov57mjqXplJnor68iDQpaVkFfRXJyb3JNc2coNSk9Iumdnuazleiuv+mXriINClpWQV9FcnJvck1zZyg2KT0i5rKh5pyJ5p2D6ZmQIg0KWlZBX0Vycm9yTXNnKDcpPSLnlKjmiLflkI3kuLrnqbos6LaF6ZW/5oiW5qC85byP6ZSZ6K+vIg0KWlZBX0Vycm9yTXNnKDgpPSLnmbvlvZXlpLHotKUiDQpaVkFfRXJyb3JNc2coOSk9IuivpeaWh+eroOS4jeWtmOWcqCINClpWQV9FcnJvck1zZygxMCk9Iuezu+e7n+WIneWni+WMluWksei0pSINClpWQV9FcnJvck1zZygxMSk9Iue8lui+keaWh+eroOWksei0pSINClpWQV9FcnJvck1zZygxMik9Iue8lui+keWIhuexu+Wksei0pSINClpWQV9FcnJvck1zZygxMyk9IuivpeWIhuexu+S4i+acieaWh+eroO+8jOWIoOmZpOWksei0pSINClpWQV9FcnJvck1zZygxNCk9IuS9oOeahOivhOiuuuW3suiiq+aLpuaIqizlj5HooajlpLHotKUuIg0KWlZBX0Vycm9yTXNnKDE1KT0i5ZCN56ew5LiN6IO95Li656m65oiW6L+H6ZW/5Y+K5qC85byP5LiN5q2j56GuIg0KWlZBX0Vycm9yTXNnKDE2KT0i57yW6L6R55So5oi35aSx6LSlIg0KWlZBX0Vycm9yTXNnKDE3KT0i5Yig6Zmk55So5oi35aSx6LSlIg0KWlZBX0Vycm9yTXNnKDE4KT0i5Yig6Zmk6K+E6K665aSx6LSlIg0KWlZBX0Vycm9yTXNnKDE5KT0i5Yig6Zmk5byV55So5aSx6LSlIg0KWlZBX0Vycm9yTXNnKDIwKT0i5Y+R6YCB5byV55So5aSx6LSlIg0KWlZBX0Vycm9yTXNnKDIxKT0i5paH5Lu25LiK5Lyg5aSx6LSlIg0KWlZBX0Vycm9yTXNnKDIyKT0i5paH5Lu25Yig6Zmk5aSx6LSlIg0KWlZBX0Vycm9yTXNnKDIzKT0i57O757uf6YeN5bu65aSx6LSlIg0KWlZBX0Vycm9yTXNnKDI0KT0i5pCc57Si5a2X56ym5Liy5aSx6LSlIg0KWlZBX0Vycm9yTXNnKDI1KT0i5L+d5a2Y6K6+572u5aSx6LSlIg0KWlZBX0Vycm9yTXNnKDI2KT0i5paH5Lu257G75Z6L6LaF5Ye66K6+5a6a6IyD5Zu0Ig0KWlZBX0Vycm9yTXNnKDI3KT0i5paH5Lu25aSn5bCP6LaF5Ye66K6+5a6a6IyD5Zu0Ig0KWlZBX0Vycm9yTXNnKDI4KT0i5paH5Lu25bey5a2Y5Zyo77yM6K+35YWI5Yig6ZmkIg0KWlZBX0Vycm9yTXNnKDI5KT0i6YKu566x5LiN6IO95Li656m65oiW6L+H6ZW/5Y+K5qC85byP5LiN5q2j56GuIg0KWlZBX0Vycm9yTXNnKDMwKT0i572R5Z2A5LiN6IO95Li656m65oiW6L+H6ZW/5Y+K5qC85byP5LiN5q2j56GuIg0KWlZBX0Vycm9yTXNnKDMxKT0i6K+35Yu/5YaS5ZCN6aG25pu/LOWmguaenOS9oOaYr+ivpeeUqOaItyzor7flhYjnmbvlvZXlkI7lho3lj5Hooajor4TorroiDQpaVkFfRXJyb3JNc2coMzIpPSLnlLHkuo7orr7lrprml7bpl7Tpl7TpmpTogIzmi5Lnu53mk43kvZwiDQpaVkFfRXJyb3JNc2coMzMpPSLnvJbovpHlhbPplK7lrZflpLHotKUiDQpaVkFfRXJyb3JNc2coMzQpPSLliKDpmaTlhbPplK7lrZflpLHotKUiDQpaVkFfRXJyb3JNc2coMzUpPSLnvJbovpFUYWdz5aSx6LSlIg0KWlZBX0Vycm9yTXNnKDM2KT0i5Yig6ZmkVGFnc+Wksei0pSINClpWQV9FcnJvck1zZygzNyk9Iue8lui+keaWh+S7tuWksei0pSINClpWQV9FcnJvck1zZygzOCk9IumqjOivgeeggei+k+WFpemUmeivryINClpWQV9FcnJvck1zZygzOSk9Iuivt+S4jeimgeWvuUJsb2fmj5DkuqTnm7jlkIznmoTor4TorroiDQpaVkFfRXJyb3JNc2coNDApPSLor4Torrrlip/og73lt7LlhbPpl60iDQpaVkFfRXJyb3JNc2coNDEpPSLlvJXnlKjlip/og73lt7LlhbPpl60iDQpaVkFfRXJyb3JNc2coNDIpPSLnvJbovpHor4TorrrlpLHotKUiDQpaVkFfRXJyb3JNc2coNDMpPSLmoKHpqoznoIHplJnor68s6K+35Yu/5Y+R5biD5Z6D5Zy+5L+h5oGvIg0KWlZBX0Vycm9yTXNnKDQ0KT0i6Z2e5YWs5byA5paH56ug5LiN6IO95Y+R6KGo6K+E6K66Ig0KWlZBX0Vycm9yTXNnKDQ1KT0i55WZ6KiA5pys5Y+q5YWB6K645rOo5YaM55So5oi35Zue5aSNLOa4uOWuouWPquiDveeVmeiogC4iDQpaVkFfRXJyb3JNc2coNDYpPSLor4TorrrlhoXlrrnkuI3og73kuLrnqbrmiJbov4fplb8iDQpaVkFfRXJyb3JNc2coNDcpPSLlm57lpI3lip/og73lj6rlr7nms6jlhoznlKjmiLflvIDlkK8s5ri45a6i5Y+q6IO955WZ6KiALiINClpWQV9FcnJvck1zZyg0OCk9IuaPkuS7tuacquWQr+eUqCzor7flnKjnrqHnkIbnlYzpnaLlkK/nlKguIg0KWlZBX0Vycm9yTXNnKDQ5KT0i6K+l5YiG57G75LiL5pyJ5a2Q5YiG57G7LOWIoOmZpOWksei0pS4iDQpaVkFfRXJyb3JNc2coNTApPSLmjIflrprnmoTniLbliIbnsbvkuI3lrZjlnKgiDQpaVkFfRXJyb3JNc2coNTEpPSLlrZDliIbnsbvkuIvkuI3og73lho3ljIXlkKvliIbnsbsiDQpaVkFfRXJyb3JNc2coNTIpPSLotoXov4fljZrlrqLorr7nva7nmoTmnIDlpKflm57lpI3lsYLmlbAiDQpaVkFfRXJyb3JNc2coNTMpPSLkvaDnmoTor4Torrrlt7Lov5vlhaXlrqHmoLjov4fnqIss6K+35Yu/5YaN5qyh5o+Q5LqkLiINClpWQV9FcnJvck1zZyg1NCk9IuWvhueggeWPquiDveS9v+eUqGEtejAtOWB+IUAjJCVeJiotX+Wtl+espue7hOS6iyzkuJTkuI3og73lsI/kuo445L2NLiINClpWQV9FcnJvck1zZyg1NSk9Ik1ENeWTiOW4jOeul+azleWQjueahOWtl+espuS4sumVv+W6puS4jeaYrzMy5L2N55qEIg0KWlZBX0Vycm9yTXNnKDU2KT0i6LaF5Ye65LqG6K6+572u55qE5Zue5aSN5bGC5pWw77yBIg0KWlZBX0Vycm9yTXNnKDU3KT0i54i26K+E6K665ZKM5a2Q6K+E6K665LiN5Zyo5ZCM5LiA56+H5paH56ugISINClpWQV9FcnJvck1zZyg1OCk9IuS4jeWtmOWcqOeItuWIhuexuyINClpWQV9FcnJvck1zZyg1OSk9IuS4jeWtmOWcqOWtkOWIhuexuyINClpWQV9FcnJvck1zZyg2MCk9IuWbnuWkjeivhOiuuuWksei0pSINClpWQV9FcnJvck1zZyg2MSk9IuivpeiusOW9leS4jeWtmOWcqCINClpWQV9FcnJvck1zZyg2Mik9IuWQjOWQjeeUqOaIt+W3suWtmOWcqCzor7fkv67mlLnnlKjmiLflkI0uIg0KWlZBX0Vycm9yTXNnKDYzKT0i6I2J56i/56aB5q2i5rWP6KeIIg0KWlZBX0Vycm9yTXNnKDY0KT0i5ZCv55So5aSx6LSlLOivpeW6lOeUqOeahHhtbOmFjee9ruS/oeaBr+S4jeaYr1otQmxvZyAyLljniYjmnKznmoQuIg0KWlZBX0Vycm9yTXNnKDY1KT0iV2luZG93cyBQaG9uZeaJi+acuuiHquW4pklF5Y+v6IO95peg5rOV5q2j5bi45LiK5Lyg77yM5bu66K6u5oKo5L2/55So56ys5LiJ5pa55rWP6KeI5Zmo44CCIg0KJT4=</file>
</files>